<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 6 TECATOR dataset | Support Vector Machine Classification of Functional Data with Random Vertical Shifts</title>
  <meta name="description" content="Chapter 6 TECATOR dataset | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 6 TECATOR dataset | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 6 TECATOR dataset | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2025-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace4.html"/>

<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Support Vector Machine Classification of Functional Data with Random Vertical Shifts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="aplikace3" class="section level1 hasAnchor" number="6">
<h1><span class="header-section-number">Chapter 6</span> TECATOR dataset<a href="aplikace3.html#aplikace3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this chapter, we will focus on the application of previously described methods (for more details, see, for example, section <a href="simulace3.html#simulace3">1</a>) to real data <code>tecator</code>, which are available, for example, in the <code>ddalpha</code> package. A detailed description of the data can be found <a href="https://search.r-project.org/CRAN/refmans/ddalpha/html/dataf.tecator.html">here</a>. This dataset contains spectrometric curves (absorbance curves measured at 100 wavelengths).</p>
<p>For each piece of finely chopped meat, we observe one spectrometric curve, which corresponds to the absorbance measured at 100 wavelengths. The pieces are divided, according to <a href="https://link.springer.com/book/10.1007/0-387-36620-2">Ferraty and Vieu (2006)</a>, into two classes: with low (<span class="math inline">\(&lt; 20\%\)</span>) and high (<span class="math inline">\(\geq 20\%\)</span>) fat content obtained through analytical chemical processing. Our goal will be to classify the spectrometric curves on the interval <span class="math inline">\(I = [850 \text{ nm}, 1050 \text{ nm}]\)</span> based on fat content. As we will see from the results in section <a href="aplikace3.html#klasA3deriv">6.4</a>, it is advantageous to consider the second derivative of the curves.</p>
<p>Let’s start by loading and plotting the data. The data are stored in a somewhat complex way, so to make working with them easier, we will save them in a more practical format. We will also name the respective columns according to whether the fat content is low (<code>small</code>) or high (<code>large</code>).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb747"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb747-1"><a href="aplikace3.html#cb747-1" tabindex="-1"></a><span class="co"># loading data </span></span>
<span id="cb747-2"><a href="aplikace3.html#cb747-2" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb747-3"><a href="aplikace3.html#cb747-3" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb747-4"><a href="aplikace3.html#cb747-4" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb747-5"><a href="aplikace3.html#cb747-5" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb747-6"><a href="aplikace3.html#cb747-6" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb747-7"><a href="aplikace3.html#cb747-7" tabindex="-1"></a></span>
<span id="cb747-8"><a href="aplikace3.html#cb747-8" tabindex="-1"></a>data <span class="ot">&lt;-</span> ddalpha<span class="sc">::</span><span class="fu">dataf.tecator</span>()</span>
<span id="cb747-9"><a href="aplikace3.html#cb747-9" tabindex="-1"></a></span>
<span id="cb747-10"><a href="aplikace3.html#cb747-10" tabindex="-1"></a>data.gr <span class="ot">&lt;-</span> data<span class="sc">$</span>dataf[[<span class="dv">1</span>]]<span class="sc">$</span>vals</span>
<span id="cb747-11"><a href="aplikace3.html#cb747-11" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span><span class="fu">length</span>(data<span class="sc">$</span>labels)) {</span>
<span id="cb747-12"><a href="aplikace3.html#cb747-12" tabindex="-1"></a>  data.gr <span class="ot">&lt;-</span> <span class="fu">rbind</span>(data.gr, data<span class="sc">$</span>dataf[[i]]<span class="sc">$</span>vals)</span>
<span id="cb747-13"><a href="aplikace3.html#cb747-13" tabindex="-1"></a>  }</span>
<span id="cb747-14"><a href="aplikace3.html#cb747-14" tabindex="-1"></a>data.gr <span class="ot">&lt;-</span> <span class="fu">cbind</span>(<span class="fu">data.frame</span>(<span class="at">wave =</span> data<span class="sc">$</span>dataf[[<span class="dv">1</span>]]<span class="sc">$</span>args),</span>
<span id="cb747-15"><a href="aplikace3.html#cb747-15" tabindex="-1"></a>                 <span class="fu">t</span>(data.gr))</span>
<span id="cb747-16"><a href="aplikace3.html#cb747-16" tabindex="-1"></a></span>
<span id="cb747-17"><a href="aplikace3.html#cb747-17" tabindex="-1"></a><span class="co"># vector of classes</span></span>
<span id="cb747-18"><a href="aplikace3.html#cb747-18" tabindex="-1"></a>labels <span class="ot">&lt;-</span> data<span class="sc">$</span>labels <span class="sc">|&gt;</span> <span class="fu">unlist</span>()</span>
<span id="cb747-19"><a href="aplikace3.html#cb747-19" tabindex="-1"></a><span class="co"># renaming according to class</span></span>
<span id="cb747-20"><a href="aplikace3.html#cb747-20" tabindex="-1"></a><span class="fu">colnames</span>(data.gr) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;wavelength&#39;</span>,</span>
<span id="cb747-21"><a href="aplikace3.html#cb747-21" tabindex="-1"></a>                       <span class="fu">paste0</span>(labels, <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(data<span class="sc">$</span>labels)))</span></code></pre></div>
</details>
<p>Let’s plot the spectrometric curves by group.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb748"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb748-1"><a href="aplikace3.html#cb748-1" tabindex="-1"></a>abs.labs <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&quot;Fat content &lt; 20 %&quot;</span>, <span class="st">&quot;Fat content &gt; 20 %&quot;</span>)</span>
<span id="cb748-2"><a href="aplikace3.html#cb748-2" tabindex="-1"></a><span class="fu">names</span>(abs.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>)</span>
<span id="cb748-3"><a href="aplikace3.html#cb748-3" tabindex="-1"></a></span>
<span id="cb748-4"><a href="aplikace3.html#cb748-4" tabindex="-1"></a><span class="fu">pivot_longer</span>(data.gr, <span class="at">cols =</span> large1<span class="sc">:</span>large215, <span class="at">names_to =</span> <span class="st">&#39;sample&#39;</span>,</span>
<span id="cb748-5"><a href="aplikace3.html#cb748-5" tabindex="-1"></a>                        <span class="at">values_to =</span> <span class="st">&#39;absorbance&#39;</span>, <span class="at">cols_vary =</span> <span class="st">&#39;slowest&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb748-6"><a href="aplikace3.html#cb748-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sample =</span> <span class="fu">as.factor</span>(sample),</span>
<span id="cb748-7"><a href="aplikace3.html#cb748-7" tabindex="-1"></a>         <span class="at">Abs =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(data.gr<span class="sc">$</span>wavelength)), </span>
<span id="cb748-8"><a href="aplikace3.html#cb748-8" tabindex="-1"></a>                      <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb748-9"><a href="aplikace3.html#cb748-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> wavelength, <span class="at">y =</span> absorbance, <span class="at">colour =</span> Abs, <span class="at">group =</span> sample)) <span class="sc">+</span> </span>
<span id="cb748-10"><a href="aplikace3.html#cb748-10" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb748-11"><a href="aplikace3.html#cb748-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb748-12"><a href="aplikace3.html#cb748-12" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Abs,</span>
<span id="cb748-13"><a href="aplikace3.html#cb748-13" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Abs =</span> abs.labs)) <span class="sc">+</span> </span>
<span id="cb748-14"><a href="aplikace3.html#cb748-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Wavelength [in nm]&quot;</span>,</span>
<span id="cb748-15"><a href="aplikace3.html#cb748-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb748-16"><a href="aplikace3.html#cb748-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Fat content&quot;</span>) <span class="sc">+</span> </span>
<span id="cb748-17"><a href="aplikace3.html#cb748-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb748-18"><a href="aplikace3.html#cb748-18" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> abs.labs)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-2"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-2-1.png" alt="Absorbance curves by group." width="672" />
<p class="caption">
Figure 6.1: Absorbance curves by group.
</p>
</div>
<div id="smoothing-of-observed-curves-1" class="section level2 hasAnchor" number="6.1">
<h2><span class="header-section-number">6.1</span> Smoothing of Observed Curves<a href="aplikace3.html#smoothing-of-observed-curves-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>We will now transform the observed discrete values (value vectors) into functional objects, with which we will subsequently work.
Since these are non-periodic curves on the interval <span class="math inline">\(I = [850, 1050]\)</span>, we will use a B-spline basis for smoothing.</p>
<p>We take the entire <code>wavelength</code> vector as knots, and we would normally consider cubic splines, but since we want to work with the second derivative, we choose <code>norder = 6</code>. For the same reason, we will penalize the fourth derivative of the functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb749"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb749-1"><a href="aplikace3.html#cb749-1" tabindex="-1"></a>t <span class="ot">&lt;-</span> data.gr<span class="sc">$</span>wavelength</span>
<span id="cb749-2"><a href="aplikace3.html#cb749-2" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb749-3"><a href="aplikace3.html#cb749-3" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb749-4"><a href="aplikace3.html#cb749-4" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb749-5"><a href="aplikace3.html#cb749-5" tabindex="-1"></a></span>
<span id="cb749-6"><a href="aplikace3.html#cb749-6" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb749-7"><a href="aplikace3.html#cb749-7" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb749-8"><a href="aplikace3.html#cb749-8" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb749-9"><a href="aplikace3.html#cb749-9" tabindex="-1"></a></span>
<span id="cb749-10"><a href="aplikace3.html#cb749-10" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">4</span>) <span class="co"># penalize 4th derivative</span></span></code></pre></div>
</details>
<p>We will find a suitable value of the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, i.e., generalized cross-validation.
The value of <span class="math inline">\(\lambda\)</span> will be considered the same for both classes, as for test observations we would not know in advance which value of <span class="math inline">\(\lambda\)</span> to choose if different values were selected for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb750"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb750-1"><a href="aplikace3.html#cb750-1" tabindex="-1"></a><span class="co"># combine observations into one matrix</span></span>
<span id="cb750-2"><a href="aplikace3.html#cb750-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> data.gr[, <span class="sc">-</span><span class="dv">1</span>] <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>()</span>
<span id="cb750-3"><a href="aplikace3.html#cb750-3" tabindex="-1"></a></span>
<span id="cb750-4"><a href="aplikace3.html#cb750-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="fl">0.5</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># lambda vector</span></span>
<span id="cb750-5"><a href="aplikace3.html#cb750-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for GCV storage</span></span>
<span id="cb750-6"><a href="aplikace3.html#cb750-6" tabindex="-1"></a></span>
<span id="cb750-7"><a href="aplikace3.html#cb750-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb750-8"><a href="aplikace3.html#cb750-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb750-9"><a href="aplikace3.html#cb750-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb750-10"><a href="aplikace3.html#cb750-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average across all observed curves</span></span>
<span id="cb750-11"><a href="aplikace3.html#cb750-11" tabindex="-1"></a>}</span>
<span id="cb750-12"><a href="aplikace3.html#cb750-12" tabindex="-1"></a></span>
<span id="cb750-13"><a href="aplikace3.html#cb750-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb750-14"><a href="aplikace3.html#cb750-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb750-15"><a href="aplikace3.html#cb750-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb750-16"><a href="aplikace3.html#cb750-16" tabindex="-1"></a>)</span>
<span id="cb750-17"><a href="aplikace3.html#cb750-17" tabindex="-1"></a></span>
<span id="cb750-18"><a href="aplikace3.html#cb750-18" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb750-19"><a href="aplikace3.html#cb750-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>To illustrate better, we will plot the <span class="math inline">\(GCV(\lambda)\)</span> progression.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb751"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb751-1"><a href="aplikace3.html#cb751-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb751-2"><a href="aplikace3.html#cb751-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb751-3"><a href="aplikace3.html#cb751-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.7</span>) <span class="sc">+</span> </span>
<span id="cb751-4"><a href="aplikace3.html#cb751-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb751-5"><a href="aplikace3.html#cb751-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb751-6"><a href="aplikace3.html#cb751-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb751-7"><a href="aplikace3.html#cb751-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb751-8"><a href="aplikace3.html#cb751-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">3</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-5"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-5-1.png" alt="Progression of $GCV(\lambda)$ for the chosen $\boldsymbol\lambda$ vector. On the $x$-axis, values are shown on a logarithmic scale with base 10. The optimal value of the smoothing parameter $\lambda_{optimal}$ is marked in red." width="672" />
<p class="caption">
Figure 6.2: Progression of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen <span class="math inline">\(\boldsymbol\lambda\)</span> vector. On the <span class="math inline">\(x\)</span>-axis, values are shown on a logarithmic scale with base 10. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is marked in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb753"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb753-1"><a href="aplikace3.html#cb753-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb753-2"><a href="aplikace3.html#cb753-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb753-3"><a href="aplikace3.html#cb753-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb753-4"><a href="aplikace3.html#cb753-4" tabindex="-1"></a></span>
<span id="cb753-5"><a href="aplikace3.html#cb753-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span></code></pre></div>
</details>
<p>Finally, we will display all curves including the average separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb754"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb754-1"><a href="aplikace3.html#cb754-1" tabindex="-1"></a><span class="fu">library</span>(tikzDevice)</span>
<span id="cb754-2"><a href="aplikace3.html#cb754-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">dim</span>(XX)[<span class="dv">2</span>]</span>
<span id="cb754-3"><a href="aplikace3.html#cb754-3" tabindex="-1"></a></span>
<span id="cb754-4"><a href="aplikace3.html#cb754-4" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb754-5"><a href="aplikace3.html#cb754-5" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, n),</span>
<span id="cb754-6"><a href="aplikace3.html#cb754-6" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t))),</span>
<span id="cb754-7"><a href="aplikace3.html#cb754-7" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb754-8"><a href="aplikace3.html#cb754-8" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb754-9"><a href="aplikace3.html#cb754-9" tabindex="-1"></a>)</span>
<span id="cb754-10"><a href="aplikace3.html#cb754-10" tabindex="-1"></a></span>
<span id="cb754-11"><a href="aplikace3.html#cb754-11" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb754-12"><a href="aplikace3.html#cb754-12" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb754-13"><a href="aplikace3.html#cb754-13" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[labels <span class="sc">==</span> <span class="st">&#39;small&#39;</span>]), <span class="at">evalarg =</span> t),</span>
<span id="cb754-14"><a href="aplikace3.html#cb754-14" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>]), <span class="at">evalarg =</span> t)),</span>
<span id="cb754-15"><a href="aplikace3.html#cb754-15" tabindex="-1"></a>  <span class="co"># c(apply(fdobjSmootheval[ , labels == &#39;small&#39;], 1, mean), </span></span>
<span id="cb754-16"><a href="aplikace3.html#cb754-16" tabindex="-1"></a>  <span class="co">#           apply(fdobjSmootheval[ , labels == &#39;large&#39;], 1, mean)),</span></span>
<span id="cb754-17"><a href="aplikace3.html#cb754-17" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb754-18"><a href="aplikace3.html#cb754-18" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb754-19"><a href="aplikace3.html#cb754-19" tabindex="-1"></a>)</span>
<span id="cb754-20"><a href="aplikace3.html#cb754-20" tabindex="-1"></a></span>
<span id="cb754-21"><a href="aplikace3.html#cb754-21" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">color =</span> Fat)) <span class="sc">+</span> </span>
<span id="cb754-22"><a href="aplikace3.html#cb754-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb754-23"><a href="aplikace3.html#cb754-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb754-24"><a href="aplikace3.html#cb754-24" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Fat,</span>
<span id="cb754-25"><a href="aplikace3.html#cb754-25" tabindex="-1"></a>             <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">Fat =</span> abs.labs)</span>
<span id="cb754-26"><a href="aplikace3.html#cb754-26" tabindex="-1"></a>             ) <span class="sc">+</span> </span>
<span id="cb754-27"><a href="aplikace3.html#cb754-27" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Wavelength&quot;</span>,</span>
<span id="cb754-28"><a href="aplikace3.html#cb754-28" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb754-29"><a href="aplikace3.html#cb754-29" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Fat content&quot;</span>) <span class="sc">+</span> </span>
<span id="cb754-30"><a href="aplikace3.html#cb754-30" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb754-31"><a href="aplikace3.html#cb754-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), </span>
<span id="cb754-32"><a href="aplikace3.html#cb754-32" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span></span>
<span id="cb754-33"><a href="aplikace3.html#cb754-33" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-7"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-7-1.png" alt="Plot of all smoothed observed curves, with colors distinguishing curves by class. The average for each class is shown in black." width="672" />
<p class="caption">
Figure 6.3: Plot of all smoothed observed curves, with colors distinguishing curves by class. The average for each class is shown in black.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb755"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb755-1"><a href="aplikace3.html#cb755-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_curves_mean.tex&quot;, device = tikz, width = 9, height = 4.5)</span></span></code></pre></div>
</details>
<p>We observe that the curves for both groups (by fat content) are relatively similar, with the average indicated in black. The curves differ mainly in the middle of the interval, where fattier samples show one additional local extremum, while less fatty samples appear simpler with only one extremum.</p>
</div>
<div id="computation-of-derivatives" class="section level2 hasAnchor" number="6.2">
<h2><span class="header-section-number">6.2</span> Computation of Derivatives<a href="aplikace3.html#computation-of-derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As mentioned above, it will be advantageous to classify the curves based on the second derivative. To compute the derivative for a functional object, we will use the <code>deriv.fd()</code> function from the <code>fda</code> package in <code>R</code>. Since we want to classify based on the second derivative, we set the argument <code>Lfdobj = 2</code>. The use of this data will be shown in Section <a href="aplikace3.html#klasA3deriv">6.4</a>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb756"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb756-1"><a href="aplikace3.html#cb756-1" tabindex="-1"></a>XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">2</span>)</span>
<span id="cb756-2"><a href="aplikace3.html#cb756-2" tabindex="-1"></a>ttt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb756-3"><a href="aplikace3.html#cb756-3" tabindex="-1"></a>fdobjSmootheval_der2 <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, </span>
<span id="cb756-4"><a href="aplikace3.html#cb756-4" tabindex="-1"></a>                                <span class="at">evalarg =</span> ttt)</span></code></pre></div>
</details>
<p>Let’s display all curves, including the average, separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb757"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb757-1"><a href="aplikace3.html#cb757-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb757-2"><a href="aplikace3.html#cb757-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(ttt, n),</span>
<span id="cb757-3"><a href="aplikace3.html#cb757-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(ttt))),</span>
<span id="cb757-4"><a href="aplikace3.html#cb757-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval_der2),</span>
<span id="cb757-5"><a href="aplikace3.html#cb757-5" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(labels, <span class="at">each =</span> <span class="fu">length</span>(ttt)), <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb757-6"><a href="aplikace3.html#cb757-6" tabindex="-1"></a>)</span>
<span id="cb757-7"><a href="aplikace3.html#cb757-7" tabindex="-1"></a></span>
<span id="cb757-8"><a href="aplikace3.html#cb757-8" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb757-9"><a href="aplikace3.html#cb757-9" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(ttt, <span class="dv">2</span>),</span>
<span id="cb757-10"><a href="aplikace3.html#cb757-10" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[labels <span class="sc">==</span> <span class="st">&#39;small&#39;</span>]), <span class="at">evalarg =</span> ttt),</span>
<span id="cb757-11"><a href="aplikace3.html#cb757-11" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>]), <span class="at">evalarg =</span> ttt)),</span>
<span id="cb757-12"><a href="aplikace3.html#cb757-12" tabindex="-1"></a>  <span class="at">Fat =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>), <span class="at">each =</span> <span class="fu">length</span>(ttt)),</span>
<span id="cb757-13"><a href="aplikace3.html#cb757-13" tabindex="-1"></a>                 <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">&#39;small&#39;</span>, <span class="st">&#39;large&#39;</span>))</span>
<span id="cb757-14"><a href="aplikace3.html#cb757-14" tabindex="-1"></a>)</span>
<span id="cb757-15"><a href="aplikace3.html#cb757-15" tabindex="-1"></a></span>
<span id="cb757-16"><a href="aplikace3.html#cb757-16" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">color =</span> Fat)) <span class="sc">+</span> </span>
<span id="cb757-17"><a href="aplikace3.html#cb757-17" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb757-18"><a href="aplikace3.html#cb757-18" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb757-19"><a href="aplikace3.html#cb757-19" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Fat) <span class="sc">+</span> </span>
<span id="cb757-20"><a href="aplikace3.html#cb757-20" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;Wavelength&quot;</span>,</span>
<span id="cb757-21"><a href="aplikace3.html#cb757-21" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Absorbance&quot;</span>,</span>
<span id="cb757-22"><a href="aplikace3.html#cb757-22" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&quot;Fat content&quot;</span>) <span class="sc">+</span> </span>
<span id="cb757-23"><a href="aplikace3.html#cb757-23" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb757-24"><a href="aplikace3.html#cb757-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), </span>
<span id="cb757-25"><a href="aplikace3.html#cb757-25" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span></span>
<span id="cb757-26"><a href="aplikace3.html#cb757-26" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-9"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-9-1.png" alt="Plot of all smoothed observed curves, with colors distinguishing curves by classification class. The average for each class is shown in black." width="672" />
<p class="caption">
Figure 6.4: Plot of all smoothed observed curves, with colors distinguishing curves by classification class. The average for each class is shown in black.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb758"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb758-1"><a href="aplikace3.html#cb758-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_curves_derivatives.tex&quot;, device = tikz, width = 9, height = 4.5)</span></span></code></pre></div>
</details>
<p>From the figure above, we see that the average curves between the two groups of samples now differ much more significantly than in the case of the original non-derivative curves.</p>
</div>
<div id="classification-of-original-curves" class="section level2 hasAnchor" number="6.3">
<h2><span class="header-section-number">6.3</span> Classification of Original Curves<a href="aplikace3.html#classification-of-original-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the first part of this chapter, we will focus on the classification of the original non-derivative curves. Classification based on the second derivative of the original curves will be shown later in Section <a href="aplikace3.html#klasA3deriv">6.4</a>. First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb759"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb759-1"><a href="aplikace3.html#cb759-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training</span></span>
<span id="cb759-2"><a href="aplikace3.html#cb759-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb759-3"><a href="aplikace3.html#cb759-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb759-4"><a href="aplikace3.html#cb759-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb759-5"><a href="aplikace3.html#cb759-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb759-6"><a href="aplikace3.html#cb759-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb759-7"><a href="aplikace3.html#cb759-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for LR on scores</span></span>
<span id="cb759-8"><a href="aplikace3.html#cb759-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for LR on scores</span></span>
<span id="cb759-9"><a href="aplikace3.html#cb759-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb759-10"><a href="aplikace3.html#cb759-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># trees</span></span>
<span id="cb759-11"><a href="aplikace3.html#cb759-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># graphics</span></span>
<span id="cb759-12"><a href="aplikace3.html#cb759-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb759-13"><a href="aplikace3.html#cb759-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># random forest</span></span>
<span id="cb759-14"><a href="aplikace3.html#cb759-14" tabindex="-1"></a></span>
<span id="cb759-15"><a href="aplikace3.html#cb759-15" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>We will split the data in a 30:70 ratio into test and training sets to evaluate the classification accuracy of individual methods. The training set will be used to construct the classifier, while the test set will be used to calculate the classification error and potentially other characteristics of our model. The resulting classifiers can then be compared with each other in terms of their classification accuracy based on these calculated characteristics.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb760"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb760-1"><a href="aplikace3.html#cb760-1" tabindex="-1"></a><span class="co"># splitting into test and training set</span></span>
<span id="cb760-2"><a href="aplikace3.html#cb760-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb760-3"><a href="aplikace3.html#cb760-3" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb760-4"><a href="aplikace3.html#cb760-4" tabindex="-1"></a></span>
<span id="cb760-5"><a href="aplikace3.html#cb760-5" tabindex="-1"></a><span class="co"># creating a 0 and 1 vector, 0 for &lt; 20 and 1 for &gt; 20 </span></span>
<span id="cb760-6"><a href="aplikace3.html#cb760-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb760-7"><a href="aplikace3.html#cb760-7" tabindex="-1"></a></span>
<span id="cb760-8"><a href="aplikace3.html#cb760-8" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb760-9"><a href="aplikace3.html#cb760-9" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb760-10"><a href="aplikace3.html#cb760-10" tabindex="-1"></a></span>
<span id="cb760-11"><a href="aplikace3.html#cb760-11" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb760-12"><a href="aplikace3.html#cb760-12" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Let’s check the distribution of individual groups in the test and training parts of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb761"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb761-1"><a href="aplikace3.html#cb761-1" tabindex="-1"></a><span class="co"># absolute distribution</span></span>
<span id="cb761-2"><a href="aplikace3.html#cb761-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 91 59</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb763"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb763-1"><a href="aplikace3.html#cb763-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 47 18</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb765"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb765-1"><a href="aplikace3.html#cb765-1" tabindex="-1"></a><span class="co"># relative distribution</span></span>
<span id="cb765-2"><a href="aplikace3.html#cb765-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.6066667 0.3933333</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb767"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb767-1"><a href="aplikace3.html#cb767-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.7230769 0.2769231</code></pre>
<div id="k-nearest-neighbors-5" class="section level3 hasAnchor" number="6.3.1">
<h3><span class="header-section-number">6.3.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="aplikace3.html#k-nearest-neighbors-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We start with a non-parametric classification method, specifically the <span class="math inline">\(K\)</span> nearest neighbors method.
First, we create the necessary objects to work with the <code>classif.knn()</code> function from the <code>fda.usc</code> package.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb769"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb769-1"><a href="aplikace3.html#cb769-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb769-2"><a href="aplikace3.html#cb769-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now, we can define the model and examine its classification accuracy.
The remaining question is how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>.
We could choose this <span class="math inline">\(K\)</span> value as the one that minimizes the error on the training data.
However, this might lead to overfitting, so we will use cross-validation.
Given the computational complexity and size of the dataset, we choose <span class="math inline">\(k\)</span>-fold CV, with <span class="math inline">\(k = 10\)</span> for example.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb770"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb770-1"><a href="aplikace3.html#cb770-1" tabindex="-1"></a><span class="co"># model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb770-2"><a href="aplikace3.html#cb770-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb770-3"><a href="aplikace3.html#cb770-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb770-4"><a href="aplikace3.html#cb770-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb770-5"><a href="aplikace3.html#cb770-5" tabindex="-1"></a></span>
<span id="cb770-6"><a href="aplikace3.html#cb770-6" tabindex="-1"></a><span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob <span class="co"># minimum error</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.1466667</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb772"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb772-1"><a href="aplikace3.html#cb772-1" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 1</code></pre>
<p>Let’s apply this process to the training data, which we will split into <span class="math inline">\(k\)</span> parts and repeat this code section <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb774"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb774-1"><a href="aplikace3.html#cb774-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb774-2"><a href="aplikace3.html#cb774-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb774-3"><a href="aplikace3.html#cb774-3" tabindex="-1"></a></span>
<span id="cb774-4"><a href="aplikace3.html#cb774-4" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb774-5"><a href="aplikace3.html#cb774-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb774-6"><a href="aplikace3.html#cb774-6" tabindex="-1"></a></span>
<span id="cb774-7"><a href="aplikace3.html#cb774-7" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb774-8"><a href="aplikace3.html#cb774-8" tabindex="-1"></a><span class="co"># columns will contain accuracy values for each training subset part</span></span>
<span id="cb774-9"><a href="aplikace3.html#cb774-9" tabindex="-1"></a><span class="co"># rows will contain values for each K neighbors</span></span>
<span id="cb774-10"><a href="aplikace3.html#cb774-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb774-11"><a href="aplikace3.html#cb774-11" tabindex="-1"></a></span>
<span id="cb774-12"><a href="aplikace3.html#cb774-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb774-13"><a href="aplikace3.html#cb774-13" tabindex="-1"></a>  <span class="co"># define the index set</span></span>
<span id="cb774-14"><a href="aplikace3.html#cb774-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb774-15"><a href="aplikace3.html#cb774-15" tabindex="-1"></a>    </span>
<span id="cb774-16"><a href="aplikace3.html#cb774-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb774-17"><a href="aplikace3.html#cb774-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb774-18"><a href="aplikace3.html#cb774-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb774-19"><a href="aplikace3.html#cb774-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb774-20"><a href="aplikace3.html#cb774-20" tabindex="-1"></a>  </span>
<span id="cb774-21"><a href="aplikace3.html#cb774-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb774-22"><a href="aplikace3.html#cb774-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb774-23"><a href="aplikace3.html#cb774-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb774-24"><a href="aplikace3.html#cb774-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb774-25"><a href="aplikace3.html#cb774-25" tabindex="-1"></a>  </span>
<span id="cb774-26"><a href="aplikace3.html#cb774-26" tabindex="-1"></a>  <span class="co"># repeat for each part ... k times</span></span>
<span id="cb774-27"><a href="aplikace3.html#cb774-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb774-28"><a href="aplikace3.html#cb774-28" tabindex="-1"></a>    <span class="co"># model for a specific K choice</span></span>
<span id="cb774-29"><a href="aplikace3.html#cb774-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb774-30"><a href="aplikace3.html#cb774-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb774-31"><a href="aplikace3.html#cb774-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb774-32"><a href="aplikace3.html#cb774-32" tabindex="-1"></a>    <span class="co"># prediction on validation part</span></span>
<span id="cb774-33"><a href="aplikace3.html#cb774-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb774-34"><a href="aplikace3.html#cb774-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb774-35"><a href="aplikace3.html#cb774-35" tabindex="-1"></a>    <span class="co"># accuracy on validation part</span></span>
<span id="cb774-36"><a href="aplikace3.html#cb774-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb774-37"><a href="aplikace3.html#cb774-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb774-38"><a href="aplikace3.html#cb774-38" tabindex="-1"></a>    </span>
<span id="cb774-39"><a href="aplikace3.html#cb774-39" tabindex="-1"></a>    <span class="co"># store accuracy at position for given K and fold</span></span>
<span id="cb774-40"><a href="aplikace3.html#cb774-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb774-41"><a href="aplikace3.html#cb774-41" tabindex="-1"></a>  }</span>
<span id="cb774-42"><a href="aplikace3.html#cb774-42" tabindex="-1"></a>}</span>
<span id="cb774-43"><a href="aplikace3.html#cb774-43" tabindex="-1"></a></span>
<span id="cb774-44"><a href="aplikace3.html#cb774-44" tabindex="-1"></a><span class="co"># calculate average accuracy for each K across folds</span></span>
<span id="cb774-45"><a href="aplikace3.html#cb774-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb774-46"><a href="aplikace3.html#cb774-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb774-47"><a href="aplikace3.html#cb774-47" tabindex="-1"></a>optimal.cv.accuracy <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb774-48"><a href="aplikace3.html#cb774-48" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span></code></pre></div>
</details>
<p>We see that the optimal value of the parameter <span class="math inline">\(K\)</span> is 1, with an error rate calculated using 10-fold CV of 0.1478.
For clarity, let’s plot the course of validation error with respect to the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb775"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb775-1"><a href="aplikace3.html#cb775-1" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb775-2"><a href="aplikace3.html#cb775-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb775-3"><a href="aplikace3.html#cb775-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb775-4"><a href="aplikace3.html#cb775-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> optimal.cv.accuracy), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb775-5"><a href="aplikace3.html#cb775-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb775-6"><a href="aplikace3.html#cb775-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb775-7"><a href="aplikace3.html#cb775-7" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb775-8"><a href="aplikace3.html#cb775-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb775-9"><a href="aplikace3.html#cb775-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - optimal.cv.accuracy), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 26 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-16-1.png" alt="Dependence of validation error on the value of $K$, i.e., on the number of neighbors." width="672" />
<p class="caption">
Figure 1.7: Dependence of validation error on the value of <span class="math inline">\(K\)</span>, i.e., on the number of neighbors.
</p>
</div>
<p>Now that we know the optimal value of parameter <span class="math inline">\(K\)</span>, we can build the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb777"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb777-1"><a href="aplikace3.html#cb777-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb777-2"><a href="aplikace3.html#cb777-2" tabindex="-1"></a></span>
<span id="cb777-3"><a href="aplikace3.html#cb777-3" tabindex="-1"></a><span class="co"># prediction</span></span>
<span id="cb777-4"><a href="aplikace3.html#cb777-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb777-5"><a href="aplikace3.html#cb777-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb777-6"><a href="aplikace3.html#cb777-6" tabindex="-1"></a></span>
<span id="cb777-7"><a href="aplikace3.html#cb777-7" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb777-8"><a href="aplikace3.html#cb777-8" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb777-9"><a href="aplikace3.html#cb777-9" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb777-10"><a href="aplikace3.html#cb777-10" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb777-11"><a href="aplikace3.html#cb777-11" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we see that the error rate of the model built using the <span class="math inline">\(K\)</span> nearest neighbors method with the optimal choice of <span class="math inline">\(K_{optimal}\)</span> equal to 1, determined by cross-validation, is 0.1467 on the training data and 0.1692 on the test data.</p>
<p>To compare different models, we can use both types of error rates, and for clarity, we will store them in a table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb778"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb778-1"><a href="aplikace3.html#cb778-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb778-2"><a href="aplikace3.html#cb778-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb778-3"><a href="aplikace3.html#cb778-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-5" class="section level3 hasAnchor" number="6.3.2">
<h3><span class="header-section-number">6.3.2</span> Linear Discriminant Analysis<a href="aplikace3.html#linear-discriminant-analysis-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a second method for constructing a classifier, we will consider linear discriminant analysis (LDA).
Since this method cannot be applied to functional data directly, we first need to discretize the data, which we will do using functional principal component analysis.
The classification algorithm will then be performed on the scores of the first <span class="math inline">\(p\)</span> principal components.
The number of components <span class="math inline">\(p\)</span> is chosen so that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>Let’s start by performing functional principal component analysis and determining the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb779"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb779-1"><a href="aplikace3.html#cb779-1" tabindex="-1"></a><span class="co"># principal component analysis</span></span>
<span id="cb779-2"><a href="aplikace3.html#cb779-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of PCs</span></span>
<span id="cb779-3"><a href="aplikace3.html#cb779-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determining p</span></span>
<span id="cb779-4"><a href="aplikace3.html#cb779-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># to allow plotting graphs,</span></span>
<span id="cb779-5"><a href="aplikace3.html#cb779-5" tabindex="-1"></a><span class="co"># we need at least 2 PCs</span></span>
<span id="cb779-6"><a href="aplikace3.html#cb779-6" tabindex="-1"></a></span>
<span id="cb779-7"><a href="aplikace3.html#cb779-7" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb779-8"><a href="aplikace3.html#cb779-8" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of first p PCs</span></span>
<span id="cb779-9"><a href="aplikace3.html#cb779-9" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># class membership</span></span></code></pre></div>
</details>
<p>In this specific case, we selected <span class="math inline">\(p=\)</span> 2 as the number of principal components, which together explain 99.57 <span class="math inline">\(\%\)</span> of the variability in the data.
The first principal component explains 98.47 % and the second 1.09 <span class="math inline">\(\%\)</span> of the variability.
Graphically, we can display the scores of the first two principal components, with points colored according to class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb780"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb780-1"><a href="aplikace3.html#cb780-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb780-2"><a href="aplikace3.html#cb780-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb780-3"><a href="aplikace3.html#cb780-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb780-4"><a href="aplikace3.html#cb780-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb780-5"><a href="aplikace3.html#cb780-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb780-6"><a href="aplikace3.html#cb780-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb780-7"><a href="aplikace3.html#cb780-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb780-8"><a href="aplikace3.html#cb780-8" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb780-9"><a href="aplikace3.html#cb780-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-20"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-20-1.png" alt="Scores of the first two principal components for the training data, with points colored by class membership." width="672" />
<p class="caption">
Figure 6.5: Scores of the first two principal components for the training data, with points colored by class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to calculate the scores for the first 2 principal components for the test data.
These scores are calculated using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t) \, \text{dt},
\]</span>
where <span class="math inline">\(\mu(t)\)</span> is the mean (average function) and <span class="math inline">\(\rho_j(t)\)</span> are the eigenfunctions (functional principal components).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb781"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb781-1"><a href="aplikace3.html#cb781-1" tabindex="-1"></a><span class="co"># score calculation for test functions</span></span>
<span id="cb781-2"><a href="aplikace3.html#cb781-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix</span></span>
<span id="cb781-3"><a href="aplikace3.html#cb781-3" tabindex="-1"></a></span>
<span id="cb781-4"><a href="aplikace3.html#cb781-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb781-5"><a href="aplikace3.html#cb781-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb781-6"><a href="aplikace3.html#cb781-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb781-7"><a href="aplikace3.html#cb781-7" tabindex="-1"></a>  <span class="co"># scalar product of residual and eigenfunctions rho (functional principal components)</span></span>
<span id="cb781-8"><a href="aplikace3.html#cb781-8" tabindex="-1"></a>}</span>
<span id="cb781-9"><a href="aplikace3.html#cb781-9" tabindex="-1"></a></span>
<span id="cb781-10"><a href="aplikace3.html#cb781-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb781-11"><a href="aplikace3.html#cb781-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb781-12"><a href="aplikace3.html#cb781-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb782"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb782-1"><a href="aplikace3.html#cb782-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb782-2"><a href="aplikace3.html#cb782-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb782-3"><a href="aplikace3.html#cb782-3" tabindex="-1"></a></span>
<span id="cb782-4"><a href="aplikace3.html#cb782-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb782-5"><a href="aplikace3.html#cb782-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb782-6"><a href="aplikace3.html#cb782-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb782-7"><a href="aplikace3.html#cb782-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb782-8"><a href="aplikace3.html#cb782-8" tabindex="-1"></a>  </span>
<span id="cb782-9"><a href="aplikace3.html#cb782-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb782-10"><a href="aplikace3.html#cb782-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb782-11"><a href="aplikace3.html#cb782-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb782-12"><a href="aplikace3.html#cb782-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (32 %) and on the test data (29.23 %).</p>
<p>For a graphical representation of the method, we can add the decision boundary to the plot of the scores of the first two principal components. This boundary is calculated on a dense grid of points and displayed using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb783"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb783-1"><a href="aplikace3.html#cb783-1" tabindex="-1"></a><span class="co"># add discriminant boundary</span></span>
<span id="cb783-2"><a href="aplikace3.html#cb783-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb783-3"><a href="aplikace3.html#cb783-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb783-4"><a href="aplikace3.html#cb783-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb783-5"><a href="aplikace3.html#cb783-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb783-6"><a href="aplikace3.html#cb783-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb783-7"><a href="aplikace3.html#cb783-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb783-8"><a href="aplikace3.html#cb783-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb783-9"><a href="aplikace3.html#cb783-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb783-10"><a href="aplikace3.html#cb783-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb783-11"><a href="aplikace3.html#cb783-11" tabindex="-1"></a><span class="co"># if p = 3</span></span>
<span id="cb783-12"><a href="aplikace3.html#cb783-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb783-13"><a href="aplikace3.html#cb783-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb783-14"><a href="aplikace3.html#cb783-14" tabindex="-1"></a><span class="co"># if p = 4</span></span>
<span id="cb783-15"><a href="aplikace3.html#cb783-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb783-16"><a href="aplikace3.html#cb783-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb783-17"><a href="aplikace3.html#cb783-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb783-18"><a href="aplikace3.html#cb783-18" tabindex="-1"></a><span class="co"># if p = 5</span></span>
<span id="cb783-19"><a href="aplikace3.html#cb783-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb783-20"><a href="aplikace3.html#cb783-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb783-21"><a href="aplikace3.html#cb783-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb783-22"><a href="aplikace3.html#cb783-22" tabindex="-1"></a></span>
<span id="cb783-23"><a href="aplikace3.html#cb783-23" tabindex="-1"></a><span class="co"># add Y = 0, 1</span></span>
<span id="cb783-24"><a href="aplikace3.html#cb783-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb783-25"><a href="aplikace3.html#cb783-25" tabindex="-1"></a></span>
<span id="cb783-26"><a href="aplikace3.html#cb783-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb783-27"><a href="aplikace3.html#cb783-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb783-28"><a href="aplikace3.html#cb783-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb783-29"><a href="aplikace3.html#cb783-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb783-30"><a href="aplikace3.html#cb783-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb783-31"><a href="aplikace3.html#cb783-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb783-32"><a href="aplikace3.html#cb783-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb783-33"><a href="aplikace3.html#cb783-33" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb783-34"><a href="aplikace3.html#cb783-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb783-35"><a href="aplikace3.html#cb783-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-23-1.png" alt="Scores of the first two principal components, colored by classification class. The black line represents the decision boundary (a line in the plane of the first two principal components) between classes constructed using LDA." width="672" />
<p class="caption">
Figure 1.8: Scores of the first two principal components, colored by classification class. The black line represents the decision boundary (a line in the plane of the first two principal components) between classes constructed using LDA.
</p>
</div>
<p>We observe that the decision boundary is a line, a linear function in the 2D space, as expected with LDA.
Finally, we add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb784"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb784-1"><a href="aplikace3.html#cb784-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb784-2"><a href="aplikace3.html#cb784-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb784-3"><a href="aplikace3.html#cb784-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb784-4"><a href="aplikace3.html#cb784-4" tabindex="-1"></a></span>
<span id="cb784-5"><a href="aplikace3.html#cb784-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-5" class="section level3 hasAnchor" number="6.3.3">
<h3><span class="header-section-number">6.3.3</span> Quadratic Discriminant Analysis<a href="aplikace3.html#quadratic-discriminant-analysis-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s construct a classifier using Quadratic Discriminant Analysis (QDA).
This approach is analogous to LDA, with the difference that we now allow for each class to have a distinct covariance matrix for the normal distribution from which the respective scores originate.
This relaxed assumption of equal covariance matrices results in a quadratic boundary between classes.</p>
<p>In <code>R</code>, QDA is performed similarly to LDA as shown in the previous section; that is, we would calculate scores for both training and test functions using functional principal component analysis, construct a classifier on the scores of the first <span class="math inline">\(p\)</span> principal components, and use it to predict the class membership of test curves in <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>We don’t need to perform functional PCA again, as we can use the results from the LDA section.</p>
<p>We can now proceed directly to constructing the classifier using the <code>qda()</code> function.
We then calculate the classifier’s accuracy on the training and test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb785"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb785-1"><a href="aplikace3.html#cb785-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb785-2"><a href="aplikace3.html#cb785-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb785-3"><a href="aplikace3.html#cb785-3" tabindex="-1"></a></span>
<span id="cb785-4"><a href="aplikace3.html#cb785-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb785-5"><a href="aplikace3.html#cb785-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb785-6"><a href="aplikace3.html#cb785-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb785-7"><a href="aplikace3.html#cb785-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb785-8"><a href="aplikace3.html#cb785-8" tabindex="-1"></a>  </span>
<span id="cb785-9"><a href="aplikace3.html#cb785-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb785-10"><a href="aplikace3.html#cb785-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb785-11"><a href="aplikace3.html#cb785-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb785-12"><a href="aplikace3.html#cb785-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (32 %) and on the test data (30.77 %).</p>
<p>For a graphical representation of the method, we can add the decision boundary to the plot of the scores of the first two principal components. This boundary is calculated on a dense grid of points and displayed using the <code>geom_contour()</code> function, as we did for LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb786"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb786-1"><a href="aplikace3.html#cb786-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb786-2"><a href="aplikace3.html#cb786-2" tabindex="-1"></a></span>
<span id="cb786-3"><a href="aplikace3.html#cb786-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb786-4"><a href="aplikace3.html#cb786-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb786-5"><a href="aplikace3.html#cb786-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb786-6"><a href="aplikace3.html#cb786-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb786-7"><a href="aplikace3.html#cb786-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb786-8"><a href="aplikace3.html#cb786-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb786-9"><a href="aplikace3.html#cb786-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb786-10"><a href="aplikace3.html#cb786-10" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb786-11"><a href="aplikace3.html#cb786-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb786-12"><a href="aplikace3.html#cb786-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-29-1.png" alt="Scores of the first two principal components, colored by classification class. The black line represents the decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA." width="672" />
<p class="caption">
Figure 5.3: Scores of the first two principal components, colored by classification class. The black line represents the decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA.
</p>
</div>
<p>Notice that the decision boundary between the classification classes is now a parabola.</p>
<p>Finally, we add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb787"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb787-1"><a href="aplikace3.html#cb787-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb787-2"><a href="aplikace3.html#cb787-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb787-3"><a href="aplikace3.html#cb787-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb787-4"><a href="aplikace3.html#cb787-4" tabindex="-1"></a></span>
<span id="cb787-5"><a href="aplikace3.html#cb787-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-5" class="section level3 hasAnchor" number="6.3.4">
<h3><span class="header-section-number">6.3.4</span> Logistic Regression<a href="aplikace3.html#logistic-regression-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression can be performed in two ways:
either by using the functional equivalent of traditional logistic regression or by applying classical multivariate logistic regression on the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-5" class="section level4 hasAnchor" number="6.3.4.1">
<h4><span class="header-section-number">6.3.4.1</span> Functional Logistic Regression<a href="aplikace3.html#functional-logistic-regression-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analogously to the finite-dimensional case, we consider a logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span>
where <span class="math inline">\(\eta(x)\)</span> is the linear predictor with values in the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em> (in the case of logistic regression, it is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>), and <span class="math inline">\(\pi(x)\)</span> is the conditional probability</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant, and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is the parameter function. Our objective is to estimate this parameter function.</p>
<p>For functional logistic regression, we use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package.
First, we create appropriate objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb788"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb788-1"><a href="aplikace3.html#cb788-1" tabindex="-1"></a><span class="co"># Create appropriate objects</span></span>
<span id="cb788-2"><a href="aplikace3.html#cb788-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb788-3"><a href="aplikace3.html#cb788-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train) </span>
<span id="cb788-4"><a href="aplikace3.html#cb788-4" tabindex="-1"></a></span>
<span id="cb788-5"><a href="aplikace3.html#cb788-5" tabindex="-1"></a><span class="co"># Points where the functions are evaluated</span></span>
<span id="cb788-6"><a href="aplikace3.html#cb788-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb788-7"><a href="aplikace3.html#cb788-7" tabindex="-1"></a></span>
<span id="cb788-8"><a href="aplikace3.html#cb788-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb788-9"><a href="aplikace3.html#cb788-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb788-10"><a href="aplikace3.html#cb788-10" tabindex="-1"></a></span>
<span id="cb788-11"><a href="aplikace3.html#cb788-11" tabindex="-1"></a><span class="co"># Choose a basis for the functional observations, typically the same</span></span>
<span id="cb788-12"><a href="aplikace3.html#cb788-12" tabindex="-1"></a><span class="co"># basis used for smoothing curves. However, this choice leads to numerical error,</span></span>
<span id="cb788-13"><a href="aplikace3.html#cb788-13" tabindex="-1"></a><span class="co"># so we choose a basis with fewer functions. </span></span>
<span id="cb788-14"><a href="aplikace3.html#cb788-14" tabindex="-1"></a><span class="co"># After trying several options, 7 functions appear to be sufficient.</span></span>
<span id="cb788-15"><a href="aplikace3.html#cb788-15" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb788-16"><a href="aplikace3.html#cb788-16" tabindex="-1"></a></span>
<span id="cb788-17"><a href="aplikace3.html#cb788-17" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb788-18"><a href="aplikace3.html#cb788-18" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt),</span>
<span id="cb788-19"><a href="aplikace3.html#cb788-19" tabindex="-1"></a>                               <span class="at">norder =</span> <span class="dv">4</span>,</span>
<span id="cb788-20"><a href="aplikace3.html#cb788-20" tabindex="-1"></a>                               <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<p>To estimate the parameter function <span class="math inline">\(\beta(t)\)</span>, we need to express it in a basis representation—in our case, a B-spline basis.
However, we need to determine the appropriate number of basis functions. This could be decided based on the training error, but the training data will favor a larger number of bases, leading to model overfitting.</p>
<p>To illustrate this, let’s train a model on the training data for each basis count <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 30\}\)</span>, calculate the training error, and also compute the test error.
Note that to determine the optimal number of basis functions, we cannot use the same data as those for estimating the test error, as this would underestimate the error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb789"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb789-1"><a href="aplikace3.html#cb789-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb789-2"><a href="aplikace3.html#cb789-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb789-3"><a href="aplikace3.html#cb789-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb789-4"><a href="aplikace3.html#cb789-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb789-5"><a href="aplikace3.html#cb789-5" tabindex="-1"></a></span>
<span id="cb789-6"><a href="aplikace3.html#cb789-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb789-7"><a href="aplikace3.html#cb789-7" tabindex="-1"></a>  <span class="co"># Basis for beta</span></span>
<span id="cb789-8"><a href="aplikace3.html#cb789-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb789-9"><a href="aplikace3.html#cb789-9" tabindex="-1"></a>  <span class="co"># Relationship</span></span>
<span id="cb789-10"><a href="aplikace3.html#cb789-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb789-11"><a href="aplikace3.html#cb789-11" tabindex="-1"></a>  <span class="co"># Basis for x and beta</span></span>
<span id="cb789-12"><a href="aplikace3.html#cb789-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># Smoothed data</span></span>
<span id="cb789-13"><a href="aplikace3.html#cb789-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb789-14"><a href="aplikace3.html#cb789-14" tabindex="-1"></a>  <span class="co"># Model input data</span></span>
<span id="cb789-15"><a href="aplikace3.html#cb789-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb789-16"><a href="aplikace3.html#cb789-16" tabindex="-1"></a>  <span class="co"># Binomial model ... logistic regression model</span></span>
<span id="cb789-17"><a href="aplikace3.html#cb789-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb789-18"><a href="aplikace3.html#cb789-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb789-19"><a href="aplikace3.html#cb789-19" tabindex="-1"></a>  </span>
<span id="cb789-20"><a href="aplikace3.html#cb789-20" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb789-21"><a href="aplikace3.html#cb789-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb789-22"><a href="aplikace3.html#cb789-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb789-23"><a href="aplikace3.html#cb789-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb789-24"><a href="aplikace3.html#cb789-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb789-25"><a href="aplikace3.html#cb789-25" tabindex="-1"></a>    </span>
<span id="cb789-26"><a href="aplikace3.html#cb789-26" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb789-27"><a href="aplikace3.html#cb789-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb789-28"><a href="aplikace3.html#cb789-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb789-29"><a href="aplikace3.html#cb789-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb789-30"><a href="aplikace3.html#cb789-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb789-31"><a href="aplikace3.html#cb789-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb789-32"><a href="aplikace3.html#cb789-32" tabindex="-1"></a>  </span>
<span id="cb789-33"><a href="aplikace3.html#cb789-33" tabindex="-1"></a>  <span class="co"># Insert into matrix</span></span>
<span id="cb789-34"><a href="aplikace3.html#cb789-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb789-35"><a href="aplikace3.html#cb789-35" tabindex="-1"></a>} </span>
<span id="cb789-36"><a href="aplikace3.html#cb789-36" tabindex="-1"></a></span>
<span id="cb789-37"><a href="aplikace3.html#cb789-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb789-38"><a href="aplikace3.html#cb789-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s plot the dependence of both types of errors on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb790"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb790-1"><a href="aplikace3.html#cb790-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb790-2"><a href="aplikace3.html#cb790-2" tabindex="-1"></a></span>
<span id="cb790-3"><a href="aplikace3.html#cb790-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb790-4"><a href="aplikace3.html#cb790-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb790-5"><a href="aplikace3.html#cb790-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb790-6"><a href="aplikace3.html#cb790-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb790-7"><a href="aplikace3.html#cb790-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb790-8"><a href="aplikace3.html#cb790-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb790-9"><a href="aplikace3.html#cb790-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb790-10"><a href="aplikace3.html#cb790-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb790-11"><a href="aplikace3.html#cb790-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb790-12"><a href="aplikace3.html#cb790-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb790-13"><a href="aplikace3.html#cb790-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb790-14"><a href="aplikace3.html#cb790-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb790-15"><a href="aplikace3.html#cb790-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 27 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-33-1.png" alt="Dependence of test and training error on the number of basis functions for $\beta$. The red dot represents the optimal number $n_{optimal}$ chosen as the minimum test error, with the test error shown by the black line and training error by the blue dashed line." width="672" />
<p class="caption">
Figure 5.4: Dependence of test and training error on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red dot represents the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum test error, with the test error shown by the black line and training error by the blue dashed line.
</p>
</div>
<p>We can see that with an increasing number of basis functions for <span class="math inline">\(\beta(t)\)</span>, the training error (blue line) tends to decrease, suggesting we would choose large values of <span class="math inline">\(n_{basis}\)</span>.
However, the optimal choice based on the test error is <span class="math inline">\(n\)</span> equal to 6, which is significantly smaller than 30.
As <span class="math inline">\(n\)</span> increases, the test error rises, indicating model overfitting.</p>
<p>To determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>, we will use 10-fold cross-validation. The maximum number of considered basis functions is set to 25, as we observed earlier that values above this lead to overfitting.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb793"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb793-1"><a href="aplikace3.html#cb793-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb793-2"><a href="aplikace3.html#cb793-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb793-3"><a href="aplikace3.html#cb793-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb793-4"><a href="aplikace3.html#cb793-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb793-5"><a href="aplikace3.html#cb793-5" tabindex="-1"></a><span class="co"># divide training data into k parts</span></span>
<span id="cb793-6"><a href="aplikace3.html#cb793-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb793-7"><a href="aplikace3.html#cb793-7" tabindex="-1"></a><span class="do">## elements that remain unchanged during the cycle</span></span>
<span id="cb793-8"><a href="aplikace3.html#cb793-8" tabindex="-1"></a><span class="co"># points where functions are evaluated</span></span>
<span id="cb793-9"><a href="aplikace3.html#cb793-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb793-10"><a href="aplikace3.html#cb793-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb793-11"><a href="aplikace3.html#cb793-11" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb793-12"><a href="aplikace3.html#cb793-12" tabindex="-1"></a><span class="co"># basis1 &lt;- create.bspline.basis(rangeval = range(tt), nbasis = nbasis.x)</span></span>
<span id="cb793-13"><a href="aplikace3.html#cb793-13" tabindex="-1"></a><span class="co"># relationship</span></span>
<span id="cb793-14"><a href="aplikace3.html#cb793-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb793-15"><a href="aplikace3.html#cb793-15" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb793-16"><a href="aplikace3.html#cb793-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb793-17"><a href="aplikace3.html#cb793-17" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb793-18"><a href="aplikace3.html#cb793-18" tabindex="-1"></a><span class="co"># columns contain accuracy values for each part of the training set</span></span>
<span id="cb793-19"><a href="aplikace3.html#cb793-19" tabindex="-1"></a><span class="co"># rows contain values for each basis count</span></span>
<span id="cb793-20"><a href="aplikace3.html#cb793-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb793-21"><a href="aplikace3.html#cb793-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now we are ready to compute the error for each of the ten subsets of the training set. Next, we determine the average and take the argument of the minimum validation error as the optimal <span class="math inline">\(n\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb794"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb794-1"><a href="aplikace3.html#cb794-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb794-2"><a href="aplikace3.html#cb794-2" tabindex="-1"></a>  <span class="co"># define the index subset</span></span>
<span id="cb794-3"><a href="aplikace3.html#cb794-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb794-4"><a href="aplikace3.html#cb794-4" tabindex="-1"></a>    </span>
<span id="cb794-5"><a href="aplikace3.html#cb794-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb794-6"><a href="aplikace3.html#cb794-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb794-7"><a href="aplikace3.html#cb794-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb794-8"><a href="aplikace3.html#cb794-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb794-9"><a href="aplikace3.html#cb794-9" tabindex="-1"></a>  </span>
<span id="cb794-10"><a href="aplikace3.html#cb794-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb794-11"><a href="aplikace3.html#cb794-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb794-12"><a href="aplikace3.html#cb794-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb794-13"><a href="aplikace3.html#cb794-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb794-14"><a href="aplikace3.html#cb794-14" tabindex="-1"></a>  </span>
<span id="cb794-15"><a href="aplikace3.html#cb794-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb794-16"><a href="aplikace3.html#cb794-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb794-17"><a href="aplikace3.html#cb794-17" tabindex="-1"></a>  </span>
<span id="cb794-18"><a href="aplikace3.html#cb794-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb794-19"><a href="aplikace3.html#cb794-19" tabindex="-1"></a>    <span class="co"># basis for betas</span></span>
<span id="cb794-20"><a href="aplikace3.html#cb794-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb794-21"><a href="aplikace3.html#cb794-21" tabindex="-1"></a>    </span>
<span id="cb794-22"><a href="aplikace3.html#cb794-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb794-23"><a href="aplikace3.html#cb794-23" tabindex="-1"></a>    <span class="co"># input data for the model</span></span>
<span id="cb794-24"><a href="aplikace3.html#cb794-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb794-25"><a href="aplikace3.html#cb794-25" tabindex="-1"></a>    <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb794-26"><a href="aplikace3.html#cb794-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb794-27"><a href="aplikace3.html#cb794-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb794-28"><a href="aplikace3.html#cb794-28" tabindex="-1"></a>    </span>
<span id="cb794-29"><a href="aplikace3.html#cb794-29" tabindex="-1"></a>    <span class="co"># accuracy on the validation set </span></span>
<span id="cb794-30"><a href="aplikace3.html#cb794-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb794-31"><a href="aplikace3.html#cb794-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb794-32"><a href="aplikace3.html#cb794-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb794-33"><a href="aplikace3.html#cb794-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb794-34"><a href="aplikace3.html#cb794-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb794-35"><a href="aplikace3.html#cb794-35" tabindex="-1"></a>    </span>
<span id="cb794-36"><a href="aplikace3.html#cb794-36" tabindex="-1"></a>    <span class="co"># insert into the matrix</span></span>
<span id="cb794-37"><a href="aplikace3.html#cb794-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb794-38"><a href="aplikace3.html#cb794-38" tabindex="-1"></a>  } </span>
<span id="cb794-39"><a href="aplikace3.html#cb794-39" tabindex="-1"></a>}</span>
<span id="cb794-40"><a href="aplikace3.html#cb794-40" tabindex="-1"></a></span>
<span id="cb794-41"><a href="aplikace3.html#cb794-41" tabindex="-1"></a><span class="co"># calculate average accuracy for each n across folds</span></span>
<span id="cb794-42"><a href="aplikace3.html#cb794-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb794-43"><a href="aplikace3.html#cb794-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb794-44"><a href="aplikace3.html#cb794-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span></code></pre></div>
</details>
<p>Let’s plot the course of validation error with the optimal value <span class="math inline">\(n_{optimal}\)</span> marked, which is 19 with a validation error of 0.0604.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb795"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb795-1"><a href="aplikace3.html#cb795-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb795-2"><a href="aplikace3.html#cb795-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb795-3"><a href="aplikace3.html#cb795-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb795-4"><a href="aplikace3.html#cb795-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb795-5"><a href="aplikace3.html#cb795-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb795-6"><a href="aplikace3.html#cb795-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb795-7"><a href="aplikace3.html#cb795-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb795-8"><a href="aplikace3.html#cb795-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb795-9"><a href="aplikace3.html#cb795-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb795-10"><a href="aplikace3.html#cb795-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis) <span class="sc">+</span> </span>
<span id="cb795-11"><a href="aplikace3.html#cb795-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 22 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-36-1.png" alt="Dependence of validation error on the value of $n_{basis}$, i.e., the number of bases." width="672" />
<p class="caption">
Figure 1.11: Dependence of validation error on the value of <span class="math inline">\(n_{basis}\)</span>, i.e., the number of bases.
</p>
</div>
<p>We can now define the final model using functional logistic regression, choosing the B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 19 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb797"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb797-1"><a href="aplikace3.html#cb797-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb797-2"><a href="aplikace3.html#cb797-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb797-3"><a href="aplikace3.html#cb797-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb797-4"><a href="aplikace3.html#cb797-4" tabindex="-1"></a><span class="co"># basis for x and betas</span></span>
<span id="cb797-5"><a href="aplikace3.html#cb797-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb797-6"><a href="aplikace3.html#cb797-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb797-7"><a href="aplikace3.html#cb797-7" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb797-8"><a href="aplikace3.html#cb797-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb797-9"><a href="aplikace3.html#cb797-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb797-10"><a href="aplikace3.html#cb797-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb797-11"><a href="aplikace3.html#cb797-11" tabindex="-1"></a><span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb797-12"><a href="aplikace3.html#cb797-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb797-13"><a href="aplikace3.html#cb797-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b,</span>
<span id="cb797-14"><a href="aplikace3.html#cb797-14" tabindex="-1"></a>                        <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">epsilon =</span> <span class="fl">1e-2</span>)</span>
<span id="cb797-15"><a href="aplikace3.html#cb797-15" tabindex="-1"></a></span>
<span id="cb797-16"><a href="aplikace3.html#cb797-16" tabindex="-1"></a><span class="co"># accuracy on the training data</span></span>
<span id="cb797-17"><a href="aplikace3.html#cb797-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb797-18"><a href="aplikace3.html#cb797-18" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb797-19"><a href="aplikace3.html#cb797-19" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb797-20"><a href="aplikace3.html#cb797-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb797-21"><a href="aplikace3.html#cb797-21" tabindex="-1"></a>  </span>
<span id="cb797-22"><a href="aplikace3.html#cb797-22" tabindex="-1"></a><span class="co"># accuracy on the test data</span></span>
<span id="cb797-23"><a href="aplikace3.html#cb797-23" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb797-24"><a href="aplikace3.html#cb797-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb797-25"><a href="aplikace3.html#cb797-25" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb797-26"><a href="aplikace3.html#cb797-26" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb797-27"><a href="aplikace3.html#cb797-27" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the training error (which is 0 %) and the test error (which is 9.23 %). To gain a better understanding, we can plot the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> on the training data as a function of the linear predictor values.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb798"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb798-1"><a href="aplikace3.html#cb798-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb798-2"><a href="aplikace3.html#cb798-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb798-3"><a href="aplikace3.html#cb798-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb798-4"><a href="aplikace3.html#cb798-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb798-5"><a href="aplikace3.html#cb798-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb798-6"><a href="aplikace3.html#cb798-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb798-7"><a href="aplikace3.html#cb798-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb798-8"><a href="aplikace3.html#cb798-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb798-9"><a href="aplikace3.html#cb798-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb798-10"><a href="aplikace3.html#cb798-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb798-11"><a href="aplikace3.html#cb798-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probabilities Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb798-12"><a href="aplikace3.html#cb798-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-38"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-38-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are colored based on their classification class." width="672" />
<p class="caption">
Figure 6.6: Dependence of estimated probabilities on the values of the linear predictor. Points are colored based on their classification class.
</p>
</div>
<p>Additionally, we can display the course of the estimated parametric function <span class="math inline">\(\beta(t)\)</span> for reference.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb799"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb799-1"><a href="aplikace3.html#cb799-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb799-2"><a href="aplikace3.html#cb799-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb799-3"><a href="aplikace3.html#cb799-3" tabindex="-1"></a></span>
<span id="cb799-4"><a href="aplikace3.html#cb799-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span></span>
<span id="cb799-5"><a href="aplikace3.html#cb799-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span></span>
<span id="cb799-6"><a href="aplikace3.html#cb799-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb799-7"><a href="aplikace3.html#cb799-7" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb799-8"><a href="aplikace3.html#cb799-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span></span>
<span id="cb799-9"><a href="aplikace3.html#cb799-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb799-10"><a href="aplikace3.html#cb799-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb799-11"><a href="aplikace3.html#cb799-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span></span>
<span id="cb799-12"><a href="aplikace3.html#cb799-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb799-13"><a href="aplikace3.html#cb799-13" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-39-1.png" alt="Course of the estimated parametric function $\beta(t), t \in [850, 1050]$." width="672" />
<p class="caption">
Figure 4.1: Course of the estimated parametric function <span class="math inline">\(\beta(t), t \in [850, 1050]\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb800"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb800-1"><a href="aplikace3.html#cb800-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(tt), <span class="fu">max</span>(tt), <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb800-2"><a href="aplikace3.html#cb800-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb800-3"><a href="aplikace3.html#cb800-3" tabindex="-1"></a></span>
<span id="cb800-4"><a href="aplikace3.html#cb800-4" tabindex="-1"></a><span class="co"># data.frame(t = t.seq, beta = beta.seq) |&gt; </span></span>
<span id="cb800-5"><a href="aplikace3.html#cb800-5" tabindex="-1"></a><span class="co">#   ggplot(aes(t, beta)) + </span></span>
<span id="cb800-6"><a href="aplikace3.html#cb800-6" tabindex="-1"></a><span class="co">#   geom_abline(aes(slope = 0, intercept = 0), linetype = &#39;dashed&#39;, </span></span>
<span id="cb800-7"><a href="aplikace3.html#cb800-7" tabindex="-1"></a><span class="co">#               linewidth = 0.5, colour = &#39;grey&#39;) +</span></span>
<span id="cb800-8"><a href="aplikace3.html#cb800-8" tabindex="-1"></a><span class="co">#   geom_line(colour = &#39;deepskyblue2&#39;, linewidth = 0.8) + </span></span>
<span id="cb800-9"><a href="aplikace3.html#cb800-9" tabindex="-1"></a><span class="co">#   theme_bw() +</span></span>
<span id="cb800-10"><a href="aplikace3.html#cb800-10" tabindex="-1"></a><span class="co">#   labs(x = expression(t),</span></span>
<span id="cb800-11"><a href="aplikace3.html#cb800-11" tabindex="-1"></a><span class="co">#        y = expression(widehat(beta)(t))) + </span></span>
<span id="cb800-12"><a href="aplikace3.html#cb800-12" tabindex="-1"></a><span class="co">#   theme(panel.grid.major = element_blank(),</span></span>
<span id="cb800-13"><a href="aplikace3.html#cb800-13" tabindex="-1"></a><span class="co">#         panel.grid.minor = element_blank())</span></span>
<span id="cb800-14"><a href="aplikace3.html#cb800-14" tabindex="-1"></a><span class="co"># </span></span>
<span id="cb800-15"><a href="aplikace3.html#cb800-15" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/betahat_presentation.tex&quot;, width = 4, height = 2.5,</span></span>
<span id="cb800-16"><a href="aplikace3.html#cb800-16" tabindex="-1"></a><span class="co">#        device = tikz)</span></span></code></pre></div>
</details>
<p>Finally, we will add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb801"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb801-1"><a href="aplikace3.html#cb801-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb801-2"><a href="aplikace3.html#cb801-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb801-3"><a href="aplikace3.html#cb801-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb801-4"><a href="aplikace3.html#cb801-4" tabindex="-1"></a></span>
<span id="cb801-5"><a href="aplikace3.html#cb801-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-with-principal-component-analysis-3" class="section level4 hasAnchor" number="6.3.4.2">
<h4><span class="header-section-number">6.3.4.2</span> Logistic Regression with Principal Component Analysis<a href="aplikace3.html#logistic-regression-with-principal-component-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To construct this classifier, we need to perform functional principal component analysis, determine the appropriate number of components, and calculate the score values for the test data. We have already done this in the linear discriminant analysis section, so we will utilize these results in the following part.</p>
<p>We can now directly build the logistic regression model using the <code>glm(, family = binomial)</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb802"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb802-1"><a href="aplikace3.html#cb802-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb802-2"><a href="aplikace3.html#cb802-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb802-3"><a href="aplikace3.html#cb802-3" tabindex="-1"></a></span>
<span id="cb802-4"><a href="aplikace3.html#cb802-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb802-5"><a href="aplikace3.html#cb802-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb802-6"><a href="aplikace3.html#cb802-6" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb802-7"><a href="aplikace3.html#cb802-7" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb802-8"><a href="aplikace3.html#cb802-8" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb802-9"><a href="aplikace3.html#cb802-9" tabindex="-1"></a></span>
<span id="cb802-10"><a href="aplikace3.html#cb802-10" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb802-11"><a href="aplikace3.html#cb802-11" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb802-12"><a href="aplikace3.html#cb802-12" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb802-13"><a href="aplikace3.html#cb802-13" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb802-14"><a href="aplikace3.html#cb802-14" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we have calculated the error rate of the classifier on the training data (30.67 %) and on the test data (29.23 %).</p>
<p>For graphical representation of the method, we can mark the decision boundary in the score plot of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, as we did in the case of LDA and QDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb803"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb803-1"><a href="aplikace3.html#cb803-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb803-2"><a href="aplikace3.html#cb803-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb803-3"><a href="aplikace3.html#cb803-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb803-4"><a href="aplikace3.html#cb803-4" tabindex="-1"></a></span>
<span id="cb803-5"><a href="aplikace3.html#cb803-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb803-6"><a href="aplikace3.html#cb803-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb803-7"><a href="aplikace3.html#cb803-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb803-8"><a href="aplikace3.html#cb803-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb803-9"><a href="aplikace3.html#cb803-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb803-10"><a href="aplikace3.html#cb803-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb803-11"><a href="aplikace3.html#cb803-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb803-12"><a href="aplikace3.html#cb803-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="sc">+</span></span>
<span id="cb803-13"><a href="aplikace3.html#cb803-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb803-14"><a href="aplikace3.html#cb803-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-45-1.png" alt="Scores of the first two principal components, colored according to class membership. The decision boundary (a line in the plane of the first two principal components) between classes, constructed using logistic regression, is marked in black." width="672" />
<p class="caption">
Figure 1.14: Scores of the first two principal components, colored according to class membership. The decision boundary (a line in the plane of the first two principal components) between classes, constructed using logistic regression, is marked in black.
</p>
</div>
<p>Notice that the decision boundary between the classification classes is now a line, just like in the case of LDA.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb804"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb804-1"><a href="aplikace3.html#cb804-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb804-2"><a href="aplikace3.html#cb804-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb804-3"><a href="aplikace3.html#cb804-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb804-4"><a href="aplikace3.html#cb804-4" tabindex="-1"></a></span>
<span id="cb804-5"><a href="aplikace3.html#cb804-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="decision-trees-4" class="section level3 hasAnchor" number="6.3.5">
<h3><span class="header-section-number">6.3.5</span> Decision Trees<a href="aplikace3.html#decision-trees-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will explore a very different approach to constructing a classifier compared to methods like LDA or logistic regression. Decision trees are a popular tool for classification, but, similar to some previous methods, they are not directly designed for functional data. However, there are ways to transform functional objects into multidimensional data and then apply decision tree algorithms to them. We can consider the following approaches:</p>
<ul>
<li>An algorithm constructed on basis coefficients,</li>
<li>Utilizing principal component scores,</li>
<li>Discretizing the interval and evaluating the function only at a finite grid of points.</li>
</ul>
<p>We will first focus on interval discretization and then compare the results with the other two approaches to constructing a decision tree.</p>
<div id="interval-discretization-7" class="section level4 hasAnchor" number="6.3.5.1">
<h4><span class="header-section-number">6.3.5.1</span> Interval Discretization<a href="aplikace3.html#interval-discretization-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we need to define the points from the interval <span class="math inline">\(I = [850, 1050]\)</span>, where we will evaluate the functions. Then we will create an object where the rows represent individual (discretized) functions and the columns represent time points. Finally, we will append a column <span class="math inline">\(Y\)</span> containing information about class membership and repeat the same process for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb805"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb805-1"><a href="aplikace3.html#cb805-1" tabindex="-1"></a><span class="co"># sequence of points where we will evaluate the functions</span></span>
<span id="cb805-2"><a href="aplikace3.html#cb805-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb805-3"><a href="aplikace3.html#cb805-3" tabindex="-1"></a>   </span>
<span id="cb805-4"><a href="aplikace3.html#cb805-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb805-5"><a href="aplikace3.html#cb805-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose to have functions in rows</span></span>
<span id="cb805-6"><a href="aplikace3.html#cb805-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb805-7"><a href="aplikace3.html#cb805-7" tabindex="-1"></a></span>
<span id="cb805-8"><a href="aplikace3.html#cb805-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb805-9"><a href="aplikace3.html#cb805-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb805-10"><a href="aplikace3.html#cb805-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can build a decision tree where all times from the <code>t.seq</code> vector will serve as predictors. This classification is not susceptible to multicollinearity, so we do not need to worry about it. We will choose accuracy as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb806"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb806-1"><a href="aplikace3.html#cb806-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb806-2"><a href="aplikace3.html#cb806-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb806-3"><a href="aplikace3.html#cb806-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb806-4"><a href="aplikace3.html#cb806-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb806-5"><a href="aplikace3.html#cb806-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb806-6"><a href="aplikace3.html#cb806-6" tabindex="-1"></a></span>
<span id="cb806-7"><a href="aplikace3.html#cb806-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb806-8"><a href="aplikace3.html#cb806-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb806-9"><a href="aplikace3.html#cb806-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb806-10"><a href="aplikace3.html#cb806-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb806-11"><a href="aplikace3.html#cb806-11" tabindex="-1"></a>  </span>
<span id="cb806-12"><a href="aplikace3.html#cb806-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb806-13"><a href="aplikace3.html#cb806-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb806-14"><a href="aplikace3.html#cb806-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb806-15"><a href="aplikace3.html#cb806-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the classifier on the test data is thus 35.38 %, and on the training data, it is 29.33 %.</p>
<p>We can visualize the decision tree using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color distinctions. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb807"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb807-1"><a href="aplikace3.html#cb807-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb807-2"><a href="aplikace3.html#cb807-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb807-3"><a href="aplikace3.html#cb807-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-49-1.png" alt="Graphical representation of the unpruned decision tree. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red." width="672" />
<p class="caption">
Figure 5.6: Graphical representation of the unpruned decision tree. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb808"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb808-1"><a href="aplikace3.html#cb808-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb808-2"><a href="aplikace3.html#cb808-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display desired information</span></span>
<span id="cb808-3"><a href="aplikace3.html#cb808-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb808-4"><a href="aplikace3.html#cb808-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb808-5"><a href="aplikace3.html#cb808-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb808-6"><a href="aplikace3.html#cb808-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb808-7"><a href="aplikace3.html#cb808-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb808-8"><a href="aplikace3.html#cb808-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-50"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-50-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 6.7: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb809"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb809-1"><a href="aplikace3.html#cb809-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discretization&#39;</span>, </span>
<span id="cb809-2"><a href="aplikace3.html#cb809-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb809-3"><a href="aplikace3.html#cb809-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb809-4"><a href="aplikace3.html#cb809-4" tabindex="-1"></a></span>
<span id="cb809-5"><a href="aplikace3.html#cb809-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-9" class="section level4 hasAnchor" number="6.3.5.2">
<h4><span class="header-section-number">6.3.5.2</span> Principal Component Scores<a href="aplikace3.html#principal-component-scores-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another option for constructing a decision tree is to use principal component scores. Since we have already calculated scores for previous classification methods, we will leverage this knowledge to build a decision tree based on the scores of the first 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb810"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb810-1"><a href="aplikace3.html#cb810-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb810-2"><a href="aplikace3.html#cb810-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb810-3"><a href="aplikace3.html#cb810-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb810-4"><a href="aplikace3.html#cb810-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb810-5"><a href="aplikace3.html#cb810-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb810-6"><a href="aplikace3.html#cb810-6" tabindex="-1"></a></span>
<span id="cb810-7"><a href="aplikace3.html#cb810-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb810-8"><a href="aplikace3.html#cb810-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb810-9"><a href="aplikace3.html#cb810-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb810-10"><a href="aplikace3.html#cb810-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb810-11"><a href="aplikace3.html#cb810-11" tabindex="-1"></a>  </span>
<span id="cb810-12"><a href="aplikace3.html#cb810-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb810-13"><a href="aplikace3.html#cb810-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb810-14"><a href="aplikace3.html#cb810-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb810-15"><a href="aplikace3.html#cb810-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the test data is thus 38.46 %, and on the training data, it is 32.67 %.</p>
<p>We can visualize the decision tree constructed from the principal component scores using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color distinctions. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb811"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb811-1"><a href="aplikace3.html#cb811-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb811-2"><a href="aplikace3.html#cb811-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-53-1.png" alt="Graphical representation of the unpruned decision tree constructed from principal component scores. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red." width="672" />
<p class="caption">
Figure 5.7: Graphical representation of the unpruned decision tree constructed from principal component scores. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb812"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb812-1"><a href="aplikace3.html#cb812-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb812-2"><a href="aplikace3.html#cb812-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display desired information</span></span>
<span id="cb812-3"><a href="aplikace3.html#cb812-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb812-4"><a href="aplikace3.html#cb812-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb812-5"><a href="aplikace3.html#cb812-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb812-6"><a href="aplikace3.html#cb812-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-54"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-54-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 6.8: Final pruned decision tree.
</p>
</div>
<p>Finally, we will add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb813"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb813-1"><a href="aplikace3.html#cb813-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb813-2"><a href="aplikace3.html#cb813-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb813-3"><a href="aplikace3.html#cb813-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb813-4"><a href="aplikace3.html#cb813-4" tabindex="-1"></a></span>
<span id="cb813-5"><a href="aplikace3.html#cb813-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-6" class="section level4 hasAnchor" number="6.3.5.3">
<h4><span class="header-section-number">6.3.5.3</span> Basis Coefficients<a href="aplikace3.html#basis-coefficients-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The last option we will use to construct a decision tree is to utilize coefficients in the representation of functions in B-spline basis.</p>
<p>First, let’s define the necessary data files containing the coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb814"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb814-1"><a href="aplikace3.html#cb814-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb814-2"><a href="aplikace3.html#cb814-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb814-3"><a href="aplikace3.html#cb814-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb814-4"><a href="aplikace3.html#cb814-4" tabindex="-1"></a></span>
<span id="cb814-5"><a href="aplikace3.html#cb814-5" tabindex="-1"></a><span class="co"># testing dataset</span></span>
<span id="cb814-6"><a href="aplikace3.html#cb814-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb814-7"><a href="aplikace3.html#cb814-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now we can build the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb815"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb815-1"><a href="aplikace3.html#cb815-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb815-2"><a href="aplikace3.html#cb815-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb815-3"><a href="aplikace3.html#cb815-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb815-4"><a href="aplikace3.html#cb815-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb815-5"><a href="aplikace3.html#cb815-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb815-6"><a href="aplikace3.html#cb815-6" tabindex="-1"></a></span>
<span id="cb815-7"><a href="aplikace3.html#cb815-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb815-8"><a href="aplikace3.html#cb815-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb815-9"><a href="aplikace3.html#cb815-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb815-10"><a href="aplikace3.html#cb815-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb815-11"><a href="aplikace3.html#cb815-11" tabindex="-1"></a>  </span>
<span id="cb815-12"><a href="aplikace3.html#cb815-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb815-13"><a href="aplikace3.html#cb815-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb815-14"><a href="aplikace3.html#cb815-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb815-15"><a href="aplikace3.html#cb815-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the training data is thus 22.67 %, and on the test data, it is 24.62 %.</p>
<p>We can visualize the decision tree constructed from the B-spline coefficients using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color distinctions. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb816"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb816-1"><a href="aplikace3.html#cb816-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb816-2"><a href="aplikace3.html#cb816-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-58"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-58-1.png" alt="Graphical representation of the unpruned decision tree constructed from basis coefficients. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red." width="672" />
<p class="caption">
Figure 5.8: Graphical representation of the unpruned decision tree constructed from basis coefficients. Nodes corresponding to class 1 are depicted in shades of blue, and those for class 0 in shades of red.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb817"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb817-1"><a href="aplikace3.html#cb817-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb817-2"><a href="aplikace3.html#cb817-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display desired information</span></span>
<span id="cb817-3"><a href="aplikace3.html#cb817-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb817-4"><a href="aplikace3.html#cb817-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb817-5"><a href="aplikace3.html#cb817-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb817-6"><a href="aplikace3.html#cb817-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-59"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-59-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 6.9: Final pruned decision tree.
</p>
</div>
<p>Finally, we will add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb818"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb818-1"><a href="aplikace3.html#cb818-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb818-2"><a href="aplikace3.html#cb818-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb818-3"><a href="aplikace3.html#cb818-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb818-4"><a href="aplikace3.html#cb818-4" tabindex="-1"></a></span>
<span id="cb818-5"><a href="aplikace3.html#cb818-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests-5" class="section level3 hasAnchor" number="6.3.6">
<h3><span class="header-section-number">6.3.6</span> Random Forests<a href="aplikace3.html#random-forests-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A classifier constructed using the random forests method involves building several individual decision trees, which are then combined to create a common classifier through “voting.”</p>
<p>As with decision trees, we have several options regarding which data (finite-dimensional) we will use to construct the model. We will again consider the three approaches discussed earlier. The data files with the relevant variables for all three approaches have already been prepared in the previous section, so we can directly construct the models, calculate the characteristics of the classifier, and add the results to the summary table.</p>
<div id="interval-discretization-8" class="section level4 hasAnchor" number="6.3.6.1">
<h4><span class="header-section-number">6.3.6.1</span> Interval Discretization<a href="aplikace3.html#interval-discretization-8" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the first case, we utilize the evaluation of functions at a grid of points in the interval <span class="math inline">\(I = [850, 1050]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb819"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb819-1"><a href="aplikace3.html#cb819-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb819-2"><a href="aplikace3.html#cb819-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb819-3"><a href="aplikace3.html#cb819-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb819-4"><a href="aplikace3.html#cb819-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb819-5"><a href="aplikace3.html#cb819-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb819-6"><a href="aplikace3.html#cb819-6" tabindex="-1"></a></span>
<span id="cb819-7"><a href="aplikace3.html#cb819-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb819-8"><a href="aplikace3.html#cb819-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb819-9"><a href="aplikace3.html#cb819-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb819-10"><a href="aplikace3.html#cb819-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb819-11"><a href="aplikace3.html#cb819-11" tabindex="-1"></a>  </span>
<span id="cb819-12"><a href="aplikace3.html#cb819-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb819-13"><a href="aplikace3.html#cb819-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb819-14"><a href="aplikace3.html#cb819-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb819-15"><a href="aplikace3.html#cb819-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 2 %, and on the test data, it is 12.31 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb820"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb820-1"><a href="aplikace3.html#cb820-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discretization&#39;</span>, </span>
<span id="cb820-2"><a href="aplikace3.html#cb820-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb820-3"><a href="aplikace3.html#cb820-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb820-4"><a href="aplikace3.html#cb820-4" tabindex="-1"></a></span>
<span id="cb820-5"><a href="aplikace3.html#cb820-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-10" class="section level4 hasAnchor" number="6.3.6.2">
<h4><span class="header-section-number">6.3.6.2</span> Principal Component Scores<a href="aplikace3.html#principal-component-scores-10" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first $p = $ 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb821"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb821-1"><a href="aplikace3.html#cb821-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb821-2"><a href="aplikace3.html#cb821-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb821-3"><a href="aplikace3.html#cb821-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb821-4"><a href="aplikace3.html#cb821-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb821-5"><a href="aplikace3.html#cb821-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb821-6"><a href="aplikace3.html#cb821-6" tabindex="-1"></a></span>
<span id="cb821-7"><a href="aplikace3.html#cb821-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb821-8"><a href="aplikace3.html#cb821-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb821-9"><a href="aplikace3.html#cb821-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb821-10"><a href="aplikace3.html#cb821-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb821-11"><a href="aplikace3.html#cb821-11" tabindex="-1"></a>  </span>
<span id="cb821-12"><a href="aplikace3.html#cb821-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb821-13"><a href="aplikace3.html#cb821-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb821-14"><a href="aplikace3.html#cb821-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb821-15"><a href="aplikace3.html#cb821-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 4.67 %, and on the test data, it is 30.77 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb822"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb822-1"><a href="aplikace3.html#cb822-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb822-2"><a href="aplikace3.html#cb822-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb822-3"><a href="aplikace3.html#cb822-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb822-4"><a href="aplikace3.html#cb822-4" tabindex="-1"></a></span>
<span id="cb822-5"><a href="aplikace3.html#cb822-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-7" class="section level4 hasAnchor" number="6.3.6.3">
<h4><span class="header-section-number">6.3.6.3</span> Basis Coefficients<a href="aplikace3.html#basis-coefficients-7" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use the representation of functions through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb823"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb823-1"><a href="aplikace3.html#cb823-1" tabindex="-1"></a><span class="co"># building the model</span></span>
<span id="cb823-2"><a href="aplikace3.html#cb823-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb823-3"><a href="aplikace3.html#cb823-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb823-4"><a href="aplikace3.html#cb823-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb823-5"><a href="aplikace3.html#cb823-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb823-6"><a href="aplikace3.html#cb823-6" tabindex="-1"></a></span>
<span id="cb823-7"><a href="aplikace3.html#cb823-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb823-8"><a href="aplikace3.html#cb823-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb823-9"><a href="aplikace3.html#cb823-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb823-10"><a href="aplikace3.html#cb823-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb823-11"><a href="aplikace3.html#cb823-11" tabindex="-1"></a>  </span>
<span id="cb823-12"><a href="aplikace3.html#cb823-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb823-13"><a href="aplikace3.html#cb823-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb823-14"><a href="aplikace3.html#cb823-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb823-15"><a href="aplikace3.html#cb823-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 1.33 %, and on the test data, it is 12.31 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb824"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb824-1"><a href="aplikace3.html#cb824-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb824-2"><a href="aplikace3.html#cb824-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb824-3"><a href="aplikace3.html#cb824-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb824-4"><a href="aplikace3.html#cb824-4" tabindex="-1"></a></span>
<span id="cb824-5"><a href="aplikace3.html#cb824-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-6" class="section level3 hasAnchor" number="6.3.7">
<h3><span class="header-section-number">6.3.7</span> Support Vector Machines<a href="aplikace3.html#support-vector-machines-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s take a look at curve classification using the Support Vector Machines (SVM) method. The advantage of this classification method is its computational efficiency, as it uses only a few (often very few) observations to define the decision boundary between classes.</p>
<p>The main advantage of SVM is the use of the so-called <em>kernel trick</em>, which allows us to replace the ordinary scalar product with another scalar product of transformed data, without having to explicitly define this transformation. This results in a generally nonlinear separating boundary between classification classes. A <em>kernel</em> (kernel function) <span class="math inline">\(K\)</span> is a function that satisfies</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span>
where <span class="math inline">\(\phi\)</span> is some (unknown) transformation (feature map), <span class="math inline">\(\mathcal H\)</span> is a Hilbert space, and <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> is some scalar product in this Hilbert space.</p>
<p>In practice, three types of kernel functions are most commonly chosen:</p>
<ul>
<li>Linear kernel – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>Polynomial kernel – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>Radial (Gaussian) kernel – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>For all the above-mentioned kernels, we must choose a constant <span class="math inline">\(C &gt; 0\)</span>, which indicates the penalty for exceeding the decision boundary between classes (inverse regularization parameter). As the value of <span class="math inline">\(C\)</span> increases, the method penalizes misclassified data more and the shape of the boundary less. Conversely, for small values of <span class="math inline">\(C\)</span>, the method does not give much importance to misclassified data but focuses more on penalizing the shape of the boundary. This constant <span class="math inline">\(C\)</span> is typically set to 1 by default, but we can also determine it directly, for example, using cross-validation.</p>
<p>By utilizing cross-validation, we can also determine the optimal values of other hyperparameters, which now depend on our choice of kernel function. In the case of a linear kernel, no other parameters are chosen besides the constant <span class="math inline">\(C\)</span>. For polynomial and radial kernels, we must determine the hyperparameters <span class="math inline">\(\alpha_0, \gamma \text{ and } d\)</span>, whose default values in <code>R</code> are <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{dim(\texttt{data})} \text{ and } d^{default} = 3\)</span>. We typically choose <span class="math inline">\(\alpha_0^{default} = 1\)</span>, as this value yields significantly better results.</p>
<p>When dealing with functional data, we have several options for applying the SVM method. The simplest variant is to use this classification method directly on the discretized function (section <a href="aplikace3.html#diskrA3">6.3.7.2</a>). Another option is to use the scores of the principal components and classify curves based on their representation (section <a href="aplikace3.html#PCA-SVMA3">6.3.7.3</a>). A straightforward variant is to use the representation of curves through the B-spline basis and classify curves based on the coefficients of their representation in this basis (section <a href="aplikace3.html#basis-SVMA3">6.3.7.4</a>).</p>
<p>A more complex consideration leads us to several additional options that utilize the functional nature of the data. One option is to classify not the original curve but its derivative (or second, third derivatives, etc.). Another option is to utilize projections of functions onto a subspace generated, for example, by B-spline functions (section <a href="aplikace3.html#projection-SVMA3">6.3.7.5</a>). The last method we will use for classifying functional data combines projection onto a certain subspace generated by functions (Reproducing Kernel Hilbert Space, RKHS) and classification of the corresponding representation. This method utilizes not only the classical SVM but also SVM for regression, which we elaborate on in section RKHS + SVM (section <a href="aplikace3.html#RKHS-SVMA3">6.3.7.6</a>).</p>
<div id="svm-for-functional-data-4" class="section level4 hasAnchor" number="6.3.7.1">
<h4><span class="header-section-number">6.3.7.1</span> SVM for Functional Data<a href="aplikace3.html#svm-for-functional-data-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the <code>fda.usc</code> library, we will use the function <code>classif.svm()</code> to apply the SVM method directly to functional data. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb825"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb825-1"><a href="aplikace3.html#cb825-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb825-2"><a href="aplikace3.html#cb825-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb825-3"><a href="aplikace3.html#cb825-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb825-4"><a href="aplikace3.html#cb825-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb825-5"><a href="aplikace3.html#cb825-5" tabindex="-1"></a>}</span>
<span id="cb825-6"><a href="aplikace3.html#cb825-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb825-7"><a href="aplikace3.html#cb825-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb825-8"><a href="aplikace3.html#cb825-8" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb825-9"><a href="aplikace3.html#cb825-9" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb825-10"><a href="aplikace3.html#cb825-10" tabindex="-1"></a>    <span class="at">byrow =</span> T)</span>
<span id="cb825-11"><a href="aplikace3.html#cb825-11" tabindex="-1"></a></span>
<span id="cb825-12"><a href="aplikace3.html#cb825-12" tabindex="-1"></a><span class="co"># splitting into test and training parts</span></span>
<span id="cb825-13"><a href="aplikace3.html#cb825-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb825-14"><a href="aplikace3.html#cb825-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb825-15"><a href="aplikace3.html#cb825-15" tabindex="-1"></a></span>
<span id="cb825-16"><a href="aplikace3.html#cb825-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb825-17"><a href="aplikace3.html#cb825-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb826"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb826-1"><a href="aplikace3.html#cb826-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb826-2"><a href="aplikace3.html#cb826-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb826-3"><a href="aplikace3.html#cb826-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb826-4"><a href="aplikace3.html#cb826-4" tabindex="-1"></a></span>
<span id="cb826-5"><a href="aplikace3.html#cb826-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb826-6"><a href="aplikace3.html#cb826-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb826-7"><a href="aplikace3.html#cb826-7" tabindex="-1"></a></span>
<span id="cb826-8"><a href="aplikace3.html#cb826-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb826-9"><a href="aplikace3.html#cb826-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb826-10"><a href="aplikace3.html#cb826-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb826-11"><a href="aplikace3.html#cb826-11" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb826-12"><a href="aplikace3.html#cb826-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt),</span>
<span id="cb826-13"><a href="aplikace3.html#cb826-13" tabindex="-1"></a>                               <span class="at">norder =</span> <span class="dv">4</span>,</span>
<span id="cb826-14"><a href="aplikace3.html#cb826-14" tabindex="-1"></a>                               <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb827"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb827-1"><a href="aplikace3.html#cb827-1" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb827-2"><a href="aplikace3.html#cb827-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb827-3"><a href="aplikace3.html#cb827-3" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb827-4"><a href="aplikace3.html#cb827-4" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb827-5"><a href="aplikace3.html#cb827-5" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb827-6"><a href="aplikace3.html#cb827-6" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb827-7"><a href="aplikace3.html#cb827-7" tabindex="-1"></a><span class="co"># SVM model</span></span>
<span id="cb827-8"><a href="aplikace3.html#cb827-8" tabindex="-1"></a>model.svm.f <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb827-9"><a href="aplikace3.html#cb827-9" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb827-10"><a href="aplikace3.html#cb827-10" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb827-11"><a href="aplikace3.html#cb827-11" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, <span class="at">degree =</span> <span class="dv">3</span>, <span class="at">coef0 =</span> <span class="dv">1</span>, <span class="at">cost =</span> <span class="fl">1e4</span>)</span>
<span id="cb827-12"><a href="aplikace3.html#cb827-12" tabindex="-1"></a></span>
<span id="cb827-13"><a href="aplikace3.html#cb827-13" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb827-14"><a href="aplikace3.html#cb827-14" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb827-15"><a href="aplikace3.html#cb827-15" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb827-16"><a href="aplikace3.html#cb827-16" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train)</span>
<span id="cb827-17"><a href="aplikace3.html#cb827-17" tabindex="-1"></a>  </span>
<span id="cb827-18"><a href="aplikace3.html#cb827-18" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb827-19"><a href="aplikace3.html#cb827-19" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb827-20"><a href="aplikace3.html#cb827-20" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb827-21"><a href="aplikace3.html#cb827-21" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test)</span></code></pre></div>
</details>
<p>We calculated the training error (which is 0 %) and the test error (which is 9.23 %).</p>
<p>Now let’s attempt, unlike the procedure in the previous chapters, to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, acknowledging that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will explore the values of the hyperparameter <span class="math inline">\(C\)</span> in the range <span class="math inline">\([10^{-2}, 10^{5}]\)</span>, while for the polynomial kernel, we will consider the value of the hyperparameter <span class="math inline">\(p\)</span> to be 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use <span class="math inline">\(r k_cv\)</span>-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the range <span class="math inline">\([10^{-5}, 10^{-2}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb828"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb828-1"><a href="aplikace3.html#cb828-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb828-2"><a href="aplikace3.html#cb828-2" tabindex="-1"></a></span>
<span id="cb828-3"><a href="aplikace3.html#cb828-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb828-4"><a href="aplikace3.html#cb828-4" tabindex="-1"></a></span>
<span id="cb828-5"><a href="aplikace3.html#cb828-5" tabindex="-1"></a><span class="co"># We split the training data into k parts</span></span>
<span id="cb828-6"><a href="aplikace3.html#cb828-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb828-7"><a href="aplikace3.html#cb828-7" tabindex="-1"></a></span>
<span id="cb828-8"><a href="aplikace3.html#cb828-8" tabindex="-1"></a><span class="co"># Which values of gamma do we want to consider</span></span>
<span id="cb828-9"><a href="aplikace3.html#cb828-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">4</span>)</span>
<span id="cb828-10"><a href="aplikace3.html#cb828-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">8</span>)</span>
<span id="cb828-11"><a href="aplikace3.html#cb828-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb828-12"><a href="aplikace3.html#cb828-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb828-13"><a href="aplikace3.html#cb828-13" tabindex="-1"></a></span>
<span id="cb828-14"><a href="aplikace3.html#cb828-14" tabindex="-1"></a><span class="co"># A list with three components... an array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb828-15"><a href="aplikace3.html#cb828-15" tabindex="-1"></a><span class="co"># An empty matrix where we will place individual results</span></span>
<span id="cb828-16"><a href="aplikace3.html#cb828-16" tabindex="-1"></a><span class="co"># The columns will contain the accuracy values for each</span></span>
<span id="cb828-17"><a href="aplikace3.html#cb828-17" tabindex="-1"></a><span class="co"># The rows will correspond to the values for a given gamma and the layers correspond to folds</span></span>
<span id="cb828-18"><a href="aplikace3.html#cb828-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb828-19"><a href="aplikace3.html#cb828-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb828-20"><a href="aplikace3.html#cb828-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb828-21"><a href="aplikace3.html#cb828-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb828-22"><a href="aplikace3.html#cb828-22" tabindex="-1"></a>)</span>
<span id="cb828-23"><a href="aplikace3.html#cb828-23" tabindex="-1"></a></span>
<span id="cb828-24"><a href="aplikace3.html#cb828-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb828-25"><a href="aplikace3.html#cb828-25" tabindex="-1"></a><span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb828-26"><a href="aplikace3.html#cb828-26" tabindex="-1"></a>  <span class="co"># We go through the individual folds</span></span>
<span id="cb828-27"><a href="aplikace3.html#cb828-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb828-28"><a href="aplikace3.html#cb828-28" tabindex="-1"></a>    <span class="co"># Definition of the test and training parts for CV</span></span>
<span id="cb828-29"><a href="aplikace3.html#cb828-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb828-30"><a href="aplikace3.html#cb828-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb828-31"><a href="aplikace3.html#cb828-31" tabindex="-1"></a>    </span>
<span id="cb828-32"><a href="aplikace3.html#cb828-32" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb828-33"><a href="aplikace3.html#cb828-33" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb828-34"><a href="aplikace3.html#cb828-34" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb828-35"><a href="aplikace3.html#cb828-35" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb828-36"><a href="aplikace3.html#cb828-36" tabindex="-1"></a>    </span>
<span id="cb828-37"><a href="aplikace3.html#cb828-37" tabindex="-1"></a>    <span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb828-38"><a href="aplikace3.html#cb828-38" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb828-39"><a href="aplikace3.html#cb828-39" tabindex="-1"></a>    </span>
<span id="cb828-40"><a href="aplikace3.html#cb828-40" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb828-41"><a href="aplikace3.html#cb828-41" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb828-42"><a href="aplikace3.html#cb828-42" tabindex="-1"></a>    <span class="co"># B-spline basis</span></span>
<span id="cb828-43"><a href="aplikace3.html#cb828-43" tabindex="-1"></a>    <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb828-44"><a href="aplikace3.html#cb828-44" tabindex="-1"></a>    <span class="co"># Formula</span></span>
<span id="cb828-45"><a href="aplikace3.html#cb828-45" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb828-46"><a href="aplikace3.html#cb828-46" tabindex="-1"></a>    <span class="co"># Basis for x</span></span>
<span id="cb828-47"><a href="aplikace3.html#cb828-47" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb828-48"><a href="aplikace3.html#cb828-48" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb828-49"><a href="aplikace3.html#cb828-49" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb828-50"><a href="aplikace3.html#cb828-50" tabindex="-1"></a>    </span>
<span id="cb828-51"><a href="aplikace3.html#cb828-51" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb828-52"><a href="aplikace3.html#cb828-52" tabindex="-1"></a>    <span class="co"># SVM model</span></span>
<span id="cb828-53"><a href="aplikace3.html#cb828-53" tabindex="-1"></a>    clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb828-54"><a href="aplikace3.html#cb828-54" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb828-55"><a href="aplikace3.html#cb828-55" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb828-56"><a href="aplikace3.html#cb828-56" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb828-57"><a href="aplikace3.html#cb828-57" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb828-58"><a href="aplikace3.html#cb828-58" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb828-59"><a href="aplikace3.html#cb828-59" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb828-60"><a href="aplikace3.html#cb828-60" tabindex="-1"></a>      </span>
<span id="cb828-61"><a href="aplikace3.html#cb828-61" tabindex="-1"></a>    <span class="co"># Accuracy on the test data</span></span>
<span id="cb828-62"><a href="aplikace3.html#cb828-62" tabindex="-1"></a>    newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb828-63"><a href="aplikace3.html#cb828-63" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb828-64"><a href="aplikace3.html#cb828-64" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb828-65"><a href="aplikace3.html#cb828-65" tabindex="-1"></a>    </span>
<span id="cb828-66"><a href="aplikace3.html#cb828-66" tabindex="-1"></a>    <span class="co"># We insert the accuracies into positions for the given C and fold</span></span>
<span id="cb828-67"><a href="aplikace3.html#cb828-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb828-68"><a href="aplikace3.html#cb828-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb828-69"><a href="aplikace3.html#cb828-69" tabindex="-1"></a>    </span>
<span id="cb828-70"><a href="aplikace3.html#cb828-70" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb828-71"><a href="aplikace3.html#cb828-71" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb828-72"><a href="aplikace3.html#cb828-72" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb828-73"><a href="aplikace3.html#cb828-73" tabindex="-1"></a>      clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb828-74"><a href="aplikace3.html#cb828-74" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb828-75"><a href="aplikace3.html#cb828-75" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb828-76"><a href="aplikace3.html#cb828-76" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb828-77"><a href="aplikace3.html#cb828-77" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb828-78"><a href="aplikace3.html#cb828-78" tabindex="-1"></a>                <span class="at">coef0 =</span> coef0,</span>
<span id="cb828-79"><a href="aplikace3.html#cb828-79" tabindex="-1"></a>                <span class="at">degree =</span> p,</span>
<span id="cb828-80"><a href="aplikace3.html#cb828-80" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb828-81"><a href="aplikace3.html#cb828-81" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb828-82"><a href="aplikace3.html#cb828-82" tabindex="-1"></a>        </span>
<span id="cb828-83"><a href="aplikace3.html#cb828-83" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb828-84"><a href="aplikace3.html#cb828-84" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb828-85"><a href="aplikace3.html#cb828-85" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb828-86"><a href="aplikace3.html#cb828-86" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb828-87"><a href="aplikace3.html#cb828-87" tabindex="-1"></a>      </span>
<span id="cb828-88"><a href="aplikace3.html#cb828-88" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, p, and fold</span></span>
<span id="cb828-89"><a href="aplikace3.html#cb828-89" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb828-90"><a href="aplikace3.html#cb828-90" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb828-91"><a href="aplikace3.html#cb828-91" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb828-92"><a href="aplikace3.html#cb828-92" tabindex="-1"></a>    }</span>
<span id="cb828-93"><a href="aplikace3.html#cb828-93" tabindex="-1"></a>        </span>
<span id="cb828-94"><a href="aplikace3.html#cb828-94" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb828-95"><a href="aplikace3.html#cb828-95" tabindex="-1"></a>    <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb828-96"><a href="aplikace3.html#cb828-96" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb828-97"><a href="aplikace3.html#cb828-97" tabindex="-1"></a>      clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb828-98"><a href="aplikace3.html#cb828-98" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb828-99"><a href="aplikace3.html#cb828-99" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb828-100"><a href="aplikace3.html#cb828-100" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb828-101"><a href="aplikace3.html#cb828-101" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb828-102"><a href="aplikace3.html#cb828-102" tabindex="-1"></a>                <span class="at">gamma =</span> gam.cv,</span>
<span id="cb828-103"><a href="aplikace3.html#cb828-103" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb828-104"><a href="aplikace3.html#cb828-104" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb828-105"><a href="aplikace3.html#cb828-105" tabindex="-1"></a>        </span>
<span id="cb828-106"><a href="aplikace3.html#cb828-106" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb828-107"><a href="aplikace3.html#cb828-107" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb828-108"><a href="aplikace3.html#cb828-108" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb828-109"><a href="aplikace3.html#cb828-109" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb828-110"><a href="aplikace3.html#cb828-110" tabindex="-1"></a>      </span>
<span id="cb828-111"><a href="aplikace3.html#cb828-111" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, gamma, and fold</span></span>
<span id="cb828-112"><a href="aplikace3.html#cb828-112" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb828-113"><a href="aplikace3.html#cb828-113" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb828-114"><a href="aplikace3.html#cb828-114" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb828-115"><a href="aplikace3.html#cb828-115" tabindex="-1"></a>    }</span>
<span id="cb828-116"><a href="aplikace3.html#cb828-116" tabindex="-1"></a>  }</span>
<span id="cb828-117"><a href="aplikace3.html#cb828-117" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of 10-fold CV so that we have one estimate of validation error for one value of the hyperparameter (or one combination of values). At the same time, we will determine the optimal values of the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb829"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb829-1"><a href="aplikace3.html#cb829-1" tabindex="-1"></a><span class="co"># We calculate the average accuracies for individual C across folds</span></span>
<span id="cb829-2"><a href="aplikace3.html#cb829-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb829-3"><a href="aplikace3.html#cb829-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb829-4"><a href="aplikace3.html#cb829-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb829-5"><a href="aplikace3.html#cb829-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb829-6"><a href="aplikace3.html#cb829-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb829-7"><a href="aplikace3.html#cb829-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb829-8"><a href="aplikace3.html#cb829-8" tabindex="-1"></a></span>
<span id="cb829-9"><a href="aplikace3.html#cb829-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb829-10"><a href="aplikace3.html#cb829-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb829-11"><a href="aplikace3.html#cb829-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb829-12"><a href="aplikace3.html#cb829-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb829-13"><a href="aplikace3.html#cb829-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb829-14"><a href="aplikace3.html#cb829-14" tabindex="-1"></a></span>
<span id="cb829-15"><a href="aplikace3.html#cb829-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb829-16"><a href="aplikace3.html#cb829-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb829-17"><a href="aplikace3.html#cb829-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb829-18"><a href="aplikace3.html#cb829-18" tabindex="-1"></a></span>
<span id="cb829-19"><a href="aplikace3.html#cb829-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb829-20"><a href="aplikace3.html#cb829-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb829-21"><a href="aplikace3.html#cb829-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb829-22"><a href="aplikace3.html#cb829-22" tabindex="-1"></a></span>
<span id="cb829-23"><a href="aplikace3.html#cb829-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb829-24"><a href="aplikace3.html#cb829-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb829-25"><a href="aplikace3.html#cb829-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s take a look at how the optimal values turned out. For <em>linear kernel</em>, we have the optimal value <span class="math inline">\(C\)</span> equal to 1, for <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 1, and for <em>radial kernel</em>, we have two optimal values, for <span class="math inline">\(C\)</span> the optimal value is 10^{4} and for <span class="math inline">\(\gamma\)</span> it is 0. The validation error rates are 0.0066667 for linear, 0.02625 for polynomial, and 0.0066667 for radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb830"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb830-1"><a href="aplikace3.html#cb830-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb830-2"><a href="aplikace3.html#cb830-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb830-3"><a href="aplikace3.html#cb830-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb830-4"><a href="aplikace3.html#cb830-4" tabindex="-1"></a></span>
<span id="cb830-5"><a href="aplikace3.html#cb830-5" tabindex="-1"></a><span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb830-6"><a href="aplikace3.html#cb830-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb830-7"><a href="aplikace3.html#cb830-7" tabindex="-1"></a></span>
<span id="cb830-8"><a href="aplikace3.html#cb830-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb830-9"><a href="aplikace3.html#cb830-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb830-10"><a href="aplikace3.html#cb830-10" tabindex="-1"></a><span class="co"># B-spline basis</span></span>
<span id="cb830-11"><a href="aplikace3.html#cb830-11" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb830-12"><a href="aplikace3.html#cb830-12" tabindex="-1"></a></span>
<span id="cb830-13"><a href="aplikace3.html#cb830-13" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb830-14"><a href="aplikace3.html#cb830-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb830-15"><a href="aplikace3.html#cb830-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb830-16"><a href="aplikace3.html#cb830-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb830-17"><a href="aplikace3.html#cb830-17" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb830-18"><a href="aplikace3.html#cb830-18" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb831"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb831-1"><a href="aplikace3.html#cb831-1" tabindex="-1"></a>model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb831-2"><a href="aplikace3.html#cb831-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb831-3"><a href="aplikace3.html#cb831-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb831-4"><a href="aplikace3.html#cb831-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb831-5"><a href="aplikace3.html#cb831-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb831-6"><a href="aplikace3.html#cb831-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb831-7"><a href="aplikace3.html#cb831-7" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb831-8"><a href="aplikace3.html#cb831-8" tabindex="-1"></a></span>
<span id="cb831-9"><a href="aplikace3.html#cb831-9" tabindex="-1"></a>model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb831-10"><a href="aplikace3.html#cb831-10" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb831-11"><a href="aplikace3.html#cb831-11" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb831-12"><a href="aplikace3.html#cb831-12" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb831-13"><a href="aplikace3.html#cb831-13" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb831-14"><a href="aplikace3.html#cb831-14" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb831-15"><a href="aplikace3.html#cb831-15" tabindex="-1"></a>            <span class="at">degree =</span> p.opt,</span>
<span id="cb831-16"><a href="aplikace3.html#cb831-16" tabindex="-1"></a>            <span class="at">coef0 =</span> coef0,</span>
<span id="cb831-17"><a href="aplikace3.html#cb831-17" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb831-18"><a href="aplikace3.html#cb831-18" tabindex="-1"></a></span>
<span id="cb831-19"><a href="aplikace3.html#cb831-19" tabindex="-1"></a>model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb831-20"><a href="aplikace3.html#cb831-20" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb831-21"><a href="aplikace3.html#cb831-21" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb831-22"><a href="aplikace3.html#cb831-22" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb831-23"><a href="aplikace3.html#cb831-23" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb831-24"><a href="aplikace3.html#cb831-24" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb831-25"><a href="aplikace3.html#cb831-25" tabindex="-1"></a>            <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb831-26"><a href="aplikace3.html#cb831-26" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb831-27"><a href="aplikace3.html#cb831-27" tabindex="-1"></a></span>
<span id="cb831-28"><a href="aplikace3.html#cb831-28" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb831-29"><a href="aplikace3.html#cb831-29" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb831-30"><a href="aplikace3.html#cb831-30" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-31"><a href="aplikace3.html#cb831-31" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb831-32"><a href="aplikace3.html#cb831-32" tabindex="-1"></a></span>
<span id="cb831-33"><a href="aplikace3.html#cb831-33" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-34"><a href="aplikace3.html#cb831-34" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb831-35"><a href="aplikace3.html#cb831-35" tabindex="-1"></a></span>
<span id="cb831-36"><a href="aplikace3.html#cb831-36" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-37"><a href="aplikace3.html#cb831-37" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb831-38"><a href="aplikace3.html#cb831-38" tabindex="-1"></a>  </span>
<span id="cb831-39"><a href="aplikace3.html#cb831-39" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb831-40"><a href="aplikace3.html#cb831-40" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb831-41"><a href="aplikace3.html#cb831-41" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-42"><a href="aplikace3.html#cb831-42" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb831-43"><a href="aplikace3.html#cb831-43" tabindex="-1"></a></span>
<span id="cb831-44"><a href="aplikace3.html#cb831-44" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-45"><a href="aplikace3.html#cb831-45" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb831-46"><a href="aplikace3.html#cb831-46" tabindex="-1"></a></span>
<span id="cb831-47"><a href="aplikace3.html#cb831-47" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb831-48"><a href="aplikace3.html#cb831-48" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 0.6667 % for the linear kernel, 1.3333 % for the polynomial kernel, and 1.3333 % for the Gaussian kernel. On the test data, the error rate of the method is 9.2308 % for the linear kernel, 6.1538 % for the polynomial kernel, and 4.6154 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb832"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb832-1"><a href="aplikace3.html#cb832-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb832-2"><a href="aplikace3.html#cb832-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb832-3"><a href="aplikace3.html#cb832-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb832-4"><a href="aplikace3.html#cb832-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb832-5"><a href="aplikace3.html#cb832-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb832-6"><a href="aplikace3.html#cb832-6" tabindex="-1"></a></span>
<span id="cb832-7"><a href="aplikace3.html#cb832-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="diskrA3" class="section level4 hasAnchor" number="6.3.7.2">
<h4><span class="header-section-number">6.3.7.2</span> Discretization of the Interval<a href="aplikace3.html#diskrA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start by applying the Support Vector Machines method directly to the discretized data (evaluating the function on a given grid of points over the interval <span class="math inline">\(I = [850, 1050]\)</span>), considering all three aforementioned kernel functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb833"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb833-1"><a href="aplikace3.html#cb833-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb833-2"><a href="aplikace3.html#cb833-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb833-3"><a href="aplikace3.html#cb833-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb833-4"><a href="aplikace3.html#cb833-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(BSmooth<span class="sc">$</span>fd[i])))</span>
<span id="cb833-5"><a href="aplikace3.html#cb833-5" tabindex="-1"></a>}</span>
<span id="cb833-6"><a href="aplikace3.html#cb833-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb833-7"><a href="aplikace3.html#cb833-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb833-8"><a href="aplikace3.html#cb833-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb833-9"><a href="aplikace3.html#cb833-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb833-10"><a href="aplikace3.html#cb833-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> T)</span>
<span id="cb833-11"><a href="aplikace3.html#cb833-11" tabindex="-1"></a></span>
<span id="cb833-12"><a href="aplikace3.html#cb833-12" tabindex="-1"></a><span class="co"># split into test and training sets</span></span>
<span id="cb833-13"><a href="aplikace3.html#cb833-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb833-14"><a href="aplikace3.html#cb833-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb833-15"><a href="aplikace3.html#cb833-15" tabindex="-1"></a></span>
<span id="cb833-16"><a href="aplikace3.html#cb833-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb833-17"><a href="aplikace3.html#cb833-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb833-18"><a href="aplikace3.html#cb833-18" tabindex="-1"></a></span>
<span id="cb833-19"><a href="aplikace3.html#cb833-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb833-20"><a href="aplikace3.html#cb833-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb833-21"><a href="aplikace3.html#cb833-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb833-22"><a href="aplikace3.html#cb833-22" tabindex="-1"></a></span>
<span id="cb833-23"><a href="aplikace3.html#cb833-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb833-24"><a href="aplikace3.html#cb833-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb833-25"><a href="aplikace3.html#cb833-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now let’s estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, and we allow for its optimal value to differ between kernels.</p>
<p>For all three kernels, we will explore values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, fixing the hyperparameter <span class="math inline">\(p\)</span> for the polynomial kernel at the value 3, since other integer values do not yield nearly as good results. For the radial kernel, we will again use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-4}, 10^{0}]\)</span>. We will set <code>coef0</code> to <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb834"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb834-1"><a href="aplikace3.html#cb834-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb834-2"><a href="aplikace3.html#cb834-2" tabindex="-1"></a></span>
<span id="cb834-3"><a href="aplikace3.html#cb834-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb834-4"><a href="aplikace3.html#cb834-4" tabindex="-1"></a></span>
<span id="cb834-5"><a href="aplikace3.html#cb834-5" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb834-6"><a href="aplikace3.html#cb834-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb834-7"><a href="aplikace3.html#cb834-7" tabindex="-1"></a></span>
<span id="cb834-8"><a href="aplikace3.html#cb834-8" tabindex="-1"></a><span class="co"># values of gamma to consider</span></span>
<span id="cb834-9"><a href="aplikace3.html#cb834-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb834-10"><a href="aplikace3.html#cb834-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb834-11"><a href="aplikace3.html#cb834-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb834-12"><a href="aplikace3.html#cb834-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb834-13"><a href="aplikace3.html#cb834-13" tabindex="-1"></a></span>
<span id="cb834-14"><a href="aplikace3.html#cb834-14" tabindex="-1"></a><span class="co"># list with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb834-15"><a href="aplikace3.html#cb834-15" tabindex="-1"></a><span class="co"># empty matrix to store results</span></span>
<span id="cb834-16"><a href="aplikace3.html#cb834-16" tabindex="-1"></a><span class="co"># columns will contain accuracy values for given C</span></span>
<span id="cb834-17"><a href="aplikace3.html#cb834-17" tabindex="-1"></a><span class="co"># rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb834-18"><a href="aplikace3.html#cb834-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb834-19"><a href="aplikace3.html#cb834-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb834-20"><a href="aplikace3.html#cb834-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb834-21"><a href="aplikace3.html#cb834-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb834-22"><a href="aplikace3.html#cb834-22" tabindex="-1"></a>)</span>
<span id="cb834-23"><a href="aplikace3.html#cb834-23" tabindex="-1"></a></span>
<span id="cb834-24"><a href="aplikace3.html#cb834-24" tabindex="-1"></a><span class="co"># first loop over values of C</span></span>
<span id="cb834-25"><a href="aplikace3.html#cb834-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb834-26"><a href="aplikace3.html#cb834-26" tabindex="-1"></a>  <span class="co"># loop through the individual folds</span></span>
<span id="cb834-27"><a href="aplikace3.html#cb834-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb834-28"><a href="aplikace3.html#cb834-28" tabindex="-1"></a>    <span class="co"># define the test and training parts for CV</span></span>
<span id="cb834-29"><a href="aplikace3.html#cb834-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb834-30"><a href="aplikace3.html#cb834-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb834-31"><a href="aplikace3.html#cb834-31" tabindex="-1"></a>    </span>
<span id="cb834-32"><a href="aplikace3.html#cb834-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb834-33"><a href="aplikace3.html#cb834-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb834-34"><a href="aplikace3.html#cb834-34" tabindex="-1"></a>    </span>
<span id="cb834-35"><a href="aplikace3.html#cb834-35" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb834-36"><a href="aplikace3.html#cb834-36" tabindex="-1"></a>    <span class="co"># model construction</span></span>
<span id="cb834-37"><a href="aplikace3.html#cb834-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb834-38"><a href="aplikace3.html#cb834-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb834-39"><a href="aplikace3.html#cb834-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb834-40"><a href="aplikace3.html#cb834-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb834-41"><a href="aplikace3.html#cb834-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb834-42"><a href="aplikace3.html#cb834-42" tabindex="-1"></a>    </span>
<span id="cb834-43"><a href="aplikace3.html#cb834-43" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb834-44"><a href="aplikace3.html#cb834-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb834-45"><a href="aplikace3.html#cb834-45" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb834-46"><a href="aplikace3.html#cb834-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb834-47"><a href="aplikace3.html#cb834-47" tabindex="-1"></a>    </span>
<span id="cb834-48"><a href="aplikace3.html#cb834-48" tabindex="-1"></a>    <span class="co"># store accuracies for the respective C and fold</span></span>
<span id="cb834-49"><a href="aplikace3.html#cb834-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb834-50"><a href="aplikace3.html#cb834-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb834-51"><a href="aplikace3.html#cb834-51" tabindex="-1"></a>    </span>
<span id="cb834-52"><a href="aplikace3.html#cb834-52" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb834-53"><a href="aplikace3.html#cb834-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb834-54"><a href="aplikace3.html#cb834-54" tabindex="-1"></a>      <span class="co"># model construction</span></span>
<span id="cb834-55"><a href="aplikace3.html#cb834-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb834-56"><a href="aplikace3.html#cb834-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb834-57"><a href="aplikace3.html#cb834-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb834-58"><a href="aplikace3.html#cb834-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb834-59"><a href="aplikace3.html#cb834-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb834-60"><a href="aplikace3.html#cb834-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb834-61"><a href="aplikace3.html#cb834-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb834-62"><a href="aplikace3.html#cb834-62" tabindex="-1"></a>      </span>
<span id="cb834-63"><a href="aplikace3.html#cb834-63" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb834-64"><a href="aplikace3.html#cb834-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb834-65"><a href="aplikace3.html#cb834-65" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb834-66"><a href="aplikace3.html#cb834-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb834-67"><a href="aplikace3.html#cb834-67" tabindex="-1"></a>      </span>
<span id="cb834-68"><a href="aplikace3.html#cb834-68" tabindex="-1"></a>      <span class="co"># store accuracies for the respective C, p, and fold</span></span>
<span id="cb834-69"><a href="aplikace3.html#cb834-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb834-70"><a href="aplikace3.html#cb834-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb834-71"><a href="aplikace3.html#cb834-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb834-72"><a href="aplikace3.html#cb834-72" tabindex="-1"></a>    }</span>
<span id="cb834-73"><a href="aplikace3.html#cb834-73" tabindex="-1"></a>        </span>
<span id="cb834-74"><a href="aplikace3.html#cb834-74" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb834-75"><a href="aplikace3.html#cb834-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb834-76"><a href="aplikace3.html#cb834-76" tabindex="-1"></a>      <span class="co"># model construction</span></span>
<span id="cb834-77"><a href="aplikace3.html#cb834-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb834-78"><a href="aplikace3.html#cb834-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb834-79"><a href="aplikace3.html#cb834-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb834-80"><a href="aplikace3.html#cb834-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb834-81"><a href="aplikace3.html#cb834-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb834-82"><a href="aplikace3.html#cb834-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb834-83"><a href="aplikace3.html#cb834-83" tabindex="-1"></a>      </span>
<span id="cb834-84"><a href="aplikace3.html#cb834-84" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb834-85"><a href="aplikace3.html#cb834-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb834-86"><a href="aplikace3.html#cb834-86" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb834-87"><a href="aplikace3.html#cb834-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb834-88"><a href="aplikace3.html#cb834-88" tabindex="-1"></a>      </span>
<span id="cb834-89"><a href="aplikace3.html#cb834-89" tabindex="-1"></a>      <span class="co"># store accuracies for the respective C, gamma, and fold</span></span>
<span id="cb834-90"><a href="aplikace3.html#cb834-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb834-91"><a href="aplikace3.html#cb834-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb834-92"><a href="aplikace3.html#cb834-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb834-93"><a href="aplikace3.html#cb834-93" tabindex="-1"></a>    }</span>
<span id="cb834-94"><a href="aplikace3.html#cb834-94" tabindex="-1"></a>  }</span>
<span id="cb834-95"><a href="aplikace3.html#cb834-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results of the 10-fold cross-validation so that we have a single estimate of validation error for each value of the hyperparameter (or each combination of values). We will also determine the optimal values of the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb835"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb835-1"><a href="aplikace3.html#cb835-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each C across folds</span></span>
<span id="cb835-2"><a href="aplikace3.html#cb835-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb835-3"><a href="aplikace3.html#cb835-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb835-4"><a href="aplikace3.html#cb835-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb835-5"><a href="aplikace3.html#cb835-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb835-6"><a href="aplikace3.html#cb835-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb835-7"><a href="aplikace3.html#cb835-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb835-8"><a href="aplikace3.html#cb835-8" tabindex="-1"></a></span>
<span id="cb835-9"><a href="aplikace3.html#cb835-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb835-10"><a href="aplikace3.html#cb835-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb835-11"><a href="aplikace3.html#cb835-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb835-12"><a href="aplikace3.html#cb835-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb835-13"><a href="aplikace3.html#cb835-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb835-14"><a href="aplikace3.html#cb835-14" tabindex="-1"></a></span>
<span id="cb835-15"><a href="aplikace3.html#cb835-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb835-16"><a href="aplikace3.html#cb835-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb835-17"><a href="aplikace3.html#cb835-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb835-18"><a href="aplikace3.html#cb835-18" tabindex="-1"></a></span>
<span id="cb835-19"><a href="aplikace3.html#cb835-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb835-20"><a href="aplikace3.html#cb835-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb835-21"><a href="aplikace3.html#cb835-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb835-22"><a href="aplikace3.html#cb835-22" tabindex="-1"></a></span>
<span id="cb835-23"><a href="aplikace3.html#cb835-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb835-24"><a href="aplikace3.html#cb835-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb835-25"><a href="aplikace3.html#cb835-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at the optimal values. For the <em>linear kernel</em>, we have an optimal value of <span class="math inline">\(C\)</span> equal to 0.1; for the <em>polynomial kernel</em>, <span class="math inline">\(C\)</span> is equal to 1; and for the <em>radial kernel</em>, we have two optimal values: the optimal value for <span class="math inline">\(C\)</span> is 1000 and for <span class="math inline">\(\gamma\)</span> it is 10^{-4}. The validation errors are 0.0066667 for linear, 0.0195833 for polynomial, and 0.0066667 for radial kernels.</p>
<p>Finally, we can construct the final classifiers on the entire training dataset using the hyperparameter values determined by the 10-fold cross-validation. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb836"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb836-1"><a href="aplikace3.html#cb836-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb836-2"><a href="aplikace3.html#cb836-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb836-3"><a href="aplikace3.html#cb836-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb836-4"><a href="aplikace3.html#cb836-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb836-5"><a href="aplikace3.html#cb836-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb836-6"><a href="aplikace3.html#cb836-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb836-7"><a href="aplikace3.html#cb836-7" tabindex="-1"></a></span>
<span id="cb836-8"><a href="aplikace3.html#cb836-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb836-9"><a href="aplikace3.html#cb836-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb836-10"><a href="aplikace3.html#cb836-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb836-11"><a href="aplikace3.html#cb836-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb836-12"><a href="aplikace3.html#cb836-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb836-13"><a href="aplikace3.html#cb836-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb836-14"><a href="aplikace3.html#cb836-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb836-15"><a href="aplikace3.html#cb836-15" tabindex="-1"></a></span>
<span id="cb836-16"><a href="aplikace3.html#cb836-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb836-17"><a href="aplikace3.html#cb836-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb836-18"><a href="aplikace3.html#cb836-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb836-19"><a href="aplikace3.html#cb836-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb836-20"><a href="aplikace3.html#cb836-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb836-21"><a href="aplikace3.html#cb836-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb836-22"><a href="aplikace3.html#cb836-22" tabindex="-1"></a></span>
<span id="cb836-23"><a href="aplikace3.html#cb836-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb836-24"><a href="aplikace3.html#cb836-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb836-25"><a href="aplikace3.html#cb836-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb836-26"><a href="aplikace3.html#cb836-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb836-27"><a href="aplikace3.html#cb836-27" tabindex="-1"></a></span>
<span id="cb836-28"><a href="aplikace3.html#cb836-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb836-29"><a href="aplikace3.html#cb836-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb836-30"><a href="aplikace3.html#cb836-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb836-31"><a href="aplikace3.html#cb836-31" tabindex="-1"></a></span>
<span id="cb836-32"><a href="aplikace3.html#cb836-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb836-33"><a href="aplikace3.html#cb836-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb836-34"><a href="aplikace3.html#cb836-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb836-35"><a href="aplikace3.html#cb836-35" tabindex="-1"></a></span>
<span id="cb836-36"><a href="aplikace3.html#cb836-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb836-37"><a href="aplikace3.html#cb836-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb836-38"><a href="aplikace3.html#cb836-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb836-39"><a href="aplikace3.html#cb836-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb836-40"><a href="aplikace3.html#cb836-40" tabindex="-1"></a></span>
<span id="cb836-41"><a href="aplikace3.html#cb836-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb836-42"><a href="aplikace3.html#cb836-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb836-43"><a href="aplikace3.html#cb836-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb836-44"><a href="aplikace3.html#cb836-44" tabindex="-1"></a></span>
<span id="cb836-45"><a href="aplikace3.html#cb836-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb836-46"><a href="aplikace3.html#cb836-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb836-47"><a href="aplikace3.html#cb836-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is therefore 1.3333 % for the linear kernel, 1.3333 % for the polynomial kernel, and 0.6667 % for the radial kernel. On the test data, the error rate of the method is 4.6154 % for the linear kernel, 4.6154 % for the polynomial kernel, and 9.2308 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb837"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb837-1"><a href="aplikace3.html#cb837-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - class&#39;</span>, </span>
<span id="cb837-2"><a href="aplikace3.html#cb837-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - class&#39;</span>, </span>
<span id="cb837-3"><a href="aplikace3.html#cb837-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - class&#39;</span>), </span>
<span id="cb837-4"><a href="aplikace3.html#cb837-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb837-5"><a href="aplikace3.html#cb837-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb837-6"><a href="aplikace3.html#cb837-6" tabindex="-1"></a></span>
<span id="cb837-7"><a href="aplikace3.html#cb837-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVMA3" class="section level4 hasAnchor" number="6.3.7.3">
<h4><span class="header-section-number">6.3.7.3</span> Principal Component Scores<a href="aplikace3.html#PCA-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first $p = $ 2 principal components.</p>
<p>Now, let’s attempt to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation, differing from the approach in previous chapters. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> is present in all kernel functions, allowing for the possibility that its optimal value may differ across kernels.</p>
<p>For all three kernels, we will examine values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, while for the polynomial kernel we will fix the hyperparameter <span class="math inline">\(p\)</span> at the value 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use 10-fold cross-validation to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. We will set <code>coef0</code> to <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb838"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb838-1"><a href="aplikace3.html#cb838-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb838-2"><a href="aplikace3.html#cb838-2" tabindex="-1"></a></span>
<span id="cb838-3"><a href="aplikace3.html#cb838-3" tabindex="-1"></a><span class="co"># Define the gamma values to consider</span></span>
<span id="cb838-4"><a href="aplikace3.html#cb838-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb838-5"><a href="aplikace3.html#cb838-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb838-6"><a href="aplikace3.html#cb838-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb838-7"><a href="aplikace3.html#cb838-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb838-8"><a href="aplikace3.html#cb838-8" tabindex="-1"></a></span>
<span id="cb838-9"><a href="aplikace3.html#cb838-9" tabindex="-1"></a><span class="co"># List with three components... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb838-10"><a href="aplikace3.html#cb838-10" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb838-11"><a href="aplikace3.html#cb838-11" tabindex="-1"></a><span class="co"># Columns will represent accuracies for given C values</span></span>
<span id="cb838-12"><a href="aplikace3.html#cb838-12" tabindex="-1"></a><span class="co"># Rows will represent values for given gamma, with layers corresponding to folds</span></span>
<span id="cb838-13"><a href="aplikace3.html#cb838-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb838-14"><a href="aplikace3.html#cb838-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb838-15"><a href="aplikace3.html#cb838-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb838-16"><a href="aplikace3.html#cb838-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb838-17"><a href="aplikace3.html#cb838-17" tabindex="-1"></a>)</span>
<span id="cb838-18"><a href="aplikace3.html#cb838-18" tabindex="-1"></a></span>
<span id="cb838-19"><a href="aplikace3.html#cb838-19" tabindex="-1"></a><span class="co"># First, iterate over the values of C</span></span>
<span id="cb838-20"><a href="aplikace3.html#cb838-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb838-21"><a href="aplikace3.html#cb838-21" tabindex="-1"></a>  <span class="co"># Iterate over the individual folds</span></span>
<span id="cb838-22"><a href="aplikace3.html#cb838-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb838-23"><a href="aplikace3.html#cb838-23" tabindex="-1"></a>    <span class="co"># Define the test and training parts for CV</span></span>
<span id="cb838-24"><a href="aplikace3.html#cb838-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb838-25"><a href="aplikace3.html#cb838-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb838-26"><a href="aplikace3.html#cb838-26" tabindex="-1"></a>    </span>
<span id="cb838-27"><a href="aplikace3.html#cb838-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb838-28"><a href="aplikace3.html#cb838-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb838-29"><a href="aplikace3.html#cb838-29" tabindex="-1"></a>    </span>
<span id="cb838-30"><a href="aplikace3.html#cb838-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb838-31"><a href="aplikace3.html#cb838-31" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb838-32"><a href="aplikace3.html#cb838-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb838-33"><a href="aplikace3.html#cb838-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb838-34"><a href="aplikace3.html#cb838-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb838-35"><a href="aplikace3.html#cb838-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb838-36"><a href="aplikace3.html#cb838-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb838-37"><a href="aplikace3.html#cb838-37" tabindex="-1"></a>    </span>
<span id="cb838-38"><a href="aplikace3.html#cb838-38" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb838-39"><a href="aplikace3.html#cb838-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb838-40"><a href="aplikace3.html#cb838-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb838-41"><a href="aplikace3.html#cb838-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb838-42"><a href="aplikace3.html#cb838-42" tabindex="-1"></a>    </span>
<span id="cb838-43"><a href="aplikace3.html#cb838-43" tabindex="-1"></a>    <span class="co"># Store accuracies at positions for given C and fold</span></span>
<span id="cb838-44"><a href="aplikace3.html#cb838-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb838-45"><a href="aplikace3.html#cb838-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb838-46"><a href="aplikace3.html#cb838-46" tabindex="-1"></a>    </span>
<span id="cb838-47"><a href="aplikace3.html#cb838-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb838-48"><a href="aplikace3.html#cb838-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb838-49"><a href="aplikace3.html#cb838-49" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb838-50"><a href="aplikace3.html#cb838-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb838-51"><a href="aplikace3.html#cb838-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb838-52"><a href="aplikace3.html#cb838-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb838-53"><a href="aplikace3.html#cb838-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb838-54"><a href="aplikace3.html#cb838-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb838-55"><a href="aplikace3.html#cb838-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb838-56"><a href="aplikace3.html#cb838-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb838-57"><a href="aplikace3.html#cb838-57" tabindex="-1"></a>      </span>
<span id="cb838-58"><a href="aplikace3.html#cb838-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb838-59"><a href="aplikace3.html#cb838-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb838-60"><a href="aplikace3.html#cb838-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb838-61"><a href="aplikace3.html#cb838-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb838-62"><a href="aplikace3.html#cb838-62" tabindex="-1"></a>      </span>
<span id="cb838-63"><a href="aplikace3.html#cb838-63" tabindex="-1"></a>      <span class="co"># Store accuracies at positions for given C, p, and fold</span></span>
<span id="cb838-64"><a href="aplikace3.html#cb838-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb838-65"><a href="aplikace3.html#cb838-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb838-66"><a href="aplikace3.html#cb838-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb838-67"><a href="aplikace3.html#cb838-67" tabindex="-1"></a>    }</span>
<span id="cb838-68"><a href="aplikace3.html#cb838-68" tabindex="-1"></a>        </span>
<span id="cb838-69"><a href="aplikace3.html#cb838-69" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb838-70"><a href="aplikace3.html#cb838-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb838-71"><a href="aplikace3.html#cb838-71" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb838-72"><a href="aplikace3.html#cb838-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb838-73"><a href="aplikace3.html#cb838-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb838-74"><a href="aplikace3.html#cb838-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb838-75"><a href="aplikace3.html#cb838-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb838-76"><a href="aplikace3.html#cb838-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb838-77"><a href="aplikace3.html#cb838-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb838-78"><a href="aplikace3.html#cb838-78" tabindex="-1"></a>      </span>
<span id="cb838-79"><a href="aplikace3.html#cb838-79" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb838-80"><a href="aplikace3.html#cb838-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb838-81"><a href="aplikace3.html#cb838-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb838-82"><a href="aplikace3.html#cb838-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb838-83"><a href="aplikace3.html#cb838-83" tabindex="-1"></a>      </span>
<span id="cb838-84"><a href="aplikace3.html#cb838-84" tabindex="-1"></a>      <span class="co"># Store accuracies at positions for given C, gamma, and fold</span></span>
<span id="cb838-85"><a href="aplikace3.html#cb838-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb838-86"><a href="aplikace3.html#cb838-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb838-87"><a href="aplikace3.html#cb838-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb838-88"><a href="aplikace3.html#cb838-88" tabindex="-1"></a>    }</span>
<span id="cb838-89"><a href="aplikace3.html#cb838-89" tabindex="-1"></a>  }</span>
<span id="cb838-90"><a href="aplikace3.html#cb838-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of the 10-fold CV so that for each hyperparameter value (or combination of values), we have one estimate of the validation error. We will also determine the optimal values for the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb839"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb839-1"><a href="aplikace3.html#cb839-1" tabindex="-1"></a><span class="co"># Compute average accuracies for individual C across folds</span></span>
<span id="cb839-2"><a href="aplikace3.html#cb839-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb839-3"><a href="aplikace3.html#cb839-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb839-4"><a href="aplikace3.html#cb839-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb839-5"><a href="aplikace3.html#cb839-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb839-6"><a href="aplikace3.html#cb839-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb839-7"><a href="aplikace3.html#cb839-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb839-8"><a href="aplikace3.html#cb839-8" tabindex="-1"></a></span>
<span id="cb839-9"><a href="aplikace3.html#cb839-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb839-10"><a href="aplikace3.html#cb839-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb839-11"><a href="aplikace3.html#cb839-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb839-12"><a href="aplikace3.html#cb839-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb839-13"><a href="aplikace3.html#cb839-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb839-14"><a href="aplikace3.html#cb839-14" tabindex="-1"></a></span>
<span id="cb839-15"><a href="aplikace3.html#cb839-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb839-16"><a href="aplikace3.html#cb839-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb839-17"><a href="aplikace3.html#cb839-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb839-18"><a href="aplikace3.html#cb839-18" tabindex="-1"></a></span>
<span id="cb839-19"><a href="aplikace3.html#cb839-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb839-20"><a href="aplikace3.html#cb839-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb839-21"><a href="aplikace3.html#cb839-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb839-22"><a href="aplikace3.html#cb839-22" tabindex="-1"></a></span>
<span id="cb839-23"><a href="aplikace3.html#cb839-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb839-24"><a href="aplikace3.html#cb839-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb839-25"><a href="aplikace3.html#cb839-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For the <em>linear kernel</em>, we have the optimal value of <span class="math inline">\(C\)</span> equal to 0.1, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 0.1, and for the <em>radial kernel</em>, we have two optimal values: for <span class="math inline">\(C\)</span>, the optimal value is 100 and for <span class="math inline">\(\gamma\)</span>, it is 1. The validation errors are 0.3417857 for linear, 0.3292857 for polynomial, and 0.3222024 for radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training data using the hyperparameter values determined through 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb840"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb840-1"><a href="aplikace3.html#cb840-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb840-2"><a href="aplikace3.html#cb840-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb840-3"><a href="aplikace3.html#cb840-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb840-4"><a href="aplikace3.html#cb840-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb840-5"><a href="aplikace3.html#cb840-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb840-6"><a href="aplikace3.html#cb840-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb840-7"><a href="aplikace3.html#cb840-7" tabindex="-1"></a></span>
<span id="cb840-8"><a href="aplikace3.html#cb840-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb840-9"><a href="aplikace3.html#cb840-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb840-10"><a href="aplikace3.html#cb840-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb840-11"><a href="aplikace3.html#cb840-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb840-12"><a href="aplikace3.html#cb840-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb840-13"><a href="aplikace3.html#cb840-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb840-14"><a href="aplikace3.html#cb840-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb840-15"><a href="aplikace3.html#cb840-15" tabindex="-1"></a></span>
<span id="cb840-16"><a href="aplikace3.html#cb840-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb840-17"><a href="aplikace3.html#cb840-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb840-18"><a href="aplikace3.html#cb840-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb840-19"><a href="aplikace3.html#cb840-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb840-20"><a href="aplikace3.html#cb840-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb840-21"><a href="aplikace3.html#cb840-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb840-22"><a href="aplikace3.html#cb840-22" tabindex="-1"></a></span>
<span id="cb840-23"><a href="aplikace3.html#cb840-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb840-24"><a href="aplikace3.html#cb840-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb840-25"><a href="aplikace3.html#cb840-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb840-26"><a href="aplikace3.html#cb840-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb840-27"><a href="aplikace3.html#cb840-27" tabindex="-1"></a></span>
<span id="cb840-28"><a href="aplikace3.html#cb840-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb840-29"><a href="aplikace3.html#cb840-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb840-30"><a href="aplikace3.html#cb840-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb840-31"><a href="aplikace3.html#cb840-31" tabindex="-1"></a></span>
<span id="cb840-32"><a href="aplikace3.html#cb840-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb840-33"><a href="aplikace3.html#cb840-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb840-34"><a href="aplikace3.html#cb840-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb840-35"><a href="aplikace3.html#cb840-35" tabindex="-1"></a>  </span>
<span id="cb840-36"><a href="aplikace3.html#cb840-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb840-37"><a href="aplikace3.html#cb840-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb840-38"><a href="aplikace3.html#cb840-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb840-39"><a href="aplikace3.html#cb840-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb840-40"><a href="aplikace3.html#cb840-40" tabindex="-1"></a></span>
<span id="cb840-41"><a href="aplikace3.html#cb840-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb840-42"><a href="aplikace3.html#cb840-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb840-43"><a href="aplikace3.html#cb840-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb840-44"><a href="aplikace3.html#cb840-44" tabindex="-1"></a></span>
<span id="cb840-45"><a href="aplikace3.html#cb840-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb840-46"><a href="aplikace3.html#cb840-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb840-47"><a href="aplikace3.html#cb840-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the principal component scores on the training data is 32 % for the linear kernel, 33.33 % for the polynomial kernel, and 17.33 % for the Gaussian kernel. On the test data, the error rates are 30.7692 % for the linear kernel, 27.6923 % for the polynomial kernel, and 40 % for the radial kernel.</p>
<p>For graphical representation of the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, as done in previous cases when we plotted the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb841"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb841-1"><a href="aplikace3.html#cb841-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb841-2"><a href="aplikace3.html#cb841-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb841-3"><a href="aplikace3.html#cb841-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb841-4"><a href="aplikace3.html#cb841-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb841-5"><a href="aplikace3.html#cb841-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb841-6"><a href="aplikace3.html#cb841-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb841-7"><a href="aplikace3.html#cb841-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb841-8"><a href="aplikace3.html#cb841-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb841-9"><a href="aplikace3.html#cb841-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb841-10"><a href="aplikace3.html#cb841-10" tabindex="-1"></a></span>
<span id="cb841-11"><a href="aplikace3.html#cb841-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb841-12"><a href="aplikace3.html#cb841-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb841-13"><a href="aplikace3.html#cb841-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb841-14"><a href="aplikace3.html#cb841-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb841-15"><a href="aplikace3.html#cb841-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb841-16"><a href="aplikace3.html#cb841-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb841-17"><a href="aplikace3.html#cb841-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Fat content&#39;</span>, </span>
<span id="cb841-18"><a href="aplikace3.html#cb841-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span></span>
<span id="cb841-19"><a href="aplikace3.html#cb841-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="sc">+</span></span>
<span id="cb841-20"><a href="aplikace3.html#cb841-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb841-21"><a href="aplikace3.html#cb841-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb841-22"><a href="aplikace3.html#cb841-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-84"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-84-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes is shown in black, constructed using the SVM method." width="672" />
<p class="caption">
Figure 3.4: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes is shown in black, constructed using the SVM method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb842"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb842-1"><a href="aplikace3.html#cb842-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb842-2"><a href="aplikace3.html#cb842-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb842-3"><a href="aplikace3.html#cb842-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb842-4"><a href="aplikace3.html#cb842-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb842-5"><a href="aplikace3.html#cb842-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb842-6"><a href="aplikace3.html#cb842-6" tabindex="-1"></a></span>
<span id="cb842-7"><a href="aplikace3.html#cb842-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVMA3" class="section level4 hasAnchor" number="6.3.7.4">
<h4><span class="header-section-number">6.3.7.4</span> Basis Coefficients<a href="aplikace3.html#basis-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we use a B-spline basis to express the functions. For all three kernels, we examine the values of hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{3}]\)</span>. For the polynomial kernel, we fix the hyperparameter <span class="math inline">\(p\)</span> at 3, as other integer values do not yield nearly as good results. On the other hand, for the radial kernel, we again use 10-fold CV to select the optimal value of hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-4}, 10^{0}]\)</span>. We set <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb843"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb843-1"><a href="aplikace3.html#cb843-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb843-2"><a href="aplikace3.html#cb843-2" tabindex="-1"></a></span>
<span id="cb843-3"><a href="aplikace3.html#cb843-3" tabindex="-1"></a><span class="co"># gamma values to consider</span></span>
<span id="cb843-4"><a href="aplikace3.html#cb843-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb843-5"><a href="aplikace3.html#cb843-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb843-6"><a href="aplikace3.html#cb843-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb843-7"><a href="aplikace3.html#cb843-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb843-8"><a href="aplikace3.html#cb843-8" tabindex="-1"></a></span>
<span id="cb843-9"><a href="aplikace3.html#cb843-9" tabindex="-1"></a><span class="co"># list with three components...array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb843-10"><a href="aplikace3.html#cb843-10" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb843-11"><a href="aplikace3.html#cb843-11" tabindex="-1"></a><span class="co"># columns hold accuracy values for given</span></span>
<span id="cb843-12"><a href="aplikace3.html#cb843-12" tabindex="-1"></a><span class="co"># rows represent values for given gamma, and layers correspond to folds</span></span>
<span id="cb843-13"><a href="aplikace3.html#cb843-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb843-14"><a href="aplikace3.html#cb843-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb843-15"><a href="aplikace3.html#cb843-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb843-16"><a href="aplikace3.html#cb843-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb843-17"><a href="aplikace3.html#cb843-17" tabindex="-1"></a>)</span>
<span id="cb843-18"><a href="aplikace3.html#cb843-18" tabindex="-1"></a></span>
<span id="cb843-19"><a href="aplikace3.html#cb843-19" tabindex="-1"></a><span class="co"># first iterate through values of C</span></span>
<span id="cb843-20"><a href="aplikace3.html#cb843-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb843-21"><a href="aplikace3.html#cb843-21" tabindex="-1"></a>  <span class="co"># iterate over individual folds</span></span>
<span id="cb843-22"><a href="aplikace3.html#cb843-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb843-23"><a href="aplikace3.html#cb843-23" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb843-24"><a href="aplikace3.html#cb843-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb843-25"><a href="aplikace3.html#cb843-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb843-26"><a href="aplikace3.html#cb843-26" tabindex="-1"></a>    </span>
<span id="cb843-27"><a href="aplikace3.html#cb843-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb843-28"><a href="aplikace3.html#cb843-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb843-29"><a href="aplikace3.html#cb843-29" tabindex="-1"></a>    </span>
<span id="cb843-30"><a href="aplikace3.html#cb843-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb843-31"><a href="aplikace3.html#cb843-31" tabindex="-1"></a>    <span class="co"># model creation</span></span>
<span id="cb843-32"><a href="aplikace3.html#cb843-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb843-33"><a href="aplikace3.html#cb843-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb843-34"><a href="aplikace3.html#cb843-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb843-35"><a href="aplikace3.html#cb843-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb843-36"><a href="aplikace3.html#cb843-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb843-37"><a href="aplikace3.html#cb843-37" tabindex="-1"></a>    </span>
<span id="cb843-38"><a href="aplikace3.html#cb843-38" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb843-39"><a href="aplikace3.html#cb843-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb843-40"><a href="aplikace3.html#cb843-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb843-41"><a href="aplikace3.html#cb843-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb843-42"><a href="aplikace3.html#cb843-42" tabindex="-1"></a>    </span>
<span id="cb843-43"><a href="aplikace3.html#cb843-43" tabindex="-1"></a>    <span class="co"># insert accuracies in positions for given C and fold</span></span>
<span id="cb843-44"><a href="aplikace3.html#cb843-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb843-45"><a href="aplikace3.html#cb843-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb843-46"><a href="aplikace3.html#cb843-46" tabindex="-1"></a>    </span>
<span id="cb843-47"><a href="aplikace3.html#cb843-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb843-48"><a href="aplikace3.html#cb843-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb843-49"><a href="aplikace3.html#cb843-49" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb843-50"><a href="aplikace3.html#cb843-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb843-51"><a href="aplikace3.html#cb843-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb843-52"><a href="aplikace3.html#cb843-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb843-53"><a href="aplikace3.html#cb843-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb843-54"><a href="aplikace3.html#cb843-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb843-55"><a href="aplikace3.html#cb843-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb843-56"><a href="aplikace3.html#cb843-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb843-57"><a href="aplikace3.html#cb843-57" tabindex="-1"></a>      </span>
<span id="cb843-58"><a href="aplikace3.html#cb843-58" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb843-59"><a href="aplikace3.html#cb843-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb843-60"><a href="aplikace3.html#cb843-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb843-61"><a href="aplikace3.html#cb843-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb843-62"><a href="aplikace3.html#cb843-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb843-63"><a href="aplikace3.html#cb843-63" tabindex="-1"></a>      </span>
<span id="cb843-64"><a href="aplikace3.html#cb843-64" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, p, and fold</span></span>
<span id="cb843-65"><a href="aplikace3.html#cb843-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb843-66"><a href="aplikace3.html#cb843-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb843-67"><a href="aplikace3.html#cb843-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb843-68"><a href="aplikace3.html#cb843-68" tabindex="-1"></a>    }</span>
<span id="cb843-69"><a href="aplikace3.html#cb843-69" tabindex="-1"></a>        </span>
<span id="cb843-70"><a href="aplikace3.html#cb843-70" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb843-71"><a href="aplikace3.html#cb843-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb843-72"><a href="aplikace3.html#cb843-72" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb843-73"><a href="aplikace3.html#cb843-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb843-74"><a href="aplikace3.html#cb843-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb843-75"><a href="aplikace3.html#cb843-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb843-76"><a href="aplikace3.html#cb843-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb843-77"><a href="aplikace3.html#cb843-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb843-78"><a href="aplikace3.html#cb843-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb843-79"><a href="aplikace3.html#cb843-79" tabindex="-1"></a>      </span>
<span id="cb843-80"><a href="aplikace3.html#cb843-80" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb843-81"><a href="aplikace3.html#cb843-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb843-82"><a href="aplikace3.html#cb843-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb843-83"><a href="aplikace3.html#cb843-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb843-84"><a href="aplikace3.html#cb843-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb843-85"><a href="aplikace3.html#cb843-85" tabindex="-1"></a>      </span>
<span id="cb843-86"><a href="aplikace3.html#cb843-86" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, gamma, and fold</span></span>
<span id="cb843-87"><a href="aplikace3.html#cb843-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb843-88"><a href="aplikace3.html#cb843-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb843-89"><a href="aplikace3.html#cb843-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb843-90"><a href="aplikace3.html#cb843-90" tabindex="-1"></a>    }</span>
<span id="cb843-91"><a href="aplikace3.html#cb843-91" tabindex="-1"></a>  }</span>
<span id="cb843-92"><a href="aplikace3.html#cb843-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results from 10-fold cross-validation so that we have a single estimate of validation error for each hyperparameter value (or combination of values). We will also determine the optimal values for each of the hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb844"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb844-1"><a href="aplikace3.html#cb844-1" tabindex="-1"></a><span class="co"># let&#39;s calculate the average accuracies for individual C over folds</span></span>
<span id="cb844-2"><a href="aplikace3.html#cb844-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb844-3"><a href="aplikace3.html#cb844-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb844-4"><a href="aplikace3.html#cb844-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb844-5"><a href="aplikace3.html#cb844-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb844-6"><a href="aplikace3.html#cb844-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb844-7"><a href="aplikace3.html#cb844-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb844-8"><a href="aplikace3.html#cb844-8" tabindex="-1"></a></span>
<span id="cb844-9"><a href="aplikace3.html#cb844-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb844-10"><a href="aplikace3.html#cb844-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb844-11"><a href="aplikace3.html#cb844-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb844-12"><a href="aplikace3.html#cb844-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb844-13"><a href="aplikace3.html#cb844-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb844-14"><a href="aplikace3.html#cb844-14" tabindex="-1"></a></span>
<span id="cb844-15"><a href="aplikace3.html#cb844-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb844-16"><a href="aplikace3.html#cb844-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb844-17"><a href="aplikace3.html#cb844-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb844-18"><a href="aplikace3.html#cb844-18" tabindex="-1"></a></span>
<span id="cb844-19"><a href="aplikace3.html#cb844-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb844-20"><a href="aplikace3.html#cb844-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb844-21"><a href="aplikace3.html#cb844-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb844-22"><a href="aplikace3.html#cb844-22" tabindex="-1"></a></span>
<span id="cb844-23"><a href="aplikace3.html#cb844-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb844-24"><a href="aplikace3.html#cb844-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb844-25"><a href="aplikace3.html#cb844-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 10, for <em>polynomial kernel</em>, <span class="math inline">\(C\)</span> is 100, and for <em>radial kernel</em>, we have two optimal values; for <span class="math inline">\(C\)</span>, the optimal value is 100 and for <span class="math inline">\(\gamma\)</span>, it is 0.01. The validation errors are 0.0195833 for linear, 0.0325 for polynomial, and 0.0392262 for radial kernel.</p>
<p>Finally, we can build the final classifiers on the entire training data with hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb845"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb845-1"><a href="aplikace3.html#cb845-1" tabindex="-1"></a><span class="co"># building the models</span></span>
<span id="cb845-2"><a href="aplikace3.html#cb845-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb845-3"><a href="aplikace3.html#cb845-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb845-4"><a href="aplikace3.html#cb845-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb845-5"><a href="aplikace3.html#cb845-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb845-6"><a href="aplikace3.html#cb845-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb845-7"><a href="aplikace3.html#cb845-7" tabindex="-1"></a></span>
<span id="cb845-8"><a href="aplikace3.html#cb845-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb845-9"><a href="aplikace3.html#cb845-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb845-10"><a href="aplikace3.html#cb845-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb845-11"><a href="aplikace3.html#cb845-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb845-12"><a href="aplikace3.html#cb845-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb845-13"><a href="aplikace3.html#cb845-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb845-14"><a href="aplikace3.html#cb845-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb845-15"><a href="aplikace3.html#cb845-15" tabindex="-1"></a></span>
<span id="cb845-16"><a href="aplikace3.html#cb845-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb845-17"><a href="aplikace3.html#cb845-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb845-18"><a href="aplikace3.html#cb845-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb845-19"><a href="aplikace3.html#cb845-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb845-20"><a href="aplikace3.html#cb845-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb845-21"><a href="aplikace3.html#cb845-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb845-22"><a href="aplikace3.html#cb845-22" tabindex="-1"></a></span>
<span id="cb845-23"><a href="aplikace3.html#cb845-23" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb845-24"><a href="aplikace3.html#cb845-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb845-25"><a href="aplikace3.html#cb845-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb845-26"><a href="aplikace3.html#cb845-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb845-27"><a href="aplikace3.html#cb845-27" tabindex="-1"></a></span>
<span id="cb845-28"><a href="aplikace3.html#cb845-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb845-29"><a href="aplikace3.html#cb845-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb845-30"><a href="aplikace3.html#cb845-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb845-31"><a href="aplikace3.html#cb845-31" tabindex="-1"></a></span>
<span id="cb845-32"><a href="aplikace3.html#cb845-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb845-33"><a href="aplikace3.html#cb845-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb845-34"><a href="aplikace3.html#cb845-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb845-35"><a href="aplikace3.html#cb845-35" tabindex="-1"></a>  </span>
<span id="cb845-36"><a href="aplikace3.html#cb845-36" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb845-37"><a href="aplikace3.html#cb845-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb845-38"><a href="aplikace3.html#cb845-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb845-39"><a href="aplikace3.html#cb845-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb845-40"><a href="aplikace3.html#cb845-40" tabindex="-1"></a></span>
<span id="cb845-41"><a href="aplikace3.html#cb845-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb845-42"><a href="aplikace3.html#cb845-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb845-43"><a href="aplikace3.html#cb845-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb845-44"><a href="aplikace3.html#cb845-44" tabindex="-1"></a></span>
<span id="cb845-45"><a href="aplikace3.html#cb845-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb845-46"><a href="aplikace3.html#cb845-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb845-47"><a href="aplikace3.html#cb845-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the base coefficients on the training data is 0.67 % for the linear kernel, 0.67 % for the polynomial kernel, and 1.33 % for the Gaussian kernel. On the test data, the error rate is 6.1538 % for the linear kernel, 9.2308 % for the polynomial kernel, and 6.1538 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb846"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb846-1"><a href="aplikace3.html#cb846-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb846-2"><a href="aplikace3.html#cb846-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb846-3"><a href="aplikace3.html#cb846-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb846-4"><a href="aplikace3.html#cb846-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb846-5"><a href="aplikace3.html#cb846-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb846-6"><a href="aplikace3.html#cb846-6" tabindex="-1"></a></span>
<span id="cb846-7"><a href="aplikace3.html#cb846-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVMA3" class="section level4 hasAnchor" number="6.3.7.5">
<h4><span class="header-section-number">6.3.7.5</span> Projection onto B-spline Basis<a href="aplikace3.html#projection-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way to apply the classic SVM method to functional data is to project the original data onto some <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal H\)</span>, denoted as <span class="math inline">\(V_d\)</span>. Let’s assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>. We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, which we can express as</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Now we can use the coefficients from the orthogonal projection for classification, applying standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>. By using this transformation, we have defined a new, so-called adapted kernel, which consists of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector machine. Thus, we have the (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>. This is a dimensionality reduction method that we can call <em>filtering</em>.</p>
<p>For the actual projection, we will use the <code>project.basis()</code> function from the <code>fda</code> library in <code>R</code>. Its input will be a matrix of the original discrete (unsmoothed) data, the values in which we measure values in the original data matrix, and the basis object onto which we want to project the data. We choose to project onto a B-spline basis because the use of a Fourier basis is not suitable for our non-periodic data.</p>
<p>The dimension <span class="math inline">\(d\)</span> is chosen either based on some prior expert knowledge or through cross-validation. In our case, we will determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (with <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method; commonly <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span> is chosen). We require B-splines of order 4, and the relationship for the number of basis functions is given by</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>. However, in <code>R</code>, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and for large values of <span class="math inline">\(n_{basis}\)</span>, we risk overfitting the model. Thus, we choose a maximum of <span class="math inline">\(n_{basis}\)</span> to be a smaller number, say 20.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb847"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb847-1"><a href="aplikace3.html#cb847-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb847-2"><a href="aplikace3.html#cb847-2" tabindex="-1"></a></span>
<span id="cb847-3"><a href="aplikace3.html#cb847-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb847-4"><a href="aplikace3.html#cb847-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb847-5"><a href="aplikace3.html#cb847-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb847-6"><a href="aplikace3.html#cb847-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb847-7"><a href="aplikace3.html#cb847-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb847-8"><a href="aplikace3.html#cb847-8" tabindex="-1"></a></span>
<span id="cb847-9"><a href="aplikace3.html#cb847-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># All dimensions we want to try</span></span>
<span id="cb847-10"><a href="aplikace3.html#cb847-10" tabindex="-1"></a></span>
<span id="cb847-11"><a href="aplikace3.html#cb847-11" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb847-12"><a href="aplikace3.html#cb847-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb847-13"><a href="aplikace3.html#cb847-13" tabindex="-1"></a></span>
<span id="cb847-14"><a href="aplikace3.html#cb847-14" tabindex="-1"></a><span class="co"># List with three components ... matrices for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb847-15"><a href="aplikace3.html#cb847-15" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb847-16"><a href="aplikace3.html#cb847-16" tabindex="-1"></a><span class="co"># Columns will be accuracy values for a given part of the training set</span></span>
<span id="cb847-17"><a href="aplikace3.html#cb847-17" tabindex="-1"></a><span class="co"># Rows will correspond to values for a given dimension</span></span>
<span id="cb847-18"><a href="aplikace3.html#cb847-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb847-19"><a href="aplikace3.html#cb847-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb847-20"><a href="aplikace3.html#cb847-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb847-21"><a href="aplikace3.html#cb847-21" tabindex="-1"></a></span>
<span id="cb847-22"><a href="aplikace3.html#cb847-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb847-23"><a href="aplikace3.html#cb847-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb847-24"><a href="aplikace3.html#cb847-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb847-25"><a href="aplikace3.html#cb847-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb847-26"><a href="aplikace3.html#cb847-26" tabindex="-1"></a>  </span>
<span id="cb847-27"><a href="aplikace3.html#cb847-27" tabindex="-1"></a>  <span class="co"># Projecting discrete data onto B-spline basis of dimension d</span></span>
<span id="cb847-28"><a href="aplikace3.html#cb847-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># Matrix of discrete data</span></span>
<span id="cb847-29"><a href="aplikace3.html#cb847-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># Vector of arguments</span></span>
<span id="cb847-30"><a href="aplikace3.html#cb847-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># Basis object</span></span>
<span id="cb847-31"><a href="aplikace3.html#cb847-31" tabindex="-1"></a>  </span>
<span id="cb847-32"><a href="aplikace3.html#cb847-32" tabindex="-1"></a>  <span class="co"># Splitting into training and testing data for CV</span></span>
<span id="cb847-33"><a href="aplikace3.html#cb847-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb847-34"><a href="aplikace3.html#cb847-34" tabindex="-1"></a>  </span>
<span id="cb847-35"><a href="aplikace3.html#cb847-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb847-36"><a href="aplikace3.html#cb847-36" tabindex="-1"></a>    <span class="co"># Define test and training parts for CV</span></span>
<span id="cb847-37"><a href="aplikace3.html#cb847-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb847-38"><a href="aplikace3.html#cb847-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb847-39"><a href="aplikace3.html#cb847-39" tabindex="-1"></a>    </span>
<span id="cb847-40"><a href="aplikace3.html#cb847-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb847-41"><a href="aplikace3.html#cb847-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb847-42"><a href="aplikace3.html#cb847-42" tabindex="-1"></a>    </span>
<span id="cb847-43"><a href="aplikace3.html#cb847-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb847-44"><a href="aplikace3.html#cb847-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb847-45"><a href="aplikace3.html#cb847-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb847-46"><a href="aplikace3.html#cb847-46" tabindex="-1"></a>  </span>
<span id="cb847-47"><a href="aplikace3.html#cb847-47" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb847-48"><a href="aplikace3.html#cb847-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb847-49"><a href="aplikace3.html#cb847-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb847-50"><a href="aplikace3.html#cb847-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb847-51"><a href="aplikace3.html#cb847-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb847-52"><a href="aplikace3.html#cb847-52" tabindex="-1"></a>    </span>
<span id="cb847-53"><a href="aplikace3.html#cb847-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb847-54"><a href="aplikace3.html#cb847-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb847-55"><a href="aplikace3.html#cb847-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb847-56"><a href="aplikace3.html#cb847-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb847-57"><a href="aplikace3.html#cb847-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb847-58"><a href="aplikace3.html#cb847-58" tabindex="-1"></a>    </span>
<span id="cb847-59"><a href="aplikace3.html#cb847-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb847-60"><a href="aplikace3.html#cb847-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb847-61"><a href="aplikace3.html#cb847-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb847-62"><a href="aplikace3.html#cb847-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb847-63"><a href="aplikace3.html#cb847-63" tabindex="-1"></a>      </span>
<span id="cb847-64"><a href="aplikace3.html#cb847-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb847-65"><a href="aplikace3.html#cb847-65" tabindex="-1"></a>    <span class="do">## Linear kernel</span></span>
<span id="cb847-66"><a href="aplikace3.html#cb847-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb847-67"><a href="aplikace3.html#cb847-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb847-68"><a href="aplikace3.html#cb847-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb847-69"><a href="aplikace3.html#cb847-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb847-70"><a href="aplikace3.html#cb847-70" tabindex="-1"></a>    <span class="do">## Polynomial kernel</span></span>
<span id="cb847-71"><a href="aplikace3.html#cb847-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb847-72"><a href="aplikace3.html#cb847-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb847-73"><a href="aplikace3.html#cb847-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb847-74"><a href="aplikace3.html#cb847-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb847-75"><a href="aplikace3.html#cb847-75" tabindex="-1"></a>    <span class="do">## Radial kernel</span></span>
<span id="cb847-76"><a href="aplikace3.html#cb847-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb847-77"><a href="aplikace3.html#cb847-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb847-78"><a href="aplikace3.html#cb847-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb847-79"><a href="aplikace3.html#cb847-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb847-80"><a href="aplikace3.html#cb847-80" tabindex="-1"></a>    </span>
<span id="cb847-81"><a href="aplikace3.html#cb847-81" tabindex="-1"></a>    <span class="co"># Store accuracies in positions for given d and fold</span></span>
<span id="cb847-82"><a href="aplikace3.html#cb847-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb847-83"><a href="aplikace3.html#cb847-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb847-84"><a href="aplikace3.html#cb847-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb847-85"><a href="aplikace3.html#cb847-85" tabindex="-1"></a>  }</span>
<span id="cb847-86"><a href="aplikace3.html#cb847-86" tabindex="-1"></a>}</span>
<span id="cb847-87"><a href="aplikace3.html#cb847-87" tabindex="-1"></a>  </span>
<span id="cb847-88"><a href="aplikace3.html#cb847-88" tabindex="-1"></a><span class="co"># Compute average accuracies for each d across folds</span></span>
<span id="cb847-89"><a href="aplikace3.html#cb847-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb847-90"><a href="aplikace3.html#cb847-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb847-91"><a href="aplikace3.html#cb847-91" tabindex="-1"></a>}</span>
<span id="cb847-92"><a href="aplikace3.html#cb847-92" tabindex="-1"></a></span>
<span id="cb847-93"><a href="aplikace3.html#cb847-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb847-94"><a href="aplikace3.html#cb847-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb847-95"><a href="aplikace3.html#cb847-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb847-96"><a href="aplikace3.html#cb847-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb847-97"><a href="aplikace3.html#cb847-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb847-98"><a href="aplikace3.html#cb847-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb847-99"><a href="aplikace3.html#cb847-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb847-100"><a href="aplikace3.html#cb847-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear     9 0.01958333
## poly       7 0.03297619
## radial     6 0.14125000</code></pre>
<p>We see that the optimal value of the parameter <span class="math inline">\(d\)</span> is 9 for the linear kernel with an error rate calculated using 10-fold CV of 0.0196, 7 for the polynomial kernel with an error rate calculated using 10-fold CV of 0.033, and 6 for the radial kernel with an error rate of 0.1412.</p>
<p>For clarity, let’s plot the validation error rates as a function of the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb849"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb849-1"><a href="aplikace3.html#cb849-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb849-2"><a href="aplikace3.html#cb849-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb849-3"><a href="aplikace3.html#cb849-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb849-4"><a href="aplikace3.html#cb849-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb849-5"><a href="aplikace3.html#cb849-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb849-6"><a href="aplikace3.html#cb849-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb849-7"><a href="aplikace3.html#cb849-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb849-8"><a href="aplikace3.html#cb849-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb849-9"><a href="aplikace3.html#cb849-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb849-10"><a href="aplikace3.html#cb849-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb849-11"><a href="aplikace3.html#cb849-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb849-12"><a href="aplikace3.html#cb849-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb849-13"><a href="aplikace3.html#cb849-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb849-14"><a href="aplikace3.html#cb849-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb849-15"><a href="aplikace3.html#cb849-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>,</span>
<span id="cb849-16"><a href="aplikace3.html#cb849-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span> </span>
<span id="cb849-17"><a href="aplikace3.html#cb849-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb849-18"><a href="aplikace3.html#cb849-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-91-1.png" alt="Dependence of validation error on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The optimal values of the dimension $V_d$ for each kernel function are marked with black dots." width="672" />
<p class="caption">
Figure 1.23: Dependence of validation error on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The optimal values of the dimension <span class="math inline">\(V_d\)</span> for each kernel function are marked with black dots.
</p>
</div>
<p>Now we can train individual classifiers on all training data and examine their performance on the test data. For each kernel function, we choose the dimension of the subspace onto which we project based on the results of cross-validation.</p>
<p>In the variable <code>Projection</code>, we have stored the matrix of coefficients for the orthogonal projection, which is given by</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb850"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb850-1"><a href="aplikace3.html#cb850-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb850-2"><a href="aplikace3.html#cb850-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb850-3"><a href="aplikace3.html#cb850-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb850-4"><a href="aplikace3.html#cb850-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb850-5"><a href="aplikace3.html#cb850-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb850-6"><a href="aplikace3.html#cb850-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb850-7"><a href="aplikace3.html#cb850-7" tabindex="-1"></a></span>
<span id="cb850-8"><a href="aplikace3.html#cb850-8" tabindex="-1"></a><span class="co"># Loop through the individual kernels</span></span>
<span id="cb850-9"><a href="aplikace3.html#cb850-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb850-10"><a href="aplikace3.html#cb850-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb850-11"><a href="aplikace3.html#cb850-11" tabindex="-1"></a>  <span class="co"># Create the base object</span></span>
<span id="cb850-12"><a href="aplikace3.html#cb850-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb850-13"><a href="aplikace3.html#cb850-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb850-14"><a href="aplikace3.html#cb850-14" tabindex="-1"></a>  </span>
<span id="cb850-15"><a href="aplikace3.html#cb850-15" tabindex="-1"></a>  <span class="co"># Project discrete data onto the B-spline basis</span></span>
<span id="cb850-16"><a href="aplikace3.html#cb850-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb850-17"><a href="aplikace3.html#cb850-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb850-18"><a href="aplikace3.html#cb850-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb850-19"><a href="aplikace3.html#cb850-19" tabindex="-1"></a>  </span>
<span id="cb850-20"><a href="aplikace3.html#cb850-20" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb850-21"><a href="aplikace3.html#cb850-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb850-22"><a href="aplikace3.html#cb850-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb850-23"><a href="aplikace3.html#cb850-23" tabindex="-1"></a>  </span>
<span id="cb850-24"><a href="aplikace3.html#cb850-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb850-25"><a href="aplikace3.html#cb850-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb850-26"><a href="aplikace3.html#cb850-26" tabindex="-1"></a>  </span>
<span id="cb850-27"><a href="aplikace3.html#cb850-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb850-28"><a href="aplikace3.html#cb850-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb850-29"><a href="aplikace3.html#cb850-29" tabindex="-1"></a>  </span>
<span id="cb850-30"><a href="aplikace3.html#cb850-30" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb850-31"><a href="aplikace3.html#cb850-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb850-32"><a href="aplikace3.html#cb850-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb850-33"><a href="aplikace3.html#cb850-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb850-34"><a href="aplikace3.html#cb850-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb850-35"><a href="aplikace3.html#cb850-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb850-36"><a href="aplikace3.html#cb850-36" tabindex="-1"></a>  </span>
<span id="cb850-37"><a href="aplikace3.html#cb850-37" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb850-38"><a href="aplikace3.html#cb850-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb850-39"><a href="aplikace3.html#cb850-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb850-40"><a href="aplikace3.html#cb850-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb850-41"><a href="aplikace3.html#cb850-41" tabindex="-1"></a>    </span>
<span id="cb850-42"><a href="aplikace3.html#cb850-42" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb850-43"><a href="aplikace3.html#cb850-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb850-44"><a href="aplikace3.html#cb850-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb850-45"><a href="aplikace3.html#cb850-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb850-46"><a href="aplikace3.html#cb850-46" tabindex="-1"></a>  </span>
<span id="cb850-47"><a href="aplikace3.html#cb850-47" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb850-48"><a href="aplikace3.html#cb850-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb850-49"><a href="aplikace3.html#cb850-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is therefore 2 % for the linear kernel, 2.67 % for the polynomial kernel, and 9.33 % for the Gaussian kernel. The error rate of the method on the test data is then 6.15 % for the linear kernel, 6.15 % for the polynomial kernel, and 10.77 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb851"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb851-1"><a href="aplikace3.html#cb851-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVMA3" class="section level4 hasAnchor" number="6.3.7.6">
<h4><span class="header-section-number">6.3.7.6</span> RKHS + SVM<a href="aplikace3.html#RKHS-SVMA3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section, we will explore another way to utilize the support vector machine (SVM) method for the classification of functional data. Again, we will follow the familiar principle of expressing functional data as finite-dimensional objects, to which we then apply the traditional SVM method.</p>
<p>However, this time we will use SVM for the representation of functional data itself through a certain finite-dimensional object. As the name suggests, it combines two concepts: the support vector machine and a space known in English literature as the <em>Reproducing Kernel Hilbert Space</em> (RKHS). The key concept for this space is the <em>kernel</em>.</p>
<div id="implementation-of-the-method-in-r-3" class="section level5 hasAnchor" number="6.3.7.6.1">
<h5><span class="header-section-number">6.3.7.6.1</span> Implementation of the method in <code>R</code><a href="aplikace3.html#implementation-of-the-method-in-r-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>From the last part of Theorem <a href="simulace3.html#thm:MaG">1.3</a>, we derive how to compute the representations of curves in practice. We will work with discretized data after smoothing the curves. First, let’s define the kernel for the RKHS space. We will use the Gaussian kernel with the parameter <span class="math inline">\(\gamma\)</span>. The value of this hyperparameter significantly affects the behavior and success of the method, so we must pay special attention to its choice (we will select it using cross-validation).</p>
<p>After trying several options, good hyperparameter choices appear to be <span class="math inline">\(\varepsilon = 0.01\)</span> and <span class="math inline">\(C = 1\)</span>. Due to computational demands, we will not estimate these hyperparameters using CV.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb852"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb852-1"><a href="aplikace3.html#cb852-1" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb852-2"><a href="aplikace3.html#cb852-2" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">1</span> </span></code></pre></div>
</details>
<div id="gaussian-kernel-5" class="section level6 hasAnchor" number="6.3.7.6.1.1">
<h6><span class="header-section-number">6.3.7.6.1.1</span> Gaussian Kernel<a href="aplikace3.html#gaussian-kernel-5" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb853"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb853-1"><a href="aplikace3.html#cb853-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb853-2"><a href="aplikace3.html#cb853-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb853-3"><a href="aplikace3.html#cb853-3" tabindex="-1"></a><span class="co"># Add the test data</span></span>
<span id="cb853-4"><a href="aplikace3.html#cb853-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb853-5"><a href="aplikace3.html#cb853-5" tabindex="-1"></a></span>
<span id="cb853-6"><a href="aplikace3.html#cb853-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb853-7"><a href="aplikace3.html#cb853-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb853-8"><a href="aplikace3.html#cb853-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb853-9"><a href="aplikace3.html#cb853-9" tabindex="-1"></a>}</span>
<span id="cb853-10"><a href="aplikace3.html#cb853-10" tabindex="-1"></a></span>
<span id="cb853-11"><a href="aplikace3.html#cb853-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb853-12"><a href="aplikace3.html#cb853-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb853-13"><a href="aplikace3.html#cb853-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb853-14"><a href="aplikace3.html#cb853-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb853-15"><a href="aplikace3.html#cb853-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb853-16"><a href="aplikace3.html#cb853-16" tabindex="-1"></a>    }</span>
<span id="cb853-17"><a href="aplikace3.html#cb853-17" tabindex="-1"></a>  }</span>
<span id="cb853-18"><a href="aplikace3.html#cb853-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb853-19"><a href="aplikace3.html#cb853-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s compute the matrix <span class="math inline">\(K_S\)</span> and its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb854"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb854-1"><a href="aplikace3.html#cb854-1" tabindex="-1"></a><span class="co"># Compute the matrix K</span></span>
<span id="cb854-2"><a href="aplikace3.html#cb854-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># fixed value for gamma; we will determine the optimal value using CV</span></span>
<span id="cb854-3"><a href="aplikace3.html#cb854-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb854-4"><a href="aplikace3.html#cb854-4" tabindex="-1"></a></span>
<span id="cb854-5"><a href="aplikace3.html#cb854-5" tabindex="-1"></a><span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb854-6"><a href="aplikace3.html#cb854-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb854-7"><a href="aplikace3.html#cb854-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb854-8"><a href="aplikace3.html#cb854-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To compute the coefficients in the representation of curves, that is, the calculation of vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat d l}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we also need the coefficients from SVM. Unlike the classification problem, we are now dealing with a regression problem since we are trying to express our observed curves in some (chosen by us via the kernel <span class="math inline">\(K\)</span>) basis. Thus, we will use the <em>Support Vector Regression</em> method, from which we will subsequently obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb855"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb855-1"><a href="aplikace3.html#cb855-1" tabindex="-1"></a><span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb855-2"><a href="aplikace3.html#cb855-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb855-3"><a href="aplikace3.html#cb855-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb855-4"><a href="aplikace3.html#cb855-4" tabindex="-1"></a></span>
<span id="cb855-5"><a href="aplikace3.html#cb855-5" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb855-6"><a href="aplikace3.html#cb855-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb855-7"><a href="aplikace3.html#cb855-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb855-8"><a href="aplikace3.html#cb855-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb855-9"><a href="aplikace3.html#cb855-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb855-10"><a href="aplikace3.html#cb855-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb855-11"><a href="aplikace3.html#cb855-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb855-12"><a href="aplikace3.html#cb855-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,</span>
<span id="cb855-13"><a href="aplikace3.html#cb855-13" tabindex="-1"></a>                  <span class="at">cost =</span> C,</span>
<span id="cb855-14"><a href="aplikace3.html#cb855-14" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb855-15"><a href="aplikace3.html#cb855-15" tabindex="-1"></a>  <span class="co"># Determine alpha</span></span>
<span id="cb855-16"><a href="aplikace3.html#cb855-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb855-17"><a href="aplikace3.html#cb855-17" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>We can now compute the representations of the individual curves. First, let’s set <span class="math inline">\(\hat d\)</span> to the full dimension, that is, <span class="math inline">\(\hat d = m ={}\)</span> 101, and then we will determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb856"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb856-1"><a href="aplikace3.html#cb856-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb856-2"><a href="aplikace3.html#cb856-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb856-3"><a href="aplikace3.html#cb856-3" tabindex="-1"></a></span>
<span id="cb856-4"><a href="aplikace3.html#cb856-4" tabindex="-1"></a><span class="co"># Determine the vector lambda</span></span>
<span id="cb856-5"><a href="aplikace3.html#cb856-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb856-6"><a href="aplikace3.html#cb856-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb856-7"><a href="aplikace3.html#cb856-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb856-8"><a href="aplikace3.html#cb856-8" tabindex="-1"></a></span>
<span id="cb856-9"><a href="aplikace3.html#cb856-9" tabindex="-1"></a><span class="co"># Compute the representation</span></span>
<span id="cb856-10"><a href="aplikace3.html#cb856-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb856-11"><a href="aplikace3.html#cb856-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb856-12"><a href="aplikace3.html#cb856-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have stored in the matrix <code>Lambda.RKHS</code> the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> for each curve in the columns. We will use these vectors as a representation of the given curves and classify the data according to this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb857"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb857-1"><a href="aplikace3.html#cb857-1" tabindex="-1"></a><span class="co"># Split into training and testing data</span></span>
<span id="cb857-2"><a href="aplikace3.html#cb857-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb857-3"><a href="aplikace3.html#cb857-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb857-4"><a href="aplikace3.html#cb857-4" tabindex="-1"></a></span>
<span id="cb857-5"><a href="aplikace3.html#cb857-5" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb857-6"><a href="aplikace3.html#cb857-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb857-7"><a href="aplikace3.html#cb857-7" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb857-8"><a href="aplikace3.html#cb857-8" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb857-9"><a href="aplikace3.html#cb857-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb857-10"><a href="aplikace3.html#cb857-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb857-11"><a href="aplikace3.html#cb857-11" tabindex="-1"></a></span>
<span id="cb857-12"><a href="aplikace3.html#cb857-12" tabindex="-1"></a><span class="co"># Iterate over individual kernels</span></span>
<span id="cb857-13"><a href="aplikace3.html#cb857-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb857-14"><a href="aplikace3.html#cb857-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb857-15"><a href="aplikace3.html#cb857-15" tabindex="-1"></a></span>
<span id="cb857-16"><a href="aplikace3.html#cb857-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb857-17"><a href="aplikace3.html#cb857-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb857-18"><a href="aplikace3.html#cb857-18" tabindex="-1"></a>  </span>
<span id="cb857-19"><a href="aplikace3.html#cb857-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb857-20"><a href="aplikace3.html#cb857-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb857-21"><a href="aplikace3.html#cb857-21" tabindex="-1"></a>  </span>
<span id="cb857-22"><a href="aplikace3.html#cb857-22" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb857-23"><a href="aplikace3.html#cb857-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb857-24"><a href="aplikace3.html#cb857-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb857-25"><a href="aplikace3.html#cb857-25" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb857-26"><a href="aplikace3.html#cb857-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb857-27"><a href="aplikace3.html#cb857-27" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb857-28"><a href="aplikace3.html#cb857-28" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb857-29"><a href="aplikace3.html#cb857-29" tabindex="-1"></a>  </span>
<span id="cb857-30"><a href="aplikace3.html#cb857-30" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb857-31"><a href="aplikace3.html#cb857-31" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb857-32"><a href="aplikace3.html#cb857-32" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb857-33"><a href="aplikace3.html#cb857-33" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb857-34"><a href="aplikace3.html#cb857-34" tabindex="-1"></a>    </span>
<span id="cb857-35"><a href="aplikace3.html#cb857-35" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb857-36"><a href="aplikace3.html#cb857-36" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb857-37"><a href="aplikace3.html#cb857-37" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb857-38"><a href="aplikace3.html#cb857-38" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb857-39"><a href="aplikace3.html#cb857-39" tabindex="-1"></a>  </span>
<span id="cb857-40"><a href="aplikace3.html#cb857-40" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb857-41"><a href="aplikace3.html#cb857-41" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb857-42"><a href="aplikace3.html#cb857-42" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-100">Table 6.1: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error, and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error estimate.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.0133</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0267</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0400</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>We see that the model classifies the training data very well for all three kernels, while its success on the testing data is not good for the linear kernel. Therefore, we will use cross-validation to determine the optimal values for <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb858"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb858-1"><a href="aplikace3.html#cb858-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb858-2"><a href="aplikace3.html#cb858-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb858-3"><a href="aplikace3.html#cb858-3" tabindex="-1"></a><span class="co"># Remove the last column which contains the values of Y</span></span>
<span id="cb858-4"><a href="aplikace3.html#cb858-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb858-5"><a href="aplikace3.html#cb858-5" tabindex="-1"></a></span>
<span id="cb858-6"><a href="aplikace3.html#cb858-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb858-7"><a href="aplikace3.html#cb858-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb858-8"><a href="aplikace3.html#cb858-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb858-9"><a href="aplikace3.html#cb858-9" tabindex="-1"></a></span>
<span id="cb858-10"><a href="aplikace3.html#cb858-10" tabindex="-1"></a><span class="co"># List with three components... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb858-11"><a href="aplikace3.html#cb858-11" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb858-12"><a href="aplikace3.html#cb858-12" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given</span></span>
<span id="cb858-13"><a href="aplikace3.html#cb858-13" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb858-14"><a href="aplikace3.html#cb858-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb858-15"><a href="aplikace3.html#cb858-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb858-16"><a href="aplikace3.html#cb858-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb858-17"><a href="aplikace3.html#cb858-17" tabindex="-1"></a></span>
<span id="cb858-18"><a href="aplikace3.html#cb858-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb858-19"><a href="aplikace3.html#cb858-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb858-20"><a href="aplikace3.html#cb858-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb858-21"><a href="aplikace3.html#cb858-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb858-22"><a href="aplikace3.html#cb858-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb858-23"><a href="aplikace3.html#cb858-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb858-24"><a href="aplikace3.html#cb858-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb859"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb859-1"><a href="aplikace3.html#cb859-1" tabindex="-1"></a><span class="co"># Cross-validation itself</span></span>
<span id="cb859-2"><a href="aplikace3.html#cb859-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb859-3"><a href="aplikace3.html#cb859-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb859-4"><a href="aplikace3.html#cb859-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb859-5"><a href="aplikace3.html#cb859-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb859-6"><a href="aplikace3.html#cb859-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb859-7"><a href="aplikace3.html#cb859-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb859-8"><a href="aplikace3.html#cb859-8" tabindex="-1"></a>  </span>
<span id="cb859-9"><a href="aplikace3.html#cb859-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb859-10"><a href="aplikace3.html#cb859-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb859-11"><a href="aplikace3.html#cb859-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb859-12"><a href="aplikace3.html#cb859-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb859-13"><a href="aplikace3.html#cb859-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb859-14"><a href="aplikace3.html#cb859-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb859-15"><a href="aplikace3.html#cb859-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb859-16"><a href="aplikace3.html#cb859-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb859-17"><a href="aplikace3.html#cb859-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb859-18"><a href="aplikace3.html#cb859-18" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb859-19"><a href="aplikace3.html#cb859-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb859-20"><a href="aplikace3.html#cb859-20" tabindex="-1"></a>  }</span>
<span id="cb859-21"><a href="aplikace3.html#cb859-21" tabindex="-1"></a>  </span>
<span id="cb859-22"><a href="aplikace3.html#cb859-22" tabindex="-1"></a>  <span class="co"># Iterate over dimensions</span></span>
<span id="cb859-23"><a href="aplikace3.html#cb859-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb859-24"><a href="aplikace3.html#cb859-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb859-25"><a href="aplikace3.html#cb859-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb859-26"><a href="aplikace3.html#cb859-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb859-27"><a href="aplikace3.html#cb859-27" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb859-28"><a href="aplikace3.html#cb859-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb859-29"><a href="aplikace3.html#cb859-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb859-30"><a href="aplikace3.html#cb859-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb859-31"><a href="aplikace3.html#cb859-31" tabindex="-1"></a>    }</span>
<span id="cb859-32"><a href="aplikace3.html#cb859-32" tabindex="-1"></a>    <span class="co"># Iterate over folds</span></span>
<span id="cb859-33"><a href="aplikace3.html#cb859-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb859-34"><a href="aplikace3.html#cb859-34" tabindex="-1"></a>      <span class="co"># Define testing and training parts for CV</span></span>
<span id="cb859-35"><a href="aplikace3.html#cb859-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb859-36"><a href="aplikace3.html#cb859-36" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb859-37"><a href="aplikace3.html#cb859-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb859-38"><a href="aplikace3.html#cb859-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb859-39"><a href="aplikace3.html#cb859-39" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb859-40"><a href="aplikace3.html#cb859-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb859-41"><a href="aplikace3.html#cb859-41" tabindex="-1"></a>                                   <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb859-42"><a href="aplikace3.html#cb859-42" tabindex="-1"></a>                                   <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb859-43"><a href="aplikace3.html#cb859-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb859-44"><a href="aplikace3.html#cb859-44" tabindex="-1"></a>      <span class="co"># Iterate over individual kernels</span></span>
<span id="cb859-45"><a href="aplikace3.html#cb859-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb859-46"><a href="aplikace3.html#cb859-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb859-47"><a href="aplikace3.html#cb859-47" tabindex="-1"></a>      </span>
<span id="cb859-48"><a href="aplikace3.html#cb859-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb859-49"><a href="aplikace3.html#cb859-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb859-50"><a href="aplikace3.html#cb859-50" tabindex="-1"></a>        </span>
<span id="cb859-51"><a href="aplikace3.html#cb859-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb859-52"><a href="aplikace3.html#cb859-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb859-53"><a href="aplikace3.html#cb859-53" tabindex="-1"></a>        </span>
<span id="cb859-54"><a href="aplikace3.html#cb859-54" tabindex="-1"></a>        <span class="co"># Build the model</span></span>
<span id="cb859-55"><a href="aplikace3.html#cb859-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb859-56"><a href="aplikace3.html#cb859-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb859-57"><a href="aplikace3.html#cb859-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb859-58"><a href="aplikace3.html#cb859-58" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb859-59"><a href="aplikace3.html#cb859-59" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb859-60"><a href="aplikace3.html#cb859-60" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb859-61"><a href="aplikace3.html#cb859-61" tabindex="-1"></a>        </span>
<span id="cb859-62"><a href="aplikace3.html#cb859-62" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb859-63"><a href="aplikace3.html#cb859-63" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb859-64"><a href="aplikace3.html#cb859-64" tabindex="-1"></a>        accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb859-65"><a href="aplikace3.html#cb859-65" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb859-66"><a href="aplikace3.html#cb859-66" tabindex="-1"></a>        </span>
<span id="cb859-67"><a href="aplikace3.html#cb859-67" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb859-68"><a href="aplikace3.html#cb859-68" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb859-69"><a href="aplikace3.html#cb859-69" tabindex="-1"></a>      }</span>
<span id="cb859-70"><a href="aplikace3.html#cb859-70" tabindex="-1"></a>      <span class="co"># Insert accuracies into positions for given d, gamma, and fold</span></span>
<span id="cb859-71"><a href="aplikace3.html#cb859-71" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb859-72"><a href="aplikace3.html#cb859-72" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb859-73"><a href="aplikace3.html#cb859-73" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb859-74"><a href="aplikace3.html#cb859-74" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb859-75"><a href="aplikace3.html#cb859-75" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb859-76"><a href="aplikace3.html#cb859-76" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb859-77"><a href="aplikace3.html#cb859-77" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb859-78"><a href="aplikace3.html#cb859-78" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb859-79"><a href="aplikace3.html#cb859-79" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb859-80"><a href="aplikace3.html#cb859-80" tabindex="-1"></a>    }</span>
<span id="cb859-81"><a href="aplikace3.html#cb859-81" tabindex="-1"></a>  }</span>
<span id="cb859-82"><a href="aplikace3.html#cb859-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb860"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb860-1"><a href="aplikace3.html#cb860-1" tabindex="-1"></a><span class="co"># We calculate the average accuracies for each method across folds</span></span>
<span id="cb860-2"><a href="aplikace3.html#cb860-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb860-3"><a href="aplikace3.html#cb860-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb860-4"><a href="aplikace3.html#cb860-4" tabindex="-1"></a>}</span>
<span id="cb860-5"><a href="aplikace3.html#cb860-5" tabindex="-1"></a></span>
<span id="cb860-6"><a href="aplikace3.html#cb860-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb860-7"><a href="aplikace3.html#cb860-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb860-8"><a href="aplikace3.html#cb860-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb860-9"><a href="aplikace3.html#cb860-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb860-10"><a href="aplikace3.html#cb860-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb860-11"><a href="aplikace3.html#cb860-11" tabindex="-1"></a></span>
<span id="cb860-12"><a href="aplikace3.html#cb860-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb860-13"><a href="aplikace3.html#cb860-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb860-14"><a href="aplikace3.html#cb860-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb860-15"><a href="aplikace3.html#cb860-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb860-16"><a href="aplikace3.html#cb860-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb860-17"><a href="aplikace3.html#cb860-17" tabindex="-1"></a></span>
<span id="cb860-18"><a href="aplikace3.html#cb860-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb860-19"><a href="aplikace3.html#cb860-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb860-20"><a href="aplikace3.html#cb860-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb860-21"><a href="aplikace3.html#cb860-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb860-22"><a href="aplikace3.html#cb860-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb860-23"><a href="aplikace3.html#cb860-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-103">Table 6.2: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">11</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">27</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">30</td>
<td align="right">3.7276</td>
<td align="right">0</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter values are <span class="math inline">\(d={}\)</span> 11 and <span class="math inline">\(\gamma={}\)</span> 1 for the linear kernel with an error value calculated using 10-fold CV 0, <span class="math inline">\(d={}\)</span> 27 and <span class="math inline">\(\gamma={}\)</span> 1 for the polynomial kernel with an error value calculated using 10-fold CV 0, and <span class="math inline">\(d={}\)</span> 30 and <span class="math inline">\(\gamma={}\)</span> 3.7276 for the radial kernel with an error value of 0.
For interest, let’s plot the validation error function in relation to the dimension <span class="math inline">\(d\)</span> and the hyperparameter <span class="math inline">\(\gamma\)</span> values.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb861"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb861-1"><a href="aplikace3.html#cb861-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb861-2"><a href="aplikace3.html#cb861-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb861-3"><a href="aplikace3.html#cb861-3" tabindex="-1"></a>                               <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb861-4"><a href="aplikace3.html#cb861-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb861-5"><a href="aplikace3.html#cb861-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb861-6"><a href="aplikace3.html#cb861-6" tabindex="-1"></a>                               <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb861-7"><a href="aplikace3.html#cb861-7" tabindex="-1"></a>                                            <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb861-8"><a href="aplikace3.html#cb861-8" tabindex="-1"></a>                                              <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb861-9"><a href="aplikace3.html#cb861-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb861-10"><a href="aplikace3.html#cb861-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb861-11"><a href="aplikace3.html#cb861-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb861-12"><a href="aplikace3.html#cb861-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb861-13"><a href="aplikace3.html#cb861-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb861-14"><a href="aplikace3.html#cb861-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb861-15"><a href="aplikace3.html#cb861-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb861-16"><a href="aplikace3.html#cb861-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb861-17"><a href="aplikace3.html#cb861-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb861-18"><a href="aplikace3.html#cb861-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb861-19"><a href="aplikace3.html#cb861-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-104"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-104-1.png" alt="Dependence of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 6.10: Dependence of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>In the above graphs, we observe how the validation error varied depending on the hyperparameter values <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>.
Notably, in all three graphs for the individual kernels, significant horizontal structures are apparent.
From this, we can draw significant theoretical and practical insights— the considered classification method (projection onto RKHS using SVM + SVM classification) is robust to the choice of hyperparameter <span class="math inline">\(d\)</span> (i.e., a small change in this parameter value does not lead to a significant deterioration in validation error), while we must be very cautious with the choice of hyperparameter <span class="math inline">\(\gamma\)</span> (even a small change in its value can lead to a large change in validation error).
This behavior is most evident with the Gaussian kernel.</p>
<p>Since we have already found the optimal values for the hyperparameters, we can construct the final models and assess their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb862"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb862-1"><a href="aplikace3.html#cb862-1" tabindex="-1"></a><span class="co"># We remove the last column containing the Y values</span></span>
<span id="cb862-2"><a href="aplikace3.html#cb862-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb862-3"><a href="aplikace3.html#cb862-3" tabindex="-1"></a><span class="co"># We also add the test data</span></span>
<span id="cb862-4"><a href="aplikace3.html#cb862-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb863"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb863-1"><a href="aplikace3.html#cb863-1" tabindex="-1"></a><span class="co"># Prepare a data table for storing results</span></span>
<span id="cb863-2"><a href="aplikace3.html#cb863-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb863-3"><a href="aplikace3.html#cb863-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb863-4"><a href="aplikace3.html#cb863-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb863-5"><a href="aplikace3.html#cb863-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb863-6"><a href="aplikace3.html#cb863-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb863-7"><a href="aplikace3.html#cb863-7" tabindex="-1"></a></span>
<span id="cb863-8"><a href="aplikace3.html#cb863-8" tabindex="-1"></a><span class="co"># Iterate through the individual kernels</span></span>
<span id="cb863-9"><a href="aplikace3.html#cb863-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb863-10"><a href="aplikace3.html#cb863-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb863-11"><a href="aplikace3.html#cb863-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># gamma value from CV</span></span>
<span id="cb863-12"><a href="aplikace3.html#cb863-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb863-13"><a href="aplikace3.html#cb863-13" tabindex="-1"></a>  </span>
<span id="cb863-14"><a href="aplikace3.html#cb863-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb863-15"><a href="aplikace3.html#cb863-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb863-16"><a href="aplikace3.html#cb863-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb863-17"><a href="aplikace3.html#cb863-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb863-18"><a href="aplikace3.html#cb863-18" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb863-19"><a href="aplikace3.html#cb863-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb863-20"><a href="aplikace3.html#cb863-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb863-21"><a href="aplikace3.html#cb863-21" tabindex="-1"></a>  </span>
<span id="cb863-22"><a href="aplikace3.html#cb863-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb863-23"><a href="aplikace3.html#cb863-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb863-24"><a href="aplikace3.html#cb863-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb863-25"><a href="aplikace3.html#cb863-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb863-26"><a href="aplikace3.html#cb863-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb863-27"><a href="aplikace3.html#cb863-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb863-28"><a href="aplikace3.html#cb863-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb863-29"><a href="aplikace3.html#cb863-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb863-30"><a href="aplikace3.html#cb863-30" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb863-31"><a href="aplikace3.html#cb863-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb863-32"><a href="aplikace3.html#cb863-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb863-33"><a href="aplikace3.html#cb863-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb863-34"><a href="aplikace3.html#cb863-34" tabindex="-1"></a>  }</span>
<span id="cb863-35"><a href="aplikace3.html#cb863-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb863-36"><a href="aplikace3.html#cb863-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb863-37"><a href="aplikace3.html#cb863-37" tabindex="-1"></a>  </span>
<span id="cb863-38"><a href="aplikace3.html#cb863-38" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb863-39"><a href="aplikace3.html#cb863-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb863-40"><a href="aplikace3.html#cb863-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb863-41"><a href="aplikace3.html#cb863-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb863-42"><a href="aplikace3.html#cb863-42" tabindex="-1"></a>  </span>
<span id="cb863-43"><a href="aplikace3.html#cb863-43" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb863-44"><a href="aplikace3.html#cb863-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb863-45"><a href="aplikace3.html#cb863-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb863-46"><a href="aplikace3.html#cb863-46" tabindex="-1"></a>  }</span>
<span id="cb863-47"><a href="aplikace3.html#cb863-47" tabindex="-1"></a>  </span>
<span id="cb863-48"><a href="aplikace3.html#cb863-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb863-49"><a href="aplikace3.html#cb863-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb863-50"><a href="aplikace3.html#cb863-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb863-51"><a href="aplikace3.html#cb863-51" tabindex="-1"></a></span>
<span id="cb863-52"><a href="aplikace3.html#cb863-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb863-53"><a href="aplikace3.html#cb863-53" tabindex="-1"></a></span>
<span id="cb863-54"><a href="aplikace3.html#cb863-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb863-55"><a href="aplikace3.html#cb863-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb863-56"><a href="aplikace3.html#cb863-56" tabindex="-1"></a>  </span>
<span id="cb863-57"><a href="aplikace3.html#cb863-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb863-58"><a href="aplikace3.html#cb863-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb863-59"><a href="aplikace3.html#cb863-59" tabindex="-1"></a>  </span>
<span id="cb863-60"><a href="aplikace3.html#cb863-60" tabindex="-1"></a>  <span class="co"># Model building</span></span>
<span id="cb863-61"><a href="aplikace3.html#cb863-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb863-62"><a href="aplikace3.html#cb863-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb863-63"><a href="aplikace3.html#cb863-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb863-64"><a href="aplikace3.html#cb863-64" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb863-65"><a href="aplikace3.html#cb863-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb863-66"><a href="aplikace3.html#cb863-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb863-67"><a href="aplikace3.html#cb863-67" tabindex="-1"></a>  </span>
<span id="cb863-68"><a href="aplikace3.html#cb863-68" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb863-69"><a href="aplikace3.html#cb863-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb863-70"><a href="aplikace3.html#cb863-70" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb863-71"><a href="aplikace3.html#cb863-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb863-72"><a href="aplikace3.html#cb863-72" tabindex="-1"></a>    </span>
<span id="cb863-73"><a href="aplikace3.html#cb863-73" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb863-74"><a href="aplikace3.html#cb863-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb863-75"><a href="aplikace3.html#cb863-75" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb863-76"><a href="aplikace3.html#cb863-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb863-77"><a href="aplikace3.html#cb863-77" tabindex="-1"></a>  </span>
<span id="cb863-78"><a href="aplikace3.html#cb863-78" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb863-79"><a href="aplikace3.html#cb863-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb863-80"><a href="aplikace3.html#cb863-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-107">Table 6.3: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0154</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with the projection onto the Reproducing Kernel Hilbert Space is therefore 0 % on the training data for the linear kernel, 0 % for the polynomial kernel, and 0 % for the Gaussian kernel.
On the test data, the error rate of the method is 3.08 % for the linear kernel, 3.08 % for the polynomial kernel, and 1.54 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb864"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb864-1"><a href="aplikace3.html#cb864-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomial-kernel-3" class="section level6 hasAnchor" number="6.3.7.6.1.2">
<h6><span class="header-section-number">6.3.7.6.1.2</span> Polynomial Kernel<a href="aplikace3.html#polynomial-kernel-3" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb865"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb865-1"><a href="aplikace3.html#cb865-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb865-2"><a href="aplikace3.html#cb865-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb865-3"><a href="aplikace3.html#cb865-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb865-4"><a href="aplikace3.html#cb865-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb865-5"><a href="aplikace3.html#cb865-5" tabindex="-1"></a></span>
<span id="cb865-6"><a href="aplikace3.html#cb865-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb865-7"><a href="aplikace3.html#cb865-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb865-8"><a href="aplikace3.html#cb865-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb865-9"><a href="aplikace3.html#cb865-9" tabindex="-1"></a>}</span>
<span id="cb865-10"><a href="aplikace3.html#cb865-10" tabindex="-1"></a></span>
<span id="cb865-11"><a href="aplikace3.html#cb865-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb865-12"><a href="aplikace3.html#cb865-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb865-13"><a href="aplikace3.html#cb865-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb865-14"><a href="aplikace3.html#cb865-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb865-15"><a href="aplikace3.html#cb865-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb865-16"><a href="aplikace3.html#cb865-16" tabindex="-1"></a>    }</span>
<span id="cb865-17"><a href="aplikace3.html#cb865-17" tabindex="-1"></a>  }</span>
<span id="cb865-18"><a href="aplikace3.html#cb865-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb865-19"><a href="aplikace3.html#cb865-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb866"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb866-1"><a href="aplikace3.html#cb866-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb866-2"><a href="aplikace3.html#cb866-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb866-3"><a href="aplikace3.html#cb866-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb866-4"><a href="aplikace3.html#cb866-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb866-5"><a href="aplikace3.html#cb866-5" tabindex="-1"></a></span>
<span id="cb866-6"><a href="aplikace3.html#cb866-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate through</span></span>
<span id="cb866-7"><a href="aplikace3.html#cb866-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># reasonable range for d</span></span>
<span id="cb866-8"><a href="aplikace3.html#cb866-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb866-9"><a href="aplikace3.html#cb866-9" tabindex="-1"></a></span>
<span id="cb866-10"><a href="aplikace3.html#cb866-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb866-11"><a href="aplikace3.html#cb866-11" tabindex="-1"></a><span class="co"># Empty matrix to store the results</span></span>
<span id="cb866-12"><a href="aplikace3.html#cb866-12" tabindex="-1"></a><span class="co"># Columns will be accuracy values for the given parameters</span></span>
<span id="cb866-13"><a href="aplikace3.html#cb866-13" tabindex="-1"></a><span class="co"># Rows will correspond to values for p and layers will correspond to folds</span></span>
<span id="cb866-14"><a href="aplikace3.html#cb866-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb866-15"><a href="aplikace3.html#cb866-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb866-16"><a href="aplikace3.html#cb866-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb866-17"><a href="aplikace3.html#cb866-17" tabindex="-1"></a></span>
<span id="cb866-18"><a href="aplikace3.html#cb866-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb866-19"><a href="aplikace3.html#cb866-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb866-20"><a href="aplikace3.html#cb866-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb866-21"><a href="aplikace3.html#cb866-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb866-22"><a href="aplikace3.html#cb866-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb866-23"><a href="aplikace3.html#cb866-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb866-24"><a href="aplikace3.html#cb866-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb867"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb867-1"><a href="aplikace3.html#cb867-1" tabindex="-1"></a><span class="co"># Cross-validation itself</span></span>
<span id="cb867-2"><a href="aplikace3.html#cb867-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb867-3"><a href="aplikace3.html#cb867-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb867-4"><a href="aplikace3.html#cb867-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb867-5"><a href="aplikace3.html#cb867-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb867-6"><a href="aplikace3.html#cb867-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb867-7"><a href="aplikace3.html#cb867-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb867-8"><a href="aplikace3.html#cb867-8" tabindex="-1"></a>  </span>
<span id="cb867-9"><a href="aplikace3.html#cb867-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb867-10"><a href="aplikace3.html#cb867-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb867-11"><a href="aplikace3.html#cb867-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb867-12"><a href="aplikace3.html#cb867-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb867-13"><a href="aplikace3.html#cb867-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb867-14"><a href="aplikace3.html#cb867-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb867-15"><a href="aplikace3.html#cb867-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb867-16"><a href="aplikace3.html#cb867-16" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb867-17"><a href="aplikace3.html#cb867-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb867-18"><a href="aplikace3.html#cb867-18" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb867-19"><a href="aplikace3.html#cb867-19" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb867-20"><a href="aplikace3.html#cb867-20" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb867-21"><a href="aplikace3.html#cb867-21" tabindex="-1"></a>  }</span>
<span id="cb867-22"><a href="aplikace3.html#cb867-22" tabindex="-1"></a>  </span>
<span id="cb867-23"><a href="aplikace3.html#cb867-23" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb867-24"><a href="aplikace3.html#cb867-24" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb867-25"><a href="aplikace3.html#cb867-25" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb867-26"><a href="aplikace3.html#cb867-26" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb867-27"><a href="aplikace3.html#cb867-27" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb867-28"><a href="aplikace3.html#cb867-28" tabindex="-1"></a>    <span class="co"># Calculate representation</span></span>
<span id="cb867-29"><a href="aplikace3.html#cb867-29" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb867-30"><a href="aplikace3.html#cb867-30" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb867-31"><a href="aplikace3.html#cb867-31" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb867-32"><a href="aplikace3.html#cb867-32" tabindex="-1"></a>    }</span>
<span id="cb867-33"><a href="aplikace3.html#cb867-33" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb867-34"><a href="aplikace3.html#cb867-34" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb867-35"><a href="aplikace3.html#cb867-35" tabindex="-1"></a>      <span class="co"># Define test and training parts for CV</span></span>
<span id="cb867-36"><a href="aplikace3.html#cb867-36" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb867-37"><a href="aplikace3.html#cb867-37" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb867-38"><a href="aplikace3.html#cb867-38" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb867-39"><a href="aplikace3.html#cb867-39" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb867-40"><a href="aplikace3.html#cb867-40" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb867-41"><a href="aplikace3.html#cb867-41" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb867-42"><a href="aplikace3.html#cb867-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb867-43"><a href="aplikace3.html#cb867-43" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb867-44"><a href="aplikace3.html#cb867-44" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb867-45"><a href="aplikace3.html#cb867-45" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb867-46"><a href="aplikace3.html#cb867-46" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb867-47"><a href="aplikace3.html#cb867-47" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb867-48"><a href="aplikace3.html#cb867-48" tabindex="-1"></a>      </span>
<span id="cb867-49"><a href="aplikace3.html#cb867-49" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb867-50"><a href="aplikace3.html#cb867-50" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb867-51"><a href="aplikace3.html#cb867-51" tabindex="-1"></a>        </span>
<span id="cb867-52"><a href="aplikace3.html#cb867-52" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb867-53"><a href="aplikace3.html#cb867-53" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb867-54"><a href="aplikace3.html#cb867-54" tabindex="-1"></a>        </span>
<span id="cb867-55"><a href="aplikace3.html#cb867-55" tabindex="-1"></a>        <span class="co"># Model construction</span></span>
<span id="cb867-56"><a href="aplikace3.html#cb867-56" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb867-57"><a href="aplikace3.html#cb867-57" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb867-58"><a href="aplikace3.html#cb867-58" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb867-59"><a href="aplikace3.html#cb867-59" tabindex="-1"></a>                            <span class="at">cost =</span> C,                    </span>
<span id="cb867-60"><a href="aplikace3.html#cb867-60" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb867-61"><a href="aplikace3.html#cb867-61" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb867-62"><a href="aplikace3.html#cb867-62" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb867-63"><a href="aplikace3.html#cb867-63" tabindex="-1"></a>        </span>
<span id="cb867-64"><a href="aplikace3.html#cb867-64" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb867-65"><a href="aplikace3.html#cb867-65" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb867-66"><a href="aplikace3.html#cb867-66" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb867-67"><a href="aplikace3.html#cb867-67" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb867-68"><a href="aplikace3.html#cb867-68" tabindex="-1"></a>        </span>
<span id="cb867-69"><a href="aplikace3.html#cb867-69" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb867-70"><a href="aplikace3.html#cb867-70" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb867-71"><a href="aplikace3.html#cb867-71" tabindex="-1"></a>      }</span>
<span id="cb867-72"><a href="aplikace3.html#cb867-72" tabindex="-1"></a>      <span class="co"># Store accuracies for the given d, gamma, and fold</span></span>
<span id="cb867-73"><a href="aplikace3.html#cb867-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb867-74"><a href="aplikace3.html#cb867-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb867-75"><a href="aplikace3.html#cb867-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb867-76"><a href="aplikace3.html#cb867-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb867-77"><a href="aplikace3.html#cb867-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb867-78"><a href="aplikace3.html#cb867-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb867-79"><a href="aplikace3.html#cb867-79" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb867-80"><a href="aplikace3.html#cb867-80" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb867-81"><a href="aplikace3.html#cb867-81" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb867-82"><a href="aplikace3.html#cb867-82" tabindex="-1"></a>    }</span>
<span id="cb867-83"><a href="aplikace3.html#cb867-83" tabindex="-1"></a>  }</span>
<span id="cb867-84"><a href="aplikace3.html#cb867-84" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb868"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb868-1"><a href="aplikace3.html#cb868-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb868-2"><a href="aplikace3.html#cb868-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb868-3"><a href="aplikace3.html#cb868-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb868-4"><a href="aplikace3.html#cb868-4" tabindex="-1"></a>}</span>
<span id="cb868-5"><a href="aplikace3.html#cb868-5" tabindex="-1"></a></span>
<span id="cb868-6"><a href="aplikace3.html#cb868-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb868-7"><a href="aplikace3.html#cb868-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb868-8"><a href="aplikace3.html#cb868-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb868-9"><a href="aplikace3.html#cb868-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb868-10"><a href="aplikace3.html#cb868-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb868-11"><a href="aplikace3.html#cb868-11" tabindex="-1"></a></span>
<span id="cb868-12"><a href="aplikace3.html#cb868-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb868-13"><a href="aplikace3.html#cb868-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb868-14"><a href="aplikace3.html#cb868-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb868-15"><a href="aplikace3.html#cb868-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb868-16"><a href="aplikace3.html#cb868-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb868-17"><a href="aplikace3.html#cb868-17" tabindex="-1"></a></span>
<span id="cb868-18"><a href="aplikace3.html#cb868-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb868-19"><a href="aplikace3.html#cb868-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb868-20"><a href="aplikace3.html#cb868-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb868-21"><a href="aplikace3.html#cb868-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb868-22"><a href="aplikace3.html#cb868-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb868-23"><a href="aplikace3.html#cb868-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-112">Table 6.4: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">20</td>
<td align="right">5</td>
<td align="right">0.0474</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">10</td>
<td align="right">3</td>
<td align="right">0.0461</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">7</td>
<td align="right">5</td>
<td align="right">0.0403</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal value for the parameter <span class="math inline">\(d={}\)</span> 20 and <span class="math inline">\(p={}\)</span> 5 is achieved for the linear kernel, with an error rate calculated using 10-fold CV of 0.0474. For the polynomial kernel, <span class="math inline">\(d={}\)</span> 10 and <span class="math inline">\(p={}\)</span> 3 yield an error rate of 0.0461, and for the radial kernel, <span class="math inline">\(d={}\)</span> 7 and <span class="math inline">\(p={}\)</span> 5 result in an error rate of 0.0403.</p>
<p>Since we have already identified the optimal values for the hyperparameters, we can now construct the final models and determine their classification performance on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb869"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb869-1"><a href="aplikace3.html#cb869-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb869-2"><a href="aplikace3.html#cb869-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb869-3"><a href="aplikace3.html#cb869-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb869-4"><a href="aplikace3.html#cb869-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb870"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb870-1"><a href="aplikace3.html#cb870-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb870-2"><a href="aplikace3.html#cb870-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb870-3"><a href="aplikace3.html#cb870-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb870-4"><a href="aplikace3.html#cb870-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb870-5"><a href="aplikace3.html#cb870-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb870-6"><a href="aplikace3.html#cb870-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb870-7"><a href="aplikace3.html#cb870-7" tabindex="-1"></a></span>
<span id="cb870-8"><a href="aplikace3.html#cb870-8" tabindex="-1"></a><span class="co"># Iterate over each kernel</span></span>
<span id="cb870-9"><a href="aplikace3.html#cb870-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb870-10"><a href="aplikace3.html#cb870-10" tabindex="-1"></a>  <span class="co"># Calculate matrix K</span></span>
<span id="cb870-11"><a href="aplikace3.html#cb870-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># value of p determined by CV</span></span>
<span id="cb870-12"><a href="aplikace3.html#cb870-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb870-13"><a href="aplikace3.html#cb870-13" tabindex="-1"></a>  </span>
<span id="cb870-14"><a href="aplikace3.html#cb870-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb870-15"><a href="aplikace3.html#cb870-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb870-16"><a href="aplikace3.html#cb870-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb870-17"><a href="aplikace3.html#cb870-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb870-18"><a href="aplikace3.html#cb870-18" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb870-19"><a href="aplikace3.html#cb870-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb870-20"><a href="aplikace3.html#cb870-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb870-21"><a href="aplikace3.html#cb870-21" tabindex="-1"></a>  </span>
<span id="cb870-22"><a href="aplikace3.html#cb870-22" tabindex="-1"></a>  <span class="co"># Model fitting</span></span>
<span id="cb870-23"><a href="aplikace3.html#cb870-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb870-24"><a href="aplikace3.html#cb870-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb870-25"><a href="aplikace3.html#cb870-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb870-26"><a href="aplikace3.html#cb870-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb870-27"><a href="aplikace3.html#cb870-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb870-28"><a href="aplikace3.html#cb870-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb870-29"><a href="aplikace3.html#cb870-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb870-30"><a href="aplikace3.html#cb870-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb870-31"><a href="aplikace3.html#cb870-31" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb870-32"><a href="aplikace3.html#cb870-32" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb870-33"><a href="aplikace3.html#cb870-33" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb870-34"><a href="aplikace3.html#cb870-34" tabindex="-1"></a>    <span class="co"># Assigning alpha</span></span>
<span id="cb870-35"><a href="aplikace3.html#cb870-35" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replacing zeros with coefficients</span></span>
<span id="cb870-36"><a href="aplikace3.html#cb870-36" tabindex="-1"></a>  }</span>
<span id="cb870-37"><a href="aplikace3.html#cb870-37" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb870-38"><a href="aplikace3.html#cb870-38" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb870-39"><a href="aplikace3.html#cb870-39" tabindex="-1"></a>  </span>
<span id="cb870-40"><a href="aplikace3.html#cb870-40" tabindex="-1"></a>  <span class="co"># Determine lambda vectors</span></span>
<span id="cb870-41"><a href="aplikace3.html#cb870-41" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb870-42"><a href="aplikace3.html#cb870-42" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb870-43"><a href="aplikace3.html#cb870-43" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb870-44"><a href="aplikace3.html#cb870-44" tabindex="-1"></a>  </span>
<span id="cb870-45"><a href="aplikace3.html#cb870-45" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb870-46"><a href="aplikace3.html#cb870-46" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb870-47"><a href="aplikace3.html#cb870-47" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb870-48"><a href="aplikace3.html#cb870-48" tabindex="-1"></a>  }</span>
<span id="cb870-49"><a href="aplikace3.html#cb870-49" tabindex="-1"></a>  </span>
<span id="cb870-50"><a href="aplikace3.html#cb870-50" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb870-51"><a href="aplikace3.html#cb870-51" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb870-52"><a href="aplikace3.html#cb870-52" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb870-53"><a href="aplikace3.html#cb870-53" tabindex="-1"></a></span>
<span id="cb870-54"><a href="aplikace3.html#cb870-54" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb870-55"><a href="aplikace3.html#cb870-55" tabindex="-1"></a></span>
<span id="cb870-56"><a href="aplikace3.html#cb870-56" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb870-57"><a href="aplikace3.html#cb870-57" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb870-58"><a href="aplikace3.html#cb870-58" tabindex="-1"></a>  </span>
<span id="cb870-59"><a href="aplikace3.html#cb870-59" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb870-60"><a href="aplikace3.html#cb870-60" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb870-61"><a href="aplikace3.html#cb870-61" tabindex="-1"></a>  </span>
<span id="cb870-62"><a href="aplikace3.html#cb870-62" tabindex="-1"></a>  <span class="co"># Model fitting</span></span>
<span id="cb870-63"><a href="aplikace3.html#cb870-63" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb870-64"><a href="aplikace3.html#cb870-64" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb870-65"><a href="aplikace3.html#cb870-65" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb870-66"><a href="aplikace3.html#cb870-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb870-67"><a href="aplikace3.html#cb870-67" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb870-68"><a href="aplikace3.html#cb870-68" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb870-69"><a href="aplikace3.html#cb870-69" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb870-70"><a href="aplikace3.html#cb870-70" tabindex="-1"></a>  </span>
<span id="cb870-71"><a href="aplikace3.html#cb870-71" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb870-72"><a href="aplikace3.html#cb870-72" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb870-73"><a href="aplikace3.html#cb870-73" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb870-74"><a href="aplikace3.html#cb870-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb870-75"><a href="aplikace3.html#cb870-75" tabindex="-1"></a>    </span>
<span id="cb870-76"><a href="aplikace3.html#cb870-76" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb870-77"><a href="aplikace3.html#cb870-77" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb870-78"><a href="aplikace3.html#cb870-78" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb870-79"><a href="aplikace3.html#cb870-79" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb870-80"><a href="aplikace3.html#cb870-80" tabindex="-1"></a>  </span>
<span id="cb870-81"><a href="aplikace3.html#cb870-81" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb870-82"><a href="aplikace3.html#cb870-82" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb870-83"><a href="aplikace3.html#cb870-83" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-115">Table 6.5: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0267</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.1077</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is therefore 3.33 % on the training data for the linear kernel, 2.67 % for the polynomial kernel, and 3.33 % for the Gaussian kernel. On the test data, the error rates are 6.15 % for the linear kernel, 10.77 % for the polynomial kernel, and 10.77 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb871"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb871-1"><a href="aplikace3.html#cb871-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="linear-kernel-3" class="section level6 hasAnchor" number="6.3.7.6.1.3">
<h6><span class="header-section-number">6.3.7.6.1.3</span> Linear Kernel<a href="aplikace3.html#linear-kernel-3" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb872"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb872-1"><a href="aplikace3.html#cb872-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb872-2"><a href="aplikace3.html#cb872-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb872-3"><a href="aplikace3.html#cb872-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb872-4"><a href="aplikace3.html#cb872-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb872-5"><a href="aplikace3.html#cb872-5" tabindex="-1"></a></span>
<span id="cb872-6"><a href="aplikace3.html#cb872-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb872-7"><a href="aplikace3.html#cb872-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb872-8"><a href="aplikace3.html#cb872-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb872-9"><a href="aplikace3.html#cb872-9" tabindex="-1"></a>}</span>
<span id="cb872-10"><a href="aplikace3.html#cb872-10" tabindex="-1"></a></span>
<span id="cb872-11"><a href="aplikace3.html#cb872-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb872-12"><a href="aplikace3.html#cb872-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb872-13"><a href="aplikace3.html#cb872-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb872-14"><a href="aplikace3.html#cb872-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb872-15"><a href="aplikace3.html#cb872-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb872-16"><a href="aplikace3.html#cb872-16" tabindex="-1"></a>    }</span>
<span id="cb872-17"><a href="aplikace3.html#cb872-17" tabindex="-1"></a>  }</span>
<span id="cb872-18"><a href="aplikace3.html#cb872-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb872-19"><a href="aplikace3.html#cb872-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb873"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb873-1"><a href="aplikace3.html#cb873-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb873-2"><a href="aplikace3.html#cb873-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb873-3"><a href="aplikace3.html#cb873-3" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb873-4"><a href="aplikace3.html#cb873-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb873-5"><a href="aplikace3.html#cb873-5" tabindex="-1"></a></span>
<span id="cb873-6"><a href="aplikace3.html#cb873-6" tabindex="-1"></a><span class="co"># Hyperparameter values to explore</span></span>
<span id="cb873-7"><a href="aplikace3.html#cb873-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb873-8"><a href="aplikace3.html#cb873-8" tabindex="-1"></a></span>
<span id="cb873-9"><a href="aplikace3.html#cb873-9" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb873-10"><a href="aplikace3.html#cb873-10" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb873-11"><a href="aplikace3.html#cb873-11" tabindex="-1"></a><span class="co"># Columns will have accuracy values for given d</span></span>
<span id="cb873-12"><a href="aplikace3.html#cb873-12" tabindex="-1"></a><span class="co"># Rows will have values for folds</span></span>
<span id="cb873-13"><a href="aplikace3.html#cb873-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb873-14"><a href="aplikace3.html#cb873-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb873-15"><a href="aplikace3.html#cb873-15" tabindex="-1"></a></span>
<span id="cb873-16"><a href="aplikace3.html#cb873-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb873-17"><a href="aplikace3.html#cb873-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb873-18"><a href="aplikace3.html#cb873-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb873-19"><a href="aplikace3.html#cb873-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb873-20"><a href="aplikace3.html#cb873-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb873-21"><a href="aplikace3.html#cb873-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb873-22"><a href="aplikace3.html#cb873-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb874"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb874-1"><a href="aplikace3.html#cb874-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb874-2"><a href="aplikace3.html#cb874-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb874-3"><a href="aplikace3.html#cb874-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb874-4"><a href="aplikace3.html#cb874-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb874-5"><a href="aplikace3.html#cb874-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb874-6"><a href="aplikace3.html#cb874-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb874-7"><a href="aplikace3.html#cb874-7" tabindex="-1"></a></span>
<span id="cb874-8"><a href="aplikace3.html#cb874-8" tabindex="-1"></a><span class="co"># Model fitting</span></span>
<span id="cb874-9"><a href="aplikace3.html#cb874-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb874-10"><a href="aplikace3.html#cb874-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb874-11"><a href="aplikace3.html#cb874-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb874-12"><a href="aplikace3.html#cb874-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb874-13"><a href="aplikace3.html#cb874-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb874-14"><a href="aplikace3.html#cb874-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb874-15"><a href="aplikace3.html#cb874-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,                   </span>
<span id="cb874-16"><a href="aplikace3.html#cb874-16" tabindex="-1"></a>                  <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb874-17"><a href="aplikace3.html#cb874-17" tabindex="-1"></a>                  <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb874-18"><a href="aplikace3.html#cb874-18" tabindex="-1"></a>                  <span class="at">cost =</span> C)</span>
<span id="cb874-19"><a href="aplikace3.html#cb874-19" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb874-20"><a href="aplikace3.html#cb874-20" tabindex="-1"></a>}</span>
<span id="cb874-21"><a href="aplikace3.html#cb874-21" tabindex="-1"></a></span>
<span id="cb874-22"><a href="aplikace3.html#cb874-22" tabindex="-1"></a><span class="co"># Iterate over dimensions</span></span>
<span id="cb874-23"><a href="aplikace3.html#cb874-23" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb874-24"><a href="aplikace3.html#cb874-24" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb874-25"><a href="aplikace3.html#cb874-25" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb874-26"><a href="aplikace3.html#cb874-26" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb874-27"><a href="aplikace3.html#cb874-27" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb874-28"><a href="aplikace3.html#cb874-28" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb874-29"><a href="aplikace3.html#cb874-29" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb874-30"><a href="aplikace3.html#cb874-30" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb874-31"><a href="aplikace3.html#cb874-31" tabindex="-1"></a>  }</span>
<span id="cb874-32"><a href="aplikace3.html#cb874-32" tabindex="-1"></a>  <span class="co"># Iterate over folds</span></span>
<span id="cb874-33"><a href="aplikace3.html#cb874-33" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb874-34"><a href="aplikace3.html#cb874-34" tabindex="-1"></a>    <span class="co"># Define test and training portions for CV</span></span>
<span id="cb874-35"><a href="aplikace3.html#cb874-35" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb874-36"><a href="aplikace3.html#cb874-36" tabindex="-1"></a>    <span class="co"># Split into training and validation data</span></span>
<span id="cb874-37"><a href="aplikace3.html#cb874-37" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb874-38"><a href="aplikace3.html#cb874-38" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb874-39"><a href="aplikace3.html#cb874-39" tabindex="-1"></a>    <span class="co"># Prepare a data frame to store results</span></span>
<span id="cb874-40"><a href="aplikace3.html#cb874-40" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb874-41"><a href="aplikace3.html#cb874-41" tabindex="-1"></a>                                 <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb874-42"><a href="aplikace3.html#cb874-42" tabindex="-1"></a>                                 <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb874-43"><a href="aplikace3.html#cb874-43" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb874-44"><a href="aplikace3.html#cb874-44" tabindex="-1"></a>    <span class="co"># Iterate over individual kernels</span></span>
<span id="cb874-45"><a href="aplikace3.html#cb874-45" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb874-46"><a href="aplikace3.html#cb874-46" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb874-47"><a href="aplikace3.html#cb874-47" tabindex="-1"></a>    </span>
<span id="cb874-48"><a href="aplikace3.html#cb874-48" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb874-49"><a href="aplikace3.html#cb874-49" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb874-50"><a href="aplikace3.html#cb874-50" tabindex="-1"></a>      </span>
<span id="cb874-51"><a href="aplikace3.html#cb874-51" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb874-52"><a href="aplikace3.html#cb874-52" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb874-53"><a href="aplikace3.html#cb874-53" tabindex="-1"></a>      </span>
<span id="cb874-54"><a href="aplikace3.html#cb874-54" tabindex="-1"></a>      <span class="co"># Model fitting</span></span>
<span id="cb874-55"><a href="aplikace3.html#cb874-55" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb874-56"><a href="aplikace3.html#cb874-56" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb874-57"><a href="aplikace3.html#cb874-57" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb874-58"><a href="aplikace3.html#cb874-58" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type,</span>
<span id="cb874-59"><a href="aplikace3.html#cb874-59" tabindex="-1"></a>                          <span class="at">epsilon =</span> eps,                   </span>
<span id="cb874-60"><a href="aplikace3.html#cb874-60" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb874-61"><a href="aplikace3.html#cb874-61" tabindex="-1"></a>                          <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb874-62"><a href="aplikace3.html#cb874-62" tabindex="-1"></a>                          <span class="at">cost =</span> C)</span>
<span id="cb874-63"><a href="aplikace3.html#cb874-63" tabindex="-1"></a>      </span>
<span id="cb874-64"><a href="aplikace3.html#cb874-64" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb874-65"><a href="aplikace3.html#cb874-65" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb874-66"><a href="aplikace3.html#cb874-66" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb874-67"><a href="aplikace3.html#cb874-67" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb874-68"><a href="aplikace3.html#cb874-68" tabindex="-1"></a>      </span>
<span id="cb874-69"><a href="aplikace3.html#cb874-69" tabindex="-1"></a>      <span class="co"># Store results</span></span>
<span id="cb874-70"><a href="aplikace3.html#cb874-70" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb874-71"><a href="aplikace3.html#cb874-71" tabindex="-1"></a>    }</span>
<span id="cb874-72"><a href="aplikace3.html#cb874-72" tabindex="-1"></a>    <span class="co"># Store accuracies for given d, gamma, and fold</span></span>
<span id="cb874-73"><a href="aplikace3.html#cb874-73" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb874-74"><a href="aplikace3.html#cb874-74" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb874-75"><a href="aplikace3.html#cb874-75" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb874-76"><a href="aplikace3.html#cb874-76" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb874-77"><a href="aplikace3.html#cb874-77" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb874-78"><a href="aplikace3.html#cb874-78" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb874-79"><a href="aplikace3.html#cb874-79" tabindex="-1"></a>  }</span>
<span id="cb874-80"><a href="aplikace3.html#cb874-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb875"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb875-1"><a href="aplikace3.html#cb875-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for individual d across folds</span></span>
<span id="cb875-2"><a href="aplikace3.html#cb875-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb875-3"><a href="aplikace3.html#cb875-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb875-4"><a href="aplikace3.html#cb875-4" tabindex="-1"></a>}</span>
<span id="cb875-5"><a href="aplikace3.html#cb875-5" tabindex="-1"></a></span>
<span id="cb875-6"><a href="aplikace3.html#cb875-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb875-7"><a href="aplikace3.html#cb875-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb875-8"><a href="aplikace3.html#cb875-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb875-9"><a href="aplikace3.html#cb875-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb875-10"><a href="aplikace3.html#cb875-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb875-11"><a href="aplikace3.html#cb875-11" tabindex="-1"></a></span>
<span id="cb875-12"><a href="aplikace3.html#cb875-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb875-13"><a href="aplikace3.html#cb875-13" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb875-14"><a href="aplikace3.html#cb875-14" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb875-15"><a href="aplikace3.html#cb875-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb875-16"><a href="aplikace3.html#cb875-16" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb875-17"><a href="aplikace3.html#cb875-17" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-120">Table 6.6: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error rate and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error rate.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">15</td>
<td align="right">0.0667</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">16</td>
<td align="right">0.0454</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">25</td>
<td align="right">0.0526</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best value of the parameter <span class="math inline">\(d={}\)</span> 15 for the linear kernel with an error rate calculated using 10-fold CV 0.0667, <span class="math inline">\(d={}\)</span> 16 for the polynomial kernel with an error rate calculated using 10-fold CV 0.0454 and <span class="math inline">\(d={}\)</span> 25 for the radial kernel with an error rate 0.0526.</p>
<p>Since we have already found the optimal values of the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb876"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb876-1"><a href="aplikace3.html#cb876-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb876-2"><a href="aplikace3.html#cb876-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb876-3"><a href="aplikace3.html#cb876-3" tabindex="-1"></a><span class="co"># Add the test data</span></span>
<span id="cb876-4"><a href="aplikace3.html#cb876-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb877"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb877-1"><a href="aplikace3.html#cb877-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store the results</span></span>
<span id="cb877-2"><a href="aplikace3.html#cb877-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb877-3"><a href="aplikace3.html#cb877-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb877-4"><a href="aplikace3.html#cb877-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb877-5"><a href="aplikace3.html#cb877-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb877-6"><a href="aplikace3.html#cb877-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb877-7"><a href="aplikace3.html#cb877-7" tabindex="-1"></a></span>
<span id="cb877-8"><a href="aplikace3.html#cb877-8" tabindex="-1"></a><span class="co"># Loop through individual kernels</span></span>
<span id="cb877-9"><a href="aplikace3.html#cb877-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb877-10"><a href="aplikace3.html#cb877-10" tabindex="-1"></a>  <span class="co"># Calculate the matrix K</span></span>
<span id="cb877-11"><a href="aplikace3.html#cb877-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb877-12"><a href="aplikace3.html#cb877-12" tabindex="-1"></a>  </span>
<span id="cb877-13"><a href="aplikace3.html#cb877-13" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb877-14"><a href="aplikace3.html#cb877-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb877-15"><a href="aplikace3.html#cb877-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb877-16"><a href="aplikace3.html#cb877-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb877-17"><a href="aplikace3.html#cb877-17" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb877-18"><a href="aplikace3.html#cb877-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb877-19"><a href="aplikace3.html#cb877-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb877-20"><a href="aplikace3.html#cb877-20" tabindex="-1"></a>  </span>
<span id="cb877-21"><a href="aplikace3.html#cb877-21" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb877-22"><a href="aplikace3.html#cb877-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb877-23"><a href="aplikace3.html#cb877-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb877-24"><a href="aplikace3.html#cb877-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb877-25"><a href="aplikace3.html#cb877-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb877-26"><a href="aplikace3.html#cb877-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb877-27"><a href="aplikace3.html#cb877-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb877-28"><a href="aplikace3.html#cb877-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,                   </span>
<span id="cb877-29"><a href="aplikace3.html#cb877-29" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb877-30"><a href="aplikace3.html#cb877-30" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb877-31"><a href="aplikace3.html#cb877-31" tabindex="-1"></a>                    <span class="at">cost =</span> C)</span>
<span id="cb877-32"><a href="aplikace3.html#cb877-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb877-33"><a href="aplikace3.html#cb877-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb877-34"><a href="aplikace3.html#cb877-34" tabindex="-1"></a>  }</span>
<span id="cb877-35"><a href="aplikace3.html#cb877-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb877-36"><a href="aplikace3.html#cb877-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb877-37"><a href="aplikace3.html#cb877-37" tabindex="-1"></a>  </span>
<span id="cb877-38"><a href="aplikace3.html#cb877-38" tabindex="-1"></a>  <span class="co"># Determine vector lambda</span></span>
<span id="cb877-39"><a href="aplikace3.html#cb877-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb877-40"><a href="aplikace3.html#cb877-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb877-41"><a href="aplikace3.html#cb877-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb877-42"><a href="aplikace3.html#cb877-42" tabindex="-1"></a>  </span>
<span id="cb877-43"><a href="aplikace3.html#cb877-43" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb877-44"><a href="aplikace3.html#cb877-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb877-45"><a href="aplikace3.html#cb877-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb877-46"><a href="aplikace3.html#cb877-46" tabindex="-1"></a>  }</span>
<span id="cb877-47"><a href="aplikace3.html#cb877-47" tabindex="-1"></a>  </span>
<span id="cb877-48"><a href="aplikace3.html#cb877-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb877-49"><a href="aplikace3.html#cb877-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb877-50"><a href="aplikace3.html#cb877-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb877-51"><a href="aplikace3.html#cb877-51" tabindex="-1"></a></span>
<span id="cb877-52"><a href="aplikace3.html#cb877-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb877-53"><a href="aplikace3.html#cb877-53" tabindex="-1"></a></span>
<span id="cb877-54"><a href="aplikace3.html#cb877-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb877-55"><a href="aplikace3.html#cb877-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb877-56"><a href="aplikace3.html#cb877-56" tabindex="-1"></a>  </span>
<span id="cb877-57"><a href="aplikace3.html#cb877-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb877-58"><a href="aplikace3.html#cb877-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb877-59"><a href="aplikace3.html#cb877-59" tabindex="-1"></a>  </span>
<span id="cb877-60"><a href="aplikace3.html#cb877-60" tabindex="-1"></a>  <span class="co"># Build models</span></span>
<span id="cb877-61"><a href="aplikace3.html#cb877-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb877-62"><a href="aplikace3.html#cb877-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb877-63"><a href="aplikace3.html#cb877-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb877-64"><a href="aplikace3.html#cb877-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type,</span>
<span id="cb877-65"><a href="aplikace3.html#cb877-65" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb877-66"><a href="aplikace3.html#cb877-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb877-67"><a href="aplikace3.html#cb877-67" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb877-68"><a href="aplikace3.html#cb877-68" tabindex="-1"></a>                      <span class="at">cost =</span> C)</span>
<span id="cb877-69"><a href="aplikace3.html#cb877-69" tabindex="-1"></a>  </span>
<span id="cb877-70"><a href="aplikace3.html#cb877-70" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb877-71"><a href="aplikace3.html#cb877-71" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb877-72"><a href="aplikace3.html#cb877-72" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb877-73"><a href="aplikace3.html#cb877-73" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb877-74"><a href="aplikace3.html#cb877-74" tabindex="-1"></a>    </span>
<span id="cb877-75"><a href="aplikace3.html#cb877-75" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb877-76"><a href="aplikace3.html#cb877-76" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb877-77"><a href="aplikace3.html#cb877-77" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb877-78"><a href="aplikace3.html#cb877-78" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb877-79"><a href="aplikace3.html#cb877-79" tabindex="-1"></a>  </span>
<span id="cb877-80"><a href="aplikace3.html#cb877-80" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb877-81"><a href="aplikace3.html#cb877-81" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb877-82"><a href="aplikace3.html#cb877-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-123">Table 6.7: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error rate and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error rate.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0133</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto Reproducing Kernel Hilbert Space is thus on the training data equal to 4 % for the linear kernel, 1.33 % for the polynomial kernel, and 2 % for the Gaussian kernel.
On the test data, the error rate is then 9.23 % for the linear kernel, 3.08 % for the polynomial kernel, and 3.08 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb878"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb878-1"><a href="aplikace3.html#cb878-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div id="results-table-5" class="section level3 hasAnchor" number="6.3.8">
<h3><span class="header-section-number">6.3.8</span> Results Table<a href="aplikace3.html#results-table-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the table below, we can see that the individual classification methods show significant differences in classification success. In particular, traditional methods like KNN, LDA, or QDA perform quite poorly. We can notice that all methods based on functional principal component analysis do not achieve comparable results to some other methods.</p>
<p>In contrast, the RKHS method, along with SVM, stands out for its good classification ability. It is worth noting that classical SVM with a linear kernel also performs quite well. Generally, a linear kernel is a good choice (as we have already seen earlier), as it approximates a certain integral well on the considered interval <span class="math inline">\(I\)</span> for a sufficiently dense network of points.</p>
<table>
<caption><span id="tab:unnamed-chunk-125">Table 6.8: </span>Summary of results of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of the training error rate and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error rate.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.1467</td>
<td align="center">0.1692</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.3200</td>
<td align="center">0.2923</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3200</td>
<td align="center">0.3077</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0000</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.3067</td>
<td align="center">0.2923</td>
</tr>
<tr class="even">
<td align="left">Tree - discretization</td>
<td align="center">0.2933</td>
<td align="center">0.3538</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.3267</td>
<td align="center">0.3846</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.2267</td>
<td align="center">0.2462</td>
</tr>
<tr class="odd">
<td align="left">RForest - discretization</td>
<td align="center">0.0200</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0467</td>
<td align="center">0.3077</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0133</td>
<td align="center">0.1231</td>
</tr>
<tr class="even">
<td align="left">SVM linear - func</td>
<td align="center">0.0067</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - func</td>
<td align="center">0.0133</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - func</td>
<td align="center">0.0133</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - class</td>
<td align="center">0.0133</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM poly - class</td>
<td align="center">0.0133</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - class</td>
<td align="center">0.0067</td>
<td align="center">0.0923</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.3200</td>
<td align="center">0.3077</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.3333</td>
<td align="center">0.2769</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.1733</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0133</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.0200</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.0267</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0933</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0154</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0267</td>
<td align="center">0.1077</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0333</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0133</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="klasA3deriv" class="section level2 hasAnchor" number="6.4">
<h2><span class="header-section-number">6.4</span> Classification Using the Second Derivative<a href="aplikace3.html#klasA3deriv" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>As we have mentioned earlier, it is appropriate to consider the second derivative for classification with this data. We have already calculated it above, so we can now proceed directly to constructing the models.</p>
<p>We will perform a similar analysis as in the previous situation, then (since we randomly split the data into test and training parts) we will conduct a simulation study that will allow us to compare the individual classification methods better and with much greater power.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb879"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb879-1"><a href="aplikace3.html#cb879-1" tabindex="-1"></a><span class="co"># splitting into test and training parts</span></span>
<span id="cb879-2"><a href="aplikace3.html#cb879-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb879-3"><a href="aplikace3.html#cb879-3" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb879-4"><a href="aplikace3.html#cb879-4" tabindex="-1"></a></span>
<span id="cb879-5"><a href="aplikace3.html#cb879-5" tabindex="-1"></a><span class="co"># creating a vector of 0s and 1s, 0 for &lt; 20 and 1 for &gt; 20 </span></span>
<span id="cb879-6"><a href="aplikace3.html#cb879-6" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb879-7"><a href="aplikace3.html#cb879-7" tabindex="-1"></a></span>
<span id="cb879-8"><a href="aplikace3.html#cb879-8" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb879-9"><a href="aplikace3.html#cb879-9" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb879-10"><a href="aplikace3.html#cb879-10" tabindex="-1"></a></span>
<span id="cb879-11"><a href="aplikace3.html#cb879-11" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb879-12"><a href="aplikace3.html#cb879-12" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>We will also look at the representation of the individual groups in the test and training parts of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb880"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb880-1"><a href="aplikace3.html#cb880-1" tabindex="-1"></a><span class="co"># absolute representation</span></span>
<span id="cb880-2"><a href="aplikace3.html#cb880-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 91 59</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb882"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb882-1"><a href="aplikace3.html#cb882-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 47 18</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb884"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb884-1"><a href="aplikace3.html#cb884-1" tabindex="-1"></a><span class="co"># relative representation</span></span>
<span id="cb884-2"><a href="aplikace3.html#cb884-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.6066667 0.3933333</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb886"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb886-1"><a href="aplikace3.html#cb886-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.7230769 0.2769231</code></pre>
<div id="k-nearest-neighbors-6" class="section level3 hasAnchor" number="6.4.1">
<h3><span class="header-section-number">6.4.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="aplikace3.html#k-nearest-neighbors-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with a nonparametric classification method, namely the <span class="math inline">\(K\)</span> nearest neighbors method. First, we will create the necessary objects so that we can further work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb888"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb888-1"><a href="aplikace3.html#cb888-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb888-2"><a href="aplikace3.html#cb888-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and look at its classification success. The last question remains, how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>. We could select this number as the <span class="math inline">\(K\)</span> at which the minimum error rate occurs on the training data. However, this could lead to model overfitting, so we will use cross-validation. Given the computational complexity and the size of the dataset, we will choose <span class="math inline">\(k\)</span>-fold CV; we will select, for example, <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb889"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb889-1"><a href="aplikace3.html#cb889-1" tabindex="-1"></a><span class="co"># model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb889-2"><a href="aplikace3.html#cb889-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb889-3"><a href="aplikace3.html#cb889-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb889-4"><a href="aplikace3.html#cb889-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb889-5"><a href="aplikace3.html#cb889-5" tabindex="-1"></a></span>
<span id="cb889-6"><a href="aplikace3.html#cb889-6" tabindex="-1"></a>neighb.model<span class="sc">$</span>max.prob <span class="co"># maximum accuracy</span></span></code></pre></div>
</details>
<pre><code>## [1] 0.9866667</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb891"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb891-1"><a href="aplikace3.html#cb891-1" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 3</code></pre>
<p>Let’s repeat the previous procedure for the training data, which we will split into <span class="math inline">\(k\)</span> parts and thus repeat this part of the code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb893"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb893-1"><a href="aplikace3.html#cb893-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb893-2"><a href="aplikace3.html#cb893-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb893-3"><a href="aplikace3.html#cb893-3" tabindex="-1"></a></span>
<span id="cb893-4"><a href="aplikace3.html#cb893-4" tabindex="-1"></a><span class="co"># we split the training data into k parts</span></span>
<span id="cb893-5"><a href="aplikace3.html#cb893-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb893-6"><a href="aplikace3.html#cb893-6" tabindex="-1"></a></span>
<span id="cb893-7"><a href="aplikace3.html#cb893-7" tabindex="-1"></a><span class="co"># empty matrix to insert individual results</span></span>
<span id="cb893-8"><a href="aplikace3.html#cb893-8" tabindex="-1"></a><span class="co"># the columns will hold the accuracy values for the given part of the training set</span></span>
<span id="cb893-9"><a href="aplikace3.html#cb893-9" tabindex="-1"></a><span class="co"># the rows will hold the values for the given value of K neighbors</span></span>
<span id="cb893-10"><a href="aplikace3.html#cb893-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb893-11"><a href="aplikace3.html#cb893-11" tabindex="-1"></a></span>
<span id="cb893-12"><a href="aplikace3.html#cb893-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb893-13"><a href="aplikace3.html#cb893-13" tabindex="-1"></a>  <span class="co"># defining the specific index set</span></span>
<span id="cb893-14"><a href="aplikace3.html#cb893-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb893-15"><a href="aplikace3.html#cb893-15" tabindex="-1"></a>    </span>
<span id="cb893-16"><a href="aplikace3.html#cb893-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb893-17"><a href="aplikace3.html#cb893-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb893-18"><a href="aplikace3.html#cb893-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb893-19"><a href="aplikace3.html#cb893-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb893-20"><a href="aplikace3.html#cb893-20" tabindex="-1"></a>  </span>
<span id="cb893-21"><a href="aplikace3.html#cb893-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb893-22"><a href="aplikace3.html#cb893-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb893-23"><a href="aplikace3.html#cb893-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb893-24"><a href="aplikace3.html#cb893-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb893-25"><a href="aplikace3.html#cb893-25" tabindex="-1"></a>  </span>
<span id="cb893-26"><a href="aplikace3.html#cb893-26" tabindex="-1"></a>  <span class="co"># we go through each part ... repeating this k times</span></span>
<span id="cb893-27"><a href="aplikace3.html#cb893-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb893-28"><a href="aplikace3.html#cb893-28" tabindex="-1"></a>    <span class="co"># model for a specific choice of K</span></span>
<span id="cb893-29"><a href="aplikace3.html#cb893-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb893-30"><a href="aplikace3.html#cb893-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb893-31"><a href="aplikace3.html#cb893-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb893-32"><a href="aplikace3.html#cb893-32" tabindex="-1"></a>    <span class="co"># prediction on the validation part</span></span>
<span id="cb893-33"><a href="aplikace3.html#cb893-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb893-34"><a href="aplikace3.html#cb893-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb893-35"><a href="aplikace3.html#cb893-35" tabindex="-1"></a>    <span class="co"># accuracy on the validation part</span></span>
<span id="cb893-36"><a href="aplikace3.html#cb893-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb893-37"><a href="aplikace3.html#cb893-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb893-38"><a href="aplikace3.html#cb893-38" tabindex="-1"></a>    </span>
<span id="cb893-39"><a href="aplikace3.html#cb893-39" tabindex="-1"></a>    <span class="co"># we insert the accuracy in the position for the given K and fold</span></span>
<span id="cb893-40"><a href="aplikace3.html#cb893-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb893-41"><a href="aplikace3.html#cb893-41" tabindex="-1"></a>  }</span>
<span id="cb893-42"><a href="aplikace3.html#cb893-42" tabindex="-1"></a>}</span>
<span id="cb893-43"><a href="aplikace3.html#cb893-43" tabindex="-1"></a></span>
<span id="cb893-44"><a href="aplikace3.html#cb893-44" tabindex="-1"></a><span class="co"># calculate average accuracies for each K over folds</span></span>
<span id="cb893-45"><a href="aplikace3.html#cb893-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb893-46"><a href="aplikace3.html#cb893-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb893-47"><a href="aplikace3.html#cb893-47" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb893-48"><a href="aplikace3.html#cb893-48" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span></code></pre></div>
</details>
<p>We see that the best value for the parameter <span class="math inline">\(K\)</span> is 3, with an error rate calculated using 10-fold CV of 0.0103. For clarity, let’s also plot the validation error rate as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb894"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb894-1"><a href="aplikace3.html#cb894-1" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb894-2"><a href="aplikace3.html#cb894-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb894-3"><a href="aplikace3.html#cb894-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb894-4"><a href="aplikace3.html#cb894-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb894-5"><a href="aplikace3.html#cb894-5" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb894-6"><a href="aplikace3.html#cb894-6" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb894-7"><a href="aplikace3.html#cb894-7" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb894-8"><a href="aplikace3.html#cb894-8" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb894-9"><a href="aplikace3.html#cb894-9" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - accuracy.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 26 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-131-1.png" alt="Dependency of validation error on the value of $K$, i.e., the number of neighbors." width="672" />
<p class="caption">
Figure 5.12: Dependency of validation error on the value of <span class="math inline">\(K\)</span>, i.e., the number of neighbors.
</p>
</div>
<p>Now that we know the optimal value of the parameter <span class="math inline">\(K\)</span>, we can construct the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb896"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb896-1"><a href="aplikace3.html#cb896-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb896-2"><a href="aplikace3.html#cb896-2" tabindex="-1"></a></span>
<span id="cb896-3"><a href="aplikace3.html#cb896-3" tabindex="-1"></a><span class="co"># predictions</span></span>
<span id="cb896-4"><a href="aplikace3.html#cb896-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb896-5"><a href="aplikace3.html#cb896-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb896-6"><a href="aplikace3.html#cb896-6" tabindex="-1"></a></span>
<span id="cb896-7"><a href="aplikace3.html#cb896-7" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb896-8"><a href="aplikace3.html#cb896-8" tabindex="-1"></a>presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb896-9"><a href="aplikace3.html#cb896-9" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb896-10"><a href="aplikace3.html#cb896-10" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb896-11"><a href="aplikace3.html#cb896-11" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we see that the error of the model built using the <span class="math inline">\(K\)</span> nearest neighbors method with the optimal choice of <span class="math inline">\(K_{optimal}\)</span> equal to 3, which we determined through cross-validation, is 0.0133 on the training data and 0.0769 on the test data.</p>
<p>To compare individual models, we can use both types of errors; for clarity, we will store them in a table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb897"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb897-1"><a href="aplikace3.html#cb897-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb897-2"><a href="aplikace3.html#cb897-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb897-3"><a href="aplikace3.html#cb897-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-6" class="section level3 hasAnchor" number="6.4.2">
<h3><span class="header-section-number">6.4.2</span> Linear Discriminant Analysis<a href="aplikace3.html#linear-discriminant-analysis-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied to functional data, we must first discretize it using functional principal component analysis. We will then perform the classification algorithm on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>Let’s first perform functional principal component analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb898"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb898-1"><a href="aplikace3.html#cb898-1" tabindex="-1"></a><span class="co"># Principal component analysis</span></span>
<span id="cb898-2"><a href="aplikace3.html#cb898-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of PCs</span></span>
<span id="cb898-3"><a href="aplikace3.html#cb898-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determining p</span></span>
<span id="cb898-4"><a href="aplikace3.html#cb898-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># to plot graphs, we need at least 2 PCs</span></span>
<span id="cb898-5"><a href="aplikace3.html#cb898-5" tabindex="-1"></a></span>
<span id="cb898-6"><a href="aplikace3.html#cb898-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb898-7"><a href="aplikace3.html#cb898-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p PCs</span></span>
<span id="cb898-8"><a href="aplikace3.html#cb898-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># membership to classes</span></span></code></pre></div>
</details>
<p>In this specific case, we took the number of principal components to be <span class="math inline">\(p=\)</span> 2, which together explain 93.12 <span class="math inline">\(\%\)</span> of the variability in the data. The first principal component explains 77.7 % and the second 15.42 <span class="math inline">\(\%\)</span> of the variability. We can visually display the scores of the first two principal components, color-coded according to classification class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb899"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb899-1"><a href="aplikace3.html#cb899-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb899-2"><a href="aplikace3.html#cb899-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb899-3"><a href="aplikace3.html#cb899-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb899-4"><a href="aplikace3.html#cb899-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb899-5"><a href="aplikace3.html#cb899-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb899-6"><a href="aplikace3.html#cb899-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb899-7"><a href="aplikace3.html#cb899-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb899-8"><a href="aplikace3.html#cb899-8" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb899-9"><a href="aplikace3.html#cb899-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-135"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-135-1.png" alt="Scores of the first two principal components for training data. Points are color-coded according to classification class membership." width="672" />
<p class="caption">
Figure 6.11: Scores of the first two principal components for training data. Points are color-coded according to classification class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to compute the scores for the first 2 principal components for the test data. These scores are calculated using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span>
where <span class="math inline">\(\mu(t)\)</span> is the mean function and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb900"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb900-1"><a href="aplikace3.html#cb900-1" tabindex="-1"></a><span class="co"># Calculation of scores for test functions</span></span>
<span id="cb900-2"><a href="aplikace3.html#cb900-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix</span></span>
<span id="cb900-3"><a href="aplikace3.html#cb900-3" tabindex="-1"></a></span>
<span id="cb900-4"><a href="aplikace3.html#cb900-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb900-5"><a href="aplikace3.html#cb900-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb900-6"><a href="aplikace3.html#cb900-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb900-7"><a href="aplikace3.html#cb900-7" tabindex="-1"></a>  <span class="co"># scalar product of the residual and eigenfunctions rho (functional principal components)</span></span>
<span id="cb900-8"><a href="aplikace3.html#cb900-8" tabindex="-1"></a>}</span>
<span id="cb900-9"><a href="aplikace3.html#cb900-9" tabindex="-1"></a></span>
<span id="cb900-10"><a href="aplikace3.html#cb900-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb900-11"><a href="aplikace3.html#cb900-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb900-12"><a href="aplikace3.html#cb900-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training part of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb901"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb901-1"><a href="aplikace3.html#cb901-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb901-2"><a href="aplikace3.html#cb901-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb901-3"><a href="aplikace3.html#cb901-3" tabindex="-1"></a></span>
<span id="cb901-4"><a href="aplikace3.html#cb901-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb901-5"><a href="aplikace3.html#cb901-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb901-6"><a href="aplikace3.html#cb901-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb901-7"><a href="aplikace3.html#cb901-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb901-8"><a href="aplikace3.html#cb901-8" tabindex="-1"></a>  </span>
<span id="cb901-9"><a href="aplikace3.html#cb901-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb901-10"><a href="aplikace3.html#cb901-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb901-11"><a href="aplikace3.html#cb901-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb901-12"><a href="aplikace3.html#cb901-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error of the classifier on the training data (4 %) as well as on the test data (9.23 %).</p>
<p>To visually represent the method, we can mark the decision boundary in the plot of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb902"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb902-1"><a href="aplikace3.html#cb902-1" tabindex="-1"></a><span class="co"># Add the decision boundary</span></span>
<span id="cb902-2"><a href="aplikace3.html#cb902-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb902-3"><a href="aplikace3.html#cb902-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb902-4"><a href="aplikace3.html#cb902-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb902-5"><a href="aplikace3.html#cb902-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb902-6"><a href="aplikace3.html#cb902-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb902-7"><a href="aplikace3.html#cb902-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb902-8"><a href="aplikace3.html#cb902-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb902-9"><a href="aplikace3.html#cb902-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb902-10"><a href="aplikace3.html#cb902-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb902-11"><a href="aplikace3.html#cb902-11" tabindex="-1"></a><span class="co"># case for p = 3</span></span>
<span id="cb902-12"><a href="aplikace3.html#cb902-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb902-13"><a href="aplikace3.html#cb902-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb902-14"><a href="aplikace3.html#cb902-14" tabindex="-1"></a><span class="co"># case for p = 4</span></span>
<span id="cb902-15"><a href="aplikace3.html#cb902-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb902-16"><a href="aplikace3.html#cb902-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb902-17"><a href="aplikace3.html#cb902-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb902-18"><a href="aplikace3.html#cb902-18" tabindex="-1"></a><span class="co"># case for p = 5</span></span>
<span id="cb902-19"><a href="aplikace3.html#cb902-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb902-20"><a href="aplikace3.html#cb902-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb902-21"><a href="aplikace3.html#cb902-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb902-22"><a href="aplikace3.html#cb902-22" tabindex="-1"></a></span>
<span id="cb902-23"><a href="aplikace3.html#cb902-23" tabindex="-1"></a><span class="co"># Add Y = 0, 1</span></span>
<span id="cb902-24"><a href="aplikace3.html#cb902-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb902-25"><a href="aplikace3.html#cb902-25" tabindex="-1"></a></span>
<span id="cb902-26"><a href="aplikace3.html#cb902-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb902-27"><a href="aplikace3.html#cb902-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb902-28"><a href="aplikace3.html#cb902-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb902-29"><a href="aplikace3.html#cb902-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb902-30"><a href="aplikace3.html#cb902-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb902-31"><a href="aplikace3.html#cb902-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb902-32"><a href="aplikace3.html#cb902-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb902-33"><a href="aplikace3.html#cb902-33" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb902-34"><a href="aplikace3.html#cb902-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb902-35"><a href="aplikace3.html#cb902-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-138"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-138-1.png" alt="Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes constructed using LDA is marked in black." width="672" />
<p class="caption">
Figure 6.12: Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes constructed using LDA is marked in black.
</p>
</div>
<p>We see that the decision boundary is a line, a linear function in the 2D space, which is what we expected from LDA. Finally, we will add the errors to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb903"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb903-1"><a href="aplikace3.html#cb903-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb903-2"><a href="aplikace3.html#cb903-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb903-3"><a href="aplikace3.html#cb903-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb903-4"><a href="aplikace3.html#cb903-4" tabindex="-1"></a></span>
<span id="cb903-5"><a href="aplikace3.html#cb903-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-6" class="section level3 hasAnchor" number="6.4.3">
<h3><span class="header-section-number">6.4.3</span> Quadratic Discriminant Analysis<a href="aplikace3.html#quadratic-discriminant-analysis-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s build a classifier using Quadratic Discriminant Analysis (QDA). This is analogous to LDA, with the difference that we now allow for different covariance matrices for each class of the normal distribution from which the corresponding scores originate. This dropped assumption of equal covariance matrices leads to a quadratic boundary between the classes.</p>
<p>In <code>R</code>, QDA is performed similarly to LDA in the previous section. We would again calculate scores for the training and test functions using functional principal component analysis and construct a classifier based on the scores of the first <span class="math inline">\(p\)</span> principal components to predict the membership of the test curves to class <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>However, we do not need to perform functional PCA, as we can use the results from the LDA section.</p>
<p>Thus, we can directly proceed to constructing the classifier using the <code>qda()</code> function. Subsequently, we will calculate the accuracy of the classifier on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb904"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb904-1"><a href="aplikace3.html#cb904-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb904-2"><a href="aplikace3.html#cb904-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb904-3"><a href="aplikace3.html#cb904-3" tabindex="-1"></a></span>
<span id="cb904-4"><a href="aplikace3.html#cb904-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb904-5"><a href="aplikace3.html#cb904-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb904-6"><a href="aplikace3.html#cb904-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb904-7"><a href="aplikace3.html#cb904-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb904-8"><a href="aplikace3.html#cb904-8" tabindex="-1"></a>  </span>
<span id="cb904-9"><a href="aplikace3.html#cb904-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb904-10"><a href="aplikace3.html#cb904-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb904-11"><a href="aplikace3.html#cb904-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb904-12"><a href="aplikace3.html#cb904-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have thus calculated the error of the classifier on the training data (0.67 %) as well as on the test data (1.54 %).</p>
<p>To visually represent the method, we can mark the decision boundary in the plot of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb905"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb905-1"><a href="aplikace3.html#cb905-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb905-2"><a href="aplikace3.html#cb905-2" tabindex="-1"></a></span>
<span id="cb905-3"><a href="aplikace3.html#cb905-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb905-4"><a href="aplikace3.html#cb905-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb905-5"><a href="aplikace3.html#cb905-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb905-6"><a href="aplikace3.html#cb905-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb905-7"><a href="aplikace3.html#cb905-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb905-8"><a href="aplikace3.html#cb905-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb905-9"><a href="aplikace3.html#cb905-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) <span class="sc">+</span></span>
<span id="cb905-10"><a href="aplikace3.html#cb905-10" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb905-11"><a href="aplikace3.html#cb905-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb905-12"><a href="aplikace3.html#cb905-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-141"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-141-1.png" alt="Scores of the first two principal components, color-coded according to class. The decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA is marked in black." width="672" />
<p class="caption">
Figure 1.26: Scores of the first two principal components, color-coded according to class. The decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA is marked in black.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a parabola, which only (at least visually) differs very little from a line.</p>
<p>Finally, we will add the errors to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb906"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb906-1"><a href="aplikace3.html#cb906-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb906-2"><a href="aplikace3.html#cb906-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb906-3"><a href="aplikace3.html#cb906-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb906-4"><a href="aplikace3.html#cb906-4" tabindex="-1"></a></span>
<span id="cb906-5"><a href="aplikace3.html#cb906-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-6" class="section level3 hasAnchor" number="6.4.4">
<h3><span class="header-section-number">6.4.4</span> Logistic Regression<a href="aplikace3.html#logistic-regression-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression can be performed in two ways. First, we can use the functional analogue of classical logistic regression, and second, we can perform classical multivariate logistic regression on the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-6" class="section level4 hasAnchor" number="6.4.4.1">
<h4><span class="header-section-number">6.4.4.1</span> Functional Logistic Regression<a href="aplikace3.html#functional-logistic-regression-6" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similarly to the finite-dimensional case of input data, we consider a logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span>
where <span class="math inline">\(\eta(x)\)</span> is the linear predictor taking values from the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em> (in the case of logistic regression, this is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>), and <span class="math inline">\(\pi(x)\)</span> is the conditional probability</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is a parameter function. Our goal is to estimate this parameter function.</p>
<p>For functional logistic regression, we will use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb907"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb907-1"><a href="aplikace3.html#cb907-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb907-2"><a href="aplikace3.html#cb907-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb907-3"><a href="aplikace3.html#cb907-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train) </span>
<span id="cb907-4"><a href="aplikace3.html#cb907-4" tabindex="-1"></a></span>
<span id="cb907-5"><a href="aplikace3.html#cb907-5" tabindex="-1"></a><span class="co"># points where the functions are evaluated</span></span>
<span id="cb907-6"><a href="aplikace3.html#cb907-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb907-7"><a href="aplikace3.html#cb907-7" tabindex="-1"></a></span>
<span id="cb907-8"><a href="aplikace3.html#cb907-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb907-9"><a href="aplikace3.html#cb907-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb907-10"><a href="aplikace3.html#cb907-10" tabindex="-1"></a></span>
<span id="cb907-11"><a href="aplikace3.html#cb907-11" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb907-12"><a href="aplikace3.html#cb907-12" tabindex="-1"></a></span>
<span id="cb907-13"><a href="aplikace3.html#cb907-13" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb907-14"><a href="aplikace3.html#cb907-14" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">norder =</span> <span class="dv">4</span>, <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<p>To estimate the parameter function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in this case, the B-spline basis. However, we need to find a suitable number of basis functions. We could determine this based on the error on the training data, but this data would tend to favor selecting a large number of bases, leading to overfitting the model.</p>
<p>Let’s illustrate this with the following case. For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 30\}\)</span>, we will train a model on the training data, determine the error rate on it, and also calculate the error rate on the test data. Remember that we cannot use the same data for selecting the appropriate number of bases when estimating the test error, as this would underestimate the error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb908"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb908-1"><a href="aplikace3.html#cb908-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">30</span></span>
<span id="cb908-2"><a href="aplikace3.html#cb908-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb908-3"><a href="aplikace3.html#cb908-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb908-4"><a href="aplikace3.html#cb908-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb908-5"><a href="aplikace3.html#cb908-5" tabindex="-1"></a></span>
<span id="cb908-6"><a href="aplikace3.html#cb908-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb908-7"><a href="aplikace3.html#cb908-7" tabindex="-1"></a>  <span class="co"># bases for betas</span></span>
<span id="cb908-8"><a href="aplikace3.html#cb908-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb908-9"><a href="aplikace3.html#cb908-9" tabindex="-1"></a>  <span class="co"># relationship</span></span>
<span id="cb908-10"><a href="aplikace3.html#cb908-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb908-11"><a href="aplikace3.html#cb908-11" tabindex="-1"></a>  <span class="co"># bases for x and betas</span></span>
<span id="cb908-12"><a href="aplikace3.html#cb908-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb908-13"><a href="aplikace3.html#cb908-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb908-14"><a href="aplikace3.html#cb908-14" tabindex="-1"></a>  <span class="co"># input data for the model</span></span>
<span id="cb908-15"><a href="aplikace3.html#cb908-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb908-16"><a href="aplikace3.html#cb908-16" tabindex="-1"></a>  <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb908-17"><a href="aplikace3.html#cb908-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb908-18"><a href="aplikace3.html#cb908-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb908-19"><a href="aplikace3.html#cb908-19" tabindex="-1"></a>  </span>
<span id="cb908-20"><a href="aplikace3.html#cb908-20" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb908-21"><a href="aplikace3.html#cb908-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb908-22"><a href="aplikace3.html#cb908-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb908-23"><a href="aplikace3.html#cb908-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb908-24"><a href="aplikace3.html#cb908-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb908-25"><a href="aplikace3.html#cb908-25" tabindex="-1"></a>    </span>
<span id="cb908-26"><a href="aplikace3.html#cb908-26" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb908-27"><a href="aplikace3.html#cb908-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb908-28"><a href="aplikace3.html#cb908-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb908-29"><a href="aplikace3.html#cb908-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb908-30"><a href="aplikace3.html#cb908-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb908-31"><a href="aplikace3.html#cb908-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb908-32"><a href="aplikace3.html#cb908-32" tabindex="-1"></a>  </span>
<span id="cb908-33"><a href="aplikace3.html#cb908-33" tabindex="-1"></a>  <span class="co"># insert into matrix</span></span>
<span id="cb908-34"><a href="aplikace3.html#cb908-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb908-35"><a href="aplikace3.html#cb908-35" tabindex="-1"></a>} </span>
<span id="cb908-36"><a href="aplikace3.html#cb908-36" tabindex="-1"></a></span>
<span id="cb908-37"><a href="aplikace3.html#cb908-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb908-38"><a href="aplikace3.html#cb908-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s visualize the progression of both types of errors in a graph depending on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb909"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb909-1"><a href="aplikace3.html#cb909-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb909-2"><a href="aplikace3.html#cb909-2" tabindex="-1"></a></span>
<span id="cb909-3"><a href="aplikace3.html#cb909-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb909-4"><a href="aplikace3.html#cb909-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb909-5"><a href="aplikace3.html#cb909-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb909-6"><a href="aplikace3.html#cb909-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb909-7"><a href="aplikace3.html#cb909-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb909-8"><a href="aplikace3.html#cb909-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb909-9"><a href="aplikace3.html#cb909-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb909-10"><a href="aplikace3.html#cb909-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb909-11"><a href="aplikace3.html#cb909-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb909-12"><a href="aplikace3.html#cb909-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb909-13"><a href="aplikace3.html#cb909-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb909-14"><a href="aplikace3.html#cb909-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb909-15"><a href="aplikace3.html#cb909-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error Rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 27 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-145"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-145-1.png" alt="Dependence of test and training error rates on the number of basis functions for $\beta$. The red dot represents the optimal number $n_{optimal}$ chosen as the minimum of the test error rate, the black line represents the test error, and the blue dashed line represents the training error rate." width="672" />
<p class="caption">
Figure 5.16: Dependence of test and training error rates on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red dot represents the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum of the test error rate, the black line represents the test error, and the blue dashed line represents the training error rate.
</p>
</div>
<p>We see that as the number of bases for <span class="math inline">\(\beta(t)\)</span> increases, the training error rate (blue line) tends to decrease, suggesting that we would choose large values for <span class="math inline">\(n_{basis}\)</span> based on it. Conversely, the optimal choice based on the test error rate is <span class="math inline">\(n\)</span> equal to 9, which is significantly smaller than 30. On the other hand, as <span class="math inline">\(n\)</span> increases, the test error rate rises, indicating model overfitting.</p>
<p>For these reasons, we will use 10-fold cross-validation to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>. We take a maximum of 25 considered basis functions since, as we saw above, beyond this value, model overfitting occurs.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb912"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb912-1"><a href="aplikace3.html#cb912-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb912-2"><a href="aplikace3.html#cb912-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb912-3"><a href="aplikace3.html#cb912-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb912-4"><a href="aplikace3.html#cb912-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb912-5"><a href="aplikace3.html#cb912-5" tabindex="-1"></a><span class="co"># divide training data into k parts</span></span>
<span id="cb912-6"><a href="aplikace3.html#cb912-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb912-7"><a href="aplikace3.html#cb912-7" tabindex="-1"></a><span class="do">## elements that do not change during the loop</span></span>
<span id="cb912-8"><a href="aplikace3.html#cb912-8" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb912-9"><a href="aplikace3.html#cb912-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb912-10"><a href="aplikace3.html#cb912-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb912-11"><a href="aplikace3.html#cb912-11" tabindex="-1"></a><span class="co"># B-spline bases </span></span>
<span id="cb912-12"><a href="aplikace3.html#cb912-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb912-13"><a href="aplikace3.html#cb912-13" tabindex="-1"></a><span class="co"># relationship</span></span>
<span id="cb912-14"><a href="aplikace3.html#cb912-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb912-15"><a href="aplikace3.html#cb912-15" tabindex="-1"></a><span class="co"># bases for x</span></span>
<span id="cb912-16"><a href="aplikace3.html#cb912-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb912-17"><a href="aplikace3.html#cb912-17" tabindex="-1"></a><span class="co"># empty matrix to insert individual results</span></span>
<span id="cb912-18"><a href="aplikace3.html#cb912-18" tabindex="-1"></a><span class="co"># columns will hold accuracy values for each part of the training set</span></span>
<span id="cb912-19"><a href="aplikace3.html#cb912-19" tabindex="-1"></a><span class="co"># rows will hold values for a given number of bases</span></span>
<span id="cb912-20"><a href="aplikace3.html#cb912-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb912-21"><a href="aplikace3.html#cb912-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now we have everything prepared to calculate the error rate on each of the ten subsets of the training set. We will then determine the average and take the optimal <span class="math inline">\(n\)</span> as the argument of the minimum validation error rate.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb913"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb913-1"><a href="aplikace3.html#cb913-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb913-2"><a href="aplikace3.html#cb913-2" tabindex="-1"></a>  <span class="co"># define the given index set</span></span>
<span id="cb913-3"><a href="aplikace3.html#cb913-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb913-4"><a href="aplikace3.html#cb913-4" tabindex="-1"></a>    </span>
<span id="cb913-5"><a href="aplikace3.html#cb913-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb913-6"><a href="aplikace3.html#cb913-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb913-7"><a href="aplikace3.html#cb913-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb913-8"><a href="aplikace3.html#cb913-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb913-9"><a href="aplikace3.html#cb913-9" tabindex="-1"></a>  </span>
<span id="cb913-10"><a href="aplikace3.html#cb913-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb913-11"><a href="aplikace3.html#cb913-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb913-12"><a href="aplikace3.html#cb913-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb913-13"><a href="aplikace3.html#cb913-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb913-14"><a href="aplikace3.html#cb913-14" tabindex="-1"></a>  </span>
<span id="cb913-15"><a href="aplikace3.html#cb913-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb913-16"><a href="aplikace3.html#cb913-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb913-17"><a href="aplikace3.html#cb913-17" tabindex="-1"></a>  </span>
<span id="cb913-18"><a href="aplikace3.html#cb913-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb913-19"><a href="aplikace3.html#cb913-19" tabindex="-1"></a>    <span class="co"># bases for betas</span></span>
<span id="cb913-20"><a href="aplikace3.html#cb913-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb913-21"><a href="aplikace3.html#cb913-21" tabindex="-1"></a>    </span>
<span id="cb913-22"><a href="aplikace3.html#cb913-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb913-23"><a href="aplikace3.html#cb913-23" tabindex="-1"></a>    <span class="co"># input data for the model</span></span>
<span id="cb913-24"><a href="aplikace3.html#cb913-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb913-25"><a href="aplikace3.html#cb913-25" tabindex="-1"></a>    <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb913-26"><a href="aplikace3.html#cb913-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb913-27"><a href="aplikace3.html#cb913-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb913-28"><a href="aplikace3.html#cb913-28" tabindex="-1"></a>    </span>
<span id="cb913-29"><a href="aplikace3.html#cb913-29" tabindex="-1"></a>    <span class="co"># accuracy on the validation part </span></span>
<span id="cb913-30"><a href="aplikace3.html#cb913-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb913-31"><a href="aplikace3.html#cb913-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb913-32"><a href="aplikace3.html#cb913-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb913-33"><a href="aplikace3.html#cb913-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb913-34"><a href="aplikace3.html#cb913-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb913-35"><a href="aplikace3.html#cb913-35" tabindex="-1"></a>    </span>
<span id="cb913-36"><a href="aplikace3.html#cb913-36" tabindex="-1"></a>    <span class="co"># insert into the matrix</span></span>
<span id="cb913-37"><a href="aplikace3.html#cb913-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb913-38"><a href="aplikace3.html#cb913-38" tabindex="-1"></a>  } </span>
<span id="cb913-39"><a href="aplikace3.html#cb913-39" tabindex="-1"></a>}</span>
<span id="cb913-40"><a href="aplikace3.html#cb913-40" tabindex="-1"></a></span>
<span id="cb913-41"><a href="aplikace3.html#cb913-41" tabindex="-1"></a><span class="co"># calculate average accuracy for each n across folds</span></span>
<span id="cb913-42"><a href="aplikace3.html#cb913-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb913-43"><a href="aplikace3.html#cb913-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb913-44"><a href="aplikace3.html#cb913-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span></code></pre></div>
</details>
<p>Let’s plot the course of validation error with the highlighted optimal value of <span class="math inline">\(n_{optimal}\)</span> equal to 16 and validation error equal to 0.0483.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb914"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb914-1"><a href="aplikace3.html#cb914-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb914-2"><a href="aplikace3.html#cb914-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb914-3"><a href="aplikace3.html#cb914-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb914-4"><a href="aplikace3.html#cb914-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb914-5"><a href="aplikace3.html#cb914-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb914-6"><a href="aplikace3.html#cb914-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb914-7"><a href="aplikace3.html#cb914-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb914-8"><a href="aplikace3.html#cb914-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb914-9"><a href="aplikace3.html#cb914-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb914-10"><a href="aplikace3.html#cb914-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis) <span class="sc">+</span> </span>
<span id="cb914-11"><a href="aplikace3.html#cb914-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 22 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-148"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-148-1.png" alt="Dependence of validation error on the value of $n_{basis}$, that is, the number of bases." width="672" />
<p class="caption">
Figure 5.17: Dependence of validation error on the value of <span class="math inline">\(n_{basis}\)</span>, that is, the number of bases.
</p>
</div>
<p>Now we can define the final model using functional logistic regression, choosing a B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 16 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb916"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb916-1"><a href="aplikace3.html#cb916-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb916-2"><a href="aplikace3.html#cb916-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb916-3"><a href="aplikace3.html#cb916-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb916-4"><a href="aplikace3.html#cb916-4" tabindex="-1"></a><span class="co"># bases for x and betas</span></span>
<span id="cb916-5"><a href="aplikace3.html#cb916-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb916-6"><a href="aplikace3.html#cb916-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb916-7"><a href="aplikace3.html#cb916-7" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb916-8"><a href="aplikace3.html#cb916-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb916-9"><a href="aplikace3.html#cb916-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb916-10"><a href="aplikace3.html#cb916-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb916-11"><a href="aplikace3.html#cb916-11" tabindex="-1"></a><span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb916-12"><a href="aplikace3.html#cb916-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb916-13"><a href="aplikace3.html#cb916-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b,</span>
<span id="cb916-14"><a href="aplikace3.html#cb916-14" tabindex="-1"></a>                        <span class="at">maxit =</span> <span class="dv">1000</span>, <span class="at">epsilon =</span> <span class="fl">1e-2</span>)</span>
<span id="cb916-15"><a href="aplikace3.html#cb916-15" tabindex="-1"></a></span>
<span id="cb916-16"><a href="aplikace3.html#cb916-16" tabindex="-1"></a><span class="co"># accuracy on the training data</span></span>
<span id="cb916-17"><a href="aplikace3.html#cb916-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb916-18"><a href="aplikace3.html#cb916-18" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb916-19"><a href="aplikace3.html#cb916-19" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb916-20"><a href="aplikace3.html#cb916-20" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb916-21"><a href="aplikace3.html#cb916-21" tabindex="-1"></a>  </span>
<span id="cb916-22"><a href="aplikace3.html#cb916-22" tabindex="-1"></a><span class="co"># accuracy on the test data</span></span>
<span id="cb916-23"><a href="aplikace3.html#cb916-23" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb916-24"><a href="aplikace3.html#cb916-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb916-25"><a href="aplikace3.html#cb916-25" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb916-26"><a href="aplikace3.html#cb916-26" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb916-27"><a href="aplikace3.html#cb916-27" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the training error (equal to 0 %) and the test error (equal to 7.69 %). For better understanding, we can also plot the values of the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> on the training data in relation to the values of the linear predictor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb917"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb917-1"><a href="aplikace3.html#cb917-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb917-2"><a href="aplikace3.html#cb917-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb917-3"><a href="aplikace3.html#cb917-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb917-4"><a href="aplikace3.html#cb917-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb917-5"><a href="aplikace3.html#cb917-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb917-6"><a href="aplikace3.html#cb917-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb917-7"><a href="aplikace3.html#cb917-7" tabindex="-1"></a>  <span class="fu">scale_color_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="sc">+</span> </span>
<span id="cb917-8"><a href="aplikace3.html#cb917-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb917-9"><a href="aplikace3.html#cb917-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb917-10"><a href="aplikace3.html#cb917-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb917-11"><a href="aplikace3.html#cb917-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probabilities Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb917-12"><a href="aplikace3.html#cb917-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-150"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-150-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are colored according to their belonging to the classification class." width="672" />
<p class="caption">
Figure 6.13: Dependence of estimated probabilities on the values of the linear predictor. Points are colored according to their belonging to the classification class.
</p>
</div>
<p>We can also display the course of the estimated parametric function <span class="math inline">\(\beta(t)\)</span> for reference.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb918"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb918-1"><a href="aplikace3.html#cb918-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb918-2"><a href="aplikace3.html#cb918-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb918-3"><a href="aplikace3.html#cb918-3" tabindex="-1"></a></span>
<span id="cb918-4"><a href="aplikace3.html#cb918-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb918-5"><a href="aplikace3.html#cb918-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb918-6"><a href="aplikace3.html#cb918-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb918-7"><a href="aplikace3.html#cb918-7" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb918-8"><a href="aplikace3.html#cb918-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb918-9"><a href="aplikace3.html#cb918-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb918-10"><a href="aplikace3.html#cb918-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb918-11"><a href="aplikace3.html#cb918-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb918-12"><a href="aplikace3.html#cb918-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb918-13"><a href="aplikace3.html#cb918-13" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-151"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-151-1.png" alt="Course of the estimate of the parametric function $\beta(t), t \in [850, 1050]$." width="672" />
<p class="caption">
Figure 5.18: Course of the estimate of the parametric function <span class="math inline">\(\beta(t), t \in [850, 1050]\)</span>.
</p>
</div>
<p>We see that the values of the function <span class="math inline">\(\hat\beta(t)\)</span> stay around zero for times <span class="math inline">\(t\)</span> from the middle and beginning of the interval <span class="math inline">\([850, 1050]\)</span>, while for later times, the values are higher. This implies the differences between functions from the classification classes at the beginning and end of the interval, while in the middle of the interval, the functions are very similar.</p>
<p>We will again add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb919"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb919-1"><a href="aplikace3.html#cb919-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb919-2"><a href="aplikace3.html#cb919-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb919-3"><a href="aplikace3.html#cb919-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb919-4"><a href="aplikace3.html#cb919-4" tabindex="-1"></a></span>
<span id="cb919-5"><a href="aplikace3.html#cb919-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-with-principal-component-analysis-4" class="section level4 hasAnchor" number="6.4.4.2">
<h4><span class="header-section-number">6.4.4.2</span> Logistic Regression with Principal Component Analysis<a href="aplikace3.html#logistic-regression-with-principal-component-analysis-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To construct this classifier, we need to perform functional principal component analysis, determine the appropriate number of components, and compute score values for the test data. We have already done this in the linear discriminant analysis section, so we will use these results in the following part.</p>
<p>We can now construct the logistic regression model using the <code>glm(, family = binomial)</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb920"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb920-1"><a href="aplikace3.html#cb920-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb920-2"><a href="aplikace3.html#cb920-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span></code></pre></div>
</details>
<pre><code>## Warning: glm.fit: fitted probabilities numerically 0 or 1 occurred</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb922"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb922-1"><a href="aplikace3.html#cb922-1" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb922-2"><a href="aplikace3.html#cb922-2" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb922-3"><a href="aplikace3.html#cb922-3" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb922-4"><a href="aplikace3.html#cb922-4" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb922-5"><a href="aplikace3.html#cb922-5" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb922-6"><a href="aplikace3.html#cb922-6" tabindex="-1"></a>  </span>
<span id="cb922-7"><a href="aplikace3.html#cb922-7" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb922-8"><a href="aplikace3.html#cb922-8" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb922-9"><a href="aplikace3.html#cb922-9" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb922-10"><a href="aplikace3.html#cb922-10" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb922-11"><a href="aplikace3.html#cb922-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have thus calculated the error rate of the classifier on the training (0.67 %) and test data (4.62 %).</p>
<p>For a graphical representation of the method, we can mark the decision boundary in the plot of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did for LDA and QDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb923"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb923-1"><a href="aplikace3.html#cb923-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb923-2"><a href="aplikace3.html#cb923-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb923-3"><a href="aplikace3.html#cb923-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb923-4"><a href="aplikace3.html#cb923-4" tabindex="-1"></a></span>
<span id="cb923-5"><a href="aplikace3.html#cb923-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb923-6"><a href="aplikace3.html#cb923-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb923-7"><a href="aplikace3.html#cb923-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb923-8"><a href="aplikace3.html#cb923-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb923-9"><a href="aplikace3.html#cb923-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb923-10"><a href="aplikace3.html#cb923-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb923-11"><a href="aplikace3.html#cb923-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Fat content&#39;</span>) <span class="sc">+</span></span>
<span id="cb923-12"><a href="aplikace3.html#cb923-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb923-13"><a href="aplikace3.html#cb923-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb923-14"><a href="aplikace3.html#cb923-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-157"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-157-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (a line in the plane of the first two principal components) between the classes is marked in black and constructed using logistic regression." width="672" />
<p class="caption">
Figure 1.28: Scores of the first two principal components, color-coded according to class membership. The decision boundary (a line in the plane of the first two principal components) between the classes is marked in black and constructed using logistic regression.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a line, as in the case of LDA.</p>
<p>Finally, let’s add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb924"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb924-1"><a href="aplikace3.html#cb924-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb924-2"><a href="aplikace3.html#cb924-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb924-3"><a href="aplikace3.html#cb924-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb924-4"><a href="aplikace3.html#cb924-4" tabindex="-1"></a></span>
<span id="cb924-5"><a href="aplikace3.html#cb924-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="decision-trees-5" class="section level3 hasAnchor" number="6.4.5">
<h3><span class="header-section-number">6.4.5</span> Decision Trees<a href="aplikace3.html#decision-trees-5" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will look at a very different approach to constructing a classifier than methods like LDA or logistic regression. Decision trees are a very popular tool for classification, but as with some previous methods, they are not directly designed for functional data. However, there are ways to convert functional objects into multidimensional ones and then apply the decision tree algorithm to them. We can consider the following approaches:</p>
<ul>
<li>An algorithm constructed on the basis of coefficients,</li>
<li>Using principal component scores,</li>
<li>Applying discretization of the interval and evaluating the function only on a finite grid of points.</li>
</ul>
<p>We will first focus on interval discretization and then compare the results with the remaining two approaches to constructing a decision tree.</p>
<div id="interval-discretization-9" class="section level4 hasAnchor" number="6.4.5.1">
<h4><span class="header-section-number">6.4.5.1</span> Interval Discretization<a href="aplikace3.html#interval-discretization-9" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we need to define the points from the interval <span class="math inline">\(I = [850, 1050]\)</span> at which we will evaluate the functions. Next, we will create an object in which the rows represent individual (discretized) functions and the columns represent time points. Finally, we will append the column <span class="math inline">\(Y\)</span> with information about class membership, and we will repeat the same for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb925"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb925-1"><a href="aplikace3.html#cb925-1" tabindex="-1"></a><span class="co"># sequence of points at which we will evaluate the functions</span></span>
<span id="cb925-2"><a href="aplikace3.html#cb925-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb925-3"><a href="aplikace3.html#cb925-3" tabindex="-1"></a>   </span>
<span id="cb925-4"><a href="aplikace3.html#cb925-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb925-5"><a href="aplikace3.html#cb925-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for functions in rows</span></span>
<span id="cb925-6"><a href="aplikace3.html#cb925-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb925-7"><a href="aplikace3.html#cb925-7" tabindex="-1"></a></span>
<span id="cb925-8"><a href="aplikace3.html#cb925-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb925-9"><a href="aplikace3.html#cb925-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb925-10"><a href="aplikace3.html#cb925-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can construct a decision tree where all time points from the vector <code>t.seq</code> will serve as predictors. This classification method is not susceptible to multicollinearity, so we do not need to worry about it. We will choose accuracy as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb926"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb926-1"><a href="aplikace3.html#cb926-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb926-2"><a href="aplikace3.html#cb926-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb926-3"><a href="aplikace3.html#cb926-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb926-4"><a href="aplikace3.html#cb926-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb926-5"><a href="aplikace3.html#cb926-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb926-6"><a href="aplikace3.html#cb926-6" tabindex="-1"></a></span>
<span id="cb926-7"><a href="aplikace3.html#cb926-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb926-8"><a href="aplikace3.html#cb926-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb926-9"><a href="aplikace3.html#cb926-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb926-10"><a href="aplikace3.html#cb926-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb926-11"><a href="aplikace3.html#cb926-11" tabindex="-1"></a>  </span>
<span id="cb926-12"><a href="aplikace3.html#cb926-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb926-13"><a href="aplikace3.html#cb926-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb926-14"><a href="aplikace3.html#cb926-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb926-15"><a href="aplikace3.html#cb926-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, the error rate of the classifier on the test data is 1.54 % and on the training data is 0.67 %.</p>
<p>Graphically, we can visualize the decision tree using the <code>fancyRpartPlot()</code> function. We will set the node colors to reflect the previous color coding. This will be an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb927"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb927-1"><a href="aplikace3.html#cb927-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb927-2"><a href="aplikace3.html#cb927-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb927-3"><a href="aplikace3.html#cb927-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-161"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-161-1.png" alt="Graphical representation of the unpruned decision tree. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red." width="672" />
<p class="caption">
Figure 1.30: Graphical representation of the unpruned decision tree. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red.
</p>
</div>
<p>We can also visualize the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb928"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb928-1"><a href="aplikace3.html#cb928-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb928-2"><a href="aplikace3.html#cb928-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display of desired information</span></span>
<span id="cb928-3"><a href="aplikace3.html#cb928-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb928-4"><a href="aplikace3.html#cb928-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb928-5"><a href="aplikace3.html#cb928-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb928-6"><a href="aplikace3.html#cb928-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb928-7"><a href="aplikace3.html#cb928-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb928-8"><a href="aplikace3.html#cb928-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-162"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-162-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 6.14: Final pruned decision tree.
</p>
</div>
<p>Finally, let’s add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb929"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb929-1"><a href="aplikace3.html#cb929-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discretization&#39;</span>, </span>
<span id="cb929-2"><a href="aplikace3.html#cb929-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb929-3"><a href="aplikace3.html#cb929-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb929-4"><a href="aplikace3.html#cb929-4" tabindex="-1"></a></span>
<span id="cb929-5"><a href="aplikace3.html#cb929-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-11" class="section level4 hasAnchor" number="6.4.5.2">
<h4><span class="header-section-number">6.4.5.2</span> Principal Component Scores<a href="aplikace3.html#principal-component-scores-11" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another option for constructing a decision tree is to use principal component scores. Since we have already computed the scores for previous classification methods, we will utilize this knowledge and build a decision tree based on the scores of the first 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb930"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb930-1"><a href="aplikace3.html#cb930-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb930-2"><a href="aplikace3.html#cb930-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb930-3"><a href="aplikace3.html#cb930-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb930-4"><a href="aplikace3.html#cb930-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb930-5"><a href="aplikace3.html#cb930-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb930-6"><a href="aplikace3.html#cb930-6" tabindex="-1"></a></span>
<span id="cb930-7"><a href="aplikace3.html#cb930-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb930-8"><a href="aplikace3.html#cb930-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb930-9"><a href="aplikace3.html#cb930-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb930-10"><a href="aplikace3.html#cb930-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb930-11"><a href="aplikace3.html#cb930-11" tabindex="-1"></a>  </span>
<span id="cb930-12"><a href="aplikace3.html#cb930-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb930-13"><a href="aplikace3.html#cb930-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb930-14"><a href="aplikace3.html#cb930-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb930-15"><a href="aplikace3.html#cb930-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, the error rate of the decision tree on the test data is 6.15 % and on the training data is 0.67 %.</p>
<p>We can visualize the decision tree constructed on the principal component scores using the <code>fancyRpartPlot()</code> function. We will set the node colors to reflect the previous color coding. This will be an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb931"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb931-1"><a href="aplikace3.html#cb931-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb931-2"><a href="aplikace3.html#cb931-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-165"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-165-1.png" alt="Graphical representation of the unpruned decision tree constructed on principal component scores. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red." width="672" />
<p class="caption">
Figure 1.32: Graphical representation of the unpruned decision tree constructed on principal component scores. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red.
</p>
</div>
<p>We can also visualize the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb932"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb932-1"><a href="aplikace3.html#cb932-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb932-2"><a href="aplikace3.html#cb932-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display of desired information</span></span>
<span id="cb932-3"><a href="aplikace3.html#cb932-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb932-4"><a href="aplikace3.html#cb932-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb932-5"><a href="aplikace3.html#cb932-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb932-6"><a href="aplikace3.html#cb932-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-166"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-166-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.23: Final pruned decision tree.
</p>
</div>
<p>Finally, let’s add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb933"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb933-1"><a href="aplikace3.html#cb933-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb933-2"><a href="aplikace3.html#cb933-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb933-3"><a href="aplikace3.html#cb933-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb933-4"><a href="aplikace3.html#cb933-4" tabindex="-1"></a></span>
<span id="cb933-5"><a href="aplikace3.html#cb933-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="b-spline-coefficients-2" class="section level4 hasAnchor" number="6.4.5.3">
<h4><span class="header-section-number">6.4.5.3</span> B-spline Coefficients<a href="aplikace3.html#b-spline-coefficients-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The last option we will use for constructing the decision tree is to utilize the coefficients expressed in the B-spline basis.</p>
<p>First, let’s define the necessary datasets with the coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb934"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb934-1"><a href="aplikace3.html#cb934-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb934-2"><a href="aplikace3.html#cb934-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb934-3"><a href="aplikace3.html#cb934-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb934-4"><a href="aplikace3.html#cb934-4" tabindex="-1"></a></span>
<span id="cb934-5"><a href="aplikace3.html#cb934-5" tabindex="-1"></a><span class="co"># testing dataset</span></span>
<span id="cb934-6"><a href="aplikace3.html#cb934-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb934-7"><a href="aplikace3.html#cb934-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now we can build the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb935"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb935-1"><a href="aplikace3.html#cb935-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb935-2"><a href="aplikace3.html#cb935-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb935-3"><a href="aplikace3.html#cb935-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb935-4"><a href="aplikace3.html#cb935-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb935-5"><a href="aplikace3.html#cb935-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb935-6"><a href="aplikace3.html#cb935-6" tabindex="-1"></a></span>
<span id="cb935-7"><a href="aplikace3.html#cb935-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb935-8"><a href="aplikace3.html#cb935-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb935-9"><a href="aplikace3.html#cb935-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb935-10"><a href="aplikace3.html#cb935-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb935-11"><a href="aplikace3.html#cb935-11" tabindex="-1"></a>  </span>
<span id="cb935-12"><a href="aplikace3.html#cb935-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb935-13"><a href="aplikace3.html#cb935-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb935-14"><a href="aplikace3.html#cb935-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb935-15"><a href="aplikace3.html#cb935-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, the error rate of the decision tree on the training data is 0.67 % and on the test data is 1.54 %.</p>
<p>We can visualize the decision tree constructed on the B-spline coefficients using the <code>fancyRpartPlot()</code> function. We will set the node colors to reflect the previous color coding. This will be an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb936"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb936-1"><a href="aplikace3.html#cb936-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb936-2"><a href="aplikace3.html#cb936-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-170"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-170-1.png" alt="Graphical representation of the unpruned decision tree constructed on B-spline coefficients. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red." width="672" />
<p class="caption">
Figure 5.24: Graphical representation of the unpruned decision tree constructed on B-spline coefficients. Nodes belonging to class 1 are colored in shades of blue, and nodes belonging to class 0 are colored in shades of red.
</p>
</div>
<p>We can also visualize the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb937"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb937-1"><a href="aplikace3.html#cb937-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb937-2"><a href="aplikace3.html#cb937-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display of desired information</span></span>
<span id="cb937-3"><a href="aplikace3.html#cb937-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb937-4"><a href="aplikace3.html#cb937-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb937-5"><a href="aplikace3.html#cb937-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb937-6"><a href="aplikace3.html#cb937-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-171"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-171-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 6.15: Final pruned decision tree.
</p>
</div>
<p>Finally, let’s add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb938"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb938-1"><a href="aplikace3.html#cb938-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb938-2"><a href="aplikace3.html#cb938-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb938-3"><a href="aplikace3.html#cb938-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb938-4"><a href="aplikace3.html#cb938-4" tabindex="-1"></a></span>
<span id="cb938-5"><a href="aplikace3.html#cb938-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests-6" class="section level3 hasAnchor" number="6.4.6">
<h3><span class="header-section-number">6.4.6</span> Random Forests<a href="aplikace3.html#random-forests-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A classifier built using the random forest method involves constructing several individual decision trees, which are then combined to create a single classifier through “voting.”</p>
<p>Just as with decision trees, we have several options regarding which data (finite-dimensional) to use for constructing the model. We will again consider the three approaches discussed earlier. The data files with the corresponding variables for all three approaches have already been prepared from the previous section, so we can proceed directly to build the models, calculate the characteristics of each classifier, and add the results to the summary table.</p>
<div id="discretization-of-the-interval-2" class="section level4 hasAnchor" number="6.4.6.1">
<h4><span class="header-section-number">6.4.6.1</span> Discretization of the Interval<a href="aplikace3.html#discretization-of-the-interval-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the first case, we utilize the evaluation of functions on a specified grid of points in the interval <span class="math inline">\(I = [850, 1050]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb939"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb939-1"><a href="aplikace3.html#cb939-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb939-2"><a href="aplikace3.html#cb939-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb939-3"><a href="aplikace3.html#cb939-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb939-4"><a href="aplikace3.html#cb939-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb939-5"><a href="aplikace3.html#cb939-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb939-6"><a href="aplikace3.html#cb939-6" tabindex="-1"></a></span>
<span id="cb939-7"><a href="aplikace3.html#cb939-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb939-8"><a href="aplikace3.html#cb939-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb939-9"><a href="aplikace3.html#cb939-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb939-10"><a href="aplikace3.html#cb939-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb939-11"><a href="aplikace3.html#cb939-11" tabindex="-1"></a>  </span>
<span id="cb939-12"><a href="aplikace3.html#cb939-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb939-13"><a href="aplikace3.html#cb939-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb939-14"><a href="aplikace3.html#cb939-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb939-15"><a href="aplikace3.html#cb939-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 0 % and on the test data is 4.62 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb940"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb940-1"><a href="aplikace3.html#cb940-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - diskr&#39;</span>, </span>
<span id="cb940-2"><a href="aplikace3.html#cb940-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb940-3"><a href="aplikace3.html#cb940-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb940-4"><a href="aplikace3.html#cb940-4" tabindex="-1"></a></span>
<span id="cb940-5"><a href="aplikace3.html#cb940-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-12" class="section level4 hasAnchor" number="6.4.6.2">
<h4><span class="header-section-number">6.4.6.2</span> Principal Component Scores<a href="aplikace3.html#principal-component-scores-12" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb941"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb941-1"><a href="aplikace3.html#cb941-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb941-2"><a href="aplikace3.html#cb941-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb941-3"><a href="aplikace3.html#cb941-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb941-4"><a href="aplikace3.html#cb941-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb941-5"><a href="aplikace3.html#cb941-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb941-6"><a href="aplikace3.html#cb941-6" tabindex="-1"></a></span>
<span id="cb941-7"><a href="aplikace3.html#cb941-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb941-8"><a href="aplikace3.html#cb941-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb941-9"><a href="aplikace3.html#cb941-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb941-10"><a href="aplikace3.html#cb941-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb941-11"><a href="aplikace3.html#cb941-11" tabindex="-1"></a>  </span>
<span id="cb941-12"><a href="aplikace3.html#cb941-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb941-13"><a href="aplikace3.html#cb941-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb941-14"><a href="aplikace3.html#cb941-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb941-15"><a href="aplikace3.html#cb941-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 0.67 % and on the test data is 4.62 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb942"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb942-1"><a href="aplikace3.html#cb942-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb942-2"><a href="aplikace3.html#cb942-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb942-3"><a href="aplikace3.html#cb942-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb942-4"><a href="aplikace3.html#cb942-4" tabindex="-1"></a></span>
<span id="cb942-5"><a href="aplikace3.html#cb942-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="b-spline-coefficients-3" class="section level4 hasAnchor" number="6.4.6.3">
<h4><span class="header-section-number">6.4.6.3</span> B-spline Coefficients<a href="aplikace3.html#b-spline-coefficients-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use the representation of functions through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb943"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb943-1"><a href="aplikace3.html#cb943-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb943-2"><a href="aplikace3.html#cb943-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb943-3"><a href="aplikace3.html#cb943-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb943-4"><a href="aplikace3.html#cb943-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb943-5"><a href="aplikace3.html#cb943-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb943-6"><a href="aplikace3.html#cb943-6" tabindex="-1"></a></span>
<span id="cb943-7"><a href="aplikace3.html#cb943-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb943-8"><a href="aplikace3.html#cb943-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb943-9"><a href="aplikace3.html#cb943-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb943-10"><a href="aplikace3.html#cb943-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb943-11"><a href="aplikace3.html#cb943-11" tabindex="-1"></a>  </span>
<span id="cb943-12"><a href="aplikace3.html#cb943-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb943-13"><a href="aplikace3.html#cb943-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb943-14"><a href="aplikace3.html#cb943-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb943-15"><a href="aplikace3.html#cb943-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 0 % and on the test data is 3.08 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb944"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb944-1"><a href="aplikace3.html#cb944-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb944-2"><a href="aplikace3.html#cb944-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb944-3"><a href="aplikace3.html#cb944-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb944-4"><a href="aplikace3.html#cb944-4" tabindex="-1"></a></span>
<span id="cb944-5"><a href="aplikace3.html#cb944-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-7" class="section level3 hasAnchor" number="6.4.7">
<h3><span class="header-section-number">6.4.7</span> Support Vector Machines<a href="aplikace3.html#support-vector-machines-7" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s look at the classification of our curves using Support Vector Machines (SVM). The advantage of this classification method is its computational efficiency, as it uses only a few (often very few) observations to define the boundary curve between classes.</p>
<p>The main advantage of SVM is the use of the so-called <em>kernel trick</em>, which allows us to replace the standard scalar product with a different scalar product of transformed data without having to define this transformation explicitly. This results in a generally nonlinear decision boundary between the classification classes. A <em>kernel</em> (kernel function) <span class="math inline">\(K\)</span> is a function that satisfies</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span>
where <span class="math inline">\(\phi\)</span> is some (unknown) transformation (feature map), <span class="math inline">\(\mathcal H\)</span> is a Hilbert space, and <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> is a scalar product on this Hilbert space.</p>
<p>In practice, three types of kernel functions are most commonly used:</p>
<ul>
<li>Linear kernel – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>Polynomial kernel – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>Radial (Gaussian) kernel – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>For all the aforementioned kernels, we need to choose a constant <span class="math inline">\(C &gt; 0\)</span>, which indicates the degree of penalty for exceeding the decision boundary between classes (inverse regularization parameter). As the value of <span class="math inline">\(C\)</span> increases, the method will penalize misclassified data more and shape the boundary less; conversely, for small values of <span class="math inline">\(C\)</span>, the method pays less attention to misclassified data and focuses more on penalizing the shape of the boundary. This constant <span class="math inline">\(C\)</span> is typically set to 1 by default, but we can also determine it directly, for example, using cross-validation.</p>
<p>By using cross-validation, we can also determine the optimal values of other hyperparameters that now depend on our choice of kernel function. In the case of a linear kernel, no other parameters are chosen apart from the constant <span class="math inline">\(C\)</span>. For polynomial and radial kernels, we need to specify the values of the hyperparameters <span class="math inline">\(\alpha_0, \gamma, \text{ and } d\)</span>, whose default values in <code>R</code> are <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{dim(\texttt{data})}, \text{ and } d^{default} = 3\)</span>.</p>
<p>In the case of functional data, we have several options for using the SVM method. The simplest variant is to apply this classification method directly to the discretized function (see section <a href="aplikace3.html#diskrA3b">6.4.7.2</a>). Another option is to utilize the scores of the principal components to classify the curves based on their representation (see section <a href="aplikace3.html#PCA-SVMA3b">6.4.7.3</a>). Another straightforward variant is to use the representation of the curves through the B-spline basis and classify the curves based on the coefficients of their representation in this basis (see section <a href="aplikace3.html#basis-SVMA3b">6.4.7.4</a>).</p>
<p>With more complex considerations, we can arrive at several additional options that utilize the functional nature of the data. Firstly, instead of classifying the original curve, we can use its derivative (or even its second, third derivative, etc.). Secondly, we can use projections of functions onto a subspace generated by, for example, B-spline functions (see section <a href="aplikace3.html#projection-SVMA3b">6.4.7.5</a>). The last method we will use for classifying functional data involves combining projection onto a specific subspace generated by functions (Reproducing Kernel Hilbert Space, RKHS) and classifying the corresponding representation. This method utilizes not only classical SVM but also SVM for regression, which is further elaborated in section RKHS + SVM <a href="aplikace3.html#RKHS-SVMA3b">6.4.7.6</a>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb945"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb945-1"><a href="aplikace3.html#cb945-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb945-2"><a href="aplikace3.html#cb945-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb945-3"><a href="aplikace3.html#cb945-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb945-4"><a href="aplikace3.html#cb945-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb945-5"><a href="aplikace3.html#cb945-5" tabindex="-1"></a>}</span>
<span id="cb945-6"><a href="aplikace3.html#cb945-6" tabindex="-1"></a>XXfd_norm_der <span class="ot">&lt;-</span> XXder </span>
<span id="cb945-7"><a href="aplikace3.html#cb945-7" tabindex="-1"></a>XXfd_norm_der<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm_der<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb945-8"><a href="aplikace3.html#cb945-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb945-9"><a href="aplikace3.html#cb945-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb945-10"><a href="aplikace3.html#cb945-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb945-11"><a href="aplikace3.html#cb945-11" tabindex="-1"></a></span>
<span id="cb945-12"><a href="aplikace3.html#cb945-12" tabindex="-1"></a><span class="co"># split into test and training set</span></span>
<span id="cb945-13"><a href="aplikace3.html#cb945-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb945-14"><a href="aplikace3.html#cb945-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb945-15"><a href="aplikace3.html#cb945-15" tabindex="-1"></a></span>
<span id="cb945-16"><a href="aplikace3.html#cb945-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb945-17"><a href="aplikace3.html#cb945-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb945-18"><a href="aplikace3.html#cb945-18" tabindex="-1"></a></span>
<span id="cb945-19"><a href="aplikace3.html#cb945-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb945-20"><a href="aplikace3.html#cb945-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb945-21"><a href="aplikace3.html#cb945-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb945-22"><a href="aplikace3.html#cb945-22" tabindex="-1"></a></span>
<span id="cb945-23"><a href="aplikace3.html#cb945-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb945-24"><a href="aplikace3.html#cb945-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb945-25"><a href="aplikace3.html#cb945-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<div id="svm-for-functional-data-5" class="section level4 hasAnchor" number="6.4.7.1">
<h4><span class="header-section-number">6.4.7.1</span> SVM for Functional Data<a href="aplikace3.html#svm-for-functional-data-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the <code>fda.usc</code> library, we will use the function <code>classif.svm()</code> to apply the SVM method directly to functional data. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb946"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb946-1"><a href="aplikace3.html#cb946-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb946-2"><a href="aplikace3.html#cb946-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb946-3"><a href="aplikace3.html#cb946-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb946-4"><a href="aplikace3.html#cb946-4" tabindex="-1"></a></span>
<span id="cb946-5"><a href="aplikace3.html#cb946-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb946-6"><a href="aplikace3.html#cb946-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb946-7"><a href="aplikace3.html#cb946-7" tabindex="-1"></a></span>
<span id="cb946-8"><a href="aplikace3.html#cb946-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb946-9"><a href="aplikace3.html#cb946-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb946-10"><a href="aplikace3.html#cb946-10" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb946-11"><a href="aplikace3.html#cb946-11" tabindex="-1"></a></span>
<span id="cb946-12"><a href="aplikace3.html#cb946-12" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb946-13"><a href="aplikace3.html#cb946-13" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">norder =</span> <span class="dv">4</span>, <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb947"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb947-1"><a href="aplikace3.html#cb947-1" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb947-2"><a href="aplikace3.html#cb947-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb947-3"><a href="aplikace3.html#cb947-3" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb947-4"><a href="aplikace3.html#cb947-4" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb947-5"><a href="aplikace3.html#cb947-5" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb947-6"><a href="aplikace3.html#cb947-6" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb947-7"><a href="aplikace3.html#cb947-7" tabindex="-1"></a><span class="co"># SVM model</span></span>
<span id="cb947-8"><a href="aplikace3.html#cb947-8" tabindex="-1"></a>model.svm.f <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb947-9"><a href="aplikace3.html#cb947-9" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb947-10"><a href="aplikace3.html#cb947-10" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb947-11"><a href="aplikace3.html#cb947-11" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, <span class="at">degree =</span> <span class="dv">5</span>, <span class="at">coef0 =</span> <span class="dv">1</span>, <span class="at">cost =</span> <span class="fl">1e4</span>)</span>
<span id="cb947-12"><a href="aplikace3.html#cb947-12" tabindex="-1"></a></span>
<span id="cb947-13"><a href="aplikace3.html#cb947-13" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb947-14"><a href="aplikace3.html#cb947-14" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb947-15"><a href="aplikace3.html#cb947-15" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb947-16"><a href="aplikace3.html#cb947-16" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train)</span>
<span id="cb947-17"><a href="aplikace3.html#cb947-17" tabindex="-1"></a>  </span>
<span id="cb947-18"><a href="aplikace3.html#cb947-18" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb947-19"><a href="aplikace3.html#cb947-19" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb947-20"><a href="aplikace3.html#cb947-20" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb947-21"><a href="aplikace3.html#cb947-21" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test)</span></code></pre></div>
</details>
<p>We calculated the training error (which is 0 %) and the test error (which is 6.15 %).</p>
<p>Now let’s attempt, unlike the procedure in the previous chapters, to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, acknowledging that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will explore the values of the hyperparameter <span class="math inline">\(C\)</span> in the range <span class="math inline">\([10^{-2}, 10^{4}]\)</span>, while for the polynomial kernel, we will consider the value of the hyperparameter <span class="math inline">\(p\)</span> to be 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use <span class="math inline">\(r k_cv\)</span>-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the range <span class="math inline">\([10^{-5}, 10^{0}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb948"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb948-1"><a href="aplikace3.html#cb948-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb948-2"><a href="aplikace3.html#cb948-2" tabindex="-1"></a></span>
<span id="cb948-3"><a href="aplikace3.html#cb948-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb948-4"><a href="aplikace3.html#cb948-4" tabindex="-1"></a></span>
<span id="cb948-5"><a href="aplikace3.html#cb948-5" tabindex="-1"></a><span class="co"># We split the training data into k parts</span></span>
<span id="cb948-6"><a href="aplikace3.html#cb948-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb948-7"><a href="aplikace3.html#cb948-7" tabindex="-1"></a></span>
<span id="cb948-8"><a href="aplikace3.html#cb948-8" tabindex="-1"></a><span class="co"># Which values of gamma do we want to consider</span></span>
<span id="cb948-9"><a href="aplikace3.html#cb948-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb948-10"><a href="aplikace3.html#cb948-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb948-11"><a href="aplikace3.html#cb948-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb948-12"><a href="aplikace3.html#cb948-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb948-13"><a href="aplikace3.html#cb948-13" tabindex="-1"></a></span>
<span id="cb948-14"><a href="aplikace3.html#cb948-14" tabindex="-1"></a><span class="co"># A list with three components... an array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb948-15"><a href="aplikace3.html#cb948-15" tabindex="-1"></a><span class="co"># An empty matrix where we will place individual results</span></span>
<span id="cb948-16"><a href="aplikace3.html#cb948-16" tabindex="-1"></a><span class="co"># The columns will contain the accuracy values for each</span></span>
<span id="cb948-17"><a href="aplikace3.html#cb948-17" tabindex="-1"></a><span class="co"># The rows will correspond to the values for a given gamma and the layers correspond to folds</span></span>
<span id="cb948-18"><a href="aplikace3.html#cb948-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb948-19"><a href="aplikace3.html#cb948-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb948-20"><a href="aplikace3.html#cb948-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb948-21"><a href="aplikace3.html#cb948-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb948-22"><a href="aplikace3.html#cb948-22" tabindex="-1"></a>)</span>
<span id="cb948-23"><a href="aplikace3.html#cb948-23" tabindex="-1"></a></span>
<span id="cb948-24"><a href="aplikace3.html#cb948-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb948-25"><a href="aplikace3.html#cb948-25" tabindex="-1"></a><span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb948-26"><a href="aplikace3.html#cb948-26" tabindex="-1"></a>  <span class="co"># We go through the individual folds</span></span>
<span id="cb948-27"><a href="aplikace3.html#cb948-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb948-28"><a href="aplikace3.html#cb948-28" tabindex="-1"></a>    <span class="co"># Definition of the test and training parts for CV</span></span>
<span id="cb948-29"><a href="aplikace3.html#cb948-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb948-30"><a href="aplikace3.html#cb948-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb948-31"><a href="aplikace3.html#cb948-31" tabindex="-1"></a>    </span>
<span id="cb948-32"><a href="aplikace3.html#cb948-32" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb948-33"><a href="aplikace3.html#cb948-33" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb948-34"><a href="aplikace3.html#cb948-34" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb948-35"><a href="aplikace3.html#cb948-35" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb948-36"><a href="aplikace3.html#cb948-36" tabindex="-1"></a>    </span>
<span id="cb948-37"><a href="aplikace3.html#cb948-37" tabindex="-1"></a>    <span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb948-38"><a href="aplikace3.html#cb948-38" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb948-39"><a href="aplikace3.html#cb948-39" tabindex="-1"></a>    </span>
<span id="cb948-40"><a href="aplikace3.html#cb948-40" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb948-41"><a href="aplikace3.html#cb948-41" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb948-42"><a href="aplikace3.html#cb948-42" tabindex="-1"></a>    <span class="co"># B-spline basis</span></span>
<span id="cb948-43"><a href="aplikace3.html#cb948-43" tabindex="-1"></a>    <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb948-44"><a href="aplikace3.html#cb948-44" tabindex="-1"></a>    <span class="co"># Formula</span></span>
<span id="cb948-45"><a href="aplikace3.html#cb948-45" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb948-46"><a href="aplikace3.html#cb948-46" tabindex="-1"></a>    <span class="co"># Basis for x</span></span>
<span id="cb948-47"><a href="aplikace3.html#cb948-47" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb948-48"><a href="aplikace3.html#cb948-48" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb948-49"><a href="aplikace3.html#cb948-49" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb948-50"><a href="aplikace3.html#cb948-50" tabindex="-1"></a>    </span>
<span id="cb948-51"><a href="aplikace3.html#cb948-51" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb948-52"><a href="aplikace3.html#cb948-52" tabindex="-1"></a>    <span class="co"># SVM model</span></span>
<span id="cb948-53"><a href="aplikace3.html#cb948-53" tabindex="-1"></a>    clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb948-54"><a href="aplikace3.html#cb948-54" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb948-55"><a href="aplikace3.html#cb948-55" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb948-56"><a href="aplikace3.html#cb948-56" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb948-57"><a href="aplikace3.html#cb948-57" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb948-58"><a href="aplikace3.html#cb948-58" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb948-59"><a href="aplikace3.html#cb948-59" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb948-60"><a href="aplikace3.html#cb948-60" tabindex="-1"></a>      </span>
<span id="cb948-61"><a href="aplikace3.html#cb948-61" tabindex="-1"></a>    <span class="co"># Accuracy on the test data</span></span>
<span id="cb948-62"><a href="aplikace3.html#cb948-62" tabindex="-1"></a>    newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb948-63"><a href="aplikace3.html#cb948-63" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb948-64"><a href="aplikace3.html#cb948-64" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb948-65"><a href="aplikace3.html#cb948-65" tabindex="-1"></a>    </span>
<span id="cb948-66"><a href="aplikace3.html#cb948-66" tabindex="-1"></a>    <span class="co"># We insert the accuracies into positions for the given C and fold</span></span>
<span id="cb948-67"><a href="aplikace3.html#cb948-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb948-68"><a href="aplikace3.html#cb948-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb948-69"><a href="aplikace3.html#cb948-69" tabindex="-1"></a>    </span>
<span id="cb948-70"><a href="aplikace3.html#cb948-70" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb948-71"><a href="aplikace3.html#cb948-71" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb948-72"><a href="aplikace3.html#cb948-72" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb948-73"><a href="aplikace3.html#cb948-73" tabindex="-1"></a>      clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb948-74"><a href="aplikace3.html#cb948-74" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb948-75"><a href="aplikace3.html#cb948-75" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb948-76"><a href="aplikace3.html#cb948-76" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb948-77"><a href="aplikace3.html#cb948-77" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb948-78"><a href="aplikace3.html#cb948-78" tabindex="-1"></a>                <span class="at">coef0 =</span> coef0,</span>
<span id="cb948-79"><a href="aplikace3.html#cb948-79" tabindex="-1"></a>                <span class="at">degree =</span> p,</span>
<span id="cb948-80"><a href="aplikace3.html#cb948-80" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb948-81"><a href="aplikace3.html#cb948-81" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb948-82"><a href="aplikace3.html#cb948-82" tabindex="-1"></a>        </span>
<span id="cb948-83"><a href="aplikace3.html#cb948-83" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb948-84"><a href="aplikace3.html#cb948-84" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb948-85"><a href="aplikace3.html#cb948-85" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb948-86"><a href="aplikace3.html#cb948-86" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb948-87"><a href="aplikace3.html#cb948-87" tabindex="-1"></a>      </span>
<span id="cb948-88"><a href="aplikace3.html#cb948-88" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, p, and fold</span></span>
<span id="cb948-89"><a href="aplikace3.html#cb948-89" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb948-90"><a href="aplikace3.html#cb948-90" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb948-91"><a href="aplikace3.html#cb948-91" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb948-92"><a href="aplikace3.html#cb948-92" tabindex="-1"></a>    }</span>
<span id="cb948-93"><a href="aplikace3.html#cb948-93" tabindex="-1"></a>        </span>
<span id="cb948-94"><a href="aplikace3.html#cb948-94" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb948-95"><a href="aplikace3.html#cb948-95" tabindex="-1"></a>    <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb948-96"><a href="aplikace3.html#cb948-96" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb948-97"><a href="aplikace3.html#cb948-97" tabindex="-1"></a>      clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb948-98"><a href="aplikace3.html#cb948-98" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb948-99"><a href="aplikace3.html#cb948-99" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb948-100"><a href="aplikace3.html#cb948-100" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb948-101"><a href="aplikace3.html#cb948-101" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb948-102"><a href="aplikace3.html#cb948-102" tabindex="-1"></a>                <span class="at">gamma =</span> gam.cv,</span>
<span id="cb948-103"><a href="aplikace3.html#cb948-103" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb948-104"><a href="aplikace3.html#cb948-104" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb948-105"><a href="aplikace3.html#cb948-105" tabindex="-1"></a>        </span>
<span id="cb948-106"><a href="aplikace3.html#cb948-106" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb948-107"><a href="aplikace3.html#cb948-107" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb948-108"><a href="aplikace3.html#cb948-108" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb948-109"><a href="aplikace3.html#cb948-109" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb948-110"><a href="aplikace3.html#cb948-110" tabindex="-1"></a>      </span>
<span id="cb948-111"><a href="aplikace3.html#cb948-111" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, gamma, and fold</span></span>
<span id="cb948-112"><a href="aplikace3.html#cb948-112" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb948-113"><a href="aplikace3.html#cb948-113" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb948-114"><a href="aplikace3.html#cb948-114" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb948-115"><a href="aplikace3.html#cb948-115" tabindex="-1"></a>    }</span>
<span id="cb948-116"><a href="aplikace3.html#cb948-116" tabindex="-1"></a>  }</span>
<span id="cb948-117"><a href="aplikace3.html#cb948-117" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of 10-fold CV so that we have one estimate of validation error for one value of the hyperparameter (or one combination of values). At the same time, we will determine the optimal values of the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb949"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb949-1"><a href="aplikace3.html#cb949-1" tabindex="-1"></a><span class="co"># We calculate the average accuracies for individual C across folds</span></span>
<span id="cb949-2"><a href="aplikace3.html#cb949-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb949-3"><a href="aplikace3.html#cb949-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb949-4"><a href="aplikace3.html#cb949-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb949-5"><a href="aplikace3.html#cb949-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb949-6"><a href="aplikace3.html#cb949-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb949-7"><a href="aplikace3.html#cb949-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb949-8"><a href="aplikace3.html#cb949-8" tabindex="-1"></a></span>
<span id="cb949-9"><a href="aplikace3.html#cb949-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb949-10"><a href="aplikace3.html#cb949-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb949-11"><a href="aplikace3.html#cb949-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb949-12"><a href="aplikace3.html#cb949-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb949-13"><a href="aplikace3.html#cb949-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb949-14"><a href="aplikace3.html#cb949-14" tabindex="-1"></a></span>
<span id="cb949-15"><a href="aplikace3.html#cb949-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb949-16"><a href="aplikace3.html#cb949-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb949-17"><a href="aplikace3.html#cb949-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb949-18"><a href="aplikace3.html#cb949-18" tabindex="-1"></a></span>
<span id="cb949-19"><a href="aplikace3.html#cb949-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb949-20"><a href="aplikace3.html#cb949-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb949-21"><a href="aplikace3.html#cb949-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb949-22"><a href="aplikace3.html#cb949-22" tabindex="-1"></a></span>
<span id="cb949-23"><a href="aplikace3.html#cb949-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb949-24"><a href="aplikace3.html#cb949-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb949-25"><a href="aplikace3.html#cb949-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s take a look at how the optimal values turned out. For <em>linear kernel</em>, we have the optimal value <span class="math inline">\(C\)</span> equal to 0.01, for <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 0.01, and for <em>radial kernel</em>, we have two optimal values, for <span class="math inline">\(C\)</span> the optimal value is 1000 and for <span class="math inline">\(\gamma\)</span> it is 0.01. The validation error rates are 0 for linear, 0.0066667 for polynomial, and 0 for radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb950"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb950-1"><a href="aplikace3.html#cb950-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb950-2"><a href="aplikace3.html#cb950-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb950-3"><a href="aplikace3.html#cb950-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb950-4"><a href="aplikace3.html#cb950-4" tabindex="-1"></a></span>
<span id="cb950-5"><a href="aplikace3.html#cb950-5" tabindex="-1"></a><span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb950-6"><a href="aplikace3.html#cb950-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb950-7"><a href="aplikace3.html#cb950-7" tabindex="-1"></a></span>
<span id="cb950-8"><a href="aplikace3.html#cb950-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb950-9"><a href="aplikace3.html#cb950-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb950-10"><a href="aplikace3.html#cb950-10" tabindex="-1"></a><span class="co"># B-spline basis</span></span>
<span id="cb950-11"><a href="aplikace3.html#cb950-11" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb950-12"><a href="aplikace3.html#cb950-12" tabindex="-1"></a></span>
<span id="cb950-13"><a href="aplikace3.html#cb950-13" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb950-14"><a href="aplikace3.html#cb950-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb950-15"><a href="aplikace3.html#cb950-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb950-16"><a href="aplikace3.html#cb950-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb950-17"><a href="aplikace3.html#cb950-17" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb950-18"><a href="aplikace3.html#cb950-18" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb951"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb951-1"><a href="aplikace3.html#cb951-1" tabindex="-1"></a>model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb951-2"><a href="aplikace3.html#cb951-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb951-3"><a href="aplikace3.html#cb951-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb951-4"><a href="aplikace3.html#cb951-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb951-5"><a href="aplikace3.html#cb951-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb951-6"><a href="aplikace3.html#cb951-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb951-7"><a href="aplikace3.html#cb951-7" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb951-8"><a href="aplikace3.html#cb951-8" tabindex="-1"></a></span>
<span id="cb951-9"><a href="aplikace3.html#cb951-9" tabindex="-1"></a>model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb951-10"><a href="aplikace3.html#cb951-10" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb951-11"><a href="aplikace3.html#cb951-11" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb951-12"><a href="aplikace3.html#cb951-12" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb951-13"><a href="aplikace3.html#cb951-13" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb951-14"><a href="aplikace3.html#cb951-14" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb951-15"><a href="aplikace3.html#cb951-15" tabindex="-1"></a>            <span class="at">degree =</span> p.opt,</span>
<span id="cb951-16"><a href="aplikace3.html#cb951-16" tabindex="-1"></a>            <span class="at">coef0 =</span> coef0,</span>
<span id="cb951-17"><a href="aplikace3.html#cb951-17" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb951-18"><a href="aplikace3.html#cb951-18" tabindex="-1"></a></span>
<span id="cb951-19"><a href="aplikace3.html#cb951-19" tabindex="-1"></a>model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb951-20"><a href="aplikace3.html#cb951-20" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb951-21"><a href="aplikace3.html#cb951-21" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb951-22"><a href="aplikace3.html#cb951-22" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb951-23"><a href="aplikace3.html#cb951-23" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb951-24"><a href="aplikace3.html#cb951-24" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb951-25"><a href="aplikace3.html#cb951-25" tabindex="-1"></a>            <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb951-26"><a href="aplikace3.html#cb951-26" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb951-27"><a href="aplikace3.html#cb951-27" tabindex="-1"></a></span>
<span id="cb951-28"><a href="aplikace3.html#cb951-28" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb951-29"><a href="aplikace3.html#cb951-29" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb951-30"><a href="aplikace3.html#cb951-30" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-31"><a href="aplikace3.html#cb951-31" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb951-32"><a href="aplikace3.html#cb951-32" tabindex="-1"></a></span>
<span id="cb951-33"><a href="aplikace3.html#cb951-33" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-34"><a href="aplikace3.html#cb951-34" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb951-35"><a href="aplikace3.html#cb951-35" tabindex="-1"></a></span>
<span id="cb951-36"><a href="aplikace3.html#cb951-36" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-37"><a href="aplikace3.html#cb951-37" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb951-38"><a href="aplikace3.html#cb951-38" tabindex="-1"></a>  </span>
<span id="cb951-39"><a href="aplikace3.html#cb951-39" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb951-40"><a href="aplikace3.html#cb951-40" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb951-41"><a href="aplikace3.html#cb951-41" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-42"><a href="aplikace3.html#cb951-42" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb951-43"><a href="aplikace3.html#cb951-43" tabindex="-1"></a></span>
<span id="cb951-44"><a href="aplikace3.html#cb951-44" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-45"><a href="aplikace3.html#cb951-45" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb951-46"><a href="aplikace3.html#cb951-46" tabindex="-1"></a></span>
<span id="cb951-47"><a href="aplikace3.html#cb951-47" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb951-48"><a href="aplikace3.html#cb951-48" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 0 % for the linear kernel, 0 % for the polynomial kernel, and 0 % for the Gaussian kernel. On the test data, the error rate of the method is 3.0769 % for the linear kernel, 0 % for the polynomial kernel, and 4.6154 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb952"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb952-1"><a href="aplikace3.html#cb952-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb952-2"><a href="aplikace3.html#cb952-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb952-3"><a href="aplikace3.html#cb952-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb952-4"><a href="aplikace3.html#cb952-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb952-5"><a href="aplikace3.html#cb952-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb952-6"><a href="aplikace3.html#cb952-6" tabindex="-1"></a></span>
<span id="cb952-7"><a href="aplikace3.html#cb952-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="diskrA3b" class="section level4 hasAnchor" number="6.4.7.2">
<h4><span class="header-section-number">6.4.7.2</span> Discretization of the Interval<a href="aplikace3.html#diskrA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s first apply the Support Vector Machine method directly to discretized data (evaluating the function on a given grid of points over the interval <span class="math inline">\(I = [850, 1050]\)</span>), considering all three aforementioned kernel functions.</p>
<p>Now, in contrast to the approach in previous chapters, let’s estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will treat each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, and we acknowledge that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will explore values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{3}]\)</span>, while for the polynomial kernel, we will fix the hyperparameter <span class="math inline">\(p\)</span> at a value of 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use 10-fold CV to determine the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-3}, 10^{2}]\)</span>. We will set <code>coef0</code> to <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb953"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb953-1"><a href="aplikace3.html#cb953-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb953-2"><a href="aplikace3.html#cb953-2" tabindex="-1"></a></span>
<span id="cb953-3"><a href="aplikace3.html#cb953-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb953-4"><a href="aplikace3.html#cb953-4" tabindex="-1"></a></span>
<span id="cb953-5"><a href="aplikace3.html#cb953-5" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb953-6"><a href="aplikace3.html#cb953-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb953-7"><a href="aplikace3.html#cb953-7" tabindex="-1"></a></span>
<span id="cb953-8"><a href="aplikace3.html#cb953-8" tabindex="-1"></a><span class="co"># Values of gamma to consider</span></span>
<span id="cb953-9"><a href="aplikace3.html#cb953-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">4</span>)</span>
<span id="cb953-10"><a href="aplikace3.html#cb953-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb953-11"><a href="aplikace3.html#cb953-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb953-12"><a href="aplikace3.html#cb953-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb953-13"><a href="aplikace3.html#cb953-13" tabindex="-1"></a></span>
<span id="cb953-14"><a href="aplikace3.html#cb953-14" tabindex="-1"></a><span class="co"># List with three components... array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb953-15"><a href="aplikace3.html#cb953-15" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb953-16"><a href="aplikace3.html#cb953-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for the given</span></span>
<span id="cb953-17"><a href="aplikace3.html#cb953-17" tabindex="-1"></a><span class="co"># Rows will contain values for the given gamma, and layers correspond to folds</span></span>
<span id="cb953-18"><a href="aplikace3.html#cb953-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb953-19"><a href="aplikace3.html#cb953-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb953-20"><a href="aplikace3.html#cb953-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb953-21"><a href="aplikace3.html#cb953-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb953-22"><a href="aplikace3.html#cb953-22" tabindex="-1"></a>)</span>
<span id="cb953-23"><a href="aplikace3.html#cb953-23" tabindex="-1"></a></span>
<span id="cb953-24"><a href="aplikace3.html#cb953-24" tabindex="-1"></a><span class="co"># First, we will go through the values of C</span></span>
<span id="cb953-25"><a href="aplikace3.html#cb953-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb953-26"><a href="aplikace3.html#cb953-26" tabindex="-1"></a>  <span class="co"># Go through individual folds</span></span>
<span id="cb953-27"><a href="aplikace3.html#cb953-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb953-28"><a href="aplikace3.html#cb953-28" tabindex="-1"></a>    <span class="co"># Define test and training portions for CV</span></span>
<span id="cb953-29"><a href="aplikace3.html#cb953-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb953-30"><a href="aplikace3.html#cb953-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb953-31"><a href="aplikace3.html#cb953-31" tabindex="-1"></a>    </span>
<span id="cb953-32"><a href="aplikace3.html#cb953-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb953-33"><a href="aplikace3.html#cb953-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb953-34"><a href="aplikace3.html#cb953-34" tabindex="-1"></a>    </span>
<span id="cb953-35"><a href="aplikace3.html#cb953-35" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb953-36"><a href="aplikace3.html#cb953-36" tabindex="-1"></a>    <span class="co"># Construct the model</span></span>
<span id="cb953-37"><a href="aplikace3.html#cb953-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb953-38"><a href="aplikace3.html#cb953-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb953-39"><a href="aplikace3.html#cb953-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb953-40"><a href="aplikace3.html#cb953-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb953-41"><a href="aplikace3.html#cb953-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb953-42"><a href="aplikace3.html#cb953-42" tabindex="-1"></a>    </span>
<span id="cb953-43"><a href="aplikace3.html#cb953-43" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb953-44"><a href="aplikace3.html#cb953-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb953-45"><a href="aplikace3.html#cb953-45" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb953-46"><a href="aplikace3.html#cb953-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb953-47"><a href="aplikace3.html#cb953-47" tabindex="-1"></a>    </span>
<span id="cb953-48"><a href="aplikace3.html#cb953-48" tabindex="-1"></a>    <span class="co"># Store accuracy at the positions for given C and fold</span></span>
<span id="cb953-49"><a href="aplikace3.html#cb953-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb953-50"><a href="aplikace3.html#cb953-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb953-51"><a href="aplikace3.html#cb953-51" tabindex="-1"></a>    </span>
<span id="cb953-52"><a href="aplikace3.html#cb953-52" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb953-53"><a href="aplikace3.html#cb953-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb953-54"><a href="aplikace3.html#cb953-54" tabindex="-1"></a>      <span class="co"># Construct the model</span></span>
<span id="cb953-55"><a href="aplikace3.html#cb953-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb953-56"><a href="aplikace3.html#cb953-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb953-57"><a href="aplikace3.html#cb953-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb953-58"><a href="aplikace3.html#cb953-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb953-59"><a href="aplikace3.html#cb953-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb953-60"><a href="aplikace3.html#cb953-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb953-61"><a href="aplikace3.html#cb953-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb953-62"><a href="aplikace3.html#cb953-62" tabindex="-1"></a>      </span>
<span id="cb953-63"><a href="aplikace3.html#cb953-63" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb953-64"><a href="aplikace3.html#cb953-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb953-65"><a href="aplikace3.html#cb953-65" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb953-66"><a href="aplikace3.html#cb953-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb953-67"><a href="aplikace3.html#cb953-67" tabindex="-1"></a>      </span>
<span id="cb953-68"><a href="aplikace3.html#cb953-68" tabindex="-1"></a>      <span class="co"># Store accuracy at the positions for given C, p, and fold</span></span>
<span id="cb953-69"><a href="aplikace3.html#cb953-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb953-70"><a href="aplikace3.html#cb953-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb953-71"><a href="aplikace3.html#cb953-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb953-72"><a href="aplikace3.html#cb953-72" tabindex="-1"></a>    }</span>
<span id="cb953-73"><a href="aplikace3.html#cb953-73" tabindex="-1"></a>        </span>
<span id="cb953-74"><a href="aplikace3.html#cb953-74" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb953-75"><a href="aplikace3.html#cb953-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb953-76"><a href="aplikace3.html#cb953-76" tabindex="-1"></a>      <span class="co"># Construct the model</span></span>
<span id="cb953-77"><a href="aplikace3.html#cb953-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb953-78"><a href="aplikace3.html#cb953-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb953-79"><a href="aplikace3.html#cb953-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb953-80"><a href="aplikace3.html#cb953-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb953-81"><a href="aplikace3.html#cb953-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb953-82"><a href="aplikace3.html#cb953-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb953-83"><a href="aplikace3.html#cb953-83" tabindex="-1"></a>      </span>
<span id="cb953-84"><a href="aplikace3.html#cb953-84" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb953-85"><a href="aplikace3.html#cb953-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb953-86"><a href="aplikace3.html#cb953-86" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb953-87"><a href="aplikace3.html#cb953-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb953-88"><a href="aplikace3.html#cb953-88" tabindex="-1"></a>      </span>
<span id="cb953-89"><a href="aplikace3.html#cb953-89" tabindex="-1"></a>      <span class="co"># Store accuracy at the positions for given C, gamma, and fold</span></span>
<span id="cb953-90"><a href="aplikace3.html#cb953-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb953-91"><a href="aplikace3.html#cb953-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb953-92"><a href="aplikace3.html#cb953-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb953-93"><a href="aplikace3.html#cb953-93" tabindex="-1"></a>    }</span>
<span id="cb953-94"><a href="aplikace3.html#cb953-94" tabindex="-1"></a>  }</span>
<span id="cb953-95"><a href="aplikace3.html#cb953-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of 10-fold CV so that we have one estimate of validation error for each hyperparameter value (or combination of values). We will also determine the optimal values for the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb954"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb954-1"><a href="aplikace3.html#cb954-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for individual C across folds</span></span>
<span id="cb954-2"><a href="aplikace3.html#cb954-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb954-3"><a href="aplikace3.html#cb954-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb954-4"><a href="aplikace3.html#cb954-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb954-5"><a href="aplikace3.html#cb954-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb954-6"><a href="aplikace3.html#cb954-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb954-7"><a href="aplikace3.html#cb954-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb954-8"><a href="aplikace3.html#cb954-8" tabindex="-1"></a></span>
<span id="cb954-9"><a href="aplikace3.html#cb954-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb954-10"><a href="aplikace3.html#cb954-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb954-11"><a href="aplikace3.html#cb954-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb954-12"><a href="aplikace3.html#cb954-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb954-13"><a href="aplikace3.html#cb954-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb954-14"><a href="aplikace3.html#cb954-14" tabindex="-1"></a></span>
<span id="cb954-15"><a href="aplikace3.html#cb954-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb954-16"><a href="aplikace3.html#cb954-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb954-17"><a href="aplikace3.html#cb954-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb954-18"><a href="aplikace3.html#cb954-18" tabindex="-1"></a></span>
<span id="cb954-19"><a href="aplikace3.html#cb954-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb954-20"><a href="aplikace3.html#cb954-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb954-21"><a href="aplikace3.html#cb954-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb954-22"><a href="aplikace3.html#cb954-22" tabindex="-1"></a></span>
<span id="cb954-23"><a href="aplikace3.html#cb954-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb954-24"><a href="aplikace3.html#cb954-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb954-25"><a href="aplikace3.html#cb954-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s see how the optimal values turned out. For the <em>linear kernel</em>, we have the optimal value of <span class="math inline">\(C\)</span> equal to 0.001, for the <em>polynomial kernel</em>, <span class="math inline">\(C\)</span> is equal to 0.1, and for the <em>radial kernel</em>, we have two optimal values: the optimal value for <span class="math inline">\(C\)</span> is 10 and for <span class="math inline">\(\gamma\)</span>, it is 0.01. The validation errors are 0.0066667 for linear, 0.0066667 for polynomial, and 0.0066667 for radial kernels.</p>
<p>Finally, we can build the final classifiers on the entire training data with hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb955"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb955-1"><a href="aplikace3.html#cb955-1" tabindex="-1"></a><span class="co"># Building the models</span></span>
<span id="cb955-2"><a href="aplikace3.html#cb955-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb955-3"><a href="aplikace3.html#cb955-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb955-4"><a href="aplikace3.html#cb955-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb955-5"><a href="aplikace3.html#cb955-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb955-6"><a href="aplikace3.html#cb955-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb955-7"><a href="aplikace3.html#cb955-7" tabindex="-1"></a></span>
<span id="cb955-8"><a href="aplikace3.html#cb955-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb955-9"><a href="aplikace3.html#cb955-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb955-10"><a href="aplikace3.html#cb955-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb955-11"><a href="aplikace3.html#cb955-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb955-12"><a href="aplikace3.html#cb955-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb955-13"><a href="aplikace3.html#cb955-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb955-14"><a href="aplikace3.html#cb955-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb955-15"><a href="aplikace3.html#cb955-15" tabindex="-1"></a></span>
<span id="cb955-16"><a href="aplikace3.html#cb955-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb955-17"><a href="aplikace3.html#cb955-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb955-18"><a href="aplikace3.html#cb955-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb955-19"><a href="aplikace3.html#cb955-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb955-20"><a href="aplikace3.html#cb955-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb955-21"><a href="aplikace3.html#cb955-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb955-22"><a href="aplikace3.html#cb955-22" tabindex="-1"></a></span>
<span id="cb955-23"><a href="aplikace3.html#cb955-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb955-24"><a href="aplikace3.html#cb955-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb955-25"><a href="aplikace3.html#cb955-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb955-26"><a href="aplikace3.html#cb955-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb955-27"><a href="aplikace3.html#cb955-27" tabindex="-1"></a></span>
<span id="cb955-28"><a href="aplikace3.html#cb955-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb955-29"><a href="aplikace3.html#cb955-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb955-30"><a href="aplikace3.html#cb955-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb955-31"><a href="aplikace3.html#cb955-31" tabindex="-1"></a></span>
<span id="cb955-32"><a href="aplikace3.html#cb955-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb955-33"><a href="aplikace3.html#cb955-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb955-34"><a href="aplikace3.html#cb955-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb955-35"><a href="aplikace3.html#cb955-35" tabindex="-1"></a></span>
<span id="cb955-36"><a href="aplikace3.html#cb955-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb955-37"><a href="aplikace3.html#cb955-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb955-38"><a href="aplikace3.html#cb955-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb955-39"><a href="aplikace3.html#cb955-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb955-40"><a href="aplikace3.html#cb955-40" tabindex="-1"></a></span>
<span id="cb955-41"><a href="aplikace3.html#cb955-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb955-42"><a href="aplikace3.html#cb955-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb955-43"><a href="aplikace3.html#cb955-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb955-44"><a href="aplikace3.html#cb955-44" tabindex="-1"></a></span>
<span id="cb955-45"><a href="aplikace3.html#cb955-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb955-46"><a href="aplikace3.html#cb955-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb955-47"><a href="aplikace3.html#cb955-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is 0.6667 % for the linear kernel, 0.6667 % for the polynomial kernel, and 0 % for the radial kernel. The error rate on the test data is then 1.5385 % for the linear kernel, 6.1538 % for the polynomial kernel, and 4.6154 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb956"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb956-1"><a href="aplikace3.html#cb956-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb956-2"><a href="aplikace3.html#cb956-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb956-3"><a href="aplikace3.html#cb956-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb956-4"><a href="aplikace3.html#cb956-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb956-5"><a href="aplikace3.html#cb956-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb956-6"><a href="aplikace3.html#cb956-6" tabindex="-1"></a></span>
<span id="cb956-7"><a href="aplikace3.html#cb956-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVMA3b" class="section level4 hasAnchor" number="6.4.7.3">
<h4><span class="header-section-number">6.4.7.3</span> Principal Component Scores<a href="aplikace3.html#PCA-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first <span class="math inline">\(p ={}\)</span> 2 principal components.</p>
<p>Now let’s try to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation, unlike the approach in previous chapters. Since each kernel has different hyperparameters in its definition, we will treat each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, with the assumption that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will iterate over the hyperparameter <span class="math inline">\(C\)</span> values in the interval <span class="math inline">\([10^{-2}, 10^{5}]\)</span>, while for the polynomial kernel, we will fix the hyperparameter <span class="math inline">\(p\)</span> at the value of 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-2}, 10^{2}]\)</span>. We will set <code>coef0</code> to <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb957"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb957-1"><a href="aplikace3.html#cb957-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb957-2"><a href="aplikace3.html#cb957-2" tabindex="-1"></a></span>
<span id="cb957-3"><a href="aplikace3.html#cb957-3" tabindex="-1"></a><span class="co"># Which gamma values do we want to consider</span></span>
<span id="cb957-4"><a href="aplikace3.html#cb957-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb957-5"><a href="aplikace3.html#cb957-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">8</span>)</span>
<span id="cb957-6"><a href="aplikace3.html#cb957-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb957-7"><a href="aplikace3.html#cb957-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb957-8"><a href="aplikace3.html#cb957-8" tabindex="-1"></a></span>
<span id="cb957-9"><a href="aplikace3.html#cb957-9" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb957-10"><a href="aplikace3.html#cb957-10" tabindex="-1"></a><span class="co"># Empty matrix where we will insert individual results</span></span>
<span id="cb957-11"><a href="aplikace3.html#cb957-11" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given C</span></span>
<span id="cb957-12"><a href="aplikace3.html#cb957-12" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb957-13"><a href="aplikace3.html#cb957-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb957-14"><a href="aplikace3.html#cb957-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb957-15"><a href="aplikace3.html#cb957-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb957-16"><a href="aplikace3.html#cb957-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb957-17"><a href="aplikace3.html#cb957-17" tabindex="-1"></a>)</span>
<span id="cb957-18"><a href="aplikace3.html#cb957-18" tabindex="-1"></a></span>
<span id="cb957-19"><a href="aplikace3.html#cb957-19" tabindex="-1"></a><span class="co"># First, we will iterate over values of C</span></span>
<span id="cb957-20"><a href="aplikace3.html#cb957-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb957-21"><a href="aplikace3.html#cb957-21" tabindex="-1"></a>  <span class="co"># Iterate over individual folds</span></span>
<span id="cb957-22"><a href="aplikace3.html#cb957-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb957-23"><a href="aplikace3.html#cb957-23" tabindex="-1"></a>    <span class="co"># Definition of the test and training parts for CV</span></span>
<span id="cb957-24"><a href="aplikace3.html#cb957-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb957-25"><a href="aplikace3.html#cb957-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb957-26"><a href="aplikace3.html#cb957-26" tabindex="-1"></a>    </span>
<span id="cb957-27"><a href="aplikace3.html#cb957-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb957-28"><a href="aplikace3.html#cb957-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb957-29"><a href="aplikace3.html#cb957-29" tabindex="-1"></a>    </span>
<span id="cb957-30"><a href="aplikace3.html#cb957-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb957-31"><a href="aplikace3.html#cb957-31" tabindex="-1"></a>    <span class="co"># Building the model</span></span>
<span id="cb957-32"><a href="aplikace3.html#cb957-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb957-33"><a href="aplikace3.html#cb957-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb957-34"><a href="aplikace3.html#cb957-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb957-35"><a href="aplikace3.html#cb957-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb957-36"><a href="aplikace3.html#cb957-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb957-37"><a href="aplikace3.html#cb957-37" tabindex="-1"></a>    </span>
<span id="cb957-38"><a href="aplikace3.html#cb957-38" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb957-39"><a href="aplikace3.html#cb957-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb957-40"><a href="aplikace3.html#cb957-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb957-41"><a href="aplikace3.html#cb957-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb957-42"><a href="aplikace3.html#cb957-42" tabindex="-1"></a>    </span>
<span id="cb957-43"><a href="aplikace3.html#cb957-43" tabindex="-1"></a>    <span class="co"># Insert accuracies into positions for given C and fold</span></span>
<span id="cb957-44"><a href="aplikace3.html#cb957-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb957-45"><a href="aplikace3.html#cb957-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb957-46"><a href="aplikace3.html#cb957-46" tabindex="-1"></a>    </span>
<span id="cb957-47"><a href="aplikace3.html#cb957-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb957-48"><a href="aplikace3.html#cb957-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb957-49"><a href="aplikace3.html#cb957-49" tabindex="-1"></a>      <span class="co"># Building the model</span></span>
<span id="cb957-50"><a href="aplikace3.html#cb957-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb957-51"><a href="aplikace3.html#cb957-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb957-52"><a href="aplikace3.html#cb957-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb957-53"><a href="aplikace3.html#cb957-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb957-54"><a href="aplikace3.html#cb957-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb957-55"><a href="aplikace3.html#cb957-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb957-56"><a href="aplikace3.html#cb957-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb957-57"><a href="aplikace3.html#cb957-57" tabindex="-1"></a>      </span>
<span id="cb957-58"><a href="aplikace3.html#cb957-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb957-59"><a href="aplikace3.html#cb957-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb957-60"><a href="aplikace3.html#cb957-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb957-61"><a href="aplikace3.html#cb957-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb957-62"><a href="aplikace3.html#cb957-62" tabindex="-1"></a>      </span>
<span id="cb957-63"><a href="aplikace3.html#cb957-63" tabindex="-1"></a>      <span class="co"># Insert accuracies into positions for given C, p, and fold</span></span>
<span id="cb957-64"><a href="aplikace3.html#cb957-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb957-65"><a href="aplikace3.html#cb957-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb957-66"><a href="aplikace3.html#cb957-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb957-67"><a href="aplikace3.html#cb957-67" tabindex="-1"></a>    }</span>
<span id="cb957-68"><a href="aplikace3.html#cb957-68" tabindex="-1"></a>        </span>
<span id="cb957-69"><a href="aplikace3.html#cb957-69" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb957-70"><a href="aplikace3.html#cb957-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb957-71"><a href="aplikace3.html#cb957-71" tabindex="-1"></a>      <span class="co"># Building the model</span></span>
<span id="cb957-72"><a href="aplikace3.html#cb957-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb957-73"><a href="aplikace3.html#cb957-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb957-74"><a href="aplikace3.html#cb957-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb957-75"><a href="aplikace3.html#cb957-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb957-76"><a href="aplikace3.html#cb957-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb957-77"><a href="aplikace3.html#cb957-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb957-78"><a href="aplikace3.html#cb957-78" tabindex="-1"></a>      </span>
<span id="cb957-79"><a href="aplikace3.html#cb957-79" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb957-80"><a href="aplikace3.html#cb957-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb957-81"><a href="aplikace3.html#cb957-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb957-82"><a href="aplikace3.html#cb957-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb957-83"><a href="aplikace3.html#cb957-83" tabindex="-1"></a>      </span>
<span id="cb957-84"><a href="aplikace3.html#cb957-84" tabindex="-1"></a>      <span class="co"># Insert accuracies into positions for given C, gamma, and fold</span></span>
<span id="cb957-85"><a href="aplikace3.html#cb957-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb957-86"><a href="aplikace3.html#cb957-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb957-87"><a href="aplikace3.html#cb957-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb957-88"><a href="aplikace3.html#cb957-88" tabindex="-1"></a>    }</span>
<span id="cb957-89"><a href="aplikace3.html#cb957-89" tabindex="-1"></a>  }</span>
<span id="cb957-90"><a href="aplikace3.html#cb957-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results of the 10-fold CV so that we have one estimate of validation error for each hyperparameter value (or combination of values). We will also determine the optimal values for each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb958"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb958-1"><a href="aplikace3.html#cb958-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for individual C across folds</span></span>
<span id="cb958-2"><a href="aplikace3.html#cb958-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb958-3"><a href="aplikace3.html#cb958-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb958-4"><a href="aplikace3.html#cb958-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb958-5"><a href="aplikace3.html#cb958-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb958-6"><a href="aplikace3.html#cb958-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb958-7"><a href="aplikace3.html#cb958-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb958-8"><a href="aplikace3.html#cb958-8" tabindex="-1"></a></span>
<span id="cb958-9"><a href="aplikace3.html#cb958-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb958-10"><a href="aplikace3.html#cb958-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb958-11"><a href="aplikace3.html#cb958-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb958-12"><a href="aplikace3.html#cb958-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb958-13"><a href="aplikace3.html#cb958-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb958-14"><a href="aplikace3.html#cb958-14" tabindex="-1"></a></span>
<span id="cb958-15"><a href="aplikace3.html#cb958-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb958-16"><a href="aplikace3.html#cb958-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb958-17"><a href="aplikace3.html#cb958-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb958-18"><a href="aplikace3.html#cb958-18" tabindex="-1"></a></span>
<span id="cb958-19"><a href="aplikace3.html#cb958-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb958-20"><a href="aplikace3.html#cb958-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb958-21"><a href="aplikace3.html#cb958-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb958-22"><a href="aplikace3.html#cb958-22" tabindex="-1"></a></span>
<span id="cb958-23"><a href="aplikace3.html#cb958-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb958-24"><a href="aplikace3.html#cb958-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb958-25"><a href="aplikace3.html#cb958-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s take a look at the optimal values. For the <em>linear kernel</em>, we have the optimal value of <span class="math inline">\(C\)</span> equal to 10, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 1, and for the <em>radial kernel</em>, we have two optimal values: for <span class="math inline">\(C\)</span>, the optimal value is 100 and for <span class="math inline">\(\gamma\)</span>, it is 1. The validation errors are respectively 0.0066667 for linear, 0.0066667 for polynomial, and 0.0066667 for radial kernels.</p>
<p>Finally, we can build the final classifiers on the entire training dataset with the hyperparameter values determined by the 10-fold CV. We will also compute the errors on the test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb959"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb959-1"><a href="aplikace3.html#cb959-1" tabindex="-1"></a><span class="co"># Build models</span></span>
<span id="cb959-2"><a href="aplikace3.html#cb959-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb959-3"><a href="aplikace3.html#cb959-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb959-4"><a href="aplikace3.html#cb959-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb959-5"><a href="aplikace3.html#cb959-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb959-6"><a href="aplikace3.html#cb959-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb959-7"><a href="aplikace3.html#cb959-7" tabindex="-1"></a></span>
<span id="cb959-8"><a href="aplikace3.html#cb959-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb959-9"><a href="aplikace3.html#cb959-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb959-10"><a href="aplikace3.html#cb959-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb959-11"><a href="aplikace3.html#cb959-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb959-12"><a href="aplikace3.html#cb959-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb959-13"><a href="aplikace3.html#cb959-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb959-14"><a href="aplikace3.html#cb959-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb959-15"><a href="aplikace3.html#cb959-15" tabindex="-1"></a></span>
<span id="cb959-16"><a href="aplikace3.html#cb959-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb959-17"><a href="aplikace3.html#cb959-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb959-18"><a href="aplikace3.html#cb959-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb959-19"><a href="aplikace3.html#cb959-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb959-20"><a href="aplikace3.html#cb959-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb959-21"><a href="aplikace3.html#cb959-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb959-22"><a href="aplikace3.html#cb959-22" tabindex="-1"></a></span>
<span id="cb959-23"><a href="aplikace3.html#cb959-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb959-24"><a href="aplikace3.html#cb959-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb959-25"><a href="aplikace3.html#cb959-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb959-26"><a href="aplikace3.html#cb959-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb959-27"><a href="aplikace3.html#cb959-27" tabindex="-1"></a></span>
<span id="cb959-28"><a href="aplikace3.html#cb959-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb959-29"><a href="aplikace3.html#cb959-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb959-30"><a href="aplikace3.html#cb959-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb959-31"><a href="aplikace3.html#cb959-31" tabindex="-1"></a></span>
<span id="cb959-32"><a href="aplikace3.html#cb959-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb959-33"><a href="aplikace3.html#cb959-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb959-34"><a href="aplikace3.html#cb959-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb959-35"><a href="aplikace3.html#cb959-35" tabindex="-1"></a>  </span>
<span id="cb959-36"><a href="aplikace3.html#cb959-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb959-37"><a href="aplikace3.html#cb959-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb959-38"><a href="aplikace3.html#cb959-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb959-39"><a href="aplikace3.html#cb959-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb959-40"><a href="aplikace3.html#cb959-40" tabindex="-1"></a></span>
<span id="cb959-41"><a href="aplikace3.html#cb959-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb959-42"><a href="aplikace3.html#cb959-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb959-43"><a href="aplikace3.html#cb959-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb959-44"><a href="aplikace3.html#cb959-44" tabindex="-1"></a></span>
<span id="cb959-45"><a href="aplikace3.html#cb959-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb959-46"><a href="aplikace3.html#cb959-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb959-47"><a href="aplikace3.html#cb959-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the principal component scores on the training data is thus 0.67 % for the linear kernel, 0.67 % for the polynomial kernel, and 0.67 % for the Gaussian kernel. On the test data, the error rate of the method is 3.0769 % for the linear kernel, 3.0769 % for the polynomial kernel, and 1.5385 % for the radial kernel.</p>
<p>For a graphical representation of the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, as we did in previous cases where we also plotted the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb960"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb960-1"><a href="aplikace3.html#cb960-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb960-2"><a href="aplikace3.html#cb960-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb960-3"><a href="aplikace3.html#cb960-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb960-4"><a href="aplikace3.html#cb960-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb960-5"><a href="aplikace3.html#cb960-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb960-6"><a href="aplikace3.html#cb960-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb960-7"><a href="aplikace3.html#cb960-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb960-8"><a href="aplikace3.html#cb960-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb960-9"><a href="aplikace3.html#cb960-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb960-10"><a href="aplikace3.html#cb960-10" tabindex="-1"></a></span>
<span id="cb960-11"><a href="aplikace3.html#cb960-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb960-12"><a href="aplikace3.html#cb960-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb960-13"><a href="aplikace3.html#cb960-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variance&#39;</span>, </span>
<span id="cb960-14"><a href="aplikace3.html#cb960-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb960-15"><a href="aplikace3.html#cb960-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb960-16"><a href="aplikace3.html#cb960-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb960-17"><a href="aplikace3.html#cb960-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>, </span>
<span id="cb960-18"><a href="aplikace3.html#cb960-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span></span>
<span id="cb960-19"><a href="aplikace3.html#cb960-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;small&quot;</span>, <span class="st">&quot;large&quot;</span>)) <span class="sc">+</span></span>
<span id="cb960-20"><a href="aplikace3.html#cb960-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb960-21"><a href="aplikace3.html#cb960-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb960-22"><a href="aplikace3.html#cb960-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-195"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-195-1.png" alt="Scores of the first two principal components, colored according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is indicated in black." width="672" />
<p class="caption">
Figure 5.33: Scores of the first two principal components, colored according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is indicated in black.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb961"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb961-1"><a href="aplikace3.html#cb961-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb961-2"><a href="aplikace3.html#cb961-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb961-3"><a href="aplikace3.html#cb961-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb961-4"><a href="aplikace3.html#cb961-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb961-5"><a href="aplikace3.html#cb961-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb961-6"><a href="aplikace3.html#cb961-6" tabindex="-1"></a></span>
<span id="cb961-7"><a href="aplikace3.html#cb961-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVMA3b" class="section level4 hasAnchor" number="6.4.7.4">
<h4><span class="header-section-number">6.4.7.4</span> Basis Coefficients<a href="aplikace3.html#basis-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use the representation of functions with a B-spline basis. For all three kernels, we will iterate over values of the hyperparameter <span class="math inline">\(C\)</span> in the range <span class="math inline">\([10^{-4}, 10^{2}]\)</span>, while for the polynomial kernel, we will fix the hyperparameter <span class="math inline">\(p\)</span> at the value of 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use <span class="math inline">\(k_{cv}\)</span>-fold cross-validation to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the range <span class="math inline">\([10^{-4}, 10^{0}]\)</span>. We will set <code>coef0 = 1</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb962"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb962-1"><a href="aplikace3.html#cb962-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb962-2"><a href="aplikace3.html#cb962-2" tabindex="-1"></a></span>
<span id="cb962-3"><a href="aplikace3.html#cb962-3" tabindex="-1"></a><span class="co"># Values of gamma to consider</span></span>
<span id="cb962-4"><a href="aplikace3.html#cb962-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb962-5"><a href="aplikace3.html#cb962-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb962-6"><a href="aplikace3.html#cb962-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb962-7"><a href="aplikace3.html#cb962-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb962-8"><a href="aplikace3.html#cb962-8" tabindex="-1"></a></span>
<span id="cb962-9"><a href="aplikace3.html#cb962-9" tabindex="-1"></a><span class="co"># List with three components ... arrays for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb962-10"><a href="aplikace3.html#cb962-10" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb962-11"><a href="aplikace3.html#cb962-11" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given parameters</span></span>
<span id="cb962-12"><a href="aplikace3.html#cb962-12" tabindex="-1"></a><span class="co"># Rows will correspond to gamma values and layers will correspond to folds</span></span>
<span id="cb962-13"><a href="aplikace3.html#cb962-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb962-14"><a href="aplikace3.html#cb962-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb962-15"><a href="aplikace3.html#cb962-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb962-16"><a href="aplikace3.html#cb962-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb962-17"><a href="aplikace3.html#cb962-17" tabindex="-1"></a>)</span>
<span id="cb962-18"><a href="aplikace3.html#cb962-18" tabindex="-1"></a></span>
<span id="cb962-19"><a href="aplikace3.html#cb962-19" tabindex="-1"></a><span class="co"># First, iterate over values of C</span></span>
<span id="cb962-20"><a href="aplikace3.html#cb962-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb962-21"><a href="aplikace3.html#cb962-21" tabindex="-1"></a>  <span class="co"># Iterate over each fold</span></span>
<span id="cb962-22"><a href="aplikace3.html#cb962-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb962-23"><a href="aplikace3.html#cb962-23" tabindex="-1"></a>    <span class="co"># Define test and training sets for CV</span></span>
<span id="cb962-24"><a href="aplikace3.html#cb962-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb962-25"><a href="aplikace3.html#cb962-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb962-26"><a href="aplikace3.html#cb962-26" tabindex="-1"></a>    </span>
<span id="cb962-27"><a href="aplikace3.html#cb962-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb962-28"><a href="aplikace3.html#cb962-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb962-29"><a href="aplikace3.html#cb962-29" tabindex="-1"></a>    </span>
<span id="cb962-30"><a href="aplikace3.html#cb962-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb962-31"><a href="aplikace3.html#cb962-31" tabindex="-1"></a>    <span class="co"># Build the model</span></span>
<span id="cb962-32"><a href="aplikace3.html#cb962-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb962-33"><a href="aplikace3.html#cb962-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb962-34"><a href="aplikace3.html#cb962-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb962-35"><a href="aplikace3.html#cb962-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb962-36"><a href="aplikace3.html#cb962-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb962-37"><a href="aplikace3.html#cb962-37" tabindex="-1"></a>    </span>
<span id="cb962-38"><a href="aplikace3.html#cb962-38" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb962-39"><a href="aplikace3.html#cb962-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb962-40"><a href="aplikace3.html#cb962-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb962-41"><a href="aplikace3.html#cb962-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb962-42"><a href="aplikace3.html#cb962-42" tabindex="-1"></a>    </span>
<span id="cb962-43"><a href="aplikace3.html#cb962-43" tabindex="-1"></a>    <span class="co"># Store accuracy for the given C and fold</span></span>
<span id="cb962-44"><a href="aplikace3.html#cb962-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb962-45"><a href="aplikace3.html#cb962-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb962-46"><a href="aplikace3.html#cb962-46" tabindex="-1"></a>    </span>
<span id="cb962-47"><a href="aplikace3.html#cb962-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb962-48"><a href="aplikace3.html#cb962-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb962-49"><a href="aplikace3.html#cb962-49" tabindex="-1"></a>      <span class="co"># Build the model</span></span>
<span id="cb962-50"><a href="aplikace3.html#cb962-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb962-51"><a href="aplikace3.html#cb962-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb962-52"><a href="aplikace3.html#cb962-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb962-53"><a href="aplikace3.html#cb962-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb962-54"><a href="aplikace3.html#cb962-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb962-55"><a href="aplikace3.html#cb962-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb962-56"><a href="aplikace3.html#cb962-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb962-57"><a href="aplikace3.html#cb962-57" tabindex="-1"></a>      </span>
<span id="cb962-58"><a href="aplikace3.html#cb962-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb962-59"><a href="aplikace3.html#cb962-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb962-60"><a href="aplikace3.html#cb962-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb962-61"><a href="aplikace3.html#cb962-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb962-62"><a href="aplikace3.html#cb962-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb962-63"><a href="aplikace3.html#cb962-63" tabindex="-1"></a>      </span>
<span id="cb962-64"><a href="aplikace3.html#cb962-64" tabindex="-1"></a>      <span class="co"># Store accuracy for the given C, p, and fold</span></span>
<span id="cb962-65"><a href="aplikace3.html#cb962-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb962-66"><a href="aplikace3.html#cb962-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb962-67"><a href="aplikace3.html#cb962-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb962-68"><a href="aplikace3.html#cb962-68" tabindex="-1"></a>    }</span>
<span id="cb962-69"><a href="aplikace3.html#cb962-69" tabindex="-1"></a>        </span>
<span id="cb962-70"><a href="aplikace3.html#cb962-70" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb962-71"><a href="aplikace3.html#cb962-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb962-72"><a href="aplikace3.html#cb962-72" tabindex="-1"></a>      <span class="co"># Build the model</span></span>
<span id="cb962-73"><a href="aplikace3.html#cb962-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb962-74"><a href="aplikace3.html#cb962-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb962-75"><a href="aplikace3.html#cb962-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb962-76"><a href="aplikace3.html#cb962-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb962-77"><a href="aplikace3.html#cb962-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb962-78"><a href="aplikace3.html#cb962-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb962-79"><a href="aplikace3.html#cb962-79" tabindex="-1"></a>      </span>
<span id="cb962-80"><a href="aplikace3.html#cb962-80" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb962-81"><a href="aplikace3.html#cb962-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb962-82"><a href="aplikace3.html#cb962-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb962-83"><a href="aplikace3.html#cb962-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb962-84"><a href="aplikace3.html#cb962-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb962-85"><a href="aplikace3.html#cb962-85" tabindex="-1"></a>      </span>
<span id="cb962-86"><a href="aplikace3.html#cb962-86" tabindex="-1"></a>      <span class="co"># Store accuracy for the given C, gamma, and fold</span></span>
<span id="cb962-87"><a href="aplikace3.html#cb962-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb962-88"><a href="aplikace3.html#cb962-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb962-89"><a href="aplikace3.html#cb962-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb962-90"><a href="aplikace3.html#cb962-90" tabindex="-1"></a>    }</span>
<span id="cb962-91"><a href="aplikace3.html#cb962-91" tabindex="-1"></a>  }</span>
<span id="cb962-92"><a href="aplikace3.html#cb962-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now, let’s average the results from <span class="math inline">\(k_{cv}\)</span>-fold cross-validation so that we have one estimate of the validation error for each hyperparameter value (or combination of values). At the same time, we will determine the optimal values for each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb963"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb963-1"><a href="aplikace3.html#cb963-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for individual C across folds</span></span>
<span id="cb963-2"><a href="aplikace3.html#cb963-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb963-3"><a href="aplikace3.html#cb963-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb963-4"><a href="aplikace3.html#cb963-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb963-5"><a href="aplikace3.html#cb963-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb963-6"><a href="aplikace3.html#cb963-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb963-7"><a href="aplikace3.html#cb963-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb963-8"><a href="aplikace3.html#cb963-8" tabindex="-1"></a></span>
<span id="cb963-9"><a href="aplikace3.html#cb963-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb963-10"><a href="aplikace3.html#cb963-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb963-11"><a href="aplikace3.html#cb963-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb963-12"><a href="aplikace3.html#cb963-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb963-13"><a href="aplikace3.html#cb963-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb963-14"><a href="aplikace3.html#cb963-14" tabindex="-1"></a></span>
<span id="cb963-15"><a href="aplikace3.html#cb963-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb963-16"><a href="aplikace3.html#cb963-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb963-17"><a href="aplikace3.html#cb963-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb963-18"><a href="aplikace3.html#cb963-18" tabindex="-1"></a></span>
<span id="cb963-19"><a href="aplikace3.html#cb963-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb963-20"><a href="aplikace3.html#cb963-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb963-21"><a href="aplikace3.html#cb963-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb963-22"><a href="aplikace3.html#cb963-22" tabindex="-1"></a></span>
<span id="cb963-23"><a href="aplikace3.html#cb963-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb963-24"><a href="aplikace3.html#cb963-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb963-25"><a href="aplikace3.html#cb963-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s see how the optimal values turned out. For the <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 0.01, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is 0.1, and for the <em>radial kernel</em> we have two optimal values: the optimal value for <span class="math inline">\(C\)</span> is 100 and for <span class="math inline">\(\gamma\)</span> it is 0.01. The validation errors are 0.0066667 for linear, 0.0133333 for polynomial, and 0.0066667 for radial kernels.</p>
<p>Finally, we can build the final classifiers on the entire training data using the hyperparameter values determined by <span class="math inline">\(k_{cv}\)</span>-fold cross-validation. We will also determine the errors on the test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb964"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb964-1"><a href="aplikace3.html#cb964-1" tabindex="-1"></a><span class="co"># Build the models</span></span>
<span id="cb964-2"><a href="aplikace3.html#cb964-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb964-3"><a href="aplikace3.html#cb964-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb964-4"><a href="aplikace3.html#cb964-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb964-5"><a href="aplikace3.html#cb964-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb964-6"><a href="aplikace3.html#cb964-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb964-7"><a href="aplikace3.html#cb964-7" tabindex="-1"></a></span>
<span id="cb964-8"><a href="aplikace3.html#cb964-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb964-9"><a href="aplikace3.html#cb964-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb964-10"><a href="aplikace3.html#cb964-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb964-11"><a href="aplikace3.html#cb964-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb964-12"><a href="aplikace3.html#cb964-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb964-13"><a href="aplikace3.html#cb964-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb964-14"><a href="aplikace3.html#cb964-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb964-15"><a href="aplikace3.html#cb964-15" tabindex="-1"></a></span>
<span id="cb964-16"><a href="aplikace3.html#cb964-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb964-17"><a href="aplikace3.html#cb964-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb964-18"><a href="aplikace3.html#cb964-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb964-19"><a href="aplikace3.html#cb964-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb964-20"><a href="aplikace3.html#cb964-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb964-21"><a href="aplikace3.html#cb964-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb964-22"><a href="aplikace3.html#cb964-22" tabindex="-1"></a></span>
<span id="cb964-23"><a href="aplikace3.html#cb964-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb964-24"><a href="aplikace3.html#cb964-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb964-25"><a href="aplikace3.html#cb964-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb964-26"><a href="aplikace3.html#cb964-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb964-27"><a href="aplikace3.html#cb964-27" tabindex="-1"></a></span>
<span id="cb964-28"><a href="aplikace3.html#cb964-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb964-29"><a href="aplikace3.html#cb964-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb964-30"><a href="aplikace3.html#cb964-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb964-31"><a href="aplikace3.html#cb964-31" tabindex="-1"></a></span>
<span id="cb964-32"><a href="aplikace3.html#cb964-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb964-33"><a href="aplikace3.html#cb964-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb964-34"><a href="aplikace3.html#cb964-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb964-35"><a href="aplikace3.html#cb964-35" tabindex="-1"></a>  </span>
<span id="cb964-36"><a href="aplikace3.html#cb964-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb964-37"><a href="aplikace3.html#cb964-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb964-38"><a href="aplikace3.html#cb964-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb964-39"><a href="aplikace3.html#cb964-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb964-40"><a href="aplikace3.html#cb964-40" tabindex="-1"></a></span>
<span id="cb964-41"><a href="aplikace3.html#cb964-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb964-42"><a href="aplikace3.html#cb964-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb964-43"><a href="aplikace3.html#cb964-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb964-44"><a href="aplikace3.html#cb964-44" tabindex="-1"></a></span>
<span id="cb964-45"><a href="aplikace3.html#cb964-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb964-46"><a href="aplikace3.html#cb964-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb964-47"><a href="aplikace3.html#cb964-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error of the SVM method applied to the basis coefficients on the training data is 0.67 % for the linear kernel, 0.67 % for the polynomial kernel, and 0 % for the radial kernel. On the test data, the error of the method is 7.6923 % for the linear kernel, 7.6923 % for the polynomial kernel, and 6.1538 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb965"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb965-1"><a href="aplikace3.html#cb965-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb965-2"><a href="aplikace3.html#cb965-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb965-3"><a href="aplikace3.html#cb965-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb965-4"><a href="aplikace3.html#cb965-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb965-5"><a href="aplikace3.html#cb965-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb965-6"><a href="aplikace3.html#cb965-6" tabindex="-1"></a></span>
<span id="cb965-7"><a href="aplikace3.html#cb965-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVMA3b" class="section level4 hasAnchor" number="6.4.7.5">
<h4><span class="header-section-number">6.4.7.5</span> Projection onto B-spline Basis<a href="aplikace3.html#projection-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another option for applying the classical SVM method to functional data is to project the original data onto a <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal H\)</span>, denoted as <span class="math inline">\(V_d\)</span>.
Assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>.
We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, which can be expressed as</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Now, we can use the coefficients from the orthogonal projection for classification, applying standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>.
By utilizing this transformation, we have defined a new, so-called adapted kernel, which consists of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector method.
Thus, we have (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>.
This is a method of dimension reduction, which we can refer to as <em>filtering</em>.</p>
<p>For the projection itself, we will use the <code>project.basis()</code> function from the <code>fda</code> library in <code>R</code>.
Its input will be a matrix of original discrete (unsmoothed) data, the values in which we measure the values in the original data matrix, and the basis object onto which we want to project the data.
We will choose projection onto a B-spline basis because the use of Fourier basis is not suitable for our non-periodic data.</p>
<p>The dimension <span class="math inline">\(d\)</span> is chosen either from some prior expert knowledge or using cross-validation.
In our case, we will determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (choosing <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method; often, <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span> is chosen).
We require B-splines of order 4; for the number of basis functions, the relationship is given by</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>.
In <code>R</code>, however, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and for large values of <span class="math inline">\(n_{basis}\)</span>, overfitting of the model occurs, so we will choose a maximum of <span class="math inline">\(n_{basis}\)</span> to be a smaller number, say 20.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb966"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb966-1"><a href="aplikace3.html#cb966-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb966-2"><a href="aplikace3.html#cb966-2" tabindex="-1"></a></span>
<span id="cb966-3"><a href="aplikace3.html#cb966-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb966-4"><a href="aplikace3.html#cb966-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb966-5"><a href="aplikace3.html#cb966-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb966-6"><a href="aplikace3.html#cb966-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb966-7"><a href="aplikace3.html#cb966-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb966-8"><a href="aplikace3.html#cb966-8" tabindex="-1"></a></span>
<span id="cb966-9"><a href="aplikace3.html#cb966-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># all dimensions we want to try</span></span>
<span id="cb966-10"><a href="aplikace3.html#cb966-10" tabindex="-1"></a></span>
<span id="cb966-11"><a href="aplikace3.html#cb966-11" tabindex="-1"></a><span class="co"># Divide training data into k parts</span></span>
<span id="cb966-12"><a href="aplikace3.html#cb966-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb966-13"><a href="aplikace3.html#cb966-13" tabindex="-1"></a></span>
<span id="cb966-14"><a href="aplikace3.html#cb966-14" tabindex="-1"></a><span class="co"># List with three components... matrices for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb966-15"><a href="aplikace3.html#cb966-15" tabindex="-1"></a><span class="co"># Empty matrix to insert individual results</span></span>
<span id="cb966-16"><a href="aplikace3.html#cb966-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for each part of the training set</span></span>
<span id="cb966-17"><a href="aplikace3.html#cb966-17" tabindex="-1"></a><span class="co"># Rows will contain values for each dimension value</span></span>
<span id="cb966-18"><a href="aplikace3.html#cb966-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb966-19"><a href="aplikace3.html#cb966-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb966-20"><a href="aplikace3.html#cb966-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb966-21"><a href="aplikace3.html#cb966-21" tabindex="-1"></a></span>
<span id="cb966-22"><a href="aplikace3.html#cb966-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb966-23"><a href="aplikace3.html#cb966-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb966-24"><a href="aplikace3.html#cb966-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb966-25"><a href="aplikace3.html#cb966-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb966-26"><a href="aplikace3.html#cb966-26" tabindex="-1"></a>  </span>
<span id="cb966-27"><a href="aplikace3.html#cb966-27" tabindex="-1"></a>  <span class="co"># Project discrete data onto B-spline basis of dimension d</span></span>
<span id="cb966-28"><a href="aplikace3.html#cb966-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb966-29"><a href="aplikace3.html#cb966-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb966-30"><a href="aplikace3.html#cb966-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb966-31"><a href="aplikace3.html#cb966-31" tabindex="-1"></a>  </span>
<span id="cb966-32"><a href="aplikace3.html#cb966-32" tabindex="-1"></a>  <span class="co"># Split into training and testing data within CV</span></span>
<span id="cb966-33"><a href="aplikace3.html#cb966-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb966-34"><a href="aplikace3.html#cb966-34" tabindex="-1"></a>  </span>
<span id="cb966-35"><a href="aplikace3.html#cb966-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb966-36"><a href="aplikace3.html#cb966-36" tabindex="-1"></a>    <span class="co"># Define testing and training parts for CV</span></span>
<span id="cb966-37"><a href="aplikace3.html#cb966-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb966-38"><a href="aplikace3.html#cb966-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb966-39"><a href="aplikace3.html#cb966-39" tabindex="-1"></a>    </span>
<span id="cb966-40"><a href="aplikace3.html#cb966-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb966-41"><a href="aplikace3.html#cb966-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb966-42"><a href="aplikace3.html#cb966-42" tabindex="-1"></a>    </span>
<span id="cb966-43"><a href="aplikace3.html#cb966-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb966-44"><a href="aplikace3.html#cb966-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb966-45"><a href="aplikace3.html#cb966-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb966-46"><a href="aplikace3.html#cb966-46" tabindex="-1"></a>  </span>
<span id="cb966-47"><a href="aplikace3.html#cb966-47" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb966-48"><a href="aplikace3.html#cb966-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb966-49"><a href="aplikace3.html#cb966-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb966-50"><a href="aplikace3.html#cb966-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb966-51"><a href="aplikace3.html#cb966-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb966-52"><a href="aplikace3.html#cb966-52" tabindex="-1"></a>    </span>
<span id="cb966-53"><a href="aplikace3.html#cb966-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb966-54"><a href="aplikace3.html#cb966-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb966-55"><a href="aplikace3.html#cb966-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb966-56"><a href="aplikace3.html#cb966-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb966-57"><a href="aplikace3.html#cb966-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb966-58"><a href="aplikace3.html#cb966-58" tabindex="-1"></a>    </span>
<span id="cb966-59"><a href="aplikace3.html#cb966-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb966-60"><a href="aplikace3.html#cb966-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb966-61"><a href="aplikace3.html#cb966-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb966-62"><a href="aplikace3.html#cb966-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb966-63"><a href="aplikace3.html#cb966-63" tabindex="-1"></a>      </span>
<span id="cb966-64"><a href="aplikace3.html#cb966-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb966-65"><a href="aplikace3.html#cb966-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb966-66"><a href="aplikace3.html#cb966-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb966-67"><a href="aplikace3.html#cb966-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb966-68"><a href="aplikace3.html#cb966-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb966-69"><a href="aplikace3.html#cb966-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb966-70"><a href="aplikace3.html#cb966-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb966-71"><a href="aplikace3.html#cb966-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb966-72"><a href="aplikace3.html#cb966-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb966-73"><a href="aplikace3.html#cb966-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb966-74"><a href="aplikace3.html#cb966-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb966-75"><a href="aplikace3.html#cb966-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb966-76"><a href="aplikace3.html#cb966-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb966-77"><a href="aplikace3.html#cb966-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb966-78"><a href="aplikace3.html#cb966-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb966-79"><a href="aplikace3.html#cb966-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb966-80"><a href="aplikace3.html#cb966-80" tabindex="-1"></a>    </span>
<span id="cb966-81"><a href="aplikace3.html#cb966-81" tabindex="-1"></a>    <span class="co"># Insert accuracies into positions for given d and fold</span></span>
<span id="cb966-82"><a href="aplikace3.html#cb966-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb966-83"><a href="aplikace3.html#cb966-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb966-84"><a href="aplikace3.html#cb966-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb966-85"><a href="aplikace3.html#cb966-85" tabindex="-1"></a>  }</span>
<span id="cb966-86"><a href="aplikace3.html#cb966-86" tabindex="-1"></a>}</span>
<span id="cb966-87"><a href="aplikace3.html#cb966-87" tabindex="-1"></a>  </span>
<span id="cb966-88"><a href="aplikace3.html#cb966-88" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb966-89"><a href="aplikace3.html#cb966-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb966-90"><a href="aplikace3.html#cb966-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb966-91"><a href="aplikace3.html#cb966-91" tabindex="-1"></a>}</span>
<span id="cb966-92"><a href="aplikace3.html#cb966-92" tabindex="-1"></a></span>
<span id="cb966-93"><a href="aplikace3.html#cb966-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb966-94"><a href="aplikace3.html#cb966-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb966-95"><a href="aplikace3.html#cb966-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb966-96"><a href="aplikace3.html#cb966-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb966-97"><a href="aplikace3.html#cb966-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb966-98"><a href="aplikace3.html#cb966-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb966-99"><a href="aplikace3.html#cb966-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb966-100"><a href="aplikace3.html#cb966-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear     9 0.01958333
## poly       7 0.03297619
## radial     6 0.14125000</code></pre>
<p>We see that the optimal value of the parameter <span class="math inline">\(d\)</span> is 9 for the linear kernel, with an error rate calculated using 10-fold CV of 0.0196, 7 for the polynomial kernel with an error rate of 0.033, and 6 for the radial kernel with an error rate of 0.1412.</p>
<p>To clarify, let’s plot the validation error rates as a function of the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb968"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb968-1"><a href="aplikace3.html#cb968-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb968-2"><a href="aplikace3.html#cb968-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb968-3"><a href="aplikace3.html#cb968-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb968-4"><a href="aplikace3.html#cb968-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb968-5"><a href="aplikace3.html#cb968-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb968-6"><a href="aplikace3.html#cb968-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb968-7"><a href="aplikace3.html#cb968-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb968-8"><a href="aplikace3.html#cb968-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb968-9"><a href="aplikace3.html#cb968-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb968-10"><a href="aplikace3.html#cb968-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb968-11"><a href="aplikace3.html#cb968-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb968-12"><a href="aplikace3.html#cb968-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb968-13"><a href="aplikace3.html#cb968-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb968-14"><a href="aplikace3.html#cb968-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb968-15"><a href="aplikace3.html#cb968-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error rate&#39;</span>,</span>
<span id="cb968-16"><a href="aplikace3.html#cb968-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span> </span>
<span id="cb968-17"><a href="aplikace3.html#cb968-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb968-18"><a href="aplikace3.html#cb968-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-202"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-202-1.png" alt="Dependency of validation error on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The black points indicate the optimal dimension values $V_d$ for each kernel function." width="672" />
<p class="caption">
Figure 6.16: Dependency of validation error on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The black points indicate the optimal dimension values <span class="math inline">\(V_d\)</span> for each kernel function.
</p>
</div>
<p>Now we can train individual classifiers on all training data and examine their performance on the test data. For each kernel function, we choose the dimension of the subspace to project onto based on the results of cross-validation.</p>
<p>In the variable <code>Projection</code>, we have stored the matrix of orthogonal projection coefficients, given by</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb969"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb969-1"><a href="aplikace3.html#cb969-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb969-2"><a href="aplikace3.html#cb969-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb969-3"><a href="aplikace3.html#cb969-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb969-4"><a href="aplikace3.html#cb969-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb969-5"><a href="aplikace3.html#cb969-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb969-6"><a href="aplikace3.html#cb969-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb969-7"><a href="aplikace3.html#cb969-7" tabindex="-1"></a></span>
<span id="cb969-8"><a href="aplikace3.html#cb969-8" tabindex="-1"></a><span class="co"># Iterate through the kernels</span></span>
<span id="cb969-9"><a href="aplikace3.html#cb969-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb969-10"><a href="aplikace3.html#cb969-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb969-11"><a href="aplikace3.html#cb969-11" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb969-12"><a href="aplikace3.html#cb969-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb969-13"><a href="aplikace3.html#cb969-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb969-14"><a href="aplikace3.html#cb969-14" tabindex="-1"></a>  </span>
<span id="cb969-15"><a href="aplikace3.html#cb969-15" tabindex="-1"></a>  <span class="co"># Project discrete data onto B-spline basis</span></span>
<span id="cb969-16"><a href="aplikace3.html#cb969-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb969-17"><a href="aplikace3.html#cb969-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb969-18"><a href="aplikace3.html#cb969-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb969-19"><a href="aplikace3.html#cb969-19" tabindex="-1"></a>  </span>
<span id="cb969-20"><a href="aplikace3.html#cb969-20" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb969-21"><a href="aplikace3.html#cb969-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb969-22"><a href="aplikace3.html#cb969-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb969-23"><a href="aplikace3.html#cb969-23" tabindex="-1"></a>  </span>
<span id="cb969-24"><a href="aplikace3.html#cb969-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb969-25"><a href="aplikace3.html#cb969-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb969-26"><a href="aplikace3.html#cb969-26" tabindex="-1"></a>  </span>
<span id="cb969-27"><a href="aplikace3.html#cb969-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb969-28"><a href="aplikace3.html#cb969-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb969-29"><a href="aplikace3.html#cb969-29" tabindex="-1"></a>  </span>
<span id="cb969-30"><a href="aplikace3.html#cb969-30" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb969-31"><a href="aplikace3.html#cb969-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb969-32"><a href="aplikace3.html#cb969-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb969-33"><a href="aplikace3.html#cb969-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb969-34"><a href="aplikace3.html#cb969-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb969-35"><a href="aplikace3.html#cb969-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb969-36"><a href="aplikace3.html#cb969-36" tabindex="-1"></a>  </span>
<span id="cb969-37"><a href="aplikace3.html#cb969-37" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb969-38"><a href="aplikace3.html#cb969-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb969-39"><a href="aplikace3.html#cb969-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb969-40"><a href="aplikace3.html#cb969-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb969-41"><a href="aplikace3.html#cb969-41" tabindex="-1"></a>    </span>
<span id="cb969-42"><a href="aplikace3.html#cb969-42" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb969-43"><a href="aplikace3.html#cb969-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb969-44"><a href="aplikace3.html#cb969-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb969-45"><a href="aplikace3.html#cb969-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb969-46"><a href="aplikace3.html#cb969-46" tabindex="-1"></a>  </span>
<span id="cb969-47"><a href="aplikace3.html#cb969-47" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb969-48"><a href="aplikace3.html#cb969-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb969-49"><a href="aplikace3.html#cb969-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is 2 % for the linear kernel, 2.67 % for the polynomial kernel, and 9.33 % for the Gaussian kernel. The error rate on the test data is 6.15 % for the linear kernel, 6.15 % for the polynomial kernel, and 10.77 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb970"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb970-1"><a href="aplikace3.html#cb970-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVMA3b" class="section level4 hasAnchor" number="6.4.7.6">
<h4><span class="header-section-number">6.4.7.6</span> RKHS + SVM<a href="aplikace3.html#RKHS-SVMA3b" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section, we will explore another way to use the support vector machine (SVM) method for classifying functional data. In this case, we will once again apply a known principle where we first express functional data as finite-dimensional objects, and then apply the classical SVM method to these objects.</p>
<p>From the last part of Theorem <a href="simulace3.html#thm:MaG">1.3</a>, we see how to compute curve representations in practice. We will work with discretized data after smoothing the curves. First, we define the kernel for the RKHS space. We will use the Gaussian kernel with parameter <span class="math inline">\(\gamma\)</span>. The value of this hyperparameter significantly influences the behavior and success of the method, so we must pay special attention to its choice (we choose it using cross-validation).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb971"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb971-1"><a href="aplikace3.html#cb971-1" tabindex="-1"></a><span class="co"># hyperparameter values same as in the previous section</span></span>
<span id="cb971-2"><a href="aplikace3.html#cb971-2" tabindex="-1"></a>eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb971-3"><a href="aplikace3.html#cb971-3" tabindex="-1"></a>C <span class="ot">&lt;-</span> <span class="dv">1</span> </span></code></pre></div>
</details>
<div id="gaussian-kernel-6" class="section level6 hasAnchor" number="6.4.7.6.0.1">
<h6><span class="header-section-number">6.4.7.6.0.1</span> Gaussian Kernel<a href="aplikace3.html#gaussian-kernel-6" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb972"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb972-1"><a href="aplikace3.html#cb972-1" tabindex="-1"></a><span class="co"># remove the last column containing values of Y</span></span>
<span id="cb972-2"><a href="aplikace3.html#cb972-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb972-3"><a href="aplikace3.html#cb972-3" tabindex="-1"></a><span class="co"># add test data as well</span></span>
<span id="cb972-4"><a href="aplikace3.html#cb972-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb972-5"><a href="aplikace3.html#cb972-5" tabindex="-1"></a></span>
<span id="cb972-6"><a href="aplikace3.html#cb972-6" tabindex="-1"></a><span class="co"># kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb972-7"><a href="aplikace3.html#cb972-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb972-8"><a href="aplikace3.html#cb972-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb972-9"><a href="aplikace3.html#cb972-9" tabindex="-1"></a>}</span>
<span id="cb972-10"><a href="aplikace3.html#cb972-10" tabindex="-1"></a></span>
<span id="cb972-11"><a href="aplikace3.html#cb972-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb972-12"><a href="aplikace3.html#cb972-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb972-13"><a href="aplikace3.html#cb972-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb972-14"><a href="aplikace3.html#cb972-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb972-15"><a href="aplikace3.html#cb972-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb972-16"><a href="aplikace3.html#cb972-16" tabindex="-1"></a>    }</span>
<span id="cb972-17"><a href="aplikace3.html#cb972-17" tabindex="-1"></a>  }</span>
<span id="cb972-18"><a href="aplikace3.html#cb972-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb972-19"><a href="aplikace3.html#cb972-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s compute the matrix <span class="math inline">\(K_S\)</span> and its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb973"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb973-1"><a href="aplikace3.html#cb973-1" tabindex="-1"></a><span class="co"># compute matrix K</span></span>
<span id="cb973-2"><a href="aplikace3.html#cb973-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># fixed value of gamma, optimal value determined via CV</span></span>
<span id="cb973-3"><a href="aplikace3.html#cb973-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb973-4"><a href="aplikace3.html#cb973-4" tabindex="-1"></a></span>
<span id="cb973-5"><a href="aplikace3.html#cb973-5" tabindex="-1"></a><span class="co"># determine eigenvalues and eigenvectors</span></span>
<span id="cb973-6"><a href="aplikace3.html#cb973-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb973-7"><a href="aplikace3.html#cb973-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb973-8"><a href="aplikace3.html#cb973-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To calculate the coefficients in the representation of the curves, i.e., the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we need the coefficients from the SVM. Unlike the classification problem, we now solve a regression problem, as we aim to express our observed curves in a basis chosen by the kernel <span class="math inline">\(K\)</span>. Therefore, we use the <em>Support Vector Regression</em> method, from which we subsequently obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb974"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb974-1"><a href="aplikace3.html#cb974-1" tabindex="-1"></a><span class="co"># determine the alpha coefficients from SVM</span></span>
<span id="cb974-2"><a href="aplikace3.html#cb974-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb974-3"><a href="aplikace3.html#cb974-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb974-4"><a href="aplikace3.html#cb974-4" tabindex="-1"></a></span>
<span id="cb974-5"><a href="aplikace3.html#cb974-5" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb974-6"><a href="aplikace3.html#cb974-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb974-7"><a href="aplikace3.html#cb974-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb974-8"><a href="aplikace3.html#cb974-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb974-9"><a href="aplikace3.html#cb974-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb974-10"><a href="aplikace3.html#cb974-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb974-11"><a href="aplikace3.html#cb974-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb974-12"><a href="aplikace3.html#cb974-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,</span>
<span id="cb974-13"><a href="aplikace3.html#cb974-13" tabindex="-1"></a>                  <span class="at">cost =</span> C,</span>
<span id="cb974-14"><a href="aplikace3.html#cb974-14" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb974-15"><a href="aplikace3.html#cb974-15" tabindex="-1"></a>  <span class="co"># determine alpha</span></span>
<span id="cb974-16"><a href="aplikace3.html#cb974-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb974-17"><a href="aplikace3.html#cb974-17" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can compute the representations of the individual curves. First, we choose <span class="math inline">\(\hat d\)</span> to be the entire dimension, i.e., <span class="math inline">\(\hat d = m ={}\)</span> 101, and then we determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb975"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb975-1"><a href="aplikace3.html#cb975-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb975-2"><a href="aplikace3.html#cb975-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb975-3"><a href="aplikace3.html#cb975-3" tabindex="-1"></a></span>
<span id="cb975-4"><a href="aplikace3.html#cb975-4" tabindex="-1"></a><span class="co"># determine the lambda vector</span></span>
<span id="cb975-5"><a href="aplikace3.html#cb975-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb975-6"><a href="aplikace3.html#cb975-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb975-7"><a href="aplikace3.html#cb975-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb975-8"><a href="aplikace3.html#cb975-8" tabindex="-1"></a></span>
<span id="cb975-9"><a href="aplikace3.html#cb975-9" tabindex="-1"></a><span class="co"># compute the representation</span></span>
<span id="cb975-10"><a href="aplikace3.html#cb975-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb975-11"><a href="aplikace3.html#cb975-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb975-12"><a href="aplikace3.html#cb975-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have the matrix <code>Lambda.RKHS</code> storing the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> in its columns for each curve. These vectors will be used as representations of the curves, and we will classify the data based on this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb976"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb976-1"><a href="aplikace3.html#cb976-1" tabindex="-1"></a><span class="co"># split into training and testing data</span></span>
<span id="cb976-2"><a href="aplikace3.html#cb976-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb976-3"><a href="aplikace3.html#cb976-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb976-4"><a href="aplikace3.html#cb976-4" tabindex="-1"></a></span>
<span id="cb976-5"><a href="aplikace3.html#cb976-5" tabindex="-1"></a><span class="co"># prepare a data table to store results</span></span>
<span id="cb976-6"><a href="aplikace3.html#cb976-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb976-7"><a href="aplikace3.html#cb976-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb976-8"><a href="aplikace3.html#cb976-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb976-9"><a href="aplikace3.html#cb976-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb976-10"><a href="aplikace3.html#cb976-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb976-11"><a href="aplikace3.html#cb976-11" tabindex="-1"></a></span>
<span id="cb976-12"><a href="aplikace3.html#cb976-12" tabindex="-1"></a><span class="co"># iterate over different kernels</span></span>
<span id="cb976-13"><a href="aplikace3.html#cb976-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb976-14"><a href="aplikace3.html#cb976-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb976-15"><a href="aplikace3.html#cb976-15" tabindex="-1"></a></span>
<span id="cb976-16"><a href="aplikace3.html#cb976-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb976-17"><a href="aplikace3.html#cb976-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb976-18"><a href="aplikace3.html#cb976-18" tabindex="-1"></a>  </span>
<span id="cb976-19"><a href="aplikace3.html#cb976-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb976-20"><a href="aplikace3.html#cb976-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb976-21"><a href="aplikace3.html#cb976-21" tabindex="-1"></a>  </span>
<span id="cb976-22"><a href="aplikace3.html#cb976-22" tabindex="-1"></a>  <span class="co"># construct the model</span></span>
<span id="cb976-23"><a href="aplikace3.html#cb976-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb976-24"><a href="aplikace3.html#cb976-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb976-25"><a href="aplikace3.html#cb976-25" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb976-26"><a href="aplikace3.html#cb976-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb976-27"><a href="aplikace3.html#cb976-27" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb976-28"><a href="aplikace3.html#cb976-28" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb976-29"><a href="aplikace3.html#cb976-29" tabindex="-1"></a>  </span>
<span id="cb976-30"><a href="aplikace3.html#cb976-30" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb976-31"><a href="aplikace3.html#cb976-31" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb976-32"><a href="aplikace3.html#cb976-32" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb976-33"><a href="aplikace3.html#cb976-33" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb976-34"><a href="aplikace3.html#cb976-34" tabindex="-1"></a>    </span>
<span id="cb976-35"><a href="aplikace3.html#cb976-35" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb976-36"><a href="aplikace3.html#cb976-36" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb976-37"><a href="aplikace3.html#cb976-37" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb976-38"><a href="aplikace3.html#cb976-38" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb976-39"><a href="aplikace3.html#cb976-39" tabindex="-1"></a>  </span>
<span id="cb976-40"><a href="aplikace3.html#cb976-40" tabindex="-1"></a>  <span class="co"># store results</span></span>
<span id="cb976-41"><a href="aplikace3.html#cb976-41" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb976-42"><a href="aplikace3.html#cb976-42" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-211">Table 6.9: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0</td>
<td align="center">0</td>
</tr>
</tbody>
</table>
<p>We see that the model classifies the training data very well for all three kernels, while its performance on the test data is quite poor. It is evident that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values for <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb977"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb977-1"><a href="aplikace3.html#cb977-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb977-2"><a href="aplikace3.html#cb977-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb977-3"><a href="aplikace3.html#cb977-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb977-4"><a href="aplikace3.html#cb977-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb977-5"><a href="aplikace3.html#cb977-5" tabindex="-1"></a></span>
<span id="cb977-6"><a href="aplikace3.html#cb977-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb977-7"><a href="aplikace3.html#cb977-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb977-8"><a href="aplikace3.html#cb977-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb977-9"><a href="aplikace3.html#cb977-9" tabindex="-1"></a></span>
<span id="cb977-10"><a href="aplikace3.html#cb977-10" tabindex="-1"></a><span class="co"># List with three components ... array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb977-11"><a href="aplikace3.html#cb977-11" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb977-12"><a href="aplikace3.html#cb977-12" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given parameters</span></span>
<span id="cb977-13"><a href="aplikace3.html#cb977-13" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb977-14"><a href="aplikace3.html#cb977-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb977-15"><a href="aplikace3.html#cb977-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb977-16"><a href="aplikace3.html#cb977-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb977-17"><a href="aplikace3.html#cb977-17" tabindex="-1"></a></span>
<span id="cb977-18"><a href="aplikace3.html#cb977-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb977-19"><a href="aplikace3.html#cb977-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb977-20"><a href="aplikace3.html#cb977-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb977-21"><a href="aplikace3.html#cb977-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb977-22"><a href="aplikace3.html#cb977-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb977-23"><a href="aplikace3.html#cb977-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb977-24"><a href="aplikace3.html#cb977-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb978"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb978-1"><a href="aplikace3.html#cb978-1" tabindex="-1"></a><span class="co"># Cross-validation itself</span></span>
<span id="cb978-2"><a href="aplikace3.html#cb978-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb978-3"><a href="aplikace3.html#cb978-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb978-4"><a href="aplikace3.html#cb978-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb978-5"><a href="aplikace3.html#cb978-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb978-6"><a href="aplikace3.html#cb978-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb978-7"><a href="aplikace3.html#cb978-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb978-8"><a href="aplikace3.html#cb978-8" tabindex="-1"></a>  </span>
<span id="cb978-9"><a href="aplikace3.html#cb978-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb978-10"><a href="aplikace3.html#cb978-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb978-11"><a href="aplikace3.html#cb978-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb978-12"><a href="aplikace3.html#cb978-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb978-13"><a href="aplikace3.html#cb978-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb978-14"><a href="aplikace3.html#cb978-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb978-15"><a href="aplikace3.html#cb978-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb978-16"><a href="aplikace3.html#cb978-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb978-17"><a href="aplikace3.html#cb978-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb978-18"><a href="aplikace3.html#cb978-18" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb978-19"><a href="aplikace3.html#cb978-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb978-20"><a href="aplikace3.html#cb978-20" tabindex="-1"></a>  }</span>
<span id="cb978-21"><a href="aplikace3.html#cb978-21" tabindex="-1"></a>  </span>
<span id="cb978-22"><a href="aplikace3.html#cb978-22" tabindex="-1"></a>  <span class="co"># Iterate over dimensions</span></span>
<span id="cb978-23"><a href="aplikace3.html#cb978-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb978-24"><a href="aplikace3.html#cb978-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb978-25"><a href="aplikace3.html#cb978-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb978-26"><a href="aplikace3.html#cb978-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb978-27"><a href="aplikace3.html#cb978-27" tabindex="-1"></a>    <span class="co"># Calculate representation</span></span>
<span id="cb978-28"><a href="aplikace3.html#cb978-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb978-29"><a href="aplikace3.html#cb978-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb978-30"><a href="aplikace3.html#cb978-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb978-31"><a href="aplikace3.html#cb978-31" tabindex="-1"></a>    }</span>
<span id="cb978-32"><a href="aplikace3.html#cb978-32" tabindex="-1"></a>    <span class="co"># Iterate over folds</span></span>
<span id="cb978-33"><a href="aplikace3.html#cb978-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb978-34"><a href="aplikace3.html#cb978-34" tabindex="-1"></a>      <span class="co"># Define test and training portions for CV</span></span>
<span id="cb978-35"><a href="aplikace3.html#cb978-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb978-36"><a href="aplikace3.html#cb978-36" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb978-37"><a href="aplikace3.html#cb978-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb978-38"><a href="aplikace3.html#cb978-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb978-39"><a href="aplikace3.html#cb978-39" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb978-40"><a href="aplikace3.html#cb978-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb978-41"><a href="aplikace3.html#cb978-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb978-42"><a href="aplikace3.html#cb978-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb978-43"><a href="aplikace3.html#cb978-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb978-44"><a href="aplikace3.html#cb978-44" tabindex="-1"></a>      <span class="co"># Iterate over kernels</span></span>
<span id="cb978-45"><a href="aplikace3.html#cb978-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb978-46"><a href="aplikace3.html#cb978-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb978-47"><a href="aplikace3.html#cb978-47" tabindex="-1"></a>      </span>
<span id="cb978-48"><a href="aplikace3.html#cb978-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb978-49"><a href="aplikace3.html#cb978-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb978-50"><a href="aplikace3.html#cb978-50" tabindex="-1"></a>        </span>
<span id="cb978-51"><a href="aplikace3.html#cb978-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb978-52"><a href="aplikace3.html#cb978-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb978-53"><a href="aplikace3.html#cb978-53" tabindex="-1"></a>        </span>
<span id="cb978-54"><a href="aplikace3.html#cb978-54" tabindex="-1"></a>        <span class="co"># Constructing the model</span></span>
<span id="cb978-55"><a href="aplikace3.html#cb978-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb978-56"><a href="aplikace3.html#cb978-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb978-57"><a href="aplikace3.html#cb978-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb978-58"><a href="aplikace3.html#cb978-58" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb978-59"><a href="aplikace3.html#cb978-59" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb978-60"><a href="aplikace3.html#cb978-60" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb978-61"><a href="aplikace3.html#cb978-61" tabindex="-1"></a>        </span>
<span id="cb978-62"><a href="aplikace3.html#cb978-62" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb978-63"><a href="aplikace3.html#cb978-63" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb978-64"><a href="aplikace3.html#cb978-64" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb978-65"><a href="aplikace3.html#cb978-65" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb978-66"><a href="aplikace3.html#cb978-66" tabindex="-1"></a>        </span>
<span id="cb978-67"><a href="aplikace3.html#cb978-67" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb978-68"><a href="aplikace3.html#cb978-68" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb978-69"><a href="aplikace3.html#cb978-69" tabindex="-1"></a>      }</span>
<span id="cb978-70"><a href="aplikace3.html#cb978-70" tabindex="-1"></a>      <span class="co"># Store accuracies in the positions for given d, gamma, and fold</span></span>
<span id="cb978-71"><a href="aplikace3.html#cb978-71" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb978-72"><a href="aplikace3.html#cb978-72" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb978-73"><a href="aplikace3.html#cb978-73" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb978-74"><a href="aplikace3.html#cb978-74" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb978-75"><a href="aplikace3.html#cb978-75" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb978-76"><a href="aplikace3.html#cb978-76" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb978-77"><a href="aplikace3.html#cb978-77" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb978-78"><a href="aplikace3.html#cb978-78" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb978-79"><a href="aplikace3.html#cb978-79" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb978-80"><a href="aplikace3.html#cb978-80" tabindex="-1"></a>    }</span>
<span id="cb978-81"><a href="aplikace3.html#cb978-81" tabindex="-1"></a>  }</span>
<span id="cb978-82"><a href="aplikace3.html#cb978-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb979"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb979-1"><a href="aplikace3.html#cb979-1" tabindex="-1"></a><span class="co"># Calculate the average accuracy for each d across folds</span></span>
<span id="cb979-2"><a href="aplikace3.html#cb979-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb979-3"><a href="aplikace3.html#cb979-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb979-4"><a href="aplikace3.html#cb979-4" tabindex="-1"></a>}</span>
<span id="cb979-5"><a href="aplikace3.html#cb979-5" tabindex="-1"></a></span>
<span id="cb979-6"><a href="aplikace3.html#cb979-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb979-7"><a href="aplikace3.html#cb979-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb979-8"><a href="aplikace3.html#cb979-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb979-9"><a href="aplikace3.html#cb979-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb979-10"><a href="aplikace3.html#cb979-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb979-11"><a href="aplikace3.html#cb979-11" tabindex="-1"></a></span>
<span id="cb979-12"><a href="aplikace3.html#cb979-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb979-13"><a href="aplikace3.html#cb979-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb979-14"><a href="aplikace3.html#cb979-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb979-15"><a href="aplikace3.html#cb979-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb979-16"><a href="aplikace3.html#cb979-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb979-17"><a href="aplikace3.html#cb979-17" tabindex="-1"></a></span>
<span id="cb979-18"><a href="aplikace3.html#cb979-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb979-19"><a href="aplikace3.html#cb979-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb979-20"><a href="aplikace3.html#cb979-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb979-21"><a href="aplikace3.html#cb979-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb979-22"><a href="aplikace3.html#cb979-22" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb979-23"><a href="aplikace3.html#cb979-23" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-214">Table 6.10: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">12</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">18</td>
<td align="right">1.0000</td>
<td align="right">0</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">17</td>
<td align="right">1.9307</td>
<td align="right">0</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best parameter values are <span class="math inline">\(d={}\)</span> 12 and <span class="math inline">\(\gamma={}\)</span> 1 for the linear kernel, with an error rate calculated using 10-fold CV of 0. The optimal values for <span class="math inline">\(d={}\)</span> 18 and <span class="math inline">\(\gamma={}\)</span> 1 correspond to the polynomial kernel, with an error rate of 0, and for <span class="math inline">\(d={}\)</span> 17 and <span class="math inline">\(\gamma={}\)</span> 1.9307 for the radial kernel, yielding an error rate of 0.</p>
<p>For interest, let’s plot the validation error as a function of dimension <span class="math inline">\(d\)</span> and hyperparameter <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb980"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb980-1"><a href="aplikace3.html#cb980-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb980-2"><a href="aplikace3.html#cb980-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb980-3"><a href="aplikace3.html#cb980-3" tabindex="-1"></a>                              <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb980-4"><a href="aplikace3.html#cb980-4" tabindex="-1"></a>                                     <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb980-5"><a href="aplikace3.html#cb980-5" tabindex="-1"></a>                                     <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb980-6"><a href="aplikace3.html#cb980-6" tabindex="-1"></a>                              <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb980-7"><a href="aplikace3.html#cb980-7" tabindex="-1"></a>                                           <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb980-8"><a href="aplikace3.html#cb980-8" tabindex="-1"></a>                                             <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb980-9"><a href="aplikace3.html#cb980-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb980-10"><a href="aplikace3.html#cb980-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb980-11"><a href="aplikace3.html#cb980-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb980-12"><a href="aplikace3.html#cb980-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb980-13"><a href="aplikace3.html#cb980-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb980-14"><a href="aplikace3.html#cb980-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb980-15"><a href="aplikace3.html#cb980-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb980-16"><a href="aplikace3.html#cb980-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb980-17"><a href="aplikace3.html#cb980-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb980-18"><a href="aplikace3.html#cb980-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb980-19"><a href="aplikace3.html#cb980-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-215"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-215-1.png" alt="Dependency of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 6.17: Dependency of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>Since we have already found the optimal hyperparameter values, we can construct the final models and assess their classification performance on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb981"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb981-1"><a href="aplikace3.html#cb981-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb981-2"><a href="aplikace3.html#cb981-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb981-3"><a href="aplikace3.html#cb981-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb981-4"><a href="aplikace3.html#cb981-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb982"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb982-1"><a href="aplikace3.html#cb982-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store the results</span></span>
<span id="cb982-2"><a href="aplikace3.html#cb982-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb982-3"><a href="aplikace3.html#cb982-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb982-4"><a href="aplikace3.html#cb982-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb982-5"><a href="aplikace3.html#cb982-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb982-6"><a href="aplikace3.html#cb982-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb982-7"><a href="aplikace3.html#cb982-7" tabindex="-1"></a></span>
<span id="cb982-8"><a href="aplikace3.html#cb982-8" tabindex="-1"></a><span class="co"># Iterate through the individual kernels</span></span>
<span id="cb982-9"><a href="aplikace3.html#cb982-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb982-10"><a href="aplikace3.html#cb982-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb982-11"><a href="aplikace3.html#cb982-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># gamma value from CV</span></span>
<span id="cb982-12"><a href="aplikace3.html#cb982-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb982-13"><a href="aplikace3.html#cb982-13" tabindex="-1"></a>  </span>
<span id="cb982-14"><a href="aplikace3.html#cb982-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb982-15"><a href="aplikace3.html#cb982-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb982-16"><a href="aplikace3.html#cb982-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb982-17"><a href="aplikace3.html#cb982-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb982-18"><a href="aplikace3.html#cb982-18" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb982-19"><a href="aplikace3.html#cb982-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb982-20"><a href="aplikace3.html#cb982-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb982-21"><a href="aplikace3.html#cb982-21" tabindex="-1"></a>  </span>
<span id="cb982-22"><a href="aplikace3.html#cb982-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb982-23"><a href="aplikace3.html#cb982-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb982-24"><a href="aplikace3.html#cb982-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb982-25"><a href="aplikace3.html#cb982-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb982-26"><a href="aplikace3.html#cb982-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb982-27"><a href="aplikace3.html#cb982-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb982-28"><a href="aplikace3.html#cb982-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb982-29"><a href="aplikace3.html#cb982-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb982-30"><a href="aplikace3.html#cb982-30" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb982-31"><a href="aplikace3.html#cb982-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb982-32"><a href="aplikace3.html#cb982-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb982-33"><a href="aplikace3.html#cb982-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb982-34"><a href="aplikace3.html#cb982-34" tabindex="-1"></a>  }</span>
<span id="cb982-35"><a href="aplikace3.html#cb982-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb982-36"><a href="aplikace3.html#cb982-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb982-37"><a href="aplikace3.html#cb982-37" tabindex="-1"></a>  </span>
<span id="cb982-38"><a href="aplikace3.html#cb982-38" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb982-39"><a href="aplikace3.html#cb982-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb982-40"><a href="aplikace3.html#cb982-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb982-41"><a href="aplikace3.html#cb982-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb982-42"><a href="aplikace3.html#cb982-42" tabindex="-1"></a>  </span>
<span id="cb982-43"><a href="aplikace3.html#cb982-43" tabindex="-1"></a>  <span class="co"># Calculate the representation</span></span>
<span id="cb982-44"><a href="aplikace3.html#cb982-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb982-45"><a href="aplikace3.html#cb982-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb982-46"><a href="aplikace3.html#cb982-46" tabindex="-1"></a>  }</span>
<span id="cb982-47"><a href="aplikace3.html#cb982-47" tabindex="-1"></a>  </span>
<span id="cb982-48"><a href="aplikace3.html#cb982-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb982-49"><a href="aplikace3.html#cb982-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb982-50"><a href="aplikace3.html#cb982-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb982-51"><a href="aplikace3.html#cb982-51" tabindex="-1"></a></span>
<span id="cb982-52"><a href="aplikace3.html#cb982-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb982-53"><a href="aplikace3.html#cb982-53" tabindex="-1"></a></span>
<span id="cb982-54"><a href="aplikace3.html#cb982-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb982-55"><a href="aplikace3.html#cb982-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb982-56"><a href="aplikace3.html#cb982-56" tabindex="-1"></a>  </span>
<span id="cb982-57"><a href="aplikace3.html#cb982-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb982-58"><a href="aplikace3.html#cb982-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb982-59"><a href="aplikace3.html#cb982-59" tabindex="-1"></a>  </span>
<span id="cb982-60"><a href="aplikace3.html#cb982-60" tabindex="-1"></a>  <span class="co"># Build models</span></span>
<span id="cb982-61"><a href="aplikace3.html#cb982-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb982-62"><a href="aplikace3.html#cb982-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb982-63"><a href="aplikace3.html#cb982-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb982-64"><a href="aplikace3.html#cb982-64" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb982-65"><a href="aplikace3.html#cb982-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> coef0,</span>
<span id="cb982-66"><a href="aplikace3.html#cb982-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb982-67"><a href="aplikace3.html#cb982-67" tabindex="-1"></a>  </span>
<span id="cb982-68"><a href="aplikace3.html#cb982-68" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb982-69"><a href="aplikace3.html#cb982-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb982-70"><a href="aplikace3.html#cb982-70" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb982-71"><a href="aplikace3.html#cb982-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb982-72"><a href="aplikace3.html#cb982-72" tabindex="-1"></a>    </span>
<span id="cb982-73"><a href="aplikace3.html#cb982-73" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb982-74"><a href="aplikace3.html#cb982-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb982-75"><a href="aplikace3.html#cb982-75" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb982-76"><a href="aplikace3.html#cb982-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb982-77"><a href="aplikace3.html#cb982-77" tabindex="-1"></a>  </span>
<span id="cb982-78"><a href="aplikace3.html#cb982-78" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb982-79"><a href="aplikace3.html#cb982-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb982-80"><a href="aplikace3.html#cb982-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-218">Table 6.11: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>The accuracy of the SVM method combined with projection onto Reproducing Kernel Hilbert Space is thus equal to 0 % for the linear kernel, 0 % for the polynomial kernel, and 0 % for the Gaussian kernel on the training data. On the test data, the accuracy of the method is 3.08 % for the linear kernel, 7.69 % for the polynomial kernel, and 3.08 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb983"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb983-1"><a href="aplikace3.html#cb983-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomial-kernel-4" class="section level6 hasAnchor" number="6.4.7.6.0.2">
<h6><span class="header-section-number">6.4.7.6.0.2</span> Polynomial Kernel<a href="aplikace3.html#polynomial-kernel-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb984"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb984-1"><a href="aplikace3.html#cb984-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb984-2"><a href="aplikace3.html#cb984-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb984-3"><a href="aplikace3.html#cb984-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb984-4"><a href="aplikace3.html#cb984-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb984-5"><a href="aplikace3.html#cb984-5" tabindex="-1"></a></span>
<span id="cb984-6"><a href="aplikace3.html#cb984-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb984-7"><a href="aplikace3.html#cb984-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb984-8"><a href="aplikace3.html#cb984-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb984-9"><a href="aplikace3.html#cb984-9" tabindex="-1"></a>}</span>
<span id="cb984-10"><a href="aplikace3.html#cb984-10" tabindex="-1"></a></span>
<span id="cb984-11"><a href="aplikace3.html#cb984-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb984-12"><a href="aplikace3.html#cb984-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb984-13"><a href="aplikace3.html#cb984-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb984-14"><a href="aplikace3.html#cb984-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb984-15"><a href="aplikace3.html#cb984-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb984-16"><a href="aplikace3.html#cb984-16" tabindex="-1"></a>    }</span>
<span id="cb984-17"><a href="aplikace3.html#cb984-17" tabindex="-1"></a>  }</span>
<span id="cb984-18"><a href="aplikace3.html#cb984-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb984-19"><a href="aplikace3.html#cb984-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb985"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb985-1"><a href="aplikace3.html#cb985-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb985-2"><a href="aplikace3.html#cb985-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb985-3"><a href="aplikace3.html#cb985-3" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb985-4"><a href="aplikace3.html#cb985-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb985-5"><a href="aplikace3.html#cb985-5" tabindex="-1"></a></span>
<span id="cb985-6"><a href="aplikace3.html#cb985-6" tabindex="-1"></a><span class="co"># Values of hyperparameters to be searched</span></span>
<span id="cb985-7"><a href="aplikace3.html#cb985-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">30</span> <span class="co"># reasonable range of values d</span></span>
<span id="cb985-8"><a href="aplikace3.html#cb985-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb985-9"><a href="aplikace3.html#cb985-9" tabindex="-1"></a></span>
<span id="cb985-10"><a href="aplikace3.html#cb985-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb985-11"><a href="aplikace3.html#cb985-11" tabindex="-1"></a><span class="co"># Empty matrix where we will store individual results</span></span>
<span id="cb985-12"><a href="aplikace3.html#cb985-12" tabindex="-1"></a><span class="co"># In columns will be the accuracy values for the given</span></span>
<span id="cb985-13"><a href="aplikace3.html#cb985-13" tabindex="-1"></a><span class="co"># In rows will be values for given p and layers corresponding to folds</span></span>
<span id="cb985-14"><a href="aplikace3.html#cb985-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb985-15"><a href="aplikace3.html#cb985-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb985-16"><a href="aplikace3.html#cb985-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb985-17"><a href="aplikace3.html#cb985-17" tabindex="-1"></a></span>
<span id="cb985-18"><a href="aplikace3.html#cb985-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb985-19"><a href="aplikace3.html#cb985-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb985-20"><a href="aplikace3.html#cb985-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb985-21"><a href="aplikace3.html#cb985-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb985-22"><a href="aplikace3.html#cb985-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb985-23"><a href="aplikace3.html#cb985-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb985-24"><a href="aplikace3.html#cb985-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb986"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb986-1"><a href="aplikace3.html#cb986-1" tabindex="-1"></a><span class="co"># Actual CV</span></span>
<span id="cb986-2"><a href="aplikace3.html#cb986-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb986-3"><a href="aplikace3.html#cb986-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb986-4"><a href="aplikace3.html#cb986-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb986-5"><a href="aplikace3.html#cb986-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb986-6"><a href="aplikace3.html#cb986-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb986-7"><a href="aplikace3.html#cb986-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb986-8"><a href="aplikace3.html#cb986-8" tabindex="-1"></a>  </span>
<span id="cb986-9"><a href="aplikace3.html#cb986-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb986-10"><a href="aplikace3.html#cb986-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb986-11"><a href="aplikace3.html#cb986-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb986-12"><a href="aplikace3.html#cb986-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb986-13"><a href="aplikace3.html#cb986-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb986-14"><a href="aplikace3.html#cb986-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb986-15"><a href="aplikace3.html#cb986-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb986-16"><a href="aplikace3.html#cb986-16" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb986-17"><a href="aplikace3.html#cb986-17" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb986-18"><a href="aplikace3.html#cb986-18" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb986-19"><a href="aplikace3.html#cb986-19" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb986-20"><a href="aplikace3.html#cb986-20" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb986-21"><a href="aplikace3.html#cb986-21" tabindex="-1"></a>  }</span>
<span id="cb986-22"><a href="aplikace3.html#cb986-22" tabindex="-1"></a>  </span>
<span id="cb986-23"><a href="aplikace3.html#cb986-23" tabindex="-1"></a>  <span class="co"># Loop through dimensions</span></span>
<span id="cb986-24"><a href="aplikace3.html#cb986-24" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb986-25"><a href="aplikace3.html#cb986-25" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb986-26"><a href="aplikace3.html#cb986-26" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb986-27"><a href="aplikace3.html#cb986-27" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb986-28"><a href="aplikace3.html#cb986-28" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb986-29"><a href="aplikace3.html#cb986-29" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb986-30"><a href="aplikace3.html#cb986-30" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb986-31"><a href="aplikace3.html#cb986-31" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb986-32"><a href="aplikace3.html#cb986-32" tabindex="-1"></a>    }</span>
<span id="cb986-33"><a href="aplikace3.html#cb986-33" tabindex="-1"></a>    <span class="co"># Loop through folds</span></span>
<span id="cb986-34"><a href="aplikace3.html#cb986-34" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb986-35"><a href="aplikace3.html#cb986-35" tabindex="-1"></a>      <span class="co"># Define test and training parts for CV</span></span>
<span id="cb986-36"><a href="aplikace3.html#cb986-36" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb986-37"><a href="aplikace3.html#cb986-37" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb986-38"><a href="aplikace3.html#cb986-38" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb986-39"><a href="aplikace3.html#cb986-39" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb986-40"><a href="aplikace3.html#cb986-40" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb986-41"><a href="aplikace3.html#cb986-41" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb986-42"><a href="aplikace3.html#cb986-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb986-43"><a href="aplikace3.html#cb986-43" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb986-44"><a href="aplikace3.html#cb986-44" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb986-45"><a href="aplikace3.html#cb986-45" tabindex="-1"></a>      <span class="co"># Loop through individual kernels</span></span>
<span id="cb986-46"><a href="aplikace3.html#cb986-46" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb986-47"><a href="aplikace3.html#cb986-47" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb986-48"><a href="aplikace3.html#cb986-48" tabindex="-1"></a>      </span>
<span id="cb986-49"><a href="aplikace3.html#cb986-49" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb986-50"><a href="aplikace3.html#cb986-50" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb986-51"><a href="aplikace3.html#cb986-51" tabindex="-1"></a>        </span>
<span id="cb986-52"><a href="aplikace3.html#cb986-52" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb986-53"><a href="aplikace3.html#cb986-53" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb986-54"><a href="aplikace3.html#cb986-54" tabindex="-1"></a>        </span>
<span id="cb986-55"><a href="aplikace3.html#cb986-55" tabindex="-1"></a>        <span class="co"># Construct the model</span></span>
<span id="cb986-56"><a href="aplikace3.html#cb986-56" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb986-57"><a href="aplikace3.html#cb986-57" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb986-58"><a href="aplikace3.html#cb986-58" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb986-59"><a href="aplikace3.html#cb986-59" tabindex="-1"></a>                            <span class="at">cost =</span> C,                    </span>
<span id="cb986-60"><a href="aplikace3.html#cb986-60" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb986-61"><a href="aplikace3.html#cb986-61" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb986-62"><a href="aplikace3.html#cb986-62" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb986-63"><a href="aplikace3.html#cb986-63" tabindex="-1"></a>        </span>
<span id="cb986-64"><a href="aplikace3.html#cb986-64" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb986-65"><a href="aplikace3.html#cb986-65" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb986-66"><a href="aplikace3.html#cb986-66" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb986-67"><a href="aplikace3.html#cb986-67" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb986-68"><a href="aplikace3.html#cb986-68" tabindex="-1"></a>        </span>
<span id="cb986-69"><a href="aplikace3.html#cb986-69" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb986-70"><a href="aplikace3.html#cb986-70" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb986-71"><a href="aplikace3.html#cb986-71" tabindex="-1"></a>      }</span>
<span id="cb986-72"><a href="aplikace3.html#cb986-72" tabindex="-1"></a>      <span class="co"># Store accuracies at positions for given d, gamma, and fold</span></span>
<span id="cb986-73"><a href="aplikace3.html#cb986-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb986-74"><a href="aplikace3.html#cb986-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb986-75"><a href="aplikace3.html#cb986-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb986-76"><a href="aplikace3.html#cb986-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb986-77"><a href="aplikace3.html#cb986-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb986-78"><a href="aplikace3.html#cb986-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb986-79"><a href="aplikace3.html#cb986-79" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb986-80"><a href="aplikace3.html#cb986-80" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb986-81"><a href="aplikace3.html#cb986-81" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb986-82"><a href="aplikace3.html#cb986-82" tabindex="-1"></a>    }</span>
<span id="cb986-83"><a href="aplikace3.html#cb986-83" tabindex="-1"></a>  }</span>
<span id="cb986-84"><a href="aplikace3.html#cb986-84" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb987"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb987-1"><a href="aplikace3.html#cb987-1" tabindex="-1"></a><span class="co"># Compute the average accuracies for each d across folds</span></span>
<span id="cb987-2"><a href="aplikace3.html#cb987-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb987-3"><a href="aplikace3.html#cb987-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb987-4"><a href="aplikace3.html#cb987-4" tabindex="-1"></a>}</span>
<span id="cb987-5"><a href="aplikace3.html#cb987-5" tabindex="-1"></a></span>
<span id="cb987-6"><a href="aplikace3.html#cb987-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb987-7"><a href="aplikace3.html#cb987-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb987-8"><a href="aplikace3.html#cb987-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb987-9"><a href="aplikace3.html#cb987-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb987-10"><a href="aplikace3.html#cb987-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb987-11"><a href="aplikace3.html#cb987-11" tabindex="-1"></a></span>
<span id="cb987-12"><a href="aplikace3.html#cb987-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb987-13"><a href="aplikace3.html#cb987-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb987-14"><a href="aplikace3.html#cb987-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb987-15"><a href="aplikace3.html#cb987-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb987-16"><a href="aplikace3.html#cb987-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb987-17"><a href="aplikace3.html#cb987-17" tabindex="-1"></a></span>
<span id="cb987-18"><a href="aplikace3.html#cb987-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb987-19"><a href="aplikace3.html#cb987-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb987-20"><a href="aplikace3.html#cb987-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb987-21"><a href="aplikace3.html#cb987-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb987-22"><a href="aplikace3.html#cb987-22" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb987-23"><a href="aplikace3.html#cb987-23" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-223">Table 6.12: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">30</td>
<td align="right">3</td>
<td align="right">0.0077</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">17</td>
<td align="right">2</td>
<td align="right">0.0077</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">3</td>
<td align="right">4</td>
<td align="right">0.0254</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter values are <span class="math inline">\(d={}\)</span> 30 and <span class="math inline">\(p={}\)</span> 3 for the linear kernel with an error value computed using 10-fold CV 0.0077, <span class="math inline">\(d={}\)</span> 17 and <span class="math inline">\(p={}\)</span> 2 for the polynomial kernel with an error value computed using 10-fold CV 0.0077, and <span class="math inline">\(d={}\)</span> 3 and <span class="math inline">\(p={}\)</span> 4 for the radial kernel with an error value 0.0254.</p>
<p>Since we have found the optimal hyperparameter values, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb988"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb988-1"><a href="aplikace3.html#cb988-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb988-2"><a href="aplikace3.html#cb988-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb988-3"><a href="aplikace3.html#cb988-3" tabindex="-1"></a><span class="co"># Add the test data</span></span>
<span id="cb988-4"><a href="aplikace3.html#cb988-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb989"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb989-1"><a href="aplikace3.html#cb989-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb989-2"><a href="aplikace3.html#cb989-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb989-3"><a href="aplikace3.html#cb989-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb989-4"><a href="aplikace3.html#cb989-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb989-5"><a href="aplikace3.html#cb989-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb989-6"><a href="aplikace3.html#cb989-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb989-7"><a href="aplikace3.html#cb989-7" tabindex="-1"></a></span>
<span id="cb989-8"><a href="aplikace3.html#cb989-8" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb989-9"><a href="aplikace3.html#cb989-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb989-10"><a href="aplikace3.html#cb989-10" tabindex="-1"></a>  <span class="co"># Compute the K matrix</span></span>
<span id="cb989-11"><a href="aplikace3.html#cb989-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># gamma value using CV</span></span>
<span id="cb989-12"><a href="aplikace3.html#cb989-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb989-13"><a href="aplikace3.html#cb989-13" tabindex="-1"></a>  </span>
<span id="cb989-14"><a href="aplikace3.html#cb989-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb989-15"><a href="aplikace3.html#cb989-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb989-16"><a href="aplikace3.html#cb989-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb989-17"><a href="aplikace3.html#cb989-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb989-18"><a href="aplikace3.html#cb989-18" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb989-19"><a href="aplikace3.html#cb989-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb989-20"><a href="aplikace3.html#cb989-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb989-21"><a href="aplikace3.html#cb989-21" tabindex="-1"></a>  </span>
<span id="cb989-22"><a href="aplikace3.html#cb989-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb989-23"><a href="aplikace3.html#cb989-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb989-24"><a href="aplikace3.html#cb989-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb989-25"><a href="aplikace3.html#cb989-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb989-26"><a href="aplikace3.html#cb989-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb989-27"><a href="aplikace3.html#cb989-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb989-28"><a href="aplikace3.html#cb989-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb989-29"><a href="aplikace3.html#cb989-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,</span>
<span id="cb989-30"><a href="aplikace3.html#cb989-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb989-31"><a href="aplikace3.html#cb989-31" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb989-32"><a href="aplikace3.html#cb989-32" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb989-33"><a href="aplikace3.html#cb989-33" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb989-34"><a href="aplikace3.html#cb989-34" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb989-35"><a href="aplikace3.html#cb989-35" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb989-36"><a href="aplikace3.html#cb989-36" tabindex="-1"></a>  }</span>
<span id="cb989-37"><a href="aplikace3.html#cb989-37" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb989-38"><a href="aplikace3.html#cb989-38" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb989-39"><a href="aplikace3.html#cb989-39" tabindex="-1"></a>  </span>
<span id="cb989-40"><a href="aplikace3.html#cb989-40" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb989-41"><a href="aplikace3.html#cb989-41" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb989-42"><a href="aplikace3.html#cb989-42" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb989-43"><a href="aplikace3.html#cb989-43" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb989-44"><a href="aplikace3.html#cb989-44" tabindex="-1"></a>  </span>
<span id="cb989-45"><a href="aplikace3.html#cb989-45" tabindex="-1"></a>  <span class="co"># Compute the representation</span></span>
<span id="cb989-46"><a href="aplikace3.html#cb989-46" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb989-47"><a href="aplikace3.html#cb989-47" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb989-48"><a href="aplikace3.html#cb989-48" tabindex="-1"></a>  }</span>
<span id="cb989-49"><a href="aplikace3.html#cb989-49" tabindex="-1"></a>  </span>
<span id="cb989-50"><a href="aplikace3.html#cb989-50" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb989-51"><a href="aplikace3.html#cb989-51" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb989-52"><a href="aplikace3.html#cb989-52" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb989-53"><a href="aplikace3.html#cb989-53" tabindex="-1"></a></span>
<span id="cb989-54"><a href="aplikace3.html#cb989-54" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb989-55"><a href="aplikace3.html#cb989-55" tabindex="-1"></a></span>
<span id="cb989-56"><a href="aplikace3.html#cb989-56" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb989-57"><a href="aplikace3.html#cb989-57" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb989-58"><a href="aplikace3.html#cb989-58" tabindex="-1"></a>  </span>
<span id="cb989-59"><a href="aplikace3.html#cb989-59" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb989-60"><a href="aplikace3.html#cb989-60" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb989-61"><a href="aplikace3.html#cb989-61" tabindex="-1"></a>  </span>
<span id="cb989-62"><a href="aplikace3.html#cb989-62" tabindex="-1"></a>  <span class="co"># Construct models</span></span>
<span id="cb989-63"><a href="aplikace3.html#cb989-63" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb989-64"><a href="aplikace3.html#cb989-64" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb989-65"><a href="aplikace3.html#cb989-65" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb989-66"><a href="aplikace3.html#cb989-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb989-67"><a href="aplikace3.html#cb989-67" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb989-68"><a href="aplikace3.html#cb989-68" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb989-69"><a href="aplikace3.html#cb989-69" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb989-70"><a href="aplikace3.html#cb989-70" tabindex="-1"></a>  </span>
<span id="cb989-71"><a href="aplikace3.html#cb989-71" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb989-72"><a href="aplikace3.html#cb989-72" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb989-73"><a href="aplikace3.html#cb989-73" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb989-74"><a href="aplikace3.html#cb989-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb989-75"><a href="aplikace3.html#cb989-75" tabindex="-1"></a>    </span>
<span id="cb989-76"><a href="aplikace3.html#cb989-76" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb989-77"><a href="aplikace3.html#cb989-77" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb989-78"><a href="aplikace3.html#cb989-78" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb989-79"><a href="aplikace3.html#cb989-79" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb989-80"><a href="aplikace3.html#cb989-80" tabindex="-1"></a>  </span>
<span id="cb989-81"><a href="aplikace3.html#cb989-81" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb989-82"><a href="aplikace3.html#cb989-82" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb989-83"><a href="aplikace3.html#cb989-83" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-226">Table 6.13: </span>Summary of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.00</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.00</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.02</td>
<td align="center">0.0308</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 0 % for the linear kernel, 0 % for the polynomial kernel, and 2 % for the Gaussian kernel.
On the test data, the error rate of the method is 3.08 % for the linear kernel, 1.54 % for the polynomial kernel, and 3.08 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb990"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb990-1"><a href="aplikace3.html#cb990-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="linear-kernel-4" class="section level6 hasAnchor" number="6.4.7.6.0.3">
<h6><span class="header-section-number">6.4.7.6.0.3</span> Linear Kernel<a href="aplikace3.html#linear-kernel-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb991"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb991-1"><a href="aplikace3.html#cb991-1" tabindex="-1"></a><span class="co"># remove the last column, which contains the Y values</span></span>
<span id="cb991-2"><a href="aplikace3.html#cb991-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb991-3"><a href="aplikace3.html#cb991-3" tabindex="-1"></a><span class="co"># also add test data</span></span>
<span id="cb991-4"><a href="aplikace3.html#cb991-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb991-5"><a href="aplikace3.html#cb991-5" tabindex="-1"></a></span>
<span id="cb991-6"><a href="aplikace3.html#cb991-6" tabindex="-1"></a><span class="co"># kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb991-7"><a href="aplikace3.html#cb991-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb991-8"><a href="aplikace3.html#cb991-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb991-9"><a href="aplikace3.html#cb991-9" tabindex="-1"></a>}</span>
<span id="cb991-10"><a href="aplikace3.html#cb991-10" tabindex="-1"></a></span>
<span id="cb991-11"><a href="aplikace3.html#cb991-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb991-12"><a href="aplikace3.html#cb991-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb991-13"><a href="aplikace3.html#cb991-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb991-14"><a href="aplikace3.html#cb991-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb991-15"><a href="aplikace3.html#cb991-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb991-16"><a href="aplikace3.html#cb991-16" tabindex="-1"></a>    }</span>
<span id="cb991-17"><a href="aplikace3.html#cb991-17" tabindex="-1"></a>  }</span>
<span id="cb991-18"><a href="aplikace3.html#cb991-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb991-19"><a href="aplikace3.html#cb991-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb992"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb992-1"><a href="aplikace3.html#cb992-1" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb992-2"><a href="aplikace3.html#cb992-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb992-3"><a href="aplikace3.html#cb992-3" tabindex="-1"></a><span class="co"># remove the last column, which contains the Y values</span></span>
<span id="cb992-4"><a href="aplikace3.html#cb992-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb992-5"><a href="aplikace3.html#cb992-5" tabindex="-1"></a></span>
<span id="cb992-6"><a href="aplikace3.html#cb992-6" tabindex="-1"></a><span class="co"># hyperparameter values that we will iterate over</span></span>
<span id="cb992-7"><a href="aplikace3.html#cb992-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb992-8"><a href="aplikace3.html#cb992-8" tabindex="-1"></a></span>
<span id="cb992-9"><a href="aplikace3.html#cb992-9" tabindex="-1"></a><span class="co"># list with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb992-10"><a href="aplikace3.html#cb992-10" tabindex="-1"></a><span class="co"># empty matrix into which we will insert the individual results</span></span>
<span id="cb992-11"><a href="aplikace3.html#cb992-11" tabindex="-1"></a><span class="co"># in columns will be accuracy values for given d</span></span>
<span id="cb992-12"><a href="aplikace3.html#cb992-12" tabindex="-1"></a><span class="co"># in rows will be values for layers corresponding to folds</span></span>
<span id="cb992-13"><a href="aplikace3.html#cb992-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb992-14"><a href="aplikace3.html#cb992-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb992-15"><a href="aplikace3.html#cb992-15" tabindex="-1"></a></span>
<span id="cb992-16"><a href="aplikace3.html#cb992-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb992-17"><a href="aplikace3.html#cb992-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb992-18"><a href="aplikace3.html#cb992-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb992-19"><a href="aplikace3.html#cb992-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb992-20"><a href="aplikace3.html#cb992-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb992-21"><a href="aplikace3.html#cb992-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb992-22"><a href="aplikace3.html#cb992-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb993"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb993-1"><a href="aplikace3.html#cb993-1" tabindex="-1"></a><span class="co"># the actual CV</span></span>
<span id="cb993-2"><a href="aplikace3.html#cb993-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb993-3"><a href="aplikace3.html#cb993-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb993-4"><a href="aplikace3.html#cb993-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb993-5"><a href="aplikace3.html#cb993-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb993-6"><a href="aplikace3.html#cb993-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb993-7"><a href="aplikace3.html#cb993-7" tabindex="-1"></a></span>
<span id="cb993-8"><a href="aplikace3.html#cb993-8" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb993-9"><a href="aplikace3.html#cb993-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb993-10"><a href="aplikace3.html#cb993-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb993-11"><a href="aplikace3.html#cb993-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb993-12"><a href="aplikace3.html#cb993-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb993-13"><a href="aplikace3.html#cb993-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb993-14"><a href="aplikace3.html#cb993-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb993-15"><a href="aplikace3.html#cb993-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> eps,                   </span>
<span id="cb993-16"><a href="aplikace3.html#cb993-16" tabindex="-1"></a>                  <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb993-17"><a href="aplikace3.html#cb993-17" tabindex="-1"></a>                  <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb993-18"><a href="aplikace3.html#cb993-18" tabindex="-1"></a>                  <span class="at">cost =</span> C)</span>
<span id="cb993-19"><a href="aplikace3.html#cb993-19" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb993-20"><a href="aplikace3.html#cb993-20" tabindex="-1"></a>}</span>
<span id="cb993-21"><a href="aplikace3.html#cb993-21" tabindex="-1"></a></span>
<span id="cb993-22"><a href="aplikace3.html#cb993-22" tabindex="-1"></a><span class="co"># iterate through dimensions</span></span>
<span id="cb993-23"><a href="aplikace3.html#cb993-23" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb993-24"><a href="aplikace3.html#cb993-24" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb993-25"><a href="aplikace3.html#cb993-25" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb993-26"><a href="aplikace3.html#cb993-26" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb993-27"><a href="aplikace3.html#cb993-27" tabindex="-1"></a>  <span class="co"># compute representation</span></span>
<span id="cb993-28"><a href="aplikace3.html#cb993-28" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb993-29"><a href="aplikace3.html#cb993-29" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb993-30"><a href="aplikace3.html#cb993-30" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb993-31"><a href="aplikace3.html#cb993-31" tabindex="-1"></a>  }</span>
<span id="cb993-32"><a href="aplikace3.html#cb993-32" tabindex="-1"></a>  <span class="co"># iterate through folds</span></span>
<span id="cb993-33"><a href="aplikace3.html#cb993-33" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb993-34"><a href="aplikace3.html#cb993-34" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb993-35"><a href="aplikace3.html#cb993-35" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb993-36"><a href="aplikace3.html#cb993-36" tabindex="-1"></a>    <span class="co"># split into training and validation data</span></span>
<span id="cb993-37"><a href="aplikace3.html#cb993-37" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb993-38"><a href="aplikace3.html#cb993-38" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb993-39"><a href="aplikace3.html#cb993-39" tabindex="-1"></a>    <span class="co"># prepare a data table to store results</span></span>
<span id="cb993-40"><a href="aplikace3.html#cb993-40" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb993-41"><a href="aplikace3.html#cb993-41" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb993-42"><a href="aplikace3.html#cb993-42" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb993-43"><a href="aplikace3.html#cb993-43" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb993-44"><a href="aplikace3.html#cb993-44" tabindex="-1"></a>    <span class="co"># iterate through individual kernels</span></span>
<span id="cb993-45"><a href="aplikace3.html#cb993-45" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb993-46"><a href="aplikace3.html#cb993-46" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb993-47"><a href="aplikace3.html#cb993-47" tabindex="-1"></a>    </span>
<span id="cb993-48"><a href="aplikace3.html#cb993-48" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb993-49"><a href="aplikace3.html#cb993-49" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb993-50"><a href="aplikace3.html#cb993-50" tabindex="-1"></a>      </span>
<span id="cb993-51"><a href="aplikace3.html#cb993-51" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb993-52"><a href="aplikace3.html#cb993-52" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb993-53"><a href="aplikace3.html#cb993-53" tabindex="-1"></a>      </span>
<span id="cb993-54"><a href="aplikace3.html#cb993-54" tabindex="-1"></a>      <span class="co"># model construction</span></span>
<span id="cb993-55"><a href="aplikace3.html#cb993-55" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb993-56"><a href="aplikace3.html#cb993-56" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb993-57"><a href="aplikace3.html#cb993-57" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb993-58"><a href="aplikace3.html#cb993-58" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type,</span>
<span id="cb993-59"><a href="aplikace3.html#cb993-59" tabindex="-1"></a>                          <span class="at">epsilon =</span> eps,                   </span>
<span id="cb993-60"><a href="aplikace3.html#cb993-60" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb993-61"><a href="aplikace3.html#cb993-61" tabindex="-1"></a>                          <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb993-62"><a href="aplikace3.html#cb993-62" tabindex="-1"></a>                          <span class="at">cost =</span> C)</span>
<span id="cb993-63"><a href="aplikace3.html#cb993-63" tabindex="-1"></a>      </span>
<span id="cb993-64"><a href="aplikace3.html#cb993-64" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb993-65"><a href="aplikace3.html#cb993-65" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb993-66"><a href="aplikace3.html#cb993-66" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb993-67"><a href="aplikace3.html#cb993-67" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb993-68"><a href="aplikace3.html#cb993-68" tabindex="-1"></a>      </span>
<span id="cb993-69"><a href="aplikace3.html#cb993-69" tabindex="-1"></a>      <span class="co"># store results</span></span>
<span id="cb993-70"><a href="aplikace3.html#cb993-70" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb993-71"><a href="aplikace3.html#cb993-71" tabindex="-1"></a>    }</span>
<span id="cb993-72"><a href="aplikace3.html#cb993-72" tabindex="-1"></a>    <span class="co"># insert accuracies into positions for given d, gamma, and fold</span></span>
<span id="cb993-73"><a href="aplikace3.html#cb993-73" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb993-74"><a href="aplikace3.html#cb993-74" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb993-75"><a href="aplikace3.html#cb993-75" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb993-76"><a href="aplikace3.html#cb993-76" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb993-77"><a href="aplikace3.html#cb993-77" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb993-78"><a href="aplikace3.html#cb993-78" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb993-79"><a href="aplikace3.html#cb993-79" tabindex="-1"></a>  }</span>
<span id="cb993-80"><a href="aplikace3.html#cb993-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb994"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb994-1"><a href="aplikace3.html#cb994-1" tabindex="-1"></a><span class="co"># calculate the average accuracies for individual d across folds</span></span>
<span id="cb994-2"><a href="aplikace3.html#cb994-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb994-3"><a href="aplikace3.html#cb994-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb994-4"><a href="aplikace3.html#cb994-4" tabindex="-1"></a>}</span>
<span id="cb994-5"><a href="aplikace3.html#cb994-5" tabindex="-1"></a></span>
<span id="cb994-6"><a href="aplikace3.html#cb994-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb994-7"><a href="aplikace3.html#cb994-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb994-8"><a href="aplikace3.html#cb994-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb994-9"><a href="aplikace3.html#cb994-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb994-10"><a href="aplikace3.html#cb994-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb994-11"><a href="aplikace3.html#cb994-11" tabindex="-1"></a></span>
<span id="cb994-12"><a href="aplikace3.html#cb994-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb994-13"><a href="aplikace3.html#cb994-13" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb994-14"><a href="aplikace3.html#cb994-14" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb994-15"><a href="aplikace3.html#cb994-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb994-16"><a href="aplikace3.html#cb994-16" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb994-17"><a href="aplikace3.html#cb994-17" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-231">Table 6.14: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">31</td>
<td align="right">0.0267</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">21</td>
<td align="right">0.0267</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">6</td>
<td align="right">0.0592</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal value of the parameter <span class="math inline">\(d={}\)</span> 31 for the linear kernel yields a cross-validation error of 0.0267, <span class="math inline">\(d={}\)</span> 21 for the polynomial kernel with a cross-validation error of 0.0267, and <span class="math inline">\(d={}\)</span> 6 for the radial kernel with a cross-validation error of 0.0592.</p>
<p>Since we have already found the optimal values of the hyperparameters, we can construct the final models and determine their classification performance on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb995"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb995-1"><a href="aplikace3.html#cb995-1" tabindex="-1"></a><span class="co"># remove the last column, which contains the Y values</span></span>
<span id="cb995-2"><a href="aplikace3.html#cb995-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb995-3"><a href="aplikace3.html#cb995-3" tabindex="-1"></a><span class="co"># add the test data</span></span>
<span id="cb995-4"><a href="aplikace3.html#cb995-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb996"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb996-1"><a href="aplikace3.html#cb996-1" tabindex="-1"></a><span class="co"># prepare a data table to store the results</span></span>
<span id="cb996-2"><a href="aplikace3.html#cb996-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb996-3"><a href="aplikace3.html#cb996-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb996-4"><a href="aplikace3.html#cb996-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb996-5"><a href="aplikace3.html#cb996-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb996-6"><a href="aplikace3.html#cb996-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb996-7"><a href="aplikace3.html#cb996-7" tabindex="-1"></a></span>
<span id="cb996-8"><a href="aplikace3.html#cb996-8" tabindex="-1"></a><span class="co"># iterate over individual kernels</span></span>
<span id="cb996-9"><a href="aplikace3.html#cb996-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb996-10"><a href="aplikace3.html#cb996-10" tabindex="-1"></a>  <span class="co"># calculate the K matrix</span></span>
<span id="cb996-11"><a href="aplikace3.html#cb996-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb996-12"><a href="aplikace3.html#cb996-12" tabindex="-1"></a>  </span>
<span id="cb996-13"><a href="aplikace3.html#cb996-13" tabindex="-1"></a>  <span class="co"># determine eigenvalues and eigenvectors</span></span>
<span id="cb996-14"><a href="aplikace3.html#cb996-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb996-15"><a href="aplikace3.html#cb996-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb996-16"><a href="aplikace3.html#cb996-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb996-17"><a href="aplikace3.html#cb996-17" tabindex="-1"></a>  <span class="co"># determine alpha coefficients from SVM</span></span>
<span id="cb996-18"><a href="aplikace3.html#cb996-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb996-19"><a href="aplikace3.html#cb996-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb996-20"><a href="aplikace3.html#cb996-20" tabindex="-1"></a>  </span>
<span id="cb996-21"><a href="aplikace3.html#cb996-21" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb996-22"><a href="aplikace3.html#cb996-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb996-23"><a href="aplikace3.html#cb996-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb996-24"><a href="aplikace3.html#cb996-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb996-25"><a href="aplikace3.html#cb996-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb996-26"><a href="aplikace3.html#cb996-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb996-27"><a href="aplikace3.html#cb996-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb996-28"><a href="aplikace3.html#cb996-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps,                   </span>
<span id="cb996-29"><a href="aplikace3.html#cb996-29" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb996-30"><a href="aplikace3.html#cb996-30" tabindex="-1"></a>                    <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb996-31"><a href="aplikace3.html#cb996-31" tabindex="-1"></a>                    <span class="at">cost =</span> C)</span>
<span id="cb996-32"><a href="aplikace3.html#cb996-32" tabindex="-1"></a>    <span class="co"># determine alpha</span></span>
<span id="cb996-33"><a href="aplikace3.html#cb996-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb996-34"><a href="aplikace3.html#cb996-34" tabindex="-1"></a>  }</span>
<span id="cb996-35"><a href="aplikace3.html#cb996-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb996-36"><a href="aplikace3.html#cb996-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb996-37"><a href="aplikace3.html#cb996-37" tabindex="-1"></a>  </span>
<span id="cb996-38"><a href="aplikace3.html#cb996-38" tabindex="-1"></a>  <span class="co"># determine the lambda vector</span></span>
<span id="cb996-39"><a href="aplikace3.html#cb996-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb996-40"><a href="aplikace3.html#cb996-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb996-41"><a href="aplikace3.html#cb996-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb996-42"><a href="aplikace3.html#cb996-42" tabindex="-1"></a>  </span>
<span id="cb996-43"><a href="aplikace3.html#cb996-43" tabindex="-1"></a>  <span class="co"># calculate the representation</span></span>
<span id="cb996-44"><a href="aplikace3.html#cb996-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb996-45"><a href="aplikace3.html#cb996-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb996-46"><a href="aplikace3.html#cb996-46" tabindex="-1"></a>  }</span>
<span id="cb996-47"><a href="aplikace3.html#cb996-47" tabindex="-1"></a>  </span>
<span id="cb996-48"><a href="aplikace3.html#cb996-48" tabindex="-1"></a>  <span class="co"># split into training and test data</span></span>
<span id="cb996-49"><a href="aplikace3.html#cb996-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb996-50"><a href="aplikace3.html#cb996-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb996-51"><a href="aplikace3.html#cb996-51" tabindex="-1"></a></span>
<span id="cb996-52"><a href="aplikace3.html#cb996-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb996-53"><a href="aplikace3.html#cb996-53" tabindex="-1"></a></span>
<span id="cb996-54"><a href="aplikace3.html#cb996-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb996-55"><a href="aplikace3.html#cb996-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb996-56"><a href="aplikace3.html#cb996-56" tabindex="-1"></a>  </span>
<span id="cb996-57"><a href="aplikace3.html#cb996-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb996-58"><a href="aplikace3.html#cb996-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb996-59"><a href="aplikace3.html#cb996-59" tabindex="-1"></a>  </span>
<span id="cb996-60"><a href="aplikace3.html#cb996-60" tabindex="-1"></a>  <span class="co"># build the models</span></span>
<span id="cb996-61"><a href="aplikace3.html#cb996-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb996-62"><a href="aplikace3.html#cb996-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb996-63"><a href="aplikace3.html#cb996-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb996-64"><a href="aplikace3.html#cb996-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type,</span>
<span id="cb996-65"><a href="aplikace3.html#cb996-65" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb996-66"><a href="aplikace3.html#cb996-66" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb996-67"><a href="aplikace3.html#cb996-67" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb996-68"><a href="aplikace3.html#cb996-68" tabindex="-1"></a>                      <span class="at">cost =</span> C)</span>
<span id="cb996-69"><a href="aplikace3.html#cb996-69" tabindex="-1"></a>  </span>
<span id="cb996-70"><a href="aplikace3.html#cb996-70" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb996-71"><a href="aplikace3.html#cb996-71" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb996-72"><a href="aplikace3.html#cb996-72" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb996-73"><a href="aplikace3.html#cb996-73" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb996-74"><a href="aplikace3.html#cb996-74" tabindex="-1"></a>    </span>
<span id="cb996-75"><a href="aplikace3.html#cb996-75" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb996-76"><a href="aplikace3.html#cb996-76" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb996-77"><a href="aplikace3.html#cb996-77" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb996-78"><a href="aplikace3.html#cb996-78" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb996-79"><a href="aplikace3.html#cb996-79" tabindex="-1"></a>  </span>
<span id="cb996-80"><a href="aplikace3.html#cb996-80" tabindex="-1"></a>  <span class="co"># save results</span></span>
<span id="cb996-81"><a href="aplikace3.html#cb996-81" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb996-82"><a href="aplikace3.html#cb996-82" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-234">Table 6.15: </span>Summary of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.00</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.00</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.02</td>
<td align="center">0.1231</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 0 % on the training data for the linear kernel, 0 % for the polynomial kernel, and 2 % for the Gaussian kernel.
On the test data, the error rate is 4.62 % for the linear kernel, 3.08 % for the polynomial kernel, and 12.31 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb997"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb997-1"><a href="aplikace3.html#cb997-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="results-table-6" class="section level3 hasAnchor" number="6.4.8">
<h3><span class="header-section-number">6.4.8</span> Results Table<a href="aplikace3.html#results-table-6" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>From the table below, let us note two significant points. The first is that the methods classify the data significantly better than in the case of the original non-derivative data. In some methods, the improvement is even by tens of percent. The second significant point is that there is not such a pronounced difference between the results of the individual methods now.</p>
<table>
<caption><span id="tab:unnamed-chunk-236">Table 6.16: </span>Summary of the results of the methods used on the simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> of testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.0133</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.0400</td>
<td align="center">0.0923</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0000</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.0067</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">Tree - discretization</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">RForest - diskr</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0067</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM linear - func</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - func</td>
<td align="center">0.0000</td>
<td align="center">0.0000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - func</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discr</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="even">
<td align="left">SVM poly - discr</td>
<td align="center">0.0067</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - discr</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.0067</td>
<td align="center">0.0154</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0769</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0067</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0000</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.0200</td>
<td align="center">0.0615</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.0267</td>
<td align="center">0.0615</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0933</td>
<td align="center">0.1077</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0769</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0000</td>
<td align="center">0.0154</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0200</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.0000</td>
<td align="center">0.0462</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0000</td>
<td align="center">0.0308</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0200</td>
<td align="center">0.1231</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simstudyA3" class="section level2 hasAnchor" number="6.5">
<h2><span class="header-section-number">6.5</span> Simulation Study<a href="aplikace3.html#simstudyA3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the entire previous section, we dealt with a set of functions from two classification classes, which we then randomly split into testing and training parts. We then evaluated the individual classifiers obtained using the considered methods based on testing and training error rates.</p>
<p>Since the division of data into two parts can vary significantly with each repetition, the error rates of the individual classification algorithms will also differ significantly. Therefore, making any conclusions about the methods and comparing them to each other based on a single generated training dataset can be very misleading.</p>
<p>For this reason, this section will focus on repeating the entire previous procedure for different splits. We will store the results in a table and finally calculate the average characteristics of the models across the individual repetitions. To ensure our conclusions are sufficiently general, we will choose the number of repetitions <span class="math inline">\(n_{sim} = 100\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb998"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb998-1"><a href="aplikace3.html#cb998-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb998-2"><a href="aplikace3.html#cb998-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb998-3"><a href="aplikace3.html#cb998-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb998-4"><a href="aplikace3.html#cb998-4" tabindex="-1"></a>      <span class="st">&#39;Linear discriminant analysis&#39;</span>,</span>
<span id="cb998-5"><a href="aplikace3.html#cb998-5" tabindex="-1"></a>      <span class="st">&#39;Quadratic discriminant analysis&#39;</span>,</span>
<span id="cb998-6"><a href="aplikace3.html#cb998-6" tabindex="-1"></a>      <span class="st">&#39;Functional logistic regression&#39;</span>,</span>
<span id="cb998-7"><a href="aplikace3.html#cb998-7" tabindex="-1"></a>      <span class="st">&#39;Logistic regression with fPCA&#39;</span>,</span>
<span id="cb998-8"><a href="aplikace3.html#cb998-8" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- discretization&#39;</span>,</span>
<span id="cb998-9"><a href="aplikace3.html#cb998-9" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- fPCA&#39;</span>,</span>
<span id="cb998-10"><a href="aplikace3.html#cb998-10" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- basis coefficients&#39;</span>,</span>
<span id="cb998-11"><a href="aplikace3.html#cb998-11" tabindex="-1"></a>      <span class="st">&#39;Random forest -- discretization&#39;</span>,</span>
<span id="cb998-12"><a href="aplikace3.html#cb998-12" tabindex="-1"></a>      <span class="st">&#39;Random forest -- fPCA&#39;</span>,</span>
<span id="cb998-13"><a href="aplikace3.html#cb998-13" tabindex="-1"></a>      <span class="st">&#39;Random forest -- basis coefficients&#39;</span>,</span>
<span id="cb998-14"><a href="aplikace3.html#cb998-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- functional&#39;</span>,</span>
<span id="cb998-15"><a href="aplikace3.html#cb998-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- functional&#39;</span>,</span>
<span id="cb998-16"><a href="aplikace3.html#cb998-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- functional&#39;</span>,</span>
<span id="cb998-17"><a href="aplikace3.html#cb998-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- discretization&#39;</span>,</span>
<span id="cb998-18"><a href="aplikace3.html#cb998-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- discretization&#39;</span>,</span>
<span id="cb998-19"><a href="aplikace3.html#cb998-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- discretization&#39;</span>,</span>
<span id="cb998-20"><a href="aplikace3.html#cb998-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb998-21"><a href="aplikace3.html#cb998-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb998-22"><a href="aplikace3.html#cb998-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb998-23"><a href="aplikace3.html#cb998-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- basis coefficients&#39;</span>,</span>
<span id="cb998-24"><a href="aplikace3.html#cb998-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- basis coefficients&#39;</span>,</span>
<span id="cb998-25"><a href="aplikace3.html#cb998-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- basis coefficients&#39;</span>,</span>
<span id="cb998-26"><a href="aplikace3.html#cb998-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projection&#39;</span>,</span>
<span id="cb998-27"><a href="aplikace3.html#cb998-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projection&#39;</span>,</span>
<span id="cb998-28"><a href="aplikace3.html#cb998-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projection&#39;</span>,</span>
<span id="cb998-29"><a href="aplikace3.html#cb998-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb998-30"><a href="aplikace3.html#cb998-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb998-31"><a href="aplikace3.html#cb998-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb998-32"><a href="aplikace3.html#cb998-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb998-33"><a href="aplikace3.html#cb998-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb998-34"><a href="aplikace3.html#cb998-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb998-35"><a href="aplikace3.html#cb998-35" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb998-36"><a href="aplikace3.html#cb998-36" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb998-37"><a href="aplikace3.html#cb998-37" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb998-38"><a href="aplikace3.html#cb998-38" tabindex="-1"></a>)</span>
<span id="cb998-39"><a href="aplikace3.html#cb998-39" tabindex="-1"></a></span>
<span id="cb998-40"><a href="aplikace3.html#cb998-40" tabindex="-1"></a></span>
<span id="cb998-41"><a href="aplikace3.html#cb998-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb998-42"><a href="aplikace3.html#cb998-42" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb998-43"><a href="aplikace3.html#cb998-43" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb998-44"><a href="aplikace3.html#cb998-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb998-45"><a href="aplikace3.html#cb998-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb998-46"><a href="aplikace3.html#cb998-46" tabindex="-1"></a></span>
<span id="cb998-47"><a href="aplikace3.html#cb998-47" tabindex="-1"></a><span class="co"># box_col &lt;- c(&#39;#CA0A0A&#39;, &#39;#fa2600&#39;, &#39;#fa2600&#39;, &#39;#D15804&#39;,</span></span>
<span id="cb998-48"><a href="aplikace3.html#cb998-48" tabindex="-1"></a><span class="co">#              &#39;#D15804&#39;, rep(&#39;#D3006D&#39;, 3), rep(&#39;#BE090F&#39;, 3), c(&quot;#12DEE8&quot;, &quot;#4ECBF3&quot;, &quot;#127DE8&quot;, &quot;#4C3CD3&quot;, &quot;#4E65F3&quot;, &quot;#4E9EF3&quot;, &quot;#081D58&quot;) |&gt; rep(each = 3))</span></span>
<span id="cb998-49"><a href="aplikace3.html#cb998-49" tabindex="-1"></a></span>
<span id="cb998-50"><a href="aplikace3.html#cb998-50" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb998-51"><a href="aplikace3.html#cb998-51" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb998-52"><a href="aplikace3.html#cb998-52" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb998-53"><a href="aplikace3.html#cb998-53" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb999"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb999-1"><a href="aplikace3.html#cb999-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb999-2"><a href="aplikace3.html#cb999-2" tabindex="-1"></a>methods_names1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb999-3"><a href="aplikace3.html#cb999-3" tabindex="-1"></a>      <span class="st">&#39;KNN&#39;</span>,</span>
<span id="cb999-4"><a href="aplikace3.html#cb999-4" tabindex="-1"></a>      <span class="st">&#39;LDA&#39;</span>,</span>
<span id="cb999-5"><a href="aplikace3.html#cb999-5" tabindex="-1"></a>      <span class="st">&#39;QDA&#39;</span>,</span>
<span id="cb999-6"><a href="aplikace3.html#cb999-6" tabindex="-1"></a>      <span class="st">&#39;functional LR&#39;</span>,</span>
<span id="cb999-7"><a href="aplikace3.html#cb999-7" tabindex="-1"></a>      <span class="st">&#39;LR with fPCA&#39;</span>,</span>
<span id="cb999-8"><a href="aplikace3.html#cb999-8" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Discretization&#39;,</span></span>
<span id="cb999-9"><a href="aplikace3.html#cb999-9" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- fPCA&#39;,</span></span>
<span id="cb999-10"><a href="aplikace3.html#cb999-10" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Basis Coefficients&#39;,</span></span>
<span id="cb999-11"><a href="aplikace3.html#cb999-11" tabindex="-1"></a>      <span class="st">&#39;RF -- discretization&#39;</span>,</span>
<span id="cb999-12"><a href="aplikace3.html#cb999-12" tabindex="-1"></a>      <span class="st">&#39;RF -- fPCA&#39;</span>,</span>
<span id="cb999-13"><a href="aplikace3.html#cb999-13" tabindex="-1"></a>      <span class="st">&#39;RF -- basis coefficients&#39;</span>,</span>
<span id="cb999-14"><a href="aplikace3.html#cb999-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- functional&#39;</span>,</span>
<span id="cb999-15"><a href="aplikace3.html#cb999-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- functional&#39;</span>,</span>
<span id="cb999-16"><a href="aplikace3.html#cb999-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- functional&#39;</span>,</span>
<span id="cb999-17"><a href="aplikace3.html#cb999-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- discretization&#39;</span>,</span>
<span id="cb999-18"><a href="aplikace3.html#cb999-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- discretization&#39;</span>,</span>
<span id="cb999-19"><a href="aplikace3.html#cb999-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- discretization&#39;</span>,</span>
<span id="cb999-20"><a href="aplikace3.html#cb999-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb999-21"><a href="aplikace3.html#cb999-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb999-22"><a href="aplikace3.html#cb999-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb999-23"><a href="aplikace3.html#cb999-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- basis coefficients&#39;</span>,</span>
<span id="cb999-24"><a href="aplikace3.html#cb999-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- basis coefficients&#39;</span>,</span>
<span id="cb999-25"><a href="aplikace3.html#cb999-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- basis coefficients&#39;</span>,</span>
<span id="cb999-26"><a href="aplikace3.html#cb999-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projection&#39;</span>,</span>
<span id="cb999-27"><a href="aplikace3.html#cb999-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projection&#39;</span>,</span>
<span id="cb999-28"><a href="aplikace3.html#cb999-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projection&#39;</span>,</span>
<span id="cb999-29"><a href="aplikace3.html#cb999-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb999-30"><a href="aplikace3.html#cb999-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb999-31"><a href="aplikace3.html#cb999-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb999-32"><a href="aplikace3.html#cb999-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb999-33"><a href="aplikace3.html#cb999-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb999-34"><a href="aplikace3.html#cb999-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span><span class="co">#,</span></span>
<span id="cb999-35"><a href="aplikace3.html#cb999-35" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (linear)&#39;,</span></span>
<span id="cb999-36"><a href="aplikace3.html#cb999-36" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (poly)&#39;,</span></span>
<span id="cb999-37"><a href="aplikace3.html#cb999-37" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb999-38"><a href="aplikace3.html#cb999-38" tabindex="-1"></a>)</span>
<span id="cb999-39"><a href="aplikace3.html#cb999-39" tabindex="-1"></a></span>
<span id="cb999-40"><a href="aplikace3.html#cb999-40" tabindex="-1"></a></span>
<span id="cb999-41"><a href="aplikace3.html#cb999-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb999-42"><a href="aplikace3.html#cb999-42" tabindex="-1"></a>box_col1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,  <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb999-43"><a href="aplikace3.html#cb999-43" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb999-44"><a href="aplikace3.html#cb999-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb999-45"><a href="aplikace3.html#cb999-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">3</span>))</span>
<span id="cb999-46"><a href="aplikace3.html#cb999-46" tabindex="-1"></a></span>
<span id="cb999-47"><a href="aplikace3.html#cb999-47" tabindex="-1"></a><span class="co"># alpha for box plots</span></span>
<span id="cb999-48"><a href="aplikace3.html#cb999-48" tabindex="-1"></a>box_alpha1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb999-49"><a href="aplikace3.html#cb999-49" tabindex="-1"></a>               <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>), <span class="dv">7</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<div id="simulation-for-original-data" class="section level3 hasAnchor" number="6.5.1">
<h3><span class="header-section-number">6.5.1</span> Simulation for original Data<a href="aplikace3.html#simulation-for-original-data" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, let us look at the simulation of the original, that is, non-derivative data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1000"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1000-1"><a href="aplikace3.html#cb1000-1" tabindex="-1"></a><span class="co"># setting the pseudorandom number generator</span></span>
<span id="cb1000-2"><a href="aplikace3.html#cb1000-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1000-3"><a href="aplikace3.html#cb1000-3" tabindex="-1"></a></span>
<span id="cb1000-4"><a href="aplikace3.html#cb1000-4" tabindex="-1"></a><span class="co"># number of simulations</span></span>
<span id="cb1000-5"><a href="aplikace3.html#cb1000-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1000-6"><a href="aplikace3.html#cb1000-6" tabindex="-1"></a></span>
<span id="cb1000-7"><a href="aplikace3.html#cb1000-7" tabindex="-1"></a><span class="do">## list to store error values</span></span>
<span id="cb1000-8"><a href="aplikace3.html#cb1000-8" tabindex="-1"></a><span class="co"># methods will be in the columns</span></span>
<span id="cb1000-9"><a href="aplikace3.html#cb1000-9" tabindex="-1"></a><span class="co"># individual repetitions will be in the rows</span></span>
<span id="cb1000-10"><a href="aplikace3.html#cb1000-10" tabindex="-1"></a><span class="co"># the list has two items ... train and test</span></span>
<span id="cb1000-11"><a href="aplikace3.html#cb1000-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb1000-12"><a href="aplikace3.html#cb1000-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>,</span>
<span id="cb1000-13"><a href="aplikace3.html#cb1000-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - func&#39;</span>, <span class="st">&#39;SVM poly - func&#39;</span>, <span class="st">&#39;SVM rbf - func&#39;</span>,</span>
<span id="cb1000-14"><a href="aplikace3.html#cb1000-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - discr&#39;</span>, <span class="st">&#39;SVM poly - discr&#39;</span>, <span class="st">&#39;SVM rbf - discr&#39;</span>, </span>
<span id="cb1000-15"><a href="aplikace3.html#cb1000-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb1000-16"><a href="aplikace3.html#cb1000-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb1000-17"><a href="aplikace3.html#cb1000-17" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb1000-18"><a href="aplikace3.html#cb1000-18" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb1000-19"><a href="aplikace3.html#cb1000-19" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb1000-20"><a href="aplikace3.html#cb1000-20" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb1000-21"><a href="aplikace3.html#cb1000-21" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb1000-22"><a href="aplikace3.html#cb1000-22" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb1000-23"><a href="aplikace3.html#cb1000-23" tabindex="-1"></a></span>
<span id="cb1000-24"><a href="aplikace3.html#cb1000-24" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb1000-25"><a href="aplikace3.html#cb1000-25" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb1000-26"><a href="aplikace3.html#cb1000-26" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb1000-27"><a href="aplikace3.html#cb1000-27" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb1000-28"><a href="aplikace3.html#cb1000-28" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb1000-29"><a href="aplikace3.html#cb1000-29" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb1000-30"><a href="aplikace3.html#cb1000-30" tabindex="-1"></a></span>
<span id="cb1000-31"><a href="aplikace3.html#cb1000-31" tabindex="-1"></a><span class="co"># object to store optimal values of hyperparameters determined using CV</span></span>
<span id="cb1000-32"><a href="aplikace3.html#cb1000-32" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb1000-33"><a href="aplikace3.html#cb1000-33" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb1000-34"><a href="aplikace3.html#cb1000-34" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-35"><a href="aplikace3.html#cb1000-35" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-36"><a href="aplikace3.html#cb1000-36" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-37"><a href="aplikace3.html#cb1000-37" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb1000-38"><a href="aplikace3.html#cb1000-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-39"><a href="aplikace3.html#cb1000-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-40"><a href="aplikace3.html#cb1000-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-41"><a href="aplikace3.html#cb1000-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-42"><a href="aplikace3.html#cb1000-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-43"><a href="aplikace3.html#cb1000-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-44"><a href="aplikace3.html#cb1000-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-45"><a href="aplikace3.html#cb1000-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-46"><a href="aplikace3.html#cb1000-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-47"><a href="aplikace3.html#cb1000-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-48"><a href="aplikace3.html#cb1000-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-49"><a href="aplikace3.html#cb1000-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-50"><a href="aplikace3.html#cb1000-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-51"><a href="aplikace3.html#cb1000-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1000-52"><a href="aplikace3.html#cb1000-52" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Now we will repeat the entire previous part 100 times and store the error values in the list <code>SIMULACE</code>. We will also save the optimal hyperparameter values in the data table <code>CV_RESULTS</code>—for the <span class="math inline">\(K\)</span> nearest neighbors method and for SVM the dimension <span class="math inline">\(d\)</span> in the case of projection onto the B-spline basis. We will also store all hyperparameter values for the SVM + RKHS method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1001"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1001-1"><a href="aplikace3.html#cb1001-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb1001-2"><a href="aplikace3.html#cb1001-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb1001-3"><a href="aplikace3.html#cb1001-3" tabindex="-1"></a></span>
<span id="cb1001-4"><a href="aplikace3.html#cb1001-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb1001-5"><a href="aplikace3.html#cb1001-5" tabindex="-1"></a></span>
<span id="cb1001-6"><a href="aplikace3.html#cb1001-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb1001-7"><a href="aplikace3.html#cb1001-7" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb1001-8"><a href="aplikace3.html#cb1001-8" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb1001-9"><a href="aplikace3.html#cb1001-9" tabindex="-1"></a>  </span>
<span id="cb1001-10"><a href="aplikace3.html#cb1001-10" tabindex="-1"></a>  <span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb1001-11"><a href="aplikace3.html#cb1001-11" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1001-12"><a href="aplikace3.html#cb1001-12" tabindex="-1"></a>  </span>
<span id="cb1001-13"><a href="aplikace3.html#cb1001-13" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-14"><a href="aplikace3.html#cb1001-14" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1001-15"><a href="aplikace3.html#cb1001-15" tabindex="-1"></a>  </span>
<span id="cb1001-16"><a href="aplikace3.html#cb1001-16" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-17"><a href="aplikace3.html#cb1001-17" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1001-18"><a href="aplikace3.html#cb1001-18" tabindex="-1"></a>  </span>
<span id="cb1001-19"><a href="aplikace3.html#cb1001-19" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb1001-20"><a href="aplikace3.html#cb1001-20" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb1001-21"><a href="aplikace3.html#cb1001-21" tabindex="-1"></a>  </span>
<span id="cb1001-22"><a href="aplikace3.html#cb1001-22" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb1001-23"><a href="aplikace3.html#cb1001-23" tabindex="-1"></a>  </span>
<span id="cb1001-24"><a href="aplikace3.html#cb1001-24" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb1001-25"><a href="aplikace3.html#cb1001-25" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># pocet sousedu </span></span>
<span id="cb1001-26"><a href="aplikace3.html#cb1001-26" tabindex="-1"></a>  </span>
<span id="cb1001-27"><a href="aplikace3.html#cb1001-27" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-28"><a href="aplikace3.html#cb1001-28" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-29"><a href="aplikace3.html#cb1001-29" tabindex="-1"></a>  </span>
<span id="cb1001-30"><a href="aplikace3.html#cb1001-30" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1001-31"><a href="aplikace3.html#cb1001-31" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1001-32"><a href="aplikace3.html#cb1001-32" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-33"><a href="aplikace3.html#cb1001-33" tabindex="-1"></a>  }</span>
<span id="cb1001-34"><a href="aplikace3.html#cb1001-34" tabindex="-1"></a>  </span>
<span id="cb1001-35"><a href="aplikace3.html#cb1001-35" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb1001-36"><a href="aplikace3.html#cb1001-36" tabindex="-1"></a>  </span>
<span id="cb1001-37"><a href="aplikace3.html#cb1001-37" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-38"><a href="aplikace3.html#cb1001-38" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb1001-39"><a href="aplikace3.html#cb1001-39" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb1001-40"><a href="aplikace3.html#cb1001-40" tabindex="-1"></a>      </span>
<span id="cb1001-41"><a href="aplikace3.html#cb1001-41" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-42"><a href="aplikace3.html#cb1001-42" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1001-43"><a href="aplikace3.html#cb1001-43" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-44"><a href="aplikace3.html#cb1001-44" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1001-45"><a href="aplikace3.html#cb1001-45" tabindex="-1"></a>    </span>
<span id="cb1001-46"><a href="aplikace3.html#cb1001-46" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-47"><a href="aplikace3.html#cb1001-47" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1001-48"><a href="aplikace3.html#cb1001-48" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-49"><a href="aplikace3.html#cb1001-49" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1001-50"><a href="aplikace3.html#cb1001-50" tabindex="-1"></a>    </span>
<span id="cb1001-51"><a href="aplikace3.html#cb1001-51" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb1001-52"><a href="aplikace3.html#cb1001-52" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb1001-53"><a href="aplikace3.html#cb1001-53" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb1001-54"><a href="aplikace3.html#cb1001-54" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb1001-55"><a href="aplikace3.html#cb1001-55" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb1001-56"><a href="aplikace3.html#cb1001-56" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb1001-57"><a href="aplikace3.html#cb1001-57" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb1001-58"><a href="aplikace3.html#cb1001-58" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb1001-59"><a href="aplikace3.html#cb1001-59" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb1001-60"><a href="aplikace3.html#cb1001-60" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb1001-61"><a href="aplikace3.html#cb1001-61" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb1001-62"><a href="aplikace3.html#cb1001-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-63"><a href="aplikace3.html#cb1001-63" tabindex="-1"></a>      </span>
<span id="cb1001-64"><a href="aplikace3.html#cb1001-64" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb1001-65"><a href="aplikace3.html#cb1001-65" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb1001-66"><a href="aplikace3.html#cb1001-66" tabindex="-1"></a>    }</span>
<span id="cb1001-67"><a href="aplikace3.html#cb1001-67" tabindex="-1"></a>  }</span>
<span id="cb1001-68"><a href="aplikace3.html#cb1001-68" tabindex="-1"></a>  </span>
<span id="cb1001-69"><a href="aplikace3.html#cb1001-69" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb1001-70"><a href="aplikace3.html#cb1001-70" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb1001-71"><a href="aplikace3.html#cb1001-71" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb1001-72"><a href="aplikace3.html#cb1001-72" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb1001-73"><a href="aplikace3.html#cb1001-73" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb1001-74"><a href="aplikace3.html#cb1001-74" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb1001-75"><a href="aplikace3.html#cb1001-75" tabindex="-1"></a>  </span>
<span id="cb1001-76"><a href="aplikace3.html#cb1001-76" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb1001-77"><a href="aplikace3.html#cb1001-77" tabindex="-1"></a>  </span>
<span id="cb1001-78"><a href="aplikace3.html#cb1001-78" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb1001-79"><a href="aplikace3.html#cb1001-79" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb1001-80"><a href="aplikace3.html#cb1001-80" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb1001-81"><a href="aplikace3.html#cb1001-81" tabindex="-1"></a>  </span>
<span id="cb1001-82"><a href="aplikace3.html#cb1001-82" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb1001-83"><a href="aplikace3.html#cb1001-83" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb1001-84"><a href="aplikace3.html#cb1001-84" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb1001-85"><a href="aplikace3.html#cb1001-85" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb1001-86"><a href="aplikace3.html#cb1001-86" tabindex="-1"></a>  </span>
<span id="cb1001-87"><a href="aplikace3.html#cb1001-87" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb1001-88"><a href="aplikace3.html#cb1001-88" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb1001-89"><a href="aplikace3.html#cb1001-89" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb1001-90"><a href="aplikace3.html#cb1001-90" tabindex="-1"></a>  </span>
<span id="cb1001-91"><a href="aplikace3.html#cb1001-91" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb1001-92"><a href="aplikace3.html#cb1001-92" tabindex="-1"></a>  </span>
<span id="cb1001-93"><a href="aplikace3.html#cb1001-93" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb1001-94"><a href="aplikace3.html#cb1001-94" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb1001-95"><a href="aplikace3.html#cb1001-95" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb1001-96"><a href="aplikace3.html#cb1001-96" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb1001-97"><a href="aplikace3.html#cb1001-97" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1001-98"><a href="aplikace3.html#cb1001-98" tabindex="-1"></a>  </span>
<span id="cb1001-99"><a href="aplikace3.html#cb1001-99" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb1001-100"><a href="aplikace3.html#cb1001-100" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb1001-101"><a href="aplikace3.html#cb1001-101" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb1001-102"><a href="aplikace3.html#cb1001-102" tabindex="-1"></a>  </span>
<span id="cb1001-103"><a href="aplikace3.html#cb1001-103" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb1001-104"><a href="aplikace3.html#cb1001-104" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb1001-105"><a href="aplikace3.html#cb1001-105" tabindex="-1"></a>  </span>
<span id="cb1001-106"><a href="aplikace3.html#cb1001-106" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb1001-107"><a href="aplikace3.html#cb1001-107" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb1001-108"><a href="aplikace3.html#cb1001-108" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb1001-109"><a href="aplikace3.html#cb1001-109" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb1001-110"><a href="aplikace3.html#cb1001-110" tabindex="-1"></a>  }</span>
<span id="cb1001-111"><a href="aplikace3.html#cb1001-111" tabindex="-1"></a>  </span>
<span id="cb1001-112"><a href="aplikace3.html#cb1001-112" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb1001-113"><a href="aplikace3.html#cb1001-113" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-114"><a href="aplikace3.html#cb1001-114" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb1001-115"><a href="aplikace3.html#cb1001-115" tabindex="-1"></a>  </span>
<span id="cb1001-116"><a href="aplikace3.html#cb1001-116" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1001-117"><a href="aplikace3.html#cb1001-117" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb1001-118"><a href="aplikace3.html#cb1001-118" tabindex="-1"></a>  </span>
<span id="cb1001-119"><a href="aplikace3.html#cb1001-119" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-120"><a href="aplikace3.html#cb1001-120" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-121"><a href="aplikace3.html#cb1001-121" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1001-122"><a href="aplikace3.html#cb1001-122" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-123"><a href="aplikace3.html#cb1001-123" tabindex="-1"></a>    </span>
<span id="cb1001-124"><a href="aplikace3.html#cb1001-124" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-125"><a href="aplikace3.html#cb1001-125" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-126"><a href="aplikace3.html#cb1001-126" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1001-127"><a href="aplikace3.html#cb1001-127" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-128"><a href="aplikace3.html#cb1001-128" tabindex="-1"></a>  </span>
<span id="cb1001-129"><a href="aplikace3.html#cb1001-129" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb1001-130"><a href="aplikace3.html#cb1001-130" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-131"><a href="aplikace3.html#cb1001-131" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-132"><a href="aplikace3.html#cb1001-132" tabindex="-1"></a>  </span>
<span id="cb1001-133"><a href="aplikace3.html#cb1001-133" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-134"><a href="aplikace3.html#cb1001-134" tabindex="-1"></a>  </span>
<span id="cb1001-135"><a href="aplikace3.html#cb1001-135" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb1001-136"><a href="aplikace3.html#cb1001-136" tabindex="-1"></a>  </span>
<span id="cb1001-137"><a href="aplikace3.html#cb1001-137" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1001-138"><a href="aplikace3.html#cb1001-138" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb1001-139"><a href="aplikace3.html#cb1001-139" tabindex="-1"></a>  </span>
<span id="cb1001-140"><a href="aplikace3.html#cb1001-140" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-141"><a href="aplikace3.html#cb1001-141" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-142"><a href="aplikace3.html#cb1001-142" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1001-143"><a href="aplikace3.html#cb1001-143" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-144"><a href="aplikace3.html#cb1001-144" tabindex="-1"></a>    </span>
<span id="cb1001-145"><a href="aplikace3.html#cb1001-145" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-146"><a href="aplikace3.html#cb1001-146" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-147"><a href="aplikace3.html#cb1001-147" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1001-148"><a href="aplikace3.html#cb1001-148" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-149"><a href="aplikace3.html#cb1001-149" tabindex="-1"></a>  </span>
<span id="cb1001-150"><a href="aplikace3.html#cb1001-150" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb1001-151"><a href="aplikace3.html#cb1001-151" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-152"><a href="aplikace3.html#cb1001-152" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-153"><a href="aplikace3.html#cb1001-153" tabindex="-1"></a>  </span>
<span id="cb1001-154"><a href="aplikace3.html#cb1001-154" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-155"><a href="aplikace3.html#cb1001-155" tabindex="-1"></a>  </span>
<span id="cb1001-156"><a href="aplikace3.html#cb1001-156" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb1001-157"><a href="aplikace3.html#cb1001-157" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb1001-158"><a href="aplikace3.html#cb1001-158" tabindex="-1"></a>  </span>
<span id="cb1001-159"><a href="aplikace3.html#cb1001-159" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb1001-160"><a href="aplikace3.html#cb1001-160" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb1001-161"><a href="aplikace3.html#cb1001-161" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb1001-162"><a href="aplikace3.html#cb1001-162" tabindex="-1"></a>  </span>
<span id="cb1001-163"><a href="aplikace3.html#cb1001-163" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1001-164"><a href="aplikace3.html#cb1001-164" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1001-165"><a href="aplikace3.html#cb1001-165" tabindex="-1"></a>  </span>
<span id="cb1001-166"><a href="aplikace3.html#cb1001-166" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1001-167"><a href="aplikace3.html#cb1001-167" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1001-168"><a href="aplikace3.html#cb1001-168" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb1001-169"><a href="aplikace3.html#cb1001-169" tabindex="-1"></a>  nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1001-170"><a href="aplikace3.html#cb1001-170" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb1001-171"><a href="aplikace3.html#cb1001-171" tabindex="-1"></a>                                 <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb1001-172"><a href="aplikace3.html#cb1001-172" tabindex="-1"></a>  </span>
<span id="cb1001-173"><a href="aplikace3.html#cb1001-173" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb1001-174"><a href="aplikace3.html#cb1001-174" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb1001-175"><a href="aplikace3.html#cb1001-175" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb1001-176"><a href="aplikace3.html#cb1001-176" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb1001-177"><a href="aplikace3.html#cb1001-177" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-178"><a href="aplikace3.html#cb1001-178" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-179"><a href="aplikace3.html#cb1001-179" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1001-180"><a href="aplikace3.html#cb1001-180" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1001-181"><a href="aplikace3.html#cb1001-181" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-182"><a href="aplikace3.html#cb1001-182" tabindex="-1"></a>  }</span>
<span id="cb1001-183"><a href="aplikace3.html#cb1001-183" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb1001-184"><a href="aplikace3.html#cb1001-184" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1001-185"><a href="aplikace3.html#cb1001-185" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1001-186"><a href="aplikace3.html#cb1001-186" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb1001-187"><a href="aplikace3.html#cb1001-187" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb1001-188"><a href="aplikace3.html#cb1001-188" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb1001-189"><a href="aplikace3.html#cb1001-189" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb1001-190"><a href="aplikace3.html#cb1001-190" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb1001-191"><a href="aplikace3.html#cb1001-191" tabindex="-1"></a>  </span>
<span id="cb1001-192"><a href="aplikace3.html#cb1001-192" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb1001-193"><a href="aplikace3.html#cb1001-193" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1001-194"><a href="aplikace3.html#cb1001-194" tabindex="-1"></a>  </span>
<span id="cb1001-195"><a href="aplikace3.html#cb1001-195" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-196"><a href="aplikace3.html#cb1001-196" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb1001-197"><a href="aplikace3.html#cb1001-197" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb1001-198"><a href="aplikace3.html#cb1001-198" tabindex="-1"></a>      </span>
<span id="cb1001-199"><a href="aplikace3.html#cb1001-199" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-200"><a href="aplikace3.html#cb1001-200" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1001-201"><a href="aplikace3.html#cb1001-201" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-202"><a href="aplikace3.html#cb1001-202" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb1001-203"><a href="aplikace3.html#cb1001-203" tabindex="-1"></a>    </span>
<span id="cb1001-204"><a href="aplikace3.html#cb1001-204" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-205"><a href="aplikace3.html#cb1001-205" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1001-206"><a href="aplikace3.html#cb1001-206" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1001-207"><a href="aplikace3.html#cb1001-207" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb1001-208"><a href="aplikace3.html#cb1001-208" tabindex="-1"></a>    </span>
<span id="cb1001-209"><a href="aplikace3.html#cb1001-209" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb1001-210"><a href="aplikace3.html#cb1001-210" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1001-211"><a href="aplikace3.html#cb1001-211" tabindex="-1"></a>    </span>
<span id="cb1001-212"><a href="aplikace3.html#cb1001-212" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb1001-213"><a href="aplikace3.html#cb1001-213" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb1001-214"><a href="aplikace3.html#cb1001-214" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb1001-215"><a href="aplikace3.html#cb1001-215" tabindex="-1"></a>      </span>
<span id="cb1001-216"><a href="aplikace3.html#cb1001-216" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb1001-217"><a href="aplikace3.html#cb1001-217" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb1001-218"><a href="aplikace3.html#cb1001-218" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb1001-219"><a href="aplikace3.html#cb1001-219" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb1001-220"><a href="aplikace3.html#cb1001-220" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb1001-221"><a href="aplikace3.html#cb1001-221" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb1001-222"><a href="aplikace3.html#cb1001-222" tabindex="-1"></a>      </span>
<span id="cb1001-223"><a href="aplikace3.html#cb1001-223" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb1001-224"><a href="aplikace3.html#cb1001-224" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1001-225"><a href="aplikace3.html#cb1001-225" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb1001-226"><a href="aplikace3.html#cb1001-226" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1001-227"><a href="aplikace3.html#cb1001-227" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1001-228"><a href="aplikace3.html#cb1001-228" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-229"><a href="aplikace3.html#cb1001-229" tabindex="-1"></a>      </span>
<span id="cb1001-230"><a href="aplikace3.html#cb1001-230" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb1001-231"><a href="aplikace3.html#cb1001-231" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb1001-232"><a href="aplikace3.html#cb1001-232" tabindex="-1"></a>    } </span>
<span id="cb1001-233"><a href="aplikace3.html#cb1001-233" tabindex="-1"></a>  }</span>
<span id="cb1001-234"><a href="aplikace3.html#cb1001-234" tabindex="-1"></a>  </span>
<span id="cb1001-235"><a href="aplikace3.html#cb1001-235" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb1001-236"><a href="aplikace3.html#cb1001-236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb1001-237"><a href="aplikace3.html#cb1001-237" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb1001-238"><a href="aplikace3.html#cb1001-238" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb1001-239"><a href="aplikace3.html#cb1001-239" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb1001-240"><a href="aplikace3.html#cb1001-240" tabindex="-1"></a>  </span>
<span id="cb1001-241"><a href="aplikace3.html#cb1001-241" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb1001-242"><a href="aplikace3.html#cb1001-242" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb1001-243"><a href="aplikace3.html#cb1001-243" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb1001-244"><a href="aplikace3.html#cb1001-244" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb1001-245"><a href="aplikace3.html#cb1001-245" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1001-246"><a href="aplikace3.html#cb1001-246" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb1001-247"><a href="aplikace3.html#cb1001-247" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb1001-248"><a href="aplikace3.html#cb1001-248" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1001-249"><a href="aplikace3.html#cb1001-249" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1001-250"><a href="aplikace3.html#cb1001-250" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1001-251"><a href="aplikace3.html#cb1001-251" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb1001-252"><a href="aplikace3.html#cb1001-252" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb1001-253"><a href="aplikace3.html#cb1001-253" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb1001-254"><a href="aplikace3.html#cb1001-254" tabindex="-1"></a>  </span>
<span id="cb1001-255"><a href="aplikace3.html#cb1001-255" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-256"><a href="aplikace3.html#cb1001-256" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb1001-257"><a href="aplikace3.html#cb1001-257" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1001-258"><a href="aplikace3.html#cb1001-258" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1001-259"><a href="aplikace3.html#cb1001-259" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-260"><a href="aplikace3.html#cb1001-260" tabindex="-1"></a>    </span>
<span id="cb1001-261"><a href="aplikace3.html#cb1001-261" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-262"><a href="aplikace3.html#cb1001-262" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb1001-263"><a href="aplikace3.html#cb1001-263" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb1001-264"><a href="aplikace3.html#cb1001-264" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1001-265"><a href="aplikace3.html#cb1001-265" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1001-266"><a href="aplikace3.html#cb1001-266" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-267"><a href="aplikace3.html#cb1001-267" tabindex="-1"></a>  </span>
<span id="cb1001-268"><a href="aplikace3.html#cb1001-268" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb1001-269"><a href="aplikace3.html#cb1001-269" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-270"><a href="aplikace3.html#cb1001-270" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-271"><a href="aplikace3.html#cb1001-271" tabindex="-1"></a>  </span>
<span id="cb1001-272"><a href="aplikace3.html#cb1001-272" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-273"><a href="aplikace3.html#cb1001-273" tabindex="-1"></a>  </span>
<span id="cb1001-274"><a href="aplikace3.html#cb1001-274" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb1001-275"><a href="aplikace3.html#cb1001-275" tabindex="-1"></a>  </span>
<span id="cb1001-276"><a href="aplikace3.html#cb1001-276" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1001-277"><a href="aplikace3.html#cb1001-277" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb1001-278"><a href="aplikace3.html#cb1001-278" tabindex="-1"></a>  </span>
<span id="cb1001-279"><a href="aplikace3.html#cb1001-279" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-280"><a href="aplikace3.html#cb1001-280" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb1001-281"><a href="aplikace3.html#cb1001-281" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1001-282"><a href="aplikace3.html#cb1001-282" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-283"><a href="aplikace3.html#cb1001-283" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-284"><a href="aplikace3.html#cb1001-284" tabindex="-1"></a>    </span>
<span id="cb1001-285"><a href="aplikace3.html#cb1001-285" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-286"><a href="aplikace3.html#cb1001-286" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb1001-287"><a href="aplikace3.html#cb1001-287" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1001-288"><a href="aplikace3.html#cb1001-288" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-289"><a href="aplikace3.html#cb1001-289" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-290"><a href="aplikace3.html#cb1001-290" tabindex="-1"></a>  </span>
<span id="cb1001-291"><a href="aplikace3.html#cb1001-291" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb1001-292"><a href="aplikace3.html#cb1001-292" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-293"><a href="aplikace3.html#cb1001-293" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-294"><a href="aplikace3.html#cb1001-294" tabindex="-1"></a>  </span>
<span id="cb1001-295"><a href="aplikace3.html#cb1001-295" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-296"><a href="aplikace3.html#cb1001-296" tabindex="-1"></a>  </span>
<span id="cb1001-297"><a href="aplikace3.html#cb1001-297" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb1001-298"><a href="aplikace3.html#cb1001-298" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb1001-299"><a href="aplikace3.html#cb1001-299" tabindex="-1"></a>  </span>
<span id="cb1001-300"><a href="aplikace3.html#cb1001-300" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb1001-301"><a href="aplikace3.html#cb1001-301" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb1001-302"><a href="aplikace3.html#cb1001-302" tabindex="-1"></a>     </span>
<span id="cb1001-303"><a href="aplikace3.html#cb1001-303" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1001-304"><a href="aplikace3.html#cb1001-304" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb1001-305"><a href="aplikace3.html#cb1001-305" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1001-306"><a href="aplikace3.html#cb1001-306" tabindex="-1"></a>  </span>
<span id="cb1001-307"><a href="aplikace3.html#cb1001-307" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1001-308"><a href="aplikace3.html#cb1001-308" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb1001-309"><a href="aplikace3.html#cb1001-309" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1001-310"><a href="aplikace3.html#cb1001-310" tabindex="-1"></a>  </span>
<span id="cb1001-311"><a href="aplikace3.html#cb1001-311" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-312"><a href="aplikace3.html#cb1001-312" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb1001-313"><a href="aplikace3.html#cb1001-313" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1001-314"><a href="aplikace3.html#cb1001-314" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1001-315"><a href="aplikace3.html#cb1001-315" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1001-316"><a href="aplikace3.html#cb1001-316" tabindex="-1"></a>  </span>
<span id="cb1001-317"><a href="aplikace3.html#cb1001-317" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-318"><a href="aplikace3.html#cb1001-318" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1001-319"><a href="aplikace3.html#cb1001-319" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-320"><a href="aplikace3.html#cb1001-320" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-321"><a href="aplikace3.html#cb1001-321" tabindex="-1"></a>    </span>
<span id="cb1001-322"><a href="aplikace3.html#cb1001-322" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-323"><a href="aplikace3.html#cb1001-323" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1001-324"><a href="aplikace3.html#cb1001-324" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-325"><a href="aplikace3.html#cb1001-325" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-326"><a href="aplikace3.html#cb1001-326" tabindex="-1"></a>  </span>
<span id="cb1001-327"><a href="aplikace3.html#cb1001-327" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb1001-328"><a href="aplikace3.html#cb1001-328" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-329"><a href="aplikace3.html#cb1001-329" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-330"><a href="aplikace3.html#cb1001-330" tabindex="-1"></a>  </span>
<span id="cb1001-331"><a href="aplikace3.html#cb1001-331" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-332"><a href="aplikace3.html#cb1001-332" tabindex="-1"></a>  </span>
<span id="cb1001-333"><a href="aplikace3.html#cb1001-333" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb1001-334"><a href="aplikace3.html#cb1001-334" tabindex="-1"></a>  </span>
<span id="cb1001-335"><a href="aplikace3.html#cb1001-335" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-336"><a href="aplikace3.html#cb1001-336" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb1001-337"><a href="aplikace3.html#cb1001-337" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1001-338"><a href="aplikace3.html#cb1001-338" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1001-339"><a href="aplikace3.html#cb1001-339" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1001-340"><a href="aplikace3.html#cb1001-340" tabindex="-1"></a>  </span>
<span id="cb1001-341"><a href="aplikace3.html#cb1001-341" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-342"><a href="aplikace3.html#cb1001-342" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-343"><a href="aplikace3.html#cb1001-343" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-344"><a href="aplikace3.html#cb1001-344" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-345"><a href="aplikace3.html#cb1001-345" tabindex="-1"></a>    </span>
<span id="cb1001-346"><a href="aplikace3.html#cb1001-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-347"><a href="aplikace3.html#cb1001-347" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-348"><a href="aplikace3.html#cb1001-348" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-349"><a href="aplikace3.html#cb1001-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-350"><a href="aplikace3.html#cb1001-350" tabindex="-1"></a>  </span>
<span id="cb1001-351"><a href="aplikace3.html#cb1001-351" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb1001-352"><a href="aplikace3.html#cb1001-352" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-353"><a href="aplikace3.html#cb1001-353" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-354"><a href="aplikace3.html#cb1001-354" tabindex="-1"></a>  </span>
<span id="cb1001-355"><a href="aplikace3.html#cb1001-355" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-356"><a href="aplikace3.html#cb1001-356" tabindex="-1"></a>  </span>
<span id="cb1001-357"><a href="aplikace3.html#cb1001-357" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb1001-358"><a href="aplikace3.html#cb1001-358" tabindex="-1"></a>  </span>
<span id="cb1001-359"><a href="aplikace3.html#cb1001-359" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb1001-360"><a href="aplikace3.html#cb1001-360" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb1001-361"><a href="aplikace3.html#cb1001-361" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1001-362"><a href="aplikace3.html#cb1001-362" tabindex="-1"></a>  </span>
<span id="cb1001-363"><a href="aplikace3.html#cb1001-363" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb1001-364"><a href="aplikace3.html#cb1001-364" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb1001-365"><a href="aplikace3.html#cb1001-365" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-366"><a href="aplikace3.html#cb1001-366" tabindex="-1"></a>  </span>
<span id="cb1001-367"><a href="aplikace3.html#cb1001-367" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-368"><a href="aplikace3.html#cb1001-368" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb1001-369"><a href="aplikace3.html#cb1001-369" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1001-370"><a href="aplikace3.html#cb1001-370" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1001-371"><a href="aplikace3.html#cb1001-371" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1001-372"><a href="aplikace3.html#cb1001-372" tabindex="-1"></a>  </span>
<span id="cb1001-373"><a href="aplikace3.html#cb1001-373" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-374"><a href="aplikace3.html#cb1001-374" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1001-375"><a href="aplikace3.html#cb1001-375" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-376"><a href="aplikace3.html#cb1001-376" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-377"><a href="aplikace3.html#cb1001-377" tabindex="-1"></a>    </span>
<span id="cb1001-378"><a href="aplikace3.html#cb1001-378" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-379"><a href="aplikace3.html#cb1001-379" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1001-380"><a href="aplikace3.html#cb1001-380" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-381"><a href="aplikace3.html#cb1001-381" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-382"><a href="aplikace3.html#cb1001-382" tabindex="-1"></a>  </span>
<span id="cb1001-383"><a href="aplikace3.html#cb1001-383" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb1001-384"><a href="aplikace3.html#cb1001-384" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-385"><a href="aplikace3.html#cb1001-385" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-386"><a href="aplikace3.html#cb1001-386" tabindex="-1"></a>  </span>
<span id="cb1001-387"><a href="aplikace3.html#cb1001-387" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-388"><a href="aplikace3.html#cb1001-388" tabindex="-1"></a>  </span>
<span id="cb1001-389"><a href="aplikace3.html#cb1001-389" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb1001-390"><a href="aplikace3.html#cb1001-390" tabindex="-1"></a>  </span>
<span id="cb1001-391"><a href="aplikace3.html#cb1001-391" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb1001-392"><a href="aplikace3.html#cb1001-392" tabindex="-1"></a>  </span>
<span id="cb1001-393"><a href="aplikace3.html#cb1001-393" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-394"><a href="aplikace3.html#cb1001-394" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb1001-395"><a href="aplikace3.html#cb1001-395" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1001-396"><a href="aplikace3.html#cb1001-396" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-397"><a href="aplikace3.html#cb1001-397" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1001-398"><a href="aplikace3.html#cb1001-398" tabindex="-1"></a>  </span>
<span id="cb1001-399"><a href="aplikace3.html#cb1001-399" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-400"><a href="aplikace3.html#cb1001-400" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1001-401"><a href="aplikace3.html#cb1001-401" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-402"><a href="aplikace3.html#cb1001-402" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-403"><a href="aplikace3.html#cb1001-403" tabindex="-1"></a>    </span>
<span id="cb1001-404"><a href="aplikace3.html#cb1001-404" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-405"><a href="aplikace3.html#cb1001-405" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1001-406"><a href="aplikace3.html#cb1001-406" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-407"><a href="aplikace3.html#cb1001-407" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-408"><a href="aplikace3.html#cb1001-408" tabindex="-1"></a>  </span>
<span id="cb1001-409"><a href="aplikace3.html#cb1001-409" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb1001-410"><a href="aplikace3.html#cb1001-410" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-411"><a href="aplikace3.html#cb1001-411" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-412"><a href="aplikace3.html#cb1001-412" tabindex="-1"></a>  </span>
<span id="cb1001-413"><a href="aplikace3.html#cb1001-413" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-414"><a href="aplikace3.html#cb1001-414" tabindex="-1"></a>  </span>
<span id="cb1001-415"><a href="aplikace3.html#cb1001-415" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb1001-416"><a href="aplikace3.html#cb1001-416" tabindex="-1"></a>  </span>
<span id="cb1001-417"><a href="aplikace3.html#cb1001-417" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-418"><a href="aplikace3.html#cb1001-418" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb1001-419"><a href="aplikace3.html#cb1001-419" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1001-420"><a href="aplikace3.html#cb1001-420" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-421"><a href="aplikace3.html#cb1001-421" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1001-422"><a href="aplikace3.html#cb1001-422" tabindex="-1"></a>  </span>
<span id="cb1001-423"><a href="aplikace3.html#cb1001-423" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-424"><a href="aplikace3.html#cb1001-424" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-425"><a href="aplikace3.html#cb1001-425" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-426"><a href="aplikace3.html#cb1001-426" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-427"><a href="aplikace3.html#cb1001-427" tabindex="-1"></a>    </span>
<span id="cb1001-428"><a href="aplikace3.html#cb1001-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-429"><a href="aplikace3.html#cb1001-429" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-430"><a href="aplikace3.html#cb1001-430" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-431"><a href="aplikace3.html#cb1001-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-432"><a href="aplikace3.html#cb1001-432" tabindex="-1"></a>  </span>
<span id="cb1001-433"><a href="aplikace3.html#cb1001-433" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb1001-434"><a href="aplikace3.html#cb1001-434" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-435"><a href="aplikace3.html#cb1001-435" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-436"><a href="aplikace3.html#cb1001-436" tabindex="-1"></a>  </span>
<span id="cb1001-437"><a href="aplikace3.html#cb1001-437" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-438"><a href="aplikace3.html#cb1001-438" tabindex="-1"></a>  </span>
<span id="cb1001-439"><a href="aplikace3.html#cb1001-439" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb1001-440"><a href="aplikace3.html#cb1001-440" tabindex="-1"></a>  </span>
<span id="cb1001-441"><a href="aplikace3.html#cb1001-441" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-442"><a href="aplikace3.html#cb1001-442" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb1001-443"><a href="aplikace3.html#cb1001-443" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1001-444"><a href="aplikace3.html#cb1001-444" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-445"><a href="aplikace3.html#cb1001-445" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1001-446"><a href="aplikace3.html#cb1001-446" tabindex="-1"></a>  </span>
<span id="cb1001-447"><a href="aplikace3.html#cb1001-447" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-448"><a href="aplikace3.html#cb1001-448" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1001-449"><a href="aplikace3.html#cb1001-449" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-450"><a href="aplikace3.html#cb1001-450" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-451"><a href="aplikace3.html#cb1001-451" tabindex="-1"></a>    </span>
<span id="cb1001-452"><a href="aplikace3.html#cb1001-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-453"><a href="aplikace3.html#cb1001-453" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1001-454"><a href="aplikace3.html#cb1001-454" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-455"><a href="aplikace3.html#cb1001-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-456"><a href="aplikace3.html#cb1001-456" tabindex="-1"></a>  </span>
<span id="cb1001-457"><a href="aplikace3.html#cb1001-457" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb1001-458"><a href="aplikace3.html#cb1001-458" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1001-459"><a href="aplikace3.html#cb1001-459" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1001-460"><a href="aplikace3.html#cb1001-460" tabindex="-1"></a>  </span>
<span id="cb1001-461"><a href="aplikace3.html#cb1001-461" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-462"><a href="aplikace3.html#cb1001-462" tabindex="-1"></a>  </span>
<span id="cb1001-463"><a href="aplikace3.html#cb1001-463" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb1001-464"><a href="aplikace3.html#cb1001-464" tabindex="-1"></a>  </span>
<span id="cb1001-465"><a href="aplikace3.html#cb1001-465" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb1001-466"><a href="aplikace3.html#cb1001-466" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-467"><a href="aplikace3.html#cb1001-467" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1001-468"><a href="aplikace3.html#cb1001-468" tabindex="-1"></a>  </span>
<span id="cb1001-469"><a href="aplikace3.html#cb1001-469" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-470"><a href="aplikace3.html#cb1001-470" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1001-471"><a href="aplikace3.html#cb1001-471" tabindex="-1"></a>  </span>
<span id="cb1001-472"><a href="aplikace3.html#cb1001-472" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1001-473"><a href="aplikace3.html#cb1001-473" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb1001-474"><a href="aplikace3.html#cb1001-474" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1001-475"><a href="aplikace3.html#cb1001-475" tabindex="-1"></a>  </span>
<span id="cb1001-476"><a href="aplikace3.html#cb1001-476" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1001-477"><a href="aplikace3.html#cb1001-477" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb1001-478"><a href="aplikace3.html#cb1001-478" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1001-479"><a href="aplikace3.html#cb1001-479" tabindex="-1"></a>  </span>
<span id="cb1001-480"><a href="aplikace3.html#cb1001-480" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-481"><a href="aplikace3.html#cb1001-481" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-482"><a href="aplikace3.html#cb1001-482" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1001-483"><a href="aplikace3.html#cb1001-483" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1001-484"><a href="aplikace3.html#cb1001-484" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-485"><a href="aplikace3.html#cb1001-485" tabindex="-1"></a>  }</span>
<span id="cb1001-486"><a href="aplikace3.html#cb1001-486" tabindex="-1"></a>  </span>
<span id="cb1001-487"><a href="aplikace3.html#cb1001-487" tabindex="-1"></a>  <span class="do">### 7.0) SVM for functional data</span></span>
<span id="cb1001-488"><a href="aplikace3.html#cb1001-488" tabindex="-1"></a>  </span>
<span id="cb1001-489"><a href="aplikace3.html#cb1001-489" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1001-490"><a href="aplikace3.html#cb1001-490" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-491"><a href="aplikace3.html#cb1001-491" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-492"><a href="aplikace3.html#cb1001-492" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1001-493"><a href="aplikace3.html#cb1001-493" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1001-494"><a href="aplikace3.html#cb1001-494" tabindex="-1"></a>  </span>
<span id="cb1001-495"><a href="aplikace3.html#cb1001-495" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-496"><a href="aplikace3.html#cb1001-496" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-497"><a href="aplikace3.html#cb1001-497" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-498"><a href="aplikace3.html#cb1001-498" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1001-499"><a href="aplikace3.html#cb1001-499" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-500"><a href="aplikace3.html#cb1001-500" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1001-501"><a href="aplikace3.html#cb1001-501" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1001-502"><a href="aplikace3.html#cb1001-502" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1001-503"><a href="aplikace3.html#cb1001-503" tabindex="-1"></a>  )</span>
<span id="cb1001-504"><a href="aplikace3.html#cb1001-504" tabindex="-1"></a>  </span>
<span id="cb1001-505"><a href="aplikace3.html#cb1001-505" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1001-506"><a href="aplikace3.html#cb1001-506" tabindex="-1"></a>  <span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb1001-507"><a href="aplikace3.html#cb1001-507" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1001-508"><a href="aplikace3.html#cb1001-508" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-509"><a href="aplikace3.html#cb1001-509" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-510"><a href="aplikace3.html#cb1001-510" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-511"><a href="aplikace3.html#cb1001-511" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1001-512"><a href="aplikace3.html#cb1001-512" tabindex="-1"></a>      </span>
<span id="cb1001-513"><a href="aplikace3.html#cb1001-513" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb1001-514"><a href="aplikace3.html#cb1001-514" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb1001-515"><a href="aplikace3.html#cb1001-515" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb1001-516"><a href="aplikace3.html#cb1001-516" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb1001-517"><a href="aplikace3.html#cb1001-517" tabindex="-1"></a>      </span>
<span id="cb1001-518"><a href="aplikace3.html#cb1001-518" tabindex="-1"></a>      <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1001-519"><a href="aplikace3.html#cb1001-519" tabindex="-1"></a>      tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1001-520"><a href="aplikace3.html#cb1001-520" tabindex="-1"></a>      </span>
<span id="cb1001-521"><a href="aplikace3.html#cb1001-521" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb1001-522"><a href="aplikace3.html#cb1001-522" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1001-523"><a href="aplikace3.html#cb1001-523" tabindex="-1"></a>      <span class="co"># B-spline baze </span></span>
<span id="cb1001-524"><a href="aplikace3.html#cb1001-524" tabindex="-1"></a>      basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb1001-525"><a href="aplikace3.html#cb1001-525" tabindex="-1"></a>                                     <span class="at">norder =</span> <span class="dv">4</span>, <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb1001-526"><a href="aplikace3.html#cb1001-526" tabindex="-1"></a>      <span class="co"># formula</span></span>
<span id="cb1001-527"><a href="aplikace3.html#cb1001-527" tabindex="-1"></a>      f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb1001-528"><a href="aplikace3.html#cb1001-528" tabindex="-1"></a>      <span class="co"># baze pro x</span></span>
<span id="cb1001-529"><a href="aplikace3.html#cb1001-529" tabindex="-1"></a>      basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1001-530"><a href="aplikace3.html#cb1001-530" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb1001-531"><a href="aplikace3.html#cb1001-531" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb1001-532"><a href="aplikace3.html#cb1001-532" tabindex="-1"></a>      </span>
<span id="cb1001-533"><a href="aplikace3.html#cb1001-533" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1001-534"><a href="aplikace3.html#cb1001-534" tabindex="-1"></a>      <span class="co"># model SVM</span></span>
<span id="cb1001-535"><a href="aplikace3.html#cb1001-535" tabindex="-1"></a>      clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-536"><a href="aplikace3.html#cb1001-536" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1001-537"><a href="aplikace3.html#cb1001-537" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-538"><a href="aplikace3.html#cb1001-538" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1001-539"><a href="aplikace3.html#cb1001-539" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1001-540"><a href="aplikace3.html#cb1001-540" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-541"><a href="aplikace3.html#cb1001-541" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-542"><a href="aplikace3.html#cb1001-542" tabindex="-1"></a>        </span>
<span id="cb1001-543"><a href="aplikace3.html#cb1001-543" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-544"><a href="aplikace3.html#cb1001-544" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1001-545"><a href="aplikace3.html#cb1001-545" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-546"><a href="aplikace3.html#cb1001-546" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1001-547"><a href="aplikace3.html#cb1001-547" tabindex="-1"></a>      </span>
<span id="cb1001-548"><a href="aplikace3.html#cb1001-548" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1001-549"><a href="aplikace3.html#cb1001-549" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1001-550"><a href="aplikace3.html#cb1001-550" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1001-551"><a href="aplikace3.html#cb1001-551" tabindex="-1"></a>      </span>
<span id="cb1001-552"><a href="aplikace3.html#cb1001-552" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1001-553"><a href="aplikace3.html#cb1001-553" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1001-554"><a href="aplikace3.html#cb1001-554" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-555"><a href="aplikace3.html#cb1001-555" tabindex="-1"></a>        clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-556"><a href="aplikace3.html#cb1001-556" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1001-557"><a href="aplikace3.html#cb1001-557" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-558"><a href="aplikace3.html#cb1001-558" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1001-559"><a href="aplikace3.html#cb1001-559" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1001-560"><a href="aplikace3.html#cb1001-560" tabindex="-1"></a>                  <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-561"><a href="aplikace3.html#cb1001-561" tabindex="-1"></a>                  <span class="at">degree =</span> p,</span>
<span id="cb1001-562"><a href="aplikace3.html#cb1001-562" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-563"><a href="aplikace3.html#cb1001-563" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-564"><a href="aplikace3.html#cb1001-564" tabindex="-1"></a>          </span>
<span id="cb1001-565"><a href="aplikace3.html#cb1001-565" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-566"><a href="aplikace3.html#cb1001-566" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1001-567"><a href="aplikace3.html#cb1001-567" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-568"><a href="aplikace3.html#cb1001-568" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1001-569"><a href="aplikace3.html#cb1001-569" tabindex="-1"></a>        </span>
<span id="cb1001-570"><a href="aplikace3.html#cb1001-570" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1001-571"><a href="aplikace3.html#cb1001-571" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1001-572"><a href="aplikace3.html#cb1001-572" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1001-573"><a href="aplikace3.html#cb1001-573" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1001-574"><a href="aplikace3.html#cb1001-574" tabindex="-1"></a>      }</span>
<span id="cb1001-575"><a href="aplikace3.html#cb1001-575" tabindex="-1"></a>          </span>
<span id="cb1001-576"><a href="aplikace3.html#cb1001-576" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1001-577"><a href="aplikace3.html#cb1001-577" tabindex="-1"></a>      <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1001-578"><a href="aplikace3.html#cb1001-578" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-579"><a href="aplikace3.html#cb1001-579" tabindex="-1"></a>        clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-580"><a href="aplikace3.html#cb1001-580" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1001-581"><a href="aplikace3.html#cb1001-581" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-582"><a href="aplikace3.html#cb1001-582" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1001-583"><a href="aplikace3.html#cb1001-583" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1001-584"><a href="aplikace3.html#cb1001-584" tabindex="-1"></a>                  <span class="at">gamma =</span> gam.cv,</span>
<span id="cb1001-585"><a href="aplikace3.html#cb1001-585" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-586"><a href="aplikace3.html#cb1001-586" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-587"><a href="aplikace3.html#cb1001-587" tabindex="-1"></a>          </span>
<span id="cb1001-588"><a href="aplikace3.html#cb1001-588" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-589"><a href="aplikace3.html#cb1001-589" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1001-590"><a href="aplikace3.html#cb1001-590" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-591"><a href="aplikace3.html#cb1001-591" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1001-592"><a href="aplikace3.html#cb1001-592" tabindex="-1"></a>        </span>
<span id="cb1001-593"><a href="aplikace3.html#cb1001-593" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1001-594"><a href="aplikace3.html#cb1001-594" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1001-595"><a href="aplikace3.html#cb1001-595" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb1001-596"><a href="aplikace3.html#cb1001-596" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1001-597"><a href="aplikace3.html#cb1001-597" tabindex="-1"></a>      }</span>
<span id="cb1001-598"><a href="aplikace3.html#cb1001-598" tabindex="-1"></a>    }</span>
<span id="cb1001-599"><a href="aplikace3.html#cb1001-599" tabindex="-1"></a>  }</span>
<span id="cb1001-600"><a href="aplikace3.html#cb1001-600" tabindex="-1"></a>  </span>
<span id="cb1001-601"><a href="aplikace3.html#cb1001-601" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1001-602"><a href="aplikace3.html#cb1001-602" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1001-603"><a href="aplikace3.html#cb1001-603" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1001-604"><a href="aplikace3.html#cb1001-604" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1001-605"><a href="aplikace3.html#cb1001-605" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-606"><a href="aplikace3.html#cb1001-606" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1001-607"><a href="aplikace3.html#cb1001-607" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-608"><a href="aplikace3.html#cb1001-608" tabindex="-1"></a>  </span>
<span id="cb1001-609"><a href="aplikace3.html#cb1001-609" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-610"><a href="aplikace3.html#cb1001-610" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1001-611"><a href="aplikace3.html#cb1001-611" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1001-612"><a href="aplikace3.html#cb1001-612" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1001-613"><a href="aplikace3.html#cb1001-613" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1001-614"><a href="aplikace3.html#cb1001-614" tabindex="-1"></a>  </span>
<span id="cb1001-615"><a href="aplikace3.html#cb1001-615" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-616"><a href="aplikace3.html#cb1001-616" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-617"><a href="aplikace3.html#cb1001-617" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1001-618"><a href="aplikace3.html#cb1001-618" tabindex="-1"></a>  </span>
<span id="cb1001-619"><a href="aplikace3.html#cb1001-619" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-620"><a href="aplikace3.html#cb1001-620" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-621"><a href="aplikace3.html#cb1001-621" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1001-622"><a href="aplikace3.html#cb1001-622" tabindex="-1"></a>  </span>
<span id="cb1001-623"><a href="aplikace3.html#cb1001-623" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-624"><a href="aplikace3.html#cb1001-624" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-625"><a href="aplikace3.html#cb1001-625" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-626"><a href="aplikace3.html#cb1001-626" tabindex="-1"></a>  </span>
<span id="cb1001-627"><a href="aplikace3.html#cb1001-627" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb1001-628"><a href="aplikace3.html#cb1001-628" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb1001-629"><a href="aplikace3.html#cb1001-629" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb1001-630"><a href="aplikace3.html#cb1001-630" tabindex="-1"></a>  </span>
<span id="cb1001-631"><a href="aplikace3.html#cb1001-631" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1001-632"><a href="aplikace3.html#cb1001-632" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1001-633"><a href="aplikace3.html#cb1001-633" tabindex="-1"></a>  </span>
<span id="cb1001-634"><a href="aplikace3.html#cb1001-634" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1001-635"><a href="aplikace3.html#cb1001-635" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1001-636"><a href="aplikace3.html#cb1001-636" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb1001-637"><a href="aplikace3.html#cb1001-637" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb1001-638"><a href="aplikace3.html#cb1001-638" tabindex="-1"></a>  </span>
<span id="cb1001-639"><a href="aplikace3.html#cb1001-639" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb1001-640"><a href="aplikace3.html#cb1001-640" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb1001-641"><a href="aplikace3.html#cb1001-641" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb1001-642"><a href="aplikace3.html#cb1001-642" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1001-643"><a href="aplikace3.html#cb1001-643" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb1001-644"><a href="aplikace3.html#cb1001-644" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1001-645"><a href="aplikace3.html#cb1001-645" tabindex="-1"></a>  </span>
<span id="cb1001-646"><a href="aplikace3.html#cb1001-646" tabindex="-1"></a>  model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-647"><a href="aplikace3.html#cb1001-647" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1001-648"><a href="aplikace3.html#cb1001-648" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-649"><a href="aplikace3.html#cb1001-649" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb1001-650"><a href="aplikace3.html#cb1001-650" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-651"><a href="aplikace3.html#cb1001-651" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-652"><a href="aplikace3.html#cb1001-652" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb1001-653"><a href="aplikace3.html#cb1001-653" tabindex="-1"></a>  </span>
<span id="cb1001-654"><a href="aplikace3.html#cb1001-654" tabindex="-1"></a>  model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-655"><a href="aplikace3.html#cb1001-655" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1001-656"><a href="aplikace3.html#cb1001-656" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-657"><a href="aplikace3.html#cb1001-657" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb1001-658"><a href="aplikace3.html#cb1001-658" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-659"><a href="aplikace3.html#cb1001-659" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-660"><a href="aplikace3.html#cb1001-660" tabindex="-1"></a>              <span class="at">degree =</span> p.opt,</span>
<span id="cb1001-661"><a href="aplikace3.html#cb1001-661" tabindex="-1"></a>              <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-662"><a href="aplikace3.html#cb1001-662" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb1001-663"><a href="aplikace3.html#cb1001-663" tabindex="-1"></a>  </span>
<span id="cb1001-664"><a href="aplikace3.html#cb1001-664" tabindex="-1"></a>  model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1001-665"><a href="aplikace3.html#cb1001-665" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1001-666"><a href="aplikace3.html#cb1001-666" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1001-667"><a href="aplikace3.html#cb1001-667" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb1001-668"><a href="aplikace3.html#cb1001-668" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-669"><a href="aplikace3.html#cb1001-669" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-670"><a href="aplikace3.html#cb1001-670" tabindex="-1"></a>              <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1001-671"><a href="aplikace3.html#cb1001-671" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb1001-672"><a href="aplikace3.html#cb1001-672" tabindex="-1"></a>  </span>
<span id="cb1001-673"><a href="aplikace3.html#cb1001-673" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-674"><a href="aplikace3.html#cb1001-674" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1001-675"><a href="aplikace3.html#cb1001-675" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-676"><a href="aplikace3.html#cb1001-676" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb1001-677"><a href="aplikace3.html#cb1001-677" tabindex="-1"></a>  </span>
<span id="cb1001-678"><a href="aplikace3.html#cb1001-678" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-679"><a href="aplikace3.html#cb1001-679" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb1001-680"><a href="aplikace3.html#cb1001-680" tabindex="-1"></a>  </span>
<span id="cb1001-681"><a href="aplikace3.html#cb1001-681" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-682"><a href="aplikace3.html#cb1001-682" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb1001-683"><a href="aplikace3.html#cb1001-683" tabindex="-1"></a>    </span>
<span id="cb1001-684"><a href="aplikace3.html#cb1001-684" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-685"><a href="aplikace3.html#cb1001-685" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb1001-686"><a href="aplikace3.html#cb1001-686" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-687"><a href="aplikace3.html#cb1001-687" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb1001-688"><a href="aplikace3.html#cb1001-688" tabindex="-1"></a>  </span>
<span id="cb1001-689"><a href="aplikace3.html#cb1001-689" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-690"><a href="aplikace3.html#cb1001-690" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb1001-691"><a href="aplikace3.html#cb1001-691" tabindex="-1"></a>  </span>
<span id="cb1001-692"><a href="aplikace3.html#cb1001-692" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1001-693"><a href="aplikace3.html#cb1001-693" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span>
<span id="cb1001-694"><a href="aplikace3.html#cb1001-694" tabindex="-1"></a>  </span>
<span id="cb1001-695"><a href="aplikace3.html#cb1001-695" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb1001-696"><a href="aplikace3.html#cb1001-696" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb1001-697"><a href="aplikace3.html#cb1001-697" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb1001-698"><a href="aplikace3.html#cb1001-698" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb1001-699"><a href="aplikace3.html#cb1001-699" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb1001-700"><a href="aplikace3.html#cb1001-700" tabindex="-1"></a>  </span>
<span id="cb1001-701"><a href="aplikace3.html#cb1001-701" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-702"><a href="aplikace3.html#cb1001-702" tabindex="-1"></a>  </span>
<span id="cb1001-703"><a href="aplikace3.html#cb1001-703" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb1001-704"><a href="aplikace3.html#cb1001-704" tabindex="-1"></a>  </span>
<span id="cb1001-705"><a href="aplikace3.html#cb1001-705" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1001-706"><a href="aplikace3.html#cb1001-706" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-707"><a href="aplikace3.html#cb1001-707" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-708"><a href="aplikace3.html#cb1001-708" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1001-709"><a href="aplikace3.html#cb1001-709" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1001-710"><a href="aplikace3.html#cb1001-710" tabindex="-1"></a>  </span>
<span id="cb1001-711"><a href="aplikace3.html#cb1001-711" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-712"><a href="aplikace3.html#cb1001-712" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-713"><a href="aplikace3.html#cb1001-713" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-714"><a href="aplikace3.html#cb1001-714" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1001-715"><a href="aplikace3.html#cb1001-715" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-716"><a href="aplikace3.html#cb1001-716" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1001-717"><a href="aplikace3.html#cb1001-717" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1001-718"><a href="aplikace3.html#cb1001-718" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1001-719"><a href="aplikace3.html#cb1001-719" tabindex="-1"></a>  )</span>
<span id="cb1001-720"><a href="aplikace3.html#cb1001-720" tabindex="-1"></a>  </span>
<span id="cb1001-721"><a href="aplikace3.html#cb1001-721" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1001-722"><a href="aplikace3.html#cb1001-722" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1001-723"><a href="aplikace3.html#cb1001-723" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1001-724"><a href="aplikace3.html#cb1001-724" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-725"><a href="aplikace3.html#cb1001-725" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-726"><a href="aplikace3.html#cb1001-726" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-727"><a href="aplikace3.html#cb1001-727" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1001-728"><a href="aplikace3.html#cb1001-728" tabindex="-1"></a>      </span>
<span id="cb1001-729"><a href="aplikace3.html#cb1001-729" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb1001-730"><a href="aplikace3.html#cb1001-730" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1001-731"><a href="aplikace3.html#cb1001-731" tabindex="-1"></a>      </span>
<span id="cb1001-732"><a href="aplikace3.html#cb1001-732" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1001-733"><a href="aplikace3.html#cb1001-733" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-734"><a href="aplikace3.html#cb1001-734" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1001-735"><a href="aplikace3.html#cb1001-735" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-736"><a href="aplikace3.html#cb1001-736" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-737"><a href="aplikace3.html#cb1001-737" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1001-738"><a href="aplikace3.html#cb1001-738" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-739"><a href="aplikace3.html#cb1001-739" tabindex="-1"></a>      </span>
<span id="cb1001-740"><a href="aplikace3.html#cb1001-740" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-741"><a href="aplikace3.html#cb1001-741" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1001-742"><a href="aplikace3.html#cb1001-742" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-743"><a href="aplikace3.html#cb1001-743" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-744"><a href="aplikace3.html#cb1001-744" tabindex="-1"></a>      </span>
<span id="cb1001-745"><a href="aplikace3.html#cb1001-745" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1001-746"><a href="aplikace3.html#cb1001-746" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-747"><a href="aplikace3.html#cb1001-747" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1001-748"><a href="aplikace3.html#cb1001-748" tabindex="-1"></a>      </span>
<span id="cb1001-749"><a href="aplikace3.html#cb1001-749" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1001-750"><a href="aplikace3.html#cb1001-750" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1001-751"><a href="aplikace3.html#cb1001-751" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-752"><a href="aplikace3.html#cb1001-752" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1001-753"><a href="aplikace3.html#cb1001-753" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-754"><a href="aplikace3.html#cb1001-754" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-755"><a href="aplikace3.html#cb1001-755" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-756"><a href="aplikace3.html#cb1001-756" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-757"><a href="aplikace3.html#cb1001-757" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1001-758"><a href="aplikace3.html#cb1001-758" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-759"><a href="aplikace3.html#cb1001-759" tabindex="-1"></a>        </span>
<span id="cb1001-760"><a href="aplikace3.html#cb1001-760" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-761"><a href="aplikace3.html#cb1001-761" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb1001-762"><a href="aplikace3.html#cb1001-762" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1001-763"><a href="aplikace3.html#cb1001-763" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-764"><a href="aplikace3.html#cb1001-764" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-765"><a href="aplikace3.html#cb1001-765" tabindex="-1"></a>        </span>
<span id="cb1001-766"><a href="aplikace3.html#cb1001-766" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1001-767"><a href="aplikace3.html#cb1001-767" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-768"><a href="aplikace3.html#cb1001-768" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1001-769"><a href="aplikace3.html#cb1001-769" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1001-770"><a href="aplikace3.html#cb1001-770" tabindex="-1"></a>      }</span>
<span id="cb1001-771"><a href="aplikace3.html#cb1001-771" tabindex="-1"></a>          </span>
<span id="cb1001-772"><a href="aplikace3.html#cb1001-772" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1001-773"><a href="aplikace3.html#cb1001-773" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1001-774"><a href="aplikace3.html#cb1001-774" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-775"><a href="aplikace3.html#cb1001-775" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1001-776"><a href="aplikace3.html#cb1001-776" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-777"><a href="aplikace3.html#cb1001-777" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-778"><a href="aplikace3.html#cb1001-778" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-779"><a href="aplikace3.html#cb1001-779" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1001-780"><a href="aplikace3.html#cb1001-780" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-781"><a href="aplikace3.html#cb1001-781" tabindex="-1"></a>        </span>
<span id="cb1001-782"><a href="aplikace3.html#cb1001-782" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-783"><a href="aplikace3.html#cb1001-783" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1001-784"><a href="aplikace3.html#cb1001-784" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-785"><a href="aplikace3.html#cb1001-785" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-786"><a href="aplikace3.html#cb1001-786" tabindex="-1"></a>        </span>
<span id="cb1001-787"><a href="aplikace3.html#cb1001-787" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1001-788"><a href="aplikace3.html#cb1001-788" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-789"><a href="aplikace3.html#cb1001-789" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1001-790"><a href="aplikace3.html#cb1001-790" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1001-791"><a href="aplikace3.html#cb1001-791" tabindex="-1"></a>      }</span>
<span id="cb1001-792"><a href="aplikace3.html#cb1001-792" tabindex="-1"></a>    }</span>
<span id="cb1001-793"><a href="aplikace3.html#cb1001-793" tabindex="-1"></a>  }</span>
<span id="cb1001-794"><a href="aplikace3.html#cb1001-794" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1001-795"><a href="aplikace3.html#cb1001-795" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1001-796"><a href="aplikace3.html#cb1001-796" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1001-797"><a href="aplikace3.html#cb1001-797" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1001-798"><a href="aplikace3.html#cb1001-798" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-799"><a href="aplikace3.html#cb1001-799" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1001-800"><a href="aplikace3.html#cb1001-800" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-801"><a href="aplikace3.html#cb1001-801" tabindex="-1"></a>  </span>
<span id="cb1001-802"><a href="aplikace3.html#cb1001-802" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-803"><a href="aplikace3.html#cb1001-803" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1001-804"><a href="aplikace3.html#cb1001-804" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1001-805"><a href="aplikace3.html#cb1001-805" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1001-806"><a href="aplikace3.html#cb1001-806" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1001-807"><a href="aplikace3.html#cb1001-807" tabindex="-1"></a>  </span>
<span id="cb1001-808"><a href="aplikace3.html#cb1001-808" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-809"><a href="aplikace3.html#cb1001-809" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-810"><a href="aplikace3.html#cb1001-810" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1001-811"><a href="aplikace3.html#cb1001-811" tabindex="-1"></a>  </span>
<span id="cb1001-812"><a href="aplikace3.html#cb1001-812" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-813"><a href="aplikace3.html#cb1001-813" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-814"><a href="aplikace3.html#cb1001-814" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1001-815"><a href="aplikace3.html#cb1001-815" tabindex="-1"></a>  </span>
<span id="cb1001-816"><a href="aplikace3.html#cb1001-816" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-817"><a href="aplikace3.html#cb1001-817" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-818"><a href="aplikace3.html#cb1001-818" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-819"><a href="aplikace3.html#cb1001-819" tabindex="-1"></a>  </span>
<span id="cb1001-820"><a href="aplikace3.html#cb1001-820" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-821"><a href="aplikace3.html#cb1001-821" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1001-822"><a href="aplikace3.html#cb1001-822" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-823"><a href="aplikace3.html#cb1001-823" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-824"><a href="aplikace3.html#cb1001-824" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1001-825"><a href="aplikace3.html#cb1001-825" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-826"><a href="aplikace3.html#cb1001-826" tabindex="-1"></a>  </span>
<span id="cb1001-827"><a href="aplikace3.html#cb1001-827" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1001-828"><a href="aplikace3.html#cb1001-828" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-829"><a href="aplikace3.html#cb1001-829" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-830"><a href="aplikace3.html#cb1001-830" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1001-831"><a href="aplikace3.html#cb1001-831" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb1001-832"><a href="aplikace3.html#cb1001-832" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-833"><a href="aplikace3.html#cb1001-833" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-834"><a href="aplikace3.html#cb1001-834" tabindex="-1"></a>  </span>
<span id="cb1001-835"><a href="aplikace3.html#cb1001-835" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1001-836"><a href="aplikace3.html#cb1001-836" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-837"><a href="aplikace3.html#cb1001-837" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1001-838"><a href="aplikace3.html#cb1001-838" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1001-839"><a href="aplikace3.html#cb1001-839" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1001-840"><a href="aplikace3.html#cb1001-840" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-841"><a href="aplikace3.html#cb1001-841" tabindex="-1"></a>  </span>
<span id="cb1001-842"><a href="aplikace3.html#cb1001-842" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-843"><a href="aplikace3.html#cb1001-843" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1001-844"><a href="aplikace3.html#cb1001-844" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-845"><a href="aplikace3.html#cb1001-845" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-846"><a href="aplikace3.html#cb1001-846" tabindex="-1"></a>  </span>
<span id="cb1001-847"><a href="aplikace3.html#cb1001-847" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1001-848"><a href="aplikace3.html#cb1001-848" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-849"><a href="aplikace3.html#cb1001-849" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-850"><a href="aplikace3.html#cb1001-850" tabindex="-1"></a>  </span>
<span id="cb1001-851"><a href="aplikace3.html#cb1001-851" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1001-852"><a href="aplikace3.html#cb1001-852" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-853"><a href="aplikace3.html#cb1001-853" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-854"><a href="aplikace3.html#cb1001-854" tabindex="-1"></a>  </span>
<span id="cb1001-855"><a href="aplikace3.html#cb1001-855" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-856"><a href="aplikace3.html#cb1001-856" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1001-857"><a href="aplikace3.html#cb1001-857" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-858"><a href="aplikace3.html#cb1001-858" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-859"><a href="aplikace3.html#cb1001-859" tabindex="-1"></a>  </span>
<span id="cb1001-860"><a href="aplikace3.html#cb1001-860" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1001-861"><a href="aplikace3.html#cb1001-861" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-862"><a href="aplikace3.html#cb1001-862" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-863"><a href="aplikace3.html#cb1001-863" tabindex="-1"></a>  </span>
<span id="cb1001-864"><a href="aplikace3.html#cb1001-864" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1001-865"><a href="aplikace3.html#cb1001-865" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-866"><a href="aplikace3.html#cb1001-866" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-867"><a href="aplikace3.html#cb1001-867" tabindex="-1"></a>  </span>
<span id="cb1001-868"><a href="aplikace3.html#cb1001-868" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb1001-869"><a href="aplikace3.html#cb1001-869" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb1001-870"><a href="aplikace3.html#cb1001-870" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb1001-871"><a href="aplikace3.html#cb1001-871" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb1001-872"><a href="aplikace3.html#cb1001-872" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1001-873"><a href="aplikace3.html#cb1001-873" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1001-874"><a href="aplikace3.html#cb1001-874" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1001-875"><a href="aplikace3.html#cb1001-875" tabindex="-1"></a>  </span>
<span id="cb1001-876"><a href="aplikace3.html#cb1001-876" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-877"><a href="aplikace3.html#cb1001-877" tabindex="-1"></a>  </span>
<span id="cb1001-878"><a href="aplikace3.html#cb1001-878" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb1001-879"><a href="aplikace3.html#cb1001-879" tabindex="-1"></a>  </span>
<span id="cb1001-880"><a href="aplikace3.html#cb1001-880" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1001-881"><a href="aplikace3.html#cb1001-881" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-882"><a href="aplikace3.html#cb1001-882" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-883"><a href="aplikace3.html#cb1001-883" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1001-884"><a href="aplikace3.html#cb1001-884" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1001-885"><a href="aplikace3.html#cb1001-885" tabindex="-1"></a>  </span>
<span id="cb1001-886"><a href="aplikace3.html#cb1001-886" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-887"><a href="aplikace3.html#cb1001-887" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-888"><a href="aplikace3.html#cb1001-888" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-889"><a href="aplikace3.html#cb1001-889" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1001-890"><a href="aplikace3.html#cb1001-890" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-891"><a href="aplikace3.html#cb1001-891" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1001-892"><a href="aplikace3.html#cb1001-892" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1001-893"><a href="aplikace3.html#cb1001-893" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1001-894"><a href="aplikace3.html#cb1001-894" tabindex="-1"></a>  )</span>
<span id="cb1001-895"><a href="aplikace3.html#cb1001-895" tabindex="-1"></a>  </span>
<span id="cb1001-896"><a href="aplikace3.html#cb1001-896" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1001-897"><a href="aplikace3.html#cb1001-897" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1001-898"><a href="aplikace3.html#cb1001-898" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1001-899"><a href="aplikace3.html#cb1001-899" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-900"><a href="aplikace3.html#cb1001-900" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-901"><a href="aplikace3.html#cb1001-901" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-902"><a href="aplikace3.html#cb1001-902" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1001-903"><a href="aplikace3.html#cb1001-903" tabindex="-1"></a>      </span>
<span id="cb1001-904"><a href="aplikace3.html#cb1001-904" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb1001-905"><a href="aplikace3.html#cb1001-905" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1001-906"><a href="aplikace3.html#cb1001-906" tabindex="-1"></a>      </span>
<span id="cb1001-907"><a href="aplikace3.html#cb1001-907" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1001-908"><a href="aplikace3.html#cb1001-908" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-909"><a href="aplikace3.html#cb1001-909" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1001-910"><a href="aplikace3.html#cb1001-910" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-911"><a href="aplikace3.html#cb1001-911" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-912"><a href="aplikace3.html#cb1001-912" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1001-913"><a href="aplikace3.html#cb1001-913" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-914"><a href="aplikace3.html#cb1001-914" tabindex="-1"></a>      </span>
<span id="cb1001-915"><a href="aplikace3.html#cb1001-915" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-916"><a href="aplikace3.html#cb1001-916" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1001-917"><a href="aplikace3.html#cb1001-917" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-918"><a href="aplikace3.html#cb1001-918" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-919"><a href="aplikace3.html#cb1001-919" tabindex="-1"></a>      </span>
<span id="cb1001-920"><a href="aplikace3.html#cb1001-920" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1001-921"><a href="aplikace3.html#cb1001-921" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-922"><a href="aplikace3.html#cb1001-922" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1001-923"><a href="aplikace3.html#cb1001-923" tabindex="-1"></a>      </span>
<span id="cb1001-924"><a href="aplikace3.html#cb1001-924" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1001-925"><a href="aplikace3.html#cb1001-925" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1001-926"><a href="aplikace3.html#cb1001-926" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-927"><a href="aplikace3.html#cb1001-927" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1001-928"><a href="aplikace3.html#cb1001-928" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-929"><a href="aplikace3.html#cb1001-929" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-930"><a href="aplikace3.html#cb1001-930" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-931"><a href="aplikace3.html#cb1001-931" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-932"><a href="aplikace3.html#cb1001-932" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1001-933"><a href="aplikace3.html#cb1001-933" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-934"><a href="aplikace3.html#cb1001-934" tabindex="-1"></a>        </span>
<span id="cb1001-935"><a href="aplikace3.html#cb1001-935" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-936"><a href="aplikace3.html#cb1001-936" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1001-937"><a href="aplikace3.html#cb1001-937" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-938"><a href="aplikace3.html#cb1001-938" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-939"><a href="aplikace3.html#cb1001-939" tabindex="-1"></a>        </span>
<span id="cb1001-940"><a href="aplikace3.html#cb1001-940" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1001-941"><a href="aplikace3.html#cb1001-941" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-942"><a href="aplikace3.html#cb1001-942" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1001-943"><a href="aplikace3.html#cb1001-943" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1001-944"><a href="aplikace3.html#cb1001-944" tabindex="-1"></a>      }</span>
<span id="cb1001-945"><a href="aplikace3.html#cb1001-945" tabindex="-1"></a>          </span>
<span id="cb1001-946"><a href="aplikace3.html#cb1001-946" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1001-947"><a href="aplikace3.html#cb1001-947" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1001-948"><a href="aplikace3.html#cb1001-948" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-949"><a href="aplikace3.html#cb1001-949" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1001-950"><a href="aplikace3.html#cb1001-950" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-951"><a href="aplikace3.html#cb1001-951" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-952"><a href="aplikace3.html#cb1001-952" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-953"><a href="aplikace3.html#cb1001-953" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1001-954"><a href="aplikace3.html#cb1001-954" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-955"><a href="aplikace3.html#cb1001-955" tabindex="-1"></a>        </span>
<span id="cb1001-956"><a href="aplikace3.html#cb1001-956" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-957"><a href="aplikace3.html#cb1001-957" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1001-958"><a href="aplikace3.html#cb1001-958" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-959"><a href="aplikace3.html#cb1001-959" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-960"><a href="aplikace3.html#cb1001-960" tabindex="-1"></a>        </span>
<span id="cb1001-961"><a href="aplikace3.html#cb1001-961" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1001-962"><a href="aplikace3.html#cb1001-962" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-963"><a href="aplikace3.html#cb1001-963" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1001-964"><a href="aplikace3.html#cb1001-964" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1001-965"><a href="aplikace3.html#cb1001-965" tabindex="-1"></a>      }</span>
<span id="cb1001-966"><a href="aplikace3.html#cb1001-966" tabindex="-1"></a>    }</span>
<span id="cb1001-967"><a href="aplikace3.html#cb1001-967" tabindex="-1"></a>  }</span>
<span id="cb1001-968"><a href="aplikace3.html#cb1001-968" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1001-969"><a href="aplikace3.html#cb1001-969" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1001-970"><a href="aplikace3.html#cb1001-970" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1001-971"><a href="aplikace3.html#cb1001-971" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1001-972"><a href="aplikace3.html#cb1001-972" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-973"><a href="aplikace3.html#cb1001-973" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1001-974"><a href="aplikace3.html#cb1001-974" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-975"><a href="aplikace3.html#cb1001-975" tabindex="-1"></a>  </span>
<span id="cb1001-976"><a href="aplikace3.html#cb1001-976" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-977"><a href="aplikace3.html#cb1001-977" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1001-978"><a href="aplikace3.html#cb1001-978" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1001-979"><a href="aplikace3.html#cb1001-979" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1001-980"><a href="aplikace3.html#cb1001-980" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1001-981"><a href="aplikace3.html#cb1001-981" tabindex="-1"></a>  </span>
<span id="cb1001-982"><a href="aplikace3.html#cb1001-982" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-983"><a href="aplikace3.html#cb1001-983" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-984"><a href="aplikace3.html#cb1001-984" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1001-985"><a href="aplikace3.html#cb1001-985" tabindex="-1"></a>  </span>
<span id="cb1001-986"><a href="aplikace3.html#cb1001-986" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-987"><a href="aplikace3.html#cb1001-987" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-988"><a href="aplikace3.html#cb1001-988" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1001-989"><a href="aplikace3.html#cb1001-989" tabindex="-1"></a>  </span>
<span id="cb1001-990"><a href="aplikace3.html#cb1001-990" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-991"><a href="aplikace3.html#cb1001-991" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-992"><a href="aplikace3.html#cb1001-992" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-993"><a href="aplikace3.html#cb1001-993" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-994"><a href="aplikace3.html#cb1001-994" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1001-995"><a href="aplikace3.html#cb1001-995" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-996"><a href="aplikace3.html#cb1001-996" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-997"><a href="aplikace3.html#cb1001-997" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1001-998"><a href="aplikace3.html#cb1001-998" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-999"><a href="aplikace3.html#cb1001-999" tabindex="-1"></a>  </span>
<span id="cb1001-1000"><a href="aplikace3.html#cb1001-1000" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1001-1001"><a href="aplikace3.html#cb1001-1001" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1002"><a href="aplikace3.html#cb1001-1002" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1003"><a href="aplikace3.html#cb1001-1003" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1001-1004"><a href="aplikace3.html#cb1001-1004" tabindex="-1"></a>                       <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1005"><a href="aplikace3.html#cb1001-1005" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb1001-1006"><a href="aplikace3.html#cb1001-1006" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-1007"><a href="aplikace3.html#cb1001-1007" tabindex="-1"></a>  </span>
<span id="cb1001-1008"><a href="aplikace3.html#cb1001-1008" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1001-1009"><a href="aplikace3.html#cb1001-1009" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1010"><a href="aplikace3.html#cb1001-1010" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1011"><a href="aplikace3.html#cb1001-1011" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1001-1012"><a href="aplikace3.html#cb1001-1012" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1001-1013"><a href="aplikace3.html#cb1001-1013" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-1014"><a href="aplikace3.html#cb1001-1014" tabindex="-1"></a>  </span>
<span id="cb1001-1015"><a href="aplikace3.html#cb1001-1015" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1016"><a href="aplikace3.html#cb1001-1016" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-1017"><a href="aplikace3.html#cb1001-1017" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1018"><a href="aplikace3.html#cb1001-1018" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1019"><a href="aplikace3.html#cb1001-1019" tabindex="-1"></a>  </span>
<span id="cb1001-1020"><a href="aplikace3.html#cb1001-1020" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-1021"><a href="aplikace3.html#cb1001-1021" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1022"><a href="aplikace3.html#cb1001-1022" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1023"><a href="aplikace3.html#cb1001-1023" tabindex="-1"></a>  </span>
<span id="cb1001-1024"><a href="aplikace3.html#cb1001-1024" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1001-1025"><a href="aplikace3.html#cb1001-1025" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1026"><a href="aplikace3.html#cb1001-1026" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1027"><a href="aplikace3.html#cb1001-1027" tabindex="-1"></a>    </span>
<span id="cb1001-1028"><a href="aplikace3.html#cb1001-1028" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-1029"><a href="aplikace3.html#cb1001-1029" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-1030"><a href="aplikace3.html#cb1001-1030" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1031"><a href="aplikace3.html#cb1001-1031" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1032"><a href="aplikace3.html#cb1001-1032" tabindex="-1"></a>  </span>
<span id="cb1001-1033"><a href="aplikace3.html#cb1001-1033" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-1034"><a href="aplikace3.html#cb1001-1034" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1035"><a href="aplikace3.html#cb1001-1035" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1036"><a href="aplikace3.html#cb1001-1036" tabindex="-1"></a>  </span>
<span id="cb1001-1037"><a href="aplikace3.html#cb1001-1037" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1001-1038"><a href="aplikace3.html#cb1001-1038" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1039"><a href="aplikace3.html#cb1001-1039" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1040"><a href="aplikace3.html#cb1001-1040" tabindex="-1"></a>  </span>
<span id="cb1001-1041"><a href="aplikace3.html#cb1001-1041" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb1001-1042"><a href="aplikace3.html#cb1001-1042" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb1001-1043"><a href="aplikace3.html#cb1001-1043" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb1001-1044"><a href="aplikace3.html#cb1001-1044" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb1001-1045"><a href="aplikace3.html#cb1001-1045" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1001-1046"><a href="aplikace3.html#cb1001-1046" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1001-1047"><a href="aplikace3.html#cb1001-1047" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1001-1048"><a href="aplikace3.html#cb1001-1048" tabindex="-1"></a>  </span>
<span id="cb1001-1049"><a href="aplikace3.html#cb1001-1049" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-1050"><a href="aplikace3.html#cb1001-1050" tabindex="-1"></a>  </span>
<span id="cb1001-1051"><a href="aplikace3.html#cb1001-1051" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb1001-1052"><a href="aplikace3.html#cb1001-1052" tabindex="-1"></a>  </span>
<span id="cb1001-1053"><a href="aplikace3.html#cb1001-1053" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1001-1054"><a href="aplikace3.html#cb1001-1054" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-1055"><a href="aplikace3.html#cb1001-1055" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1001-1056"><a href="aplikace3.html#cb1001-1056" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1001-1057"><a href="aplikace3.html#cb1001-1057" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1001-1058"><a href="aplikace3.html#cb1001-1058" tabindex="-1"></a>  </span>
<span id="cb1001-1059"><a href="aplikace3.html#cb1001-1059" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-1060"><a href="aplikace3.html#cb1001-1060" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-1061"><a href="aplikace3.html#cb1001-1061" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-1062"><a href="aplikace3.html#cb1001-1062" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1001-1063"><a href="aplikace3.html#cb1001-1063" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-1064"><a href="aplikace3.html#cb1001-1064" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1001-1065"><a href="aplikace3.html#cb1001-1065" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1001-1066"><a href="aplikace3.html#cb1001-1066" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1001-1067"><a href="aplikace3.html#cb1001-1067" tabindex="-1"></a>  )</span>
<span id="cb1001-1068"><a href="aplikace3.html#cb1001-1068" tabindex="-1"></a>  </span>
<span id="cb1001-1069"><a href="aplikace3.html#cb1001-1069" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1001-1070"><a href="aplikace3.html#cb1001-1070" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1001-1071"><a href="aplikace3.html#cb1001-1071" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1001-1072"><a href="aplikace3.html#cb1001-1072" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-1073"><a href="aplikace3.html#cb1001-1073" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-1074"><a href="aplikace3.html#cb1001-1074" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-1075"><a href="aplikace3.html#cb1001-1075" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1001-1076"><a href="aplikace3.html#cb1001-1076" tabindex="-1"></a>      </span>
<span id="cb1001-1077"><a href="aplikace3.html#cb1001-1077" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb1001-1078"><a href="aplikace3.html#cb1001-1078" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1001-1079"><a href="aplikace3.html#cb1001-1079" tabindex="-1"></a>      </span>
<span id="cb1001-1080"><a href="aplikace3.html#cb1001-1080" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1001-1081"><a href="aplikace3.html#cb1001-1081" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1082"><a href="aplikace3.html#cb1001-1082" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1001-1083"><a href="aplikace3.html#cb1001-1083" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1084"><a href="aplikace3.html#cb1001-1084" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1085"><a href="aplikace3.html#cb1001-1085" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1001-1086"><a href="aplikace3.html#cb1001-1086" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-1087"><a href="aplikace3.html#cb1001-1087" tabindex="-1"></a>      </span>
<span id="cb1001-1088"><a href="aplikace3.html#cb1001-1088" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1089"><a href="aplikace3.html#cb1001-1089" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1001-1090"><a href="aplikace3.html#cb1001-1090" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1091"><a href="aplikace3.html#cb1001-1091" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1092"><a href="aplikace3.html#cb1001-1092" tabindex="-1"></a>      </span>
<span id="cb1001-1093"><a href="aplikace3.html#cb1001-1093" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1001-1094"><a href="aplikace3.html#cb1001-1094" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-1095"><a href="aplikace3.html#cb1001-1095" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1001-1096"><a href="aplikace3.html#cb1001-1096" tabindex="-1"></a>      </span>
<span id="cb1001-1097"><a href="aplikace3.html#cb1001-1097" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1001-1098"><a href="aplikace3.html#cb1001-1098" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1001-1099"><a href="aplikace3.html#cb1001-1099" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1100"><a href="aplikace3.html#cb1001-1100" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1001-1101"><a href="aplikace3.html#cb1001-1101" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1102"><a href="aplikace3.html#cb1001-1102" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1103"><a href="aplikace3.html#cb1001-1103" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-1104"><a href="aplikace3.html#cb1001-1104" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1001-1105"><a href="aplikace3.html#cb1001-1105" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1001-1106"><a href="aplikace3.html#cb1001-1106" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-1107"><a href="aplikace3.html#cb1001-1107" tabindex="-1"></a>        </span>
<span id="cb1001-1108"><a href="aplikace3.html#cb1001-1108" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1109"><a href="aplikace3.html#cb1001-1109" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb1001-1110"><a href="aplikace3.html#cb1001-1110" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1001-1111"><a href="aplikace3.html#cb1001-1111" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1112"><a href="aplikace3.html#cb1001-1112" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1113"><a href="aplikace3.html#cb1001-1113" tabindex="-1"></a>        </span>
<span id="cb1001-1114"><a href="aplikace3.html#cb1001-1114" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1001-1115"><a href="aplikace3.html#cb1001-1115" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-1116"><a href="aplikace3.html#cb1001-1116" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1001-1117"><a href="aplikace3.html#cb1001-1117" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1001-1118"><a href="aplikace3.html#cb1001-1118" tabindex="-1"></a>      }</span>
<span id="cb1001-1119"><a href="aplikace3.html#cb1001-1119" tabindex="-1"></a>          </span>
<span id="cb1001-1120"><a href="aplikace3.html#cb1001-1120" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1001-1121"><a href="aplikace3.html#cb1001-1121" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1001-1122"><a href="aplikace3.html#cb1001-1122" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1123"><a href="aplikace3.html#cb1001-1123" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1001-1124"><a href="aplikace3.html#cb1001-1124" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1125"><a href="aplikace3.html#cb1001-1125" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1126"><a href="aplikace3.html#cb1001-1126" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1001-1127"><a href="aplikace3.html#cb1001-1127" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1001-1128"><a href="aplikace3.html#cb1001-1128" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-1129"><a href="aplikace3.html#cb1001-1129" tabindex="-1"></a>        </span>
<span id="cb1001-1130"><a href="aplikace3.html#cb1001-1130" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1131"><a href="aplikace3.html#cb1001-1131" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb1001-1132"><a href="aplikace3.html#cb1001-1132" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1001-1133"><a href="aplikace3.html#cb1001-1133" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1134"><a href="aplikace3.html#cb1001-1134" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1135"><a href="aplikace3.html#cb1001-1135" tabindex="-1"></a>        </span>
<span id="cb1001-1136"><a href="aplikace3.html#cb1001-1136" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1001-1137"><a href="aplikace3.html#cb1001-1137" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1001-1138"><a href="aplikace3.html#cb1001-1138" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1001-1139"><a href="aplikace3.html#cb1001-1139" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1001-1140"><a href="aplikace3.html#cb1001-1140" tabindex="-1"></a>      }</span>
<span id="cb1001-1141"><a href="aplikace3.html#cb1001-1141" tabindex="-1"></a>    }</span>
<span id="cb1001-1142"><a href="aplikace3.html#cb1001-1142" tabindex="-1"></a>  }</span>
<span id="cb1001-1143"><a href="aplikace3.html#cb1001-1143" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1001-1144"><a href="aplikace3.html#cb1001-1144" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1001-1145"><a href="aplikace3.html#cb1001-1145" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1001-1146"><a href="aplikace3.html#cb1001-1146" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1001-1147"><a href="aplikace3.html#cb1001-1147" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-1148"><a href="aplikace3.html#cb1001-1148" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1001-1149"><a href="aplikace3.html#cb1001-1149" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-1150"><a href="aplikace3.html#cb1001-1150" tabindex="-1"></a>  </span>
<span id="cb1001-1151"><a href="aplikace3.html#cb1001-1151" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-1152"><a href="aplikace3.html#cb1001-1152" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1001-1153"><a href="aplikace3.html#cb1001-1153" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1001-1154"><a href="aplikace3.html#cb1001-1154" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1001-1155"><a href="aplikace3.html#cb1001-1155" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1001-1156"><a href="aplikace3.html#cb1001-1156" tabindex="-1"></a>  </span>
<span id="cb1001-1157"><a href="aplikace3.html#cb1001-1157" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-1158"><a href="aplikace3.html#cb1001-1158" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-1159"><a href="aplikace3.html#cb1001-1159" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1001-1160"><a href="aplikace3.html#cb1001-1160" tabindex="-1"></a>  </span>
<span id="cb1001-1161"><a href="aplikace3.html#cb1001-1161" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-1162"><a href="aplikace3.html#cb1001-1162" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1001-1163"><a href="aplikace3.html#cb1001-1163" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1001-1164"><a href="aplikace3.html#cb1001-1164" tabindex="-1"></a>  </span>
<span id="cb1001-1165"><a href="aplikace3.html#cb1001-1165" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-1166"><a href="aplikace3.html#cb1001-1166" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-1167"><a href="aplikace3.html#cb1001-1167" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-1168"><a href="aplikace3.html#cb1001-1168" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1169"><a href="aplikace3.html#cb1001-1169" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1001-1170"><a href="aplikace3.html#cb1001-1170" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1171"><a href="aplikace3.html#cb1001-1171" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1172"><a href="aplikace3.html#cb1001-1172" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1001-1173"><a href="aplikace3.html#cb1001-1173" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-1174"><a href="aplikace3.html#cb1001-1174" tabindex="-1"></a>  </span>
<span id="cb1001-1175"><a href="aplikace3.html#cb1001-1175" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1001-1176"><a href="aplikace3.html#cb1001-1176" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1177"><a href="aplikace3.html#cb1001-1177" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1178"><a href="aplikace3.html#cb1001-1178" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1001-1179"><a href="aplikace3.html#cb1001-1179" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1180"><a href="aplikace3.html#cb1001-1180" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb1001-1181"><a href="aplikace3.html#cb1001-1181" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-1182"><a href="aplikace3.html#cb1001-1182" tabindex="-1"></a>  </span>
<span id="cb1001-1183"><a href="aplikace3.html#cb1001-1183" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1001-1184"><a href="aplikace3.html#cb1001-1184" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1185"><a href="aplikace3.html#cb1001-1185" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1186"><a href="aplikace3.html#cb1001-1186" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1001-1187"><a href="aplikace3.html#cb1001-1187" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1001-1188"><a href="aplikace3.html#cb1001-1188" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-1189"><a href="aplikace3.html#cb1001-1189" tabindex="-1"></a>  </span>
<span id="cb1001-1190"><a href="aplikace3.html#cb1001-1190" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1191"><a href="aplikace3.html#cb1001-1191" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1001-1192"><a href="aplikace3.html#cb1001-1192" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1193"><a href="aplikace3.html#cb1001-1193" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1194"><a href="aplikace3.html#cb1001-1194" tabindex="-1"></a>  </span>
<span id="cb1001-1195"><a href="aplikace3.html#cb1001-1195" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1001-1196"><a href="aplikace3.html#cb1001-1196" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1197"><a href="aplikace3.html#cb1001-1197" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1198"><a href="aplikace3.html#cb1001-1198" tabindex="-1"></a>  </span>
<span id="cb1001-1199"><a href="aplikace3.html#cb1001-1199" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1001-1200"><a href="aplikace3.html#cb1001-1200" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1201"><a href="aplikace3.html#cb1001-1201" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1202"><a href="aplikace3.html#cb1001-1202" tabindex="-1"></a>    </span>
<span id="cb1001-1203"><a href="aplikace3.html#cb1001-1203" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-1204"><a href="aplikace3.html#cb1001-1204" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1001-1205"><a href="aplikace3.html#cb1001-1205" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1206"><a href="aplikace3.html#cb1001-1206" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1207"><a href="aplikace3.html#cb1001-1207" tabindex="-1"></a>  </span>
<span id="cb1001-1208"><a href="aplikace3.html#cb1001-1208" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1001-1209"><a href="aplikace3.html#cb1001-1209" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1210"><a href="aplikace3.html#cb1001-1210" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1211"><a href="aplikace3.html#cb1001-1211" tabindex="-1"></a>  </span>
<span id="cb1001-1212"><a href="aplikace3.html#cb1001-1212" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1001-1213"><a href="aplikace3.html#cb1001-1213" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1214"><a href="aplikace3.html#cb1001-1214" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1215"><a href="aplikace3.html#cb1001-1215" tabindex="-1"></a></span>
<span id="cb1001-1216"><a href="aplikace3.html#cb1001-1216" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb1001-1217"><a href="aplikace3.html#cb1001-1217" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb1001-1218"><a href="aplikace3.html#cb1001-1218" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb1001-1219"><a href="aplikace3.html#cb1001-1219" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb1001-1220"><a href="aplikace3.html#cb1001-1220" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1001-1221"><a href="aplikace3.html#cb1001-1221" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1001-1222"><a href="aplikace3.html#cb1001-1222" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1001-1223"><a href="aplikace3.html#cb1001-1223" tabindex="-1"></a></span>
<span id="cb1001-1224"><a href="aplikace3.html#cb1001-1224" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-1225"><a href="aplikace3.html#cb1001-1225" tabindex="-1"></a>  </span>
<span id="cb1001-1226"><a href="aplikace3.html#cb1001-1226" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb1001-1227"><a href="aplikace3.html#cb1001-1227" tabindex="-1"></a>  </span>
<span id="cb1001-1228"><a href="aplikace3.html#cb1001-1228" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb1001-1229"><a href="aplikace3.html#cb1001-1229" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb1001-1230"><a href="aplikace3.html#cb1001-1230" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1001-1231"><a href="aplikace3.html#cb1001-1231" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb1001-1232"><a href="aplikace3.html#cb1001-1232" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1001-1233"><a href="aplikace3.html#cb1001-1233" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb1001-1234"><a href="aplikace3.html#cb1001-1234" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-1235"><a href="aplikace3.html#cb1001-1235" tabindex="-1"></a>  </span>
<span id="cb1001-1236"><a href="aplikace3.html#cb1001-1236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb1001-1237"><a href="aplikace3.html#cb1001-1237" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb1001-1238"><a href="aplikace3.html#cb1001-1238" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb1001-1239"><a href="aplikace3.html#cb1001-1239" tabindex="-1"></a>  </span>
<span id="cb1001-1240"><a href="aplikace3.html#cb1001-1240" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb1001-1241"><a href="aplikace3.html#cb1001-1241" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb1001-1242"><a href="aplikace3.html#cb1001-1242" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb1001-1243"><a href="aplikace3.html#cb1001-1243" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb1001-1244"><a href="aplikace3.html#cb1001-1244" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-1245"><a href="aplikace3.html#cb1001-1245" tabindex="-1"></a>    </span>
<span id="cb1001-1246"><a href="aplikace3.html#cb1001-1246" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-1247"><a href="aplikace3.html#cb1001-1247" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-1248"><a href="aplikace3.html#cb1001-1248" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1001-1249"><a href="aplikace3.html#cb1001-1249" tabindex="-1"></a>      </span>
<span id="cb1001-1250"><a href="aplikace3.html#cb1001-1250" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb1001-1251"><a href="aplikace3.html#cb1001-1251" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb1001-1252"><a href="aplikace3.html#cb1001-1252" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1001-1253"><a href="aplikace3.html#cb1001-1253" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb1001-1254"><a href="aplikace3.html#cb1001-1254" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb1001-1255"><a href="aplikace3.html#cb1001-1255" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1256"><a href="aplikace3.html#cb1001-1256" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1001-1257"><a href="aplikace3.html#cb1001-1257" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1258"><a href="aplikace3.html#cb1001-1258" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1259"><a href="aplikace3.html#cb1001-1259" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1001-1260"><a href="aplikace3.html#cb1001-1260" tabindex="-1"></a>      </span>
<span id="cb1001-1261"><a href="aplikace3.html#cb1001-1261" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1001-1262"><a href="aplikace3.html#cb1001-1262" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1263"><a href="aplikace3.html#cb1001-1263" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1264"><a href="aplikace3.html#cb1001-1264" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1265"><a href="aplikace3.html#cb1001-1265" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1001-1266"><a href="aplikace3.html#cb1001-1266" tabindex="-1"></a>      </span>
<span id="cb1001-1267"><a href="aplikace3.html#cb1001-1267" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1001-1268"><a href="aplikace3.html#cb1001-1268" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1269"><a href="aplikace3.html#cb1001-1269" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1270"><a href="aplikace3.html#cb1001-1270" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1001-1271"><a href="aplikace3.html#cb1001-1271" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1272"><a href="aplikace3.html#cb1001-1272" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb1001-1273"><a href="aplikace3.html#cb1001-1273" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb1001-1274"><a href="aplikace3.html#cb1001-1274" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1001-1275"><a href="aplikace3.html#cb1001-1275" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1001-1276"><a href="aplikace3.html#cb1001-1276" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1277"><a href="aplikace3.html#cb1001-1277" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb1001-1278"><a href="aplikace3.html#cb1001-1278" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb1001-1279"><a href="aplikace3.html#cb1001-1279" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1001-1280"><a href="aplikace3.html#cb1001-1280" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1001-1281"><a href="aplikace3.html#cb1001-1281" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1282"><a href="aplikace3.html#cb1001-1282" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb1001-1283"><a href="aplikace3.html#cb1001-1283" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb1001-1284"><a href="aplikace3.html#cb1001-1284" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1001-1285"><a href="aplikace3.html#cb1001-1285" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1001-1286"><a href="aplikace3.html#cb1001-1286" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1287"><a href="aplikace3.html#cb1001-1287" tabindex="-1"></a>      </span>
<span id="cb1001-1288"><a href="aplikace3.html#cb1001-1288" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb1001-1289"><a href="aplikace3.html#cb1001-1289" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1001-1290"><a href="aplikace3.html#cb1001-1290" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1001-1291"><a href="aplikace3.html#cb1001-1291" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1001-1292"><a href="aplikace3.html#cb1001-1292" tabindex="-1"></a>    }</span>
<span id="cb1001-1293"><a href="aplikace3.html#cb1001-1293" tabindex="-1"></a>  }</span>
<span id="cb1001-1294"><a href="aplikace3.html#cb1001-1294" tabindex="-1"></a>  </span>
<span id="cb1001-1295"><a href="aplikace3.html#cb1001-1295" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1001-1296"><a href="aplikace3.html#cb1001-1296" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1001-1297"><a href="aplikace3.html#cb1001-1297" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb1001-1298"><a href="aplikace3.html#cb1001-1298" tabindex="-1"></a>  }</span>
<span id="cb1001-1299"><a href="aplikace3.html#cb1001-1299" tabindex="-1"></a>  </span>
<span id="cb1001-1300"><a href="aplikace3.html#cb1001-1300" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb1001-1301"><a href="aplikace3.html#cb1001-1301" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb1001-1302"><a href="aplikace3.html#cb1001-1302" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb1001-1303"><a href="aplikace3.html#cb1001-1303" tabindex="-1"></a>  </span>
<span id="cb1001-1304"><a href="aplikace3.html#cb1001-1304" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb1001-1305"><a href="aplikace3.html#cb1001-1305" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1001-1306"><a href="aplikace3.html#cb1001-1306" tabindex="-1"></a>  </span>
<span id="cb1001-1307"><a href="aplikace3.html#cb1001-1307" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1308"><a href="aplikace3.html#cb1001-1308" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb1001-1309"><a href="aplikace3.html#cb1001-1309" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb1001-1310"><a href="aplikace3.html#cb1001-1310" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb1001-1311"><a href="aplikace3.html#cb1001-1311" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1001-1312"><a href="aplikace3.html#cb1001-1312" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1313"><a href="aplikace3.html#cb1001-1313" tabindex="-1"></a>  </span>
<span id="cb1001-1314"><a href="aplikace3.html#cb1001-1314" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1315"><a href="aplikace3.html#cb1001-1315" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1316"><a href="aplikace3.html#cb1001-1316" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb1001-1317"><a href="aplikace3.html#cb1001-1317" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb1001-1318"><a href="aplikace3.html#cb1001-1318" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb1001-1319"><a href="aplikace3.html#cb1001-1319" tabindex="-1"></a>    </span>
<span id="cb1001-1320"><a href="aplikace3.html#cb1001-1320" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1001-1321"><a href="aplikace3.html#cb1001-1321" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1001-1322"><a href="aplikace3.html#cb1001-1322" tabindex="-1"></a>    </span>
<span id="cb1001-1323"><a href="aplikace3.html#cb1001-1323" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb1001-1324"><a href="aplikace3.html#cb1001-1324" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1001-1325"><a href="aplikace3.html#cb1001-1325" tabindex="-1"></a>    </span>
<span id="cb1001-1326"><a href="aplikace3.html#cb1001-1326" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb1001-1327"><a href="aplikace3.html#cb1001-1327" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-1328"><a href="aplikace3.html#cb1001-1328" tabindex="-1"></a>    </span>
<span id="cb1001-1329"><a href="aplikace3.html#cb1001-1329" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1330"><a href="aplikace3.html#cb1001-1330" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb1001-1331"><a href="aplikace3.html#cb1001-1331" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1332"><a href="aplikace3.html#cb1001-1332" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1333"><a href="aplikace3.html#cb1001-1333" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1334"><a href="aplikace3.html#cb1001-1334" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1335"><a href="aplikace3.html#cb1001-1335" tabindex="-1"></a>    </span>
<span id="cb1001-1336"><a href="aplikace3.html#cb1001-1336" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1337"><a href="aplikace3.html#cb1001-1337" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb1001-1338"><a href="aplikace3.html#cb1001-1338" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-1339"><a href="aplikace3.html#cb1001-1339" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1340"><a href="aplikace3.html#cb1001-1340" tabindex="-1"></a>      </span>
<span id="cb1001-1341"><a href="aplikace3.html#cb1001-1341" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1342"><a href="aplikace3.html#cb1001-1342" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb1001-1343"><a href="aplikace3.html#cb1001-1343" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1344"><a href="aplikace3.html#cb1001-1344" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1345"><a href="aplikace3.html#cb1001-1345" tabindex="-1"></a>    </span>
<span id="cb1001-1346"><a href="aplikace3.html#cb1001-1346" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1347"><a href="aplikace3.html#cb1001-1347" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1001-1348"><a href="aplikace3.html#cb1001-1348" tabindex="-1"></a>  }</span>
<span id="cb1001-1349"><a href="aplikace3.html#cb1001-1349" tabindex="-1"></a>  </span>
<span id="cb1001-1350"><a href="aplikace3.html#cb1001-1350" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-1351"><a href="aplikace3.html#cb1001-1351" tabindex="-1"></a>  </span>
<span id="cb1001-1352"><a href="aplikace3.html#cb1001-1352" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb1001-1353"><a href="aplikace3.html#cb1001-1353" tabindex="-1"></a>  </span>
<span id="cb1001-1354"><a href="aplikace3.html#cb1001-1354" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1001-1355"><a href="aplikace3.html#cb1001-1355" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb1001-1356"><a href="aplikace3.html#cb1001-1356" tabindex="-1"></a>  </span>
<span id="cb1001-1357"><a href="aplikace3.html#cb1001-1357" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb1001-1358"><a href="aplikace3.html#cb1001-1358" tabindex="-1"></a>  </span>
<span id="cb1001-1359"><a href="aplikace3.html#cb1001-1359" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb1001-1360"><a href="aplikace3.html#cb1001-1360" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb1001-1361"><a href="aplikace3.html#cb1001-1361" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb1001-1362"><a href="aplikace3.html#cb1001-1362" tabindex="-1"></a>  }</span>
<span id="cb1001-1363"><a href="aplikace3.html#cb1001-1363" tabindex="-1"></a>  </span>
<span id="cb1001-1364"><a href="aplikace3.html#cb1001-1364" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb1001-1365"><a href="aplikace3.html#cb1001-1365" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1001-1366"><a href="aplikace3.html#cb1001-1366" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1001-1367"><a href="aplikace3.html#cb1001-1367" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1001-1368"><a href="aplikace3.html#cb1001-1368" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb1001-1369"><a href="aplikace3.html#cb1001-1369" tabindex="-1"></a>      }</span>
<span id="cb1001-1370"><a href="aplikace3.html#cb1001-1370" tabindex="-1"></a>    }</span>
<span id="cb1001-1371"><a href="aplikace3.html#cb1001-1371" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1001-1372"><a href="aplikace3.html#cb1001-1372" tabindex="-1"></a>  }</span>
<span id="cb1001-1373"><a href="aplikace3.html#cb1001-1373" tabindex="-1"></a>  </span>
<span id="cb1001-1374"><a href="aplikace3.html#cb1001-1374" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-1375"><a href="aplikace3.html#cb1001-1375" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-1376"><a href="aplikace3.html#cb1001-1376" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1377"><a href="aplikace3.html#cb1001-1377" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1378"><a href="aplikace3.html#cb1001-1378" tabindex="-1"></a>  </span>
<span id="cb1001-1379"><a href="aplikace3.html#cb1001-1379" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1001-1380"><a href="aplikace3.html#cb1001-1380" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1001-1381"><a href="aplikace3.html#cb1001-1381" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb1001-1382"><a href="aplikace3.html#cb1001-1382" tabindex="-1"></a>  </span>
<span id="cb1001-1383"><a href="aplikace3.html#cb1001-1383" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-1384"><a href="aplikace3.html#cb1001-1384" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-1385"><a href="aplikace3.html#cb1001-1385" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-1386"><a href="aplikace3.html#cb1001-1386" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1001-1387"><a href="aplikace3.html#cb1001-1387" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb1001-1388"><a href="aplikace3.html#cb1001-1388" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1001-1389"><a href="aplikace3.html#cb1001-1389" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1001-1390"><a href="aplikace3.html#cb1001-1390" tabindex="-1"></a>  </span>
<span id="cb1001-1391"><a href="aplikace3.html#cb1001-1391" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-1392"><a href="aplikace3.html#cb1001-1392" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1393"><a href="aplikace3.html#cb1001-1393" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1394"><a href="aplikace3.html#cb1001-1394" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1395"><a href="aplikace3.html#cb1001-1395" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1396"><a href="aplikace3.html#cb1001-1396" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1397"><a href="aplikace3.html#cb1001-1397" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1001-1398"><a href="aplikace3.html#cb1001-1398" tabindex="-1"></a>  </span>
<span id="cb1001-1399"><a href="aplikace3.html#cb1001-1399" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1001-1400"><a href="aplikace3.html#cb1001-1400" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1001-1401"><a href="aplikace3.html#cb1001-1401" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb1001-1402"><a href="aplikace3.html#cb1001-1402" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-1403"><a href="aplikace3.html#cb1001-1403" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-1404"><a href="aplikace3.html#cb1001-1404" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-1405"><a href="aplikace3.html#cb1001-1405" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1001-1406"><a href="aplikace3.html#cb1001-1406" tabindex="-1"></a>    </span>
<span id="cb1001-1407"><a href="aplikace3.html#cb1001-1407" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1001-1408"><a href="aplikace3.html#cb1001-1408" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1409"><a href="aplikace3.html#cb1001-1409" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-1410"><a href="aplikace3.html#cb1001-1410" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-1411"><a href="aplikace3.html#cb1001-1411" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-1412"><a href="aplikace3.html#cb1001-1412" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1001-1413"><a href="aplikace3.html#cb1001-1413" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-1414"><a href="aplikace3.html#cb1001-1414" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps, </span>
<span id="cb1001-1415"><a href="aplikace3.html#cb1001-1415" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1001-1416"><a href="aplikace3.html#cb1001-1416" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1417"><a href="aplikace3.html#cb1001-1417" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb1001-1418"><a href="aplikace3.html#cb1001-1418" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1001-1419"><a href="aplikace3.html#cb1001-1419" tabindex="-1"></a>    }</span>
<span id="cb1001-1420"><a href="aplikace3.html#cb1001-1420" tabindex="-1"></a>    </span>
<span id="cb1001-1421"><a href="aplikace3.html#cb1001-1421" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb1001-1422"><a href="aplikace3.html#cb1001-1422" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1001-1423"><a href="aplikace3.html#cb1001-1423" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-1424"><a href="aplikace3.html#cb1001-1424" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-1425"><a href="aplikace3.html#cb1001-1425" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1001-1426"><a href="aplikace3.html#cb1001-1426" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-1427"><a href="aplikace3.html#cb1001-1427" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1428"><a href="aplikace3.html#cb1001-1428" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1001-1429"><a href="aplikace3.html#cb1001-1429" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-1430"><a href="aplikace3.html#cb1001-1430" tabindex="-1"></a>      }</span>
<span id="cb1001-1431"><a href="aplikace3.html#cb1001-1431" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb1001-1432"><a href="aplikace3.html#cb1001-1432" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-1433"><a href="aplikace3.html#cb1001-1433" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-1434"><a href="aplikace3.html#cb1001-1434" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-1435"><a href="aplikace3.html#cb1001-1435" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1001-1436"><a href="aplikace3.html#cb1001-1436" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1001-1437"><a href="aplikace3.html#cb1001-1437" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1001-1438"><a href="aplikace3.html#cb1001-1438" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1439"><a href="aplikace3.html#cb1001-1439" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1001-1440"><a href="aplikace3.html#cb1001-1440" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1001-1441"><a href="aplikace3.html#cb1001-1441" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1001-1442"><a href="aplikace3.html#cb1001-1442" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1443"><a href="aplikace3.html#cb1001-1443" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1444"><a href="aplikace3.html#cb1001-1444" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1445"><a href="aplikace3.html#cb1001-1445" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1446"><a href="aplikace3.html#cb1001-1446" tabindex="-1"></a>        </span>
<span id="cb1001-1447"><a href="aplikace3.html#cb1001-1447" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-1448"><a href="aplikace3.html#cb1001-1448" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1001-1449"><a href="aplikace3.html#cb1001-1449" tabindex="-1"></a>          </span>
<span id="cb1001-1450"><a href="aplikace3.html#cb1001-1450" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-1451"><a href="aplikace3.html#cb1001-1451" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1001-1452"><a href="aplikace3.html#cb1001-1452" tabindex="-1"></a>          </span>
<span id="cb1001-1453"><a href="aplikace3.html#cb1001-1453" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1454"><a href="aplikace3.html#cb1001-1454" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-1455"><a href="aplikace3.html#cb1001-1455" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1456"><a href="aplikace3.html#cb1001-1456" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1457"><a href="aplikace3.html#cb1001-1457" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb1001-1458"><a href="aplikace3.html#cb1001-1458" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1459"><a href="aplikace3.html#cb1001-1459" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1460"><a href="aplikace3.html#cb1001-1460" tabindex="-1"></a>          </span>
<span id="cb1001-1461"><a href="aplikace3.html#cb1001-1461" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1462"><a href="aplikace3.html#cb1001-1462" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-1463"><a href="aplikace3.html#cb1001-1463" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1464"><a href="aplikace3.html#cb1001-1464" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1465"><a href="aplikace3.html#cb1001-1465" tabindex="-1"></a>          </span>
<span id="cb1001-1466"><a href="aplikace3.html#cb1001-1466" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1467"><a href="aplikace3.html#cb1001-1467" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1001-1468"><a href="aplikace3.html#cb1001-1468" tabindex="-1"></a>        }</span>
<span id="cb1001-1469"><a href="aplikace3.html#cb1001-1469" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1001-1470"><a href="aplikace3.html#cb1001-1470" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1001-1471"><a href="aplikace3.html#cb1001-1471" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1472"><a href="aplikace3.html#cb1001-1472" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1473"><a href="aplikace3.html#cb1001-1473" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1001-1474"><a href="aplikace3.html#cb1001-1474" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1475"><a href="aplikace3.html#cb1001-1475" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1476"><a href="aplikace3.html#cb1001-1476" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1001-1477"><a href="aplikace3.html#cb1001-1477" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1478"><a href="aplikace3.html#cb1001-1478" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1479"><a href="aplikace3.html#cb1001-1479" tabindex="-1"></a>      }</span>
<span id="cb1001-1480"><a href="aplikace3.html#cb1001-1480" tabindex="-1"></a>    }</span>
<span id="cb1001-1481"><a href="aplikace3.html#cb1001-1481" tabindex="-1"></a>  }</span>
<span id="cb1001-1482"><a href="aplikace3.html#cb1001-1482" tabindex="-1"></a>  </span>
<span id="cb1001-1483"><a href="aplikace3.html#cb1001-1483" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1001-1484"><a href="aplikace3.html#cb1001-1484" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1001-1485"><a href="aplikace3.html#cb1001-1485" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-1486"><a href="aplikace3.html#cb1001-1486" tabindex="-1"></a>  }</span>
<span id="cb1001-1487"><a href="aplikace3.html#cb1001-1487" tabindex="-1"></a>  </span>
<span id="cb1001-1488"><a href="aplikace3.html#cb1001-1488" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb1001-1489"><a href="aplikace3.html#cb1001-1489" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb1001-1490"><a href="aplikace3.html#cb1001-1490" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb1001-1491"><a href="aplikace3.html#cb1001-1491" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1001-1492"><a href="aplikace3.html#cb1001-1492" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1001-1493"><a href="aplikace3.html#cb1001-1493" tabindex="-1"></a>  </span>
<span id="cb1001-1494"><a href="aplikace3.html#cb1001-1494" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1495"><a href="aplikace3.html#cb1001-1495" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1496"><a href="aplikace3.html#cb1001-1496" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1001-1497"><a href="aplikace3.html#cb1001-1497" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1001-1498"><a href="aplikace3.html#cb1001-1498" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1001-1499"><a href="aplikace3.html#cb1001-1499" tabindex="-1"></a>  </span>
<span id="cb1001-1500"><a href="aplikace3.html#cb1001-1500" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-1501"><a href="aplikace3.html#cb1001-1501" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-1502"><a href="aplikace3.html#cb1001-1502" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-1503"><a href="aplikace3.html#cb1001-1503" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1001-1504"><a href="aplikace3.html#cb1001-1504" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1001-1505"><a href="aplikace3.html#cb1001-1505" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1001-1506"><a href="aplikace3.html#cb1001-1506" tabindex="-1"></a>  </span>
<span id="cb1001-1507"><a href="aplikace3.html#cb1001-1507" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb1001-1508"><a href="aplikace3.html#cb1001-1508" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1001-1509"><a href="aplikace3.html#cb1001-1509" tabindex="-1"></a>  </span>
<span id="cb1001-1510"><a href="aplikace3.html#cb1001-1510" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1511"><a href="aplikace3.html#cb1001-1511" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1512"><a href="aplikace3.html#cb1001-1512" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1001-1513"><a href="aplikace3.html#cb1001-1513" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1001-1514"><a href="aplikace3.html#cb1001-1514" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1515"><a href="aplikace3.html#cb1001-1515" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb1001-1516"><a href="aplikace3.html#cb1001-1516" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb1001-1517"><a href="aplikace3.html#cb1001-1517" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb1001-1518"><a href="aplikace3.html#cb1001-1518" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1001-1519"><a href="aplikace3.html#cb1001-1519" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1520"><a href="aplikace3.html#cb1001-1520" tabindex="-1"></a>  </span>
<span id="cb1001-1521"><a href="aplikace3.html#cb1001-1521" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1522"><a href="aplikace3.html#cb1001-1522" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1523"><a href="aplikace3.html#cb1001-1523" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1001-1524"><a href="aplikace3.html#cb1001-1524" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb1001-1525"><a href="aplikace3.html#cb1001-1525" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb1001-1526"><a href="aplikace3.html#cb1001-1526" tabindex="-1"></a>    </span>
<span id="cb1001-1527"><a href="aplikace3.html#cb1001-1527" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1001-1528"><a href="aplikace3.html#cb1001-1528" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-1529"><a href="aplikace3.html#cb1001-1529" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-1530"><a href="aplikace3.html#cb1001-1530" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-1531"><a href="aplikace3.html#cb1001-1531" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1001-1532"><a href="aplikace3.html#cb1001-1532" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1001-1533"><a href="aplikace3.html#cb1001-1533" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1001-1534"><a href="aplikace3.html#cb1001-1534" tabindex="-1"></a>    </span>
<span id="cb1001-1535"><a href="aplikace3.html#cb1001-1535" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1001-1536"><a href="aplikace3.html#cb1001-1536" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1537"><a href="aplikace3.html#cb1001-1537" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-1538"><a href="aplikace3.html#cb1001-1538" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-1539"><a href="aplikace3.html#cb1001-1539" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-1540"><a href="aplikace3.html#cb1001-1540" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1001-1541"><a href="aplikace3.html#cb1001-1541" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-1542"><a href="aplikace3.html#cb1001-1542" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,</span>
<span id="cb1001-1543"><a href="aplikace3.html#cb1001-1543" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1001-1544"><a href="aplikace3.html#cb1001-1544" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb1001-1545"><a href="aplikace3.html#cb1001-1545" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1001-1546"><a href="aplikace3.html#cb1001-1546" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1001-1547"><a href="aplikace3.html#cb1001-1547" tabindex="-1"></a>    }</span>
<span id="cb1001-1548"><a href="aplikace3.html#cb1001-1548" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1001-1549"><a href="aplikace3.html#cb1001-1549" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1001-1550"><a href="aplikace3.html#cb1001-1550" tabindex="-1"></a>    </span>
<span id="cb1001-1551"><a href="aplikace3.html#cb1001-1551" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1001-1552"><a href="aplikace3.html#cb1001-1552" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-1553"><a href="aplikace3.html#cb1001-1553" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-1554"><a href="aplikace3.html#cb1001-1554" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1001-1555"><a href="aplikace3.html#cb1001-1555" tabindex="-1"></a>    </span>
<span id="cb1001-1556"><a href="aplikace3.html#cb1001-1556" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-1557"><a href="aplikace3.html#cb1001-1557" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1558"><a href="aplikace3.html#cb1001-1558" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-1559"><a href="aplikace3.html#cb1001-1559" tabindex="-1"></a>    }</span>
<span id="cb1001-1560"><a href="aplikace3.html#cb1001-1560" tabindex="-1"></a>    </span>
<span id="cb1001-1561"><a href="aplikace3.html#cb1001-1561" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1001-1562"><a href="aplikace3.html#cb1001-1562" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1001-1563"><a href="aplikace3.html#cb1001-1563" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1001-1564"><a href="aplikace3.html#cb1001-1564" tabindex="-1"></a>  </span>
<span id="cb1001-1565"><a href="aplikace3.html#cb1001-1565" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1566"><a href="aplikace3.html#cb1001-1566" tabindex="-1"></a>  </span>
<span id="cb1001-1567"><a href="aplikace3.html#cb1001-1567" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-1568"><a href="aplikace3.html#cb1001-1568" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1001-1569"><a href="aplikace3.html#cb1001-1569" tabindex="-1"></a>    </span>
<span id="cb1001-1570"><a href="aplikace3.html#cb1001-1570" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-1571"><a href="aplikace3.html#cb1001-1571" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-1572"><a href="aplikace3.html#cb1001-1572" tabindex="-1"></a>    </span>
<span id="cb1001-1573"><a href="aplikace3.html#cb1001-1573" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1574"><a href="aplikace3.html#cb1001-1574" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-1575"><a href="aplikace3.html#cb1001-1575" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1576"><a href="aplikace3.html#cb1001-1576" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1577"><a href="aplikace3.html#cb1001-1577" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1001-1578"><a href="aplikace3.html#cb1001-1578" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1579"><a href="aplikace3.html#cb1001-1579" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1580"><a href="aplikace3.html#cb1001-1580" tabindex="-1"></a>    </span>
<span id="cb1001-1581"><a href="aplikace3.html#cb1001-1581" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1582"><a href="aplikace3.html#cb1001-1582" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1001-1583"><a href="aplikace3.html#cb1001-1583" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-1584"><a href="aplikace3.html#cb1001-1584" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1585"><a href="aplikace3.html#cb1001-1585" tabindex="-1"></a>      </span>
<span id="cb1001-1586"><a href="aplikace3.html#cb1001-1586" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-1587"><a href="aplikace3.html#cb1001-1587" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-1588"><a href="aplikace3.html#cb1001-1588" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1589"><a href="aplikace3.html#cb1001-1589" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1590"><a href="aplikace3.html#cb1001-1590" tabindex="-1"></a>    </span>
<span id="cb1001-1591"><a href="aplikace3.html#cb1001-1591" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1592"><a href="aplikace3.html#cb1001-1592" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1001-1593"><a href="aplikace3.html#cb1001-1593" tabindex="-1"></a>  }</span>
<span id="cb1001-1594"><a href="aplikace3.html#cb1001-1594" tabindex="-1"></a>  </span>
<span id="cb1001-1595"><a href="aplikace3.html#cb1001-1595" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-1596"><a href="aplikace3.html#cb1001-1596" tabindex="-1"></a></span>
<span id="cb1001-1597"><a href="aplikace3.html#cb1001-1597" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb1001-1598"><a href="aplikace3.html#cb1001-1598" tabindex="-1"></a>  </span>
<span id="cb1001-1599"><a href="aplikace3.html#cb1001-1599" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb1001-1600"><a href="aplikace3.html#cb1001-1600" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb1001-1601"><a href="aplikace3.html#cb1001-1601" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb1001-1602"><a href="aplikace3.html#cb1001-1602" tabindex="-1"></a>  }</span>
<span id="cb1001-1603"><a href="aplikace3.html#cb1001-1603" tabindex="-1"></a>  </span>
<span id="cb1001-1604"><a href="aplikace3.html#cb1001-1604" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb1001-1605"><a href="aplikace3.html#cb1001-1605" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1001-1606"><a href="aplikace3.html#cb1001-1606" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1001-1607"><a href="aplikace3.html#cb1001-1607" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1001-1608"><a href="aplikace3.html#cb1001-1608" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb1001-1609"><a href="aplikace3.html#cb1001-1609" tabindex="-1"></a>      }</span>
<span id="cb1001-1610"><a href="aplikace3.html#cb1001-1610" tabindex="-1"></a>    }</span>
<span id="cb1001-1611"><a href="aplikace3.html#cb1001-1611" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1001-1612"><a href="aplikace3.html#cb1001-1612" tabindex="-1"></a>  }</span>
<span id="cb1001-1613"><a href="aplikace3.html#cb1001-1613" tabindex="-1"></a>  </span>
<span id="cb1001-1614"><a href="aplikace3.html#cb1001-1614" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-1615"><a href="aplikace3.html#cb1001-1615" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-1616"><a href="aplikace3.html#cb1001-1616" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1617"><a href="aplikace3.html#cb1001-1617" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1618"><a href="aplikace3.html#cb1001-1618" tabindex="-1"></a>  </span>
<span id="cb1001-1619"><a href="aplikace3.html#cb1001-1619" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1001-1620"><a href="aplikace3.html#cb1001-1620" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1001-1621"><a href="aplikace3.html#cb1001-1621" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb1001-1622"><a href="aplikace3.html#cb1001-1622" tabindex="-1"></a>  </span>
<span id="cb1001-1623"><a href="aplikace3.html#cb1001-1623" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-1624"><a href="aplikace3.html#cb1001-1624" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-1625"><a href="aplikace3.html#cb1001-1625" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1001-1626"><a href="aplikace3.html#cb1001-1626" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb1001-1627"><a href="aplikace3.html#cb1001-1627" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb1001-1628"><a href="aplikace3.html#cb1001-1628" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1001-1629"><a href="aplikace3.html#cb1001-1629" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1001-1630"><a href="aplikace3.html#cb1001-1630" tabindex="-1"></a>  </span>
<span id="cb1001-1631"><a href="aplikace3.html#cb1001-1631" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-1632"><a href="aplikace3.html#cb1001-1632" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1633"><a href="aplikace3.html#cb1001-1633" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1634"><a href="aplikace3.html#cb1001-1634" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1635"><a href="aplikace3.html#cb1001-1635" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1636"><a href="aplikace3.html#cb1001-1636" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1637"><a href="aplikace3.html#cb1001-1637" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1001-1638"><a href="aplikace3.html#cb1001-1638" tabindex="-1"></a>  </span>
<span id="cb1001-1639"><a href="aplikace3.html#cb1001-1639" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1001-1640"><a href="aplikace3.html#cb1001-1640" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb1001-1641"><a href="aplikace3.html#cb1001-1641" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb1001-1642"><a href="aplikace3.html#cb1001-1642" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-1643"><a href="aplikace3.html#cb1001-1643" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-1644"><a href="aplikace3.html#cb1001-1644" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-1645"><a href="aplikace3.html#cb1001-1645" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1001-1646"><a href="aplikace3.html#cb1001-1646" tabindex="-1"></a>    </span>
<span id="cb1001-1647"><a href="aplikace3.html#cb1001-1647" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1001-1648"><a href="aplikace3.html#cb1001-1648" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1649"><a href="aplikace3.html#cb1001-1649" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-1650"><a href="aplikace3.html#cb1001-1650" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-1651"><a href="aplikace3.html#cb1001-1651" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-1652"><a href="aplikace3.html#cb1001-1652" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1001-1653"><a href="aplikace3.html#cb1001-1653" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-1654"><a href="aplikace3.html#cb1001-1654" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1001-1655"><a href="aplikace3.html#cb1001-1655" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1656"><a href="aplikace3.html#cb1001-1656" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1657"><a href="aplikace3.html#cb1001-1657" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1001-1658"><a href="aplikace3.html#cb1001-1658" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb1001-1659"><a href="aplikace3.html#cb1001-1659" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1001-1660"><a href="aplikace3.html#cb1001-1660" tabindex="-1"></a>    }</span>
<span id="cb1001-1661"><a href="aplikace3.html#cb1001-1661" tabindex="-1"></a>    </span>
<span id="cb1001-1662"><a href="aplikace3.html#cb1001-1662" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb1001-1663"><a href="aplikace3.html#cb1001-1663" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1001-1664"><a href="aplikace3.html#cb1001-1664" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-1665"><a href="aplikace3.html#cb1001-1665" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-1666"><a href="aplikace3.html#cb1001-1666" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1001-1667"><a href="aplikace3.html#cb1001-1667" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-1668"><a href="aplikace3.html#cb1001-1668" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1669"><a href="aplikace3.html#cb1001-1669" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1001-1670"><a href="aplikace3.html#cb1001-1670" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-1671"><a href="aplikace3.html#cb1001-1671" tabindex="-1"></a>      }</span>
<span id="cb1001-1672"><a href="aplikace3.html#cb1001-1672" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb1001-1673"><a href="aplikace3.html#cb1001-1673" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-1674"><a href="aplikace3.html#cb1001-1674" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-1675"><a href="aplikace3.html#cb1001-1675" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-1676"><a href="aplikace3.html#cb1001-1676" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1001-1677"><a href="aplikace3.html#cb1001-1677" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1001-1678"><a href="aplikace3.html#cb1001-1678" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1001-1679"><a href="aplikace3.html#cb1001-1679" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1680"><a href="aplikace3.html#cb1001-1680" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1001-1681"><a href="aplikace3.html#cb1001-1681" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1001-1682"><a href="aplikace3.html#cb1001-1682" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1001-1683"><a href="aplikace3.html#cb1001-1683" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1684"><a href="aplikace3.html#cb1001-1684" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1685"><a href="aplikace3.html#cb1001-1685" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1686"><a href="aplikace3.html#cb1001-1686" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1687"><a href="aplikace3.html#cb1001-1687" tabindex="-1"></a>        </span>
<span id="cb1001-1688"><a href="aplikace3.html#cb1001-1688" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-1689"><a href="aplikace3.html#cb1001-1689" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1001-1690"><a href="aplikace3.html#cb1001-1690" tabindex="-1"></a>          </span>
<span id="cb1001-1691"><a href="aplikace3.html#cb1001-1691" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-1692"><a href="aplikace3.html#cb1001-1692" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1001-1693"><a href="aplikace3.html#cb1001-1693" tabindex="-1"></a>          </span>
<span id="cb1001-1694"><a href="aplikace3.html#cb1001-1694" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1695"><a href="aplikace3.html#cb1001-1695" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-1696"><a href="aplikace3.html#cb1001-1696" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1697"><a href="aplikace3.html#cb1001-1697" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1698"><a href="aplikace3.html#cb1001-1698" tabindex="-1"></a>                              <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1001-1699"><a href="aplikace3.html#cb1001-1699" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1700"><a href="aplikace3.html#cb1001-1700" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1701"><a href="aplikace3.html#cb1001-1701" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb1001-1702"><a href="aplikace3.html#cb1001-1702" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1703"><a href="aplikace3.html#cb1001-1703" tabindex="-1"></a>          </span>
<span id="cb1001-1704"><a href="aplikace3.html#cb1001-1704" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1705"><a href="aplikace3.html#cb1001-1705" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-1706"><a href="aplikace3.html#cb1001-1706" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1707"><a href="aplikace3.html#cb1001-1707" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1708"><a href="aplikace3.html#cb1001-1708" tabindex="-1"></a>          </span>
<span id="cb1001-1709"><a href="aplikace3.html#cb1001-1709" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1710"><a href="aplikace3.html#cb1001-1710" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1001-1711"><a href="aplikace3.html#cb1001-1711" tabindex="-1"></a>        }</span>
<span id="cb1001-1712"><a href="aplikace3.html#cb1001-1712" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1001-1713"><a href="aplikace3.html#cb1001-1713" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1001-1714"><a href="aplikace3.html#cb1001-1714" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1715"><a href="aplikace3.html#cb1001-1715" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1716"><a href="aplikace3.html#cb1001-1716" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1001-1717"><a href="aplikace3.html#cb1001-1717" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1718"><a href="aplikace3.html#cb1001-1718" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1719"><a href="aplikace3.html#cb1001-1719" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1001-1720"><a href="aplikace3.html#cb1001-1720" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1721"><a href="aplikace3.html#cb1001-1721" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1722"><a href="aplikace3.html#cb1001-1722" tabindex="-1"></a>      }</span>
<span id="cb1001-1723"><a href="aplikace3.html#cb1001-1723" tabindex="-1"></a>    }</span>
<span id="cb1001-1724"><a href="aplikace3.html#cb1001-1724" tabindex="-1"></a>  }</span>
<span id="cb1001-1725"><a href="aplikace3.html#cb1001-1725" tabindex="-1"></a>  </span>
<span id="cb1001-1726"><a href="aplikace3.html#cb1001-1726" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1001-1727"><a href="aplikace3.html#cb1001-1727" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1001-1728"><a href="aplikace3.html#cb1001-1728" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1001-1729"><a href="aplikace3.html#cb1001-1729" tabindex="-1"></a>  }</span>
<span id="cb1001-1730"><a href="aplikace3.html#cb1001-1730" tabindex="-1"></a>  </span>
<span id="cb1001-1731"><a href="aplikace3.html#cb1001-1731" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb1001-1732"><a href="aplikace3.html#cb1001-1732" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb1001-1733"><a href="aplikace3.html#cb1001-1733" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb1001-1734"><a href="aplikace3.html#cb1001-1734" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb1001-1735"><a href="aplikace3.html#cb1001-1735" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb1001-1736"><a href="aplikace3.html#cb1001-1736" tabindex="-1"></a>  </span>
<span id="cb1001-1737"><a href="aplikace3.html#cb1001-1737" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1738"><a href="aplikace3.html#cb1001-1738" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1739"><a href="aplikace3.html#cb1001-1739" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1001-1740"><a href="aplikace3.html#cb1001-1740" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1001-1741"><a href="aplikace3.html#cb1001-1741" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1001-1742"><a href="aplikace3.html#cb1001-1742" tabindex="-1"></a>  </span>
<span id="cb1001-1743"><a href="aplikace3.html#cb1001-1743" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-1744"><a href="aplikace3.html#cb1001-1744" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-1745"><a href="aplikace3.html#cb1001-1745" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-1746"><a href="aplikace3.html#cb1001-1746" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1001-1747"><a href="aplikace3.html#cb1001-1747" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1001-1748"><a href="aplikace3.html#cb1001-1748" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1001-1749"><a href="aplikace3.html#cb1001-1749" tabindex="-1"></a>  </span>
<span id="cb1001-1750"><a href="aplikace3.html#cb1001-1750" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb1001-1751"><a href="aplikace3.html#cb1001-1751" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1001-1752"><a href="aplikace3.html#cb1001-1752" tabindex="-1"></a>  </span>
<span id="cb1001-1753"><a href="aplikace3.html#cb1001-1753" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1754"><a href="aplikace3.html#cb1001-1754" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1755"><a href="aplikace3.html#cb1001-1755" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1001-1756"><a href="aplikace3.html#cb1001-1756" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1001-1757"><a href="aplikace3.html#cb1001-1757" tabindex="-1"></a>  </span>
<span id="cb1001-1758"><a href="aplikace3.html#cb1001-1758" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1759"><a href="aplikace3.html#cb1001-1759" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb1001-1760"><a href="aplikace3.html#cb1001-1760" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb1001-1761"><a href="aplikace3.html#cb1001-1761" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb1001-1762"><a href="aplikace3.html#cb1001-1762" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1001-1763"><a href="aplikace3.html#cb1001-1763" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1764"><a href="aplikace3.html#cb1001-1764" tabindex="-1"></a>  </span>
<span id="cb1001-1765"><a href="aplikace3.html#cb1001-1765" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1766"><a href="aplikace3.html#cb1001-1766" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1767"><a href="aplikace3.html#cb1001-1767" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1001-1768"><a href="aplikace3.html#cb1001-1768" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb1001-1769"><a href="aplikace3.html#cb1001-1769" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb1001-1770"><a href="aplikace3.html#cb1001-1770" tabindex="-1"></a>    </span>
<span id="cb1001-1771"><a href="aplikace3.html#cb1001-1771" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1001-1772"><a href="aplikace3.html#cb1001-1772" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-1773"><a href="aplikace3.html#cb1001-1773" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-1774"><a href="aplikace3.html#cb1001-1774" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-1775"><a href="aplikace3.html#cb1001-1775" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1001-1776"><a href="aplikace3.html#cb1001-1776" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1001-1777"><a href="aplikace3.html#cb1001-1777" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1001-1778"><a href="aplikace3.html#cb1001-1778" tabindex="-1"></a>    </span>
<span id="cb1001-1779"><a href="aplikace3.html#cb1001-1779" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1001-1780"><a href="aplikace3.html#cb1001-1780" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1781"><a href="aplikace3.html#cb1001-1781" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-1782"><a href="aplikace3.html#cb1001-1782" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-1783"><a href="aplikace3.html#cb1001-1783" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-1784"><a href="aplikace3.html#cb1001-1784" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1001-1785"><a href="aplikace3.html#cb1001-1785" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-1786"><a href="aplikace3.html#cb1001-1786" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1001-1787"><a href="aplikace3.html#cb1001-1787" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1788"><a href="aplikace3.html#cb1001-1788" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1789"><a href="aplikace3.html#cb1001-1789" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1001-1790"><a href="aplikace3.html#cb1001-1790" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb1001-1791"><a href="aplikace3.html#cb1001-1791" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1001-1792"><a href="aplikace3.html#cb1001-1792" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1001-1793"><a href="aplikace3.html#cb1001-1793" tabindex="-1"></a>    }</span>
<span id="cb1001-1794"><a href="aplikace3.html#cb1001-1794" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1001-1795"><a href="aplikace3.html#cb1001-1795" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1001-1796"><a href="aplikace3.html#cb1001-1796" tabindex="-1"></a>    </span>
<span id="cb1001-1797"><a href="aplikace3.html#cb1001-1797" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1001-1798"><a href="aplikace3.html#cb1001-1798" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-1799"><a href="aplikace3.html#cb1001-1799" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-1800"><a href="aplikace3.html#cb1001-1800" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1001-1801"><a href="aplikace3.html#cb1001-1801" tabindex="-1"></a>    </span>
<span id="cb1001-1802"><a href="aplikace3.html#cb1001-1802" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-1803"><a href="aplikace3.html#cb1001-1803" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1804"><a href="aplikace3.html#cb1001-1804" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-1805"><a href="aplikace3.html#cb1001-1805" tabindex="-1"></a>    }</span>
<span id="cb1001-1806"><a href="aplikace3.html#cb1001-1806" tabindex="-1"></a>    </span>
<span id="cb1001-1807"><a href="aplikace3.html#cb1001-1807" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1001-1808"><a href="aplikace3.html#cb1001-1808" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1001-1809"><a href="aplikace3.html#cb1001-1809" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1001-1810"><a href="aplikace3.html#cb1001-1810" tabindex="-1"></a>  </span>
<span id="cb1001-1811"><a href="aplikace3.html#cb1001-1811" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1812"><a href="aplikace3.html#cb1001-1812" tabindex="-1"></a>  </span>
<span id="cb1001-1813"><a href="aplikace3.html#cb1001-1813" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-1814"><a href="aplikace3.html#cb1001-1814" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1001-1815"><a href="aplikace3.html#cb1001-1815" tabindex="-1"></a>    </span>
<span id="cb1001-1816"><a href="aplikace3.html#cb1001-1816" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-1817"><a href="aplikace3.html#cb1001-1817" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-1818"><a href="aplikace3.html#cb1001-1818" tabindex="-1"></a>    </span>
<span id="cb1001-1819"><a href="aplikace3.html#cb1001-1819" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1820"><a href="aplikace3.html#cb1001-1820" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-1821"><a href="aplikace3.html#cb1001-1821" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1822"><a href="aplikace3.html#cb1001-1822" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1823"><a href="aplikace3.html#cb1001-1823" tabindex="-1"></a>                        <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1001-1824"><a href="aplikace3.html#cb1001-1824" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1825"><a href="aplikace3.html#cb1001-1825" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1826"><a href="aplikace3.html#cb1001-1826" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1001-1827"><a href="aplikace3.html#cb1001-1827" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1828"><a href="aplikace3.html#cb1001-1828" tabindex="-1"></a>    </span>
<span id="cb1001-1829"><a href="aplikace3.html#cb1001-1829" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-1830"><a href="aplikace3.html#cb1001-1830" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1001-1831"><a href="aplikace3.html#cb1001-1831" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-1832"><a href="aplikace3.html#cb1001-1832" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1833"><a href="aplikace3.html#cb1001-1833" tabindex="-1"></a>      </span>
<span id="cb1001-1834"><a href="aplikace3.html#cb1001-1834" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-1835"><a href="aplikace3.html#cb1001-1835" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-1836"><a href="aplikace3.html#cb1001-1836" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1837"><a href="aplikace3.html#cb1001-1837" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1838"><a href="aplikace3.html#cb1001-1838" tabindex="-1"></a>    </span>
<span id="cb1001-1839"><a href="aplikace3.html#cb1001-1839" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1840"><a href="aplikace3.html#cb1001-1840" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1001-1841"><a href="aplikace3.html#cb1001-1841" tabindex="-1"></a>  }</span>
<span id="cb1001-1842"><a href="aplikace3.html#cb1001-1842" tabindex="-1"></a>  </span>
<span id="cb1001-1843"><a href="aplikace3.html#cb1001-1843" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-1844"><a href="aplikace3.html#cb1001-1844" tabindex="-1"></a>  </span>
<span id="cb1001-1845"><a href="aplikace3.html#cb1001-1845" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb1001-1846"><a href="aplikace3.html#cb1001-1846" tabindex="-1"></a>  </span>
<span id="cb1001-1847"><a href="aplikace3.html#cb1001-1847" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb1001-1848"><a href="aplikace3.html#cb1001-1848" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb1001-1849"><a href="aplikace3.html#cb1001-1849" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb1001-1850"><a href="aplikace3.html#cb1001-1850" tabindex="-1"></a>  }</span>
<span id="cb1001-1851"><a href="aplikace3.html#cb1001-1851" tabindex="-1"></a>  </span>
<span id="cb1001-1852"><a href="aplikace3.html#cb1001-1852" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1001-1853"><a href="aplikace3.html#cb1001-1853" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1001-1854"><a href="aplikace3.html#cb1001-1854" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1001-1855"><a href="aplikace3.html#cb1001-1855" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1001-1856"><a href="aplikace3.html#cb1001-1856" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb1001-1857"><a href="aplikace3.html#cb1001-1857" tabindex="-1"></a>      }</span>
<span id="cb1001-1858"><a href="aplikace3.html#cb1001-1858" tabindex="-1"></a>    }</span>
<span id="cb1001-1859"><a href="aplikace3.html#cb1001-1859" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1001-1860"><a href="aplikace3.html#cb1001-1860" tabindex="-1"></a>  }</span>
<span id="cb1001-1861"><a href="aplikace3.html#cb1001-1861" tabindex="-1"></a>  </span>
<span id="cb1001-1862"><a href="aplikace3.html#cb1001-1862" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1001-1863"><a href="aplikace3.html#cb1001-1863" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1001-1864"><a href="aplikace3.html#cb1001-1864" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1865"><a href="aplikace3.html#cb1001-1865" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1866"><a href="aplikace3.html#cb1001-1866" tabindex="-1"></a>  </span>
<span id="cb1001-1867"><a href="aplikace3.html#cb1001-1867" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1001-1868"><a href="aplikace3.html#cb1001-1868" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1001-1869"><a href="aplikace3.html#cb1001-1869" tabindex="-1"></a>  </span>
<span id="cb1001-1870"><a href="aplikace3.html#cb1001-1870" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1001-1871"><a href="aplikace3.html#cb1001-1871" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1001-1872"><a href="aplikace3.html#cb1001-1872" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb1001-1873"><a href="aplikace3.html#cb1001-1873" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb1001-1874"><a href="aplikace3.html#cb1001-1874" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1001-1875"><a href="aplikace3.html#cb1001-1875" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1001-1876"><a href="aplikace3.html#cb1001-1876" tabindex="-1"></a>  </span>
<span id="cb1001-1877"><a href="aplikace3.html#cb1001-1877" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1001-1878"><a href="aplikace3.html#cb1001-1878" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1879"><a href="aplikace3.html#cb1001-1879" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1880"><a href="aplikace3.html#cb1001-1880" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1881"><a href="aplikace3.html#cb1001-1881" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1001-1882"><a href="aplikace3.html#cb1001-1882" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1001-1883"><a href="aplikace3.html#cb1001-1883" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1001-1884"><a href="aplikace3.html#cb1001-1884" tabindex="-1"></a>  </span>
<span id="cb1001-1885"><a href="aplikace3.html#cb1001-1885" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1001-1886"><a href="aplikace3.html#cb1001-1886" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb1001-1887"><a href="aplikace3.html#cb1001-1887" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-1888"><a href="aplikace3.html#cb1001-1888" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-1889"><a href="aplikace3.html#cb1001-1889" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-1890"><a href="aplikace3.html#cb1001-1890" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1001-1891"><a href="aplikace3.html#cb1001-1891" tabindex="-1"></a>  </span>
<span id="cb1001-1892"><a href="aplikace3.html#cb1001-1892" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1001-1893"><a href="aplikace3.html#cb1001-1893" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1894"><a href="aplikace3.html#cb1001-1894" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-1895"><a href="aplikace3.html#cb1001-1895" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-1896"><a href="aplikace3.html#cb1001-1896" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-1897"><a href="aplikace3.html#cb1001-1897" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1001-1898"><a href="aplikace3.html#cb1001-1898" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-1899"><a href="aplikace3.html#cb1001-1899" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb1001-1900"><a href="aplikace3.html#cb1001-1900" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps)</span>
<span id="cb1001-1901"><a href="aplikace3.html#cb1001-1901" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1001-1902"><a href="aplikace3.html#cb1001-1902" tabindex="-1"></a>  }</span>
<span id="cb1001-1903"><a href="aplikace3.html#cb1001-1903" tabindex="-1"></a>  </span>
<span id="cb1001-1904"><a href="aplikace3.html#cb1001-1904" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb1001-1905"><a href="aplikace3.html#cb1001-1905" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1001-1906"><a href="aplikace3.html#cb1001-1906" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-1907"><a href="aplikace3.html#cb1001-1907" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-1908"><a href="aplikace3.html#cb1001-1908" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1001-1909"><a href="aplikace3.html#cb1001-1909" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-1910"><a href="aplikace3.html#cb1001-1910" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-1911"><a href="aplikace3.html#cb1001-1911" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1001-1912"><a href="aplikace3.html#cb1001-1912" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-1913"><a href="aplikace3.html#cb1001-1913" tabindex="-1"></a>    }</span>
<span id="cb1001-1914"><a href="aplikace3.html#cb1001-1914" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb1001-1915"><a href="aplikace3.html#cb1001-1915" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1001-1916"><a href="aplikace3.html#cb1001-1916" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1001-1917"><a href="aplikace3.html#cb1001-1917" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1001-1918"><a href="aplikace3.html#cb1001-1918" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1001-1919"><a href="aplikace3.html#cb1001-1919" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1001-1920"><a href="aplikace3.html#cb1001-1920" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1001-1921"><a href="aplikace3.html#cb1001-1921" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1922"><a href="aplikace3.html#cb1001-1922" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1001-1923"><a href="aplikace3.html#cb1001-1923" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1001-1924"><a href="aplikace3.html#cb1001-1924" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1001-1925"><a href="aplikace3.html#cb1001-1925" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1926"><a href="aplikace3.html#cb1001-1926" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1927"><a href="aplikace3.html#cb1001-1927" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1928"><a href="aplikace3.html#cb1001-1928" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-1929"><a href="aplikace3.html#cb1001-1929" tabindex="-1"></a>      </span>
<span id="cb1001-1930"><a href="aplikace3.html#cb1001-1930" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-1931"><a href="aplikace3.html#cb1001-1931" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1001-1932"><a href="aplikace3.html#cb1001-1932" tabindex="-1"></a>        </span>
<span id="cb1001-1933"><a href="aplikace3.html#cb1001-1933" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-1934"><a href="aplikace3.html#cb1001-1934" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1001-1935"><a href="aplikace3.html#cb1001-1935" tabindex="-1"></a>        </span>
<span id="cb1001-1936"><a href="aplikace3.html#cb1001-1936" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-1937"><a href="aplikace3.html#cb1001-1937" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-1938"><a href="aplikace3.html#cb1001-1938" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-1939"><a href="aplikace3.html#cb1001-1939" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-1940"><a href="aplikace3.html#cb1001-1940" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb1001-1941"><a href="aplikace3.html#cb1001-1941" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-1942"><a href="aplikace3.html#cb1001-1942" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-1943"><a href="aplikace3.html#cb1001-1943" tabindex="-1"></a>        </span>
<span id="cb1001-1944"><a href="aplikace3.html#cb1001-1944" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1001-1945"><a href="aplikace3.html#cb1001-1945" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-1946"><a href="aplikace3.html#cb1001-1946" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-1947"><a href="aplikace3.html#cb1001-1947" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-1948"><a href="aplikace3.html#cb1001-1948" tabindex="-1"></a>        </span>
<span id="cb1001-1949"><a href="aplikace3.html#cb1001-1949" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-1950"><a href="aplikace3.html#cb1001-1950" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1001-1951"><a href="aplikace3.html#cb1001-1951" tabindex="-1"></a>      }</span>
<span id="cb1001-1952"><a href="aplikace3.html#cb1001-1952" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1001-1953"><a href="aplikace3.html#cb1001-1953" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1954"><a href="aplikace3.html#cb1001-1954" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1955"><a href="aplikace3.html#cb1001-1955" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1956"><a href="aplikace3.html#cb1001-1956" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1957"><a href="aplikace3.html#cb1001-1957" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1001-1958"><a href="aplikace3.html#cb1001-1958" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1001-1959"><a href="aplikace3.html#cb1001-1959" tabindex="-1"></a>    }</span>
<span id="cb1001-1960"><a href="aplikace3.html#cb1001-1960" tabindex="-1"></a>  }</span>
<span id="cb1001-1961"><a href="aplikace3.html#cb1001-1961" tabindex="-1"></a>  </span>
<span id="cb1001-1962"><a href="aplikace3.html#cb1001-1962" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1001-1963"><a href="aplikace3.html#cb1001-1963" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1001-1964"><a href="aplikace3.html#cb1001-1964" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb1001-1965"><a href="aplikace3.html#cb1001-1965" tabindex="-1"></a>  }</span>
<span id="cb1001-1966"><a href="aplikace3.html#cb1001-1966" tabindex="-1"></a>  </span>
<span id="cb1001-1967"><a href="aplikace3.html#cb1001-1967" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1968"><a href="aplikace3.html#cb1001-1968" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1001-1969"><a href="aplikace3.html#cb1001-1969" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1001-1970"><a href="aplikace3.html#cb1001-1970" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1001-1971"><a href="aplikace3.html#cb1001-1971" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1001-1972"><a href="aplikace3.html#cb1001-1972" tabindex="-1"></a>  </span>
<span id="cb1001-1973"><a href="aplikace3.html#cb1001-1973" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1001-1974"><a href="aplikace3.html#cb1001-1974" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1001-1975"><a href="aplikace3.html#cb1001-1975" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1001-1976"><a href="aplikace3.html#cb1001-1976" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1001-1977"><a href="aplikace3.html#cb1001-1977" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1001-1978"><a href="aplikace3.html#cb1001-1978" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1001-1979"><a href="aplikace3.html#cb1001-1979" tabindex="-1"></a>  </span>
<span id="cb1001-1980"><a href="aplikace3.html#cb1001-1980" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1001-1981"><a href="aplikace3.html#cb1001-1981" tabindex="-1"></a>  </span>
<span id="cb1001-1982"><a href="aplikace3.html#cb1001-1982" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1001-1983"><a href="aplikace3.html#cb1001-1983" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1001-1984"><a href="aplikace3.html#cb1001-1984" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1001-1985"><a href="aplikace3.html#cb1001-1985" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1001-1986"><a href="aplikace3.html#cb1001-1986" tabindex="-1"></a>  </span>
<span id="cb1001-1987"><a href="aplikace3.html#cb1001-1987" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1001-1988"><a href="aplikace3.html#cb1001-1988" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb1001-1989"><a href="aplikace3.html#cb1001-1989" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb1001-1990"><a href="aplikace3.html#cb1001-1990" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb1001-1991"><a href="aplikace3.html#cb1001-1991" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1001-1992"><a href="aplikace3.html#cb1001-1992" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1001-1993"><a href="aplikace3.html#cb1001-1993" tabindex="-1"></a>  </span>
<span id="cb1001-1994"><a href="aplikace3.html#cb1001-1994" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1001-1995"><a href="aplikace3.html#cb1001-1995" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1001-1996"><a href="aplikace3.html#cb1001-1996" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1001-1997"><a href="aplikace3.html#cb1001-1997" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb1001-1998"><a href="aplikace3.html#cb1001-1998" tabindex="-1"></a>    </span>
<span id="cb1001-1999"><a href="aplikace3.html#cb1001-1999" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1001-2000"><a href="aplikace3.html#cb1001-2000" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1001-2001"><a href="aplikace3.html#cb1001-2001" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1001-2002"><a href="aplikace3.html#cb1001-2002" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1001-2003"><a href="aplikace3.html#cb1001-2003" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1001-2004"><a href="aplikace3.html#cb1001-2004" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1001-2005"><a href="aplikace3.html#cb1001-2005" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1001-2006"><a href="aplikace3.html#cb1001-2006" tabindex="-1"></a>    </span>
<span id="cb1001-2007"><a href="aplikace3.html#cb1001-2007" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1001-2008"><a href="aplikace3.html#cb1001-2008" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-2009"><a href="aplikace3.html#cb1001-2009" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1001-2010"><a href="aplikace3.html#cb1001-2010" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1001-2011"><a href="aplikace3.html#cb1001-2011" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1001-2012"><a href="aplikace3.html#cb1001-2012" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1001-2013"><a href="aplikace3.html#cb1001-2013" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1001-2014"><a href="aplikace3.html#cb1001-2014" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1001-2015"><a href="aplikace3.html#cb1001-2015" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps)</span>
<span id="cb1001-2016"><a href="aplikace3.html#cb1001-2016" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1001-2017"><a href="aplikace3.html#cb1001-2017" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1001-2018"><a href="aplikace3.html#cb1001-2018" tabindex="-1"></a>    }</span>
<span id="cb1001-2019"><a href="aplikace3.html#cb1001-2019" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1001-2020"><a href="aplikace3.html#cb1001-2020" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1001-2021"><a href="aplikace3.html#cb1001-2021" tabindex="-1"></a>    </span>
<span id="cb1001-2022"><a href="aplikace3.html#cb1001-2022" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1001-2023"><a href="aplikace3.html#cb1001-2023" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1001-2024"><a href="aplikace3.html#cb1001-2024" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1001-2025"><a href="aplikace3.html#cb1001-2025" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1001-2026"><a href="aplikace3.html#cb1001-2026" tabindex="-1"></a>    </span>
<span id="cb1001-2027"><a href="aplikace3.html#cb1001-2027" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1001-2028"><a href="aplikace3.html#cb1001-2028" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1001-2029"><a href="aplikace3.html#cb1001-2029" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1001-2030"><a href="aplikace3.html#cb1001-2030" tabindex="-1"></a>    }</span>
<span id="cb1001-2031"><a href="aplikace3.html#cb1001-2031" tabindex="-1"></a>    </span>
<span id="cb1001-2032"><a href="aplikace3.html#cb1001-2032" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1001-2033"><a href="aplikace3.html#cb1001-2033" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1001-2034"><a href="aplikace3.html#cb1001-2034" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1001-2035"><a href="aplikace3.html#cb1001-2035" tabindex="-1"></a>  </span>
<span id="cb1001-2036"><a href="aplikace3.html#cb1001-2036" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1001-2037"><a href="aplikace3.html#cb1001-2037" tabindex="-1"></a>  </span>
<span id="cb1001-2038"><a href="aplikace3.html#cb1001-2038" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1001-2039"><a href="aplikace3.html#cb1001-2039" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1001-2040"><a href="aplikace3.html#cb1001-2040" tabindex="-1"></a>    </span>
<span id="cb1001-2041"><a href="aplikace3.html#cb1001-2041" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1001-2042"><a href="aplikace3.html#cb1001-2042" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1001-2043"><a href="aplikace3.html#cb1001-2043" tabindex="-1"></a>    </span>
<span id="cb1001-2044"><a href="aplikace3.html#cb1001-2044" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1001-2045"><a href="aplikace3.html#cb1001-2045" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1001-2046"><a href="aplikace3.html#cb1001-2046" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1001-2047"><a href="aplikace3.html#cb1001-2047" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1001-2048"><a href="aplikace3.html#cb1001-2048" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1001-2049"><a href="aplikace3.html#cb1001-2049" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1001-2050"><a href="aplikace3.html#cb1001-2050" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1001-2051"><a href="aplikace3.html#cb1001-2051" tabindex="-1"></a>    </span>
<span id="cb1001-2052"><a href="aplikace3.html#cb1001-2052" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1001-2053"><a href="aplikace3.html#cb1001-2053" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1001-2054"><a href="aplikace3.html#cb1001-2054" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1001-2055"><a href="aplikace3.html#cb1001-2055" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-2056"><a href="aplikace3.html#cb1001-2056" tabindex="-1"></a>      </span>
<span id="cb1001-2057"><a href="aplikace3.html#cb1001-2057" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1001-2058"><a href="aplikace3.html#cb1001-2058" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1001-2059"><a href="aplikace3.html#cb1001-2059" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1001-2060"><a href="aplikace3.html#cb1001-2060" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1001-2061"><a href="aplikace3.html#cb1001-2061" tabindex="-1"></a>    </span>
<span id="cb1001-2062"><a href="aplikace3.html#cb1001-2062" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1001-2063"><a href="aplikace3.html#cb1001-2063" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1001-2064"><a href="aplikace3.html#cb1001-2064" tabindex="-1"></a>  }</span>
<span id="cb1001-2065"><a href="aplikace3.html#cb1001-2065" tabindex="-1"></a>  </span>
<span id="cb1001-2066"><a href="aplikace3.html#cb1001-2066" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1001-2067"><a href="aplikace3.html#cb1001-2067" tabindex="-1"></a>  </span>
<span id="cb1001-2068"><a href="aplikace3.html#cb1001-2068" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb1001-2069"><a href="aplikace3.html#cb1001-2069" tabindex="-1"></a>  </span>
<span id="cb1001-2070"><a href="aplikace3.html#cb1001-2070" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb1001-2071"><a href="aplikace3.html#cb1001-2071" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb1001-2072"><a href="aplikace3.html#cb1001-2072" tabindex="-1"></a>  </span>
<span id="cb1001-2073"><a href="aplikace3.html#cb1001-2073" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb1001-2074"><a href="aplikace3.html#cb1001-2074" tabindex="-1"></a>}</span>
<span id="cb1001-2075"><a href="aplikace3.html#cb1001-2075" tabindex="-1"></a></span>
<span id="cb1001-2076"><a href="aplikace3.html#cb1001-2076" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb1001-2077"><a href="aplikace3.html#cb1001-2077" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03neder.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Now we will compute the average test and training error rates for individual classification methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1002"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1002-1"><a href="aplikace3.html#cb1002-1" tabindex="-1"></a><span class="co"># Add to the final table</span></span>
<span id="cb1002-2"><a href="aplikace3.html#cb1002-2" tabindex="-1"></a></span>
<span id="cb1002-3"><a href="aplikace3.html#cb1002-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb1002-4"><a href="aplikace3.html#cb1002-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb1002-5"><a href="aplikace3.html#cb1002-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb1002-6"><a href="aplikace3.html#cb1002-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb1002-7"><a href="aplikace3.html#cb1002-7" tabindex="-1"></a></span>
<span id="cb1002-8"><a href="aplikace3.html#cb1002-8" tabindex="-1"></a><span class="co"># Save the final values </span></span>
<span id="cb1002-9"><a href="aplikace3.html#cb1002-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03neder_res.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="results-3" class="section level4 hasAnchor" number="6.5.1.1">
<h4><span class="header-section-number">6.5.1.1</span> Results<a href="aplikace3.html#results-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-244">Table 6.17: </span>Summary of the results of the methods applied to simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error, <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes testing error, <span class="math inline">\(\widehat{SD}_{train}\)</span> denotes the estimate of the standard deviation of training errors, and <span class="math inline">\(\widehat{SD}_{test}\)</span> is the estimate of the standard deviation of testing errors.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.1715</td>
<td align="right">0.1768</td>
<td align="right">0.0271</td>
<td align="right">0.0511</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.3001</td>
<td align="right">0.3152</td>
<td align="right">0.0222</td>
<td align="right">0.0447</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.3019</td>
<td align="right">0.3237</td>
<td align="right">0.0229</td>
<td align="right">0.0459</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0017</td>
<td align="right">0.0486</td>
<td align="right">0.0076</td>
<td align="right">0.0401</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.2922</td>
<td align="right">0.3118</td>
<td align="right">0.0223</td>
<td align="right">0.0480</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1943</td>
<td align="right">0.2862</td>
<td align="right">0.0495</td>
<td align="right">0.0577</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.2502</td>
<td align="right">0.3448</td>
<td align="right">0.0523</td>
<td align="right">0.0566</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1901</td>
<td align="right">0.2843</td>
<td align="right">0.0433</td>
<td align="right">0.0581</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0131</td>
<td align="right">0.1985</td>
<td align="right">0.0089</td>
<td align="right">0.0479</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0365</td>
<td align="right">0.3128</td>
<td align="right">0.0119</td>
<td align="right">0.0535</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0127</td>
<td align="right">0.1991</td>
<td align="right">0.0080</td>
<td align="right">0.0491</td>
</tr>
<tr class="even">
<td>SVM linear - func</td>
<td align="right">0.0077</td>
<td align="right">0.0269</td>
<td align="right">0.0077</td>
<td align="right">0.0221</td>
</tr>
<tr class="odd">
<td>SVM poly - func</td>
<td align="right">0.0112</td>
<td align="right">0.0483</td>
<td align="right">0.0130</td>
<td align="right">0.0264</td>
</tr>
<tr class="even">
<td>SVM rbf - func</td>
<td align="right">0.0052</td>
<td align="right">0.0315</td>
<td align="right">0.0060</td>
<td align="right">0.0244</td>
</tr>
<tr class="odd">
<td>SVM linear - discr</td>
<td align="right">0.0041</td>
<td align="right">0.0238</td>
<td align="right">0.0051</td>
<td align="right">0.0196</td>
</tr>
<tr class="even">
<td>SVM poly - discr</td>
<td align="right">0.0130</td>
<td align="right">0.0406</td>
<td align="right">0.0111</td>
<td align="right">0.0257</td>
</tr>
<tr class="odd">
<td>SVM rbf - discr</td>
<td align="right">0.0051</td>
<td align="right">0.0355</td>
<td align="right">0.0080</td>
<td align="right">0.0228</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.2980</td>
<td align="right">0.3278</td>
<td align="right">0.0232</td>
<td align="right">0.0521</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.2790</td>
<td align="right">0.3462</td>
<td align="right">0.0391</td>
<td align="right">0.0506</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.1665</td>
<td align="right">0.3363</td>
<td align="right">0.1006</td>
<td align="right">0.0470</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0078</td>
<td align="right">0.0246</td>
<td align="right">0.0081</td>
<td align="right">0.0203</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.0105</td>
<td align="right">0.0434</td>
<td align="right">0.0091</td>
<td align="right">0.0248</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0221</td>
<td align="right">0.0486</td>
<td align="right">0.0153</td>
<td align="right">0.0295</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.0321</td>
<td align="right">0.0389</td>
<td align="right">0.0100</td>
<td align="right">0.0252</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0353</td>
<td align="right">0.0508</td>
<td align="right">0.0130</td>
<td align="right">0.0343</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.1385</td>
<td align="right">0.1868</td>
<td align="right">0.0293</td>
<td align="right">0.0558</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0009</td>
<td align="right">0.0215</td>
<td align="right">0.0025</td>
<td align="right">0.0167</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0013</td>
<td align="right">0.0151</td>
<td align="right">0.0026</td>
<td align="right">0.0187</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0027</td>
<td align="right">0.0208</td>
<td align="right">0.0038</td>
<td align="right">0.0158</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0562</td>
<td align="right">0.0805</td>
<td align="right">0.0129</td>
<td align="right">0.0316</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0292</td>
<td align="right">0.0898</td>
<td align="right">0.0138</td>
<td align="right">0.0299</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0297</td>
<td align="right">0.0674</td>
<td align="right">0.0097</td>
<td align="right">0.0334</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.0467</td>
<td align="right">0.0802</td>
<td align="right">0.0143</td>
<td align="right">0.0326</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0403</td>
<td align="right">0.0737</td>
<td align="right">0.0116</td>
<td align="right">0.0291</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.0775</td>
<td align="right">0.1118</td>
<td align="right">0.0188</td>
<td align="right">0.0408</td>
</tr>
</tbody>
</table>
<p>The table above includes all the computed characteristics. It also includes standard deviations to allow comparison of the consistency or variability of the individual methods.</p>
<p>We can also formally test whether some methods are more successful than others. Given the violation of the normality assumption, we cannot use the classical paired t-test. We will utilize its non-parametric alternative - the Wilcoxon test.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1003"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1003-1"><a href="aplikace3.html#cb1003-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.0007795578</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1005"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1005-1"><a href="aplikace3.html#cb1005-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.1468789</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1007"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1007-1"><a href="aplikace3.html#cb1007-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.2632162</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1009"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1009-1"><a href="aplikace3.html#cb1009-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 2.025628e-09</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1011"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1011-1"><a href="aplikace3.html#cb1011-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 3.134111e-11</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1013"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1013-1"><a href="aplikace3.html#cb1013-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 6.198434e-10</code></pre>
<p>Finally, we can graphically display the computed values from the simulation for the individual classification methods using box plots, separately for test and training error rates.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1015"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1015-1"><a href="aplikace3.html#cb1015-1" tabindex="-1"></a><span class="co"># Rename classification methods</span></span>
<span id="cb1015-2"><a href="aplikace3.html#cb1015-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1015-3"><a href="aplikace3.html#cb1015-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb1015-4"><a href="aplikace3.html#cb1015-4" tabindex="-1"></a>      <span class="st">&#39;Linear Discriminant Analysis&#39;</span>,</span>
<span id="cb1015-5"><a href="aplikace3.html#cb1015-5" tabindex="-1"></a>      <span class="st">&#39;Quadratic Discriminant Analysis&#39;</span>,</span>
<span id="cb1015-6"><a href="aplikace3.html#cb1015-6" tabindex="-1"></a>      <span class="st">&#39;Functional Logistic Regression&#39;</span>,</span>
<span id="cb1015-7"><a href="aplikace3.html#cb1015-7" tabindex="-1"></a>      <span class="st">&#39;Logistic Regression with fPCA&#39;</span>,</span>
<span id="cb1015-8"><a href="aplikace3.html#cb1015-8" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- discretization&#39;</span>,</span>
<span id="cb1015-9"><a href="aplikace3.html#cb1015-9" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- fPCA&#39;</span>,</span>
<span id="cb1015-10"><a href="aplikace3.html#cb1015-10" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- basis coefficients&#39;</span>,</span>
<span id="cb1015-11"><a href="aplikace3.html#cb1015-11" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- discretization&#39;</span>,</span>
<span id="cb1015-12"><a href="aplikace3.html#cb1015-12" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- fPCA&#39;</span>,</span>
<span id="cb1015-13"><a href="aplikace3.html#cb1015-13" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- basis coefficients&#39;</span>,</span>
<span id="cb1015-14"><a href="aplikace3.html#cb1015-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- discretization&#39;</span>,</span>
<span id="cb1015-15"><a href="aplikace3.html#cb1015-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- discretization&#39;</span>,</span>
<span id="cb1015-16"><a href="aplikace3.html#cb1015-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- discretization&#39;</span>,</span>
<span id="cb1015-17"><a href="aplikace3.html#cb1015-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb1015-18"><a href="aplikace3.html#cb1015-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb1015-19"><a href="aplikace3.html#cb1015-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb1015-20"><a href="aplikace3.html#cb1015-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- basis coefficients&#39;</span>,</span>
<span id="cb1015-21"><a href="aplikace3.html#cb1015-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- basis coefficients&#39;</span>,</span>
<span id="cb1015-22"><a href="aplikace3.html#cb1015-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- basis coefficients&#39;</span>,</span>
<span id="cb1015-23"><a href="aplikace3.html#cb1015-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projection&#39;</span>,</span>
<span id="cb1015-24"><a href="aplikace3.html#cb1015-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projection&#39;</span>,</span>
<span id="cb1015-25"><a href="aplikace3.html#cb1015-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projection&#39;</span>,</span>
<span id="cb1015-26"><a href="aplikace3.html#cb1015-26" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb1015-27"><a href="aplikace3.html#cb1015-27" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb1015-28"><a href="aplikace3.html#cb1015-28" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb1015-29"><a href="aplikace3.html#cb1015-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb1015-30"><a href="aplikace3.html#cb1015-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb1015-31"><a href="aplikace3.html#cb1015-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb1015-32"><a href="aplikace3.html#cb1015-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb1015-33"><a href="aplikace3.html#cb1015-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb1015-34"><a href="aplikace3.html#cb1015-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb1015-35"><a href="aplikace3.html#cb1015-35" tabindex="-1"></a>)</span>
<span id="cb1015-36"><a href="aplikace3.html#cb1015-36" tabindex="-1"></a></span>
<span id="cb1015-37"><a href="aplikace3.html#cb1015-37" tabindex="-1"></a><span class="co"># Colors for boxplots </span></span>
<span id="cb1015-38"><a href="aplikace3.html#cb1015-38" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb1015-39"><a href="aplikace3.html#cb1015-39" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb1015-40"><a href="aplikace3.html#cb1015-40" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb1015-41"><a href="aplikace3.html#cb1015-41" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb1015-42"><a href="aplikace3.html#cb1015-42" tabindex="-1"></a></span>
<span id="cb1015-43"><a href="aplikace3.html#cb1015-43" tabindex="-1"></a><span class="co"># Alpha for boxplots</span></span>
<span id="cb1015-44"><a href="aplikace3.html#cb1015-44" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb1015-45"><a href="aplikace3.html#cb1015-45" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb1015-46"><a href="aplikace3.html#cb1015-46" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1016"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1016-1"><a href="aplikace3.html#cb1016-1" tabindex="-1"></a>sub_methods <span class="ot">&lt;-</span> methods[<span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">32</span>)]</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1017"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1017-1"><a href="aplikace3.html#cb1017-1" tabindex="-1"></a><span class="co"># for training data</span></span>
<span id="cb1017-2"><a href="aplikace3.html#cb1017-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb1017-3"><a href="aplikace3.html#cb1017-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1017-4"><a href="aplikace3.html#cb1017-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1017-5"><a href="aplikace3.html#cb1017-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb1017-6"><a href="aplikace3.html#cb1017-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb1017-7"><a href="aplikace3.html#cb1017-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb1017-8"><a href="aplikace3.html#cb1017-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1017-9"><a href="aplikace3.html#cb1017-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1017-10"><a href="aplikace3.html#cb1017-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb1017-11"><a href="aplikace3.html#cb1017-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb1017-12"><a href="aplikace3.html#cb1017-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb1017-13"><a href="aplikace3.html#cb1017-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">60</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1017-14"><a href="aplikace3.html#cb1017-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb1017-15"><a href="aplikace3.html#cb1017-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb1017-16"><a href="aplikace3.html#cb1017-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb1017-17"><a href="aplikace3.html#cb1017-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb1017-18"><a href="aplikace3.html#cb1017-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb1017-19"><a href="aplikace3.html#cb1017-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-248"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-248-1.png" alt="Box plots of training error rates for 100 simulations separately for each classification method. The black symbols $+$ denote the means." width="672" />
<p class="caption">
Figure 6.18: Box plots of training error rates for 100 simulations separately for each classification method. The black symbols <span class="math inline">\(+\)</span> denote the means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1018"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1018-1"><a href="aplikace3.html#cb1018-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb1018-2"><a href="aplikace3.html#cb1018-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb1018-3"><a href="aplikace3.html#cb1018-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1018-4"><a href="aplikace3.html#cb1018-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1018-5"><a href="aplikace3.html#cb1018-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb1018-6"><a href="aplikace3.html#cb1018-6" tabindex="-1"></a>      <span class="fu">filter</span>(method <span class="sc">%in%</span> sub_methods) <span class="sc">|&gt;</span></span>
<span id="cb1018-7"><a href="aplikace3.html#cb1018-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span> </span>
<span id="cb1018-8"><a href="aplikace3.html#cb1018-8" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb1018-9"><a href="aplikace3.html#cb1018-9" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1018-10"><a href="aplikace3.html#cb1018-10" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb1018-11"><a href="aplikace3.html#cb1018-11" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1018-12"><a href="aplikace3.html#cb1018-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1018-13"><a href="aplikace3.html#cb1018-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb1018-14"><a href="aplikace3.html#cb1018-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">widehat{</span><span class="sc">\\</span><span class="st">textnormal{Err}}_{test}$&quot;</span></span>
<span id="cb1018-15"><a href="aplikace3.html#cb1018-15" tabindex="-1"></a>       <span class="co"># y = expression(widehat(Err)[test])</span></span>
<span id="cb1018-16"><a href="aplikace3.html#cb1018-16" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb1018-17"><a href="aplikace3.html#cb1018-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb1018-18"><a href="aplikace3.html#cb1018-18" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1018-19"><a href="aplikace3.html#cb1018-19" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb1018-20"><a href="aplikace3.html#cb1018-20" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1018-21"><a href="aplikace3.html#cb1018-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> methods_names1) <span class="sc">+</span></span>
<span id="cb1018-22"><a href="aplikace3.html#cb1018-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1018-23"><a href="aplikace3.html#cb1018-23" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> box_col1) <span class="sc">+</span></span>
<span id="cb1018-24"><a href="aplikace3.html#cb1018-24" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> box_alpha1) <span class="sc">+</span></span>
<span id="cb1018-25"><a href="aplikace3.html#cb1018-25" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb1018-26"><a href="aplikace3.html#cb1018-26" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;gray25&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-250"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-250-1.png" alt="Box plots of test error rates for 100 simulations separately for each classification method. The black symbols $+$ denote the means." width="672" />
<p class="caption">
Figure 6.19: Box plots of test error rates for 100 simulations separately for each classification method. The black symbols <span class="math inline">\(+\)</span> denote the means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1019"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1019-1"><a href="aplikace3.html#cb1019-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/results_tec_neder.tex&quot;, device = tikz, width = 7, height = 5)</span></span>
<span id="cb1019-2"><a href="aplikace3.html#cb1019-2" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_box_test_neder_subset.tex&quot;, device = tikz, width = 6.5, height = 5)</span></span></code></pre></div>
</details>
<p>Finally, let’s take a look at which hyperparameter values were the most frequently chosen.</p>
<table>
<caption><span id="tab:unnamed-chunk-252">Table 6.18: </span>Medians of hyperparameter values for selected methods where some hyperparameter was determined using cross-validation.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Median Hyperparameter Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">10.0</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">6.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">3.7</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">1.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">16.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">16.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">20.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">5.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">6.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">7.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">17.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">17.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">13.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1020"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1020-1"><a href="aplikace3.html#cb1020-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb1020-2"><a href="aplikace3.html#cb1020-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1020-3"><a href="aplikace3.html#cb1020-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb1020-4"><a href="aplikace3.html#cb1020-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb1020-5"><a href="aplikace3.html#cb1020-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1020-6"><a href="aplikace3.html#cb1020-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb1020-7"><a href="aplikace3.html#cb1020-7" tabindex="-1"></a></span>
<span id="cb1020-8"><a href="aplikace3.html#cb1020-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1020-9"><a href="aplikace3.html#cb1020-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1020-10"><a href="aplikace3.html#cb1020-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1020-11"><a href="aplikace3.html#cb1020-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1020-12"><a href="aplikace3.html#cb1020-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1020-13"><a href="aplikace3.html#cb1020-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1020-14"><a href="aplikace3.html#cb1020-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb1020-15"><a href="aplikace3.html#cb1020-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb1020-16"><a href="aplikace3.html#cb1020-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1020-17"><a href="aplikace3.html#cb1020-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-253"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-253-1.png" alt="Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components." width="672" />
<p class="caption">
Figure 6.20: Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1021"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1021-1"><a href="aplikace3.html#cb1021-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1021-2"><a href="aplikace3.html#cb1021-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1021-3"><a href="aplikace3.html#cb1021-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1021-4"><a href="aplikace3.html#cb1021-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1021-5"><a href="aplikace3.html#cb1021-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1021-6"><a href="aplikace3.html#cb1021-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1021-7"><a href="aplikace3.html#cb1021-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb1021-8"><a href="aplikace3.html#cb1021-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb1021-9"><a href="aplikace3.html#cb1021-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1021-10"><a href="aplikace3.html#cb1021-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-255"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-255-1.png" alt="Histograms of hyperparameter values for SVM method with projection on B-spline basis." width="672" />
<p class="caption">
Figure 6.21: Histograms of hyperparameter values for SVM method with projection on B-spline basis.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1022"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1022-1"><a href="aplikace3.html#cb1022-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1022-2"><a href="aplikace3.html#cb1022-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb1022-3"><a href="aplikace3.html#cb1022-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb1022-4"><a href="aplikace3.html#cb1022-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1022-5"><a href="aplikace3.html#cb1022-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1022-6"><a href="aplikace3.html#cb1022-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1022-7"><a href="aplikace3.html#cb1022-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1022-8"><a href="aplikace3.html#cb1022-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1022-9"><a href="aplikace3.html#cb1022-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1022-10"><a href="aplikace3.html#cb1022-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb1022-11"><a href="aplikace3.html#cb1022-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1022-12"><a href="aplikace3.html#cb1022-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-257"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-257-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with radial kernel." width="672" />
<p class="caption">
Figure 6.22: Histograms of hyperparameter values for RKHS + SVM with radial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1023"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1023-1"><a href="aplikace3.html#cb1023-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1023-2"><a href="aplikace3.html#cb1023-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb1023-3"><a href="aplikace3.html#cb1023-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb1023-4"><a href="aplikace3.html#cb1023-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1023-5"><a href="aplikace3.html#cb1023-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1023-6"><a href="aplikace3.html#cb1023-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1023-7"><a href="aplikace3.html#cb1023-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1023-8"><a href="aplikace3.html#cb1023-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1023-9"><a href="aplikace3.html#cb1023-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1023-10"><a href="aplikace3.html#cb1023-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1023-11"><a href="aplikace3.html#cb1023-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1023-12"><a href="aplikace3.html#cb1023-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-259"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-259-1.png" alt="Histograms of hyperparameter values for the RKHS + SVM with polynomial kernel." width="672" />
<p class="caption">
Figure 6.23: Histograms of hyperparameter values for the RKHS + SVM with polynomial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1024"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1024-1"><a href="aplikace3.html#cb1024-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1024-2"><a href="aplikace3.html#cb1024-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb1024-3"><a href="aplikace3.html#cb1024-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1024-4"><a href="aplikace3.html#cb1024-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1024-5"><a href="aplikace3.html#cb1024-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1024-6"><a href="aplikace3.html#cb1024-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1024-7"><a href="aplikace3.html#cb1024-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1024-8"><a href="aplikace3.html#cb1024-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1024-9"><a href="aplikace3.html#cb1024-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1024-10"><a href="aplikace3.html#cb1024-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1024-11"><a href="aplikace3.html#cb1024-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-261"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-261-1.png" alt="Histograms of hyperparameter values for the RKHS + SVM with linear kernel." width="672" />
<p class="caption">
Figure 6.24: Histograms of hyperparameter values for the RKHS + SVM with linear kernel.
</p>
</div>
</div>
</div>
<div id="simulation-for-derivations" class="section level3 hasAnchor" number="6.5.2">
<h3><span class="header-section-number">6.5.2</span> Simulation for derivations<a href="aplikace3.html#simulation-for-derivations" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s finally take a look at the simulation of derived data (we determined the second derivative of the curves).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1025"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1025-1"><a href="aplikace3.html#cb1025-1" tabindex="-1"></a><span class="co"># Setting the random number generator</span></span>
<span id="cb1025-2"><a href="aplikace3.html#cb1025-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">41</span>)</span>
<span id="cb1025-3"><a href="aplikace3.html#cb1025-3" tabindex="-1"></a></span>
<span id="cb1025-4"><a href="aplikace3.html#cb1025-4" tabindex="-1"></a><span class="co"># Number of simulations</span></span>
<span id="cb1025-5"><a href="aplikace3.html#cb1025-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1025-6"><a href="aplikace3.html#cb1025-6" tabindex="-1"></a></span>
<span id="cb1025-7"><a href="aplikace3.html#cb1025-7" tabindex="-1"></a><span class="do">## List to store error values</span></span>
<span id="cb1025-8"><a href="aplikace3.html#cb1025-8" tabindex="-1"></a><span class="co"># Columns will represent methods</span></span>
<span id="cb1025-9"><a href="aplikace3.html#cb1025-9" tabindex="-1"></a><span class="co"># Rows will represent individual repetitions</span></span>
<span id="cb1025-10"><a href="aplikace3.html#cb1025-10" tabindex="-1"></a><span class="co"># List has two items ... train and test</span></span>
<span id="cb1025-11"><a href="aplikace3.html#cb1025-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb1025-12"><a href="aplikace3.html#cb1025-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>,</span>
<span id="cb1025-13"><a href="aplikace3.html#cb1025-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - func&#39;</span>, <span class="st">&#39;SVM poly - func&#39;</span>, <span class="st">&#39;SVM rbf - func&#39;</span>,</span>
<span id="cb1025-14"><a href="aplikace3.html#cb1025-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb1025-15"><a href="aplikace3.html#cb1025-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb1025-16"><a href="aplikace3.html#cb1025-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb1025-17"><a href="aplikace3.html#cb1025-17" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb1025-18"><a href="aplikace3.html#cb1025-18" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb1025-19"><a href="aplikace3.html#cb1025-19" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb1025-20"><a href="aplikace3.html#cb1025-20" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb1025-21"><a href="aplikace3.html#cb1025-21" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb1025-22"><a href="aplikace3.html#cb1025-22" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb1025-23"><a href="aplikace3.html#cb1025-23" tabindex="-1"></a></span>
<span id="cb1025-24"><a href="aplikace3.html#cb1025-24" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb1025-25"><a href="aplikace3.html#cb1025-25" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb1025-26"><a href="aplikace3.html#cb1025-26" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb1025-27"><a href="aplikace3.html#cb1025-27" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb1025-28"><a href="aplikace3.html#cb1025-28" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb1025-29"><a href="aplikace3.html#cb1025-29" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb1025-30"><a href="aplikace3.html#cb1025-30" tabindex="-1"></a></span>
<span id="cb1025-31"><a href="aplikace3.html#cb1025-31" tabindex="-1"></a><span class="co"># Object to store optimal hyperparameter values determined using CV</span></span>
<span id="cb1025-32"><a href="aplikace3.html#cb1025-32" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb1025-33"><a href="aplikace3.html#cb1025-33" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb1025-34"><a href="aplikace3.html#cb1025-34" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-35"><a href="aplikace3.html#cb1025-35" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-36"><a href="aplikace3.html#cb1025-36" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-37"><a href="aplikace3.html#cb1025-37" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb1025-38"><a href="aplikace3.html#cb1025-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-39"><a href="aplikace3.html#cb1025-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-40"><a href="aplikace3.html#cb1025-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-41"><a href="aplikace3.html#cb1025-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-42"><a href="aplikace3.html#cb1025-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-43"><a href="aplikace3.html#cb1025-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-44"><a href="aplikace3.html#cb1025-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-45"><a href="aplikace3.html#cb1025-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-46"><a href="aplikace3.html#cb1025-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-47"><a href="aplikace3.html#cb1025-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-48"><a href="aplikace3.html#cb1025-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-49"><a href="aplikace3.html#cb1025-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-50"><a href="aplikace3.html#cb1025-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-51"><a href="aplikace3.html#cb1025-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb1025-52"><a href="aplikace3.html#cb1025-52" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Now we will repeat the entire previous section 100 times, storing the error values in the <code>SIMULACE</code> list. We will then store the optimal hyperparameter values in the <code>CV_RESULTS</code> data table—specifically for the <span class="math inline">\(K\)</span>-nearest neighbors method and for SVM, the dimension <span class="math inline">\(d\)</span> in the case of projection onto the B-spline basis. We will also save all hyperparameter values for the SVM + RKHS method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1026"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1026-1"><a href="aplikace3.html#cb1026-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb1026-2"><a href="aplikace3.html#cb1026-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">41</span>)</span>
<span id="cb1026-3"><a href="aplikace3.html#cb1026-3" tabindex="-1"></a></span>
<span id="cb1026-4"><a href="aplikace3.html#cb1026-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb1026-5"><a href="aplikace3.html#cb1026-5" tabindex="-1"></a></span>
<span id="cb1026-6"><a href="aplikace3.html#cb1026-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb1026-7"><a href="aplikace3.html#cb1026-7" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb1026-8"><a href="aplikace3.html#cb1026-8" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb1026-9"><a href="aplikace3.html#cb1026-9" tabindex="-1"></a>  </span>
<span id="cb1026-10"><a href="aplikace3.html#cb1026-10" tabindex="-1"></a>  <span class="co"># vytvoreni vektoru 0 a 1, 0 pro &lt; 20 a 1 pro &gt; 20 </span></span>
<span id="cb1026-11"><a href="aplikace3.html#cb1026-11" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(labels <span class="sc">==</span> <span class="st">&#39;large&#39;</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1026-12"><a href="aplikace3.html#cb1026-12" tabindex="-1"></a>  </span>
<span id="cb1026-13"><a href="aplikace3.html#cb1026-13" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-14"><a href="aplikace3.html#cb1026-14" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1026-15"><a href="aplikace3.html#cb1026-15" tabindex="-1"></a>  </span>
<span id="cb1026-16"><a href="aplikace3.html#cb1026-16" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-17"><a href="aplikace3.html#cb1026-17" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1026-18"><a href="aplikace3.html#cb1026-18" tabindex="-1"></a>  </span>
<span id="cb1026-19"><a href="aplikace3.html#cb1026-19" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb1026-20"><a href="aplikace3.html#cb1026-20" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb1026-21"><a href="aplikace3.html#cb1026-21" tabindex="-1"></a>  </span>
<span id="cb1026-22"><a href="aplikace3.html#cb1026-22" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb1026-23"><a href="aplikace3.html#cb1026-23" tabindex="-1"></a>  </span>
<span id="cb1026-24"><a href="aplikace3.html#cb1026-24" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb1026-25"><a href="aplikace3.html#cb1026-25" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>) <span class="co"># pocet sousedu </span></span>
<span id="cb1026-26"><a href="aplikace3.html#cb1026-26" tabindex="-1"></a>  </span>
<span id="cb1026-27"><a href="aplikace3.html#cb1026-27" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-28"><a href="aplikace3.html#cb1026-28" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-29"><a href="aplikace3.html#cb1026-29" tabindex="-1"></a>  </span>
<span id="cb1026-30"><a href="aplikace3.html#cb1026-30" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1026-31"><a href="aplikace3.html#cb1026-31" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1026-32"><a href="aplikace3.html#cb1026-32" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-33"><a href="aplikace3.html#cb1026-33" tabindex="-1"></a>  }</span>
<span id="cb1026-34"><a href="aplikace3.html#cb1026-34" tabindex="-1"></a>  </span>
<span id="cb1026-35"><a href="aplikace3.html#cb1026-35" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb1026-36"><a href="aplikace3.html#cb1026-36" tabindex="-1"></a>  </span>
<span id="cb1026-37"><a href="aplikace3.html#cb1026-37" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-38"><a href="aplikace3.html#cb1026-38" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb1026-39"><a href="aplikace3.html#cb1026-39" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb1026-40"><a href="aplikace3.html#cb1026-40" tabindex="-1"></a>      </span>
<span id="cb1026-41"><a href="aplikace3.html#cb1026-41" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-42"><a href="aplikace3.html#cb1026-42" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1026-43"><a href="aplikace3.html#cb1026-43" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-44"><a href="aplikace3.html#cb1026-44" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1026-45"><a href="aplikace3.html#cb1026-45" tabindex="-1"></a>    </span>
<span id="cb1026-46"><a href="aplikace3.html#cb1026-46" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-47"><a href="aplikace3.html#cb1026-47" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1026-48"><a href="aplikace3.html#cb1026-48" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-49"><a href="aplikace3.html#cb1026-49" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb1026-50"><a href="aplikace3.html#cb1026-50" tabindex="-1"></a>    </span>
<span id="cb1026-51"><a href="aplikace3.html#cb1026-51" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb1026-52"><a href="aplikace3.html#cb1026-52" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb1026-53"><a href="aplikace3.html#cb1026-53" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb1026-54"><a href="aplikace3.html#cb1026-54" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb1026-55"><a href="aplikace3.html#cb1026-55" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb1026-56"><a href="aplikace3.html#cb1026-56" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb1026-57"><a href="aplikace3.html#cb1026-57" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb1026-58"><a href="aplikace3.html#cb1026-58" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb1026-59"><a href="aplikace3.html#cb1026-59" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb1026-60"><a href="aplikace3.html#cb1026-60" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb1026-61"><a href="aplikace3.html#cb1026-61" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb1026-62"><a href="aplikace3.html#cb1026-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-63"><a href="aplikace3.html#cb1026-63" tabindex="-1"></a>      </span>
<span id="cb1026-64"><a href="aplikace3.html#cb1026-64" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb1026-65"><a href="aplikace3.html#cb1026-65" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb1026-66"><a href="aplikace3.html#cb1026-66" tabindex="-1"></a>    }</span>
<span id="cb1026-67"><a href="aplikace3.html#cb1026-67" tabindex="-1"></a>  }</span>
<span id="cb1026-68"><a href="aplikace3.html#cb1026-68" tabindex="-1"></a>  </span>
<span id="cb1026-69"><a href="aplikace3.html#cb1026-69" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb1026-70"><a href="aplikace3.html#cb1026-70" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb1026-71"><a href="aplikace3.html#cb1026-71" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb1026-72"><a href="aplikace3.html#cb1026-72" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb1026-73"><a href="aplikace3.html#cb1026-73" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb1026-74"><a href="aplikace3.html#cb1026-74" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb1026-75"><a href="aplikace3.html#cb1026-75" tabindex="-1"></a>  </span>
<span id="cb1026-76"><a href="aplikace3.html#cb1026-76" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb1026-77"><a href="aplikace3.html#cb1026-77" tabindex="-1"></a>  </span>
<span id="cb1026-78"><a href="aplikace3.html#cb1026-78" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb1026-79"><a href="aplikace3.html#cb1026-79" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb1026-80"><a href="aplikace3.html#cb1026-80" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb1026-81"><a href="aplikace3.html#cb1026-81" tabindex="-1"></a>  </span>
<span id="cb1026-82"><a href="aplikace3.html#cb1026-82" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb1026-83"><a href="aplikace3.html#cb1026-83" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb1026-84"><a href="aplikace3.html#cb1026-84" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb1026-85"><a href="aplikace3.html#cb1026-85" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb1026-86"><a href="aplikace3.html#cb1026-86" tabindex="-1"></a>  </span>
<span id="cb1026-87"><a href="aplikace3.html#cb1026-87" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb1026-88"><a href="aplikace3.html#cb1026-88" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb1026-89"><a href="aplikace3.html#cb1026-89" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb1026-90"><a href="aplikace3.html#cb1026-90" tabindex="-1"></a>  </span>
<span id="cb1026-91"><a href="aplikace3.html#cb1026-91" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb1026-92"><a href="aplikace3.html#cb1026-92" tabindex="-1"></a>  </span>
<span id="cb1026-93"><a href="aplikace3.html#cb1026-93" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb1026-94"><a href="aplikace3.html#cb1026-94" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb1026-95"><a href="aplikace3.html#cb1026-95" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb1026-96"><a href="aplikace3.html#cb1026-96" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb1026-97"><a href="aplikace3.html#cb1026-97" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb1026-98"><a href="aplikace3.html#cb1026-98" tabindex="-1"></a>  </span>
<span id="cb1026-99"><a href="aplikace3.html#cb1026-99" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb1026-100"><a href="aplikace3.html#cb1026-100" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb1026-101"><a href="aplikace3.html#cb1026-101" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb1026-102"><a href="aplikace3.html#cb1026-102" tabindex="-1"></a>  </span>
<span id="cb1026-103"><a href="aplikace3.html#cb1026-103" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb1026-104"><a href="aplikace3.html#cb1026-104" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb1026-105"><a href="aplikace3.html#cb1026-105" tabindex="-1"></a>  </span>
<span id="cb1026-106"><a href="aplikace3.html#cb1026-106" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb1026-107"><a href="aplikace3.html#cb1026-107" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb1026-108"><a href="aplikace3.html#cb1026-108" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb1026-109"><a href="aplikace3.html#cb1026-109" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb1026-110"><a href="aplikace3.html#cb1026-110" tabindex="-1"></a>  }</span>
<span id="cb1026-111"><a href="aplikace3.html#cb1026-111" tabindex="-1"></a>  </span>
<span id="cb1026-112"><a href="aplikace3.html#cb1026-112" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb1026-113"><a href="aplikace3.html#cb1026-113" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-114"><a href="aplikace3.html#cb1026-114" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb1026-115"><a href="aplikace3.html#cb1026-115" tabindex="-1"></a>  </span>
<span id="cb1026-116"><a href="aplikace3.html#cb1026-116" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1026-117"><a href="aplikace3.html#cb1026-117" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb1026-118"><a href="aplikace3.html#cb1026-118" tabindex="-1"></a>  </span>
<span id="cb1026-119"><a href="aplikace3.html#cb1026-119" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-120"><a href="aplikace3.html#cb1026-120" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-121"><a href="aplikace3.html#cb1026-121" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1026-122"><a href="aplikace3.html#cb1026-122" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-123"><a href="aplikace3.html#cb1026-123" tabindex="-1"></a>    </span>
<span id="cb1026-124"><a href="aplikace3.html#cb1026-124" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-125"><a href="aplikace3.html#cb1026-125" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-126"><a href="aplikace3.html#cb1026-126" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1026-127"><a href="aplikace3.html#cb1026-127" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-128"><a href="aplikace3.html#cb1026-128" tabindex="-1"></a>  </span>
<span id="cb1026-129"><a href="aplikace3.html#cb1026-129" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb1026-130"><a href="aplikace3.html#cb1026-130" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-131"><a href="aplikace3.html#cb1026-131" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-132"><a href="aplikace3.html#cb1026-132" tabindex="-1"></a>  </span>
<span id="cb1026-133"><a href="aplikace3.html#cb1026-133" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-134"><a href="aplikace3.html#cb1026-134" tabindex="-1"></a>  </span>
<span id="cb1026-135"><a href="aplikace3.html#cb1026-135" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb1026-136"><a href="aplikace3.html#cb1026-136" tabindex="-1"></a>  </span>
<span id="cb1026-137"><a href="aplikace3.html#cb1026-137" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1026-138"><a href="aplikace3.html#cb1026-138" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb1026-139"><a href="aplikace3.html#cb1026-139" tabindex="-1"></a>  </span>
<span id="cb1026-140"><a href="aplikace3.html#cb1026-140" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-141"><a href="aplikace3.html#cb1026-141" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-142"><a href="aplikace3.html#cb1026-142" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1026-143"><a href="aplikace3.html#cb1026-143" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-144"><a href="aplikace3.html#cb1026-144" tabindex="-1"></a>    </span>
<span id="cb1026-145"><a href="aplikace3.html#cb1026-145" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-146"><a href="aplikace3.html#cb1026-146" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-147"><a href="aplikace3.html#cb1026-147" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb1026-148"><a href="aplikace3.html#cb1026-148" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-149"><a href="aplikace3.html#cb1026-149" tabindex="-1"></a>  </span>
<span id="cb1026-150"><a href="aplikace3.html#cb1026-150" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb1026-151"><a href="aplikace3.html#cb1026-151" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-152"><a href="aplikace3.html#cb1026-152" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-153"><a href="aplikace3.html#cb1026-153" tabindex="-1"></a>  </span>
<span id="cb1026-154"><a href="aplikace3.html#cb1026-154" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-155"><a href="aplikace3.html#cb1026-155" tabindex="-1"></a>  </span>
<span id="cb1026-156"><a href="aplikace3.html#cb1026-156" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb1026-157"><a href="aplikace3.html#cb1026-157" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb1026-158"><a href="aplikace3.html#cb1026-158" tabindex="-1"></a>  </span>
<span id="cb1026-159"><a href="aplikace3.html#cb1026-159" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb1026-160"><a href="aplikace3.html#cb1026-160" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb1026-161"><a href="aplikace3.html#cb1026-161" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb1026-162"><a href="aplikace3.html#cb1026-162" tabindex="-1"></a>  </span>
<span id="cb1026-163"><a href="aplikace3.html#cb1026-163" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1026-164"><a href="aplikace3.html#cb1026-164" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1026-165"><a href="aplikace3.html#cb1026-165" tabindex="-1"></a>  </span>
<span id="cb1026-166"><a href="aplikace3.html#cb1026-166" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1026-167"><a href="aplikace3.html#cb1026-167" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1026-168"><a href="aplikace3.html#cb1026-168" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb1026-169"><a href="aplikace3.html#cb1026-169" tabindex="-1"></a>  nbasis.x <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb1026-170"><a href="aplikace3.html#cb1026-170" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb1026-171"><a href="aplikace3.html#cb1026-171" tabindex="-1"></a>                                 <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb1026-172"><a href="aplikace3.html#cb1026-172" tabindex="-1"></a>  </span>
<span id="cb1026-173"><a href="aplikace3.html#cb1026-173" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb1026-174"><a href="aplikace3.html#cb1026-174" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb1026-175"><a href="aplikace3.html#cb1026-175" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb1026-176"><a href="aplikace3.html#cb1026-176" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb1026-177"><a href="aplikace3.html#cb1026-177" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-178"><a href="aplikace3.html#cb1026-178" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-179"><a href="aplikace3.html#cb1026-179" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1026-180"><a href="aplikace3.html#cb1026-180" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1026-181"><a href="aplikace3.html#cb1026-181" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-182"><a href="aplikace3.html#cb1026-182" tabindex="-1"></a>  }</span>
<span id="cb1026-183"><a href="aplikace3.html#cb1026-183" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb1026-184"><a href="aplikace3.html#cb1026-184" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1026-185"><a href="aplikace3.html#cb1026-185" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1026-186"><a href="aplikace3.html#cb1026-186" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb1026-187"><a href="aplikace3.html#cb1026-187" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb1026-188"><a href="aplikace3.html#cb1026-188" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb1026-189"><a href="aplikace3.html#cb1026-189" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb1026-190"><a href="aplikace3.html#cb1026-190" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb1026-191"><a href="aplikace3.html#cb1026-191" tabindex="-1"></a>  </span>
<span id="cb1026-192"><a href="aplikace3.html#cb1026-192" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb1026-193"><a href="aplikace3.html#cb1026-193" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1026-194"><a href="aplikace3.html#cb1026-194" tabindex="-1"></a>  </span>
<span id="cb1026-195"><a href="aplikace3.html#cb1026-195" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-196"><a href="aplikace3.html#cb1026-196" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb1026-197"><a href="aplikace3.html#cb1026-197" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb1026-198"><a href="aplikace3.html#cb1026-198" tabindex="-1"></a>      </span>
<span id="cb1026-199"><a href="aplikace3.html#cb1026-199" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-200"><a href="aplikace3.html#cb1026-200" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1026-201"><a href="aplikace3.html#cb1026-201" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-202"><a href="aplikace3.html#cb1026-202" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb1026-203"><a href="aplikace3.html#cb1026-203" tabindex="-1"></a>    </span>
<span id="cb1026-204"><a href="aplikace3.html#cb1026-204" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-205"><a href="aplikace3.html#cb1026-205" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb1026-206"><a href="aplikace3.html#cb1026-206" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb1026-207"><a href="aplikace3.html#cb1026-207" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb1026-208"><a href="aplikace3.html#cb1026-208" tabindex="-1"></a>    </span>
<span id="cb1026-209"><a href="aplikace3.html#cb1026-209" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb1026-210"><a href="aplikace3.html#cb1026-210" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1026-211"><a href="aplikace3.html#cb1026-211" tabindex="-1"></a>    </span>
<span id="cb1026-212"><a href="aplikace3.html#cb1026-212" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb1026-213"><a href="aplikace3.html#cb1026-213" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb1026-214"><a href="aplikace3.html#cb1026-214" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb1026-215"><a href="aplikace3.html#cb1026-215" tabindex="-1"></a>      </span>
<span id="cb1026-216"><a href="aplikace3.html#cb1026-216" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb1026-217"><a href="aplikace3.html#cb1026-217" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb1026-218"><a href="aplikace3.html#cb1026-218" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb1026-219"><a href="aplikace3.html#cb1026-219" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb1026-220"><a href="aplikace3.html#cb1026-220" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb1026-221"><a href="aplikace3.html#cb1026-221" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb1026-222"><a href="aplikace3.html#cb1026-222" tabindex="-1"></a>      </span>
<span id="cb1026-223"><a href="aplikace3.html#cb1026-223" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb1026-224"><a href="aplikace3.html#cb1026-224" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1026-225"><a href="aplikace3.html#cb1026-225" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb1026-226"><a href="aplikace3.html#cb1026-226" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1026-227"><a href="aplikace3.html#cb1026-227" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1026-228"><a href="aplikace3.html#cb1026-228" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-229"><a href="aplikace3.html#cb1026-229" tabindex="-1"></a>      </span>
<span id="cb1026-230"><a href="aplikace3.html#cb1026-230" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb1026-231"><a href="aplikace3.html#cb1026-231" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb1026-232"><a href="aplikace3.html#cb1026-232" tabindex="-1"></a>    } </span>
<span id="cb1026-233"><a href="aplikace3.html#cb1026-233" tabindex="-1"></a>  }</span>
<span id="cb1026-234"><a href="aplikace3.html#cb1026-234" tabindex="-1"></a>  </span>
<span id="cb1026-235"><a href="aplikace3.html#cb1026-235" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb1026-236"><a href="aplikace3.html#cb1026-236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb1026-237"><a href="aplikace3.html#cb1026-237" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb1026-238"><a href="aplikace3.html#cb1026-238" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb1026-239"><a href="aplikace3.html#cb1026-239" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb1026-240"><a href="aplikace3.html#cb1026-240" tabindex="-1"></a>  </span>
<span id="cb1026-241"><a href="aplikace3.html#cb1026-241" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb1026-242"><a href="aplikace3.html#cb1026-242" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb1026-243"><a href="aplikace3.html#cb1026-243" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb1026-244"><a href="aplikace3.html#cb1026-244" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb1026-245"><a href="aplikace3.html#cb1026-245" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1026-246"><a href="aplikace3.html#cb1026-246" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb1026-247"><a href="aplikace3.html#cb1026-247" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb1026-248"><a href="aplikace3.html#cb1026-248" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1026-249"><a href="aplikace3.html#cb1026-249" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1026-250"><a href="aplikace3.html#cb1026-250" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1026-251"><a href="aplikace3.html#cb1026-251" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb1026-252"><a href="aplikace3.html#cb1026-252" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb1026-253"><a href="aplikace3.html#cb1026-253" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb1026-254"><a href="aplikace3.html#cb1026-254" tabindex="-1"></a>  </span>
<span id="cb1026-255"><a href="aplikace3.html#cb1026-255" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-256"><a href="aplikace3.html#cb1026-256" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb1026-257"><a href="aplikace3.html#cb1026-257" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1026-258"><a href="aplikace3.html#cb1026-258" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1026-259"><a href="aplikace3.html#cb1026-259" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-260"><a href="aplikace3.html#cb1026-260" tabindex="-1"></a>    </span>
<span id="cb1026-261"><a href="aplikace3.html#cb1026-261" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-262"><a href="aplikace3.html#cb1026-262" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb1026-263"><a href="aplikace3.html#cb1026-263" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb1026-264"><a href="aplikace3.html#cb1026-264" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb1026-265"><a href="aplikace3.html#cb1026-265" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb1026-266"><a href="aplikace3.html#cb1026-266" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-267"><a href="aplikace3.html#cb1026-267" tabindex="-1"></a>  </span>
<span id="cb1026-268"><a href="aplikace3.html#cb1026-268" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb1026-269"><a href="aplikace3.html#cb1026-269" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-270"><a href="aplikace3.html#cb1026-270" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-271"><a href="aplikace3.html#cb1026-271" tabindex="-1"></a>  </span>
<span id="cb1026-272"><a href="aplikace3.html#cb1026-272" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-273"><a href="aplikace3.html#cb1026-273" tabindex="-1"></a>  </span>
<span id="cb1026-274"><a href="aplikace3.html#cb1026-274" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb1026-275"><a href="aplikace3.html#cb1026-275" tabindex="-1"></a>  </span>
<span id="cb1026-276"><a href="aplikace3.html#cb1026-276" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1026-277"><a href="aplikace3.html#cb1026-277" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb1026-278"><a href="aplikace3.html#cb1026-278" tabindex="-1"></a>  </span>
<span id="cb1026-279"><a href="aplikace3.html#cb1026-279" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-280"><a href="aplikace3.html#cb1026-280" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb1026-281"><a href="aplikace3.html#cb1026-281" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1026-282"><a href="aplikace3.html#cb1026-282" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-283"><a href="aplikace3.html#cb1026-283" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-284"><a href="aplikace3.html#cb1026-284" tabindex="-1"></a>    </span>
<span id="cb1026-285"><a href="aplikace3.html#cb1026-285" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-286"><a href="aplikace3.html#cb1026-286" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb1026-287"><a href="aplikace3.html#cb1026-287" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb1026-288"><a href="aplikace3.html#cb1026-288" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-289"><a href="aplikace3.html#cb1026-289" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-290"><a href="aplikace3.html#cb1026-290" tabindex="-1"></a>  </span>
<span id="cb1026-291"><a href="aplikace3.html#cb1026-291" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb1026-292"><a href="aplikace3.html#cb1026-292" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-293"><a href="aplikace3.html#cb1026-293" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-294"><a href="aplikace3.html#cb1026-294" tabindex="-1"></a>  </span>
<span id="cb1026-295"><a href="aplikace3.html#cb1026-295" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-296"><a href="aplikace3.html#cb1026-296" tabindex="-1"></a>  </span>
<span id="cb1026-297"><a href="aplikace3.html#cb1026-297" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb1026-298"><a href="aplikace3.html#cb1026-298" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb1026-299"><a href="aplikace3.html#cb1026-299" tabindex="-1"></a>  </span>
<span id="cb1026-300"><a href="aplikace3.html#cb1026-300" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb1026-301"><a href="aplikace3.html#cb1026-301" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb1026-302"><a href="aplikace3.html#cb1026-302" tabindex="-1"></a>     </span>
<span id="cb1026-303"><a href="aplikace3.html#cb1026-303" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1026-304"><a href="aplikace3.html#cb1026-304" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb1026-305"><a href="aplikace3.html#cb1026-305" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1026-306"><a href="aplikace3.html#cb1026-306" tabindex="-1"></a>  </span>
<span id="cb1026-307"><a href="aplikace3.html#cb1026-307" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1026-308"><a href="aplikace3.html#cb1026-308" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb1026-309"><a href="aplikace3.html#cb1026-309" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1026-310"><a href="aplikace3.html#cb1026-310" tabindex="-1"></a>  </span>
<span id="cb1026-311"><a href="aplikace3.html#cb1026-311" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-312"><a href="aplikace3.html#cb1026-312" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb1026-313"><a href="aplikace3.html#cb1026-313" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1026-314"><a href="aplikace3.html#cb1026-314" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1026-315"><a href="aplikace3.html#cb1026-315" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1026-316"><a href="aplikace3.html#cb1026-316" tabindex="-1"></a>  </span>
<span id="cb1026-317"><a href="aplikace3.html#cb1026-317" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-318"><a href="aplikace3.html#cb1026-318" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1026-319"><a href="aplikace3.html#cb1026-319" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-320"><a href="aplikace3.html#cb1026-320" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-321"><a href="aplikace3.html#cb1026-321" tabindex="-1"></a>    </span>
<span id="cb1026-322"><a href="aplikace3.html#cb1026-322" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-323"><a href="aplikace3.html#cb1026-323" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1026-324"><a href="aplikace3.html#cb1026-324" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-325"><a href="aplikace3.html#cb1026-325" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-326"><a href="aplikace3.html#cb1026-326" tabindex="-1"></a>  </span>
<span id="cb1026-327"><a href="aplikace3.html#cb1026-327" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb1026-328"><a href="aplikace3.html#cb1026-328" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-329"><a href="aplikace3.html#cb1026-329" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-330"><a href="aplikace3.html#cb1026-330" tabindex="-1"></a>  </span>
<span id="cb1026-331"><a href="aplikace3.html#cb1026-331" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-332"><a href="aplikace3.html#cb1026-332" tabindex="-1"></a>  </span>
<span id="cb1026-333"><a href="aplikace3.html#cb1026-333" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb1026-334"><a href="aplikace3.html#cb1026-334" tabindex="-1"></a>  </span>
<span id="cb1026-335"><a href="aplikace3.html#cb1026-335" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-336"><a href="aplikace3.html#cb1026-336" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb1026-337"><a href="aplikace3.html#cb1026-337" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1026-338"><a href="aplikace3.html#cb1026-338" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1026-339"><a href="aplikace3.html#cb1026-339" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1026-340"><a href="aplikace3.html#cb1026-340" tabindex="-1"></a>  </span>
<span id="cb1026-341"><a href="aplikace3.html#cb1026-341" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-342"><a href="aplikace3.html#cb1026-342" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-343"><a href="aplikace3.html#cb1026-343" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-344"><a href="aplikace3.html#cb1026-344" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-345"><a href="aplikace3.html#cb1026-345" tabindex="-1"></a>    </span>
<span id="cb1026-346"><a href="aplikace3.html#cb1026-346" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-347"><a href="aplikace3.html#cb1026-347" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-348"><a href="aplikace3.html#cb1026-348" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-349"><a href="aplikace3.html#cb1026-349" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-350"><a href="aplikace3.html#cb1026-350" tabindex="-1"></a>  </span>
<span id="cb1026-351"><a href="aplikace3.html#cb1026-351" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb1026-352"><a href="aplikace3.html#cb1026-352" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-353"><a href="aplikace3.html#cb1026-353" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-354"><a href="aplikace3.html#cb1026-354" tabindex="-1"></a>  </span>
<span id="cb1026-355"><a href="aplikace3.html#cb1026-355" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-356"><a href="aplikace3.html#cb1026-356" tabindex="-1"></a>  </span>
<span id="cb1026-357"><a href="aplikace3.html#cb1026-357" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb1026-358"><a href="aplikace3.html#cb1026-358" tabindex="-1"></a>  </span>
<span id="cb1026-359"><a href="aplikace3.html#cb1026-359" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb1026-360"><a href="aplikace3.html#cb1026-360" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb1026-361"><a href="aplikace3.html#cb1026-361" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1026-362"><a href="aplikace3.html#cb1026-362" tabindex="-1"></a>  </span>
<span id="cb1026-363"><a href="aplikace3.html#cb1026-363" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb1026-364"><a href="aplikace3.html#cb1026-364" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb1026-365"><a href="aplikace3.html#cb1026-365" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-366"><a href="aplikace3.html#cb1026-366" tabindex="-1"></a>  </span>
<span id="cb1026-367"><a href="aplikace3.html#cb1026-367" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-368"><a href="aplikace3.html#cb1026-368" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb1026-369"><a href="aplikace3.html#cb1026-369" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb1026-370"><a href="aplikace3.html#cb1026-370" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb1026-371"><a href="aplikace3.html#cb1026-371" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb1026-372"><a href="aplikace3.html#cb1026-372" tabindex="-1"></a>  </span>
<span id="cb1026-373"><a href="aplikace3.html#cb1026-373" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-374"><a href="aplikace3.html#cb1026-374" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1026-375"><a href="aplikace3.html#cb1026-375" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-376"><a href="aplikace3.html#cb1026-376" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-377"><a href="aplikace3.html#cb1026-377" tabindex="-1"></a>    </span>
<span id="cb1026-378"><a href="aplikace3.html#cb1026-378" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-379"><a href="aplikace3.html#cb1026-379" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1026-380"><a href="aplikace3.html#cb1026-380" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-381"><a href="aplikace3.html#cb1026-381" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-382"><a href="aplikace3.html#cb1026-382" tabindex="-1"></a>  </span>
<span id="cb1026-383"><a href="aplikace3.html#cb1026-383" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb1026-384"><a href="aplikace3.html#cb1026-384" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-385"><a href="aplikace3.html#cb1026-385" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-386"><a href="aplikace3.html#cb1026-386" tabindex="-1"></a>  </span>
<span id="cb1026-387"><a href="aplikace3.html#cb1026-387" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-388"><a href="aplikace3.html#cb1026-388" tabindex="-1"></a>  </span>
<span id="cb1026-389"><a href="aplikace3.html#cb1026-389" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb1026-390"><a href="aplikace3.html#cb1026-390" tabindex="-1"></a>  </span>
<span id="cb1026-391"><a href="aplikace3.html#cb1026-391" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb1026-392"><a href="aplikace3.html#cb1026-392" tabindex="-1"></a>  </span>
<span id="cb1026-393"><a href="aplikace3.html#cb1026-393" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-394"><a href="aplikace3.html#cb1026-394" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb1026-395"><a href="aplikace3.html#cb1026-395" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1026-396"><a href="aplikace3.html#cb1026-396" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-397"><a href="aplikace3.html#cb1026-397" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1026-398"><a href="aplikace3.html#cb1026-398" tabindex="-1"></a>  </span>
<span id="cb1026-399"><a href="aplikace3.html#cb1026-399" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-400"><a href="aplikace3.html#cb1026-400" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1026-401"><a href="aplikace3.html#cb1026-401" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-402"><a href="aplikace3.html#cb1026-402" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-403"><a href="aplikace3.html#cb1026-403" tabindex="-1"></a>    </span>
<span id="cb1026-404"><a href="aplikace3.html#cb1026-404" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-405"><a href="aplikace3.html#cb1026-405" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1026-406"><a href="aplikace3.html#cb1026-406" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-407"><a href="aplikace3.html#cb1026-407" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-408"><a href="aplikace3.html#cb1026-408" tabindex="-1"></a>  </span>
<span id="cb1026-409"><a href="aplikace3.html#cb1026-409" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb1026-410"><a href="aplikace3.html#cb1026-410" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-411"><a href="aplikace3.html#cb1026-411" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-412"><a href="aplikace3.html#cb1026-412" tabindex="-1"></a>  </span>
<span id="cb1026-413"><a href="aplikace3.html#cb1026-413" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-414"><a href="aplikace3.html#cb1026-414" tabindex="-1"></a>  </span>
<span id="cb1026-415"><a href="aplikace3.html#cb1026-415" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb1026-416"><a href="aplikace3.html#cb1026-416" tabindex="-1"></a>  </span>
<span id="cb1026-417"><a href="aplikace3.html#cb1026-417" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-418"><a href="aplikace3.html#cb1026-418" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb1026-419"><a href="aplikace3.html#cb1026-419" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1026-420"><a href="aplikace3.html#cb1026-420" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-421"><a href="aplikace3.html#cb1026-421" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1026-422"><a href="aplikace3.html#cb1026-422" tabindex="-1"></a>  </span>
<span id="cb1026-423"><a href="aplikace3.html#cb1026-423" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-424"><a href="aplikace3.html#cb1026-424" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-425"><a href="aplikace3.html#cb1026-425" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-426"><a href="aplikace3.html#cb1026-426" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-427"><a href="aplikace3.html#cb1026-427" tabindex="-1"></a>    </span>
<span id="cb1026-428"><a href="aplikace3.html#cb1026-428" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-429"><a href="aplikace3.html#cb1026-429" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-430"><a href="aplikace3.html#cb1026-430" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-431"><a href="aplikace3.html#cb1026-431" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-432"><a href="aplikace3.html#cb1026-432" tabindex="-1"></a>  </span>
<span id="cb1026-433"><a href="aplikace3.html#cb1026-433" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb1026-434"><a href="aplikace3.html#cb1026-434" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-435"><a href="aplikace3.html#cb1026-435" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-436"><a href="aplikace3.html#cb1026-436" tabindex="-1"></a>  </span>
<span id="cb1026-437"><a href="aplikace3.html#cb1026-437" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-438"><a href="aplikace3.html#cb1026-438" tabindex="-1"></a>  </span>
<span id="cb1026-439"><a href="aplikace3.html#cb1026-439" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb1026-440"><a href="aplikace3.html#cb1026-440" tabindex="-1"></a>  </span>
<span id="cb1026-441"><a href="aplikace3.html#cb1026-441" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-442"><a href="aplikace3.html#cb1026-442" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb1026-443"><a href="aplikace3.html#cb1026-443" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb1026-444"><a href="aplikace3.html#cb1026-444" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-445"><a href="aplikace3.html#cb1026-445" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb1026-446"><a href="aplikace3.html#cb1026-446" tabindex="-1"></a>  </span>
<span id="cb1026-447"><a href="aplikace3.html#cb1026-447" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-448"><a href="aplikace3.html#cb1026-448" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1026-449"><a href="aplikace3.html#cb1026-449" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-450"><a href="aplikace3.html#cb1026-450" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-451"><a href="aplikace3.html#cb1026-451" tabindex="-1"></a>    </span>
<span id="cb1026-452"><a href="aplikace3.html#cb1026-452" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-453"><a href="aplikace3.html#cb1026-453" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1026-454"><a href="aplikace3.html#cb1026-454" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-455"><a href="aplikace3.html#cb1026-455" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-456"><a href="aplikace3.html#cb1026-456" tabindex="-1"></a>  </span>
<span id="cb1026-457"><a href="aplikace3.html#cb1026-457" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb1026-458"><a href="aplikace3.html#cb1026-458" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb1026-459"><a href="aplikace3.html#cb1026-459" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb1026-460"><a href="aplikace3.html#cb1026-460" tabindex="-1"></a>  </span>
<span id="cb1026-461"><a href="aplikace3.html#cb1026-461" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-462"><a href="aplikace3.html#cb1026-462" tabindex="-1"></a>  </span>
<span id="cb1026-463"><a href="aplikace3.html#cb1026-463" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb1026-464"><a href="aplikace3.html#cb1026-464" tabindex="-1"></a>  </span>
<span id="cb1026-465"><a href="aplikace3.html#cb1026-465" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb1026-466"><a href="aplikace3.html#cb1026-466" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-467"><a href="aplikace3.html#cb1026-467" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm_der, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1026-468"><a href="aplikace3.html#cb1026-468" tabindex="-1"></a>  </span>
<span id="cb1026-469"><a href="aplikace3.html#cb1026-469" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-470"><a href="aplikace3.html#cb1026-470" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1026-471"><a href="aplikace3.html#cb1026-471" tabindex="-1"></a>  </span>
<span id="cb1026-472"><a href="aplikace3.html#cb1026-472" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1026-473"><a href="aplikace3.html#cb1026-473" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb1026-474"><a href="aplikace3.html#cb1026-474" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1026-475"><a href="aplikace3.html#cb1026-475" tabindex="-1"></a>  </span>
<span id="cb1026-476"><a href="aplikace3.html#cb1026-476" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb1026-477"><a href="aplikace3.html#cb1026-477" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb1026-478"><a href="aplikace3.html#cb1026-478" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb1026-479"><a href="aplikace3.html#cb1026-479" tabindex="-1"></a>  </span>
<span id="cb1026-480"><a href="aplikace3.html#cb1026-480" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-481"><a href="aplikace3.html#cb1026-481" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-482"><a href="aplikace3.html#cb1026-482" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb1026-483"><a href="aplikace3.html#cb1026-483" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb1026-484"><a href="aplikace3.html#cb1026-484" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-485"><a href="aplikace3.html#cb1026-485" tabindex="-1"></a>  }</span>
<span id="cb1026-486"><a href="aplikace3.html#cb1026-486" tabindex="-1"></a>  </span>
<span id="cb1026-487"><a href="aplikace3.html#cb1026-487" tabindex="-1"></a>  <span class="do">### 7.0) SVM for functional data</span></span>
<span id="cb1026-488"><a href="aplikace3.html#cb1026-488" tabindex="-1"></a>  </span>
<span id="cb1026-489"><a href="aplikace3.html#cb1026-489" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1026-490"><a href="aplikace3.html#cb1026-490" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-491"><a href="aplikace3.html#cb1026-491" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-492"><a href="aplikace3.html#cb1026-492" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1026-493"><a href="aplikace3.html#cb1026-493" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1026-494"><a href="aplikace3.html#cb1026-494" tabindex="-1"></a>  </span>
<span id="cb1026-495"><a href="aplikace3.html#cb1026-495" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-496"><a href="aplikace3.html#cb1026-496" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-497"><a href="aplikace3.html#cb1026-497" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-498"><a href="aplikace3.html#cb1026-498" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1026-499"><a href="aplikace3.html#cb1026-499" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-500"><a href="aplikace3.html#cb1026-500" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1026-501"><a href="aplikace3.html#cb1026-501" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1026-502"><a href="aplikace3.html#cb1026-502" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1026-503"><a href="aplikace3.html#cb1026-503" tabindex="-1"></a>  )</span>
<span id="cb1026-504"><a href="aplikace3.html#cb1026-504" tabindex="-1"></a>  </span>
<span id="cb1026-505"><a href="aplikace3.html#cb1026-505" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1026-506"><a href="aplikace3.html#cb1026-506" tabindex="-1"></a>  <span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb1026-507"><a href="aplikace3.html#cb1026-507" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1026-508"><a href="aplikace3.html#cb1026-508" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-509"><a href="aplikace3.html#cb1026-509" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-510"><a href="aplikace3.html#cb1026-510" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-511"><a href="aplikace3.html#cb1026-511" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1026-512"><a href="aplikace3.html#cb1026-512" tabindex="-1"></a>      </span>
<span id="cb1026-513"><a href="aplikace3.html#cb1026-513" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb1026-514"><a href="aplikace3.html#cb1026-514" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb1026-515"><a href="aplikace3.html#cb1026-515" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb1026-516"><a href="aplikace3.html#cb1026-516" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb1026-517"><a href="aplikace3.html#cb1026-517" tabindex="-1"></a>      </span>
<span id="cb1026-518"><a href="aplikace3.html#cb1026-518" tabindex="-1"></a>      <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1026-519"><a href="aplikace3.html#cb1026-519" tabindex="-1"></a>      tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1026-520"><a href="aplikace3.html#cb1026-520" tabindex="-1"></a>      </span>
<span id="cb1026-521"><a href="aplikace3.html#cb1026-521" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb1026-522"><a href="aplikace3.html#cb1026-522" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1026-523"><a href="aplikace3.html#cb1026-523" tabindex="-1"></a>      <span class="co"># B-spline baze </span></span>
<span id="cb1026-524"><a href="aplikace3.html#cb1026-524" tabindex="-1"></a>      basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), </span>
<span id="cb1026-525"><a href="aplikace3.html#cb1026-525" tabindex="-1"></a>                                     <span class="at">norder =</span> <span class="dv">4</span>, <span class="at">nbasis =</span> <span class="dv">100</span>)</span>
<span id="cb1026-526"><a href="aplikace3.html#cb1026-526" tabindex="-1"></a>      <span class="co"># formula</span></span>
<span id="cb1026-527"><a href="aplikace3.html#cb1026-527" tabindex="-1"></a>      f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb1026-528"><a href="aplikace3.html#cb1026-528" tabindex="-1"></a>      <span class="co"># baze pro x</span></span>
<span id="cb1026-529"><a href="aplikace3.html#cb1026-529" tabindex="-1"></a>      basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1026-530"><a href="aplikace3.html#cb1026-530" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb1026-531"><a href="aplikace3.html#cb1026-531" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb1026-532"><a href="aplikace3.html#cb1026-532" tabindex="-1"></a>      </span>
<span id="cb1026-533"><a href="aplikace3.html#cb1026-533" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1026-534"><a href="aplikace3.html#cb1026-534" tabindex="-1"></a>      <span class="co"># model SVM</span></span>
<span id="cb1026-535"><a href="aplikace3.html#cb1026-535" tabindex="-1"></a>      clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-536"><a href="aplikace3.html#cb1026-536" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1026-537"><a href="aplikace3.html#cb1026-537" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-538"><a href="aplikace3.html#cb1026-538" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1026-539"><a href="aplikace3.html#cb1026-539" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1026-540"><a href="aplikace3.html#cb1026-540" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-541"><a href="aplikace3.html#cb1026-541" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-542"><a href="aplikace3.html#cb1026-542" tabindex="-1"></a>        </span>
<span id="cb1026-543"><a href="aplikace3.html#cb1026-543" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-544"><a href="aplikace3.html#cb1026-544" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1026-545"><a href="aplikace3.html#cb1026-545" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-546"><a href="aplikace3.html#cb1026-546" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1026-547"><a href="aplikace3.html#cb1026-547" tabindex="-1"></a>      </span>
<span id="cb1026-548"><a href="aplikace3.html#cb1026-548" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1026-549"><a href="aplikace3.html#cb1026-549" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1026-550"><a href="aplikace3.html#cb1026-550" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1026-551"><a href="aplikace3.html#cb1026-551" tabindex="-1"></a>      </span>
<span id="cb1026-552"><a href="aplikace3.html#cb1026-552" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1026-553"><a href="aplikace3.html#cb1026-553" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1026-554"><a href="aplikace3.html#cb1026-554" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-555"><a href="aplikace3.html#cb1026-555" tabindex="-1"></a>        clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-556"><a href="aplikace3.html#cb1026-556" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1026-557"><a href="aplikace3.html#cb1026-557" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-558"><a href="aplikace3.html#cb1026-558" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1026-559"><a href="aplikace3.html#cb1026-559" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1026-560"><a href="aplikace3.html#cb1026-560" tabindex="-1"></a>                  <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-561"><a href="aplikace3.html#cb1026-561" tabindex="-1"></a>                  <span class="at">degree =</span> p,</span>
<span id="cb1026-562"><a href="aplikace3.html#cb1026-562" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-563"><a href="aplikace3.html#cb1026-563" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-564"><a href="aplikace3.html#cb1026-564" tabindex="-1"></a>          </span>
<span id="cb1026-565"><a href="aplikace3.html#cb1026-565" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-566"><a href="aplikace3.html#cb1026-566" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1026-567"><a href="aplikace3.html#cb1026-567" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-568"><a href="aplikace3.html#cb1026-568" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1026-569"><a href="aplikace3.html#cb1026-569" tabindex="-1"></a>        </span>
<span id="cb1026-570"><a href="aplikace3.html#cb1026-570" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1026-571"><a href="aplikace3.html#cb1026-571" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1026-572"><a href="aplikace3.html#cb1026-572" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1026-573"><a href="aplikace3.html#cb1026-573" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1026-574"><a href="aplikace3.html#cb1026-574" tabindex="-1"></a>      }</span>
<span id="cb1026-575"><a href="aplikace3.html#cb1026-575" tabindex="-1"></a>          </span>
<span id="cb1026-576"><a href="aplikace3.html#cb1026-576" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1026-577"><a href="aplikace3.html#cb1026-577" tabindex="-1"></a>      <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1026-578"><a href="aplikace3.html#cb1026-578" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-579"><a href="aplikace3.html#cb1026-579" tabindex="-1"></a>        clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-580"><a href="aplikace3.html#cb1026-580" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb1026-581"><a href="aplikace3.html#cb1026-581" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-582"><a href="aplikace3.html#cb1026-582" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1026-583"><a href="aplikace3.html#cb1026-583" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb1026-584"><a href="aplikace3.html#cb1026-584" tabindex="-1"></a>                  <span class="at">gamma =</span> gam.cv,</span>
<span id="cb1026-585"><a href="aplikace3.html#cb1026-585" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-586"><a href="aplikace3.html#cb1026-586" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-587"><a href="aplikace3.html#cb1026-587" tabindex="-1"></a>          </span>
<span id="cb1026-588"><a href="aplikace3.html#cb1026-588" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-589"><a href="aplikace3.html#cb1026-589" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb1026-590"><a href="aplikace3.html#cb1026-590" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-591"><a href="aplikace3.html#cb1026-591" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb1026-592"><a href="aplikace3.html#cb1026-592" tabindex="-1"></a>        </span>
<span id="cb1026-593"><a href="aplikace3.html#cb1026-593" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1026-594"><a href="aplikace3.html#cb1026-594" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb1026-595"><a href="aplikace3.html#cb1026-595" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb1026-596"><a href="aplikace3.html#cb1026-596" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1026-597"><a href="aplikace3.html#cb1026-597" tabindex="-1"></a>      }</span>
<span id="cb1026-598"><a href="aplikace3.html#cb1026-598" tabindex="-1"></a>    }</span>
<span id="cb1026-599"><a href="aplikace3.html#cb1026-599" tabindex="-1"></a>  }</span>
<span id="cb1026-600"><a href="aplikace3.html#cb1026-600" tabindex="-1"></a>  </span>
<span id="cb1026-601"><a href="aplikace3.html#cb1026-601" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1026-602"><a href="aplikace3.html#cb1026-602" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1026-603"><a href="aplikace3.html#cb1026-603" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1026-604"><a href="aplikace3.html#cb1026-604" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1026-605"><a href="aplikace3.html#cb1026-605" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-606"><a href="aplikace3.html#cb1026-606" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1026-607"><a href="aplikace3.html#cb1026-607" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-608"><a href="aplikace3.html#cb1026-608" tabindex="-1"></a>  </span>
<span id="cb1026-609"><a href="aplikace3.html#cb1026-609" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-610"><a href="aplikace3.html#cb1026-610" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1026-611"><a href="aplikace3.html#cb1026-611" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1026-612"><a href="aplikace3.html#cb1026-612" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1026-613"><a href="aplikace3.html#cb1026-613" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1026-614"><a href="aplikace3.html#cb1026-614" tabindex="-1"></a>  </span>
<span id="cb1026-615"><a href="aplikace3.html#cb1026-615" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-616"><a href="aplikace3.html#cb1026-616" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-617"><a href="aplikace3.html#cb1026-617" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1026-618"><a href="aplikace3.html#cb1026-618" tabindex="-1"></a>  </span>
<span id="cb1026-619"><a href="aplikace3.html#cb1026-619" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-620"><a href="aplikace3.html#cb1026-620" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-621"><a href="aplikace3.html#cb1026-621" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1026-622"><a href="aplikace3.html#cb1026-622" tabindex="-1"></a>  </span>
<span id="cb1026-623"><a href="aplikace3.html#cb1026-623" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-624"><a href="aplikace3.html#cb1026-624" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-625"><a href="aplikace3.html#cb1026-625" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-626"><a href="aplikace3.html#cb1026-626" tabindex="-1"></a>  </span>
<span id="cb1026-627"><a href="aplikace3.html#cb1026-627" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb1026-628"><a href="aplikace3.html#cb1026-628" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb1026-629"><a href="aplikace3.html#cb1026-629" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb1026-630"><a href="aplikace3.html#cb1026-630" tabindex="-1"></a>  </span>
<span id="cb1026-631"><a href="aplikace3.html#cb1026-631" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb1026-632"><a href="aplikace3.html#cb1026-632" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb1026-633"><a href="aplikace3.html#cb1026-633" tabindex="-1"></a>  </span>
<span id="cb1026-634"><a href="aplikace3.html#cb1026-634" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb1026-635"><a href="aplikace3.html#cb1026-635" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb1026-636"><a href="aplikace3.html#cb1026-636" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb1026-637"><a href="aplikace3.html#cb1026-637" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb1026-638"><a href="aplikace3.html#cb1026-638" tabindex="-1"></a>  </span>
<span id="cb1026-639"><a href="aplikace3.html#cb1026-639" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb1026-640"><a href="aplikace3.html#cb1026-640" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb1026-641"><a href="aplikace3.html#cb1026-641" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb1026-642"><a href="aplikace3.html#cb1026-642" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb1026-643"><a href="aplikace3.html#cb1026-643" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb1026-644"><a href="aplikace3.html#cb1026-644" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1026-645"><a href="aplikace3.html#cb1026-645" tabindex="-1"></a>  </span>
<span id="cb1026-646"><a href="aplikace3.html#cb1026-646" tabindex="-1"></a>  model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-647"><a href="aplikace3.html#cb1026-647" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1026-648"><a href="aplikace3.html#cb1026-648" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-649"><a href="aplikace3.html#cb1026-649" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb1026-650"><a href="aplikace3.html#cb1026-650" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-651"><a href="aplikace3.html#cb1026-651" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-652"><a href="aplikace3.html#cb1026-652" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb1026-653"><a href="aplikace3.html#cb1026-653" tabindex="-1"></a>  </span>
<span id="cb1026-654"><a href="aplikace3.html#cb1026-654" tabindex="-1"></a>  model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-655"><a href="aplikace3.html#cb1026-655" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1026-656"><a href="aplikace3.html#cb1026-656" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-657"><a href="aplikace3.html#cb1026-657" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb1026-658"><a href="aplikace3.html#cb1026-658" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-659"><a href="aplikace3.html#cb1026-659" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-660"><a href="aplikace3.html#cb1026-660" tabindex="-1"></a>              <span class="at">degree =</span> p.opt,</span>
<span id="cb1026-661"><a href="aplikace3.html#cb1026-661" tabindex="-1"></a>              <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-662"><a href="aplikace3.html#cb1026-662" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb1026-663"><a href="aplikace3.html#cb1026-663" tabindex="-1"></a>  </span>
<span id="cb1026-664"><a href="aplikace3.html#cb1026-664" tabindex="-1"></a>  model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb1026-665"><a href="aplikace3.html#cb1026-665" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb1026-666"><a href="aplikace3.html#cb1026-666" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb1026-667"><a href="aplikace3.html#cb1026-667" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb1026-668"><a href="aplikace3.html#cb1026-668" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-669"><a href="aplikace3.html#cb1026-669" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-670"><a href="aplikace3.html#cb1026-670" tabindex="-1"></a>              <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1026-671"><a href="aplikace3.html#cb1026-671" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb1026-672"><a href="aplikace3.html#cb1026-672" tabindex="-1"></a>  </span>
<span id="cb1026-673"><a href="aplikace3.html#cb1026-673" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-674"><a href="aplikace3.html#cb1026-674" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb1026-675"><a href="aplikace3.html#cb1026-675" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-676"><a href="aplikace3.html#cb1026-676" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb1026-677"><a href="aplikace3.html#cb1026-677" tabindex="-1"></a>  </span>
<span id="cb1026-678"><a href="aplikace3.html#cb1026-678" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-679"><a href="aplikace3.html#cb1026-679" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb1026-680"><a href="aplikace3.html#cb1026-680" tabindex="-1"></a>  </span>
<span id="cb1026-681"><a href="aplikace3.html#cb1026-681" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-682"><a href="aplikace3.html#cb1026-682" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb1026-683"><a href="aplikace3.html#cb1026-683" tabindex="-1"></a>    </span>
<span id="cb1026-684"><a href="aplikace3.html#cb1026-684" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-685"><a href="aplikace3.html#cb1026-685" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb1026-686"><a href="aplikace3.html#cb1026-686" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-687"><a href="aplikace3.html#cb1026-687" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb1026-688"><a href="aplikace3.html#cb1026-688" tabindex="-1"></a>  </span>
<span id="cb1026-689"><a href="aplikace3.html#cb1026-689" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-690"><a href="aplikace3.html#cb1026-690" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb1026-691"><a href="aplikace3.html#cb1026-691" tabindex="-1"></a>  </span>
<span id="cb1026-692"><a href="aplikace3.html#cb1026-692" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb1026-693"><a href="aplikace3.html#cb1026-693" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span>
<span id="cb1026-694"><a href="aplikace3.html#cb1026-694" tabindex="-1"></a>  </span>
<span id="cb1026-695"><a href="aplikace3.html#cb1026-695" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb1026-696"><a href="aplikace3.html#cb1026-696" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb1026-697"><a href="aplikace3.html#cb1026-697" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb1026-698"><a href="aplikace3.html#cb1026-698" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb1026-699"><a href="aplikace3.html#cb1026-699" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb1026-700"><a href="aplikace3.html#cb1026-700" tabindex="-1"></a>  </span>
<span id="cb1026-701"><a href="aplikace3.html#cb1026-701" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-702"><a href="aplikace3.html#cb1026-702" tabindex="-1"></a>  </span>
<span id="cb1026-703"><a href="aplikace3.html#cb1026-703" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb1026-704"><a href="aplikace3.html#cb1026-704" tabindex="-1"></a>  </span>
<span id="cb1026-705"><a href="aplikace3.html#cb1026-705" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1026-706"><a href="aplikace3.html#cb1026-706" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-707"><a href="aplikace3.html#cb1026-707" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-708"><a href="aplikace3.html#cb1026-708" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1026-709"><a href="aplikace3.html#cb1026-709" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1026-710"><a href="aplikace3.html#cb1026-710" tabindex="-1"></a>  </span>
<span id="cb1026-711"><a href="aplikace3.html#cb1026-711" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-712"><a href="aplikace3.html#cb1026-712" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-713"><a href="aplikace3.html#cb1026-713" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-714"><a href="aplikace3.html#cb1026-714" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1026-715"><a href="aplikace3.html#cb1026-715" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-716"><a href="aplikace3.html#cb1026-716" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1026-717"><a href="aplikace3.html#cb1026-717" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1026-718"><a href="aplikace3.html#cb1026-718" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1026-719"><a href="aplikace3.html#cb1026-719" tabindex="-1"></a>  )</span>
<span id="cb1026-720"><a href="aplikace3.html#cb1026-720" tabindex="-1"></a>  </span>
<span id="cb1026-721"><a href="aplikace3.html#cb1026-721" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1026-722"><a href="aplikace3.html#cb1026-722" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1026-723"><a href="aplikace3.html#cb1026-723" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1026-724"><a href="aplikace3.html#cb1026-724" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-725"><a href="aplikace3.html#cb1026-725" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-726"><a href="aplikace3.html#cb1026-726" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-727"><a href="aplikace3.html#cb1026-727" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1026-728"><a href="aplikace3.html#cb1026-728" tabindex="-1"></a>      </span>
<span id="cb1026-729"><a href="aplikace3.html#cb1026-729" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb1026-730"><a href="aplikace3.html#cb1026-730" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1026-731"><a href="aplikace3.html#cb1026-731" tabindex="-1"></a>      </span>
<span id="cb1026-732"><a href="aplikace3.html#cb1026-732" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1026-733"><a href="aplikace3.html#cb1026-733" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-734"><a href="aplikace3.html#cb1026-734" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1026-735"><a href="aplikace3.html#cb1026-735" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-736"><a href="aplikace3.html#cb1026-736" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-737"><a href="aplikace3.html#cb1026-737" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1026-738"><a href="aplikace3.html#cb1026-738" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-739"><a href="aplikace3.html#cb1026-739" tabindex="-1"></a>      </span>
<span id="cb1026-740"><a href="aplikace3.html#cb1026-740" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-741"><a href="aplikace3.html#cb1026-741" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1026-742"><a href="aplikace3.html#cb1026-742" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-743"><a href="aplikace3.html#cb1026-743" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-744"><a href="aplikace3.html#cb1026-744" tabindex="-1"></a>      </span>
<span id="cb1026-745"><a href="aplikace3.html#cb1026-745" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1026-746"><a href="aplikace3.html#cb1026-746" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-747"><a href="aplikace3.html#cb1026-747" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1026-748"><a href="aplikace3.html#cb1026-748" tabindex="-1"></a>      </span>
<span id="cb1026-749"><a href="aplikace3.html#cb1026-749" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1026-750"><a href="aplikace3.html#cb1026-750" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1026-751"><a href="aplikace3.html#cb1026-751" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-752"><a href="aplikace3.html#cb1026-752" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1026-753"><a href="aplikace3.html#cb1026-753" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-754"><a href="aplikace3.html#cb1026-754" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-755"><a href="aplikace3.html#cb1026-755" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-756"><a href="aplikace3.html#cb1026-756" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-757"><a href="aplikace3.html#cb1026-757" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1026-758"><a href="aplikace3.html#cb1026-758" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-759"><a href="aplikace3.html#cb1026-759" tabindex="-1"></a>        </span>
<span id="cb1026-760"><a href="aplikace3.html#cb1026-760" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-761"><a href="aplikace3.html#cb1026-761" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb1026-762"><a href="aplikace3.html#cb1026-762" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1026-763"><a href="aplikace3.html#cb1026-763" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-764"><a href="aplikace3.html#cb1026-764" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-765"><a href="aplikace3.html#cb1026-765" tabindex="-1"></a>        </span>
<span id="cb1026-766"><a href="aplikace3.html#cb1026-766" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1026-767"><a href="aplikace3.html#cb1026-767" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-768"><a href="aplikace3.html#cb1026-768" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1026-769"><a href="aplikace3.html#cb1026-769" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1026-770"><a href="aplikace3.html#cb1026-770" tabindex="-1"></a>      }</span>
<span id="cb1026-771"><a href="aplikace3.html#cb1026-771" tabindex="-1"></a>          </span>
<span id="cb1026-772"><a href="aplikace3.html#cb1026-772" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1026-773"><a href="aplikace3.html#cb1026-773" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1026-774"><a href="aplikace3.html#cb1026-774" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-775"><a href="aplikace3.html#cb1026-775" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb1026-776"><a href="aplikace3.html#cb1026-776" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-777"><a href="aplikace3.html#cb1026-777" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-778"><a href="aplikace3.html#cb1026-778" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-779"><a href="aplikace3.html#cb1026-779" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1026-780"><a href="aplikace3.html#cb1026-780" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-781"><a href="aplikace3.html#cb1026-781" tabindex="-1"></a>        </span>
<span id="cb1026-782"><a href="aplikace3.html#cb1026-782" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-783"><a href="aplikace3.html#cb1026-783" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb1026-784"><a href="aplikace3.html#cb1026-784" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-785"><a href="aplikace3.html#cb1026-785" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-786"><a href="aplikace3.html#cb1026-786" tabindex="-1"></a>        </span>
<span id="cb1026-787"><a href="aplikace3.html#cb1026-787" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1026-788"><a href="aplikace3.html#cb1026-788" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-789"><a href="aplikace3.html#cb1026-789" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1026-790"><a href="aplikace3.html#cb1026-790" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1026-791"><a href="aplikace3.html#cb1026-791" tabindex="-1"></a>      }</span>
<span id="cb1026-792"><a href="aplikace3.html#cb1026-792" tabindex="-1"></a>    }</span>
<span id="cb1026-793"><a href="aplikace3.html#cb1026-793" tabindex="-1"></a>  }</span>
<span id="cb1026-794"><a href="aplikace3.html#cb1026-794" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1026-795"><a href="aplikace3.html#cb1026-795" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1026-796"><a href="aplikace3.html#cb1026-796" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1026-797"><a href="aplikace3.html#cb1026-797" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1026-798"><a href="aplikace3.html#cb1026-798" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-799"><a href="aplikace3.html#cb1026-799" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1026-800"><a href="aplikace3.html#cb1026-800" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-801"><a href="aplikace3.html#cb1026-801" tabindex="-1"></a>  </span>
<span id="cb1026-802"><a href="aplikace3.html#cb1026-802" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-803"><a href="aplikace3.html#cb1026-803" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1026-804"><a href="aplikace3.html#cb1026-804" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1026-805"><a href="aplikace3.html#cb1026-805" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1026-806"><a href="aplikace3.html#cb1026-806" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1026-807"><a href="aplikace3.html#cb1026-807" tabindex="-1"></a>  </span>
<span id="cb1026-808"><a href="aplikace3.html#cb1026-808" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-809"><a href="aplikace3.html#cb1026-809" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-810"><a href="aplikace3.html#cb1026-810" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1026-811"><a href="aplikace3.html#cb1026-811" tabindex="-1"></a>  </span>
<span id="cb1026-812"><a href="aplikace3.html#cb1026-812" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-813"><a href="aplikace3.html#cb1026-813" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-814"><a href="aplikace3.html#cb1026-814" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1026-815"><a href="aplikace3.html#cb1026-815" tabindex="-1"></a>  </span>
<span id="cb1026-816"><a href="aplikace3.html#cb1026-816" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-817"><a href="aplikace3.html#cb1026-817" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-818"><a href="aplikace3.html#cb1026-818" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-819"><a href="aplikace3.html#cb1026-819" tabindex="-1"></a>  </span>
<span id="cb1026-820"><a href="aplikace3.html#cb1026-820" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-821"><a href="aplikace3.html#cb1026-821" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1026-822"><a href="aplikace3.html#cb1026-822" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-823"><a href="aplikace3.html#cb1026-823" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-824"><a href="aplikace3.html#cb1026-824" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1026-825"><a href="aplikace3.html#cb1026-825" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-826"><a href="aplikace3.html#cb1026-826" tabindex="-1"></a>  </span>
<span id="cb1026-827"><a href="aplikace3.html#cb1026-827" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1026-828"><a href="aplikace3.html#cb1026-828" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-829"><a href="aplikace3.html#cb1026-829" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-830"><a href="aplikace3.html#cb1026-830" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1026-831"><a href="aplikace3.html#cb1026-831" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb1026-832"><a href="aplikace3.html#cb1026-832" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-833"><a href="aplikace3.html#cb1026-833" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-834"><a href="aplikace3.html#cb1026-834" tabindex="-1"></a>  </span>
<span id="cb1026-835"><a href="aplikace3.html#cb1026-835" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb1026-836"><a href="aplikace3.html#cb1026-836" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-837"><a href="aplikace3.html#cb1026-837" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb1026-838"><a href="aplikace3.html#cb1026-838" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1026-839"><a href="aplikace3.html#cb1026-839" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1026-840"><a href="aplikace3.html#cb1026-840" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-841"><a href="aplikace3.html#cb1026-841" tabindex="-1"></a>  </span>
<span id="cb1026-842"><a href="aplikace3.html#cb1026-842" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-843"><a href="aplikace3.html#cb1026-843" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1026-844"><a href="aplikace3.html#cb1026-844" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-845"><a href="aplikace3.html#cb1026-845" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-846"><a href="aplikace3.html#cb1026-846" tabindex="-1"></a>  </span>
<span id="cb1026-847"><a href="aplikace3.html#cb1026-847" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1026-848"><a href="aplikace3.html#cb1026-848" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-849"><a href="aplikace3.html#cb1026-849" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-850"><a href="aplikace3.html#cb1026-850" tabindex="-1"></a>  </span>
<span id="cb1026-851"><a href="aplikace3.html#cb1026-851" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb1026-852"><a href="aplikace3.html#cb1026-852" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-853"><a href="aplikace3.html#cb1026-853" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-854"><a href="aplikace3.html#cb1026-854" tabindex="-1"></a>  </span>
<span id="cb1026-855"><a href="aplikace3.html#cb1026-855" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-856"><a href="aplikace3.html#cb1026-856" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1026-857"><a href="aplikace3.html#cb1026-857" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-858"><a href="aplikace3.html#cb1026-858" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-859"><a href="aplikace3.html#cb1026-859" tabindex="-1"></a>  </span>
<span id="cb1026-860"><a href="aplikace3.html#cb1026-860" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1026-861"><a href="aplikace3.html#cb1026-861" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-862"><a href="aplikace3.html#cb1026-862" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-863"><a href="aplikace3.html#cb1026-863" tabindex="-1"></a>  </span>
<span id="cb1026-864"><a href="aplikace3.html#cb1026-864" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb1026-865"><a href="aplikace3.html#cb1026-865" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-866"><a href="aplikace3.html#cb1026-866" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-867"><a href="aplikace3.html#cb1026-867" tabindex="-1"></a>  </span>
<span id="cb1026-868"><a href="aplikace3.html#cb1026-868" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb1026-869"><a href="aplikace3.html#cb1026-869" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb1026-870"><a href="aplikace3.html#cb1026-870" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb1026-871"><a href="aplikace3.html#cb1026-871" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb1026-872"><a href="aplikace3.html#cb1026-872" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1026-873"><a href="aplikace3.html#cb1026-873" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1026-874"><a href="aplikace3.html#cb1026-874" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1026-875"><a href="aplikace3.html#cb1026-875" tabindex="-1"></a>  </span>
<span id="cb1026-876"><a href="aplikace3.html#cb1026-876" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-877"><a href="aplikace3.html#cb1026-877" tabindex="-1"></a>  </span>
<span id="cb1026-878"><a href="aplikace3.html#cb1026-878" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb1026-879"><a href="aplikace3.html#cb1026-879" tabindex="-1"></a>  </span>
<span id="cb1026-880"><a href="aplikace3.html#cb1026-880" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1026-881"><a href="aplikace3.html#cb1026-881" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-882"><a href="aplikace3.html#cb1026-882" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-883"><a href="aplikace3.html#cb1026-883" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1026-884"><a href="aplikace3.html#cb1026-884" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1026-885"><a href="aplikace3.html#cb1026-885" tabindex="-1"></a>  </span>
<span id="cb1026-886"><a href="aplikace3.html#cb1026-886" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-887"><a href="aplikace3.html#cb1026-887" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-888"><a href="aplikace3.html#cb1026-888" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-889"><a href="aplikace3.html#cb1026-889" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1026-890"><a href="aplikace3.html#cb1026-890" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-891"><a href="aplikace3.html#cb1026-891" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1026-892"><a href="aplikace3.html#cb1026-892" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1026-893"><a href="aplikace3.html#cb1026-893" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1026-894"><a href="aplikace3.html#cb1026-894" tabindex="-1"></a>  )</span>
<span id="cb1026-895"><a href="aplikace3.html#cb1026-895" tabindex="-1"></a>  </span>
<span id="cb1026-896"><a href="aplikace3.html#cb1026-896" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1026-897"><a href="aplikace3.html#cb1026-897" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1026-898"><a href="aplikace3.html#cb1026-898" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1026-899"><a href="aplikace3.html#cb1026-899" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-900"><a href="aplikace3.html#cb1026-900" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-901"><a href="aplikace3.html#cb1026-901" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-902"><a href="aplikace3.html#cb1026-902" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1026-903"><a href="aplikace3.html#cb1026-903" tabindex="-1"></a>      </span>
<span id="cb1026-904"><a href="aplikace3.html#cb1026-904" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb1026-905"><a href="aplikace3.html#cb1026-905" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1026-906"><a href="aplikace3.html#cb1026-906" tabindex="-1"></a>      </span>
<span id="cb1026-907"><a href="aplikace3.html#cb1026-907" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1026-908"><a href="aplikace3.html#cb1026-908" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-909"><a href="aplikace3.html#cb1026-909" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1026-910"><a href="aplikace3.html#cb1026-910" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-911"><a href="aplikace3.html#cb1026-911" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-912"><a href="aplikace3.html#cb1026-912" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1026-913"><a href="aplikace3.html#cb1026-913" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-914"><a href="aplikace3.html#cb1026-914" tabindex="-1"></a>      </span>
<span id="cb1026-915"><a href="aplikace3.html#cb1026-915" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-916"><a href="aplikace3.html#cb1026-916" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1026-917"><a href="aplikace3.html#cb1026-917" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-918"><a href="aplikace3.html#cb1026-918" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-919"><a href="aplikace3.html#cb1026-919" tabindex="-1"></a>      </span>
<span id="cb1026-920"><a href="aplikace3.html#cb1026-920" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1026-921"><a href="aplikace3.html#cb1026-921" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-922"><a href="aplikace3.html#cb1026-922" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1026-923"><a href="aplikace3.html#cb1026-923" tabindex="-1"></a>      </span>
<span id="cb1026-924"><a href="aplikace3.html#cb1026-924" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1026-925"><a href="aplikace3.html#cb1026-925" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1026-926"><a href="aplikace3.html#cb1026-926" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-927"><a href="aplikace3.html#cb1026-927" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1026-928"><a href="aplikace3.html#cb1026-928" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-929"><a href="aplikace3.html#cb1026-929" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-930"><a href="aplikace3.html#cb1026-930" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-931"><a href="aplikace3.html#cb1026-931" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-932"><a href="aplikace3.html#cb1026-932" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1026-933"><a href="aplikace3.html#cb1026-933" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-934"><a href="aplikace3.html#cb1026-934" tabindex="-1"></a>        </span>
<span id="cb1026-935"><a href="aplikace3.html#cb1026-935" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-936"><a href="aplikace3.html#cb1026-936" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1026-937"><a href="aplikace3.html#cb1026-937" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-938"><a href="aplikace3.html#cb1026-938" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-939"><a href="aplikace3.html#cb1026-939" tabindex="-1"></a>        </span>
<span id="cb1026-940"><a href="aplikace3.html#cb1026-940" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1026-941"><a href="aplikace3.html#cb1026-941" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-942"><a href="aplikace3.html#cb1026-942" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1026-943"><a href="aplikace3.html#cb1026-943" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1026-944"><a href="aplikace3.html#cb1026-944" tabindex="-1"></a>      }</span>
<span id="cb1026-945"><a href="aplikace3.html#cb1026-945" tabindex="-1"></a>          </span>
<span id="cb1026-946"><a href="aplikace3.html#cb1026-946" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1026-947"><a href="aplikace3.html#cb1026-947" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1026-948"><a href="aplikace3.html#cb1026-948" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-949"><a href="aplikace3.html#cb1026-949" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb1026-950"><a href="aplikace3.html#cb1026-950" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-951"><a href="aplikace3.html#cb1026-951" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-952"><a href="aplikace3.html#cb1026-952" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-953"><a href="aplikace3.html#cb1026-953" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1026-954"><a href="aplikace3.html#cb1026-954" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-955"><a href="aplikace3.html#cb1026-955" tabindex="-1"></a>        </span>
<span id="cb1026-956"><a href="aplikace3.html#cb1026-956" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-957"><a href="aplikace3.html#cb1026-957" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb1026-958"><a href="aplikace3.html#cb1026-958" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-959"><a href="aplikace3.html#cb1026-959" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-960"><a href="aplikace3.html#cb1026-960" tabindex="-1"></a>        </span>
<span id="cb1026-961"><a href="aplikace3.html#cb1026-961" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1026-962"><a href="aplikace3.html#cb1026-962" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-963"><a href="aplikace3.html#cb1026-963" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1026-964"><a href="aplikace3.html#cb1026-964" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1026-965"><a href="aplikace3.html#cb1026-965" tabindex="-1"></a>      }</span>
<span id="cb1026-966"><a href="aplikace3.html#cb1026-966" tabindex="-1"></a>    }</span>
<span id="cb1026-967"><a href="aplikace3.html#cb1026-967" tabindex="-1"></a>  }</span>
<span id="cb1026-968"><a href="aplikace3.html#cb1026-968" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1026-969"><a href="aplikace3.html#cb1026-969" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1026-970"><a href="aplikace3.html#cb1026-970" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1026-971"><a href="aplikace3.html#cb1026-971" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1026-972"><a href="aplikace3.html#cb1026-972" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-973"><a href="aplikace3.html#cb1026-973" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1026-974"><a href="aplikace3.html#cb1026-974" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-975"><a href="aplikace3.html#cb1026-975" tabindex="-1"></a>  </span>
<span id="cb1026-976"><a href="aplikace3.html#cb1026-976" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-977"><a href="aplikace3.html#cb1026-977" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1026-978"><a href="aplikace3.html#cb1026-978" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1026-979"><a href="aplikace3.html#cb1026-979" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1026-980"><a href="aplikace3.html#cb1026-980" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1026-981"><a href="aplikace3.html#cb1026-981" tabindex="-1"></a>  </span>
<span id="cb1026-982"><a href="aplikace3.html#cb1026-982" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-983"><a href="aplikace3.html#cb1026-983" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-984"><a href="aplikace3.html#cb1026-984" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1026-985"><a href="aplikace3.html#cb1026-985" tabindex="-1"></a>  </span>
<span id="cb1026-986"><a href="aplikace3.html#cb1026-986" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-987"><a href="aplikace3.html#cb1026-987" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-988"><a href="aplikace3.html#cb1026-988" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1026-989"><a href="aplikace3.html#cb1026-989" tabindex="-1"></a>  </span>
<span id="cb1026-990"><a href="aplikace3.html#cb1026-990" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-991"><a href="aplikace3.html#cb1026-991" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-992"><a href="aplikace3.html#cb1026-992" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-993"><a href="aplikace3.html#cb1026-993" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-994"><a href="aplikace3.html#cb1026-994" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1026-995"><a href="aplikace3.html#cb1026-995" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-996"><a href="aplikace3.html#cb1026-996" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-997"><a href="aplikace3.html#cb1026-997" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1026-998"><a href="aplikace3.html#cb1026-998" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-999"><a href="aplikace3.html#cb1026-999" tabindex="-1"></a>  </span>
<span id="cb1026-1000"><a href="aplikace3.html#cb1026-1000" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1026-1001"><a href="aplikace3.html#cb1026-1001" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1002"><a href="aplikace3.html#cb1026-1002" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1003"><a href="aplikace3.html#cb1026-1003" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1026-1004"><a href="aplikace3.html#cb1026-1004" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1005"><a href="aplikace3.html#cb1026-1005" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb1026-1006"><a href="aplikace3.html#cb1026-1006" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-1007"><a href="aplikace3.html#cb1026-1007" tabindex="-1"></a>  </span>
<span id="cb1026-1008"><a href="aplikace3.html#cb1026-1008" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb1026-1009"><a href="aplikace3.html#cb1026-1009" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1010"><a href="aplikace3.html#cb1026-1010" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1011"><a href="aplikace3.html#cb1026-1011" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1026-1012"><a href="aplikace3.html#cb1026-1012" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1026-1013"><a href="aplikace3.html#cb1026-1013" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-1014"><a href="aplikace3.html#cb1026-1014" tabindex="-1"></a>  </span>
<span id="cb1026-1015"><a href="aplikace3.html#cb1026-1015" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1016"><a href="aplikace3.html#cb1026-1016" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-1017"><a href="aplikace3.html#cb1026-1017" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1018"><a href="aplikace3.html#cb1026-1018" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1019"><a href="aplikace3.html#cb1026-1019" tabindex="-1"></a>  </span>
<span id="cb1026-1020"><a href="aplikace3.html#cb1026-1020" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-1021"><a href="aplikace3.html#cb1026-1021" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1022"><a href="aplikace3.html#cb1026-1022" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1023"><a href="aplikace3.html#cb1026-1023" tabindex="-1"></a>  </span>
<span id="cb1026-1024"><a href="aplikace3.html#cb1026-1024" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb1026-1025"><a href="aplikace3.html#cb1026-1025" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1026"><a href="aplikace3.html#cb1026-1026" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1027"><a href="aplikace3.html#cb1026-1027" tabindex="-1"></a>    </span>
<span id="cb1026-1028"><a href="aplikace3.html#cb1026-1028" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-1029"><a href="aplikace3.html#cb1026-1029" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-1030"><a href="aplikace3.html#cb1026-1030" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1031"><a href="aplikace3.html#cb1026-1031" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1032"><a href="aplikace3.html#cb1026-1032" tabindex="-1"></a>  </span>
<span id="cb1026-1033"><a href="aplikace3.html#cb1026-1033" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-1034"><a href="aplikace3.html#cb1026-1034" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1035"><a href="aplikace3.html#cb1026-1035" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1036"><a href="aplikace3.html#cb1026-1036" tabindex="-1"></a>  </span>
<span id="cb1026-1037"><a href="aplikace3.html#cb1026-1037" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb1026-1038"><a href="aplikace3.html#cb1026-1038" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1039"><a href="aplikace3.html#cb1026-1039" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1040"><a href="aplikace3.html#cb1026-1040" tabindex="-1"></a>  </span>
<span id="cb1026-1041"><a href="aplikace3.html#cb1026-1041" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb1026-1042"><a href="aplikace3.html#cb1026-1042" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb1026-1043"><a href="aplikace3.html#cb1026-1043" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb1026-1044"><a href="aplikace3.html#cb1026-1044" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb1026-1045"><a href="aplikace3.html#cb1026-1045" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1026-1046"><a href="aplikace3.html#cb1026-1046" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1026-1047"><a href="aplikace3.html#cb1026-1047" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1026-1048"><a href="aplikace3.html#cb1026-1048" tabindex="-1"></a>  </span>
<span id="cb1026-1049"><a href="aplikace3.html#cb1026-1049" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-1050"><a href="aplikace3.html#cb1026-1050" tabindex="-1"></a>  </span>
<span id="cb1026-1051"><a href="aplikace3.html#cb1026-1051" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb1026-1052"><a href="aplikace3.html#cb1026-1052" tabindex="-1"></a>  </span>
<span id="cb1026-1053"><a href="aplikace3.html#cb1026-1053" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb1026-1054"><a href="aplikace3.html#cb1026-1054" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-1055"><a href="aplikace3.html#cb1026-1055" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb1026-1056"><a href="aplikace3.html#cb1026-1056" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb1026-1057"><a href="aplikace3.html#cb1026-1057" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1026-1058"><a href="aplikace3.html#cb1026-1058" tabindex="-1"></a>  </span>
<span id="cb1026-1059"><a href="aplikace3.html#cb1026-1059" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-1060"><a href="aplikace3.html#cb1026-1060" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-1061"><a href="aplikace3.html#cb1026-1061" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-1062"><a href="aplikace3.html#cb1026-1062" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1026-1063"><a href="aplikace3.html#cb1026-1063" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-1064"><a href="aplikace3.html#cb1026-1064" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb1026-1065"><a href="aplikace3.html#cb1026-1065" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb1026-1066"><a href="aplikace3.html#cb1026-1066" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb1026-1067"><a href="aplikace3.html#cb1026-1067" tabindex="-1"></a>  )</span>
<span id="cb1026-1068"><a href="aplikace3.html#cb1026-1068" tabindex="-1"></a>  </span>
<span id="cb1026-1069"><a href="aplikace3.html#cb1026-1069" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb1026-1070"><a href="aplikace3.html#cb1026-1070" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb1026-1071"><a href="aplikace3.html#cb1026-1071" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb1026-1072"><a href="aplikace3.html#cb1026-1072" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-1073"><a href="aplikace3.html#cb1026-1073" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-1074"><a href="aplikace3.html#cb1026-1074" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-1075"><a href="aplikace3.html#cb1026-1075" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1026-1076"><a href="aplikace3.html#cb1026-1076" tabindex="-1"></a>      </span>
<span id="cb1026-1077"><a href="aplikace3.html#cb1026-1077" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb1026-1078"><a href="aplikace3.html#cb1026-1078" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1026-1079"><a href="aplikace3.html#cb1026-1079" tabindex="-1"></a>      </span>
<span id="cb1026-1080"><a href="aplikace3.html#cb1026-1080" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb1026-1081"><a href="aplikace3.html#cb1026-1081" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1082"><a href="aplikace3.html#cb1026-1082" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1026-1083"><a href="aplikace3.html#cb1026-1083" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1084"><a href="aplikace3.html#cb1026-1084" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1085"><a href="aplikace3.html#cb1026-1085" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb1026-1086"><a href="aplikace3.html#cb1026-1086" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-1087"><a href="aplikace3.html#cb1026-1087" tabindex="-1"></a>      </span>
<span id="cb1026-1088"><a href="aplikace3.html#cb1026-1088" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1089"><a href="aplikace3.html#cb1026-1089" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1026-1090"><a href="aplikace3.html#cb1026-1090" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1091"><a href="aplikace3.html#cb1026-1091" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1092"><a href="aplikace3.html#cb1026-1092" tabindex="-1"></a>      </span>
<span id="cb1026-1093"><a href="aplikace3.html#cb1026-1093" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb1026-1094"><a href="aplikace3.html#cb1026-1094" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-1095"><a href="aplikace3.html#cb1026-1095" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1026-1096"><a href="aplikace3.html#cb1026-1096" tabindex="-1"></a>      </span>
<span id="cb1026-1097"><a href="aplikace3.html#cb1026-1097" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb1026-1098"><a href="aplikace3.html#cb1026-1098" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb1026-1099"><a href="aplikace3.html#cb1026-1099" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1100"><a href="aplikace3.html#cb1026-1100" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1026-1101"><a href="aplikace3.html#cb1026-1101" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1102"><a href="aplikace3.html#cb1026-1102" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1103"><a href="aplikace3.html#cb1026-1103" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-1104"><a href="aplikace3.html#cb1026-1104" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1105"><a href="aplikace3.html#cb1026-1105" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb1026-1106"><a href="aplikace3.html#cb1026-1106" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-1107"><a href="aplikace3.html#cb1026-1107" tabindex="-1"></a>        </span>
<span id="cb1026-1108"><a href="aplikace3.html#cb1026-1108" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1109"><a href="aplikace3.html#cb1026-1109" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb1026-1110"><a href="aplikace3.html#cb1026-1110" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1026-1111"><a href="aplikace3.html#cb1026-1111" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1112"><a href="aplikace3.html#cb1026-1112" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1113"><a href="aplikace3.html#cb1026-1113" tabindex="-1"></a>        </span>
<span id="cb1026-1114"><a href="aplikace3.html#cb1026-1114" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb1026-1115"><a href="aplikace3.html#cb1026-1115" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-1116"><a href="aplikace3.html#cb1026-1116" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb1026-1117"><a href="aplikace3.html#cb1026-1117" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1026-1118"><a href="aplikace3.html#cb1026-1118" tabindex="-1"></a>      }</span>
<span id="cb1026-1119"><a href="aplikace3.html#cb1026-1119" tabindex="-1"></a>          </span>
<span id="cb1026-1120"><a href="aplikace3.html#cb1026-1120" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb1026-1121"><a href="aplikace3.html#cb1026-1121" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1026-1122"><a href="aplikace3.html#cb1026-1122" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1123"><a href="aplikace3.html#cb1026-1123" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb1026-1124"><a href="aplikace3.html#cb1026-1124" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1125"><a href="aplikace3.html#cb1026-1125" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1126"><a href="aplikace3.html#cb1026-1126" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb1026-1127"><a href="aplikace3.html#cb1026-1127" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb1026-1128"><a href="aplikace3.html#cb1026-1128" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-1129"><a href="aplikace3.html#cb1026-1129" tabindex="-1"></a>        </span>
<span id="cb1026-1130"><a href="aplikace3.html#cb1026-1130" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1131"><a href="aplikace3.html#cb1026-1131" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb1026-1132"><a href="aplikace3.html#cb1026-1132" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb1026-1133"><a href="aplikace3.html#cb1026-1133" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1134"><a href="aplikace3.html#cb1026-1134" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1135"><a href="aplikace3.html#cb1026-1135" tabindex="-1"></a>        </span>
<span id="cb1026-1136"><a href="aplikace3.html#cb1026-1136" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb1026-1137"><a href="aplikace3.html#cb1026-1137" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb1026-1138"><a href="aplikace3.html#cb1026-1138" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb1026-1139"><a href="aplikace3.html#cb1026-1139" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1026-1140"><a href="aplikace3.html#cb1026-1140" tabindex="-1"></a>      }</span>
<span id="cb1026-1141"><a href="aplikace3.html#cb1026-1141" tabindex="-1"></a>    }</span>
<span id="cb1026-1142"><a href="aplikace3.html#cb1026-1142" tabindex="-1"></a>  }</span>
<span id="cb1026-1143"><a href="aplikace3.html#cb1026-1143" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb1026-1144"><a href="aplikace3.html#cb1026-1144" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb1026-1145"><a href="aplikace3.html#cb1026-1145" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb1026-1146"><a href="aplikace3.html#cb1026-1146" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb1026-1147"><a href="aplikace3.html#cb1026-1147" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-1148"><a href="aplikace3.html#cb1026-1148" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb1026-1149"><a href="aplikace3.html#cb1026-1149" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-1150"><a href="aplikace3.html#cb1026-1150" tabindex="-1"></a>  </span>
<span id="cb1026-1151"><a href="aplikace3.html#cb1026-1151" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-1152"><a href="aplikace3.html#cb1026-1152" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb1026-1153"><a href="aplikace3.html#cb1026-1153" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb1026-1154"><a href="aplikace3.html#cb1026-1154" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb1026-1155"><a href="aplikace3.html#cb1026-1155" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb1026-1156"><a href="aplikace3.html#cb1026-1156" tabindex="-1"></a>  </span>
<span id="cb1026-1157"><a href="aplikace3.html#cb1026-1157" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-1158"><a href="aplikace3.html#cb1026-1158" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-1159"><a href="aplikace3.html#cb1026-1159" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1026-1160"><a href="aplikace3.html#cb1026-1160" tabindex="-1"></a>  </span>
<span id="cb1026-1161"><a href="aplikace3.html#cb1026-1161" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-1162"><a href="aplikace3.html#cb1026-1162" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb1026-1163"><a href="aplikace3.html#cb1026-1163" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb1026-1164"><a href="aplikace3.html#cb1026-1164" tabindex="-1"></a>  </span>
<span id="cb1026-1165"><a href="aplikace3.html#cb1026-1165" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-1166"><a href="aplikace3.html#cb1026-1166" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-1167"><a href="aplikace3.html#cb1026-1167" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-1168"><a href="aplikace3.html#cb1026-1168" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1169"><a href="aplikace3.html#cb1026-1169" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1026-1170"><a href="aplikace3.html#cb1026-1170" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1171"><a href="aplikace3.html#cb1026-1171" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1172"><a href="aplikace3.html#cb1026-1172" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb1026-1173"><a href="aplikace3.html#cb1026-1173" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-1174"><a href="aplikace3.html#cb1026-1174" tabindex="-1"></a>  </span>
<span id="cb1026-1175"><a href="aplikace3.html#cb1026-1175" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1026-1176"><a href="aplikace3.html#cb1026-1176" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1177"><a href="aplikace3.html#cb1026-1177" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1178"><a href="aplikace3.html#cb1026-1178" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb1026-1179"><a href="aplikace3.html#cb1026-1179" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb1026-1180"><a href="aplikace3.html#cb1026-1180" tabindex="-1"></a>                          <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1181"><a href="aplikace3.html#cb1026-1181" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-1182"><a href="aplikace3.html#cb1026-1182" tabindex="-1"></a>  </span>
<span id="cb1026-1183"><a href="aplikace3.html#cb1026-1183" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb1026-1184"><a href="aplikace3.html#cb1026-1184" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1185"><a href="aplikace3.html#cb1026-1185" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1186"><a href="aplikace3.html#cb1026-1186" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb1026-1187"><a href="aplikace3.html#cb1026-1187" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb1026-1188"><a href="aplikace3.html#cb1026-1188" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-1189"><a href="aplikace3.html#cb1026-1189" tabindex="-1"></a>  </span>
<span id="cb1026-1190"><a href="aplikace3.html#cb1026-1190" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1191"><a href="aplikace3.html#cb1026-1191" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1026-1192"><a href="aplikace3.html#cb1026-1192" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1193"><a href="aplikace3.html#cb1026-1193" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1194"><a href="aplikace3.html#cb1026-1194" tabindex="-1"></a>  </span>
<span id="cb1026-1195"><a href="aplikace3.html#cb1026-1195" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1026-1196"><a href="aplikace3.html#cb1026-1196" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1197"><a href="aplikace3.html#cb1026-1197" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1198"><a href="aplikace3.html#cb1026-1198" tabindex="-1"></a>  </span>
<span id="cb1026-1199"><a href="aplikace3.html#cb1026-1199" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb1026-1200"><a href="aplikace3.html#cb1026-1200" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1201"><a href="aplikace3.html#cb1026-1201" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1202"><a href="aplikace3.html#cb1026-1202" tabindex="-1"></a>    </span>
<span id="cb1026-1203"><a href="aplikace3.html#cb1026-1203" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-1204"><a href="aplikace3.html#cb1026-1204" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1026-1205"><a href="aplikace3.html#cb1026-1205" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1206"><a href="aplikace3.html#cb1026-1206" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1207"><a href="aplikace3.html#cb1026-1207" tabindex="-1"></a>  </span>
<span id="cb1026-1208"><a href="aplikace3.html#cb1026-1208" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1026-1209"><a href="aplikace3.html#cb1026-1209" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1210"><a href="aplikace3.html#cb1026-1210" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1211"><a href="aplikace3.html#cb1026-1211" tabindex="-1"></a>  </span>
<span id="cb1026-1212"><a href="aplikace3.html#cb1026-1212" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb1026-1213"><a href="aplikace3.html#cb1026-1213" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1214"><a href="aplikace3.html#cb1026-1214" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1215"><a href="aplikace3.html#cb1026-1215" tabindex="-1"></a></span>
<span id="cb1026-1216"><a href="aplikace3.html#cb1026-1216" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb1026-1217"><a href="aplikace3.html#cb1026-1217" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb1026-1218"><a href="aplikace3.html#cb1026-1218" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb1026-1219"><a href="aplikace3.html#cb1026-1219" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb1026-1220"><a href="aplikace3.html#cb1026-1220" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb1026-1221"><a href="aplikace3.html#cb1026-1221" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb1026-1222"><a href="aplikace3.html#cb1026-1222" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb1026-1223"><a href="aplikace3.html#cb1026-1223" tabindex="-1"></a></span>
<span id="cb1026-1224"><a href="aplikace3.html#cb1026-1224" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-1225"><a href="aplikace3.html#cb1026-1225" tabindex="-1"></a>  </span>
<span id="cb1026-1226"><a href="aplikace3.html#cb1026-1226" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb1026-1227"><a href="aplikace3.html#cb1026-1227" tabindex="-1"></a>  </span>
<span id="cb1026-1228"><a href="aplikace3.html#cb1026-1228" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb1026-1229"><a href="aplikace3.html#cb1026-1229" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb1026-1230"><a href="aplikace3.html#cb1026-1230" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb1026-1231"><a href="aplikace3.html#cb1026-1231" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb1026-1232"><a href="aplikace3.html#cb1026-1232" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb1026-1233"><a href="aplikace3.html#cb1026-1233" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb1026-1234"><a href="aplikace3.html#cb1026-1234" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-1235"><a href="aplikace3.html#cb1026-1235" tabindex="-1"></a>  </span>
<span id="cb1026-1236"><a href="aplikace3.html#cb1026-1236" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb1026-1237"><a href="aplikace3.html#cb1026-1237" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb1026-1238"><a href="aplikace3.html#cb1026-1238" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb1026-1239"><a href="aplikace3.html#cb1026-1239" tabindex="-1"></a>  </span>
<span id="cb1026-1240"><a href="aplikace3.html#cb1026-1240" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb1026-1241"><a href="aplikace3.html#cb1026-1241" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb1026-1242"><a href="aplikace3.html#cb1026-1242" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb1026-1243"><a href="aplikace3.html#cb1026-1243" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb1026-1244"><a href="aplikace3.html#cb1026-1244" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-1245"><a href="aplikace3.html#cb1026-1245" tabindex="-1"></a>    </span>
<span id="cb1026-1246"><a href="aplikace3.html#cb1026-1246" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-1247"><a href="aplikace3.html#cb1026-1247" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-1248"><a href="aplikace3.html#cb1026-1248" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb1026-1249"><a href="aplikace3.html#cb1026-1249" tabindex="-1"></a>      </span>
<span id="cb1026-1250"><a href="aplikace3.html#cb1026-1250" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb1026-1251"><a href="aplikace3.html#cb1026-1251" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb1026-1252"><a href="aplikace3.html#cb1026-1252" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb1026-1253"><a href="aplikace3.html#cb1026-1253" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb1026-1254"><a href="aplikace3.html#cb1026-1254" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb1026-1255"><a href="aplikace3.html#cb1026-1255" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1256"><a href="aplikace3.html#cb1026-1256" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1026-1257"><a href="aplikace3.html#cb1026-1257" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1258"><a href="aplikace3.html#cb1026-1258" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1259"><a href="aplikace3.html#cb1026-1259" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb1026-1260"><a href="aplikace3.html#cb1026-1260" tabindex="-1"></a>      </span>
<span id="cb1026-1261"><a href="aplikace3.html#cb1026-1261" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1026-1262"><a href="aplikace3.html#cb1026-1262" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1263"><a href="aplikace3.html#cb1026-1263" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1264"><a href="aplikace3.html#cb1026-1264" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1265"><a href="aplikace3.html#cb1026-1265" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb1026-1266"><a href="aplikace3.html#cb1026-1266" tabindex="-1"></a>      </span>
<span id="cb1026-1267"><a href="aplikace3.html#cb1026-1267" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb1026-1268"><a href="aplikace3.html#cb1026-1268" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1269"><a href="aplikace3.html#cb1026-1269" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1270"><a href="aplikace3.html#cb1026-1270" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb1026-1271"><a href="aplikace3.html#cb1026-1271" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1272"><a href="aplikace3.html#cb1026-1272" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb1026-1273"><a href="aplikace3.html#cb1026-1273" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb1026-1274"><a href="aplikace3.html#cb1026-1274" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1026-1275"><a href="aplikace3.html#cb1026-1275" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb1026-1276"><a href="aplikace3.html#cb1026-1276" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1277"><a href="aplikace3.html#cb1026-1277" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb1026-1278"><a href="aplikace3.html#cb1026-1278" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb1026-1279"><a href="aplikace3.html#cb1026-1279" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1026-1280"><a href="aplikace3.html#cb1026-1280" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb1026-1281"><a href="aplikace3.html#cb1026-1281" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1282"><a href="aplikace3.html#cb1026-1282" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb1026-1283"><a href="aplikace3.html#cb1026-1283" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb1026-1284"><a href="aplikace3.html#cb1026-1284" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb1026-1285"><a href="aplikace3.html#cb1026-1285" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb1026-1286"><a href="aplikace3.html#cb1026-1286" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1287"><a href="aplikace3.html#cb1026-1287" tabindex="-1"></a>      </span>
<span id="cb1026-1288"><a href="aplikace3.html#cb1026-1288" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb1026-1289"><a href="aplikace3.html#cb1026-1289" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb1026-1290"><a href="aplikace3.html#cb1026-1290" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb1026-1291"><a href="aplikace3.html#cb1026-1291" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb1026-1292"><a href="aplikace3.html#cb1026-1292" tabindex="-1"></a>    }</span>
<span id="cb1026-1293"><a href="aplikace3.html#cb1026-1293" tabindex="-1"></a>  }</span>
<span id="cb1026-1294"><a href="aplikace3.html#cb1026-1294" tabindex="-1"></a>  </span>
<span id="cb1026-1295"><a href="aplikace3.html#cb1026-1295" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1026-1296"><a href="aplikace3.html#cb1026-1296" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1026-1297"><a href="aplikace3.html#cb1026-1297" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb1026-1298"><a href="aplikace3.html#cb1026-1298" tabindex="-1"></a>  }</span>
<span id="cb1026-1299"><a href="aplikace3.html#cb1026-1299" tabindex="-1"></a>  </span>
<span id="cb1026-1300"><a href="aplikace3.html#cb1026-1300" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb1026-1301"><a href="aplikace3.html#cb1026-1301" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb1026-1302"><a href="aplikace3.html#cb1026-1302" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb1026-1303"><a href="aplikace3.html#cb1026-1303" tabindex="-1"></a>  </span>
<span id="cb1026-1304"><a href="aplikace3.html#cb1026-1304" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb1026-1305"><a href="aplikace3.html#cb1026-1305" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1026-1306"><a href="aplikace3.html#cb1026-1306" tabindex="-1"></a>  </span>
<span id="cb1026-1307"><a href="aplikace3.html#cb1026-1307" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1308"><a href="aplikace3.html#cb1026-1308" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb1026-1309"><a href="aplikace3.html#cb1026-1309" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb1026-1310"><a href="aplikace3.html#cb1026-1310" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb1026-1311"><a href="aplikace3.html#cb1026-1311" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1026-1312"><a href="aplikace3.html#cb1026-1312" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1313"><a href="aplikace3.html#cb1026-1313" tabindex="-1"></a>  </span>
<span id="cb1026-1314"><a href="aplikace3.html#cb1026-1314" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1315"><a href="aplikace3.html#cb1026-1315" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1316"><a href="aplikace3.html#cb1026-1316" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb1026-1317"><a href="aplikace3.html#cb1026-1317" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb1026-1318"><a href="aplikace3.html#cb1026-1318" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb1026-1319"><a href="aplikace3.html#cb1026-1319" tabindex="-1"></a>    </span>
<span id="cb1026-1320"><a href="aplikace3.html#cb1026-1320" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb1026-1321"><a href="aplikace3.html#cb1026-1321" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb1026-1322"><a href="aplikace3.html#cb1026-1322" tabindex="-1"></a>    </span>
<span id="cb1026-1323"><a href="aplikace3.html#cb1026-1323" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb1026-1324"><a href="aplikace3.html#cb1026-1324" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1026-1325"><a href="aplikace3.html#cb1026-1325" tabindex="-1"></a>    </span>
<span id="cb1026-1326"><a href="aplikace3.html#cb1026-1326" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb1026-1327"><a href="aplikace3.html#cb1026-1327" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-1328"><a href="aplikace3.html#cb1026-1328" tabindex="-1"></a>    </span>
<span id="cb1026-1329"><a href="aplikace3.html#cb1026-1329" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1330"><a href="aplikace3.html#cb1026-1330" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb1026-1331"><a href="aplikace3.html#cb1026-1331" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1332"><a href="aplikace3.html#cb1026-1332" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1333"><a href="aplikace3.html#cb1026-1333" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1334"><a href="aplikace3.html#cb1026-1334" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1335"><a href="aplikace3.html#cb1026-1335" tabindex="-1"></a>    </span>
<span id="cb1026-1336"><a href="aplikace3.html#cb1026-1336" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1337"><a href="aplikace3.html#cb1026-1337" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb1026-1338"><a href="aplikace3.html#cb1026-1338" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-1339"><a href="aplikace3.html#cb1026-1339" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1340"><a href="aplikace3.html#cb1026-1340" tabindex="-1"></a>      </span>
<span id="cb1026-1341"><a href="aplikace3.html#cb1026-1341" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1342"><a href="aplikace3.html#cb1026-1342" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb1026-1343"><a href="aplikace3.html#cb1026-1343" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1344"><a href="aplikace3.html#cb1026-1344" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1345"><a href="aplikace3.html#cb1026-1345" tabindex="-1"></a>    </span>
<span id="cb1026-1346"><a href="aplikace3.html#cb1026-1346" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1347"><a href="aplikace3.html#cb1026-1347" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1026-1348"><a href="aplikace3.html#cb1026-1348" tabindex="-1"></a>  }</span>
<span id="cb1026-1349"><a href="aplikace3.html#cb1026-1349" tabindex="-1"></a>  </span>
<span id="cb1026-1350"><a href="aplikace3.html#cb1026-1350" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-1351"><a href="aplikace3.html#cb1026-1351" tabindex="-1"></a>  </span>
<span id="cb1026-1352"><a href="aplikace3.html#cb1026-1352" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb1026-1353"><a href="aplikace3.html#cb1026-1353" tabindex="-1"></a>  </span>
<span id="cb1026-1354"><a href="aplikace3.html#cb1026-1354" tabindex="-1"></a>  C <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb1026-1355"><a href="aplikace3.html#cb1026-1355" tabindex="-1"></a>  eps <span class="ot">&lt;-</span> <span class="fl">0.01</span></span>
<span id="cb1026-1356"><a href="aplikace3.html#cb1026-1356" tabindex="-1"></a>  </span>
<span id="cb1026-1357"><a href="aplikace3.html#cb1026-1357" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb1026-1358"><a href="aplikace3.html#cb1026-1358" tabindex="-1"></a>  </span>
<span id="cb1026-1359"><a href="aplikace3.html#cb1026-1359" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb1026-1360"><a href="aplikace3.html#cb1026-1360" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb1026-1361"><a href="aplikace3.html#cb1026-1361" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb1026-1362"><a href="aplikace3.html#cb1026-1362" tabindex="-1"></a>  }</span>
<span id="cb1026-1363"><a href="aplikace3.html#cb1026-1363" tabindex="-1"></a>  </span>
<span id="cb1026-1364"><a href="aplikace3.html#cb1026-1364" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb1026-1365"><a href="aplikace3.html#cb1026-1365" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1026-1366"><a href="aplikace3.html#cb1026-1366" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1026-1367"><a href="aplikace3.html#cb1026-1367" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1026-1368"><a href="aplikace3.html#cb1026-1368" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb1026-1369"><a href="aplikace3.html#cb1026-1369" tabindex="-1"></a>      }</span>
<span id="cb1026-1370"><a href="aplikace3.html#cb1026-1370" tabindex="-1"></a>    }</span>
<span id="cb1026-1371"><a href="aplikace3.html#cb1026-1371" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1026-1372"><a href="aplikace3.html#cb1026-1372" tabindex="-1"></a>  }</span>
<span id="cb1026-1373"><a href="aplikace3.html#cb1026-1373" tabindex="-1"></a>  </span>
<span id="cb1026-1374"><a href="aplikace3.html#cb1026-1374" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-1375"><a href="aplikace3.html#cb1026-1375" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-1376"><a href="aplikace3.html#cb1026-1376" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1377"><a href="aplikace3.html#cb1026-1377" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1378"><a href="aplikace3.html#cb1026-1378" tabindex="-1"></a>  </span>
<span id="cb1026-1379"><a href="aplikace3.html#cb1026-1379" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1026-1380"><a href="aplikace3.html#cb1026-1380" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">30</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1026-1381"><a href="aplikace3.html#cb1026-1381" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb1026-1382"><a href="aplikace3.html#cb1026-1382" tabindex="-1"></a>  </span>
<span id="cb1026-1383"><a href="aplikace3.html#cb1026-1383" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-1384"><a href="aplikace3.html#cb1026-1384" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-1385"><a href="aplikace3.html#cb1026-1385" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-1386"><a href="aplikace3.html#cb1026-1386" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb1026-1387"><a href="aplikace3.html#cb1026-1387" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb1026-1388"><a href="aplikace3.html#cb1026-1388" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1026-1389"><a href="aplikace3.html#cb1026-1389" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1026-1390"><a href="aplikace3.html#cb1026-1390" tabindex="-1"></a>  </span>
<span id="cb1026-1391"><a href="aplikace3.html#cb1026-1391" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-1392"><a href="aplikace3.html#cb1026-1392" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1393"><a href="aplikace3.html#cb1026-1393" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1394"><a href="aplikace3.html#cb1026-1394" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1395"><a href="aplikace3.html#cb1026-1395" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1396"><a href="aplikace3.html#cb1026-1396" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1397"><a href="aplikace3.html#cb1026-1397" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1026-1398"><a href="aplikace3.html#cb1026-1398" tabindex="-1"></a>  </span>
<span id="cb1026-1399"><a href="aplikace3.html#cb1026-1399" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1026-1400"><a href="aplikace3.html#cb1026-1400" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb1026-1401"><a href="aplikace3.html#cb1026-1401" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb1026-1402"><a href="aplikace3.html#cb1026-1402" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-1403"><a href="aplikace3.html#cb1026-1403" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-1404"><a href="aplikace3.html#cb1026-1404" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-1405"><a href="aplikace3.html#cb1026-1405" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1026-1406"><a href="aplikace3.html#cb1026-1406" tabindex="-1"></a>    </span>
<span id="cb1026-1407"><a href="aplikace3.html#cb1026-1407" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1026-1408"><a href="aplikace3.html#cb1026-1408" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1409"><a href="aplikace3.html#cb1026-1409" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-1410"><a href="aplikace3.html#cb1026-1410" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-1411"><a href="aplikace3.html#cb1026-1411" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-1412"><a href="aplikace3.html#cb1026-1412" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1026-1413"><a href="aplikace3.html#cb1026-1413" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-1414"><a href="aplikace3.html#cb1026-1414" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps, </span>
<span id="cb1026-1415"><a href="aplikace3.html#cb1026-1415" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1026-1416"><a href="aplikace3.html#cb1026-1416" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb1026-1417"><a href="aplikace3.html#cb1026-1417" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1026-1418"><a href="aplikace3.html#cb1026-1418" tabindex="-1"></a>    }</span>
<span id="cb1026-1419"><a href="aplikace3.html#cb1026-1419" tabindex="-1"></a>    </span>
<span id="cb1026-1420"><a href="aplikace3.html#cb1026-1420" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb1026-1421"><a href="aplikace3.html#cb1026-1421" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1026-1422"><a href="aplikace3.html#cb1026-1422" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-1423"><a href="aplikace3.html#cb1026-1423" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-1424"><a href="aplikace3.html#cb1026-1424" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1026-1425"><a href="aplikace3.html#cb1026-1425" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-1426"><a href="aplikace3.html#cb1026-1426" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1427"><a href="aplikace3.html#cb1026-1427" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1026-1428"><a href="aplikace3.html#cb1026-1428" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-1429"><a href="aplikace3.html#cb1026-1429" tabindex="-1"></a>      }</span>
<span id="cb1026-1430"><a href="aplikace3.html#cb1026-1430" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb1026-1431"><a href="aplikace3.html#cb1026-1431" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-1432"><a href="aplikace3.html#cb1026-1432" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-1433"><a href="aplikace3.html#cb1026-1433" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-1434"><a href="aplikace3.html#cb1026-1434" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1026-1435"><a href="aplikace3.html#cb1026-1435" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1026-1436"><a href="aplikace3.html#cb1026-1436" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1026-1437"><a href="aplikace3.html#cb1026-1437" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1438"><a href="aplikace3.html#cb1026-1438" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1026-1439"><a href="aplikace3.html#cb1026-1439" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1026-1440"><a href="aplikace3.html#cb1026-1440" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1026-1441"><a href="aplikace3.html#cb1026-1441" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1442"><a href="aplikace3.html#cb1026-1442" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1443"><a href="aplikace3.html#cb1026-1443" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1444"><a href="aplikace3.html#cb1026-1444" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1445"><a href="aplikace3.html#cb1026-1445" tabindex="-1"></a>        </span>
<span id="cb1026-1446"><a href="aplikace3.html#cb1026-1446" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-1447"><a href="aplikace3.html#cb1026-1447" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1026-1448"><a href="aplikace3.html#cb1026-1448" tabindex="-1"></a>          </span>
<span id="cb1026-1449"><a href="aplikace3.html#cb1026-1449" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-1450"><a href="aplikace3.html#cb1026-1450" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1026-1451"><a href="aplikace3.html#cb1026-1451" tabindex="-1"></a>          </span>
<span id="cb1026-1452"><a href="aplikace3.html#cb1026-1452" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1453"><a href="aplikace3.html#cb1026-1453" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-1454"><a href="aplikace3.html#cb1026-1454" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1455"><a href="aplikace3.html#cb1026-1455" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1456"><a href="aplikace3.html#cb1026-1456" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb1026-1457"><a href="aplikace3.html#cb1026-1457" tabindex="-1"></a>                              <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1458"><a href="aplikace3.html#cb1026-1458" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1459"><a href="aplikace3.html#cb1026-1459" tabindex="-1"></a>          </span>
<span id="cb1026-1460"><a href="aplikace3.html#cb1026-1460" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1461"><a href="aplikace3.html#cb1026-1461" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-1462"><a href="aplikace3.html#cb1026-1462" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1463"><a href="aplikace3.html#cb1026-1463" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1464"><a href="aplikace3.html#cb1026-1464" tabindex="-1"></a>          </span>
<span id="cb1026-1465"><a href="aplikace3.html#cb1026-1465" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1466"><a href="aplikace3.html#cb1026-1466" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1026-1467"><a href="aplikace3.html#cb1026-1467" tabindex="-1"></a>        }</span>
<span id="cb1026-1468"><a href="aplikace3.html#cb1026-1468" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1026-1469"><a href="aplikace3.html#cb1026-1469" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1026-1470"><a href="aplikace3.html#cb1026-1470" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1471"><a href="aplikace3.html#cb1026-1471" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1472"><a href="aplikace3.html#cb1026-1472" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1026-1473"><a href="aplikace3.html#cb1026-1473" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1474"><a href="aplikace3.html#cb1026-1474" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1475"><a href="aplikace3.html#cb1026-1475" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb1026-1476"><a href="aplikace3.html#cb1026-1476" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1477"><a href="aplikace3.html#cb1026-1477" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1478"><a href="aplikace3.html#cb1026-1478" tabindex="-1"></a>      }</span>
<span id="cb1026-1479"><a href="aplikace3.html#cb1026-1479" tabindex="-1"></a>    }</span>
<span id="cb1026-1480"><a href="aplikace3.html#cb1026-1480" tabindex="-1"></a>  }</span>
<span id="cb1026-1481"><a href="aplikace3.html#cb1026-1481" tabindex="-1"></a>  </span>
<span id="cb1026-1482"><a href="aplikace3.html#cb1026-1482" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1026-1483"><a href="aplikace3.html#cb1026-1483" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1026-1484"><a href="aplikace3.html#cb1026-1484" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-1485"><a href="aplikace3.html#cb1026-1485" tabindex="-1"></a>  }</span>
<span id="cb1026-1486"><a href="aplikace3.html#cb1026-1486" tabindex="-1"></a>  </span>
<span id="cb1026-1487"><a href="aplikace3.html#cb1026-1487" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb1026-1488"><a href="aplikace3.html#cb1026-1488" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb1026-1489"><a href="aplikace3.html#cb1026-1489" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb1026-1490"><a href="aplikace3.html#cb1026-1490" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb1026-1491"><a href="aplikace3.html#cb1026-1491" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb1026-1492"><a href="aplikace3.html#cb1026-1492" tabindex="-1"></a>  </span>
<span id="cb1026-1493"><a href="aplikace3.html#cb1026-1493" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1494"><a href="aplikace3.html#cb1026-1494" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1495"><a href="aplikace3.html#cb1026-1495" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1026-1496"><a href="aplikace3.html#cb1026-1496" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1026-1497"><a href="aplikace3.html#cb1026-1497" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1026-1498"><a href="aplikace3.html#cb1026-1498" tabindex="-1"></a>  </span>
<span id="cb1026-1499"><a href="aplikace3.html#cb1026-1499" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-1500"><a href="aplikace3.html#cb1026-1500" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-1501"><a href="aplikace3.html#cb1026-1501" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-1502"><a href="aplikace3.html#cb1026-1502" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1026-1503"><a href="aplikace3.html#cb1026-1503" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1026-1504"><a href="aplikace3.html#cb1026-1504" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1026-1505"><a href="aplikace3.html#cb1026-1505" tabindex="-1"></a>  </span>
<span id="cb1026-1506"><a href="aplikace3.html#cb1026-1506" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb1026-1507"><a href="aplikace3.html#cb1026-1507" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1026-1508"><a href="aplikace3.html#cb1026-1508" tabindex="-1"></a>  </span>
<span id="cb1026-1509"><a href="aplikace3.html#cb1026-1509" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1510"><a href="aplikace3.html#cb1026-1510" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1511"><a href="aplikace3.html#cb1026-1511" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1026-1512"><a href="aplikace3.html#cb1026-1512" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1026-1513"><a href="aplikace3.html#cb1026-1513" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1514"><a href="aplikace3.html#cb1026-1514" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb1026-1515"><a href="aplikace3.html#cb1026-1515" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb1026-1516"><a href="aplikace3.html#cb1026-1516" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb1026-1517"><a href="aplikace3.html#cb1026-1517" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1026-1518"><a href="aplikace3.html#cb1026-1518" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1519"><a href="aplikace3.html#cb1026-1519" tabindex="-1"></a>  </span>
<span id="cb1026-1520"><a href="aplikace3.html#cb1026-1520" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1521"><a href="aplikace3.html#cb1026-1521" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1522"><a href="aplikace3.html#cb1026-1522" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1026-1523"><a href="aplikace3.html#cb1026-1523" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb1026-1524"><a href="aplikace3.html#cb1026-1524" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb1026-1525"><a href="aplikace3.html#cb1026-1525" tabindex="-1"></a>    </span>
<span id="cb1026-1526"><a href="aplikace3.html#cb1026-1526" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1026-1527"><a href="aplikace3.html#cb1026-1527" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-1528"><a href="aplikace3.html#cb1026-1528" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-1529"><a href="aplikace3.html#cb1026-1529" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-1530"><a href="aplikace3.html#cb1026-1530" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1026-1531"><a href="aplikace3.html#cb1026-1531" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1026-1532"><a href="aplikace3.html#cb1026-1532" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1026-1533"><a href="aplikace3.html#cb1026-1533" tabindex="-1"></a>    </span>
<span id="cb1026-1534"><a href="aplikace3.html#cb1026-1534" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1026-1535"><a href="aplikace3.html#cb1026-1535" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1536"><a href="aplikace3.html#cb1026-1536" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-1537"><a href="aplikace3.html#cb1026-1537" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-1538"><a href="aplikace3.html#cb1026-1538" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-1539"><a href="aplikace3.html#cb1026-1539" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb1026-1540"><a href="aplikace3.html#cb1026-1540" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-1541"><a href="aplikace3.html#cb1026-1541" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,</span>
<span id="cb1026-1542"><a href="aplikace3.html#cb1026-1542" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1026-1543"><a href="aplikace3.html#cb1026-1543" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb1026-1544"><a href="aplikace3.html#cb1026-1544" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1026-1545"><a href="aplikace3.html#cb1026-1545" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1026-1546"><a href="aplikace3.html#cb1026-1546" tabindex="-1"></a>    }</span>
<span id="cb1026-1547"><a href="aplikace3.html#cb1026-1547" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1026-1548"><a href="aplikace3.html#cb1026-1548" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1026-1549"><a href="aplikace3.html#cb1026-1549" tabindex="-1"></a>    </span>
<span id="cb1026-1550"><a href="aplikace3.html#cb1026-1550" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1026-1551"><a href="aplikace3.html#cb1026-1551" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-1552"><a href="aplikace3.html#cb1026-1552" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-1553"><a href="aplikace3.html#cb1026-1553" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1026-1554"><a href="aplikace3.html#cb1026-1554" tabindex="-1"></a>    </span>
<span id="cb1026-1555"><a href="aplikace3.html#cb1026-1555" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-1556"><a href="aplikace3.html#cb1026-1556" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1557"><a href="aplikace3.html#cb1026-1557" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-1558"><a href="aplikace3.html#cb1026-1558" tabindex="-1"></a>    }</span>
<span id="cb1026-1559"><a href="aplikace3.html#cb1026-1559" tabindex="-1"></a>    </span>
<span id="cb1026-1560"><a href="aplikace3.html#cb1026-1560" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1026-1561"><a href="aplikace3.html#cb1026-1561" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1026-1562"><a href="aplikace3.html#cb1026-1562" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1026-1563"><a href="aplikace3.html#cb1026-1563" tabindex="-1"></a>  </span>
<span id="cb1026-1564"><a href="aplikace3.html#cb1026-1564" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1565"><a href="aplikace3.html#cb1026-1565" tabindex="-1"></a>  </span>
<span id="cb1026-1566"><a href="aplikace3.html#cb1026-1566" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-1567"><a href="aplikace3.html#cb1026-1567" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1026-1568"><a href="aplikace3.html#cb1026-1568" tabindex="-1"></a>    </span>
<span id="cb1026-1569"><a href="aplikace3.html#cb1026-1569" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-1570"><a href="aplikace3.html#cb1026-1570" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-1571"><a href="aplikace3.html#cb1026-1571" tabindex="-1"></a>    </span>
<span id="cb1026-1572"><a href="aplikace3.html#cb1026-1572" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1573"><a href="aplikace3.html#cb1026-1573" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-1574"><a href="aplikace3.html#cb1026-1574" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1575"><a href="aplikace3.html#cb1026-1575" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1576"><a href="aplikace3.html#cb1026-1576" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1026-1577"><a href="aplikace3.html#cb1026-1577" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1578"><a href="aplikace3.html#cb1026-1578" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1579"><a href="aplikace3.html#cb1026-1579" tabindex="-1"></a>    </span>
<span id="cb1026-1580"><a href="aplikace3.html#cb1026-1580" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1581"><a href="aplikace3.html#cb1026-1581" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1026-1582"><a href="aplikace3.html#cb1026-1582" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-1583"><a href="aplikace3.html#cb1026-1583" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1584"><a href="aplikace3.html#cb1026-1584" tabindex="-1"></a>      </span>
<span id="cb1026-1585"><a href="aplikace3.html#cb1026-1585" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-1586"><a href="aplikace3.html#cb1026-1586" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-1587"><a href="aplikace3.html#cb1026-1587" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1588"><a href="aplikace3.html#cb1026-1588" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1589"><a href="aplikace3.html#cb1026-1589" tabindex="-1"></a>    </span>
<span id="cb1026-1590"><a href="aplikace3.html#cb1026-1590" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1591"><a href="aplikace3.html#cb1026-1591" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1026-1592"><a href="aplikace3.html#cb1026-1592" tabindex="-1"></a>  }</span>
<span id="cb1026-1593"><a href="aplikace3.html#cb1026-1593" tabindex="-1"></a>  </span>
<span id="cb1026-1594"><a href="aplikace3.html#cb1026-1594" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-1595"><a href="aplikace3.html#cb1026-1595" tabindex="-1"></a></span>
<span id="cb1026-1596"><a href="aplikace3.html#cb1026-1596" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb1026-1597"><a href="aplikace3.html#cb1026-1597" tabindex="-1"></a>  </span>
<span id="cb1026-1598"><a href="aplikace3.html#cb1026-1598" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb1026-1599"><a href="aplikace3.html#cb1026-1599" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb1026-1600"><a href="aplikace3.html#cb1026-1600" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb1026-1601"><a href="aplikace3.html#cb1026-1601" tabindex="-1"></a>  }</span>
<span id="cb1026-1602"><a href="aplikace3.html#cb1026-1602" tabindex="-1"></a>  </span>
<span id="cb1026-1603"><a href="aplikace3.html#cb1026-1603" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb1026-1604"><a href="aplikace3.html#cb1026-1604" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1026-1605"><a href="aplikace3.html#cb1026-1605" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1026-1606"><a href="aplikace3.html#cb1026-1606" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1026-1607"><a href="aplikace3.html#cb1026-1607" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb1026-1608"><a href="aplikace3.html#cb1026-1608" tabindex="-1"></a>      }</span>
<span id="cb1026-1609"><a href="aplikace3.html#cb1026-1609" tabindex="-1"></a>    }</span>
<span id="cb1026-1610"><a href="aplikace3.html#cb1026-1610" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1026-1611"><a href="aplikace3.html#cb1026-1611" tabindex="-1"></a>  }</span>
<span id="cb1026-1612"><a href="aplikace3.html#cb1026-1612" tabindex="-1"></a>  </span>
<span id="cb1026-1613"><a href="aplikace3.html#cb1026-1613" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-1614"><a href="aplikace3.html#cb1026-1614" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-1615"><a href="aplikace3.html#cb1026-1615" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1616"><a href="aplikace3.html#cb1026-1616" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1617"><a href="aplikace3.html#cb1026-1617" tabindex="-1"></a>  </span>
<span id="cb1026-1618"><a href="aplikace3.html#cb1026-1618" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1026-1619"><a href="aplikace3.html#cb1026-1619" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">2</span>, <span class="dv">10</span>, <span class="at">by =</span> <span class="dv">1</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1026-1620"><a href="aplikace3.html#cb1026-1620" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb1026-1621"><a href="aplikace3.html#cb1026-1621" tabindex="-1"></a>  </span>
<span id="cb1026-1622"><a href="aplikace3.html#cb1026-1622" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-1623"><a href="aplikace3.html#cb1026-1623" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-1624"><a href="aplikace3.html#cb1026-1624" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb1026-1625"><a href="aplikace3.html#cb1026-1625" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb1026-1626"><a href="aplikace3.html#cb1026-1626" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb1026-1627"><a href="aplikace3.html#cb1026-1627" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1026-1628"><a href="aplikace3.html#cb1026-1628" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1026-1629"><a href="aplikace3.html#cb1026-1629" tabindex="-1"></a>  </span>
<span id="cb1026-1630"><a href="aplikace3.html#cb1026-1630" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-1631"><a href="aplikace3.html#cb1026-1631" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1632"><a href="aplikace3.html#cb1026-1632" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1633"><a href="aplikace3.html#cb1026-1633" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1634"><a href="aplikace3.html#cb1026-1634" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1635"><a href="aplikace3.html#cb1026-1635" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1636"><a href="aplikace3.html#cb1026-1636" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1026-1637"><a href="aplikace3.html#cb1026-1637" tabindex="-1"></a>  </span>
<span id="cb1026-1638"><a href="aplikace3.html#cb1026-1638" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1026-1639"><a href="aplikace3.html#cb1026-1639" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb1026-1640"><a href="aplikace3.html#cb1026-1640" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb1026-1641"><a href="aplikace3.html#cb1026-1641" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-1642"><a href="aplikace3.html#cb1026-1642" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-1643"><a href="aplikace3.html#cb1026-1643" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-1644"><a href="aplikace3.html#cb1026-1644" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1026-1645"><a href="aplikace3.html#cb1026-1645" tabindex="-1"></a>    </span>
<span id="cb1026-1646"><a href="aplikace3.html#cb1026-1646" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1026-1647"><a href="aplikace3.html#cb1026-1647" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1648"><a href="aplikace3.html#cb1026-1648" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-1649"><a href="aplikace3.html#cb1026-1649" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-1650"><a href="aplikace3.html#cb1026-1650" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-1651"><a href="aplikace3.html#cb1026-1651" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1026-1652"><a href="aplikace3.html#cb1026-1652" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-1653"><a href="aplikace3.html#cb1026-1653" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1026-1654"><a href="aplikace3.html#cb1026-1654" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1655"><a href="aplikace3.html#cb1026-1655" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1656"><a href="aplikace3.html#cb1026-1656" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1026-1657"><a href="aplikace3.html#cb1026-1657" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb1026-1658"><a href="aplikace3.html#cb1026-1658" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1026-1659"><a href="aplikace3.html#cb1026-1659" tabindex="-1"></a>    }</span>
<span id="cb1026-1660"><a href="aplikace3.html#cb1026-1660" tabindex="-1"></a>    </span>
<span id="cb1026-1661"><a href="aplikace3.html#cb1026-1661" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb1026-1662"><a href="aplikace3.html#cb1026-1662" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1026-1663"><a href="aplikace3.html#cb1026-1663" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-1664"><a href="aplikace3.html#cb1026-1664" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-1665"><a href="aplikace3.html#cb1026-1665" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1026-1666"><a href="aplikace3.html#cb1026-1666" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-1667"><a href="aplikace3.html#cb1026-1667" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1668"><a href="aplikace3.html#cb1026-1668" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1026-1669"><a href="aplikace3.html#cb1026-1669" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-1670"><a href="aplikace3.html#cb1026-1670" tabindex="-1"></a>      }</span>
<span id="cb1026-1671"><a href="aplikace3.html#cb1026-1671" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb1026-1672"><a href="aplikace3.html#cb1026-1672" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-1673"><a href="aplikace3.html#cb1026-1673" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-1674"><a href="aplikace3.html#cb1026-1674" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-1675"><a href="aplikace3.html#cb1026-1675" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1026-1676"><a href="aplikace3.html#cb1026-1676" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1026-1677"><a href="aplikace3.html#cb1026-1677" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1026-1678"><a href="aplikace3.html#cb1026-1678" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1679"><a href="aplikace3.html#cb1026-1679" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1026-1680"><a href="aplikace3.html#cb1026-1680" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1026-1681"><a href="aplikace3.html#cb1026-1681" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1026-1682"><a href="aplikace3.html#cb1026-1682" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1683"><a href="aplikace3.html#cb1026-1683" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1684"><a href="aplikace3.html#cb1026-1684" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1685"><a href="aplikace3.html#cb1026-1685" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1686"><a href="aplikace3.html#cb1026-1686" tabindex="-1"></a>        </span>
<span id="cb1026-1687"><a href="aplikace3.html#cb1026-1687" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-1688"><a href="aplikace3.html#cb1026-1688" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1026-1689"><a href="aplikace3.html#cb1026-1689" tabindex="-1"></a>          </span>
<span id="cb1026-1690"><a href="aplikace3.html#cb1026-1690" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-1691"><a href="aplikace3.html#cb1026-1691" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1026-1692"><a href="aplikace3.html#cb1026-1692" tabindex="-1"></a>          </span>
<span id="cb1026-1693"><a href="aplikace3.html#cb1026-1693" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1694"><a href="aplikace3.html#cb1026-1694" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-1695"><a href="aplikace3.html#cb1026-1695" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1696"><a href="aplikace3.html#cb1026-1696" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1697"><a href="aplikace3.html#cb1026-1697" tabindex="-1"></a>                              <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1026-1698"><a href="aplikace3.html#cb1026-1698" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1699"><a href="aplikace3.html#cb1026-1699" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1700"><a href="aplikace3.html#cb1026-1700" tabindex="-1"></a>                              <span class="at">cost =</span> C,</span>
<span id="cb1026-1701"><a href="aplikace3.html#cb1026-1701" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1702"><a href="aplikace3.html#cb1026-1702" tabindex="-1"></a>          </span>
<span id="cb1026-1703"><a href="aplikace3.html#cb1026-1703" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1704"><a href="aplikace3.html#cb1026-1704" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-1705"><a href="aplikace3.html#cb1026-1705" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1706"><a href="aplikace3.html#cb1026-1706" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1707"><a href="aplikace3.html#cb1026-1707" tabindex="-1"></a>          </span>
<span id="cb1026-1708"><a href="aplikace3.html#cb1026-1708" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1709"><a href="aplikace3.html#cb1026-1709" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1026-1710"><a href="aplikace3.html#cb1026-1710" tabindex="-1"></a>        }</span>
<span id="cb1026-1711"><a href="aplikace3.html#cb1026-1711" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1026-1712"><a href="aplikace3.html#cb1026-1712" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1026-1713"><a href="aplikace3.html#cb1026-1713" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1714"><a href="aplikace3.html#cb1026-1714" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1715"><a href="aplikace3.html#cb1026-1715" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1026-1716"><a href="aplikace3.html#cb1026-1716" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1717"><a href="aplikace3.html#cb1026-1717" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1718"><a href="aplikace3.html#cb1026-1718" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb1026-1719"><a href="aplikace3.html#cb1026-1719" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1720"><a href="aplikace3.html#cb1026-1720" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1721"><a href="aplikace3.html#cb1026-1721" tabindex="-1"></a>      }</span>
<span id="cb1026-1722"><a href="aplikace3.html#cb1026-1722" tabindex="-1"></a>    }</span>
<span id="cb1026-1723"><a href="aplikace3.html#cb1026-1723" tabindex="-1"></a>  }</span>
<span id="cb1026-1724"><a href="aplikace3.html#cb1026-1724" tabindex="-1"></a>  </span>
<span id="cb1026-1725"><a href="aplikace3.html#cb1026-1725" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1026-1726"><a href="aplikace3.html#cb1026-1726" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1026-1727"><a href="aplikace3.html#cb1026-1727" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb1026-1728"><a href="aplikace3.html#cb1026-1728" tabindex="-1"></a>  }</span>
<span id="cb1026-1729"><a href="aplikace3.html#cb1026-1729" tabindex="-1"></a>  </span>
<span id="cb1026-1730"><a href="aplikace3.html#cb1026-1730" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb1026-1731"><a href="aplikace3.html#cb1026-1731" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb1026-1732"><a href="aplikace3.html#cb1026-1732" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb1026-1733"><a href="aplikace3.html#cb1026-1733" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb1026-1734"><a href="aplikace3.html#cb1026-1734" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb1026-1735"><a href="aplikace3.html#cb1026-1735" tabindex="-1"></a>  </span>
<span id="cb1026-1736"><a href="aplikace3.html#cb1026-1736" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1737"><a href="aplikace3.html#cb1026-1737" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1738"><a href="aplikace3.html#cb1026-1738" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1026-1739"><a href="aplikace3.html#cb1026-1739" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1026-1740"><a href="aplikace3.html#cb1026-1740" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1026-1741"><a href="aplikace3.html#cb1026-1741" tabindex="-1"></a>  </span>
<span id="cb1026-1742"><a href="aplikace3.html#cb1026-1742" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-1743"><a href="aplikace3.html#cb1026-1743" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-1744"><a href="aplikace3.html#cb1026-1744" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-1745"><a href="aplikace3.html#cb1026-1745" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1026-1746"><a href="aplikace3.html#cb1026-1746" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1026-1747"><a href="aplikace3.html#cb1026-1747" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1026-1748"><a href="aplikace3.html#cb1026-1748" tabindex="-1"></a>  </span>
<span id="cb1026-1749"><a href="aplikace3.html#cb1026-1749" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb1026-1750"><a href="aplikace3.html#cb1026-1750" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1026-1751"><a href="aplikace3.html#cb1026-1751" tabindex="-1"></a>  </span>
<span id="cb1026-1752"><a href="aplikace3.html#cb1026-1752" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1753"><a href="aplikace3.html#cb1026-1753" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1754"><a href="aplikace3.html#cb1026-1754" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1026-1755"><a href="aplikace3.html#cb1026-1755" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1026-1756"><a href="aplikace3.html#cb1026-1756" tabindex="-1"></a>  </span>
<span id="cb1026-1757"><a href="aplikace3.html#cb1026-1757" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1758"><a href="aplikace3.html#cb1026-1758" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb1026-1759"><a href="aplikace3.html#cb1026-1759" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb1026-1760"><a href="aplikace3.html#cb1026-1760" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb1026-1761"><a href="aplikace3.html#cb1026-1761" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1026-1762"><a href="aplikace3.html#cb1026-1762" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1763"><a href="aplikace3.html#cb1026-1763" tabindex="-1"></a>  </span>
<span id="cb1026-1764"><a href="aplikace3.html#cb1026-1764" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1765"><a href="aplikace3.html#cb1026-1765" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1766"><a href="aplikace3.html#cb1026-1766" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1026-1767"><a href="aplikace3.html#cb1026-1767" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb1026-1768"><a href="aplikace3.html#cb1026-1768" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb1026-1769"><a href="aplikace3.html#cb1026-1769" tabindex="-1"></a>    </span>
<span id="cb1026-1770"><a href="aplikace3.html#cb1026-1770" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1026-1771"><a href="aplikace3.html#cb1026-1771" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-1772"><a href="aplikace3.html#cb1026-1772" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-1773"><a href="aplikace3.html#cb1026-1773" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-1774"><a href="aplikace3.html#cb1026-1774" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1026-1775"><a href="aplikace3.html#cb1026-1775" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1026-1776"><a href="aplikace3.html#cb1026-1776" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1026-1777"><a href="aplikace3.html#cb1026-1777" tabindex="-1"></a>    </span>
<span id="cb1026-1778"><a href="aplikace3.html#cb1026-1778" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1026-1779"><a href="aplikace3.html#cb1026-1779" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1780"><a href="aplikace3.html#cb1026-1780" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-1781"><a href="aplikace3.html#cb1026-1781" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-1782"><a href="aplikace3.html#cb1026-1782" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-1783"><a href="aplikace3.html#cb1026-1783" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb1026-1784"><a href="aplikace3.html#cb1026-1784" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-1785"><a href="aplikace3.html#cb1026-1785" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1026-1786"><a href="aplikace3.html#cb1026-1786" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1787"><a href="aplikace3.html#cb1026-1787" tabindex="-1"></a>                      <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1788"><a href="aplikace3.html#cb1026-1788" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1026-1789"><a href="aplikace3.html#cb1026-1789" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb1026-1790"><a href="aplikace3.html#cb1026-1790" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1026-1791"><a href="aplikace3.html#cb1026-1791" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1026-1792"><a href="aplikace3.html#cb1026-1792" tabindex="-1"></a>    }</span>
<span id="cb1026-1793"><a href="aplikace3.html#cb1026-1793" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1026-1794"><a href="aplikace3.html#cb1026-1794" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1026-1795"><a href="aplikace3.html#cb1026-1795" tabindex="-1"></a>    </span>
<span id="cb1026-1796"><a href="aplikace3.html#cb1026-1796" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1026-1797"><a href="aplikace3.html#cb1026-1797" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-1798"><a href="aplikace3.html#cb1026-1798" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-1799"><a href="aplikace3.html#cb1026-1799" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1026-1800"><a href="aplikace3.html#cb1026-1800" tabindex="-1"></a>    </span>
<span id="cb1026-1801"><a href="aplikace3.html#cb1026-1801" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-1802"><a href="aplikace3.html#cb1026-1802" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1803"><a href="aplikace3.html#cb1026-1803" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-1804"><a href="aplikace3.html#cb1026-1804" tabindex="-1"></a>    }</span>
<span id="cb1026-1805"><a href="aplikace3.html#cb1026-1805" tabindex="-1"></a>    </span>
<span id="cb1026-1806"><a href="aplikace3.html#cb1026-1806" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1026-1807"><a href="aplikace3.html#cb1026-1807" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1026-1808"><a href="aplikace3.html#cb1026-1808" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1026-1809"><a href="aplikace3.html#cb1026-1809" tabindex="-1"></a>  </span>
<span id="cb1026-1810"><a href="aplikace3.html#cb1026-1810" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1811"><a href="aplikace3.html#cb1026-1811" tabindex="-1"></a>  </span>
<span id="cb1026-1812"><a href="aplikace3.html#cb1026-1812" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-1813"><a href="aplikace3.html#cb1026-1813" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1026-1814"><a href="aplikace3.html#cb1026-1814" tabindex="-1"></a>    </span>
<span id="cb1026-1815"><a href="aplikace3.html#cb1026-1815" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-1816"><a href="aplikace3.html#cb1026-1816" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-1817"><a href="aplikace3.html#cb1026-1817" tabindex="-1"></a>    </span>
<span id="cb1026-1818"><a href="aplikace3.html#cb1026-1818" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1819"><a href="aplikace3.html#cb1026-1819" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-1820"><a href="aplikace3.html#cb1026-1820" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1821"><a href="aplikace3.html#cb1026-1821" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1822"><a href="aplikace3.html#cb1026-1822" tabindex="-1"></a>                        <span class="at">epsilon =</span> eps,                   </span>
<span id="cb1026-1823"><a href="aplikace3.html#cb1026-1823" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1824"><a href="aplikace3.html#cb1026-1824" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="dv">1</span>,</span>
<span id="cb1026-1825"><a href="aplikace3.html#cb1026-1825" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1026-1826"><a href="aplikace3.html#cb1026-1826" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1827"><a href="aplikace3.html#cb1026-1827" tabindex="-1"></a>    </span>
<span id="cb1026-1828"><a href="aplikace3.html#cb1026-1828" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-1829"><a href="aplikace3.html#cb1026-1829" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1026-1830"><a href="aplikace3.html#cb1026-1830" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-1831"><a href="aplikace3.html#cb1026-1831" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1832"><a href="aplikace3.html#cb1026-1832" tabindex="-1"></a>      </span>
<span id="cb1026-1833"><a href="aplikace3.html#cb1026-1833" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-1834"><a href="aplikace3.html#cb1026-1834" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-1835"><a href="aplikace3.html#cb1026-1835" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1836"><a href="aplikace3.html#cb1026-1836" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1837"><a href="aplikace3.html#cb1026-1837" tabindex="-1"></a>    </span>
<span id="cb1026-1838"><a href="aplikace3.html#cb1026-1838" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1839"><a href="aplikace3.html#cb1026-1839" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1026-1840"><a href="aplikace3.html#cb1026-1840" tabindex="-1"></a>  }</span>
<span id="cb1026-1841"><a href="aplikace3.html#cb1026-1841" tabindex="-1"></a>  </span>
<span id="cb1026-1842"><a href="aplikace3.html#cb1026-1842" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-1843"><a href="aplikace3.html#cb1026-1843" tabindex="-1"></a>  </span>
<span id="cb1026-1844"><a href="aplikace3.html#cb1026-1844" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb1026-1845"><a href="aplikace3.html#cb1026-1845" tabindex="-1"></a>  </span>
<span id="cb1026-1846"><a href="aplikace3.html#cb1026-1846" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb1026-1847"><a href="aplikace3.html#cb1026-1847" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb1026-1848"><a href="aplikace3.html#cb1026-1848" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb1026-1849"><a href="aplikace3.html#cb1026-1849" tabindex="-1"></a>  }</span>
<span id="cb1026-1850"><a href="aplikace3.html#cb1026-1850" tabindex="-1"></a>  </span>
<span id="cb1026-1851"><a href="aplikace3.html#cb1026-1851" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb1026-1852"><a href="aplikace3.html#cb1026-1852" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb1026-1853"><a href="aplikace3.html#cb1026-1853" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb1026-1854"><a href="aplikace3.html#cb1026-1854" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb1026-1855"><a href="aplikace3.html#cb1026-1855" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb1026-1856"><a href="aplikace3.html#cb1026-1856" tabindex="-1"></a>      }</span>
<span id="cb1026-1857"><a href="aplikace3.html#cb1026-1857" tabindex="-1"></a>    }</span>
<span id="cb1026-1858"><a href="aplikace3.html#cb1026-1858" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb1026-1859"><a href="aplikace3.html#cb1026-1859" tabindex="-1"></a>  }</span>
<span id="cb1026-1860"><a href="aplikace3.html#cb1026-1860" tabindex="-1"></a>  </span>
<span id="cb1026-1861"><a href="aplikace3.html#cb1026-1861" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb1026-1862"><a href="aplikace3.html#cb1026-1862" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb1026-1863"><a href="aplikace3.html#cb1026-1863" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1864"><a href="aplikace3.html#cb1026-1864" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1865"><a href="aplikace3.html#cb1026-1865" tabindex="-1"></a>  </span>
<span id="cb1026-1866"><a href="aplikace3.html#cb1026-1866" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb1026-1867"><a href="aplikace3.html#cb1026-1867" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb1026-1868"><a href="aplikace3.html#cb1026-1868" tabindex="-1"></a>  </span>
<span id="cb1026-1869"><a href="aplikace3.html#cb1026-1869" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb1026-1870"><a href="aplikace3.html#cb1026-1870" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb1026-1871"><a href="aplikace3.html#cb1026-1871" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb1026-1872"><a href="aplikace3.html#cb1026-1872" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb1026-1873"><a href="aplikace3.html#cb1026-1873" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb1026-1874"><a href="aplikace3.html#cb1026-1874" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb1026-1875"><a href="aplikace3.html#cb1026-1875" tabindex="-1"></a>  </span>
<span id="cb1026-1876"><a href="aplikace3.html#cb1026-1876" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb1026-1877"><a href="aplikace3.html#cb1026-1877" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1878"><a href="aplikace3.html#cb1026-1878" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1879"><a href="aplikace3.html#cb1026-1879" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1880"><a href="aplikace3.html#cb1026-1880" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb1026-1881"><a href="aplikace3.html#cb1026-1881" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb1026-1882"><a href="aplikace3.html#cb1026-1882" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb1026-1883"><a href="aplikace3.html#cb1026-1883" tabindex="-1"></a>  </span>
<span id="cb1026-1884"><a href="aplikace3.html#cb1026-1884" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb1026-1885"><a href="aplikace3.html#cb1026-1885" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb1026-1886"><a href="aplikace3.html#cb1026-1886" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-1887"><a href="aplikace3.html#cb1026-1887" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-1888"><a href="aplikace3.html#cb1026-1888" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-1889"><a href="aplikace3.html#cb1026-1889" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb1026-1890"><a href="aplikace3.html#cb1026-1890" tabindex="-1"></a>  </span>
<span id="cb1026-1891"><a href="aplikace3.html#cb1026-1891" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb1026-1892"><a href="aplikace3.html#cb1026-1892" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1893"><a href="aplikace3.html#cb1026-1893" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-1894"><a href="aplikace3.html#cb1026-1894" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-1895"><a href="aplikace3.html#cb1026-1895" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-1896"><a href="aplikace3.html#cb1026-1896" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1026-1897"><a href="aplikace3.html#cb1026-1897" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-1898"><a href="aplikace3.html#cb1026-1898" tabindex="-1"></a>                    <span class="at">cost =</span> C,</span>
<span id="cb1026-1899"><a href="aplikace3.html#cb1026-1899" tabindex="-1"></a>                    <span class="at">epsilon =</span> eps)</span>
<span id="cb1026-1900"><a href="aplikace3.html#cb1026-1900" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb1026-1901"><a href="aplikace3.html#cb1026-1901" tabindex="-1"></a>  }</span>
<span id="cb1026-1902"><a href="aplikace3.html#cb1026-1902" tabindex="-1"></a>  </span>
<span id="cb1026-1903"><a href="aplikace3.html#cb1026-1903" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb1026-1904"><a href="aplikace3.html#cb1026-1904" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb1026-1905"><a href="aplikace3.html#cb1026-1905" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-1906"><a href="aplikace3.html#cb1026-1906" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-1907"><a href="aplikace3.html#cb1026-1907" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb1026-1908"><a href="aplikace3.html#cb1026-1908" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-1909"><a href="aplikace3.html#cb1026-1909" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-1910"><a href="aplikace3.html#cb1026-1910" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb1026-1911"><a href="aplikace3.html#cb1026-1911" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-1912"><a href="aplikace3.html#cb1026-1912" tabindex="-1"></a>    }</span>
<span id="cb1026-1913"><a href="aplikace3.html#cb1026-1913" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb1026-1914"><a href="aplikace3.html#cb1026-1914" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb1026-1915"><a href="aplikace3.html#cb1026-1915" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb1026-1916"><a href="aplikace3.html#cb1026-1916" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb1026-1917"><a href="aplikace3.html#cb1026-1917" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb1026-1918"><a href="aplikace3.html#cb1026-1918" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb1026-1919"><a href="aplikace3.html#cb1026-1919" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb1026-1920"><a href="aplikace3.html#cb1026-1920" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1921"><a href="aplikace3.html#cb1026-1921" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb1026-1922"><a href="aplikace3.html#cb1026-1922" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb1026-1923"><a href="aplikace3.html#cb1026-1923" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb1026-1924"><a href="aplikace3.html#cb1026-1924" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1925"><a href="aplikace3.html#cb1026-1925" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1926"><a href="aplikace3.html#cb1026-1926" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1927"><a href="aplikace3.html#cb1026-1927" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-1928"><a href="aplikace3.html#cb1026-1928" tabindex="-1"></a>      </span>
<span id="cb1026-1929"><a href="aplikace3.html#cb1026-1929" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-1930"><a href="aplikace3.html#cb1026-1930" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb1026-1931"><a href="aplikace3.html#cb1026-1931" tabindex="-1"></a>        </span>
<span id="cb1026-1932"><a href="aplikace3.html#cb1026-1932" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-1933"><a href="aplikace3.html#cb1026-1933" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb1026-1934"><a href="aplikace3.html#cb1026-1934" tabindex="-1"></a>        </span>
<span id="cb1026-1935"><a href="aplikace3.html#cb1026-1935" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-1936"><a href="aplikace3.html#cb1026-1936" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-1937"><a href="aplikace3.html#cb1026-1937" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-1938"><a href="aplikace3.html#cb1026-1938" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-1939"><a href="aplikace3.html#cb1026-1939" tabindex="-1"></a>                            <span class="at">cost =</span> C,</span>
<span id="cb1026-1940"><a href="aplikace3.html#cb1026-1940" tabindex="-1"></a>                            <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-1941"><a href="aplikace3.html#cb1026-1941" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-1942"><a href="aplikace3.html#cb1026-1942" tabindex="-1"></a>        </span>
<span id="cb1026-1943"><a href="aplikace3.html#cb1026-1943" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb1026-1944"><a href="aplikace3.html#cb1026-1944" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-1945"><a href="aplikace3.html#cb1026-1945" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-1946"><a href="aplikace3.html#cb1026-1946" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-1947"><a href="aplikace3.html#cb1026-1947" tabindex="-1"></a>        </span>
<span id="cb1026-1948"><a href="aplikace3.html#cb1026-1948" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-1949"><a href="aplikace3.html#cb1026-1949" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb1026-1950"><a href="aplikace3.html#cb1026-1950" tabindex="-1"></a>      }</span>
<span id="cb1026-1951"><a href="aplikace3.html#cb1026-1951" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb1026-1952"><a href="aplikace3.html#cb1026-1952" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1953"><a href="aplikace3.html#cb1026-1953" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1954"><a href="aplikace3.html#cb1026-1954" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1955"><a href="aplikace3.html#cb1026-1955" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1956"><a href="aplikace3.html#cb1026-1956" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb1026-1957"><a href="aplikace3.html#cb1026-1957" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb1026-1958"><a href="aplikace3.html#cb1026-1958" tabindex="-1"></a>    }</span>
<span id="cb1026-1959"><a href="aplikace3.html#cb1026-1959" tabindex="-1"></a>  }</span>
<span id="cb1026-1960"><a href="aplikace3.html#cb1026-1960" tabindex="-1"></a>  </span>
<span id="cb1026-1961"><a href="aplikace3.html#cb1026-1961" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb1026-1962"><a href="aplikace3.html#cb1026-1962" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb1026-1963"><a href="aplikace3.html#cb1026-1963" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb1026-1964"><a href="aplikace3.html#cb1026-1964" tabindex="-1"></a>  }</span>
<span id="cb1026-1965"><a href="aplikace3.html#cb1026-1965" tabindex="-1"></a>  </span>
<span id="cb1026-1966"><a href="aplikace3.html#cb1026-1966" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1967"><a href="aplikace3.html#cb1026-1967" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb1026-1968"><a href="aplikace3.html#cb1026-1968" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb1026-1969"><a href="aplikace3.html#cb1026-1969" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb1026-1970"><a href="aplikace3.html#cb1026-1970" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb1026-1971"><a href="aplikace3.html#cb1026-1971" tabindex="-1"></a>  </span>
<span id="cb1026-1972"><a href="aplikace3.html#cb1026-1972" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb1026-1973"><a href="aplikace3.html#cb1026-1973" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb1026-1974"><a href="aplikace3.html#cb1026-1974" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb1026-1975"><a href="aplikace3.html#cb1026-1975" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb1026-1976"><a href="aplikace3.html#cb1026-1976" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb1026-1977"><a href="aplikace3.html#cb1026-1977" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb1026-1978"><a href="aplikace3.html#cb1026-1978" tabindex="-1"></a>  </span>
<span id="cb1026-1979"><a href="aplikace3.html#cb1026-1979" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb1026-1980"><a href="aplikace3.html#cb1026-1980" tabindex="-1"></a>  </span>
<span id="cb1026-1981"><a href="aplikace3.html#cb1026-1981" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb1026-1982"><a href="aplikace3.html#cb1026-1982" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb1026-1983"><a href="aplikace3.html#cb1026-1983" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb1026-1984"><a href="aplikace3.html#cb1026-1984" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb1026-1985"><a href="aplikace3.html#cb1026-1985" tabindex="-1"></a>  </span>
<span id="cb1026-1986"><a href="aplikace3.html#cb1026-1986" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb1026-1987"><a href="aplikace3.html#cb1026-1987" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb1026-1988"><a href="aplikace3.html#cb1026-1988" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb1026-1989"><a href="aplikace3.html#cb1026-1989" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb1026-1990"><a href="aplikace3.html#cb1026-1990" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb1026-1991"><a href="aplikace3.html#cb1026-1991" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb1026-1992"><a href="aplikace3.html#cb1026-1992" tabindex="-1"></a>  </span>
<span id="cb1026-1993"><a href="aplikace3.html#cb1026-1993" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb1026-1994"><a href="aplikace3.html#cb1026-1994" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb1026-1995"><a href="aplikace3.html#cb1026-1995" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb1026-1996"><a href="aplikace3.html#cb1026-1996" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb1026-1997"><a href="aplikace3.html#cb1026-1997" tabindex="-1"></a>    </span>
<span id="cb1026-1998"><a href="aplikace3.html#cb1026-1998" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb1026-1999"><a href="aplikace3.html#cb1026-1999" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb1026-2000"><a href="aplikace3.html#cb1026-2000" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb1026-2001"><a href="aplikace3.html#cb1026-2001" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb1026-2002"><a href="aplikace3.html#cb1026-2002" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb1026-2003"><a href="aplikace3.html#cb1026-2003" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb1026-2004"><a href="aplikace3.html#cb1026-2004" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb1026-2005"><a href="aplikace3.html#cb1026-2005" tabindex="-1"></a>    </span>
<span id="cb1026-2006"><a href="aplikace3.html#cb1026-2006" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb1026-2007"><a href="aplikace3.html#cb1026-2007" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-2008"><a href="aplikace3.html#cb1026-2008" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb1026-2009"><a href="aplikace3.html#cb1026-2009" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb1026-2010"><a href="aplikace3.html#cb1026-2010" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb1026-2011"><a href="aplikace3.html#cb1026-2011" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb1026-2012"><a href="aplikace3.html#cb1026-2012" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb1026-2013"><a href="aplikace3.html#cb1026-2013" tabindex="-1"></a>                      <span class="at">cost =</span> C,</span>
<span id="cb1026-2014"><a href="aplikace3.html#cb1026-2014" tabindex="-1"></a>                      <span class="at">epsilon =</span> eps)</span>
<span id="cb1026-2015"><a href="aplikace3.html#cb1026-2015" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb1026-2016"><a href="aplikace3.html#cb1026-2016" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb1026-2017"><a href="aplikace3.html#cb1026-2017" tabindex="-1"></a>    }</span>
<span id="cb1026-2018"><a href="aplikace3.html#cb1026-2018" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb1026-2019"><a href="aplikace3.html#cb1026-2019" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb1026-2020"><a href="aplikace3.html#cb1026-2020" tabindex="-1"></a>    </span>
<span id="cb1026-2021"><a href="aplikace3.html#cb1026-2021" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb1026-2022"><a href="aplikace3.html#cb1026-2022" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb1026-2023"><a href="aplikace3.html#cb1026-2023" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb1026-2024"><a href="aplikace3.html#cb1026-2024" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb1026-2025"><a href="aplikace3.html#cb1026-2025" tabindex="-1"></a>    </span>
<span id="cb1026-2026"><a href="aplikace3.html#cb1026-2026" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb1026-2027"><a href="aplikace3.html#cb1026-2027" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb1026-2028"><a href="aplikace3.html#cb1026-2028" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb1026-2029"><a href="aplikace3.html#cb1026-2029" tabindex="-1"></a>    }</span>
<span id="cb1026-2030"><a href="aplikace3.html#cb1026-2030" tabindex="-1"></a>    </span>
<span id="cb1026-2031"><a href="aplikace3.html#cb1026-2031" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb1026-2032"><a href="aplikace3.html#cb1026-2032" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb1026-2033"><a href="aplikace3.html#cb1026-2033" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb1026-2034"><a href="aplikace3.html#cb1026-2034" tabindex="-1"></a>  </span>
<span id="cb1026-2035"><a href="aplikace3.html#cb1026-2035" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb1026-2036"><a href="aplikace3.html#cb1026-2036" tabindex="-1"></a>  </span>
<span id="cb1026-2037"><a href="aplikace3.html#cb1026-2037" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb1026-2038"><a href="aplikace3.html#cb1026-2038" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb1026-2039"><a href="aplikace3.html#cb1026-2039" tabindex="-1"></a>    </span>
<span id="cb1026-2040"><a href="aplikace3.html#cb1026-2040" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb1026-2041"><a href="aplikace3.html#cb1026-2041" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb1026-2042"><a href="aplikace3.html#cb1026-2042" tabindex="-1"></a>    </span>
<span id="cb1026-2043"><a href="aplikace3.html#cb1026-2043" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb1026-2044"><a href="aplikace3.html#cb1026-2044" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb1026-2045"><a href="aplikace3.html#cb1026-2045" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb1026-2046"><a href="aplikace3.html#cb1026-2046" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb1026-2047"><a href="aplikace3.html#cb1026-2047" tabindex="-1"></a>                        <span class="at">cost =</span> C,</span>
<span id="cb1026-2048"><a href="aplikace3.html#cb1026-2048" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb1026-2049"><a href="aplikace3.html#cb1026-2049" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb1026-2050"><a href="aplikace3.html#cb1026-2050" tabindex="-1"></a>    </span>
<span id="cb1026-2051"><a href="aplikace3.html#cb1026-2051" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb1026-2052"><a href="aplikace3.html#cb1026-2052" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb1026-2053"><a href="aplikace3.html#cb1026-2053" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb1026-2054"><a href="aplikace3.html#cb1026-2054" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-2055"><a href="aplikace3.html#cb1026-2055" tabindex="-1"></a>      </span>
<span id="cb1026-2056"><a href="aplikace3.html#cb1026-2056" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb1026-2057"><a href="aplikace3.html#cb1026-2057" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb1026-2058"><a href="aplikace3.html#cb1026-2058" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb1026-2059"><a href="aplikace3.html#cb1026-2059" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb1026-2060"><a href="aplikace3.html#cb1026-2060" tabindex="-1"></a>    </span>
<span id="cb1026-2061"><a href="aplikace3.html#cb1026-2061" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb1026-2062"><a href="aplikace3.html#cb1026-2062" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb1026-2063"><a href="aplikace3.html#cb1026-2063" tabindex="-1"></a>  }</span>
<span id="cb1026-2064"><a href="aplikace3.html#cb1026-2064" tabindex="-1"></a>  </span>
<span id="cb1026-2065"><a href="aplikace3.html#cb1026-2065" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb1026-2066"><a href="aplikace3.html#cb1026-2066" tabindex="-1"></a>  </span>
<span id="cb1026-2067"><a href="aplikace3.html#cb1026-2067" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb1026-2068"><a href="aplikace3.html#cb1026-2068" tabindex="-1"></a>  </span>
<span id="cb1026-2069"><a href="aplikace3.html#cb1026-2069" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb1026-2070"><a href="aplikace3.html#cb1026-2070" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb1026-2071"><a href="aplikace3.html#cb1026-2071" tabindex="-1"></a>  </span>
<span id="cb1026-2072"><a href="aplikace3.html#cb1026-2072" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb1026-2073"><a href="aplikace3.html#cb1026-2073" tabindex="-1"></a>}</span>
<span id="cb1026-2074"><a href="aplikace3.html#cb1026-2074" tabindex="-1"></a></span>
<span id="cb1026-2075"><a href="aplikace3.html#cb1026-2075" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb1026-2076"><a href="aplikace3.html#cb1026-2076" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03der.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Now we will calculate the average training and testing errors for the individual classification methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1027"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1027-1"><a href="aplikace3.html#cb1027-1" tabindex="-1"></a><span class="co"># Insert into the final table</span></span>
<span id="cb1027-2"><a href="aplikace3.html#cb1027-2" tabindex="-1"></a></span>
<span id="cb1027-3"><a href="aplikace3.html#cb1027-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb1027-4"><a href="aplikace3.html#cb1027-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb1027-5"><a href="aplikace3.html#cb1027-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb1027-6"><a href="aplikace3.html#cb1027-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb1027-7"><a href="aplikace3.html#cb1027-7" tabindex="-1"></a></span>
<span id="cb1027-8"><a href="aplikace3.html#cb1027-8" tabindex="-1"></a><span class="co"># Save the resulting values </span></span>
<span id="cb1027-9"><a href="aplikace3.html#cb1027-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/aplikace_03der_res.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="results-4" class="section level4 hasAnchor" number="6.5.2.1">
<h4><span class="header-section-number">6.5.2.1</span> Results<a href="aplikace3.html#results-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-267">Table 6.19: </span>Summary of the results of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error, <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error, <span class="math inline">\(\widehat{SD}_{train}\)</span> the estimate of the standard deviation of training errors, and <span class="math inline">\(\widehat{SD}_{test}\)</span> the estimate of the standard deviation of testing errors.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.0153</td>
<td align="right">0.0195</td>
<td align="right">0.0067</td>
<td align="right">0.0176</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.0575</td>
<td align="right">0.0592</td>
<td align="right">0.0107</td>
<td align="right">0.0285</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.0115</td>
<td align="right">0.0160</td>
<td align="right">0.0062</td>
<td align="right">0.0151</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0001</td>
<td align="right">0.0469</td>
<td align="right">0.0007</td>
<td align="right">0.0379</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.0082</td>
<td align="right">0.0166</td>
<td align="right">0.0063</td>
<td align="right">0.0143</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.0109</td>
<td align="right">0.0294</td>
<td align="right">0.0454</td>
<td align="right">0.0608</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.0169</td>
<td align="right">0.0245</td>
<td align="right">0.0065</td>
<td align="right">0.0184</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.0107</td>
<td align="right">0.0288</td>
<td align="right">0.0455</td>
<td align="right">0.0593</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0003</td>
<td align="right">0.0097</td>
<td align="right">0.0015</td>
<td align="right">0.0104</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0053</td>
<td align="right">0.0166</td>
<td align="right">0.0036</td>
<td align="right">0.0159</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0002</td>
<td align="right">0.0085</td>
<td align="right">0.0011</td>
<td align="right">0.0086</td>
</tr>
<tr class="even">
<td>SVM linear - func</td>
<td align="right">0.0011</td>
<td align="right">0.0092</td>
<td align="right">0.0027</td>
<td align="right">0.0116</td>
</tr>
<tr class="odd">
<td>SVM poly - func</td>
<td align="right">0.0019</td>
<td align="right">0.0054</td>
<td align="right">0.0032</td>
<td align="right">0.0110</td>
</tr>
<tr class="even">
<td>SVM rbf - func</td>
<td align="right">0.0009</td>
<td align="right">0.0069</td>
<td align="right">0.0035</td>
<td align="right">0.0110</td>
</tr>
<tr class="odd">
<td>SVM linear - diskr</td>
<td align="right">0.0021</td>
<td align="right">0.0117</td>
<td align="right">0.0046</td>
<td align="right">0.0140</td>
</tr>
<tr class="even">
<td>SVM poly - diskr</td>
<td align="right">0.0007</td>
<td align="right">0.0126</td>
<td align="right">0.0032</td>
<td align="right">0.0157</td>
</tr>
<tr class="odd">
<td>SVM rbf - diskr</td>
<td align="right">0.0012</td>
<td align="right">0.0115</td>
<td align="right">0.0036</td>
<td align="right">0.0139</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.0101</td>
<td align="right">0.0195</td>
<td align="right">0.0065</td>
<td align="right">0.0160</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.0086</td>
<td align="right">0.0231</td>
<td align="right">0.0062</td>
<td align="right">0.0160</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.0067</td>
<td align="right">0.0217</td>
<td align="right">0.0054</td>
<td align="right">0.0196</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0059</td>
<td align="right">0.0254</td>
<td align="right">0.0093</td>
<td align="right">0.0191</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.0023</td>
<td align="right">0.0223</td>
<td align="right">0.0056</td>
<td align="right">0.0195</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0025</td>
<td align="right">0.0232</td>
<td align="right">0.0053</td>
<td align="right">0.0180</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.0309</td>
<td align="right">0.0420</td>
<td align="right">0.0101</td>
<td align="right">0.0251</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0354</td>
<td align="right">0.0577</td>
<td align="right">0.0158</td>
<td align="right">0.0397</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.1415</td>
<td align="right">0.1897</td>
<td align="right">0.0327</td>
<td align="right">0.0537</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0015</td>
<td align="right">0.0223</td>
<td align="right">0.0030</td>
<td align="right">0.0157</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0028</td>
<td align="right">0.0229</td>
<td align="right">0.0037</td>
<td align="right">0.0173</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0039</td>
<td align="right">0.0212</td>
<td align="right">0.0042</td>
<td align="right">0.0157</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0133</td>
<td align="right">0.0442</td>
<td align="right">0.0066</td>
<td align="right">0.0217</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0085</td>
<td align="right">0.0502</td>
<td align="right">0.0106</td>
<td align="right">0.0251</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0125</td>
<td align="right">0.0545</td>
<td align="right">0.0101</td>
<td align="right">0.0223</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.0077</td>
<td align="right">0.0458</td>
<td align="right">0.0100</td>
<td align="right">0.0207</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0049</td>
<td align="right">0.0388</td>
<td align="right">0.0069</td>
<td align="right">0.0242</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.0077</td>
<td align="right">0.0429</td>
<td align="right">0.0085</td>
<td align="right">0.0252</td>
</tr>
</tbody>
</table>
<p>The table above presents all computed characteristics. It also includes standard deviations to compare the stability or variability of the individual methods.</p>
<p>We can also formally test whether some methods are more successful than others. Due to the violation of the normality assumption, we cannot use the classic paired t-test. Instead, we will use its non-parametric alternative - the Wilcoxon test.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1028"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1028-1"><a href="aplikace3.html#cb1028-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_Bbasis&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_discr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.01762011</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1030"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1030-1"><a href="aplikace3.html#cb1030-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;RF_Bbasis&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.01250668</code></pre>
<p>Finally, we can graphically display the computed values from the simulation for individual classification methods using box plots, separately for testing and training errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1032"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1032-1"><a href="aplikace3.html#cb1032-1" tabindex="-1"></a><span class="co"># for training data</span></span>
<span id="cb1032-2"><a href="aplikace3.html#cb1032-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb1032-3"><a href="aplikace3.html#cb1032-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1032-4"><a href="aplikace3.html#cb1032-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1032-5"><a href="aplikace3.html#cb1032-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb1032-6"><a href="aplikace3.html#cb1032-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb1032-7"><a href="aplikace3.html#cb1032-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb1032-8"><a href="aplikace3.html#cb1032-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1032-9"><a href="aplikace3.html#cb1032-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1032-10"><a href="aplikace3.html#cb1032-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb1032-11"><a href="aplikace3.html#cb1032-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb1032-12"><a href="aplikace3.html#cb1032-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb1032-13"><a href="aplikace3.html#cb1032-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1032-14"><a href="aplikace3.html#cb1032-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb1032-15"><a href="aplikace3.html#cb1032-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb1032-16"><a href="aplikace3.html#cb1032-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb1032-17"><a href="aplikace3.html#cb1032-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb1032-18"><a href="aplikace3.html#cb1032-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb1032-19"><a href="aplikace3.html#cb1032-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-269"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-269-1.png" alt="Box plots of training errors for 100 simulations separately for each classification method. The black symbols $+$ denote the means." width="672" />
<p class="caption">
Figure 6.25: Box plots of training errors for 100 simulations separately for each classification method. The black symbols <span class="math inline">\(+\)</span> denote the means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1033"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1033-1"><a href="aplikace3.html#cb1033-1" tabindex="-1"></a><span class="co"># for testing data</span></span>
<span id="cb1033-2"><a href="aplikace3.html#cb1033-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb1033-3"><a href="aplikace3.html#cb1033-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1033-4"><a href="aplikace3.html#cb1033-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1033-5"><a href="aplikace3.html#cb1033-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb1033-6"><a href="aplikace3.html#cb1033-6" tabindex="-1"></a>   <span class="fu">filter</span>(method <span class="sc">%in%</span> sub_methods) <span class="sc">|&gt;</span></span>
<span id="cb1033-7"><a href="aplikace3.html#cb1033-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span></span>
<span id="cb1033-8"><a href="aplikace3.html#cb1033-8" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb1033-9"><a href="aplikace3.html#cb1033-9" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb1033-10"><a href="aplikace3.html#cb1033-10" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb1033-11"><a href="aplikace3.html#cb1033-11" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1033-12"><a href="aplikace3.html#cb1033-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1033-13"><a href="aplikace3.html#cb1033-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb1033-14"><a href="aplikace3.html#cb1033-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">widehat{</span><span class="sc">\\</span><span class="st">textnormal{Err}}_{test}$&quot;</span></span>
<span id="cb1033-15"><a href="aplikace3.html#cb1033-15" tabindex="-1"></a>       <span class="co"># y = expression(widehat(Err)[train])</span></span>
<span id="cb1033-16"><a href="aplikace3.html#cb1033-16" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb1033-17"><a href="aplikace3.html#cb1033-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb1033-18"><a href="aplikace3.html#cb1033-18" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">45</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb1033-19"><a href="aplikace3.html#cb1033-19" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb1033-20"><a href="aplikace3.html#cb1033-20" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb1033-21"><a href="aplikace3.html#cb1033-21" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> methods_names1) <span class="sc">+</span></span>
<span id="cb1033-22"><a href="aplikace3.html#cb1033-22" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb1033-23"><a href="aplikace3.html#cb1033-23" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.15</span>)) <span class="sc">+</span></span>
<span id="cb1033-24"><a href="aplikace3.html#cb1033-24" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> box_col1) <span class="sc">+</span></span>
<span id="cb1033-25"><a href="aplikace3.html#cb1033-25" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> box_alpha1) <span class="sc">+</span></span>
<span id="cb1033-26"><a href="aplikace3.html#cb1033-26" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb1033-27"><a href="aplikace3.html#cb1033-27" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey20&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-271"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-271-1.png" alt="Box plots of testing errors for 100 simulations separately for each classification method. The black symbols $+$ denote the means." width="672" />
<p class="caption">
Figure 6.26: Box plots of testing errors for 100 simulations separately for each classification method. The black symbols <span class="math inline">\(+\)</span> denote the means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1034"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1034-1"><a href="aplikace3.html#cb1034-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/results_tec_der.tex&quot;, device = tikz, width = 7, height = 5)</span></span>
<span id="cb1034-2"><a href="aplikace3.html#cb1034-2" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap7_tecator_box_test_der_subset.tex&quot;, device = tikz, width = 6.5, height = 5)</span></span></code></pre></div>
</details>
<p>Finally, let’s take a look at which hyperparameter values were the most commonly chosen.</p>
<table>
<caption><span id="tab:unnamed-chunk-273">Table 5.16: </span>Medians of hyperparameter values for selected methods where a hyperparameter was determined using cross-validation.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Median hyperparameter value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">2.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">8.0</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">6.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">0.5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">0.3</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">0.3</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">14.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">8.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">6.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">5.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">21.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">21.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">25.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1035"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1035-1"><a href="aplikace3.html#cb1035-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb1035-2"><a href="aplikace3.html#cb1035-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb1035-3"><a href="aplikace3.html#cb1035-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb1035-4"><a href="aplikace3.html#cb1035-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb1035-5"><a href="aplikace3.html#cb1035-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb1035-6"><a href="aplikace3.html#cb1035-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb1035-7"><a href="aplikace3.html#cb1035-7" tabindex="-1"></a></span>
<span id="cb1035-8"><a href="aplikace3.html#cb1035-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1035-9"><a href="aplikace3.html#cb1035-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1035-10"><a href="aplikace3.html#cb1035-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1035-11"><a href="aplikace3.html#cb1035-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1035-12"><a href="aplikace3.html#cb1035-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1035-13"><a href="aplikace3.html#cb1035-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1035-14"><a href="aplikace3.html#cb1035-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb1035-15"><a href="aplikace3.html#cb1035-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1035-16"><a href="aplikace3.html#cb1035-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1035-17"><a href="aplikace3.html#cb1035-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-274-1.png" alt="Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components." width="672" />
<p class="caption">
Figure 5.41: Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1036"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1036-1"><a href="aplikace3.html#cb1036-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1036-2"><a href="aplikace3.html#cb1036-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1036-3"><a href="aplikace3.html#cb1036-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1036-4"><a href="aplikace3.html#cb1036-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1036-5"><a href="aplikace3.html#cb1036-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1036-6"><a href="aplikace3.html#cb1036-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1036-7"><a href="aplikace3.html#cb1036-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb1036-8"><a href="aplikace3.html#cb1036-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1036-9"><a href="aplikace3.html#cb1036-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1036-10"><a href="aplikace3.html#cb1036-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-276"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-276-1.png" alt="Histograms of hyperparameter values for SVM with projection onto B-spline basis." width="672" />
<p class="caption">
Figure 6.27: Histograms of hyperparameter values for SVM with projection onto B-spline basis.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1037"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1037-1"><a href="aplikace3.html#cb1037-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1037-2"><a href="aplikace3.html#cb1037-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb1037-3"><a href="aplikace3.html#cb1037-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb1037-4"><a href="aplikace3.html#cb1037-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1037-5"><a href="aplikace3.html#cb1037-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1037-6"><a href="aplikace3.html#cb1037-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1037-7"><a href="aplikace3.html#cb1037-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1037-8"><a href="aplikace3.html#cb1037-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1037-9"><a href="aplikace3.html#cb1037-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1037-10"><a href="aplikace3.html#cb1037-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1037-11"><a href="aplikace3.html#cb1037-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1037-12"><a href="aplikace3.html#cb1037-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-278"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-278-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with radial kernel." width="672" />
<p class="caption">
Figure 5.42: Histograms of hyperparameter values for RKHS + SVM with radial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1038"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1038-1"><a href="aplikace3.html#cb1038-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1038-2"><a href="aplikace3.html#cb1038-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb1038-3"><a href="aplikace3.html#cb1038-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb1038-4"><a href="aplikace3.html#cb1038-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1038-5"><a href="aplikace3.html#cb1038-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1038-6"><a href="aplikace3.html#cb1038-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1038-7"><a href="aplikace3.html#cb1038-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1038-8"><a href="aplikace3.html#cb1038-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1038-9"><a href="aplikace3.html#cb1038-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1038-10"><a href="aplikace3.html#cb1038-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1038-11"><a href="aplikace3.html#cb1038-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1038-12"><a href="aplikace3.html#cb1038-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-280"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-280-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with polynomial kernel." width="672" />
<p class="caption">
Figure 6.28: Histograms of hyperparameter values for RKHS + SVM with polynomial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1039"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1039-1"><a href="aplikace3.html#cb1039-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb1039-2"><a href="aplikace3.html#cb1039-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb1039-3"><a href="aplikace3.html#cb1039-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb1039-4"><a href="aplikace3.html#cb1039-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb1039-5"><a href="aplikace3.html#cb1039-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb1039-6"><a href="aplikace3.html#cb1039-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb1039-7"><a href="aplikace3.html#cb1039-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb1039-8"><a href="aplikace3.html#cb1039-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb1039-9"><a href="aplikace3.html#cb1039-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter values&#39;</span>,</span>
<span id="cb1039-10"><a href="aplikace3.html#cb1039-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb1039-11"><a href="aplikace3.html#cb1039-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282"></span>
<img src="06-Application_files/figure-html/unnamed-chunk-282-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with linear kernel." width="672" />
<p class="caption">
Figure 5.43: Histograms of hyperparameter values for RKHS + SVM with linear kernel.
</p>
</div>

</div>
</div>
</div>
</div>






            </section>

          </div>
        </div>
      </div>
<a href="simulace4.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page"><i class="fa fa-angle-left"></i></a>

    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": null,
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/06-Application.Rmd",
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  },
  "info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
