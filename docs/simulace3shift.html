<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 3 Dependence on parameter \(\sigma_{shift}\) | Support Vector Machine Classification of Functional Data with Random Vertical Shifts</title>
  <meta name="description" content="Chapter 3 Dependence on parameter \(\sigma_{shift}\) | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 3 Dependence on parameter \(\sigma_{shift}\) | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 3 Dependence on parameter \(\sigma_{shift}\) | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2025-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace3sigma.html"/>
<link rel="next" href="simulace3diskr.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Support Vector Machine Classification of Functional Data with Random Vertical Shifts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace3shift" class="section level1 hasAnchor" number="3">
<h1><span class="header-section-number">Chapter 3</span> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span><a href="simulace3shift.html#simulace3shift" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we will focus on the dependence of the results from section <a href="simulace3.html#simulace3">1</a> on the value of <span class="math inline">\(\sigma^2_{shift}\)</span>, which defines the variance of the normal distribution from which we generate the shift for the generated curves. We expect that as the value of <span class="math inline">\(\sigma^2_{shift}\)</span> increases, the results of the individual methods will deteriorate, and thus the classification will not be as successful. We assume that methods utilizing the functional nature of the data will be more successful compared to classical methods as the value of <span class="math inline">\(\sigma^2_{shift}\)</span> increases. In the previous section <a href="simulace3sigma.html#simulace3sigma">2</a>, we examined the dependence of results on the value of <span class="math inline">\(\sigma^2\)</span>, that is, on the variance of the normal distribution from which we generate random errors around the generating curves.</p>
<div id="simulation-of-functional-data-2" class="section level2 hasAnchor" number="3.1">
<h2><span class="header-section-number">3.1</span> Simulation of Functional Data<a href="simulace3shift.html#simulation-of-functional-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will simulate functions that we will subsequently want to classify. For simplicity, we will consider two classification classes. For the simulation, we will first:</p>
<ul>
<li><p>choose suitable functions,</p></li>
<li><p>generate points from the chosen interval, which include, for example, Gaussian noise,</p></li>
<li><p>smooth the obtained discrete points into the form of a functional object using some suitable basis system.</p></li>
</ul>
<p>With this approach, we will obtain functional objects along with the value of the categorical variable <span class="math inline">\(Y\)</span>, which distinguishes the membership in the classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb286"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb286-1"><a href="simulace3shift.html#cb286-1" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb286-2"><a href="simulace3shift.html#cb286-2" tabindex="-1"></a></span>
<span id="cb286-3"><a href="simulace3shift.html#cb286-3" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb286-4"><a href="simulace3shift.html#cb286-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb286-5"><a href="simulace3shift.html#cb286-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb286-6"><a href="simulace3shift.html#cb286-6" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb286-7"><a href="simulace3shift.html#cb286-7" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb286-8"><a href="simulace3shift.html#cb286-8" tabindex="-1"></a><span class="fu">library</span>(polynom)</span>
<span id="cb286-9"><a href="simulace3shift.html#cb286-9" tabindex="-1"></a></span>
<span id="cb286-10"><a href="simulace3shift.html#cb286-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Let us consider two classification classes, <span class="math inline">\(Y \in \{0, 1\}\)</span>, with the same number of <code>n</code> generated functions for each class. First, we define two functions, each corresponding to one class. The functions will be considered on the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<p>Now we will create the functions using interpolation polynomials. First, we define the points through which our curve will pass and subsequently fit an interpolation polynomial through these points, which we will use for generating curves for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb287"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb287-1"><a href="simulace3shift.html#cb287-1" tabindex="-1"></a><span class="co"># Defining points for class 0</span></span>
<span id="cb287-2"><a href="simulace3shift.html#cb287-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.65</span>, <span class="fl">0.94</span>, <span class="fl">1.42</span>, <span class="fl">2.26</span>, <span class="fl">2.84</span>, <span class="fl">3.73</span>, <span class="fl">4.50</span>, <span class="fl">5.43</span>, <span class="fl">6.00</span>)</span>
<span id="cb287-3"><a href="simulace3shift.html#cb287-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.86</span>, <span class="fl">1.49</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.36</span>, <span class="fl">0.23</span>, <span class="dv">0</span>)</span>
<span id="cb287-4"><a href="simulace3shift.html#cb287-4" tabindex="-1"></a></span>
<span id="cb287-5"><a href="simulace3shift.html#cb287-5" tabindex="-1"></a><span class="co"># Defining points for class 1</span></span>
<span id="cb287-6"><a href="simulace3shift.html#cb287-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.51</span>, <span class="fl">0.91</span>, <span class="fl">1.25</span>, <span class="fl">1.51</span>, <span class="fl">2.14</span>, <span class="fl">2.43</span>, <span class="fl">2.96</span>, <span class="fl">3.70</span>, <span class="fl">4.60</span>,</span>
<span id="cb287-7"><a href="simulace3shift.html#cb287-7" tabindex="-1"></a>         <span class="fl">5.25</span>, <span class="fl">5.67</span>, <span class="fl">6.00</span>)</span>
<span id="cb287-8"><a href="simulace3shift.html#cb287-8" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.71</span>, <span class="fl">1.08</span>, <span class="fl">1.47</span>, <span class="fl">1.39</span>, <span class="fl">0.81</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb287-9"><a href="simulace3shift.html#cb287-9" tabindex="-1"></a>         <span class="fl">0.3</span>, <span class="fl">0.37</span>, <span class="dv">0</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb288"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb288-1"><a href="simulace3shift.html#cb288-1" tabindex="-1"></a><span class="co"># Graph of the points</span></span>
<span id="cb288-2"><a href="simulace3shift.html#cb288-2" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb288-3"><a href="simulace3shift.html#cb288-3" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb288-4"><a href="simulace3shift.html#cb288-4" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb288-5"><a href="simulace3shift.html#cb288-5" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb288-6"><a href="simulace3shift.html#cb288-6" tabindex="-1"></a></span>
<span id="cb288-7"><a href="simulace3shift.html#cb288-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb288-8"><a href="simulace3shift.html#cb288-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb288-9"><a href="simulace3shift.html#cb288-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb288-10"><a href="simulace3shift.html#cb288-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-3-1.png" alt="Points that define the interpolation polynomials." width="672" />
<p class="caption">
Figure 1.1: Points that define the interpolation polynomials.
</p>
</div>
<p>To calculate the interpolation polynomials, we will use the <code>poly.calc()</code> function from the <code>polynom</code> library. We will also define functions <code>poly.0()</code> and <code>poly.1()</code>, which will compute the polynomial values at a given point in the interval. To create them, we will use the <code>predict()</code> function, to which we will input the respective polynomial and the point at which we want to evaluate the polynomial.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb289"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb289-1"><a href="simulace3shift.html#cb289-1" tabindex="-1"></a><span class="co"># Calculation of the polynomials</span></span>
<span id="cb289-2"><a href="simulace3shift.html#cb289-2" tabindex="-1"></a>polynom<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>)</span>
<span id="cb289-3"><a href="simulace3shift.html#cb289-3" tabindex="-1"></a>polynom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb290"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb290-1"><a href="simulace3shift.html#cb290-1" tabindex="-1"></a>poly<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.0</span>, x))</span>
<span id="cb290-2"><a href="simulace3shift.html#cb290-2" tabindex="-1"></a>poly<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.1</span>, x))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb291"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb291-1"><a href="simulace3shift.html#cb291-1" tabindex="-1"></a><span class="co"># Plotting the polynomial</span></span>
<span id="cb291-2"><a href="simulace3shift.html#cb291-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x<span class="fl">.0</span>), <span class="fu">max</span>(x<span class="fl">.0</span>), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb291-3"><a href="simulace3shift.html#cb291-3" tabindex="-1"></a>yy<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.0</span>(xx)</span>
<span id="cb291-4"><a href="simulace3shift.html#cb291-4" tabindex="-1"></a>yy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.1</span>(xx)</span>
<span id="cb291-5"><a href="simulace3shift.html#cb291-5" tabindex="-1"></a></span>
<span id="cb291-6"><a href="simulace3shift.html#cb291-6" tabindex="-1"></a>dat_poly_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(xx, xx),</span>
<span id="cb291-7"><a href="simulace3shift.html#cb291-7" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(yy<span class="fl">.0</span>, yy<span class="fl">.1</span>),</span>
<span id="cb291-8"><a href="simulace3shift.html#cb291-8" tabindex="-1"></a>                            <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb291-9"><a href="simulace3shift.html#cb291-9" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="fu">length</span>(xx), <span class="fu">length</span>(xx))))</span>
<span id="cb291-10"><a href="simulace3shift.html#cb291-10" tabindex="-1"></a></span>
<span id="cb291-11"><a href="simulace3shift.html#cb291-11" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb291-12"><a href="simulace3shift.html#cb291-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb291-13"><a href="simulace3shift.html#cb291-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb291-14"><a href="simulace3shift.html#cb291-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_plot,</span>
<span id="cb291-15"><a href="simulace3shift.html#cb291-15" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class),</span>
<span id="cb291-16"><a href="simulace3shift.html#cb291-16" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb291-17"><a href="simulace3shift.html#cb291-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-6-1.png" alt="Representation of two functions over the interval $I = [0, 6]$, from which we generate observations from classes 0 and 1." width="672" />
<p class="caption">
Figure 1.2: Representation of two functions over the interval <span class="math inline">\(I = [0, 6]\)</span>, from which we generate observations from classes 0 and 1.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb292"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb292-1"><a href="simulace3shift.html#cb292-1" tabindex="-1"></a><span class="co"># Generating functions for Y = 0 and Y = 1</span></span>
<span id="cb292-2"><a href="simulace3shift.html#cb292-2" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> poly<span class="fl">.0</span></span>
<span id="cb292-3"><a href="simulace3shift.html#cb292-3" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> poly<span class="fl">.1</span></span></code></pre></div>
</details>
<p>Now we will create a function to generate random functions with added noise (or points on a predetermined grid) from the chosen generating function. The argument <code>t</code> represents the vector of values at which we want to evaluate the given functions, <code>fun</code> denotes the generating function, <code>n</code> is the number of functions, and <code>sigma</code> is the standard deviation <span class="math inline">\(\sigma\)</span> of the normal distribution <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>, from which we randomly generate Gaussian white noise with <span class="math inline">\(\mu = 0\)</span>. To demonstrate the advantage of using methods that work with functional data, we will also add a random term during generation to each simulated observation, which will serve as the vertical shift of the entire function (parameter <code>sigma_shift</code>). This shift will be generated from a normal distribution with the parameter <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb293"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb293-1"><a href="simulace3shift.html#cb293-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb293-2"><a href="simulace3shift.html#cb293-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb293-3"><a href="simulace3shift.html#cb293-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb293-4"><a href="simulace3shift.html#cb293-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb293-5"><a href="simulace3shift.html#cb293-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb293-6"><a href="simulace3shift.html#cb293-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb293-7"><a href="simulace3shift.html#cb293-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb293-8"><a href="simulace3shift.html#cb293-8" tabindex="-1"></a>  </span>
<span id="cb293-9"><a href="simulace3shift.html#cb293-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb293-10"><a href="simulace3shift.html#cb293-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb293-11"><a href="simulace3shift.html#cb293-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb293-12"><a href="simulace3shift.html#cb293-12" tabindex="-1"></a>  </span>
<span id="cb293-13"><a href="simulace3shift.html#cb293-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb293-14"><a href="simulace3shift.html#cb293-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb293-15"><a href="simulace3shift.html#cb293-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb293-16"><a href="simulace3shift.html#cb293-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb293-17"><a href="simulace3shift.html#cb293-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb293-18"><a href="simulace3shift.html#cb293-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fun</span>(X) <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb293-19"><a href="simulace3shift.html#cb293-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can generate the functions. In each of the two classes, we will consider 100 observations, so <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb294"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb294-1"><a href="simulace3shift.html#cb294-1" tabindex="-1"></a><span class="co"># Number of generated observations for each class</span></span>
<span id="cb294-2"><a href="simulace3shift.html#cb294-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb294-3"><a href="simulace3shift.html#cb294-3" tabindex="-1"></a><span class="co"># Vector of time evenly spaced over the interval [0, 6]</span></span>
<span id="cb294-4"><a href="simulace3shift.html#cb294-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb294-5"><a href="simulace3shift.html#cb294-5" tabindex="-1"></a></span>
<span id="cb294-6"><a href="simulace3shift.html#cb294-6" tabindex="-1"></a><span class="co"># For Y = 0</span></span>
<span id="cb294-7"><a href="simulace3shift.html#cb294-7" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb294-8"><a href="simulace3shift.html#cb294-8" tabindex="-1"></a><span class="co"># For Y = 1</span></span>
<span id="cb294-9"><a href="simulace3shift.html#cb294-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (not yet smoothed) functions color-coded by class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb295"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb295-1"><a href="simulace3shift.html#cb295-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of curves we want to plot from each group</span></span>
<span id="cb295-2"><a href="simulace3shift.html#cb295-2" tabindex="-1"></a></span>
<span id="cb295-3"><a href="simulace3shift.html#cb295-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb295-4"><a href="simulace3shift.html#cb295-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb295-5"><a href="simulace3shift.html#cb295-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb295-6"><a href="simulace3shift.html#cb295-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb295-7"><a href="simulace3shift.html#cb295-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb295-8"><a href="simulace3shift.html#cb295-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb295-9"><a href="simulace3shift.html#cb295-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb295-10"><a href="simulace3shift.html#cb295-10" tabindex="-1"></a>  )</span>
<span id="cb295-11"><a href="simulace3shift.html#cb295-11" tabindex="-1"></a></span>
<span id="cb295-12"><a href="simulace3shift.html#cb295-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb295-13"><a href="simulace3shift.html#cb295-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb295-14"><a href="simulace3shift.html#cb295-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb295-15"><a href="simulace3shift.html#cb295-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb295-16"><a href="simulace3shift.html#cb295-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb295-17"><a href="simulace3shift.html#cb295-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb295-18"><a href="simulace3shift.html#cb295-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb295-19"><a href="simulace3shift.html#cb295-19" tabindex="-1"></a>  )</span>
<span id="cb295-20"><a href="simulace3shift.html#cb295-20" tabindex="-1"></a></span>
<span id="cb295-21"><a href="simulace3shift.html#cb295-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb295-22"><a href="simulace3shift.html#cb295-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb295-23"><a href="simulace3shift.html#cb295-23" tabindex="-1"></a></span>
<span id="cb295-24"><a href="simulace3shift.html#cb295-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb295-25"><a href="simulace3shift.html#cb295-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb295-26"><a href="simulace3shift.html#cb295-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb295-27"><a href="simulace3shift.html#cb295-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb295-28"><a href="simulace3shift.html#cb295-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb295-29"><a href="simulace3shift.html#cb295-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb295-30"><a href="simulace3shift.html#cb295-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb295-31"><a href="simulace3shift.html#cb295-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-11-1.png" alt="First 10 generated observations from each of the two classification classes. The observed data are not smoothed." width="672" />
<p class="caption">
Figure 2.1: First 10 generated observations from each of the two classification classes. The observed data are not smoothed.
</p>
</div>
</div>
<div id="smoothing-the-observed-curves-1" class="section level2 hasAnchor" number="3.2">
<h2><span class="header-section-number">3.2</span> Smoothing the Observed Curves<a href="simulace3shift.html#smoothing-the-observed-curves-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will convert the observed discrete values (vectors of values) into functional objects, with which we will subsequently work. We will again use the B-spline basis for smoothing.</p>
<p>We will take the entire vector <code>t</code> as the knots and typically consider cubic splines, so we choose (the implicit choice in <code>R</code>) <code>norder = 4</code>. We will penalize the second derivative of the functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb296"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb296-1"><a href="simulace3shift.html#cb296-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb296-2"><a href="simulace3shift.html#cb296-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb296-3"><a href="simulace3shift.html#cb296-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb296-4"><a href="simulace3shift.html#cb296-4" tabindex="-1"></a></span>
<span id="cb296-5"><a href="simulace3shift.html#cb296-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb296-6"><a href="simulace3shift.html#cb296-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb296-7"><a href="simulace3shift.html#cb296-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb296-8"><a href="simulace3shift.html#cb296-8" tabindex="-1"></a></span>
<span id="cb296-9"><a href="simulace3shift.html#cb296-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) <span class="co"># Penalizing the 2nd derivative</span></span></code></pre></div>
</details>
<p>We will find a suitable value for the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, that is, through generalized cross-validation. We will consider the value of <span class="math inline">\(\lambda\)</span> to be the same for both classification groups, as for test observations we would not know in advance which value of $, in the case of different choices for each class, we should choose.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb297"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb297-1"><a href="simulace3shift.html#cb297-1" tabindex="-1"></a><span class="co"># Combining observations into one matrix</span></span>
<span id="cb297-2"><a href="simulace3shift.html#cb297-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb297-3"><a href="simulace3shift.html#cb297-3" tabindex="-1"></a></span>
<span id="cb297-4"><a href="simulace3shift.html#cb297-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># Vector of lambdas</span></span>
<span id="cb297-5"><a href="simulace3shift.html#cb297-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># Empty vector to store GCV</span></span>
<span id="cb297-6"><a href="simulace3shift.html#cb297-6" tabindex="-1"></a></span>
<span id="cb297-7"><a href="simulace3shift.html#cb297-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb297-8"><a href="simulace3shift.html#cb297-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb297-9"><a href="simulace3shift.html#cb297-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># Smoothing</span></span>
<span id="cb297-10"><a href="simulace3shift.html#cb297-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># Average over all observed curves</span></span>
<span id="cb297-11"><a href="simulace3shift.html#cb297-11" tabindex="-1"></a>}</span>
<span id="cb297-12"><a href="simulace3shift.html#cb297-12" tabindex="-1"></a></span>
<span id="cb297-13"><a href="simulace3shift.html#cb297-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb297-14"><a href="simulace3shift.html#cb297-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb297-15"><a href="simulace3shift.html#cb297-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb297-16"><a href="simulace3shift.html#cb297-16" tabindex="-1"></a>)</span>
<span id="cb297-17"><a href="simulace3shift.html#cb297-17" tabindex="-1"></a></span>
<span id="cb297-18"><a href="simulace3shift.html#cb297-18" tabindex="-1"></a><span class="co"># Finding the value of the minimum</span></span>
<span id="cb297-19"><a href="simulace3shift.html#cb297-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>For better visualization, we will plot the progression of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb298"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb298-1"><a href="simulace3shift.html#cb298-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb298-2"><a href="simulace3shift.html#cb298-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb298-3"><a href="simulace3shift.html#cb298-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb298-4"><a href="simulace3shift.html#cb298-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb298-5"><a href="simulace3shift.html#cb298-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb298-6"><a href="simulace3shift.html#cb298-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb298-7"><a href="simulace3shift.html#cb298-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb298-8"><a href="simulace3shift.html#cb298-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-14-1.png" alt="The progression of $GCV(\lambda)$ for the selected vector $\boldsymbol\lambda$. The values on the x-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is shown in red." width="672" />
<p class="caption">
Figure 1.5: The progression of <span class="math inline">\(GCV(\lambda)\)</span> for the selected vector <span class="math inline">\(\boldsymbol\lambda\)</span>. The values on the x-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is shown in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically represent the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb300"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb300-1"><a href="simulace3shift.html#cb300-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb300-2"><a href="simulace3shift.html#cb300-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb300-3"><a href="simulace3shift.html#cb300-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb300-4"><a href="simulace3shift.html#cb300-4" tabindex="-1"></a></span>
<span id="cb300-5"><a href="simulace3shift.html#cb300-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb300-6"><a href="simulace3shift.html#cb300-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb300-7"><a href="simulace3shift.html#cb300-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb300-8"><a href="simulace3shift.html#cb300-8" tabindex="-1"></a></span>
<span id="cb300-9"><a href="simulace3shift.html#cb300-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb300-10"><a href="simulace3shift.html#cb300-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb300-11"><a href="simulace3shift.html#cb300-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb300-12"><a href="simulace3shift.html#cb300-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb300-13"><a href="simulace3shift.html#cb300-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb300-14"><a href="simulace3shift.html#cb300-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb300-15"><a href="simulace3shift.html#cb300-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb300-16"><a href="simulace3shift.html#cb300-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-15-1.png" alt="The first 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.6: The first 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s also display all curves including the average separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb301"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb301-1"><a href="simulace3shift.html#cb301-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb301-2"><a href="simulace3shift.html#cb301-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb301-3"><a href="simulace3shift.html#cb301-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb301-4"><a href="simulace3shift.html#cb301-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb301-5"><a href="simulace3shift.html#cb301-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb301-6"><a href="simulace3shift.html#cb301-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb301-7"><a href="simulace3shift.html#cb301-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb301-8"><a href="simulace3shift.html#cb301-8" tabindex="-1"></a>)</span>
<span id="cb301-9"><a href="simulace3shift.html#cb301-9" tabindex="-1"></a></span>
<span id="cb301-10"><a href="simulace3shift.html#cb301-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb301-11"><a href="simulace3shift.html#cb301-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb301-12"><a href="simulace3shift.html#cb301-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb301-13"><a href="simulace3shift.html#cb301-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb301-14"><a href="simulace3shift.html#cb301-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb301-15"><a href="simulace3shift.html#cb301-15" tabindex="-1"></a>)</span>
<span id="cb301-16"><a href="simulace3shift.html#cb301-16" tabindex="-1"></a></span>
<span id="cb301-17"><a href="simulace3shift.html#cb301-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb301-18"><a href="simulace3shift.html#cb301-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb301-19"><a href="simulace3shift.html#cb301-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb301-20"><a href="simulace3shift.html#cb301-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb301-21"><a href="simulace3shift.html#cb301-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb301-22"><a href="simulace3shift.html#cb301-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb301-23"><a href="simulace3shift.html#cb301-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb301-24"><a href="simulace3shift.html#cb301-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb301-25"><a href="simulace3shift.html#cb301-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb301-26"><a href="simulace3shift.html#cb301-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb301-27"><a href="simulace3shift.html#cb301-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb301-28"><a href="simulace3shift.html#cb301-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb301-29"><a href="simulace3shift.html#cb301-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="co">#, limits = c(-1, 2))</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-16-1.png" alt="Plot of all smoothed observed curves, colored according to their classification class. The thick line represents the mean for each class." width="672" />
<p class="caption">
Figure 1.7: Plot of all smoothed observed curves, colored according to their classification class. The thick line represents the mean for each class.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb302"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb302-1"><a href="simulace3shift.html#cb302-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb302-2"><a href="simulace3shift.html#cb302-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb302-3"><a href="simulace3shift.html#cb302-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb302-4"><a href="simulace3shift.html#cb302-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb302-5"><a href="simulace3shift.html#cb302-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb302-6"><a href="simulace3shift.html#cb302-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb302-7"><a href="simulace3shift.html#cb302-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb302-8"><a href="simulace3shift.html#cb302-8" tabindex="-1"></a>)</span>
<span id="cb302-9"><a href="simulace3shift.html#cb302-9" tabindex="-1"></a></span>
<span id="cb302-10"><a href="simulace3shift.html#cb302-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb302-11"><a href="simulace3shift.html#cb302-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb302-12"><a href="simulace3shift.html#cb302-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb302-13"><a href="simulace3shift.html#cb302-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb302-14"><a href="simulace3shift.html#cb302-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb302-15"><a href="simulace3shift.html#cb302-15" tabindex="-1"></a>)</span>
<span id="cb302-16"><a href="simulace3shift.html#cb302-16" tabindex="-1"></a></span>
<span id="cb302-17"><a href="simulace3shift.html#cb302-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb302-18"><a href="simulace3shift.html#cb302-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb302-19"><a href="simulace3shift.html#cb302-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb302-20"><a href="simulace3shift.html#cb302-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb302-21"><a href="simulace3shift.html#cb302-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb302-22"><a href="simulace3shift.html#cb302-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb302-23"><a href="simulace3shift.html#cb302-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb302-24"><a href="simulace3shift.html#cb302-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb302-25"><a href="simulace3shift.html#cb302-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb302-26"><a href="simulace3shift.html#cb302-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb302-27"><a href="simulace3shift.html#cb302-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb302-28"><a href="simulace3shift.html#cb302-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb302-29"><a href="simulace3shift.html#cb302-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-17-1.png" alt="Plot of all smoothed observed curves, colored according to their classification class. The thick line represents the mean for each class. Zoomed-in view." width="672" />
<p class="caption">
Figure 2.2: Plot of all smoothed observed curves, colored according to their classification class. The thick line represents the mean for each class. Zoomed-in view.
</p>
</div>
</div>
<div id="classification-of-curves-2" class="section level2 hasAnchor" number="3.3">
<h2><span class="header-section-number">3.3</span> Classification of Curves<a href="simulace3shift.html#classification-of-curves-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb303"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb303-1"><a href="simulace3shift.html#cb303-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training sets</span></span>
<span id="cb303-2"><a href="simulace3shift.html#cb303-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb303-3"><a href="simulace3shift.html#cb303-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb303-4"><a href="simulace3shift.html#cb303-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb303-5"><a href="simulace3shift.html#cb303-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb303-6"><a href="simulace3shift.html#cb303-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb303-7"><a href="simulace3shift.html#cb303-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for LR on scores</span></span>
<span id="cb303-8"><a href="simulace3shift.html#cb303-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for LR on scores</span></span>
<span id="cb303-9"><a href="simulace3shift.html#cb303-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb303-10"><a href="simulace3shift.html#cb303-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># for decision trees</span></span>
<span id="cb303-11"><a href="simulace3shift.html#cb303-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># for visualization</span></span>
<span id="cb303-12"><a href="simulace3shift.html#cb303-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb303-13"><a href="simulace3shift.html#cb303-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># for random forests</span></span></code></pre></div>
</details>
<p>To compare the individual classifiers, we will split the generated observation set into two parts in a 70:30 ratio, specifically for training and test (validation) sets. The training set will be used for constructing the classifier, while the test set will be used for calculating classification error and potentially other characteristics of our model. The resulting classifiers can then be compared based on these calculated characteristics in terms of their classification success.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb304"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb304-1"><a href="simulace3shift.html#cb304-1" tabindex="-1"></a><span class="co"># Splitting into test and training sets</span></span>
<span id="cb304-2"><a href="simulace3shift.html#cb304-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb304-3"><a href="simulace3shift.html#cb304-3" tabindex="-1"></a></span>
<span id="cb304-4"><a href="simulace3shift.html#cb304-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb304-5"><a href="simulace3shift.html#cb304-5" tabindex="-1"></a></span>
<span id="cb304-6"><a href="simulace3shift.html#cb304-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb304-7"><a href="simulace3shift.html#cb304-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb304-8"><a href="simulace3shift.html#cb304-8" tabindex="-1"></a></span>
<span id="cb304-9"><a href="simulace3shift.html#cb304-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb304-10"><a href="simulace3shift.html#cb304-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, we will examine the representation of individual groups in the test and training parts of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb305"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb305-1"><a href="simulace3shift.html#cb305-1" tabindex="-1"></a><span class="co"># Absolute representation</span></span>
<span id="cb305-2"><a href="simulace3shift.html#cb305-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb307"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb307-1"><a href="simulace3shift.html#cb307-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb309"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb309-1"><a href="simulace3shift.html#cb309-1" tabindex="-1"></a><span class="co"># Relative representation</span></span>
<span id="cb309-2"><a href="simulace3shift.html#cb309-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb311"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb311-1"><a href="simulace3shift.html#cb311-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nearest-neighbors-2" class="section level3 hasAnchor" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="simulace3shift.html#k-nearest-neighbors-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will start with a non-parametric classification method, the <span class="math inline">\(K\)</span> nearest neighbors method. First, we will create the necessary objects so that we can further work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb313"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb313-1"><a href="simulace3shift.html#cb313-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb313-2"><a href="simulace3shift.html#cb313-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and examine its classification success. The last question remains how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>. We could select <span class="math inline">\(K\)</span> that minimizes the error rate on the training data. However, this could lead to overfitting the model; therefore, we will use cross-validation. Given the computational complexity and the size of the dataset, we will choose <span class="math inline">\(k\)</span>-fold CV, for instance, with <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb314"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb314-1"><a href="simulace3shift.html#cb314-1" tabindex="-1"></a><span class="co"># Model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb314-2"><a href="simulace3shift.html#cb314-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb314-3"><a href="simulace3shift.html#cb314-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb314-4"><a href="simulace3shift.html#cb314-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb314-5"><a href="simulace3shift.html#cb314-5" tabindex="-1"></a></span>
<span id="cb314-6"><a href="simulace3shift.html#cb314-6" tabindex="-1"></a><span class="co"># summary(neighb.model) # summary of the model</span></span>
<span id="cb314-7"><a href="simulace3shift.html#cb314-7" tabindex="-1"></a><span class="co"># plot(neighb.model$gcv, pch = 16) # plot the dependence of GCV on the number of neighbors K</span></span>
<span id="cb314-8"><a href="simulace3shift.html#cb314-8" tabindex="-1"></a><span class="co"># neighb.model$max.prob # maximum accuracy</span></span>
<span id="cb314-9"><a href="simulace3shift.html#cb314-9" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 5</code></pre>
<p>Let’s follow the previous procedure for the training data, which we will split into <span class="math inline">\(k\)</span> parts and repeat this code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb316"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb316-1"><a href="simulace3shift.html#cb316-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb316-2"><a href="simulace3shift.html#cb316-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb316-3"><a href="simulace3shift.html#cb316-3" tabindex="-1"></a></span>
<span id="cb316-4"><a href="simulace3shift.html#cb316-4" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb316-5"><a href="simulace3shift.html#cb316-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb316-6"><a href="simulace3shift.html#cb316-6" tabindex="-1"></a></span>
<span id="cb316-7"><a href="simulace3shift.html#cb316-7" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb316-8"><a href="simulace3shift.html#cb316-8" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for the given part of the training set</span></span>
<span id="cb316-9"><a href="simulace3shift.html#cb316-9" tabindex="-1"></a><span class="co"># Rows will contain values for each neighbor value K</span></span>
<span id="cb316-10"><a href="simulace3shift.html#cb316-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb316-11"><a href="simulace3shift.html#cb316-11" tabindex="-1"></a></span>
<span id="cb316-12"><a href="simulace3shift.html#cb316-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb316-13"><a href="simulace3shift.html#cb316-13" tabindex="-1"></a>  <span class="co"># Define the specific index set</span></span>
<span id="cb316-14"><a href="simulace3shift.html#cb316-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb316-15"><a href="simulace3shift.html#cb316-15" tabindex="-1"></a>    </span>
<span id="cb316-16"><a href="simulace3shift.html#cb316-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb316-17"><a href="simulace3shift.html#cb316-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb316-18"><a href="simulace3shift.html#cb316-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb316-19"><a href="simulace3shift.html#cb316-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb316-20"><a href="simulace3shift.html#cb316-20" tabindex="-1"></a>  </span>
<span id="cb316-21"><a href="simulace3shift.html#cb316-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb316-22"><a href="simulace3shift.html#cb316-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb316-23"><a href="simulace3shift.html#cb316-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb316-24"><a href="simulace3shift.html#cb316-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb316-25"><a href="simulace3shift.html#cb316-25" tabindex="-1"></a>  </span>
<span id="cb316-26"><a href="simulace3shift.html#cb316-26" tabindex="-1"></a>  <span class="co"># Loop through each part ... repeat k times</span></span>
<span id="cb316-27"><a href="simulace3shift.html#cb316-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb316-28"><a href="simulace3shift.html#cb316-28" tabindex="-1"></a>    <span class="co"># Model for a specific choice of K</span></span>
<span id="cb316-29"><a href="simulace3shift.html#cb316-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb316-30"><a href="simulace3shift.html#cb316-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb316-31"><a href="simulace3shift.html#cb316-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb316-32"><a href="simulace3shift.html#cb316-32" tabindex="-1"></a>    <span class="co"># Prediction on the validation part</span></span>
<span id="cb316-33"><a href="simulace3shift.html#cb316-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb316-34"><a href="simulace3shift.html#cb316-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb316-35"><a href="simulace3shift.html#cb316-35" tabindex="-1"></a>    <span class="co"># Accuracy on the validation part</span></span>
<span id="cb316-36"><a href="simulace3shift.html#cb316-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb316-37"><a href="simulace3shift.html#cb316-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb316-38"><a href="simulace3shift.html#cb316-38" tabindex="-1"></a>    </span>
<span id="cb316-39"><a href="simulace3shift.html#cb316-39" tabindex="-1"></a>    <span class="co"># Store accuracy at the position for given K and fold</span></span>
<span id="cb316-40"><a href="simulace3shift.html#cb316-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb316-41"><a href="simulace3shift.html#cb316-41" tabindex="-1"></a>  }</span>
<span id="cb316-42"><a href="simulace3shift.html#cb316-42" tabindex="-1"></a>}</span>
<span id="cb316-43"><a href="simulace3shift.html#cb316-43" tabindex="-1"></a></span>
<span id="cb316-44"><a href="simulace3shift.html#cb316-44" tabindex="-1"></a><span class="co"># Calculate average accuracy for each K across folds</span></span>
<span id="cb316-45"><a href="simulace3shift.html#cb316-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb316-46"><a href="simulace3shift.html#cb316-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb316-47"><a href="simulace3shift.html#cb316-47" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb316-48"><a href="simulace3shift.html#cb316-48" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>We can see that the optimal parameter <span class="math inline">\(K\)</span> is 5 with an error rate calculated using 10-fold CV of 0.3429. For clarity, let’s also plot the validation error as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb317"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb317-1"><a href="simulace3shift.html#cb317-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb317-2"><a href="simulace3shift.html#cb317-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb317-3"><a href="simulace3shift.html#cb317-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb317-4"><a href="simulace3shift.html#cb317-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb317-5"><a href="simulace3shift.html#cb317-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb317-6"><a href="simulace3shift.html#cb317-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb317-7"><a href="simulace3shift.html#cb317-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb317-8"><a href="simulace3shift.html#cb317-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb317-9"><a href="simulace3shift.html#cb317-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb317-10"><a href="simulace3shift.html#cb317-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - accuracy.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 24 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-24-1.png" alt="Dependence of validation error on the value of $K$, i.e., on the number of neighbors." width="672" />
<p class="caption">
Figure 2.3: Dependence of validation error on the value of <span class="math inline">\(K\)</span>, i.e., on the number of neighbors.
</p>
</div>
<p>Now that we know the optimal value of the parameter <span class="math inline">\(K\)</span>, we can build the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb319"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb319-1"><a href="simulace3shift.html#cb319-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb319-2"><a href="simulace3shift.html#cb319-2" tabindex="-1"></a></span>
<span id="cb319-3"><a href="simulace3shift.html#cb319-3" tabindex="-1"></a><span class="co"># Predictions</span></span>
<span id="cb319-4"><a href="simulace3shift.html#cb319-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb319-5"><a href="simulace3shift.html#cb319-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb319-6"><a href="simulace3shift.html#cb319-6" tabindex="-1"></a></span>
<span id="cb319-7"><a href="simulace3shift.html#cb319-7" tabindex="-1"></a><span class="co"># summary(neighb.model)</span></span>
<span id="cb319-8"><a href="simulace3shift.html#cb319-8" tabindex="-1"></a></span>
<span id="cb319-9"><a href="simulace3shift.html#cb319-9" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb319-10"><a href="simulace3shift.html#cb319-10" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb319-11"><a href="simulace3shift.html#cb319-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb319-12"><a href="simulace3shift.html#cb319-12" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb319-13"><a href="simulace3shift.html#cb319-13" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb319-14"><a href="simulace3shift.html#cb319-14" tabindex="-1"></a><span class="co"># Error rate</span></span>
<span id="cb319-15"><a href="simulace3shift.html#cb319-15" tabindex="-1"></a><span class="co"># 1 - accuracy</span></span></code></pre></div>
</details>
<p>Thus, we see that the error rate of the model constructed using the <span class="math inline">\(K\)</span> nearest neighbors method with the optimal choice <span class="math inline">\(K_{optimal}\)</span> equal to 5, which we determined through cross-validation, is 0.3571 on the training data and 0.3833 on the test data.</p>
<p>To compare the individual models, we can use both types of error rates. For clarity, we will store them in a table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb320"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb320-1"><a href="simulace3shift.html#cb320-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb320-2"><a href="simulace3shift.html#cb320-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb320-3"><a href="simulace3shift.html#cb320-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-2" class="section level3 hasAnchor" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Linear Discriminant Analysis<a href="simulace3shift.html#linear-discriminant-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied directly to functional data, we first need to discretize it using Functional Principal Component Analysis (FPCA). The classification algorithm will then be performed on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>Let’s first perform the functional principal component analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb321"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb321-1"><a href="simulace3shift.html#cb321-1" tabindex="-1"></a><span class="co"># Principal component analysis</span></span>
<span id="cb321-2"><a href="simulace3shift.html#cb321-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of principal components</span></span>
<span id="cb321-3"><a href="simulace3shift.html#cb321-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determine p</span></span>
<span id="cb321-4"><a href="simulace3shift.html#cb321-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb321-5"><a href="simulace3shift.html#cb321-5" tabindex="-1"></a></span>
<span id="cb321-6"><a href="simulace3shift.html#cb321-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb321-7"><a href="simulace3shift.html#cb321-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p principal components</span></span>
<span id="cb321-8"><a href="simulace3shift.html#cb321-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># membership to classes</span></span></code></pre></div>
</details>
<p>In this specific case, we have taken the number of principal components as <span class="math inline">\(p\)</span> = 2, which together explain 98.72 % of the variability in the data. The first principal component explains 98.2 % and the second 0.52 % of the variability. We can graphically display the scores of the first two principal components, color-coded by classification class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb322"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb322-1"><a href="simulace3shift.html#cb322-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb322-2"><a href="simulace3shift.html#cb322-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb322-3"><a href="simulace3shift.html#cb322-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variability&#39;</span>, </span>
<span id="cb322-4"><a href="simulace3shift.html#cb322-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb322-5"><a href="simulace3shift.html#cb322-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb322-6"><a href="simulace3shift.html#cb322-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb322-7"><a href="simulace3shift.html#cb322-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb322-8"><a href="simulace3shift.html#cb322-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb322-9"><a href="simulace3shift.html#cb322-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-28-1.png" alt="Scores of the first two principal components for the training data. Points are color-coded based on class membership." width="672" />
<p class="caption">
Figure 2.4: Scores of the first two principal components for the training data. Points are color-coded based on class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to compute the scores for the first 2 principal components for the test data. These scores can be calculated using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span></p>
<p>where <span class="math inline">\(\mu(t)\)</span> is the mean function (average function) and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb323"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb323-1"><a href="simulace3shift.html#cb323-1" tabindex="-1"></a><span class="co"># Calculate scores for the test functions</span></span>
<span id="cb323-2"><a href="simulace3shift.html#cb323-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix </span></span>
<span id="cb323-3"><a href="simulace3shift.html#cb323-3" tabindex="-1"></a></span>
<span id="cb323-4"><a href="simulace3shift.html#cb323-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb323-5"><a href="simulace3shift.html#cb323-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb323-6"><a href="simulace3shift.html#cb323-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb323-7"><a href="simulace3shift.html#cb323-7" tabindex="-1"></a>  <span class="co"># scalar product of the residual and eigenfunctions rho (functional principal components)</span></span>
<span id="cb323-8"><a href="simulace3shift.html#cb323-8" tabindex="-1"></a>}</span>
<span id="cb323-9"><a href="simulace3shift.html#cb323-9" tabindex="-1"></a></span>
<span id="cb323-10"><a href="simulace3shift.html#cb323-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb323-11"><a href="simulace3shift.html#cb323-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb323-12"><a href="simulace3shift.html#cb323-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct a classifier on the training portion of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb324"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb324-1"><a href="simulace3shift.html#cb324-1" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb324-2"><a href="simulace3shift.html#cb324-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb324-3"><a href="simulace3shift.html#cb324-3" tabindex="-1"></a></span>
<span id="cb324-4"><a href="simulace3shift.html#cb324-4" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb324-5"><a href="simulace3shift.html#cb324-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb324-6"><a href="simulace3shift.html#cb324-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb324-7"><a href="simulace3shift.html#cb324-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb324-8"><a href="simulace3shift.html#cb324-8" tabindex="-1"></a></span>
<span id="cb324-9"><a href="simulace3shift.html#cb324-9" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb324-10"><a href="simulace3shift.html#cb324-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb324-11"><a href="simulace3shift.html#cb324-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb324-12"><a href="simulace3shift.html#cb324-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (41.43 %) as well as on the test data (40 %).</p>
<p>To visually illustrate the method, we can mark the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb325"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb325-1"><a href="simulace3shift.html#cb325-1" tabindex="-1"></a><span class="co"># Add decision boundary</span></span>
<span id="cb325-2"><a href="simulace3shift.html#cb325-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb325-3"><a href="simulace3shift.html#cb325-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb325-4"><a href="simulace3shift.html#cb325-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb325-5"><a href="simulace3shift.html#cb325-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb325-6"><a href="simulace3shift.html#cb325-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb325-7"><a href="simulace3shift.html#cb325-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb325-8"><a href="simulace3shift.html#cb325-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb325-9"><a href="simulace3shift.html#cb325-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb325-10"><a href="simulace3shift.html#cb325-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb325-11"><a href="simulace3shift.html#cb325-11" tabindex="-1"></a><span class="co"># if p = 3</span></span>
<span id="cb325-12"><a href="simulace3shift.html#cb325-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb325-13"><a href="simulace3shift.html#cb325-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb325-14"><a href="simulace3shift.html#cb325-14" tabindex="-1"></a><span class="co"># if p = 4</span></span>
<span id="cb325-15"><a href="simulace3shift.html#cb325-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb325-16"><a href="simulace3shift.html#cb325-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb325-17"><a href="simulace3shift.html#cb325-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb325-18"><a href="simulace3shift.html#cb325-18" tabindex="-1"></a><span class="co"># if p = 5</span></span>
<span id="cb325-19"><a href="simulace3shift.html#cb325-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb325-20"><a href="simulace3shift.html#cb325-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb325-21"><a href="simulace3shift.html#cb325-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb325-22"><a href="simulace3shift.html#cb325-22" tabindex="-1"></a></span>
<span id="cb325-23"><a href="simulace3shift.html#cb325-23" tabindex="-1"></a><span class="co"># Add Y = 0, 1</span></span>
<span id="cb325-24"><a href="simulace3shift.html#cb325-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb325-25"><a href="simulace3shift.html#cb325-25" tabindex="-1"></a></span>
<span id="cb325-26"><a href="simulace3shift.html#cb325-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb325-27"><a href="simulace3shift.html#cb325-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb325-28"><a href="simulace3shift.html#cb325-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variability&#39;</span>, </span>
<span id="cb325-29"><a href="simulace3shift.html#cb325-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb325-30"><a href="simulace3shift.html#cb325-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb325-31"><a href="simulace3shift.html#cb325-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb325-32"><a href="simulace3shift.html#cb325-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb325-33"><a href="simulace3shift.html#cb325-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb325-34"><a href="simulace3shift.html#cb325-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb325-35"><a href="simulace3shift.html#cb325-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-31-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is shown in black." width="672" />
<p class="caption">
Figure 2.5: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is shown in black.
</p>
</div>
<p>We observe that the decision boundary is a line, a linear function in 2D space, which we expected from LDA. Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb326"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb326-1"><a href="simulace3shift.html#cb326-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb326-2"><a href="simulace3shift.html#cb326-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb326-3"><a href="simulace3shift.html#cb326-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb326-4"><a href="simulace3shift.html#cb326-4" tabindex="-1"></a></span>
<span id="cb326-5"><a href="simulace3shift.html#cb326-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-2" class="section level3 hasAnchor" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Quadratic Discriminant Analysis<a href="simulace3shift.html#quadratic-discriminant-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s construct a classifier using Quadratic Discriminant Analysis (QDA). This is an analogous case to LDA, with the difference that we now allow for different covariance matrices of the normal distribution for each class from which the corresponding scores originate. This dropped assumption of equal covariance matrices leads to a quadratic boundary between classes.</p>
<p>In <code>R</code>, QDA is performed similarly to LDA in the previous section, meaning we would again calculate scores for both training and test functions using functional principal component analysis. We will construct the classifier on the scores of the first <span class="math inline">\(p\)</span> principal components and use it to predict the class membership of the test curves as <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>We do not need to perform functional PCA; we will use the results from the LDA section.</p>
<p>We can now proceed directly to constructing the classifier using the <code>qda()</code> function. Subsequently, we will calculate the accuracy of the classifier on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb327"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb327-1"><a href="simulace3shift.html#cb327-1" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb327-2"><a href="simulace3shift.html#cb327-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb327-3"><a href="simulace3shift.html#cb327-3" tabindex="-1"></a></span>
<span id="cb327-4"><a href="simulace3shift.html#cb327-4" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb327-5"><a href="simulace3shift.html#cb327-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb327-6"><a href="simulace3shift.html#cb327-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb327-7"><a href="simulace3shift.html#cb327-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb327-8"><a href="simulace3shift.html#cb327-8" tabindex="-1"></a>  </span>
<span id="cb327-9"><a href="simulace3shift.html#cb327-9" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb327-10"><a href="simulace3shift.html#cb327-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb327-11"><a href="simulace3shift.html#cb327-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb327-12"><a href="simulace3shift.html#cb327-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we have calculated the error rate of the classifier on the training data (35.71 %) as well as on the test data (40 %).</p>
<p>To visually illustrate the method, we can mark the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just like in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb328"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb328-1"><a href="simulace3shift.html#cb328-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb328-2"><a href="simulace3shift.html#cb328-2" tabindex="-1"></a></span>
<span id="cb328-3"><a href="simulace3shift.html#cb328-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb328-4"><a href="simulace3shift.html#cb328-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb328-5"><a href="simulace3shift.html#cb328-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variability&#39;</span>, </span>
<span id="cb328-6"><a href="simulace3shift.html#cb328-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb328-7"><a href="simulace3shift.html#cb328-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb328-8"><a href="simulace3shift.html#cb328-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb328-9"><a href="simulace3shift.html#cb328-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb328-10"><a href="simulace3shift.html#cb328-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb328-11"><a href="simulace3shift.html#cb328-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb328-12"><a href="simulace3shift.html#cb328-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-37-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is shown in black." width="672" />
<p class="caption">
Figure 2.6: Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is shown in black.
</p>
</div>
<p>Note that the decision boundary between classification classes is now a parabola.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb329"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb329-1"><a href="simulace3shift.html#cb329-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb329-2"><a href="simulace3shift.html#cb329-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb329-3"><a href="simulace3shift.html#cb329-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb329-4"><a href="simulace3shift.html#cb329-4" tabindex="-1"></a></span>
<span id="cb329-5"><a href="simulace3shift.html#cb329-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-2" class="section level3 hasAnchor" number="3.3.4">
<h3><span class="header-section-number">3.3.4</span> Logistic Regression<a href="simulace3shift.html#logistic-regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression can be performed in two ways:
1. Using the functional analogue of classical logistic regression,
2. Using classical multidimensional logistic regression applied to the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-2" class="section level4 hasAnchor" number="3.3.4.1">
<h4><span class="header-section-number">3.3.4.1</span> Functional Logistic Regression<a href="simulace3shift.html#functional-logistic-regression-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analogous to the case of finite-dimensional input data, we consider a logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text{ d} t,
\]</span></p>
<p>where <span class="math inline">\(\eta(x)\)</span> is a linear predictor taking values in the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is a <em>link function</em> (in the case of logistic regression, this is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>), and <span class="math inline">\(\pi(x)\)</span> is the conditional probability:</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text{e}^{\alpha + \int \beta(t)\cdot x(t) \text{ d} t}}{1 + \text{e}^{\alpha + \int \beta(t)\cdot x(t) \text{ d} t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is a parameterized function. Our goal is to estimate this parameterized function.</p>
<p>For functional logistic regression, we will use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package. First, we will create appropriate objects for the construction of the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb330"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb330-1"><a href="simulace3shift.html#cb330-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb330-2"><a href="simulace3shift.html#cb330-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb330-3"><a href="simulace3shift.html#cb330-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb330-4"><a href="simulace3shift.html#cb330-4" tabindex="-1"></a></span>
<span id="cb330-5"><a href="simulace3shift.html#cb330-5" tabindex="-1"></a><span class="co"># Points at which functions are evaluated</span></span>
<span id="cb330-6"><a href="simulace3shift.html#cb330-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb330-7"><a href="simulace3shift.html#cb330-7" tabindex="-1"></a></span>
<span id="cb330-8"><a href="simulace3shift.html#cb330-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb330-9"><a href="simulace3shift.html#cb330-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb330-10"><a href="simulace3shift.html#cb330-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb330-11"><a href="simulace3shift.html#cb330-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span></code></pre></div>
</details>
<p>To estimate the parameterized function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in our case, a B-spline basis. However, we need to find an appropriate number of basis functions. This could be determined based on the error rate on the training data, but this data would favor the selection of a large number of bases, leading to model overfitting.</p>
<p>Let’s illustrate this with the following case. For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 50\}\)</span>, we will train a model on the training data, determine the error rate on them, and also calculate the error rate on the test data. Remember, we cannot use the same data to estimate the test error rate, as this would underestimate it.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb331"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb331-1"><a href="simulace3shift.html#cb331-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb331-2"><a href="simulace3shift.html#cb331-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb331-3"><a href="simulace3shift.html#cb331-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb331-4"><a href="simulace3shift.html#cb331-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb331-5"><a href="simulace3shift.html#cb331-5" tabindex="-1"></a></span>
<span id="cb331-6"><a href="simulace3shift.html#cb331-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb331-7"><a href="simulace3shift.html#cb331-7" tabindex="-1"></a>  <span class="co"># Basis for betas</span></span>
<span id="cb331-8"><a href="simulace3shift.html#cb331-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb331-9"><a href="simulace3shift.html#cb331-9" tabindex="-1"></a>  <span class="co"># Relationship</span></span>
<span id="cb331-10"><a href="simulace3shift.html#cb331-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb331-11"><a href="simulace3shift.html#cb331-11" tabindex="-1"></a>  <span class="co"># Basis for x and betas</span></span>
<span id="cb331-12"><a href="simulace3shift.html#cb331-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb331-13"><a href="simulace3shift.html#cb331-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb331-14"><a href="simulace3shift.html#cb331-14" tabindex="-1"></a>  <span class="co"># Input data for the model</span></span>
<span id="cb331-15"><a href="simulace3shift.html#cb331-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb331-16"><a href="simulace3shift.html#cb331-16" tabindex="-1"></a>  <span class="co"># Binomial model ... logistic regression model</span></span>
<span id="cb331-17"><a href="simulace3shift.html#cb331-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb331-18"><a href="simulace3shift.html#cb331-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb331-19"><a href="simulace3shift.html#cb331-19" tabindex="-1"></a>  </span>
<span id="cb331-20"><a href="simulace3shift.html#cb331-20" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb331-21"><a href="simulace3shift.html#cb331-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb331-22"><a href="simulace3shift.html#cb331-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb331-23"><a href="simulace3shift.html#cb331-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb331-24"><a href="simulace3shift.html#cb331-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb331-25"><a href="simulace3shift.html#cb331-25" tabindex="-1"></a>    </span>
<span id="cb331-26"><a href="simulace3shift.html#cb331-26" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb331-27"><a href="simulace3shift.html#cb331-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb331-28"><a href="simulace3shift.html#cb331-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb331-29"><a href="simulace3shift.html#cb331-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb331-30"><a href="simulace3shift.html#cb331-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb331-31"><a href="simulace3shift.html#cb331-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb331-32"><a href="simulace3shift.html#cb331-32" tabindex="-1"></a>  </span>
<span id="cb331-33"><a href="simulace3shift.html#cb331-33" tabindex="-1"></a>  <span class="co"># Store in matrix</span></span>
<span id="cb331-34"><a href="simulace3shift.html#cb331-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb331-35"><a href="simulace3shift.html#cb331-35" tabindex="-1"></a>} </span>
<span id="cb331-36"><a href="simulace3shift.html#cb331-36" tabindex="-1"></a></span>
<span id="cb331-37"><a href="simulace3shift.html#cb331-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb331-38"><a href="simulace3shift.html#cb331-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s illustrate the relationship between both types of error rates in a graph, depending on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb332"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb332-1"><a href="simulace3shift.html#cb332-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb332-2"><a href="simulace3shift.html#cb332-2" tabindex="-1"></a></span>
<span id="cb332-3"><a href="simulace3shift.html#cb332-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb332-4"><a href="simulace3shift.html#cb332-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb332-5"><a href="simulace3shift.html#cb332-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb332-6"><a href="simulace3shift.html#cb332-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb332-7"><a href="simulace3shift.html#cb332-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb332-8"><a href="simulace3shift.html#cb332-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb332-9"><a href="simulace3shift.html#cb332-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb332-10"><a href="simulace3shift.html#cb332-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb332-11"><a href="simulace3shift.html#cb332-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb332-12"><a href="simulace3shift.html#cb332-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb332-13"><a href="simulace3shift.html#cb332-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb332-14"><a href="simulace3shift.html#cb332-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb332-15"><a href="simulace3shift.html#cb332-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error Rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 47 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-41"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-41-1.png" alt="Dependence of test and training error rates on the number of basis functions for $\beta$. The red point indicates the optimal number $n_{optimal}$ chosen as the minimum of the test error rate, the black line represents the test error rate, and the blue dashed line shows the trend of the training error rate." width="672" />
<p class="caption">
Figure 2.7: Dependence of test and training error rates on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red point indicates the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum of the test error rate, the black line represents the test error rate, and the blue dashed line shows the trend of the training error rate.
</p>
</div>
<p>As we can see, as the number of basis functions for <span class="math inline">\(\beta(t)\)</span> increases, the training error rate (blue line) tends to decrease, suggesting that we would choose large values of <span class="math inline">\(n_{basis}\)</span> based on this. Conversely, the optimal choice based on the test error rate is <span class="math inline">\(n = 29\)</span>, which is significantly smaller than 50. In contrast, as <span class="math inline">\(n\)</span> increases, the test error rate rises, indicating model overfitting.</p>
<p>For these reasons, we will use 10-fold cross-validation to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>. The maximum number of basis functions considered will be 25, as we observed earlier that exceeding this number leads to model overfitting.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb335"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb335-1"><a href="simulace3shift.html#cb335-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb335-2"><a href="simulace3shift.html#cb335-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb335-3"><a href="simulace3shift.html#cb335-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb335-4"><a href="simulace3shift.html#cb335-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb335-5"><a href="simulace3shift.html#cb335-5" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb335-6"><a href="simulace3shift.html#cb335-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb335-7"><a href="simulace3shift.html#cb335-7" tabindex="-1"></a><span class="co"># Unchanging elements during the loop</span></span>
<span id="cb335-8"><a href="simulace3shift.html#cb335-8" tabindex="-1"></a><span class="co"># Points at which functions are evaluated</span></span>
<span id="cb335-9"><a href="simulace3shift.html#cb335-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb335-10"><a href="simulace3shift.html#cb335-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb335-11"><a href="simulace3shift.html#cb335-11" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb335-12"><a href="simulace3shift.html#cb335-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb335-13"><a href="simulace3shift.html#cb335-13" tabindex="-1"></a><span class="co"># Relationship</span></span>
<span id="cb335-14"><a href="simulace3shift.html#cb335-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb335-15"><a href="simulace3shift.html#cb335-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb335-16"><a href="simulace3shift.html#cb335-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb335-17"><a href="simulace3shift.html#cb335-17" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb335-18"><a href="simulace3shift.html#cb335-18" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for each part of the training set</span></span>
<span id="cb335-19"><a href="simulace3shift.html#cb335-19" tabindex="-1"></a><span class="co"># Rows will contain values for the given number of bases</span></span>
<span id="cb335-20"><a href="simulace3shift.html#cb335-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb335-21"><a href="simulace3shift.html#cb335-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now we are ready to calculate the error rate on each of the ten subsets of the training set. Next, we will determine the average and take the argument of the minimum validation error rate as optimal <span class="math inline">\(n\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb336"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb336-1"><a href="simulace3shift.html#cb336-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb336-2"><a href="simulace3shift.html#cb336-2" tabindex="-1"></a>  <span class="co"># Define the given index set</span></span>
<span id="cb336-3"><a href="simulace3shift.html#cb336-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb336-4"><a href="simulace3shift.html#cb336-4" tabindex="-1"></a>    </span>
<span id="cb336-5"><a href="simulace3shift.html#cb336-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb336-6"><a href="simulace3shift.html#cb336-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb336-7"><a href="simulace3shift.html#cb336-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb336-8"><a href="simulace3shift.html#cb336-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb336-9"><a href="simulace3shift.html#cb336-9" tabindex="-1"></a>  </span>
<span id="cb336-10"><a href="simulace3shift.html#cb336-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb336-11"><a href="simulace3shift.html#cb336-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb336-12"><a href="simulace3shift.html#cb336-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb336-13"><a href="simulace3shift.html#cb336-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb336-14"><a href="simulace3shift.html#cb336-14" tabindex="-1"></a>  </span>
<span id="cb336-15"><a href="simulace3shift.html#cb336-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb336-16"><a href="simulace3shift.html#cb336-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb336-17"><a href="simulace3shift.html#cb336-17" tabindex="-1"></a>  </span>
<span id="cb336-18"><a href="simulace3shift.html#cb336-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb336-19"><a href="simulace3shift.html#cb336-19" tabindex="-1"></a>    <span class="co"># Basis for betas</span></span>
<span id="cb336-20"><a href="simulace3shift.html#cb336-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb336-21"><a href="simulace3shift.html#cb336-21" tabindex="-1"></a>    </span>
<span id="cb336-22"><a href="simulace3shift.html#cb336-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb336-23"><a href="simulace3shift.html#cb336-23" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb336-24"><a href="simulace3shift.html#cb336-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb336-25"><a href="simulace3shift.html#cb336-25" tabindex="-1"></a>    <span class="co"># Binomial model ... logistic regression model</span></span>
<span id="cb336-26"><a href="simulace3shift.html#cb336-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb336-27"><a href="simulace3shift.html#cb336-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb336-28"><a href="simulace3shift.html#cb336-28" tabindex="-1"></a>    </span>
<span id="cb336-29"><a href="simulace3shift.html#cb336-29" tabindex="-1"></a>    <span class="co"># Accuracy on validation part </span></span>
<span id="cb336-30"><a href="simulace3shift.html#cb336-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb336-31"><a href="simulace3shift.html#cb336-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb336-32"><a href="simulace3shift.html#cb336-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb336-33"><a href="simulace3shift.html#cb336-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb336-34"><a href="simulace3shift.html#cb336-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb336-35"><a href="simulace3shift.html#cb336-35" tabindex="-1"></a>    </span>
<span id="cb336-36"><a href="simulace3shift.html#cb336-36" tabindex="-1"></a>    <span class="co"># Store in matrix</span></span>
<span id="cb336-37"><a href="simulace3shift.html#cb336-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb336-38"><a href="simulace3shift.html#cb336-38" tabindex="-1"></a>  } </span>
<span id="cb336-39"><a href="simulace3shift.html#cb336-39" tabindex="-1"></a>}</span>
<span id="cb336-40"><a href="simulace3shift.html#cb336-40" tabindex="-1"></a></span>
<span id="cb336-41"><a href="simulace3shift.html#cb336-41" tabindex="-1"></a><span class="co"># Calculate the average accuracies for each n over folds</span></span>
<span id="cb336-42"><a href="simulace3shift.html#cb336-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb336-43"><a href="simulace3shift.html#cb336-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb336-44"><a href="simulace3shift.html#cb336-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb336-45"><a href="simulace3shift.html#cb336-45" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>Let’s also plot the validation error rate along with the highlighted optimal value <span class="math inline">\(n_{optimal}\)</span> as 11 with validation error rate 0.072.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb337"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb337-1"><a href="simulace3shift.html#cb337-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb337-2"><a href="simulace3shift.html#cb337-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb337-3"><a href="simulace3shift.html#cb337-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb337-4"><a href="simulace3shift.html#cb337-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb337-5"><a href="simulace3shift.html#cb337-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb337-6"><a href="simulace3shift.html#cb337-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb337-7"><a href="simulace3shift.html#cb337-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb337-8"><a href="simulace3shift.html#cb337-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb337-9"><a href="simulace3shift.html#cb337-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb337-10"><a href="simulace3shift.html#cb337-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 22 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-44-1.png" alt="Dependence of validation error rate on the value of $n_{basis}$, that is, on the number of bases." width="672" />
<p class="caption">
Figure 2.8: Dependence of validation error rate on the value of <span class="math inline">\(n_{basis}\)</span>, that is, on the number of bases.
</p>
</div>
<p>Now we can define the final model using functional logistic regression, choosing a B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 11 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb339"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb339-1"><a href="simulace3shift.html#cb339-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb339-2"><a href="simulace3shift.html#cb339-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb339-3"><a href="simulace3shift.html#cb339-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb339-4"><a href="simulace3shift.html#cb339-4" tabindex="-1"></a><span class="co"># Bases for x and betas</span></span>
<span id="cb339-5"><a href="simulace3shift.html#cb339-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb339-6"><a href="simulace3shift.html#cb339-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb339-7"><a href="simulace3shift.html#cb339-7" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb339-8"><a href="simulace3shift.html#cb339-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb339-9"><a href="simulace3shift.html#cb339-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb339-10"><a href="simulace3shift.html#cb339-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb339-11"><a href="simulace3shift.html#cb339-11" tabindex="-1"></a><span class="co"># Binomial model ... logistic regression model</span></span>
<span id="cb339-12"><a href="simulace3shift.html#cb339-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb339-13"><a href="simulace3shift.html#cb339-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb339-14"><a href="simulace3shift.html#cb339-14" tabindex="-1"></a></span>
<span id="cb339-15"><a href="simulace3shift.html#cb339-15" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb339-16"><a href="simulace3shift.html#cb339-16" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb339-17"><a href="simulace3shift.html#cb339-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb339-18"><a href="simulace3shift.html#cb339-18" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb339-19"><a href="simulace3shift.html#cb339-19" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb339-20"><a href="simulace3shift.html#cb339-20" tabindex="-1"></a>  </span>
<span id="cb339-21"><a href="simulace3shift.html#cb339-21" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb339-22"><a href="simulace3shift.html#cb339-22" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb339-23"><a href="simulace3shift.html#cb339-23" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb339-24"><a href="simulace3shift.html#cb339-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb339-25"><a href="simulace3shift.html#cb339-25" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb339-26"><a href="simulace3shift.html#cb339-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the training error rate (which is 3.57 %) and the test error rate (which is 8.33 %). To better visualize the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> on the training data in relation to the values of the linear predictor, we can plot:</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb340"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb340-1"><a href="simulace3shift.html#cb340-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb340-2"><a href="simulace3shift.html#cb340-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb340-3"><a href="simulace3shift.html#cb340-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb340-4"><a href="simulace3shift.html#cb340-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb340-5"><a href="simulace3shift.html#cb340-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb340-6"><a href="simulace3shift.html#cb340-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb340-7"><a href="simulace3shift.html#cb340-7" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb340-8"><a href="simulace3shift.html#cb340-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb340-9"><a href="simulace3shift.html#cb340-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb340-10"><a href="simulace3shift.html#cb340-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb340-11"><a href="simulace3shift.html#cb340-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probabilities Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb340-12"><a href="simulace3shift.html#cb340-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-46-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 1.15: Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to class membership.
</p>
</div>
<p>We can also visualize the estimated parametric function <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb341"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb341-1"><a href="simulace3shift.html#cb341-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb341-2"><a href="simulace3shift.html#cb341-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb341-3"><a href="simulace3shift.html#cb341-3" tabindex="-1"></a></span>
<span id="cb341-4"><a href="simulace3shift.html#cb341-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb341-5"><a href="simulace3shift.html#cb341-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb341-6"><a href="simulace3shift.html#cb341-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb341-7"><a href="simulace3shift.html#cb341-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb341-8"><a href="simulace3shift.html#cb341-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb341-9"><a href="simulace3shift.html#cb341-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb341-10"><a href="simulace3shift.html#cb341-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb341-11"><a href="simulace3shift.html#cb341-11" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb341-12"><a href="simulace3shift.html#cb341-12" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-47"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-47-1.png" alt="Plot of the estimated parametric function $\beta(t), t \in [0, 6]$." width="672" />
<p class="caption">
Figure 2.9: Plot of the estimated parametric function <span class="math inline">\(\beta(t), t \in [0, 6]\)</span>.
</p>
</div>
<p>Finally, we will summarize the results in a summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb342"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb342-1"><a href="simulace3shift.html#cb342-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb342-2"><a href="simulace3shift.html#cb342-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb342-3"><a href="simulace3shift.html#cb342-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb342-4"><a href="simulace3shift.html#cb342-4" tabindex="-1"></a></span>
<span id="cb342-5"><a href="simulace3shift.html#cb342-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-2" class="section level3 hasAnchor" number="3.3.5">
<h3><span class="header-section-number">3.3.5</span> Support Vector Machines<a href="simulace3shift.html#support-vector-machines-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>We will define data for the next methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb343"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb343-1"><a href="simulace3shift.html#cb343-1" tabindex="-1"></a><span class="co"># Sequence of points where we will evaluate the function</span></span>
<span id="cb343-2"><a href="simulace3shift.html#cb343-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb343-3"><a href="simulace3shift.html#cb343-3" tabindex="-1"></a>   </span>
<span id="cb343-4"><a href="simulace3shift.html#cb343-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb343-5"><a href="simulace3shift.html#cb343-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># Transpose for functions in rows</span></span>
<span id="cb343-6"><a href="simulace3shift.html#cb343-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb343-7"><a href="simulace3shift.html#cb343-7" tabindex="-1"></a></span>
<span id="cb343-8"><a href="simulace3shift.html#cb343-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb343-9"><a href="simulace3shift.html#cb343-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb343-10"><a href="simulace3shift.html#cb343-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>First, let’s define the necessary datasets with coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb344"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb344-1"><a href="simulace3shift.html#cb344-1" tabindex="-1"></a><span class="co"># Training dataset</span></span>
<span id="cb344-2"><a href="simulace3shift.html#cb344-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb344-3"><a href="simulace3shift.html#cb344-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb344-4"><a href="simulace3shift.html#cb344-4" tabindex="-1"></a></span>
<span id="cb344-5"><a href="simulace3shift.html#cb344-5" tabindex="-1"></a><span class="co"># Test dataset</span></span>
<span id="cb344-6"><a href="simulace3shift.html#cb344-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb344-7"><a href="simulace3shift.html#cb344-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now let’s look at the classification of our simulated curves using Support Vector Machines (SVM). The advantage of this classification method is its computational efficiency, as it uses only a few observations (often very few) to define the decision boundary between classes.</p>
<div id="discretization-of-the-interval-1" class="section level4 hasAnchor" number="3.3.5.1">
<h4><span class="header-section-number">3.3.5.1</span> Discretization of the Interval<a href="simulace3shift.html#discretization-of-the-interval-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start by applying the SVM method directly to the discretized data (evaluating the function on a given grid of points in the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three aforementioned kernel functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb345"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb345-1"><a href="simulace3shift.html#cb345-1" tabindex="-1"></a><span class="co"># Set norm equal to one</span></span>
<span id="cb345-2"><a href="simulace3shift.html#cb345-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb345-3"><a href="simulace3shift.html#cb345-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb345-4"><a href="simulace3shift.html#cb345-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb345-5"><a href="simulace3shift.html#cb345-5" tabindex="-1"></a>}</span>
<span id="cb345-6"><a href="simulace3shift.html#cb345-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb345-7"><a href="simulace3shift.html#cb345-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb345-8"><a href="simulace3shift.html#cb345-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb345-9"><a href="simulace3shift.html#cb345-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb345-10"><a href="simulace3shift.html#cb345-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> T)</span>
<span id="cb345-11"><a href="simulace3shift.html#cb345-11" tabindex="-1"></a></span>
<span id="cb345-12"><a href="simulace3shift.html#cb345-12" tabindex="-1"></a><span class="co"># Split into training and test sets</span></span>
<span id="cb345-13"><a href="simulace3shift.html#cb345-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb345-14"><a href="simulace3shift.html#cb345-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb345-15"><a href="simulace3shift.html#cb345-15" tabindex="-1"></a></span>
<span id="cb345-16"><a href="simulace3shift.html#cb345-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb345-17"><a href="simulace3shift.html#cb345-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb345-18"><a href="simulace3shift.html#cb345-18" tabindex="-1"></a></span>
<span id="cb345-19"><a href="simulace3shift.html#cb345-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb345-20"><a href="simulace3shift.html#cb345-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb345-21"><a href="simulace3shift.html#cb345-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb345-22"><a href="simulace3shift.html#cb345-22" tabindex="-1"></a></span>
<span id="cb345-23"><a href="simulace3shift.html#cb345-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb345-24"><a href="simulace3shift.html#cb345-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb345-25"><a href="simulace3shift.html#cb345-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb346"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb346-1"><a href="simulace3shift.html#cb346-1" tabindex="-1"></a><span class="co"># Build models</span></span>
<span id="cb346-2"><a href="simulace3shift.html#cb346-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb346-3"><a href="simulace3shift.html#cb346-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb346-4"><a href="simulace3shift.html#cb346-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb346-5"><a href="simulace3shift.html#cb346-5" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb346-6"><a href="simulace3shift.html#cb346-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb346-7"><a href="simulace3shift.html#cb346-7" tabindex="-1"></a></span>
<span id="cb346-8"><a href="simulace3shift.html#cb346-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb346-9"><a href="simulace3shift.html#cb346-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb346-10"><a href="simulace3shift.html#cb346-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb346-11"><a href="simulace3shift.html#cb346-11" tabindex="-1"></a>                 <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb346-12"><a href="simulace3shift.html#cb346-12" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb346-13"><a href="simulace3shift.html#cb346-13" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb346-14"><a href="simulace3shift.html#cb346-14" tabindex="-1"></a></span>
<span id="cb346-15"><a href="simulace3shift.html#cb346-15" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb346-16"><a href="simulace3shift.html#cb346-16" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb346-17"><a href="simulace3shift.html#cb346-17" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb346-18"><a href="simulace3shift.html#cb346-18" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb346-19"><a href="simulace3shift.html#cb346-19" tabindex="-1"></a>                 <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb346-20"><a href="simulace3shift.html#cb346-20" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb346-21"><a href="simulace3shift.html#cb346-21" tabindex="-1"></a></span>
<span id="cb346-22"><a href="simulace3shift.html#cb346-22" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb346-23"><a href="simulace3shift.html#cb346-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb346-24"><a href="simulace3shift.html#cb346-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb346-25"><a href="simulace3shift.html#cb346-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb346-26"><a href="simulace3shift.html#cb346-26" tabindex="-1"></a></span>
<span id="cb346-27"><a href="simulace3shift.html#cb346-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb346-28"><a href="simulace3shift.html#cb346-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb346-29"><a href="simulace3shift.html#cb346-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb346-30"><a href="simulace3shift.html#cb346-30" tabindex="-1"></a></span>
<span id="cb346-31"><a href="simulace3shift.html#cb346-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb346-32"><a href="simulace3shift.html#cb346-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb346-33"><a href="simulace3shift.html#cb346-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb346-34"><a href="simulace3shift.html#cb346-34" tabindex="-1"></a></span>
<span id="cb346-35"><a href="simulace3shift.html#cb346-35" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb346-36"><a href="simulace3shift.html#cb346-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb346-37"><a href="simulace3shift.html#cb346-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb346-38"><a href="simulace3shift.html#cb346-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb346-39"><a href="simulace3shift.html#cb346-39" tabindex="-1"></a></span>
<span id="cb346-40"><a href="simulace3shift.html#cb346-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb346-41"><a href="simulace3shift.html#cb346-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb346-42"><a href="simulace3shift.html#cb346-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb346-43"><a href="simulace3shift.html#cb346-43" tabindex="-1"></a></span>
<span id="cb346-44"><a href="simulace3shift.html#cb346-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb346-45"><a href="simulace3shift.html#cb346-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb346-46"><a href="simulace3shift.html#cb346-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 5.71 % for the linear kernel, 2.14 % for the polynomial kernel, and 3.57 % for the radial kernel. On the test data, the error rate is 16.67 % for the linear kernel, 16.67 % for the polynomial kernel, and 13.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb347"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb347-1"><a href="simulace3shift.html#cb347-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discretized&#39;</span>, </span>
<span id="cb347-2"><a href="simulace3shift.html#cb347-2" tabindex="-1"></a>                            <span class="st">&#39;SVM polynomial - discretized&#39;</span>, </span>
<span id="cb347-3"><a href="simulace3shift.html#cb347-3" tabindex="-1"></a>                            <span class="st">&#39;SVM RBF - discretized&#39;</span>), </span>
<span id="cb347-4"><a href="simulace3shift.html#cb347-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb347-5"><a href="simulace3shift.html#cb347-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb347-6"><a href="simulace3shift.html#cb347-6" tabindex="-1"></a></span>
<span id="cb347-7"><a href="simulace3shift.html#cb347-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="principal-component-scores-4" class="section level3 hasAnchor" number="3.3.6">
<h3><span class="header-section-number">3.3.6</span> Principal Component Scores<a href="simulace3shift.html#principal-component-scores-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb348"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb348-1"><a href="simulace3shift.html#cb348-1" tabindex="-1"></a><span class="co"># Model building</span></span>
<span id="cb348-2"><a href="simulace3shift.html#cb348-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb348-3"><a href="simulace3shift.html#cb348-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb348-4"><a href="simulace3shift.html#cb348-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb348-5"><a href="simulace3shift.html#cb348-5" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb348-6"><a href="simulace3shift.html#cb348-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb348-7"><a href="simulace3shift.html#cb348-7" tabindex="-1"></a></span>
<span id="cb348-8"><a href="simulace3shift.html#cb348-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb348-9"><a href="simulace3shift.html#cb348-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb348-10"><a href="simulace3shift.html#cb348-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb348-11"><a href="simulace3shift.html#cb348-11" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb348-12"><a href="simulace3shift.html#cb348-12" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.6</span>,</span>
<span id="cb348-13"><a href="simulace3shift.html#cb348-13" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb348-14"><a href="simulace3shift.html#cb348-14" tabindex="-1"></a></span>
<span id="cb348-15"><a href="simulace3shift.html#cb348-15" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb348-16"><a href="simulace3shift.html#cb348-16" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb348-17"><a href="simulace3shift.html#cb348-17" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb348-18"><a href="simulace3shift.html#cb348-18" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb348-19"><a href="simulace3shift.html#cb348-19" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb348-20"><a href="simulace3shift.html#cb348-20" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb348-21"><a href="simulace3shift.html#cb348-21" tabindex="-1"></a></span>
<span id="cb348-22"><a href="simulace3shift.html#cb348-22" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb348-23"><a href="simulace3shift.html#cb348-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb348-24"><a href="simulace3shift.html#cb348-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb348-25"><a href="simulace3shift.html#cb348-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb348-26"><a href="simulace3shift.html#cb348-26" tabindex="-1"></a></span>
<span id="cb348-27"><a href="simulace3shift.html#cb348-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb348-28"><a href="simulace3shift.html#cb348-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb348-29"><a href="simulace3shift.html#cb348-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb348-30"><a href="simulace3shift.html#cb348-30" tabindex="-1"></a></span>
<span id="cb348-31"><a href="simulace3shift.html#cb348-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb348-32"><a href="simulace3shift.html#cb348-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb348-33"><a href="simulace3shift.html#cb348-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb348-34"><a href="simulace3shift.html#cb348-34" tabindex="-1"></a>  </span>
<span id="cb348-35"><a href="simulace3shift.html#cb348-35" tabindex="-1"></a><span class="co"># Accuracy on testing data</span></span>
<span id="cb348-36"><a href="simulace3shift.html#cb348-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb348-37"><a href="simulace3shift.html#cb348-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb348-38"><a href="simulace3shift.html#cb348-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb348-39"><a href="simulace3shift.html#cb348-39" tabindex="-1"></a></span>
<span id="cb348-40"><a href="simulace3shift.html#cb348-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb348-41"><a href="simulace3shift.html#cb348-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb348-42"><a href="simulace3shift.html#cb348-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb348-43"><a href="simulace3shift.html#cb348-43" tabindex="-1"></a></span>
<span id="cb348-44"><a href="simulace3shift.html#cb348-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb348-45"><a href="simulace3shift.html#cb348-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb348-46"><a href="simulace3shift.html#cb348-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the principal component scores on the training data is thus 44.29 % for the linear kernel, 37.86 % for the polynomial kernel, and 37.14 % for the Gaussian kernel. On the testing data, the error rate of the method is 48.33 % for the linear kernel, 43.33 % for the polynomial kernel, and 40 % for the radial kernel.</p>
<p>To graphically represent the method, we can plot the decision boundary on the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, as done in previous cases when we also plotted classification boundaries.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb349"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb349-1"><a href="simulace3shift.html#cb349-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb349-2"><a href="simulace3shift.html#cb349-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb349-3"><a href="simulace3shift.html#cb349-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb349-4"><a href="simulace3shift.html#cb349-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb349-5"><a href="simulace3shift.html#cb349-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb349-6"><a href="simulace3shift.html#cb349-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb349-7"><a href="simulace3shift.html#cb349-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb349-8"><a href="simulace3shift.html#cb349-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))))</span>
<span id="cb349-9"><a href="simulace3shift.html#cb349-9" tabindex="-1"></a></span>
<span id="cb349-10"><a href="simulace3shift.html#cb349-10" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb349-11"><a href="simulace3shift.html#cb349-11" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb349-12"><a href="simulace3shift.html#cb349-12" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb349-13"><a href="simulace3shift.html#cb349-13" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb349-14"><a href="simulace3shift.html#cb349-14" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb349-15"><a href="simulace3shift.html#cb349-15" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb349-16"><a href="simulace3shift.html#cb349-16" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>, </span>
<span id="cb349-17"><a href="simulace3shift.html#cb349-17" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel type&#39;</span>) <span class="sc">+</span></span>
<span id="cb349-18"><a href="simulace3shift.html#cb349-18" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb349-19"><a href="simulace3shift.html#cb349-19" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb349-20"><a href="simulace3shift.html#cb349-20" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb349-21"><a href="simulace3shift.html#cb349-21" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb349-22"><a href="simulace3shift.html#cb349-22" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb349-23"><a href="simulace3shift.html#cb349-23" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb349-24"><a href="simulace3shift.html#cb349-24" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb349-25"><a href="simulace3shift.html#cb349-25" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-57"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-57-1.png" alt="Scores of the first two principal components, color-coded according to classification class membership. The decision boundary (line or curves in the plane of the first two principal components) between the classes is marked in black, constructed using the SVM method." width="672" />
<p class="caption">
Figure 1.18: Scores of the first two principal components, color-coded according to classification class membership. The decision boundary (line or curves in the plane of the first two principal components) between the classes is marked in black, constructed using the SVM method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb350"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb350-1"><a href="simulace3shift.html#cb350-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb350-2"><a href="simulace3shift.html#cb350-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb350-3"><a href="simulace3shift.html#cb350-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb350-4"><a href="simulace3shift.html#cb350-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb350-5"><a href="simulace3shift.html#cb350-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb350-6"><a href="simulace3shift.html#cb350-6" tabindex="-1"></a></span>
<span id="cb350-7"><a href="simulace3shift.html#cb350-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
<div id="base-coefficients" class="section level4 hasAnchor" number="3.3.6.1">
<h4><span class="header-section-number">3.3.6.1</span> Base Coefficients<a href="simulace3shift.html#base-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use function representation through B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb351"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb351-1"><a href="simulace3shift.html#cb351-1" tabindex="-1"></a><span class="co"># Model building</span></span>
<span id="cb351-2"><a href="simulace3shift.html#cb351-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb351-3"><a href="simulace3shift.html#cb351-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb351-4"><a href="simulace3shift.html#cb351-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb351-5"><a href="simulace3shift.html#cb351-5" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb351-6"><a href="simulace3shift.html#cb351-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb351-7"><a href="simulace3shift.html#cb351-7" tabindex="-1"></a></span>
<span id="cb351-8"><a href="simulace3shift.html#cb351-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb351-9"><a href="simulace3shift.html#cb351-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb351-10"><a href="simulace3shift.html#cb351-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb351-11"><a href="simulace3shift.html#cb351-11" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb351-12"><a href="simulace3shift.html#cb351-12" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb351-13"><a href="simulace3shift.html#cb351-13" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb351-14"><a href="simulace3shift.html#cb351-14" tabindex="-1"></a></span>
<span id="cb351-15"><a href="simulace3shift.html#cb351-15" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb351-16"><a href="simulace3shift.html#cb351-16" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb351-17"><a href="simulace3shift.html#cb351-17" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb351-18"><a href="simulace3shift.html#cb351-18" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb351-19"><a href="simulace3shift.html#cb351-19" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="fl">0.005</span>,</span>
<span id="cb351-20"><a href="simulace3shift.html#cb351-20" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb351-21"><a href="simulace3shift.html#cb351-21" tabindex="-1"></a></span>
<span id="cb351-22"><a href="simulace3shift.html#cb351-22" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb351-23"><a href="simulace3shift.html#cb351-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb351-24"><a href="simulace3shift.html#cb351-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb351-25"><a href="simulace3shift.html#cb351-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb351-26"><a href="simulace3shift.html#cb351-26" tabindex="-1"></a></span>
<span id="cb351-27"><a href="simulace3shift.html#cb351-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb351-28"><a href="simulace3shift.html#cb351-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb351-29"><a href="simulace3shift.html#cb351-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb351-30"><a href="simulace3shift.html#cb351-30" tabindex="-1"></a></span>
<span id="cb351-31"><a href="simulace3shift.html#cb351-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb351-32"><a href="simulace3shift.html#cb351-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb351-33"><a href="simulace3shift.html#cb351-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb351-34"><a href="simulace3shift.html#cb351-34" tabindex="-1"></a>  </span>
<span id="cb351-35"><a href="simulace3shift.html#cb351-35" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb351-36"><a href="simulace3shift.html#cb351-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb351-37"><a href="simulace3shift.html#cb351-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb351-38"><a href="simulace3shift.html#cb351-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb351-39"><a href="simulace3shift.html#cb351-39" tabindex="-1"></a></span>
<span id="cb351-40"><a href="simulace3shift.html#cb351-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb351-41"><a href="simulace3shift.html#cb351-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb351-42"><a href="simulace3shift.html#cb351-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb351-43"><a href="simulace3shift.html#cb351-43" tabindex="-1"></a></span>
<span id="cb351-44"><a href="simulace3shift.html#cb351-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb351-45"><a href="simulace3shift.html#cb351-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb351-46"><a href="simulace3shift.html#cb351-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the base coefficients on the training data is therefore 4.29 % for the linear kernel, 4.29 % for the polynomial kernel, and 7.14 % for the radial kernel. On the test data, the error rate of the method is 10 % for the linear kernel, 11.67 % for the polynomial kernel, and 15 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb352"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb352-1"><a href="simulace3shift.html#cb352-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb352-2"><a href="simulace3shift.html#cb352-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb352-3"><a href="simulace3shift.html#cb352-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb352-4"><a href="simulace3shift.html#cb352-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb352-5"><a href="simulace3shift.html#cb352-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb352-6"><a href="simulace3shift.html#cb352-6" tabindex="-1"></a></span>
<span id="cb352-7"><a href="simulace3shift.html#cb352-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-onto-b-spline-basis-1" class="section level4 hasAnchor" number="3.3.6.2">
<h4><span class="header-section-number">3.3.6.2</span> Projection onto B-Spline Basis<a href="simulace3shift.html#projection-onto-b-spline-basis-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way to apply the classical SVM method to functional data is to project the original data onto a <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal{H}\)</span>, which we denote as <span class="math inline">\(V_d\)</span>. We assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>. We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, which can be expressed as</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Now, we can use the coefficients from the orthogonal projection for classification, applying standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>. By utilizing this transformation, we have defined a new, so-called adapted kernel, which consists of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector method. Thus, we have the (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>. This is a dimensionality reduction method that we can call <em>filtering</em>.</p>
<p>For the projection itself, we will use the <code>project.basis()</code> function from the <code>fda</code> package in <code>R</code>. The input will be a matrix of the original discrete (non-smoothed) data, the values at which we measure the values in the original data matrix, and the basis object onto which we want to project the data. We will choose to project onto the B-spline basis since using a Fourier basis is not suitable for our non-periodic data.</p>
<p>The dimension <span class="math inline">\(d\)</span> is either chosen based on prior expert knowledge or through cross-validation. In our case, we will determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (choosing <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method, often <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span>). We require B-splines of order 4, and the number of basis functions is determined by the relationship</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>. Therefore, we choose a minimum dimension of <span class="math inline">\(n_{basis} = 3\)</span> (for <span class="math inline">\(n_{breaks} = 1\)</span>) and a maximum dimension of <span class="math inline">\(n_{basis} = 53\)</span> (for <span class="math inline">\(n_{breaks} = 51\)</span>, corresponding to the number of original discrete data points). However, in <code>R</code>, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and for large values of <span class="math inline">\(n_{basis}\)</span>, overfitting occurs, so we choose a maximum of <span class="math inline">\(n_{basis} = 43\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb353"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb353-1"><a href="simulace3shift.html#cb353-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb353-2"><a href="simulace3shift.html#cb353-2" tabindex="-1"></a></span>
<span id="cb353-3"><a href="simulace3shift.html#cb353-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb353-4"><a href="simulace3shift.html#cb353-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb353-5"><a href="simulace3shift.html#cb353-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb353-6"><a href="simulace3shift.html#cb353-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb353-7"><a href="simulace3shift.html#cb353-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb353-8"><a href="simulace3shift.html#cb353-8" tabindex="-1"></a></span>
<span id="cb353-9"><a href="simulace3shift.html#cb353-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># All dimensions we want to try</span></span>
<span id="cb353-10"><a href="simulace3shift.html#cb353-10" tabindex="-1"></a></span>
<span id="cb353-11"><a href="simulace3shift.html#cb353-11" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb353-12"><a href="simulace3shift.html#cb353-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb353-13"><a href="simulace3shift.html#cb353-13" tabindex="-1"></a></span>
<span id="cb353-14"><a href="simulace3shift.html#cb353-14" tabindex="-1"></a><span class="co"># List with three components ... matrices for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb353-15"><a href="simulace3shift.html#cb353-15" tabindex="-1"></a><span class="co"># Empty matrix where we will store the results</span></span>
<span id="cb353-16"><a href="simulace3shift.html#cb353-16" tabindex="-1"></a><span class="co"># Columns will have accuracy values for the respective part of the training set</span></span>
<span id="cb353-17"><a href="simulace3shift.html#cb353-17" tabindex="-1"></a><span class="co"># Rows will have values for the respective dimension value</span></span>
<span id="cb353-18"><a href="simulace3shift.html#cb353-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb353-19"><a href="simulace3shift.html#cb353-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb353-20"><a href="simulace3shift.html#cb353-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb353-21"><a href="simulace3shift.html#cb353-21" tabindex="-1"></a></span>
<span id="cb353-22"><a href="simulace3shift.html#cb353-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb353-23"><a href="simulace3shift.html#cb353-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb353-24"><a href="simulace3shift.html#cb353-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb353-25"><a href="simulace3shift.html#cb353-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb353-26"><a href="simulace3shift.html#cb353-26" tabindex="-1"></a>  </span>
<span id="cb353-27"><a href="simulace3shift.html#cb353-27" tabindex="-1"></a>  <span class="co"># Projection of discrete data onto B-spline basis of dimension d</span></span>
<span id="cb353-28"><a href="simulace3shift.html#cb353-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># Matrix of discrete data</span></span>
<span id="cb353-29"><a href="simulace3shift.html#cb353-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># Vector of arguments</span></span>
<span id="cb353-30"><a href="simulace3shift.html#cb353-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># Basis object</span></span>
<span id="cb353-31"><a href="simulace3shift.html#cb353-31" tabindex="-1"></a>  </span>
<span id="cb353-32"><a href="simulace3shift.html#cb353-32" tabindex="-1"></a>  <span class="co"># Split into training and testing data for CV</span></span>
<span id="cb353-33"><a href="simulace3shift.html#cb353-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb353-34"><a href="simulace3shift.html#cb353-34" tabindex="-1"></a>  </span>
<span id="cb353-35"><a href="simulace3shift.html#cb353-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb353-36"><a href="simulace3shift.html#cb353-36" tabindex="-1"></a>    <span class="co"># Define test and training parts for CV</span></span>
<span id="cb353-37"><a href="simulace3shift.html#cb353-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb353-38"><a href="simulace3shift.html#cb353-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb353-39"><a href="simulace3shift.html#cb353-39" tabindex="-1"></a>    </span>
<span id="cb353-40"><a href="simulace3shift.html#cb353-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb353-41"><a href="simulace3shift.html#cb353-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb353-42"><a href="simulace3shift.html#cb353-42" tabindex="-1"></a>    </span>
<span id="cb353-43"><a href="simulace3shift.html#cb353-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb353-44"><a href="simulace3shift.html#cb353-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb353-45"><a href="simulace3shift.html#cb353-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb353-46"><a href="simulace3shift.html#cb353-46" tabindex="-1"></a>  </span>
<span id="cb353-47"><a href="simulace3shift.html#cb353-47" tabindex="-1"></a>    <span class="co"># Model building</span></span>
<span id="cb353-48"><a href="simulace3shift.html#cb353-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb353-49"><a href="simulace3shift.html#cb353-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb353-50"><a href="simulace3shift.html#cb353-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb353-51"><a href="simulace3shift.html#cb353-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb353-52"><a href="simulace3shift.html#cb353-52" tabindex="-1"></a>    </span>
<span id="cb353-53"><a href="simulace3shift.html#cb353-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb353-54"><a href="simulace3shift.html#cb353-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb353-55"><a href="simulace3shift.html#cb353-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb353-56"><a href="simulace3shift.html#cb353-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb353-57"><a href="simulace3shift.html#cb353-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb353-58"><a href="simulace3shift.html#cb353-58" tabindex="-1"></a>    </span>
<span id="cb353-59"><a href="simulace3shift.html#cb353-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb353-60"><a href="simulace3shift.html#cb353-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb353-61"><a href="simulace3shift.html#cb353-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb353-62"><a href="simulace3shift.html#cb353-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb353-63"><a href="simulace3shift.html#cb353-63" tabindex="-1"></a>      </span>
<span id="cb353-64"><a href="simulace3shift.html#cb353-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb353-65"><a href="simulace3shift.html#cb353-65" tabindex="-1"></a>    <span class="do">## Linear kernel</span></span>
<span id="cb353-66"><a href="simulace3shift.html#cb353-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb353-67"><a href="simulace3shift.html#cb353-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb353-68"><a href="simulace3shift.html#cb353-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb353-69"><a href="simulace3shift.html#cb353-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb353-70"><a href="simulace3shift.html#cb353-70" tabindex="-1"></a>    <span class="do">## Polynomial kernel</span></span>
<span id="cb353-71"><a href="simulace3shift.html#cb353-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb353-72"><a href="simulace3shift.html#cb353-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb353-73"><a href="simulace3shift.html#cb353-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb353-74"><a href="simulace3shift.html#cb353-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb353-75"><a href="simulace3shift.html#cb353-75" tabindex="-1"></a>    <span class="do">## Radial kernel</span></span>
<span id="cb353-76"><a href="simulace3shift.html#cb353-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb353-77"><a href="simulace3shift.html#cb353-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb353-78"><a href="simulace3shift.html#cb353-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb353-79"><a href="simulace3shift.html#cb353-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb353-80"><a href="simulace3shift.html#cb353-80" tabindex="-1"></a>    </span>
<span id="cb353-81"><a href="simulace3shift.html#cb353-81" tabindex="-1"></a>    <span class="co"># Store accuracies in positions for given d and fold</span></span>
<span id="cb353-82"><a href="simulace3shift.html#cb353-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb353-83"><a href="simulace3shift.html#cb353-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb353-84"><a href="simulace3shift.html#cb353-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb353-85"><a href="simulace3shift.html#cb353-85" tabindex="-1"></a>  }</span>
<span id="cb353-86"><a href="simulace3shift.html#cb353-86" tabindex="-1"></a>}</span>
<span id="cb353-87"><a href="simulace3shift.html#cb353-87" tabindex="-1"></a>  </span>
<span id="cb353-88"><a href="simulace3shift.html#cb353-88" tabindex="-1"></a><span class="co"># Compute average accuracies for each d across folds</span></span>
<span id="cb353-89"><a href="simulace3shift.html#cb353-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb353-90"><a href="simulace3shift.html#cb353-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb353-91"><a href="simulace3shift.html#cb353-91" tabindex="-1"></a>}</span>
<span id="cb353-92"><a href="simulace3shift.html#cb353-92" tabindex="-1"></a></span>
<span id="cb353-93"><a href="simulace3shift.html#cb353-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb353-94"><a href="simulace3shift.html#cb353-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb353-95"><a href="simulace3shift.html#cb353-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb353-96"><a href="simulace3shift.html#cb353-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb353-97"><a href="simulace3shift.html#cb353-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb353-98"><a href="simulace3shift.html#cb353-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb353-99"><a href="simulace3shift.html#cb353-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb353-100"><a href="simulace3shift.html#cb353-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear    11 0.05578755
## poly      11 0.07673993
## radial    10 0.06959707</code></pre>
<p>We can see that the best value of the parameter <span class="math inline">\(d\)</span> is 11 for the linear kernel with the error value calculated using 10-fold CV 0.0558, 11 for the polynomial kernel with the value calculated using 10-fold CV 0.0767, and 10 for the radial kernel with the value 0.0696.<br />
For clarity, let’s also plot the progression of validation errors depending on the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb355"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb355-1"><a href="simulace3shift.html#cb355-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb355-2"><a href="simulace3shift.html#cb355-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb355-3"><a href="simulace3shift.html#cb355-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb355-4"><a href="simulace3shift.html#cb355-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb355-5"><a href="simulace3shift.html#cb355-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb355-6"><a href="simulace3shift.html#cb355-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb355-7"><a href="simulace3shift.html#cb355-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb355-8"><a href="simulace3shift.html#cb355-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb355-9"><a href="simulace3shift.html#cb355-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb355-10"><a href="simulace3shift.html#cb355-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb355-11"><a href="simulace3shift.html#cb355-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb355-12"><a href="simulace3shift.html#cb355-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb355-13"><a href="simulace3shift.html#cb355-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb355-14"><a href="simulace3shift.html#cb355-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb355-15"><a href="simulace3shift.html#cb355-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb355-16"><a href="simulace3shift.html#cb355-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb355-17"><a href="simulace3shift.html#cb355-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-62"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-62-1.png" alt="Dependency of validation error on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The optimal values of the dimension $V_d$ for each kernel function are marked by black dots." width="672" />
<p class="caption">
Figure 3.1: Dependency of validation error on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The optimal values of the dimension <span class="math inline">\(V_d\)</span> for each kernel function are marked by black dots.
</p>
</div>
<p>Now we can train the individual classifiers on all training data and look at their success on the test data.<br />
For each kernel function, we choose the dimension of the subspace we project onto based on the results of cross-validation.</p>
<p>In the variable <code>Projection</code>, we have stored the matrix of coefficients for the orthogonal projection, i.e.,</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb356"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb356-1"><a href="simulace3shift.html#cb356-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb356-2"><a href="simulace3shift.html#cb356-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb356-3"><a href="simulace3shift.html#cb356-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb356-4"><a href="simulace3shift.html#cb356-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb356-5"><a href="simulace3shift.html#cb356-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb356-6"><a href="simulace3shift.html#cb356-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb356-7"><a href="simulace3shift.html#cb356-7" tabindex="-1"></a></span>
<span id="cb356-8"><a href="simulace3shift.html#cb356-8" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb356-9"><a href="simulace3shift.html#cb356-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb356-10"><a href="simulace3shift.html#cb356-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb356-11"><a href="simulace3shift.html#cb356-11" tabindex="-1"></a>  <span class="co"># Base object</span></span>
<span id="cb356-12"><a href="simulace3shift.html#cb356-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb356-13"><a href="simulace3shift.html#cb356-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb356-14"><a href="simulace3shift.html#cb356-14" tabindex="-1"></a>  </span>
<span id="cb356-15"><a href="simulace3shift.html#cb356-15" tabindex="-1"></a>  <span class="co"># Projection of discrete data onto B-spline basis</span></span>
<span id="cb356-16"><a href="simulace3shift.html#cb356-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb356-17"><a href="simulace3shift.html#cb356-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb356-18"><a href="simulace3shift.html#cb356-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb356-19"><a href="simulace3shift.html#cb356-19" tabindex="-1"></a>  </span>
<span id="cb356-20"><a href="simulace3shift.html#cb356-20" tabindex="-1"></a>  <span class="co"># Splitting into training and test data</span></span>
<span id="cb356-21"><a href="simulace3shift.html#cb356-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb356-22"><a href="simulace3shift.html#cb356-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb356-23"><a href="simulace3shift.html#cb356-23" tabindex="-1"></a>  </span>
<span id="cb356-24"><a href="simulace3shift.html#cb356-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb356-25"><a href="simulace3shift.html#cb356-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb356-26"><a href="simulace3shift.html#cb356-26" tabindex="-1"></a>  </span>
<span id="cb356-27"><a href="simulace3shift.html#cb356-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb356-28"><a href="simulace3shift.html#cb356-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb356-29"><a href="simulace3shift.html#cb356-29" tabindex="-1"></a>  </span>
<span id="cb356-30"><a href="simulace3shift.html#cb356-30" tabindex="-1"></a>  <span class="co"># Building the model</span></span>
<span id="cb356-31"><a href="simulace3shift.html#cb356-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb356-32"><a href="simulace3shift.html#cb356-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb356-33"><a href="simulace3shift.html#cb356-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb356-34"><a href="simulace3shift.html#cb356-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb356-35"><a href="simulace3shift.html#cb356-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb356-36"><a href="simulace3shift.html#cb356-36" tabindex="-1"></a>  </span>
<span id="cb356-37"><a href="simulace3shift.html#cb356-37" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb356-38"><a href="simulace3shift.html#cb356-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb356-39"><a href="simulace3shift.html#cb356-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb356-40"><a href="simulace3shift.html#cb356-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb356-41"><a href="simulace3shift.html#cb356-41" tabindex="-1"></a>    </span>
<span id="cb356-42"><a href="simulace3shift.html#cb356-42" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb356-43"><a href="simulace3shift.html#cb356-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb356-44"><a href="simulace3shift.html#cb356-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb356-45"><a href="simulace3shift.html#cb356-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb356-46"><a href="simulace3shift.html#cb356-46" tabindex="-1"></a>  </span>
<span id="cb356-47"><a href="simulace3shift.html#cb356-47" tabindex="-1"></a>  <span class="co"># Storing results</span></span>
<span id="cb356-48"><a href="simulace3shift.html#cb356-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb356-49"><a href="simulace3shift.html#cb356-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is thus 4.29 % for the linear kernel, 3.57 % for the polynomial kernel, and 5 % for the Gaussian kernel.<br />
On the test data, the error rate of the method is 10 % for the linear kernel, 8.33 % for the polynomial kernel, and 10 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb357"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb357-1"><a href="simulace3shift.html#cb357-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVM" class="section level4 hasAnchor" number="3.3.6.3">
<h4><span class="header-section-number">3.3.6.3</span> RKHS + SVM<a href="simulace3sigma.html#RKHS-SVM" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="gaussian-kernel-2" class="section level6 hasAnchor" number="3.3.6.3.0.1">
<h6><span class="header-section-number">3.3.6.3.0.1</span> Gaussian Kernel<a href="simulace3shift.html#gaussian-kernel-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb358"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb358-1"><a href="simulace3shift.html#cb358-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb358-2"><a href="simulace3shift.html#cb358-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb358-3"><a href="simulace3shift.html#cb358-3" tabindex="-1"></a><span class="co"># Add test data</span></span>
<span id="cb358-4"><a href="simulace3shift.html#cb358-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb358-5"><a href="simulace3shift.html#cb358-5" tabindex="-1"></a></span>
<span id="cb358-6"><a href="simulace3shift.html#cb358-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb358-7"><a href="simulace3shift.html#cb358-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb358-8"><a href="simulace3shift.html#cb358-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb358-9"><a href="simulace3shift.html#cb358-9" tabindex="-1"></a>}</span>
<span id="cb358-10"><a href="simulace3shift.html#cb358-10" tabindex="-1"></a></span>
<span id="cb358-11"><a href="simulace3shift.html#cb358-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb358-12"><a href="simulace3shift.html#cb358-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb358-13"><a href="simulace3shift.html#cb358-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb358-14"><a href="simulace3shift.html#cb358-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb358-15"><a href="simulace3shift.html#cb358-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb358-16"><a href="simulace3shift.html#cb358-16" tabindex="-1"></a>    }</span>
<span id="cb358-17"><a href="simulace3shift.html#cb358-17" tabindex="-1"></a>  }</span>
<span id="cb358-18"><a href="simulace3shift.html#cb358-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb358-19"><a href="simulace3shift.html#cb358-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Let’s compute the matrix <span class="math inline">\(K_S\)</span> along with its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb359"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb359-1"><a href="simulace3shift.html#cb359-1" tabindex="-1"></a><span class="co"># Compute the matrix K</span></span>
<span id="cb359-2"><a href="simulace3shift.html#cb359-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Fixed value of gamma, optimal value will be determined using CV</span></span>
<span id="cb359-3"><a href="simulace3shift.html#cb359-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb359-4"><a href="simulace3shift.html#cb359-4" tabindex="-1"></a></span>
<span id="cb359-5"><a href="simulace3shift.html#cb359-5" tabindex="-1"></a><span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb359-6"><a href="simulace3shift.html#cb359-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb359-7"><a href="simulace3shift.html#cb359-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb359-8"><a href="simulace3shift.html#cb359-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To compute the coefficients in the representation of curves, specifically the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we also need the coefficients from SVM. Unlike the classification problem, we are now dealing with a regression problem, as we are trying to express our observed curves in some basis (chosen using kernel <span class="math inline">\(K\)</span>). Therefore, we will use the <em>Support Vector Regression</em> method, from which we will obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb360"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb360-1"><a href="simulace3shift.html#cb360-1" tabindex="-1"></a><span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb360-2"><a href="simulace3shift.html#cb360-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb360-3"><a href="simulace3shift.html#cb360-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb360-4"><a href="simulace3shift.html#cb360-4" tabindex="-1"></a></span>
<span id="cb360-5"><a href="simulace3shift.html#cb360-5" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb360-6"><a href="simulace3shift.html#cb360-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb360-7"><a href="simulace3shift.html#cb360-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb360-8"><a href="simulace3shift.html#cb360-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb360-9"><a href="simulace3shift.html#cb360-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb360-10"><a href="simulace3shift.html#cb360-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb360-11"><a href="simulace3shift.html#cb360-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb360-12"><a href="simulace3shift.html#cb360-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb360-13"><a href="simulace3shift.html#cb360-13" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb360-14"><a href="simulace3shift.html#cb360-14" tabindex="-1"></a>  <span class="co"># Determine alpha</span></span>
<span id="cb360-15"><a href="simulace3shift.html#cb360-15" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb360-16"><a href="simulace3shift.html#cb360-16" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can compute the representations of individual curves. First, let’s choose <span class="math inline">\(\hat d\)</span> as the full dimension, i.e., <span class="math inline">\(\hat d = m ={}\)</span> 101, and then determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb361"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb361-1"><a href="simulace3shift.html#cb361-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb361-2"><a href="simulace3shift.html#cb361-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb361-3"><a href="simulace3shift.html#cb361-3" tabindex="-1"></a></span>
<span id="cb361-4"><a href="simulace3shift.html#cb361-4" tabindex="-1"></a><span class="co"># Determine the lambda vector</span></span>
<span id="cb361-5"><a href="simulace3shift.html#cb361-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb361-6"><a href="simulace3shift.html#cb361-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb361-7"><a href="simulace3shift.html#cb361-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># Create an empty object</span></span>
<span id="cb361-8"><a href="simulace3shift.html#cb361-8" tabindex="-1"></a></span>
<span id="cb361-9"><a href="simulace3shift.html#cb361-9" tabindex="-1"></a><span class="co"># Compute the representation</span></span>
<span id="cb361-10"><a href="simulace3shift.html#cb361-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb361-11"><a href="simulace3shift.html#cb361-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb361-12"><a href="simulace3shift.html#cb361-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*\)</span> stored in the columns of the matrix <code>Lambda.RKHS</code> for each curve. We will use these vectors as representations of the given curves and classify the data based on this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb362"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb362-1"><a href="simulace3shift.html#cb362-1" tabindex="-1"></a><span class="co"># Split into training and test data</span></span>
<span id="cb362-2"><a href="simulace3shift.html#cb362-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb362-3"><a href="simulace3shift.html#cb362-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb362-4"><a href="simulace3shift.html#cb362-4" tabindex="-1"></a></span>
<span id="cb362-5"><a href="simulace3shift.html#cb362-5" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb362-6"><a href="simulace3shift.html#cb362-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb362-7"><a href="simulace3shift.html#cb362-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb362-8"><a href="simulace3shift.html#cb362-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb362-9"><a href="simulace3shift.html#cb362-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb362-10"><a href="simulace3shift.html#cb362-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb362-11"><a href="simulace3shift.html#cb362-11" tabindex="-1"></a></span>
<span id="cb362-12"><a href="simulace3shift.html#cb362-12" tabindex="-1"></a><span class="co"># Loop through individual kernels</span></span>
<span id="cb362-13"><a href="simulace3shift.html#cb362-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb362-14"><a href="simulace3shift.html#cb362-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb362-15"><a href="simulace3shift.html#cb362-15" tabindex="-1"></a></span>
<span id="cb362-16"><a href="simulace3shift.html#cb362-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb362-17"><a href="simulace3shift.html#cb362-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb362-18"><a href="simulace3shift.html#cb362-18" tabindex="-1"></a>  </span>
<span id="cb362-19"><a href="simulace3shift.html#cb362-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb362-20"><a href="simulace3shift.html#cb362-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb362-21"><a href="simulace3shift.html#cb362-21" tabindex="-1"></a>  </span>
<span id="cb362-22"><a href="simulace3shift.html#cb362-22" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb362-23"><a href="simulace3shift.html#cb362-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb362-24"><a href="simulace3shift.html#cb362-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb362-25"><a href="simulace3shift.html#cb362-25" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb362-26"><a href="simulace3shift.html#cb362-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb362-27"><a href="simulace3shift.html#cb362-27" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb362-28"><a href="simulace3shift.html#cb362-28" tabindex="-1"></a>  </span>
<span id="cb362-29"><a href="simulace3shift.html#cb362-29" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb362-30"><a href="simulace3shift.html#cb362-30" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb362-31"><a href="simulace3shift.html#cb362-31" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb362-32"><a href="simulace3shift.html#cb362-32" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb362-33"><a href="simulace3shift.html#cb362-33" tabindex="-1"></a>    </span>
<span id="cb362-34"><a href="simulace3shift.html#cb362-34" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb362-35"><a href="simulace3shift.html#cb362-35" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb362-36"><a href="simulace3shift.html#cb362-36" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb362-37"><a href="simulace3shift.html#cb362-37" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb362-38"><a href="simulace3shift.html#cb362-38" tabindex="-1"></a>  </span>
<span id="cb362-39"><a href="simulace3shift.html#cb362-39" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb362-40"><a href="simulace3shift.html#cb362-40" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb362-41"><a href="simulace3shift.html#cb362-41" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-70">Table 3.1: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.1000</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0286</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0786</td>
<td align="center">0.2667</td>
</tr>
</tbody>
</table>
<p>We see that the model classifies the training data very well for all three kernels, while its performance on the test data is not good at all. It is clear that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb363"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb363-1"><a href="simulace3shift.html#cb363-1" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb363-2"><a href="simulace3shift.html#cb363-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb363-3"><a href="simulace3shift.html#cb363-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb363-4"><a href="simulace3shift.html#cb363-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb363-5"><a href="simulace3shift.html#cb363-5" tabindex="-1"></a></span>
<span id="cb363-6"><a href="simulace3shift.html#cb363-6" tabindex="-1"></a><span class="co"># Values of hyperparameters to explore</span></span>
<span id="cb363-7"><a href="simulace3shift.html#cb363-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range for d</span></span>
<span id="cb363-8"><a href="simulace3shift.html#cb363-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb363-9"><a href="simulace3shift.html#cb363-9" tabindex="-1"></a></span>
<span id="cb363-10"><a href="simulace3shift.html#cb363-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb363-11"><a href="simulace3shift.html#cb363-11" tabindex="-1"></a><span class="co"># Empty matrix to store results</span></span>
<span id="cb363-12"><a href="simulace3shift.html#cb363-12" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given hyperparameters</span></span>
<span id="cb363-13"><a href="simulace3shift.html#cb363-13" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb363-14"><a href="simulace3shift.html#cb363-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb363-15"><a href="simulace3shift.html#cb363-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb363-16"><a href="simulace3shift.html#cb363-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb363-17"><a href="simulace3shift.html#cb363-17" tabindex="-1"></a></span>
<span id="cb363-18"><a href="simulace3shift.html#cb363-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb363-19"><a href="simulace3shift.html#cb363-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb363-20"><a href="simulace3shift.html#cb363-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb363-21"><a href="simulace3shift.html#cb363-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb363-22"><a href="simulace3shift.html#cb363-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb363-23"><a href="simulace3shift.html#cb363-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb363-24"><a href="simulace3shift.html#cb363-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb364"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb364-1"><a href="simulace3shift.html#cb364-1" tabindex="-1"></a><span class="co"># Cross-validation itself</span></span>
<span id="cb364-2"><a href="simulace3shift.html#cb364-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb364-3"><a href="simulace3shift.html#cb364-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb364-4"><a href="simulace3shift.html#cb364-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb364-5"><a href="simulace3shift.html#cb364-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb364-6"><a href="simulace3shift.html#cb364-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb364-7"><a href="simulace3shift.html#cb364-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb364-8"><a href="simulace3shift.html#cb364-8" tabindex="-1"></a>  </span>
<span id="cb364-9"><a href="simulace3shift.html#cb364-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb364-10"><a href="simulace3shift.html#cb364-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb364-11"><a href="simulace3shift.html#cb364-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb364-12"><a href="simulace3shift.html#cb364-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb364-13"><a href="simulace3shift.html#cb364-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb364-14"><a href="simulace3shift.html#cb364-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb364-15"><a href="simulace3shift.html#cb364-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb364-16"><a href="simulace3shift.html#cb364-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb364-17"><a href="simulace3shift.html#cb364-17" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb364-18"><a href="simulace3shift.html#cb364-18" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb364-19"><a href="simulace3shift.html#cb364-19" tabindex="-1"></a>  }</span>
<span id="cb364-20"><a href="simulace3shift.html#cb364-20" tabindex="-1"></a>  </span>
<span id="cb364-21"><a href="simulace3shift.html#cb364-21" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb364-22"><a href="simulace3shift.html#cb364-22" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb364-23"><a href="simulace3shift.html#cb364-23" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb364-24"><a href="simulace3shift.html#cb364-24" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb364-25"><a href="simulace3shift.html#cb364-25" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb364-26"><a href="simulace3shift.html#cb364-26" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb364-27"><a href="simulace3shift.html#cb364-27" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb364-28"><a href="simulace3shift.html#cb364-28" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb364-29"><a href="simulace3shift.html#cb364-29" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb364-30"><a href="simulace3shift.html#cb364-30" tabindex="-1"></a>    }</span>
<span id="cb364-31"><a href="simulace3shift.html#cb364-31" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb364-32"><a href="simulace3shift.html#cb364-32" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb364-33"><a href="simulace3shift.html#cb364-33" tabindex="-1"></a>      <span class="co"># Define test and training parts for CV</span></span>
<span id="cb364-34"><a href="simulace3shift.html#cb364-34" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb364-35"><a href="simulace3shift.html#cb364-35" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb364-36"><a href="simulace3shift.html#cb364-36" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb364-37"><a href="simulace3shift.html#cb364-37" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb364-38"><a href="simulace3shift.html#cb364-38" tabindex="-1"></a>      <span class="co"># Prepare data frame to store results</span></span>
<span id="cb364-39"><a href="simulace3shift.html#cb364-39" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb364-40"><a href="simulace3shift.html#cb364-40" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb364-41"><a href="simulace3shift.html#cb364-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb364-42"><a href="simulace3shift.html#cb364-42" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb364-43"><a href="simulace3shift.html#cb364-43" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb364-44"><a href="simulace3shift.html#cb364-44" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb364-45"><a href="simulace3shift.html#cb364-45" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb364-46"><a href="simulace3shift.html#cb364-46" tabindex="-1"></a>      </span>
<span id="cb364-47"><a href="simulace3shift.html#cb364-47" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb364-48"><a href="simulace3shift.html#cb364-48" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb364-49"><a href="simulace3shift.html#cb364-49" tabindex="-1"></a>        </span>
<span id="cb364-50"><a href="simulace3shift.html#cb364-50" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb364-51"><a href="simulace3shift.html#cb364-51" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb364-52"><a href="simulace3shift.html#cb364-52" tabindex="-1"></a>        </span>
<span id="cb364-53"><a href="simulace3shift.html#cb364-53" tabindex="-1"></a>        <span class="co"># Construct the model</span></span>
<span id="cb364-54"><a href="simulace3shift.html#cb364-54" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb364-55"><a href="simulace3shift.html#cb364-55" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb364-56"><a href="simulace3shift.html#cb364-56" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb364-57"><a href="simulace3shift.html#cb364-57" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb364-58"><a href="simulace3shift.html#cb364-58" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb364-59"><a href="simulace3shift.html#cb364-59" tabindex="-1"></a>        </span>
<span id="cb364-60"><a href="simulace3shift.html#cb364-60" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb364-61"><a href="simulace3shift.html#cb364-61" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb364-62"><a href="simulace3shift.html#cb364-62" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb364-63"><a href="simulace3shift.html#cb364-63" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb364-64"><a href="simulace3shift.html#cb364-64" tabindex="-1"></a>        </span>
<span id="cb364-65"><a href="simulace3shift.html#cb364-65" tabindex="-1"></a>        <span class="co"># Save results</span></span>
<span id="cb364-66"><a href="simulace3shift.html#cb364-66" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb364-67"><a href="simulace3shift.html#cb364-67" tabindex="-1"></a>      }</span>
<span id="cb364-68"><a href="simulace3shift.html#cb364-68" tabindex="-1"></a>      <span class="co"># Store accuracies at positions for given d, gamma, and fold</span></span>
<span id="cb364-69"><a href="simulace3shift.html#cb364-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb364-70"><a href="simulace3shift.html#cb364-70" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb364-71"><a href="simulace3shift.html#cb364-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb364-72"><a href="simulace3shift.html#cb364-72" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb364-73"><a href="simulace3shift.html#cb364-73" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb364-74"><a href="simulace3shift.html#cb364-74" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb364-75"><a href="simulace3shift.html#cb364-75" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb364-76"><a href="simulace3shift.html#cb364-76" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb364-77"><a href="simulace3shift.html#cb364-77" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb364-78"><a href="simulace3shift.html#cb364-78" tabindex="-1"></a>    }</span>
<span id="cb364-79"><a href="simulace3shift.html#cb364-79" tabindex="-1"></a>  }</span>
<span id="cb364-80"><a href="simulace3shift.html#cb364-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb365"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb365-1"><a href="simulace3shift.html#cb365-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb365-2"><a href="simulace3shift.html#cb365-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb365-3"><a href="simulace3shift.html#cb365-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb365-4"><a href="simulace3shift.html#cb365-4" tabindex="-1"></a>}</span>
<span id="cb365-5"><a href="simulace3shift.html#cb365-5" tabindex="-1"></a></span>
<span id="cb365-6"><a href="simulace3shift.html#cb365-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb365-7"><a href="simulace3shift.html#cb365-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb365-8"><a href="simulace3shift.html#cb365-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb365-9"><a href="simulace3shift.html#cb365-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb365-10"><a href="simulace3shift.html#cb365-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb365-11"><a href="simulace3shift.html#cb365-11" tabindex="-1"></a></span>
<span id="cb365-12"><a href="simulace3shift.html#cb365-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb365-13"><a href="simulace3shift.html#cb365-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb365-14"><a href="simulace3shift.html#cb365-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb365-15"><a href="simulace3shift.html#cb365-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb365-16"><a href="simulace3shift.html#cb365-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb365-17"><a href="simulace3shift.html#cb365-17" tabindex="-1"></a></span>
<span id="cb365-18"><a href="simulace3shift.html#cb365-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb365-19"><a href="simulace3shift.html#cb365-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb365-20"><a href="simulace3shift.html#cb365-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb365-21"><a href="simulace3shift.html#cb365-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb365-22"><a href="simulace3shift.html#cb365-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb365-23"><a href="simulace3shift.html#cb365-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-73">Table 3.2: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">31</td>
<td align="right">8.4834</td>
<td align="right">0.0655</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">24</td>
<td align="right">8.4834</td>
<td align="right">0.1213</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">26</td>
<td align="right">0.7197</td>
<td align="right">0.1218</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter values are <span class="math inline">\(d={}\)</span> 31 and <span class="math inline">\(\gamma={}\)</span> 8.4834 for the linear kernel with an error value computed using 10-fold CV 0.0655, <span class="math inline">\(d={}\)</span> 24 and <span class="math inline">\(\gamma={}\)</span> 8.4834 for the polynomial kernel with an error value computed using 10-fold CV 0.1213, and <span class="math inline">\(d={}\)</span> 26 and <span class="math inline">\(\gamma={}\)</span> 0.7197 for the radial kernel with an error value of 0.1218. For interest, let’s plot the validation error function as a function of dimension <span class="math inline">\(d\)</span> and hyperparameter <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb366"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb366-1"><a href="simulace3shift.html#cb366-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb366-2"><a href="simulace3shift.html#cb366-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb366-3"><a href="simulace3shift.html#cb366-3" tabindex="-1"></a>                               <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb366-4"><a href="simulace3shift.html#cb366-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb366-5"><a href="simulace3shift.html#cb366-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb366-6"><a href="simulace3shift.html#cb366-6" tabindex="-1"></a>                               <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb366-7"><a href="simulace3shift.html#cb366-7" tabindex="-1"></a>                                            <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb366-8"><a href="simulace3shift.html#cb366-8" tabindex="-1"></a>                                              <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb366-9"><a href="simulace3shift.html#cb366-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb366-10"><a href="simulace3shift.html#cb366-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb366-11"><a href="simulace3shift.html#cb366-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb366-12"><a href="simulace3shift.html#cb366-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb366-13"><a href="simulace3shift.html#cb366-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb366-14"><a href="simulace3shift.html#cb366-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb366-15"><a href="simulace3shift.html#cb366-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb366-16"><a href="simulace3shift.html#cb366-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb366-17"><a href="simulace3shift.html#cb366-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb366-18"><a href="simulace3shift.html#cb366-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb366-19"><a href="simulace3shift.html#cb366-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-74"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-74-1.png" alt="Dependence of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 3.2: Dependence of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>Since we have already found the optimal values for the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb367"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb367-1"><a href="simulace3shift.html#cb367-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains Y values</span></span>
<span id="cb367-2"><a href="simulace3shift.html#cb367-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb367-3"><a href="simulace3shift.html#cb367-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb367-4"><a href="simulace3shift.html#cb367-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb368"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb368-1"><a href="simulace3shift.html#cb368-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb368-2"><a href="simulace3shift.html#cb368-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb368-3"><a href="simulace3shift.html#cb368-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb368-4"><a href="simulace3shift.html#cb368-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb368-5"><a href="simulace3shift.html#cb368-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb368-6"><a href="simulace3shift.html#cb368-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb368-7"><a href="simulace3shift.html#cb368-7" tabindex="-1"></a></span>
<span id="cb368-8"><a href="simulace3shift.html#cb368-8" tabindex="-1"></a><span class="co"># Iterate through the kernels</span></span>
<span id="cb368-9"><a href="simulace3shift.html#cb368-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb368-10"><a href="simulace3shift.html#cb368-10" tabindex="-1"></a>  <span class="co"># Compute the K matrix</span></span>
<span id="cb368-11"><a href="simulace3shift.html#cb368-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># gamma value from CV</span></span>
<span id="cb368-12"><a href="simulace3shift.html#cb368-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb368-13"><a href="simulace3shift.html#cb368-13" tabindex="-1"></a>  </span>
<span id="cb368-14"><a href="simulace3shift.html#cb368-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb368-15"><a href="simulace3shift.html#cb368-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb368-16"><a href="simulace3shift.html#cb368-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb368-17"><a href="simulace3shift.html#cb368-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb368-18"><a href="simulace3shift.html#cb368-18" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb368-19"><a href="simulace3shift.html#cb368-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb368-20"><a href="simulace3shift.html#cb368-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb368-21"><a href="simulace3shift.html#cb368-21" tabindex="-1"></a>  </span>
<span id="cb368-22"><a href="simulace3shift.html#cb368-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb368-23"><a href="simulace3shift.html#cb368-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb368-24"><a href="simulace3shift.html#cb368-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb368-25"><a href="simulace3shift.html#cb368-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb368-26"><a href="simulace3shift.html#cb368-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb368-27"><a href="simulace3shift.html#cb368-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb368-28"><a href="simulace3shift.html#cb368-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb368-29"><a href="simulace3shift.html#cb368-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb368-30"><a href="simulace3shift.html#cb368-30" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb368-31"><a href="simulace3shift.html#cb368-31" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb368-32"><a href="simulace3shift.html#cb368-32" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb368-33"><a href="simulace3shift.html#cb368-33" tabindex="-1"></a>  }</span>
<span id="cb368-34"><a href="simulace3shift.html#cb368-34" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb368-35"><a href="simulace3shift.html#cb368-35" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb368-36"><a href="simulace3shift.html#cb368-36" tabindex="-1"></a>  </span>
<span id="cb368-37"><a href="simulace3shift.html#cb368-37" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb368-38"><a href="simulace3shift.html#cb368-38" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb368-39"><a href="simulace3shift.html#cb368-39" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb368-40"><a href="simulace3shift.html#cb368-40" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb368-41"><a href="simulace3shift.html#cb368-41" tabindex="-1"></a>  </span>
<span id="cb368-42"><a href="simulace3shift.html#cb368-42" tabindex="-1"></a>  <span class="co"># Compute the representation</span></span>
<span id="cb368-43"><a href="simulace3shift.html#cb368-43" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb368-44"><a href="simulace3shift.html#cb368-44" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb368-45"><a href="simulace3shift.html#cb368-45" tabindex="-1"></a>  }</span>
<span id="cb368-46"><a href="simulace3shift.html#cb368-46" tabindex="-1"></a>  </span>
<span id="cb368-47"><a href="simulace3shift.html#cb368-47" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb368-48"><a href="simulace3shift.html#cb368-48" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb368-49"><a href="simulace3shift.html#cb368-49" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb368-50"><a href="simulace3shift.html#cb368-50" tabindex="-1"></a></span>
<span id="cb368-51"><a href="simulace3shift.html#cb368-51" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb368-52"><a href="simulace3shift.html#cb368-52" tabindex="-1"></a></span>
<span id="cb368-53"><a href="simulace3shift.html#cb368-53" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb368-54"><a href="simulace3shift.html#cb368-54" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb368-55"><a href="simulace3shift.html#cb368-55" tabindex="-1"></a>  </span>
<span id="cb368-56"><a href="simulace3shift.html#cb368-56" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb368-57"><a href="simulace3shift.html#cb368-57" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb368-58"><a href="simulace3shift.html#cb368-58" tabindex="-1"></a>  </span>
<span id="cb368-59"><a href="simulace3shift.html#cb368-59" tabindex="-1"></a>  <span class="co"># Build models</span></span>
<span id="cb368-60"><a href="simulace3shift.html#cb368-60" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb368-61"><a href="simulace3shift.html#cb368-61" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb368-62"><a href="simulace3shift.html#cb368-62" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb368-63"><a href="simulace3shift.html#cb368-63" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb368-64"><a href="simulace3shift.html#cb368-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb368-65"><a href="simulace3shift.html#cb368-65" tabindex="-1"></a>  </span>
<span id="cb368-66"><a href="simulace3shift.html#cb368-66" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb368-67"><a href="simulace3shift.html#cb368-67" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb368-68"><a href="simulace3shift.html#cb368-68" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb368-69"><a href="simulace3shift.html#cb368-69" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb368-70"><a href="simulace3shift.html#cb368-70" tabindex="-1"></a>    </span>
<span id="cb368-71"><a href="simulace3shift.html#cb368-71" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb368-72"><a href="simulace3shift.html#cb368-72" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb368-73"><a href="simulace3shift.html#cb368-73" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb368-74"><a href="simulace3shift.html#cb368-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb368-75"><a href="simulace3shift.html#cb368-75" tabindex="-1"></a>  </span>
<span id="cb368-76"><a href="simulace3shift.html#cb368-76" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb368-77"><a href="simulace3shift.html#cb368-77" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb368-78"><a href="simulace3shift.html#cb368-78" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-77">Table 3.3: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1667</td>
</tr>
</tbody>
</table>
<p>The error of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 2.14 % for the linear kernel, 0 % for the polynomial kernel, and 2.14 % for the Gaussian kernel on the training data. On the testing data, the error rates are 18.33 % for the linear kernel, 20 % for the polynomial kernel, and 16.67 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb369"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb369-1"><a href="simulace3shift.html#cb369-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="results-table-1" class="section level3 hasAnchor" number="3.3.7">
<h3><span class="header-section-number">3.3.7</span> Results Table<a href="simulace3shift.html#results-table-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-79">Table 2.2: </span>Summary of the results of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.3571</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.4143</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3571</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discretized</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="even">
<td align="left">SVM polynomial - discretized</td>
<td align="center">0.0214</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM RBF - discretized</td>
<td align="center">0.0357</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.4429</td>
<td align="center">0.4833</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.3786</td>
<td align="center">0.4333</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.3714</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0429</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0429</td>
<td align="center">0.1167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0714</td>
<td align="center">0.1500</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.0429</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0500</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1667</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simulation-study-2" class="section level2 hasAnchor" number="3.4">
<h2><span class="header-section-number">3.4</span> Simulation Study<a href="simulace3shift.html#simulation-study-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the entire previous section, we focused solely on one randomly generated dataset of functions from two classification classes, which we subsequently randomly split into test and training parts. We then evaluated the individual classifiers obtained using the considered methods based on their test and training errors.</p>
<p>Since the generated data (and their division into two parts) can vary significantly with each repetition, the errors of the individual classification algorithms can also differ greatly. Therefore, drawing any conclusions about the methods and comparing them based on a single generated dataset can be very misleading.</p>
<p>For this reason, we will repeat the entire previous procedure for various generated datasets in this section. We will store the results in a table and finally compute the average characteristics of the models across the repetitions. To ensure our conclusions are sufficiently general, we will choose the number of repetitions as <span class="math inline">\(n_{sim} = 25\)</span>.</p>
<p>Now, we will repeat the entire previous section <code>n.sim</code> times and store the error values in the object <code>SIMUL_params</code>, while varying the parameter <span class="math inline">\(\sigma_{shift}\)</span> to observe how the results of the selected classification methods change with this value.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb370"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb370-1"><a href="simulace3shift.html#cb370-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb370-2"><a href="simulace3shift.html#cb370-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb370-3"><a href="simulace3shift.html#cb370-3" tabindex="-1"></a></span>
<span id="cb370-4"><a href="simulace3shift.html#cb370-4" tabindex="-1"></a><span class="co"># pocet simulaci pro kazdou hodnotu simulacniho parametru</span></span>
<span id="cb370-5"><a href="simulace3shift.html#cb370-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb370-6"><a href="simulace3shift.html#cb370-6" tabindex="-1"></a></span>
<span id="cb370-7"><a href="simulace3shift.html#cb370-7" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb370-8"><a href="simulace3shift.html#cb370-8" tabindex="-1"></a>             <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb370-9"><a href="simulace3shift.html#cb370-9" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb370-10"><a href="simulace3shift.html#cb370-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb370-11"><a href="simulace3shift.html#cb370-11" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>, </span>
<span id="cb370-12"><a href="simulace3shift.html#cb370-12" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>,</span>
<span id="cb370-13"><a href="simulace3shift.html#cb370-13" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, </span>
<span id="cb370-14"><a href="simulace3shift.html#cb370-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb370-15"><a href="simulace3shift.html#cb370-15" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span></span>
<span id="cb370-16"><a href="simulace3shift.html#cb370-16" tabindex="-1"></a>             )</span>
<span id="cb370-17"><a href="simulace3shift.html#cb370-17" tabindex="-1"></a></span>
<span id="cb370-18"><a href="simulace3shift.html#cb370-18" tabindex="-1"></a><span class="co"># vektor smerodatnych odchylek definujicich posunuti generovanych krivek</span></span>
<span id="cb370-19"><a href="simulace3shift.html#cb370-19" tabindex="-1"></a>shift_vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">30</span>)</span>
<span id="cb370-20"><a href="simulace3shift.html#cb370-20" tabindex="-1"></a></span>
<span id="cb370-21"><a href="simulace3shift.html#cb370-21" tabindex="-1"></a><span class="co"># vysledny objekt, do nehoz ukladame vysledky simulaci</span></span>
<span id="cb370-22"><a href="simulace3shift.html#cb370-22" tabindex="-1"></a>SIMUL_params <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(methods), <span class="dv">4</span>, <span class="fu">length</span>(shift_vector)),</span>
<span id="cb370-23"><a href="simulace3shift.html#cb370-23" tabindex="-1"></a>                      <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb370-24"><a href="simulace3shift.html#cb370-24" tabindex="-1"></a>                        <span class="at">method =</span> methods,</span>
<span id="cb370-25"><a href="simulace3shift.html#cb370-25" tabindex="-1"></a>                        <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">&#39;ERRtrain&#39;</span>, <span class="st">&#39;Errtest&#39;</span>, <span class="st">&#39;SDtrain&#39;</span>, <span class="st">&#39;SDtest&#39;</span>),</span>
<span id="cb370-26"><a href="simulace3shift.html#cb370-26" tabindex="-1"></a>                        <span class="at">shift =</span> <span class="fu">paste0</span>(shift_vector)))</span>
<span id="cb370-27"><a href="simulace3shift.html#cb370-27" tabindex="-1"></a></span>
<span id="cb370-28"><a href="simulace3shift.html#cb370-28" tabindex="-1"></a><span class="cf">for</span> (n_shift <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(shift_vector)) {</span>
<span id="cb370-29"><a href="simulace3shift.html#cb370-29" tabindex="-1"></a>  <span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb370-30"><a href="simulace3shift.html#cb370-30" tabindex="-1"></a>  <span class="co"># ve sloupcich budou metody</span></span>
<span id="cb370-31"><a href="simulace3shift.html#cb370-31" tabindex="-1"></a>  <span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb370-32"><a href="simulace3shift.html#cb370-32" tabindex="-1"></a>  <span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb370-33"><a href="simulace3shift.html#cb370-33" tabindex="-1"></a>  SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb370-34"><a href="simulace3shift.html#cb370-34" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb370-35"><a href="simulace3shift.html#cb370-35" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb370-36"><a href="simulace3shift.html#cb370-36" tabindex="-1"></a>                   <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb370-37"><a href="simulace3shift.html#cb370-37" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb370-38"><a href="simulace3shift.html#cb370-38" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb370-39"><a href="simulace3shift.html#cb370-39" tabindex="-1"></a>  </span>
<span id="cb370-40"><a href="simulace3shift.html#cb370-40" tabindex="-1"></a>  <span class="co"># objekt na ulozeni optimalnich hodnot hyperparametru, ktere se urcuji pomoci CV</span></span>
<span id="cb370-41"><a href="simulace3shift.html#cb370-41" tabindex="-1"></a>  CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb370-42"><a href="simulace3shift.html#cb370-42" tabindex="-1"></a>                           <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb370-43"><a href="simulace3shift.html#cb370-43" tabindex="-1"></a>                           <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb370-44"><a href="simulace3shift.html#cb370-44" tabindex="-1"></a>                           <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb370-45"><a href="simulace3shift.html#cb370-45" tabindex="-1"></a>                           <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb370-46"><a href="simulace3shift.html#cb370-46" tabindex="-1"></a>                           <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span>
<span id="cb370-47"><a href="simulace3shift.html#cb370-47" tabindex="-1"></a>  </span>
<span id="cb370-48"><a href="simulace3shift.html#cb370-48" tabindex="-1"></a>  <span class="do">## SIMULACE</span></span>
<span id="cb370-49"><a href="simulace3shift.html#cb370-49" tabindex="-1"></a>  </span>
<span id="cb370-50"><a href="simulace3shift.html#cb370-50" tabindex="-1"></a>  <span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb370-51"><a href="simulace3shift.html#cb370-51" tabindex="-1"></a>    <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb370-52"><a href="simulace3shift.html#cb370-52" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb370-53"><a href="simulace3shift.html#cb370-53" tabindex="-1"></a>    <span class="co"># vektor casu ekvidistantni na intervalu [0, 6]</span></span>
<span id="cb370-54"><a href="simulace3shift.html#cb370-54" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb370-55"><a href="simulace3shift.html#cb370-55" tabindex="-1"></a>    </span>
<span id="cb370-56"><a href="simulace3shift.html#cb370-56" tabindex="-1"></a>    <span class="co"># pro Y = 0</span></span>
<span id="cb370-57"><a href="simulace3shift.html#cb370-57" tabindex="-1"></a>    X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, shift_vector[n_shift])</span>
<span id="cb370-58"><a href="simulace3shift.html#cb370-58" tabindex="-1"></a>    <span class="co"># pro Y = 1</span></span>
<span id="cb370-59"><a href="simulace3shift.html#cb370-59" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, shift_vector[n_shift])</span>
<span id="cb370-60"><a href="simulace3shift.html#cb370-60" tabindex="-1"></a>    </span>
<span id="cb370-61"><a href="simulace3shift.html#cb370-61" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb370-62"><a href="simulace3shift.html#cb370-62" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> t</span>
<span id="cb370-63"><a href="simulace3shift.html#cb370-63" tabindex="-1"></a>    norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb370-64"><a href="simulace3shift.html#cb370-64" tabindex="-1"></a>    </span>
<span id="cb370-65"><a href="simulace3shift.html#cb370-65" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb370-66"><a href="simulace3shift.html#cb370-66" tabindex="-1"></a>                                   <span class="at">norder =</span> norder, </span>
<span id="cb370-67"><a href="simulace3shift.html#cb370-67" tabindex="-1"></a>                                   <span class="at">breaks =</span> breaks)</span>
<span id="cb370-68"><a href="simulace3shift.html#cb370-68" tabindex="-1"></a>    </span>
<span id="cb370-69"><a href="simulace3shift.html#cb370-69" tabindex="-1"></a>    curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb370-70"><a href="simulace3shift.html#cb370-70" tabindex="-1"></a>    <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb370-71"><a href="simulace3shift.html#cb370-71" tabindex="-1"></a>    XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb370-72"><a href="simulace3shift.html#cb370-72" tabindex="-1"></a>    </span>
<span id="cb370-73"><a href="simulace3shift.html#cb370-73" tabindex="-1"></a>    lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb370-74"><a href="simulace3shift.html#cb370-74" tabindex="-1"></a>    gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb370-75"><a href="simulace3shift.html#cb370-75" tabindex="-1"></a>    </span>
<span id="cb370-76"><a href="simulace3shift.html#cb370-76" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb370-77"><a href="simulace3shift.html#cb370-77" tabindex="-1"></a>      curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb370-78"><a href="simulace3shift.html#cb370-78" tabindex="-1"></a>      BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb370-79"><a href="simulace3shift.html#cb370-79" tabindex="-1"></a>      gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb370-80"><a href="simulace3shift.html#cb370-80" tabindex="-1"></a>    }</span>
<span id="cb370-81"><a href="simulace3shift.html#cb370-81" tabindex="-1"></a>    </span>
<span id="cb370-82"><a href="simulace3shift.html#cb370-82" tabindex="-1"></a>    GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb370-83"><a href="simulace3shift.html#cb370-83" tabindex="-1"></a>      <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb370-84"><a href="simulace3shift.html#cb370-84" tabindex="-1"></a>      <span class="at">GCV =</span> gcv</span>
<span id="cb370-85"><a href="simulace3shift.html#cb370-85" tabindex="-1"></a>    )</span>
<span id="cb370-86"><a href="simulace3shift.html#cb370-86" tabindex="-1"></a>    </span>
<span id="cb370-87"><a href="simulace3shift.html#cb370-87" tabindex="-1"></a>    <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb370-88"><a href="simulace3shift.html#cb370-88" tabindex="-1"></a>    lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb370-89"><a href="simulace3shift.html#cb370-89" tabindex="-1"></a>    </span>
<span id="cb370-90"><a href="simulace3shift.html#cb370-90" tabindex="-1"></a>    curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb370-91"><a href="simulace3shift.html#cb370-91" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb370-92"><a href="simulace3shift.html#cb370-92" tabindex="-1"></a>    XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb370-93"><a href="simulace3shift.html#cb370-93" tabindex="-1"></a>    </span>
<span id="cb370-94"><a href="simulace3shift.html#cb370-94" tabindex="-1"></a>    fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb370-95"><a href="simulace3shift.html#cb370-95" tabindex="-1"></a>    </span>
<span id="cb370-96"><a href="simulace3shift.html#cb370-96" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb370-97"><a href="simulace3shift.html#cb370-97" tabindex="-1"></a>    split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb370-98"><a href="simulace3shift.html#cb370-98" tabindex="-1"></a>    </span>
<span id="cb370-99"><a href="simulace3shift.html#cb370-99" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb370-100"><a href="simulace3shift.html#cb370-100" tabindex="-1"></a>    </span>
<span id="cb370-101"><a href="simulace3shift.html#cb370-101" tabindex="-1"></a>    X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-102"><a href="simulace3shift.html#cb370-102" tabindex="-1"></a>    X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb370-103"><a href="simulace3shift.html#cb370-103" tabindex="-1"></a>    </span>
<span id="cb370-104"><a href="simulace3shift.html#cb370-104" tabindex="-1"></a>    Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-105"><a href="simulace3shift.html#cb370-105" tabindex="-1"></a>    Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb370-106"><a href="simulace3shift.html#cb370-106" tabindex="-1"></a>    </span>
<span id="cb370-107"><a href="simulace3shift.html#cb370-107" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb370-108"><a href="simulace3shift.html#cb370-108" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb370-109"><a href="simulace3shift.html#cb370-109" tabindex="-1"></a>    </span>
<span id="cb370-110"><a href="simulace3shift.html#cb370-110" tabindex="-1"></a>    <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb370-111"><a href="simulace3shift.html#cb370-111" tabindex="-1"></a>    </span>
<span id="cb370-112"><a href="simulace3shift.html#cb370-112" tabindex="-1"></a>    k_cv <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># k-fold CV</span></span>
<span id="cb370-113"><a href="simulace3shift.html#cb370-113" tabindex="-1"></a>    neighbours <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span> <span class="co">#c(1:(2 * ceiling(sqrt(length(y.train))))) # pocet sousedu </span></span>
<span id="cb370-114"><a href="simulace3shift.html#cb370-114" tabindex="-1"></a>    </span>
<span id="cb370-115"><a href="simulace3shift.html#cb370-115" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb370-116"><a href="simulace3shift.html#cb370-116" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb370-117"><a href="simulace3shift.html#cb370-117" tabindex="-1"></a>    </span>
<span id="cb370-118"><a href="simulace3shift.html#cb370-118" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb370-119"><a href="simulace3shift.html#cb370-119" tabindex="-1"></a>    </span>
<span id="cb370-120"><a href="simulace3shift.html#cb370-120" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb370-121"><a href="simulace3shift.html#cb370-121" tabindex="-1"></a>      <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb370-122"><a href="simulace3shift.html#cb370-122" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb370-123"><a href="simulace3shift.html#cb370-123" tabindex="-1"></a>        </span>
<span id="cb370-124"><a href="simulace3shift.html#cb370-124" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-125"><a href="simulace3shift.html#cb370-125" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb370-126"><a href="simulace3shift.html#cb370-126" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-127"><a href="simulace3shift.html#cb370-127" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb370-128"><a href="simulace3shift.html#cb370-128" tabindex="-1"></a>      </span>
<span id="cb370-129"><a href="simulace3shift.html#cb370-129" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-130"><a href="simulace3shift.html#cb370-130" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb370-131"><a href="simulace3shift.html#cb370-131" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-132"><a href="simulace3shift.html#cb370-132" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb370-133"><a href="simulace3shift.html#cb370-133" tabindex="-1"></a>      </span>
<span id="cb370-134"><a href="simulace3shift.html#cb370-134" tabindex="-1"></a>      <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb370-135"><a href="simulace3shift.html#cb370-135" tabindex="-1"></a>      <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb370-136"><a href="simulace3shift.html#cb370-136" tabindex="-1"></a>        <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb370-137"><a href="simulace3shift.html#cb370-137" tabindex="-1"></a>        neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb370-138"><a href="simulace3shift.html#cb370-138" tabindex="-1"></a>                                  <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb370-139"><a href="simulace3shift.html#cb370-139" tabindex="-1"></a>                                  <span class="at">knn =</span> neighbour) </span>
<span id="cb370-140"><a href="simulace3shift.html#cb370-140" tabindex="-1"></a>        <span class="co"># predikce na validacni casti</span></span>
<span id="cb370-141"><a href="simulace3shift.html#cb370-141" tabindex="-1"></a>        model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb370-142"><a href="simulace3shift.html#cb370-142" tabindex="-1"></a>                                        <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb370-143"><a href="simulace3shift.html#cb370-143" tabindex="-1"></a>        <span class="co"># presnost na validacni casti</span></span>
<span id="cb370-144"><a href="simulace3shift.html#cb370-144" tabindex="-1"></a>        presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb370-145"><a href="simulace3shift.html#cb370-145" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-146"><a href="simulace3shift.html#cb370-146" tabindex="-1"></a>        </span>
<span id="cb370-147"><a href="simulace3shift.html#cb370-147" tabindex="-1"></a>        <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb370-148"><a href="simulace3shift.html#cb370-148" tabindex="-1"></a>        CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb370-149"><a href="simulace3shift.html#cb370-149" tabindex="-1"></a>      }</span>
<span id="cb370-150"><a href="simulace3shift.html#cb370-150" tabindex="-1"></a>    }</span>
<span id="cb370-151"><a href="simulace3shift.html#cb370-151" tabindex="-1"></a>    </span>
<span id="cb370-152"><a href="simulace3shift.html#cb370-152" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb370-153"><a href="simulace3shift.html#cb370-153" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb370-154"><a href="simulace3shift.html#cb370-154" tabindex="-1"></a>    K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb370-155"><a href="simulace3shift.html#cb370-155" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb370-156"><a href="simulace3shift.html#cb370-156" tabindex="-1"></a>    presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb370-157"><a href="simulace3shift.html#cb370-157" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb370-158"><a href="simulace3shift.html#cb370-158" tabindex="-1"></a>    </span>
<span id="cb370-159"><a href="simulace3shift.html#cb370-159" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb370-160"><a href="simulace3shift.html#cb370-160" tabindex="-1"></a>    </span>
<span id="cb370-161"><a href="simulace3shift.html#cb370-161" tabindex="-1"></a>    <span class="co"># predikce</span></span>
<span id="cb370-162"><a href="simulace3shift.html#cb370-162" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb370-163"><a href="simulace3shift.html#cb370-163" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb370-164"><a href="simulace3shift.html#cb370-164" tabindex="-1"></a>    </span>
<span id="cb370-165"><a href="simulace3shift.html#cb370-165" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb370-166"><a href="simulace3shift.html#cb370-166" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb370-167"><a href="simulace3shift.html#cb370-167" tabindex="-1"></a>      <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb370-168"><a href="simulace3shift.html#cb370-168" tabindex="-1"></a>      <span class="fu">sum</span>()</span>
<span id="cb370-169"><a href="simulace3shift.html#cb370-169" tabindex="-1"></a>    </span>
<span id="cb370-170"><a href="simulace3shift.html#cb370-170" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb370-171"><a href="simulace3shift.html#cb370-171" tabindex="-1"></a>                          <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb370-172"><a href="simulace3shift.html#cb370-172" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb370-173"><a href="simulace3shift.html#cb370-173" tabindex="-1"></a>    </span>
<span id="cb370-174"><a href="simulace3shift.html#cb370-174" tabindex="-1"></a>    <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb370-175"><a href="simulace3shift.html#cb370-175" tabindex="-1"></a>    </span>
<span id="cb370-176"><a href="simulace3shift.html#cb370-176" tabindex="-1"></a>    <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb370-177"><a href="simulace3shift.html#cb370-177" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb370-178"><a href="simulace3shift.html#cb370-178" tabindex="-1"></a>    nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb370-179"><a href="simulace3shift.html#cb370-179" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb370-180"><a href="simulace3shift.html#cb370-180" tabindex="-1"></a>    <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb370-181"><a href="simulace3shift.html#cb370-181" tabindex="-1"></a>    </span>
<span id="cb370-182"><a href="simulace3shift.html#cb370-182" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb370-183"><a href="simulace3shift.html#cb370-183" tabindex="-1"></a>    data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb370-184"><a href="simulace3shift.html#cb370-184" tabindex="-1"></a>    data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb370-185"><a href="simulace3shift.html#cb370-185" tabindex="-1"></a>    </span>
<span id="cb370-186"><a href="simulace3shift.html#cb370-186" tabindex="-1"></a>    <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb370-187"><a href="simulace3shift.html#cb370-187" tabindex="-1"></a>    scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb370-188"><a href="simulace3shift.html#cb370-188" tabindex="-1"></a>    </span>
<span id="cb370-189"><a href="simulace3shift.html#cb370-189" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb370-190"><a href="simulace3shift.html#cb370-190" tabindex="-1"></a>      xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb370-191"><a href="simulace3shift.html#cb370-191" tabindex="-1"></a>      scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb370-192"><a href="simulace3shift.html#cb370-192" tabindex="-1"></a>      <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb370-193"><a href="simulace3shift.html#cb370-193" tabindex="-1"></a>    }</span>
<span id="cb370-194"><a href="simulace3shift.html#cb370-194" tabindex="-1"></a>    </span>
<span id="cb370-195"><a href="simulace3shift.html#cb370-195" tabindex="-1"></a>    data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb370-196"><a href="simulace3shift.html#cb370-196" tabindex="-1"></a>    data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb370-197"><a href="simulace3shift.html#cb370-197" tabindex="-1"></a>    <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb370-198"><a href="simulace3shift.html#cb370-198" tabindex="-1"></a>    </span>
<span id="cb370-199"><a href="simulace3shift.html#cb370-199" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb370-200"><a href="simulace3shift.html#cb370-200" tabindex="-1"></a>    clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb370-201"><a href="simulace3shift.html#cb370-201" tabindex="-1"></a>    </span>
<span id="cb370-202"><a href="simulace3shift.html#cb370-202" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-203"><a href="simulace3shift.html#cb370-203" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-204"><a href="simulace3shift.html#cb370-204" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb370-205"><a href="simulace3shift.html#cb370-205" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-206"><a href="simulace3shift.html#cb370-206" tabindex="-1"></a>      </span>
<span id="cb370-207"><a href="simulace3shift.html#cb370-207" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-208"><a href="simulace3shift.html#cb370-208" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-209"><a href="simulace3shift.html#cb370-209" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb370-210"><a href="simulace3shift.html#cb370-210" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-211"><a href="simulace3shift.html#cb370-211" tabindex="-1"></a>    </span>
<span id="cb370-212"><a href="simulace3shift.html#cb370-212" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb370-213"><a href="simulace3shift.html#cb370-213" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-214"><a href="simulace3shift.html#cb370-214" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-215"><a href="simulace3shift.html#cb370-215" tabindex="-1"></a>    </span>
<span id="cb370-216"><a href="simulace3shift.html#cb370-216" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-217"><a href="simulace3shift.html#cb370-217" tabindex="-1"></a>    </span>
<span id="cb370-218"><a href="simulace3shift.html#cb370-218" tabindex="-1"></a>    <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb370-219"><a href="simulace3shift.html#cb370-219" tabindex="-1"></a>    </span>
<span id="cb370-220"><a href="simulace3shift.html#cb370-220" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb370-221"><a href="simulace3shift.html#cb370-221" tabindex="-1"></a>    clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb370-222"><a href="simulace3shift.html#cb370-222" tabindex="-1"></a>    </span>
<span id="cb370-223"><a href="simulace3shift.html#cb370-223" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-224"><a href="simulace3shift.html#cb370-224" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-225"><a href="simulace3shift.html#cb370-225" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb370-226"><a href="simulace3shift.html#cb370-226" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-227"><a href="simulace3shift.html#cb370-227" tabindex="-1"></a>      </span>
<span id="cb370-228"><a href="simulace3shift.html#cb370-228" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-229"><a href="simulace3shift.html#cb370-229" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-230"><a href="simulace3shift.html#cb370-230" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb370-231"><a href="simulace3shift.html#cb370-231" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-232"><a href="simulace3shift.html#cb370-232" tabindex="-1"></a>    </span>
<span id="cb370-233"><a href="simulace3shift.html#cb370-233" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb370-234"><a href="simulace3shift.html#cb370-234" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-235"><a href="simulace3shift.html#cb370-235" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-236"><a href="simulace3shift.html#cb370-236" tabindex="-1"></a>    </span>
<span id="cb370-237"><a href="simulace3shift.html#cb370-237" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-238"><a href="simulace3shift.html#cb370-238" tabindex="-1"></a>    </span>
<span id="cb370-239"><a href="simulace3shift.html#cb370-239" tabindex="-1"></a>    <span class="do">## 4) Logistická regrese</span></span>
<span id="cb370-240"><a href="simulace3shift.html#cb370-240" tabindex="-1"></a>    <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb370-241"><a href="simulace3shift.html#cb370-241" tabindex="-1"></a>    </span>
<span id="cb370-242"><a href="simulace3shift.html#cb370-242" tabindex="-1"></a>    <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb370-243"><a href="simulace3shift.html#cb370-243" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb370-244"><a href="simulace3shift.html#cb370-244" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb370-245"><a href="simulace3shift.html#cb370-245" tabindex="-1"></a>    </span>
<span id="cb370-246"><a href="simulace3shift.html#cb370-246" tabindex="-1"></a>    <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb370-247"><a href="simulace3shift.html#cb370-247" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb370-248"><a href="simulace3shift.html#cb370-248" tabindex="-1"></a>    </span>
<span id="cb370-249"><a href="simulace3shift.html#cb370-249" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb370-250"><a href="simulace3shift.html#cb370-250" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb370-251"><a href="simulace3shift.html#cb370-251" tabindex="-1"></a>    <span class="co"># B-spline baze </span></span>
<span id="cb370-252"><a href="simulace3shift.html#cb370-252" tabindex="-1"></a>    basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb370-253"><a href="simulace3shift.html#cb370-253" tabindex="-1"></a>    </span>
<span id="cb370-254"><a href="simulace3shift.html#cb370-254" tabindex="-1"></a>    <span class="do">### 10-fold cross-validation</span></span>
<span id="cb370-255"><a href="simulace3shift.html#cb370-255" tabindex="-1"></a>    n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb370-256"><a href="simulace3shift.html#cb370-256" tabindex="-1"></a>    n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb370-257"><a href="simulace3shift.html#cb370-257" tabindex="-1"></a>    <span class="co"># k_cv &lt;- 10 # k-fold CV</span></span>
<span id="cb370-258"><a href="simulace3shift.html#cb370-258" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb370-259"><a href="simulace3shift.html#cb370-259" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb370-260"><a href="simulace3shift.html#cb370-260" tabindex="-1"></a>    <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb370-261"><a href="simulace3shift.html#cb370-261" tabindex="-1"></a>    <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb370-262"><a href="simulace3shift.html#cb370-262" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb370-263"><a href="simulace3shift.html#cb370-263" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb370-264"><a href="simulace3shift.html#cb370-264" tabindex="-1"></a>    <span class="co"># B-spline baze </span></span>
<span id="cb370-265"><a href="simulace3shift.html#cb370-265" tabindex="-1"></a>    basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb370-266"><a href="simulace3shift.html#cb370-266" tabindex="-1"></a>    <span class="co"># vztah</span></span>
<span id="cb370-267"><a href="simulace3shift.html#cb370-267" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb370-268"><a href="simulace3shift.html#cb370-268" tabindex="-1"></a>    <span class="co"># baze pro x</span></span>
<span id="cb370-269"><a href="simulace3shift.html#cb370-269" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb370-270"><a href="simulace3shift.html#cb370-270" tabindex="-1"></a>    </span>
<span id="cb370-271"><a href="simulace3shift.html#cb370-271" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb370-272"><a href="simulace3shift.html#cb370-272" tabindex="-1"></a>                         <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb370-273"><a href="simulace3shift.html#cb370-273" tabindex="-1"></a>    </span>
<span id="cb370-274"><a href="simulace3shift.html#cb370-274" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb370-275"><a href="simulace3shift.html#cb370-275" tabindex="-1"></a>      <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb370-276"><a href="simulace3shift.html#cb370-276" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb370-277"><a href="simulace3shift.html#cb370-277" tabindex="-1"></a>        </span>
<span id="cb370-278"><a href="simulace3shift.html#cb370-278" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-279"><a href="simulace3shift.html#cb370-279" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb370-280"><a href="simulace3shift.html#cb370-280" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-281"><a href="simulace3shift.html#cb370-281" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb370-282"><a href="simulace3shift.html#cb370-282" tabindex="-1"></a>      </span>
<span id="cb370-283"><a href="simulace3shift.html#cb370-283" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-284"><a href="simulace3shift.html#cb370-284" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb370-285"><a href="simulace3shift.html#cb370-285" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb370-286"><a href="simulace3shift.html#cb370-286" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb370-287"><a href="simulace3shift.html#cb370-287" tabindex="-1"></a>      </span>
<span id="cb370-288"><a href="simulace3shift.html#cb370-288" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb370-289"><a href="simulace3shift.html#cb370-289" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb370-290"><a href="simulace3shift.html#cb370-290" tabindex="-1"></a>      </span>
<span id="cb370-291"><a href="simulace3shift.html#cb370-291" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb370-292"><a href="simulace3shift.html#cb370-292" tabindex="-1"></a>        <span class="co"># baze pro bety</span></span>
<span id="cb370-293"><a href="simulace3shift.html#cb370-293" tabindex="-1"></a>        basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb370-294"><a href="simulace3shift.html#cb370-294" tabindex="-1"></a>        </span>
<span id="cb370-295"><a href="simulace3shift.html#cb370-295" tabindex="-1"></a>        basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb370-296"><a href="simulace3shift.html#cb370-296" tabindex="-1"></a>        <span class="co"># vstupni data do modelu</span></span>
<span id="cb370-297"><a href="simulace3shift.html#cb370-297" tabindex="-1"></a>        ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb370-298"><a href="simulace3shift.html#cb370-298" tabindex="-1"></a>        <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb370-299"><a href="simulace3shift.html#cb370-299" tabindex="-1"></a>        model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb370-300"><a href="simulace3shift.html#cb370-300" tabindex="-1"></a>                                <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb370-301"><a href="simulace3shift.html#cb370-301" tabindex="-1"></a>        </span>
<span id="cb370-302"><a href="simulace3shift.html#cb370-302" tabindex="-1"></a>        <span class="co"># presnost na validacni casti </span></span>
<span id="cb370-303"><a href="simulace3shift.html#cb370-303" tabindex="-1"></a>        newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb370-304"><a href="simulace3shift.html#cb370-304" tabindex="-1"></a>        predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb370-305"><a href="simulace3shift.html#cb370-305" tabindex="-1"></a>        predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb370-306"><a href="simulace3shift.html#cb370-306" tabindex="-1"></a>        presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb370-307"><a href="simulace3shift.html#cb370-307" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-308"><a href="simulace3shift.html#cb370-308" tabindex="-1"></a>        </span>
<span id="cb370-309"><a href="simulace3shift.html#cb370-309" tabindex="-1"></a>        <span class="co"># vlozime do matice</span></span>
<span id="cb370-310"><a href="simulace3shift.html#cb370-310" tabindex="-1"></a>        CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb370-311"><a href="simulace3shift.html#cb370-311" tabindex="-1"></a>      } </span>
<span id="cb370-312"><a href="simulace3shift.html#cb370-312" tabindex="-1"></a>    }</span>
<span id="cb370-313"><a href="simulace3shift.html#cb370-313" tabindex="-1"></a>    </span>
<span id="cb370-314"><a href="simulace3shift.html#cb370-314" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb370-315"><a href="simulace3shift.html#cb370-315" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb370-316"><a href="simulace3shift.html#cb370-316" tabindex="-1"></a>    n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb370-317"><a href="simulace3shift.html#cb370-317" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb370-318"><a href="simulace3shift.html#cb370-318" tabindex="-1"></a>    presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb370-319"><a href="simulace3shift.html#cb370-319" tabindex="-1"></a>    </span>
<span id="cb370-320"><a href="simulace3shift.html#cb370-320" tabindex="-1"></a>    <span class="co"># optimalni model</span></span>
<span id="cb370-321"><a href="simulace3shift.html#cb370-321" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb370-322"><a href="simulace3shift.html#cb370-322" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb370-323"><a href="simulace3shift.html#cb370-323" tabindex="-1"></a>    <span class="co"># baze pro x a bety</span></span>
<span id="cb370-324"><a href="simulace3shift.html#cb370-324" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb370-325"><a href="simulace3shift.html#cb370-325" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb370-326"><a href="simulace3shift.html#cb370-326" tabindex="-1"></a>    <span class="co"># vstupni data do modelu</span></span>
<span id="cb370-327"><a href="simulace3shift.html#cb370-327" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb370-328"><a href="simulace3shift.html#cb370-328" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb370-329"><a href="simulace3shift.html#cb370-329" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb370-330"><a href="simulace3shift.html#cb370-330" tabindex="-1"></a>    <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb370-331"><a href="simulace3shift.html#cb370-331" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb370-332"><a href="simulace3shift.html#cb370-332" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb370-333"><a href="simulace3shift.html#cb370-333" tabindex="-1"></a>    </span>
<span id="cb370-334"><a href="simulace3shift.html#cb370-334" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-335"><a href="simulace3shift.html#cb370-335" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb370-336"><a href="simulace3shift.html#cb370-336" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb370-337"><a href="simulace3shift.html#cb370-337" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb370-338"><a href="simulace3shift.html#cb370-338" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-339"><a href="simulace3shift.html#cb370-339" tabindex="-1"></a>      </span>
<span id="cb370-340"><a href="simulace3shift.html#cb370-340" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-341"><a href="simulace3shift.html#cb370-341" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb370-342"><a href="simulace3shift.html#cb370-342" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb370-343"><a href="simulace3shift.html#cb370-343" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb370-344"><a href="simulace3shift.html#cb370-344" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb370-345"><a href="simulace3shift.html#cb370-345" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-346"><a href="simulace3shift.html#cb370-346" tabindex="-1"></a>    </span>
<span id="cb370-347"><a href="simulace3shift.html#cb370-347" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb370-348"><a href="simulace3shift.html#cb370-348" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-349"><a href="simulace3shift.html#cb370-349" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-350"><a href="simulace3shift.html#cb370-350" tabindex="-1"></a>    </span>
<span id="cb370-351"><a href="simulace3shift.html#cb370-351" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-352"><a href="simulace3shift.html#cb370-352" tabindex="-1"></a>    </span>
<span id="cb370-353"><a href="simulace3shift.html#cb370-353" tabindex="-1"></a>    <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb370-354"><a href="simulace3shift.html#cb370-354" tabindex="-1"></a>  </span>
<span id="cb370-355"><a href="simulace3shift.html#cb370-355" tabindex="-1"></a>    <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb370-356"><a href="simulace3shift.html#cb370-356" tabindex="-1"></a>    </span>
<span id="cb370-357"><a href="simulace3shift.html#cb370-357" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb370-358"><a href="simulace3shift.html#cb370-358" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb370-359"><a href="simulace3shift.html#cb370-359" tabindex="-1"></a>       </span>
<span id="cb370-360"><a href="simulace3shift.html#cb370-360" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb370-361"><a href="simulace3shift.html#cb370-361" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb370-362"><a href="simulace3shift.html#cb370-362" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb370-363"><a href="simulace3shift.html#cb370-363" tabindex="-1"></a>    </span>
<span id="cb370-364"><a href="simulace3shift.html#cb370-364" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb370-365"><a href="simulace3shift.html#cb370-365" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb370-366"><a href="simulace3shift.html#cb370-366" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb370-367"><a href="simulace3shift.html#cb370-367" tabindex="-1"></a>    </span>
<span id="cb370-368"><a href="simulace3shift.html#cb370-368" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-369"><a href="simulace3shift.html#cb370-369" tabindex="-1"></a>    clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb370-370"><a href="simulace3shift.html#cb370-370" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb370-371"><a href="simulace3shift.html#cb370-371" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-372"><a href="simulace3shift.html#cb370-372" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb370-373"><a href="simulace3shift.html#cb370-373" tabindex="-1"></a>    </span>
<span id="cb370-374"><a href="simulace3shift.html#cb370-374" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-375"><a href="simulace3shift.html#cb370-375" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb370-376"><a href="simulace3shift.html#cb370-376" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb370-377"><a href="simulace3shift.html#cb370-377" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-378"><a href="simulace3shift.html#cb370-378" tabindex="-1"></a>      </span>
<span id="cb370-379"><a href="simulace3shift.html#cb370-379" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-380"><a href="simulace3shift.html#cb370-380" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb370-381"><a href="simulace3shift.html#cb370-381" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-382"><a href="simulace3shift.html#cb370-382" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-383"><a href="simulace3shift.html#cb370-383" tabindex="-1"></a>    </span>
<span id="cb370-384"><a href="simulace3shift.html#cb370-384" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb370-385"><a href="simulace3shift.html#cb370-385" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-386"><a href="simulace3shift.html#cb370-386" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-387"><a href="simulace3shift.html#cb370-387" tabindex="-1"></a>    </span>
<span id="cb370-388"><a href="simulace3shift.html#cb370-388" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-389"><a href="simulace3shift.html#cb370-389" tabindex="-1"></a>    </span>
<span id="cb370-390"><a href="simulace3shift.html#cb370-390" tabindex="-1"></a>    <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb370-391"><a href="simulace3shift.html#cb370-391" tabindex="-1"></a>    </span>
<span id="cb370-392"><a href="simulace3shift.html#cb370-392" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-393"><a href="simulace3shift.html#cb370-393" tabindex="-1"></a>    clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb370-394"><a href="simulace3shift.html#cb370-394" tabindex="-1"></a>                               <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb370-395"><a href="simulace3shift.html#cb370-395" tabindex="-1"></a>                               <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-396"><a href="simulace3shift.html#cb370-396" tabindex="-1"></a>                               <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb370-397"><a href="simulace3shift.html#cb370-397" tabindex="-1"></a>    </span>
<span id="cb370-398"><a href="simulace3shift.html#cb370-398" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-399"><a href="simulace3shift.html#cb370-399" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-400"><a href="simulace3shift.html#cb370-400" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb370-401"><a href="simulace3shift.html#cb370-401" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-402"><a href="simulace3shift.html#cb370-402" tabindex="-1"></a>      </span>
<span id="cb370-403"><a href="simulace3shift.html#cb370-403" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-404"><a href="simulace3shift.html#cb370-404" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-405"><a href="simulace3shift.html#cb370-405" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-406"><a href="simulace3shift.html#cb370-406" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-407"><a href="simulace3shift.html#cb370-407" tabindex="-1"></a>    </span>
<span id="cb370-408"><a href="simulace3shift.html#cb370-408" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb370-409"><a href="simulace3shift.html#cb370-409" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-410"><a href="simulace3shift.html#cb370-410" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-411"><a href="simulace3shift.html#cb370-411" tabindex="-1"></a>    </span>
<span id="cb370-412"><a href="simulace3shift.html#cb370-412" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-413"><a href="simulace3shift.html#cb370-413" tabindex="-1"></a>    </span>
<span id="cb370-414"><a href="simulace3shift.html#cb370-414" tabindex="-1"></a>    <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb370-415"><a href="simulace3shift.html#cb370-415" tabindex="-1"></a></span>
<span id="cb370-416"><a href="simulace3shift.html#cb370-416" tabindex="-1"></a>    <span class="co"># trenovaci dataset</span></span>
<span id="cb370-417"><a href="simulace3shift.html#cb370-417" tabindex="-1"></a>    data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb370-418"><a href="simulace3shift.html#cb370-418" tabindex="-1"></a>    data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb370-419"><a href="simulace3shift.html#cb370-419" tabindex="-1"></a>    </span>
<span id="cb370-420"><a href="simulace3shift.html#cb370-420" tabindex="-1"></a>    <span class="co"># testovaci dataset</span></span>
<span id="cb370-421"><a href="simulace3shift.html#cb370-421" tabindex="-1"></a>    data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb370-422"><a href="simulace3shift.html#cb370-422" tabindex="-1"></a>    data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb370-423"><a href="simulace3shift.html#cb370-423" tabindex="-1"></a>    </span>
<span id="cb370-424"><a href="simulace3shift.html#cb370-424" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-425"><a href="simulace3shift.html#cb370-425" tabindex="-1"></a>    clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb370-426"><a href="simulace3shift.html#cb370-426" tabindex="-1"></a>                                  <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb370-427"><a href="simulace3shift.html#cb370-427" tabindex="-1"></a>                                  <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-428"><a href="simulace3shift.html#cb370-428" tabindex="-1"></a>                                  <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb370-429"><a href="simulace3shift.html#cb370-429" tabindex="-1"></a>    </span>
<span id="cb370-430"><a href="simulace3shift.html#cb370-430" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-431"><a href="simulace3shift.html#cb370-431" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb370-432"><a href="simulace3shift.html#cb370-432" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb370-433"><a href="simulace3shift.html#cb370-433" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-434"><a href="simulace3shift.html#cb370-434" tabindex="-1"></a>      </span>
<span id="cb370-435"><a href="simulace3shift.html#cb370-435" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-436"><a href="simulace3shift.html#cb370-436" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb370-437"><a href="simulace3shift.html#cb370-437" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-438"><a href="simulace3shift.html#cb370-438" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-439"><a href="simulace3shift.html#cb370-439" tabindex="-1"></a>    </span>
<span id="cb370-440"><a href="simulace3shift.html#cb370-440" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb370-441"><a href="simulace3shift.html#cb370-441" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb370-442"><a href="simulace3shift.html#cb370-442" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb370-443"><a href="simulace3shift.html#cb370-443" tabindex="-1"></a>    </span>
<span id="cb370-444"><a href="simulace3shift.html#cb370-444" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-445"><a href="simulace3shift.html#cb370-445" tabindex="-1"></a>      </span>
<span id="cb370-446"><a href="simulace3shift.html#cb370-446" tabindex="-1"></a>    <span class="do">## 7) SVM</span></span>
<span id="cb370-447"><a href="simulace3shift.html#cb370-447" tabindex="-1"></a>    </span>
<span id="cb370-448"><a href="simulace3shift.html#cb370-448" tabindex="-1"></a>    <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb370-449"><a href="simulace3shift.html#cb370-449" tabindex="-1"></a>    </span>
<span id="cb370-450"><a href="simulace3shift.html#cb370-450" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb370-451"><a href="simulace3shift.html#cb370-451" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb370-452"><a href="simulace3shift.html#cb370-452" tabindex="-1"></a>    </span>
<span id="cb370-453"><a href="simulace3shift.html#cb370-453" tabindex="-1"></a>    <span class="co"># normovani dat</span></span>
<span id="cb370-454"><a href="simulace3shift.html#cb370-454" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb370-455"><a href="simulace3shift.html#cb370-455" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb370-456"><a href="simulace3shift.html#cb370-456" tabindex="-1"></a>      norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb370-457"><a href="simulace3shift.html#cb370-457" tabindex="-1"></a>      }</span>
<span id="cb370-458"><a href="simulace3shift.html#cb370-458" tabindex="-1"></a>    XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb370-459"><a href="simulace3shift.html#cb370-459" tabindex="-1"></a>    XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb370-460"><a href="simulace3shift.html#cb370-460" tabindex="-1"></a>                                                <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb370-461"><a href="simulace3shift.html#cb370-461" tabindex="-1"></a>                                                <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb370-462"><a href="simulace3shift.html#cb370-462" tabindex="-1"></a>                                                <span class="at">byrow =</span> T)</span>
<span id="cb370-463"><a href="simulace3shift.html#cb370-463" tabindex="-1"></a>    </span>
<span id="cb370-464"><a href="simulace3shift.html#cb370-464" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb370-465"><a href="simulace3shift.html#cb370-465" tabindex="-1"></a>    X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-466"><a href="simulace3shift.html#cb370-466" tabindex="-1"></a>    X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb370-467"><a href="simulace3shift.html#cb370-467" tabindex="-1"></a>    </span>
<span id="cb370-468"><a href="simulace3shift.html#cb370-468" tabindex="-1"></a>    Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-469"><a href="simulace3shift.html#cb370-469" tabindex="-1"></a>    Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb370-470"><a href="simulace3shift.html#cb370-470" tabindex="-1"></a>    </span>
<span id="cb370-471"><a href="simulace3shift.html#cb370-471" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb370-472"><a href="simulace3shift.html#cb370-472" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb370-473"><a href="simulace3shift.html#cb370-473" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb370-474"><a href="simulace3shift.html#cb370-474" tabindex="-1"></a>    </span>
<span id="cb370-475"><a href="simulace3shift.html#cb370-475" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb370-476"><a href="simulace3shift.html#cb370-476" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb370-477"><a href="simulace3shift.html#cb370-477" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb370-478"><a href="simulace3shift.html#cb370-478" tabindex="-1"></a>    </span>
<span id="cb370-479"><a href="simulace3shift.html#cb370-479" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb370-480"><a href="simulace3shift.html#cb370-480" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-481"><a href="simulace3shift.html#cb370-481" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-482"><a href="simulace3shift.html#cb370-482" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb370-483"><a href="simulace3shift.html#cb370-483" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb370-484"><a href="simulace3shift.html#cb370-484" tabindex="-1"></a>    </span>
<span id="cb370-485"><a href="simulace3shift.html#cb370-485" tabindex="-1"></a>    clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb370-486"><a href="simulace3shift.html#cb370-486" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-487"><a href="simulace3shift.html#cb370-487" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-488"><a href="simulace3shift.html#cb370-488" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-489"><a href="simulace3shift.html#cb370-489" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb370-490"><a href="simulace3shift.html#cb370-490" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb370-491"><a href="simulace3shift.html#cb370-491" tabindex="-1"></a>    </span>
<span id="cb370-492"><a href="simulace3shift.html#cb370-492" tabindex="-1"></a>    clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb370-493"><a href="simulace3shift.html#cb370-493" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-494"><a href="simulace3shift.html#cb370-494" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-495"><a href="simulace3shift.html#cb370-495" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb370-496"><a href="simulace3shift.html#cb370-496" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb370-497"><a href="simulace3shift.html#cb370-497" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb370-498"><a href="simulace3shift.html#cb370-498" tabindex="-1"></a>    </span>
<span id="cb370-499"><a href="simulace3shift.html#cb370-499" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-500"><a href="simulace3shift.html#cb370-500" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb370-501"><a href="simulace3shift.html#cb370-501" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb370-502"><a href="simulace3shift.html#cb370-502" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-503"><a href="simulace3shift.html#cb370-503" tabindex="-1"></a>    </span>
<span id="cb370-504"><a href="simulace3shift.html#cb370-504" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb370-505"><a href="simulace3shift.html#cb370-505" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb370-506"><a href="simulace3shift.html#cb370-506" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-507"><a href="simulace3shift.html#cb370-507" tabindex="-1"></a>    </span>
<span id="cb370-508"><a href="simulace3shift.html#cb370-508" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb370-509"><a href="simulace3shift.html#cb370-509" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb370-510"><a href="simulace3shift.html#cb370-510" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-511"><a href="simulace3shift.html#cb370-511" tabindex="-1"></a>    </span>
<span id="cb370-512"><a href="simulace3shift.html#cb370-512" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb370-513"><a href="simulace3shift.html#cb370-513" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb370-514"><a href="simulace3shift.html#cb370-514" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb370-515"><a href="simulace3shift.html#cb370-515" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-516"><a href="simulace3shift.html#cb370-516" tabindex="-1"></a>    </span>
<span id="cb370-517"><a href="simulace3shift.html#cb370-517" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb370-518"><a href="simulace3shift.html#cb370-518" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb370-519"><a href="simulace3shift.html#cb370-519" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-520"><a href="simulace3shift.html#cb370-520" tabindex="-1"></a>    </span>
<span id="cb370-521"><a href="simulace3shift.html#cb370-521" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb370-522"><a href="simulace3shift.html#cb370-522" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb370-523"><a href="simulace3shift.html#cb370-523" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-524"><a href="simulace3shift.html#cb370-524" tabindex="-1"></a>    </span>
<span id="cb370-525"><a href="simulace3shift.html#cb370-525" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb370-526"><a href="simulace3shift.html#cb370-526" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb370-527"><a href="simulace3shift.html#cb370-527" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb370-528"><a href="simulace3shift.html#cb370-528" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb370-529"><a href="simulace3shift.html#cb370-529" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb370-530"><a href="simulace3shift.html#cb370-530" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb370-531"><a href="simulace3shift.html#cb370-531" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb370-532"><a href="simulace3shift.html#cb370-532" tabindex="-1"></a>    </span>
<span id="cb370-533"><a href="simulace3shift.html#cb370-533" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-534"><a href="simulace3shift.html#cb370-534" tabindex="-1"></a>    </span>
<span id="cb370-535"><a href="simulace3shift.html#cb370-535" tabindex="-1"></a>    <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb370-536"><a href="simulace3shift.html#cb370-536" tabindex="-1"></a>    </span>
<span id="cb370-537"><a href="simulace3shift.html#cb370-537" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-538"><a href="simulace3shift.html#cb370-538" tabindex="-1"></a>    clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb370-539"><a href="simulace3shift.html#cb370-539" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-540"><a href="simulace3shift.html#cb370-540" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-541"><a href="simulace3shift.html#cb370-541" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb370-542"><a href="simulace3shift.html#cb370-542" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb370-543"><a href="simulace3shift.html#cb370-543" tabindex="-1"></a>    </span>
<span id="cb370-544"><a href="simulace3shift.html#cb370-544" tabindex="-1"></a>    clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb370-545"><a href="simulace3shift.html#cb370-545" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-546"><a href="simulace3shift.html#cb370-546" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-547"><a href="simulace3shift.html#cb370-547" tabindex="-1"></a>                         <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-548"><a href="simulace3shift.html#cb370-548" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="fl">0.6</span>,</span>
<span id="cb370-549"><a href="simulace3shift.html#cb370-549" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb370-550"><a href="simulace3shift.html#cb370-550" tabindex="-1"></a>    </span>
<span id="cb370-551"><a href="simulace3shift.html#cb370-551" tabindex="-1"></a>    clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb370-552"><a href="simulace3shift.html#cb370-552" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-553"><a href="simulace3shift.html#cb370-553" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-554"><a href="simulace3shift.html#cb370-554" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb370-555"><a href="simulace3shift.html#cb370-555" tabindex="-1"></a>                         <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb370-556"><a href="simulace3shift.html#cb370-556" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb370-557"><a href="simulace3shift.html#cb370-557" tabindex="-1"></a>    </span>
<span id="cb370-558"><a href="simulace3shift.html#cb370-558" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-559"><a href="simulace3shift.html#cb370-559" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-560"><a href="simulace3shift.html#cb370-560" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb370-561"><a href="simulace3shift.html#cb370-561" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-562"><a href="simulace3shift.html#cb370-562" tabindex="-1"></a>    </span>
<span id="cb370-563"><a href="simulace3shift.html#cb370-563" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-564"><a href="simulace3shift.html#cb370-564" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb370-565"><a href="simulace3shift.html#cb370-565" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-566"><a href="simulace3shift.html#cb370-566" tabindex="-1"></a>    </span>
<span id="cb370-567"><a href="simulace3shift.html#cb370-567" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb370-568"><a href="simulace3shift.html#cb370-568" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb370-569"><a href="simulace3shift.html#cb370-569" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-570"><a href="simulace3shift.html#cb370-570" tabindex="-1"></a>      </span>
<span id="cb370-571"><a href="simulace3shift.html#cb370-571" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb370-572"><a href="simulace3shift.html#cb370-572" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-573"><a href="simulace3shift.html#cb370-573" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb370-574"><a href="simulace3shift.html#cb370-574" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-575"><a href="simulace3shift.html#cb370-575" tabindex="-1"></a>    </span>
<span id="cb370-576"><a href="simulace3shift.html#cb370-576" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-577"><a href="simulace3shift.html#cb370-577" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb370-578"><a href="simulace3shift.html#cb370-578" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-579"><a href="simulace3shift.html#cb370-579" tabindex="-1"></a>    </span>
<span id="cb370-580"><a href="simulace3shift.html#cb370-580" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb370-581"><a href="simulace3shift.html#cb370-581" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb370-582"><a href="simulace3shift.html#cb370-582" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-583"><a href="simulace3shift.html#cb370-583" tabindex="-1"></a>    </span>
<span id="cb370-584"><a href="simulace3shift.html#cb370-584" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb370-585"><a href="simulace3shift.html#cb370-585" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb370-586"><a href="simulace3shift.html#cb370-586" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb370-587"><a href="simulace3shift.html#cb370-587" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb370-588"><a href="simulace3shift.html#cb370-588" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb370-589"><a href="simulace3shift.html#cb370-589" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb370-590"><a href="simulace3shift.html#cb370-590" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb370-591"><a href="simulace3shift.html#cb370-591" tabindex="-1"></a>    </span>
<span id="cb370-592"><a href="simulace3shift.html#cb370-592" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-593"><a href="simulace3shift.html#cb370-593" tabindex="-1"></a>    </span>
<span id="cb370-594"><a href="simulace3shift.html#cb370-594" tabindex="-1"></a>    <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb370-595"><a href="simulace3shift.html#cb370-595" tabindex="-1"></a>    </span>
<span id="cb370-596"><a href="simulace3shift.html#cb370-596" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-597"><a href="simulace3shift.html#cb370-597" tabindex="-1"></a>    clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb370-598"><a href="simulace3shift.html#cb370-598" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-599"><a href="simulace3shift.html#cb370-599" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-600"><a href="simulace3shift.html#cb370-600" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb370-601"><a href="simulace3shift.html#cb370-601" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb370-602"><a href="simulace3shift.html#cb370-602" tabindex="-1"></a>    </span>
<span id="cb370-603"><a href="simulace3shift.html#cb370-603" tabindex="-1"></a>    clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb370-604"><a href="simulace3shift.html#cb370-604" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-605"><a href="simulace3shift.html#cb370-605" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-606"><a href="simulace3shift.html#cb370-606" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-607"><a href="simulace3shift.html#cb370-607" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb370-608"><a href="simulace3shift.html#cb370-608" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb370-609"><a href="simulace3shift.html#cb370-609" tabindex="-1"></a>    </span>
<span id="cb370-610"><a href="simulace3shift.html#cb370-610" tabindex="-1"></a>    clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb370-611"><a href="simulace3shift.html#cb370-611" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-612"><a href="simulace3shift.html#cb370-612" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-613"><a href="simulace3shift.html#cb370-613" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb370-614"><a href="simulace3shift.html#cb370-614" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="fl">0.005</span>,</span>
<span id="cb370-615"><a href="simulace3shift.html#cb370-615" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb370-616"><a href="simulace3shift.html#cb370-616" tabindex="-1"></a>    </span>
<span id="cb370-617"><a href="simulace3shift.html#cb370-617" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-618"><a href="simulace3shift.html#cb370-618" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb370-619"><a href="simulace3shift.html#cb370-619" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb370-620"><a href="simulace3shift.html#cb370-620" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-621"><a href="simulace3shift.html#cb370-621" tabindex="-1"></a>    </span>
<span id="cb370-622"><a href="simulace3shift.html#cb370-622" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb370-623"><a href="simulace3shift.html#cb370-623" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb370-624"><a href="simulace3shift.html#cb370-624" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-625"><a href="simulace3shift.html#cb370-625" tabindex="-1"></a>    </span>
<span id="cb370-626"><a href="simulace3shift.html#cb370-626" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb370-627"><a href="simulace3shift.html#cb370-627" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb370-628"><a href="simulace3shift.html#cb370-628" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-629"><a href="simulace3shift.html#cb370-629" tabindex="-1"></a>      </span>
<span id="cb370-630"><a href="simulace3shift.html#cb370-630" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-631"><a href="simulace3shift.html#cb370-631" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb370-632"><a href="simulace3shift.html#cb370-632" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb370-633"><a href="simulace3shift.html#cb370-633" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-634"><a href="simulace3shift.html#cb370-634" tabindex="-1"></a>    </span>
<span id="cb370-635"><a href="simulace3shift.html#cb370-635" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb370-636"><a href="simulace3shift.html#cb370-636" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb370-637"><a href="simulace3shift.html#cb370-637" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-638"><a href="simulace3shift.html#cb370-638" tabindex="-1"></a>    </span>
<span id="cb370-639"><a href="simulace3shift.html#cb370-639" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb370-640"><a href="simulace3shift.html#cb370-640" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb370-641"><a href="simulace3shift.html#cb370-641" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-642"><a href="simulace3shift.html#cb370-642" tabindex="-1"></a>    </span>
<span id="cb370-643"><a href="simulace3shift.html#cb370-643" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb370-644"><a href="simulace3shift.html#cb370-644" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb370-645"><a href="simulace3shift.html#cb370-645" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb370-646"><a href="simulace3shift.html#cb370-646" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb370-647"><a href="simulace3shift.html#cb370-647" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb370-648"><a href="simulace3shift.html#cb370-648" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb370-649"><a href="simulace3shift.html#cb370-649" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb370-650"><a href="simulace3shift.html#cb370-650" tabindex="-1"></a>  </span>
<span id="cb370-651"><a href="simulace3shift.html#cb370-651" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-652"><a href="simulace3shift.html#cb370-652" tabindex="-1"></a>    </span>
<span id="cb370-653"><a href="simulace3shift.html#cb370-653" tabindex="-1"></a>    <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb370-654"><a href="simulace3shift.html#cb370-654" tabindex="-1"></a>    </span>
<span id="cb370-655"><a href="simulace3shift.html#cb370-655" tabindex="-1"></a>    <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb370-656"><a href="simulace3shift.html#cb370-656" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb370-657"><a href="simulace3shift.html#cb370-657" tabindex="-1"></a>    norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb370-658"><a href="simulace3shift.html#cb370-658" tabindex="-1"></a>    n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb370-659"><a href="simulace3shift.html#cb370-659" tabindex="-1"></a>    n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co">#length(t) + norder - 2 - 10</span></span>
<span id="cb370-660"><a href="simulace3shift.html#cb370-660" tabindex="-1"></a>    dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb370-661"><a href="simulace3shift.html#cb370-661" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb370-662"><a href="simulace3shift.html#cb370-662" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb370-663"><a href="simulace3shift.html#cb370-663" tabindex="-1"></a>                       <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb370-664"><a href="simulace3shift.html#cb370-664" tabindex="-1"></a>                       <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb370-665"><a href="simulace3shift.html#cb370-665" tabindex="-1"></a>    </span>
<span id="cb370-666"><a href="simulace3shift.html#cb370-666" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb370-667"><a href="simulace3shift.html#cb370-667" tabindex="-1"></a>      bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb370-668"><a href="simulace3shift.html#cb370-668" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d)</span>
<span id="cb370-669"><a href="simulace3shift.html#cb370-669" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb370-670"><a href="simulace3shift.html#cb370-670" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-671"><a href="simulace3shift.html#cb370-671" tabindex="-1"></a>      </span>
<span id="cb370-672"><a href="simulace3shift.html#cb370-672" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb370-673"><a href="simulace3shift.html#cb370-673" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb370-674"><a href="simulace3shift.html#cb370-674" tabindex="-1"></a>        cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb370-675"><a href="simulace3shift.html#cb370-675" tabindex="-1"></a>        </span>
<span id="cb370-676"><a href="simulace3shift.html#cb370-676" tabindex="-1"></a>        data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb370-677"><a href="simulace3shift.html#cb370-677" tabindex="-1"></a>        data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb370-678"><a href="simulace3shift.html#cb370-678" tabindex="-1"></a>        data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb370-679"><a href="simulace3shift.html#cb370-679" tabindex="-1"></a>        Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb370-680"><a href="simulace3shift.html#cb370-680" tabindex="-1"></a>        data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb370-681"><a href="simulace3shift.html#cb370-681" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-682"><a href="simulace3shift.html#cb370-682" tabindex="-1"></a>        clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb370-683"><a href="simulace3shift.html#cb370-683" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-684"><a href="simulace3shift.html#cb370-684" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-685"><a href="simulace3shift.html#cb370-685" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb370-686"><a href="simulace3shift.html#cb370-686" tabindex="-1"></a>        </span>
<span id="cb370-687"><a href="simulace3shift.html#cb370-687" tabindex="-1"></a>        clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb370-688"><a href="simulace3shift.html#cb370-688" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-689"><a href="simulace3shift.html#cb370-689" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-690"><a href="simulace3shift.html#cb370-690" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-691"><a href="simulace3shift.html#cb370-691" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb370-692"><a href="simulace3shift.html#cb370-692" tabindex="-1"></a>        </span>
<span id="cb370-693"><a href="simulace3shift.html#cb370-693" tabindex="-1"></a>        clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb370-694"><a href="simulace3shift.html#cb370-694" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-695"><a href="simulace3shift.html#cb370-695" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-696"><a href="simulace3shift.html#cb370-696" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb370-697"><a href="simulace3shift.html#cb370-697" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb370-698"><a href="simulace3shift.html#cb370-698" tabindex="-1"></a>        <span class="do">## linear kernel</span></span>
<span id="cb370-699"><a href="simulace3shift.html#cb370-699" tabindex="-1"></a>        predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb370-700"><a href="simulace3shift.html#cb370-700" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb370-701"><a href="simulace3shift.html#cb370-701" tabindex="-1"></a>        presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb370-702"><a href="simulace3shift.html#cb370-702" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-703"><a href="simulace3shift.html#cb370-703" tabindex="-1"></a>        <span class="do">## polynomial kernel</span></span>
<span id="cb370-704"><a href="simulace3shift.html#cb370-704" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb370-705"><a href="simulace3shift.html#cb370-705" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb370-706"><a href="simulace3shift.html#cb370-706" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb370-707"><a href="simulace3shift.html#cb370-707" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-708"><a href="simulace3shift.html#cb370-708" tabindex="-1"></a>        <span class="do">## radial kernel</span></span>
<span id="cb370-709"><a href="simulace3shift.html#cb370-709" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb370-710"><a href="simulace3shift.html#cb370-710" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb370-711"><a href="simulace3shift.html#cb370-711" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb370-712"><a href="simulace3shift.html#cb370-712" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-713"><a href="simulace3shift.html#cb370-713" tabindex="-1"></a>        </span>
<span id="cb370-714"><a href="simulace3shift.html#cb370-714" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb370-715"><a href="simulace3shift.html#cb370-715" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb370-716"><a href="simulace3shift.html#cb370-716" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb370-717"><a href="simulace3shift.html#cb370-717" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb370-718"><a href="simulace3shift.html#cb370-718" tabindex="-1"></a>      }</span>
<span id="cb370-719"><a href="simulace3shift.html#cb370-719" tabindex="-1"></a>    }</span>
<span id="cb370-720"><a href="simulace3shift.html#cb370-720" tabindex="-1"></a>    </span>
<span id="cb370-721"><a href="simulace3shift.html#cb370-721" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb370-722"><a href="simulace3shift.html#cb370-722" tabindex="-1"></a>    <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb370-723"><a href="simulace3shift.html#cb370-723" tabindex="-1"></a>      CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb370-724"><a href="simulace3shift.html#cb370-724" tabindex="-1"></a>    }</span>
<span id="cb370-725"><a href="simulace3shift.html#cb370-725" tabindex="-1"></a>    </span>
<span id="cb370-726"><a href="simulace3shift.html#cb370-726" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb370-727"><a href="simulace3shift.html#cb370-727" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb370-728"><a href="simulace3shift.html#cb370-728" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb370-729"><a href="simulace3shift.html#cb370-729" tabindex="-1"></a>    </span>
<span id="cb370-730"><a href="simulace3shift.html#cb370-730" tabindex="-1"></a>    <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb370-731"><a href="simulace3shift.html#cb370-731" tabindex="-1"></a>    CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb370-732"><a href="simulace3shift.html#cb370-732" tabindex="-1"></a>    </span>
<span id="cb370-733"><a href="simulace3shift.html#cb370-733" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb370-734"><a href="simulace3shift.html#cb370-734" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb370-735"><a href="simulace3shift.html#cb370-735" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb370-736"><a href="simulace3shift.html#cb370-736" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb370-737"><a href="simulace3shift.html#cb370-737" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb370-738"><a href="simulace3shift.html#cb370-738" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb370-739"><a href="simulace3shift.html#cb370-739" tabindex="-1"></a>    </span>
<span id="cb370-740"><a href="simulace3shift.html#cb370-740" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb370-741"><a href="simulace3shift.html#cb370-741" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb370-742"><a href="simulace3shift.html#cb370-742" tabindex="-1"></a>      bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb370-743"><a href="simulace3shift.html#cb370-743" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb370-744"><a href="simulace3shift.html#cb370-744" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb370-745"><a href="simulace3shift.html#cb370-745" tabindex="-1"></a>      </span>
<span id="cb370-746"><a href="simulace3shift.html#cb370-746" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb370-747"><a href="simulace3shift.html#cb370-747" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb370-748"><a href="simulace3shift.html#cb370-748" tabindex="-1"></a>      </span>
<span id="cb370-749"><a href="simulace3shift.html#cb370-749" tabindex="-1"></a>      data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb370-750"><a href="simulace3shift.html#cb370-750" tabindex="-1"></a>      data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb370-751"><a href="simulace3shift.html#cb370-751" tabindex="-1"></a>      </span>
<span id="cb370-752"><a href="simulace3shift.html#cb370-752" tabindex="-1"></a>      data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb370-753"><a href="simulace3shift.html#cb370-753" tabindex="-1"></a>      data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb370-754"><a href="simulace3shift.html#cb370-754" tabindex="-1"></a>      </span>
<span id="cb370-755"><a href="simulace3shift.html#cb370-755" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-756"><a href="simulace3shift.html#cb370-756" tabindex="-1"></a>      clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb370-757"><a href="simulace3shift.html#cb370-757" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-758"><a href="simulace3shift.html#cb370-758" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-759"><a href="simulace3shift.html#cb370-759" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-760"><a href="simulace3shift.html#cb370-760" tabindex="-1"></a>                                <span class="at">kernel =</span> kernel_type)</span>
<span id="cb370-761"><a href="simulace3shift.html#cb370-761" tabindex="-1"></a>      </span>
<span id="cb370-762"><a href="simulace3shift.html#cb370-762" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-763"><a href="simulace3shift.html#cb370-763" tabindex="-1"></a>      predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb370-764"><a href="simulace3shift.html#cb370-764" tabindex="-1"></a>      presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb370-765"><a href="simulace3shift.html#cb370-765" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-766"><a href="simulace3shift.html#cb370-766" tabindex="-1"></a>        </span>
<span id="cb370-767"><a href="simulace3shift.html#cb370-767" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-768"><a href="simulace3shift.html#cb370-768" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb370-769"><a href="simulace3shift.html#cb370-769" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-770"><a href="simulace3shift.html#cb370-770" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-771"><a href="simulace3shift.html#cb370-771" tabindex="-1"></a>      </span>
<span id="cb370-772"><a href="simulace3shift.html#cb370-772" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb370-773"><a href="simulace3shift.html#cb370-773" tabindex="-1"></a>      Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb370-774"><a href="simulace3shift.html#cb370-774" tabindex="-1"></a>    }</span>
<span id="cb370-775"><a href="simulace3shift.html#cb370-775" tabindex="-1"></a>    </span>
<span id="cb370-776"><a href="simulace3shift.html#cb370-776" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-777"><a href="simulace3shift.html#cb370-777" tabindex="-1"></a>    </span>
<span id="cb370-778"><a href="simulace3shift.html#cb370-778" tabindex="-1"></a>    <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb370-779"><a href="simulace3shift.html#cb370-779" tabindex="-1"></a>  </span>
<span id="cb370-780"><a href="simulace3shift.html#cb370-780" tabindex="-1"></a>    <span class="do">### Gaussovo jadro</span></span>
<span id="cb370-781"><a href="simulace3shift.html#cb370-781" tabindex="-1"></a>    </span>
<span id="cb370-782"><a href="simulace3shift.html#cb370-782" tabindex="-1"></a>    <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb370-783"><a href="simulace3shift.html#cb370-783" tabindex="-1"></a>    <span class="co"># Gauss.kernel &lt;- function(x, y, gamma) {</span></span>
<span id="cb370-784"><a href="simulace3shift.html#cb370-784" tabindex="-1"></a>    <span class="co">#   return(exp(-gamma * norm(c(x - y) |&gt; t(), type = &#39;F&#39;)))</span></span>
<span id="cb370-785"><a href="simulace3shift.html#cb370-785" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb370-786"><a href="simulace3shift.html#cb370-786" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb370-787"><a href="simulace3shift.html#cb370-787" tabindex="-1"></a>    <span class="co"># Kernel.RKHS &lt;- function(x, gamma) {</span></span>
<span id="cb370-788"><a href="simulace3shift.html#cb370-788" tabindex="-1"></a>    <span class="co">#   K &lt;- matrix(NA, ncol = length(x), nrow = length(x))</span></span>
<span id="cb370-789"><a href="simulace3shift.html#cb370-789" tabindex="-1"></a>    <span class="co">#   for(i in 1:nrow(K)) {</span></span>
<span id="cb370-790"><a href="simulace3shift.html#cb370-790" tabindex="-1"></a>    <span class="co">#     for(j in 1:ncol(K)) {</span></span>
<span id="cb370-791"><a href="simulace3shift.html#cb370-791" tabindex="-1"></a>    <span class="co">#       K[i, j] &lt;- Gauss.kernel(x = x[i], y = x[j], gamma = gamma)</span></span>
<span id="cb370-792"><a href="simulace3shift.html#cb370-792" tabindex="-1"></a>    <span class="co">#     }</span></span>
<span id="cb370-793"><a href="simulace3shift.html#cb370-793" tabindex="-1"></a>    <span class="co">#   }</span></span>
<span id="cb370-794"><a href="simulace3shift.html#cb370-794" tabindex="-1"></a>    <span class="co">#   return(K)</span></span>
<span id="cb370-795"><a href="simulace3shift.html#cb370-795" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb370-796"><a href="simulace3shift.html#cb370-796" tabindex="-1"></a>    </span>
<span id="cb370-797"><a href="simulace3shift.html#cb370-797" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb370-798"><a href="simulace3shift.html#cb370-798" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb370-799"><a href="simulace3shift.html#cb370-799" tabindex="-1"></a>    <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb370-800"><a href="simulace3shift.html#cb370-800" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb370-801"><a href="simulace3shift.html#cb370-801" tabindex="-1"></a>    </span>
<span id="cb370-802"><a href="simulace3shift.html#cb370-802" tabindex="-1"></a>    <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb370-803"><a href="simulace3shift.html#cb370-803" tabindex="-1"></a>    dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb370-804"><a href="simulace3shift.html#cb370-804" tabindex="-1"></a>    gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb370-805"><a href="simulace3shift.html#cb370-805" tabindex="-1"></a>    </span>
<span id="cb370-806"><a href="simulace3shift.html#cb370-806" tabindex="-1"></a>    <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb370-807"><a href="simulace3shift.html#cb370-807" tabindex="-1"></a>    <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb370-808"><a href="simulace3shift.html#cb370-808" tabindex="-1"></a>    <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb370-809"><a href="simulace3shift.html#cb370-809" tabindex="-1"></a>    <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb370-810"><a href="simulace3shift.html#cb370-810" tabindex="-1"></a>    dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb370-811"><a href="simulace3shift.html#cb370-811" tabindex="-1"></a>                      <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb370-812"><a href="simulace3shift.html#cb370-812" tabindex="-1"></a>                      <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb370-813"><a href="simulace3shift.html#cb370-813" tabindex="-1"></a>    </span>
<span id="cb370-814"><a href="simulace3shift.html#cb370-814" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb370-815"><a href="simulace3shift.html#cb370-815" tabindex="-1"></a>      <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb370-816"><a href="simulace3shift.html#cb370-816" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names),</span>
<span id="cb370-817"><a href="simulace3shift.html#cb370-817" tabindex="-1"></a>      <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb370-818"><a href="simulace3shift.html#cb370-818" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names),</span>
<span id="cb370-819"><a href="simulace3shift.html#cb370-819" tabindex="-1"></a>      <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb370-820"><a href="simulace3shift.html#cb370-820" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names))</span>
<span id="cb370-821"><a href="simulace3shift.html#cb370-821" tabindex="-1"></a>    </span>
<span id="cb370-822"><a href="simulace3shift.html#cb370-822" tabindex="-1"></a>    <span class="co"># samotna CV</span></span>
<span id="cb370-823"><a href="simulace3shift.html#cb370-823" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb370-824"><a href="simulace3shift.html#cb370-824" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb370-825"><a href="simulace3shift.html#cb370-825" tabindex="-1"></a>      Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb370-826"><a href="simulace3shift.html#cb370-826" tabindex="-1"></a>      eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb370-827"><a href="simulace3shift.html#cb370-827" tabindex="-1"></a>      eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb370-828"><a href="simulace3shift.html#cb370-828" tabindex="-1"></a>      alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb370-829"><a href="simulace3shift.html#cb370-829" tabindex="-1"></a>      </span>
<span id="cb370-830"><a href="simulace3shift.html#cb370-830" tabindex="-1"></a>      <span class="co"># model</span></span>
<span id="cb370-831"><a href="simulace3shift.html#cb370-831" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb370-832"><a href="simulace3shift.html#cb370-832" tabindex="-1"></a>        df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb370-833"><a href="simulace3shift.html#cb370-833" tabindex="-1"></a>                             <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb370-834"><a href="simulace3shift.html#cb370-834" tabindex="-1"></a>        svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb370-835"><a href="simulace3shift.html#cb370-835" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb370-836"><a href="simulace3shift.html#cb370-836" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb370-837"><a href="simulace3shift.html#cb370-837" tabindex="-1"></a>                        <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb370-838"><a href="simulace3shift.html#cb370-838" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma)</span>
<span id="cb370-839"><a href="simulace3shift.html#cb370-839" tabindex="-1"></a>        alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb370-840"><a href="simulace3shift.html#cb370-840" tabindex="-1"></a>      }</span>
<span id="cb370-841"><a href="simulace3shift.html#cb370-841" tabindex="-1"></a>      </span>
<span id="cb370-842"><a href="simulace3shift.html#cb370-842" tabindex="-1"></a>      <span class="co"># projdeme dimenze</span></span>
<span id="cb370-843"><a href="simulace3shift.html#cb370-843" tabindex="-1"></a>      <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb370-844"><a href="simulace3shift.html#cb370-844" tabindex="-1"></a>        Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb370-845"><a href="simulace3shift.html#cb370-845" tabindex="-1"></a>                              <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb370-846"><a href="simulace3shift.html#cb370-846" tabindex="-1"></a>                              <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb370-847"><a href="simulace3shift.html#cb370-847" tabindex="-1"></a>        <span class="co"># vypocet reprezentace</span></span>
<span id="cb370-848"><a href="simulace3shift.html#cb370-848" tabindex="-1"></a>        <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb370-849"><a href="simulace3shift.html#cb370-849" tabindex="-1"></a>          Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb370-850"><a href="simulace3shift.html#cb370-850" tabindex="-1"></a>                                 alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb370-851"><a href="simulace3shift.html#cb370-851" tabindex="-1"></a>        }</span>
<span id="cb370-852"><a href="simulace3shift.html#cb370-852" tabindex="-1"></a>        <span class="co"># projdeme folds</span></span>
<span id="cb370-853"><a href="simulace3shift.html#cb370-853" tabindex="-1"></a>        <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb370-854"><a href="simulace3shift.html#cb370-854" tabindex="-1"></a>          <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb370-855"><a href="simulace3shift.html#cb370-855" tabindex="-1"></a>          fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb370-856"><a href="simulace3shift.html#cb370-856" tabindex="-1"></a>          <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb370-857"><a href="simulace3shift.html#cb370-857" tabindex="-1"></a>          XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb370-858"><a href="simulace3shift.html#cb370-858" tabindex="-1"></a>          XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb370-859"><a href="simulace3shift.html#cb370-859" tabindex="-1"></a>          <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb370-860"><a href="simulace3shift.html#cb370-860" tabindex="-1"></a>          Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb370-861"><a href="simulace3shift.html#cb370-861" tabindex="-1"></a>                                      <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb370-862"><a href="simulace3shift.html#cb370-862" tabindex="-1"></a>                                      <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb370-863"><a href="simulace3shift.html#cb370-863" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb370-864"><a href="simulace3shift.html#cb370-864" tabindex="-1"></a>          <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb370-865"><a href="simulace3shift.html#cb370-865" tabindex="-1"></a>          <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb370-866"><a href="simulace3shift.html#cb370-866" tabindex="-1"></a>            kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb370-867"><a href="simulace3shift.html#cb370-867" tabindex="-1"></a>          </span>
<span id="cb370-868"><a href="simulace3shift.html#cb370-868" tabindex="-1"></a>            data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb370-869"><a href="simulace3shift.html#cb370-869" tabindex="-1"></a>            data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb370-870"><a href="simulace3shift.html#cb370-870" tabindex="-1"></a>            </span>
<span id="cb370-871"><a href="simulace3shift.html#cb370-871" tabindex="-1"></a>            data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb370-872"><a href="simulace3shift.html#cb370-872" tabindex="-1"></a>            data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb370-873"><a href="simulace3shift.html#cb370-873" tabindex="-1"></a>            </span>
<span id="cb370-874"><a href="simulace3shift.html#cb370-874" tabindex="-1"></a>            <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-875"><a href="simulace3shift.html#cb370-875" tabindex="-1"></a>            clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb370-876"><a href="simulace3shift.html#cb370-876" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-877"><a href="simulace3shift.html#cb370-877" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-878"><a href="simulace3shift.html#cb370-878" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-879"><a href="simulace3shift.html#cb370-879" tabindex="-1"></a>                                <span class="at">kernel =</span> kernel_type)</span>
<span id="cb370-880"><a href="simulace3shift.html#cb370-880" tabindex="-1"></a>            </span>
<span id="cb370-881"><a href="simulace3shift.html#cb370-881" tabindex="-1"></a>            <span class="co"># presnost na validacnich datech</span></span>
<span id="cb370-882"><a href="simulace3shift.html#cb370-882" tabindex="-1"></a>            predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb370-883"><a href="simulace3shift.html#cb370-883" tabindex="-1"></a>            presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-884"><a href="simulace3shift.html#cb370-884" tabindex="-1"></a>              <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-885"><a href="simulace3shift.html#cb370-885" tabindex="-1"></a>            </span>
<span id="cb370-886"><a href="simulace3shift.html#cb370-886" tabindex="-1"></a>            <span class="co"># ulozeni vysledku</span></span>
<span id="cb370-887"><a href="simulace3shift.html#cb370-887" tabindex="-1"></a>            Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb370-888"><a href="simulace3shift.html#cb370-888" tabindex="-1"></a>          }</span>
<span id="cb370-889"><a href="simulace3shift.html#cb370-889" tabindex="-1"></a>          <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb370-890"><a href="simulace3shift.html#cb370-890" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb370-891"><a href="simulace3shift.html#cb370-891" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb370-892"><a href="simulace3shift.html#cb370-892" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb370-893"><a href="simulace3shift.html#cb370-893" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb370-894"><a href="simulace3shift.html#cb370-894" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb370-895"><a href="simulace3shift.html#cb370-895" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb370-896"><a href="simulace3shift.html#cb370-896" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb370-897"><a href="simulace3shift.html#cb370-897" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb370-898"><a href="simulace3shift.html#cb370-898" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb370-899"><a href="simulace3shift.html#cb370-899" tabindex="-1"></a>        }</span>
<span id="cb370-900"><a href="simulace3shift.html#cb370-900" tabindex="-1"></a>      }</span>
<span id="cb370-901"><a href="simulace3shift.html#cb370-901" tabindex="-1"></a>    }</span>
<span id="cb370-902"><a href="simulace3shift.html#cb370-902" tabindex="-1"></a>    </span>
<span id="cb370-903"><a href="simulace3shift.html#cb370-903" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb370-904"><a href="simulace3shift.html#cb370-904" tabindex="-1"></a>    <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb370-905"><a href="simulace3shift.html#cb370-905" tabindex="-1"></a>      CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb370-906"><a href="simulace3shift.html#cb370-906" tabindex="-1"></a>    }</span>
<span id="cb370-907"><a href="simulace3shift.html#cb370-907" tabindex="-1"></a>    </span>
<span id="cb370-908"><a href="simulace3shift.html#cb370-908" tabindex="-1"></a>    gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb370-909"><a href="simulace3shift.html#cb370-909" tabindex="-1"></a>                   <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb370-910"><a href="simulace3shift.html#cb370-910" tabindex="-1"></a>                   <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb370-911"><a href="simulace3shift.html#cb370-911" tabindex="-1"></a>    gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb370-912"><a href="simulace3shift.html#cb370-912" tabindex="-1"></a>    gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb370-913"><a href="simulace3shift.html#cb370-913" tabindex="-1"></a>    </span>
<span id="cb370-914"><a href="simulace3shift.html#cb370-914" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb370-915"><a href="simulace3shift.html#cb370-915" tabindex="-1"></a>               <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb370-916"><a href="simulace3shift.html#cb370-916" tabindex="-1"></a>               <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb370-917"><a href="simulace3shift.html#cb370-917" tabindex="-1"></a>    d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb370-918"><a href="simulace3shift.html#cb370-918" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb370-919"><a href="simulace3shift.html#cb370-919" tabindex="-1"></a>    </span>
<span id="cb370-920"><a href="simulace3shift.html#cb370-920" tabindex="-1"></a>    err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb370-921"><a href="simulace3shift.html#cb370-921" tabindex="-1"></a>                         <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb370-922"><a href="simulace3shift.html#cb370-922" tabindex="-1"></a>                         <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb370-923"><a href="simulace3shift.html#cb370-923" tabindex="-1"></a>    df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb370-924"><a href="simulace3shift.html#cb370-924" tabindex="-1"></a>               <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb370-925"><a href="simulace3shift.html#cb370-925" tabindex="-1"></a>               <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb370-926"><a href="simulace3shift.html#cb370-926" tabindex="-1"></a>    </span>
<span id="cb370-927"><a href="simulace3shift.html#cb370-927" tabindex="-1"></a>    <span class="co"># CV_RESULTS$SVM_RKHS_radial_gamma[sim] &lt;- gamma.opt</span></span>
<span id="cb370-928"><a href="simulace3shift.html#cb370-928" tabindex="-1"></a>    <span class="co"># CV_RESULTS$SVM_RKHS_radial_d[sim] &lt;- d.opt</span></span>
<span id="cb370-929"><a href="simulace3shift.html#cb370-929" tabindex="-1"></a>    </span>
<span id="cb370-930"><a href="simulace3shift.html#cb370-930" tabindex="-1"></a>    <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb370-931"><a href="simulace3shift.html#cb370-931" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb370-932"><a href="simulace3shift.html#cb370-932" tabindex="-1"></a>    <span class="co"># pridame i testovaci data</span></span>
<span id="cb370-933"><a href="simulace3shift.html#cb370-933" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb370-934"><a href="simulace3shift.html#cb370-934" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb370-935"><a href="simulace3shift.html#cb370-935" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb370-936"><a href="simulace3shift.html#cb370-936" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb370-937"><a href="simulace3shift.html#cb370-937" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb370-938"><a href="simulace3shift.html#cb370-938" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb370-939"><a href="simulace3shift.html#cb370-939" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb370-940"><a href="simulace3shift.html#cb370-940" tabindex="-1"></a>    </span>
<span id="cb370-941"><a href="simulace3shift.html#cb370-941" tabindex="-1"></a>    <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb370-942"><a href="simulace3shift.html#cb370-942" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb370-943"><a href="simulace3shift.html#cb370-943" tabindex="-1"></a>      <span class="co"># spocitame matici K</span></span>
<span id="cb370-944"><a href="simulace3shift.html#cb370-944" tabindex="-1"></a>      gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb370-945"><a href="simulace3shift.html#cb370-945" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb370-946"><a href="simulace3shift.html#cb370-946" tabindex="-1"></a>      </span>
<span id="cb370-947"><a href="simulace3shift.html#cb370-947" tabindex="-1"></a>      <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb370-948"><a href="simulace3shift.html#cb370-948" tabindex="-1"></a>      Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb370-949"><a href="simulace3shift.html#cb370-949" tabindex="-1"></a>      eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb370-950"><a href="simulace3shift.html#cb370-950" tabindex="-1"></a>      eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb370-951"><a href="simulace3shift.html#cb370-951" tabindex="-1"></a>      <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb370-952"><a href="simulace3shift.html#cb370-952" tabindex="-1"></a>      alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb370-953"><a href="simulace3shift.html#cb370-953" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb370-954"><a href="simulace3shift.html#cb370-954" tabindex="-1"></a>      </span>
<span id="cb370-955"><a href="simulace3shift.html#cb370-955" tabindex="-1"></a>      <span class="co"># model</span></span>
<span id="cb370-956"><a href="simulace3shift.html#cb370-956" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb370-957"><a href="simulace3shift.html#cb370-957" tabindex="-1"></a>        df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb370-958"><a href="simulace3shift.html#cb370-958" tabindex="-1"></a>                             <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb370-959"><a href="simulace3shift.html#cb370-959" tabindex="-1"></a>        svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb370-960"><a href="simulace3shift.html#cb370-960" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb370-961"><a href="simulace3shift.html#cb370-961" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb370-962"><a href="simulace3shift.html#cb370-962" tabindex="-1"></a>                        <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb370-963"><a href="simulace3shift.html#cb370-963" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma)</span>
<span id="cb370-964"><a href="simulace3shift.html#cb370-964" tabindex="-1"></a>        <span class="co"># urceni alpha</span></span>
<span id="cb370-965"><a href="simulace3shift.html#cb370-965" tabindex="-1"></a>        alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb370-966"><a href="simulace3shift.html#cb370-966" tabindex="-1"></a>      }</span>
<span id="cb370-967"><a href="simulace3shift.html#cb370-967" tabindex="-1"></a>      <span class="co"># d</span></span>
<span id="cb370-968"><a href="simulace3shift.html#cb370-968" tabindex="-1"></a>      d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb370-969"><a href="simulace3shift.html#cb370-969" tabindex="-1"></a>      </span>
<span id="cb370-970"><a href="simulace3shift.html#cb370-970" tabindex="-1"></a>      <span class="co"># urceni vektoru lambda</span></span>
<span id="cb370-971"><a href="simulace3shift.html#cb370-971" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb370-972"><a href="simulace3shift.html#cb370-972" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb370-973"><a href="simulace3shift.html#cb370-973" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb370-974"><a href="simulace3shift.html#cb370-974" tabindex="-1"></a>      </span>
<span id="cb370-975"><a href="simulace3shift.html#cb370-975" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb370-976"><a href="simulace3shift.html#cb370-976" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb370-977"><a href="simulace3shift.html#cb370-977" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb370-978"><a href="simulace3shift.html#cb370-978" tabindex="-1"></a>      }</span>
<span id="cb370-979"><a href="simulace3shift.html#cb370-979" tabindex="-1"></a>      </span>
<span id="cb370-980"><a href="simulace3shift.html#cb370-980" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb370-981"><a href="simulace3shift.html#cb370-981" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb370-982"><a href="simulace3shift.html#cb370-982" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb370-983"><a href="simulace3shift.html#cb370-983" tabindex="-1"></a>    </span>
<span id="cb370-984"><a href="simulace3shift.html#cb370-984" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb370-985"><a href="simulace3shift.html#cb370-985" tabindex="-1"></a>    </span>
<span id="cb370-986"><a href="simulace3shift.html#cb370-986" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb370-987"><a href="simulace3shift.html#cb370-987" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb370-988"><a href="simulace3shift.html#cb370-988" tabindex="-1"></a>      </span>
<span id="cb370-989"><a href="simulace3shift.html#cb370-989" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb370-990"><a href="simulace3shift.html#cb370-990" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb370-991"><a href="simulace3shift.html#cb370-991" tabindex="-1"></a>      </span>
<span id="cb370-992"><a href="simulace3shift.html#cb370-992" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb370-993"><a href="simulace3shift.html#cb370-993" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb370-994"><a href="simulace3shift.html#cb370-994" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb370-995"><a href="simulace3shift.html#cb370-995" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb370-996"><a href="simulace3shift.html#cb370-996" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb370-997"><a href="simulace3shift.html#cb370-997" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type)</span>
<span id="cb370-998"><a href="simulace3shift.html#cb370-998" tabindex="-1"></a>      </span>
<span id="cb370-999"><a href="simulace3shift.html#cb370-999" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb370-1000"><a href="simulace3shift.html#cb370-1000" tabindex="-1"></a>      predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb370-1001"><a href="simulace3shift.html#cb370-1001" tabindex="-1"></a>      presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb370-1002"><a href="simulace3shift.html#cb370-1002" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-1003"><a href="simulace3shift.html#cb370-1003" tabindex="-1"></a>        </span>
<span id="cb370-1004"><a href="simulace3shift.html#cb370-1004" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb370-1005"><a href="simulace3shift.html#cb370-1005" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb370-1006"><a href="simulace3shift.html#cb370-1006" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb370-1007"><a href="simulace3shift.html#cb370-1007" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb370-1008"><a href="simulace3shift.html#cb370-1008" tabindex="-1"></a>      </span>
<span id="cb370-1009"><a href="simulace3shift.html#cb370-1009" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb370-1010"><a href="simulace3shift.html#cb370-1010" tabindex="-1"></a>      Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb370-1011"><a href="simulace3shift.html#cb370-1011" tabindex="-1"></a>    }</span>
<span id="cb370-1012"><a href="simulace3shift.html#cb370-1012" tabindex="-1"></a>    </span>
<span id="cb370-1013"><a href="simulace3shift.html#cb370-1013" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb370-1014"><a href="simulace3shift.html#cb370-1014" tabindex="-1"></a></span>
<span id="cb370-1015"><a href="simulace3shift.html#cb370-1015" tabindex="-1"></a>    <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb370-1016"><a href="simulace3shift.html#cb370-1016" tabindex="-1"></a>    </span>
<span id="cb370-1017"><a href="simulace3shift.html#cb370-1017" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb370-1018"><a href="simulace3shift.html#cb370-1018" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb370-1019"><a href="simulace3shift.html#cb370-1019" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, <span class="fu">paste0</span>(n_shift, <span class="st">&#39;: &#39;</span>, sim))</span>
<span id="cb370-1020"><a href="simulace3shift.html#cb370-1020" tabindex="-1"></a>  }</span>
<span id="cb370-1021"><a href="simulace3shift.html#cb370-1021" tabindex="-1"></a>  </span>
<span id="cb370-1022"><a href="simulace3shift.html#cb370-1022" tabindex="-1"></a>  <span class="co"># Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</span></span>
<span id="cb370-1023"><a href="simulace3shift.html#cb370-1023" tabindex="-1"></a>  </span>
<span id="cb370-1024"><a href="simulace3shift.html#cb370-1024" tabindex="-1"></a>  <span class="co"># dame do vysledne tabulky</span></span>
<span id="cb370-1025"><a href="simulace3shift.html#cb370-1025" tabindex="-1"></a>  </span>
<span id="cb370-1026"><a href="simulace3shift.html#cb370-1026" tabindex="-1"></a>  SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb370-1027"><a href="simulace3shift.html#cb370-1027" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb370-1028"><a href="simulace3shift.html#cb370-1028" tabindex="-1"></a>                            <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb370-1029"><a href="simulace3shift.html#cb370-1029" tabindex="-1"></a>                            <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb370-1030"><a href="simulace3shift.html#cb370-1030" tabindex="-1"></a>  </span>
<span id="cb370-1031"><a href="simulace3shift.html#cb370-1031" tabindex="-1"></a>  SIMUL_params[, , n_shift] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SIMULACE.df)</span>
<span id="cb370-1032"><a href="simulace3shift.html#cb370-1032" tabindex="-1"></a>}</span>
<span id="cb370-1033"><a href="simulace3shift.html#cb370-1033" tabindex="-1"></a></span>
<span id="cb370-1034"><a href="simulace3shift.html#cb370-1034" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb370-1035"><a href="simulace3shift.html#cb370-1035" tabindex="-1"></a><span class="fu">save</span>(SIMUL_params, <span class="at">file =</span> <span class="st">&#39;RData/simulace_parametry_shift_03_rf_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="graphical-output-1" class="section level3 hasAnchor" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Graphical Output<a href="simulace3shift.html#graphical-output-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine the dependence of the simulated results on the value of the standard deviation parameter for the normal distribution of measurement errors. First, we’ll plot the data for training errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb371"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb371-1"><a href="simulace3shift.html#cb371-1" tabindex="-1"></a><span class="co"># For training data</span></span>
<span id="cb371-2"><a href="simulace3shift.html#cb371-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb371-3"><a href="simulace3shift.html#cb371-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span>   </span>
<span id="cb371-4"><a href="simulace3shift.html#cb371-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb371-5"><a href="simulace3shift.html#cb371-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(shift_vector), </span>
<span id="cb371-6"><a href="simulace3shift.html#cb371-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;shift&#39;</span>, </span>
<span id="cb371-7"><a href="simulace3shift.html#cb371-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb371-8"><a href="simulace3shift.html#cb371-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb371-9"><a href="simulace3shift.html#cb371-9" tabindex="-1"></a>         <span class="at">shift =</span> <span class="fu">as.numeric</span>(shift)) <span class="sc">|&gt;</span> </span>
<span id="cb371-10"><a href="simulace3shift.html#cb371-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb371-11"><a href="simulace3shift.html#cb371-11" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb371-12"><a href="simulace3shift.html#cb371-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb371-13"><a href="simulace3shift.html#cb371-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[shift]),</span>
<span id="cb371-14"><a href="simulace3shift.html#cb371-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train]),</span>
<span id="cb371-15"><a href="simulace3shift.html#cb371-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb371-16"><a href="simulace3shift.html#cb371-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-83"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-83-1.png" alt="Graph of the dependence of training error for individual classification methods on the value of the parameter $\sigma_{shift}$, which defines the standard deviation for generating random vertical shifts." width="672" />
<p class="caption">
Figure 3.3: Graph of the dependence of training error for individual classification methods on the value of the parameter <span class="math inline">\(\sigma_{shift}\)</span>, which defines the standard deviation for generating random vertical shifts.
</p>
</div>
<p>Next, we’ll plot the data for test errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb372"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb372-1"><a href="simulace3shift.html#cb372-1" tabindex="-1"></a><span class="co"># For test data</span></span>
<span id="cb372-2"><a href="simulace3shift.html#cb372-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb372-3"><a href="simulace3shift.html#cb372-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span>   </span>
<span id="cb372-4"><a href="simulace3shift.html#cb372-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb372-5"><a href="simulace3shift.html#cb372-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(shift_vector), </span>
<span id="cb372-6"><a href="simulace3shift.html#cb372-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;shift&#39;</span>, </span>
<span id="cb372-7"><a href="simulace3shift.html#cb372-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb372-8"><a href="simulace3shift.html#cb372-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb372-9"><a href="simulace3shift.html#cb372-9" tabindex="-1"></a>         <span class="at">shift =</span> <span class="fu">as.numeric</span>(shift)) <span class="sc">|&gt;</span> </span>
<span id="cb372-10"><a href="simulace3shift.html#cb372-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb372-11"><a href="simulace3shift.html#cb372-11" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb372-12"><a href="simulace3shift.html#cb372-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb372-13"><a href="simulace3shift.html#cb372-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[shift]),</span>
<span id="cb372-14"><a href="simulace3shift.html#cb372-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test]),</span>
<span id="cb372-15"><a href="simulace3shift.html#cb372-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb372-16"><a href="simulace3shift.html#cb372-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-84"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-84-1.png" alt="Graph of the dependence of test error for individual classification methods on the value of the parameter $\sigma_{shift}$, which defines the standard deviation for generating random vertical shifts." width="672" />
<p class="caption">
Figure 3.4: Graph of the dependence of test error for individual classification methods on the value of the parameter <span class="math inline">\(\sigma_{shift}\)</span>, which defines the standard deviation for generating random vertical shifts.
</p>
</div>
<p>Since the results are subject to random fluctuations and increasing the number of repetitions $ n_{} $ would be computationally intensive, we will now smooth the curves of the average test and training errors. Given that error rates are non-negative, we will perform the smoothing with this in mind. Additionally, to ensure that the smoothed curves closely follow the observed discrete values, we will consider different weights for small and large values of $ $.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb373"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb373-1"><a href="simulace3shift.html#cb373-1" tabindex="-1"></a>methods_subset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, <span class="st">&#39;SVM linear - diskr&#39;</span>,</span>
<span id="cb373-2"><a href="simulace3shift.html#cb373-2" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM linear - Bbasis&#39;</span>,</span>
<span id="cb373-3"><a href="simulace3shift.html#cb373-3" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>)</span>
<span id="cb373-4"><a href="simulace3shift.html#cb373-4" tabindex="-1"></a></span>
<span id="cb373-5"><a href="simulace3shift.html#cb373-5" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb373-6"><a href="simulace3shift.html#cb373-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb373-7"><a href="simulace3shift.html#cb373-7" tabindex="-1"></a></span>
<span id="cb373-8"><a href="simulace3shift.html#cb373-8" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> shift_vector</span>
<span id="cb373-9"><a href="simulace3shift.html#cb373-9" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb373-10"><a href="simulace3shift.html#cb373-10" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb373-11"><a href="simulace3shift.html#cb373-11" tabindex="-1"></a></span>
<span id="cb373-12"><a href="simulace3shift.html#cb373-12" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb373-13"><a href="simulace3shift.html#cb373-13" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb373-14"><a href="simulace3shift.html#cb373-14" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb373-15"><a href="simulace3shift.html#cb373-15" tabindex="-1"></a></span>
<span id="cb373-16"><a href="simulace3shift.html#cb373-16" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb373-17"><a href="simulace3shift.html#cb373-17" tabindex="-1"></a></span>
<span id="cb373-18"><a href="simulace3shift.html#cb373-18" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># Vector of lambdas</span></span>
<span id="cb373-19"><a href="simulace3shift.html#cb373-19" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># Empty vector for storing GCV</span></span>
<span id="cb373-20"><a href="simulace3shift.html#cb373-20" tabindex="-1"></a></span>
<span id="cb373-21"><a href="simulace3shift.html#cb373-21" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb373-22"><a href="simulace3shift.html#cb373-22" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb373-23"><a href="simulace3shift.html#cb373-23" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.Fdpar) <span class="co"># Smoothing</span></span>
<span id="cb373-24"><a href="simulace3shift.html#cb373-24" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># Average over all observed curves</span></span>
<span id="cb373-25"><a href="simulace3shift.html#cb373-25" tabindex="-1"></a>}</span>
<span id="cb373-26"><a href="simulace3shift.html#cb373-26" tabindex="-1"></a></span>
<span id="cb373-27"><a href="simulace3shift.html#cb373-27" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb373-28"><a href="simulace3shift.html#cb373-28" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb373-29"><a href="simulace3shift.html#cb373-29" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb373-30"><a href="simulace3shift.html#cb373-30" tabindex="-1"></a>)</span>
<span id="cb373-31"><a href="simulace3shift.html#cb373-31" tabindex="-1"></a></span>
<span id="cb373-32"><a href="simulace3shift.html#cb373-32" tabindex="-1"></a><span class="co"># Find the minimum value</span></span>
<span id="cb373-33"><a href="simulace3shift.html#cb373-33" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb373-34"><a href="simulace3shift.html#cb373-34" tabindex="-1"></a></span>
<span id="cb373-35"><a href="simulace3shift.html#cb373-35" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb373-36"><a href="simulace3shift.html#cb373-36" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.fdPar) <span class="co"># Smooth position</span></span>
<span id="cb373-37"><a href="simulace3shift.html#cb373-37" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd <span class="co"># Wfdobj</span></span>
<span id="cb373-38"><a href="simulace3shift.html#cb373-38" tabindex="-1"></a></span>
<span id="cb373-39"><a href="simulace3shift.html#cb373-39" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd,  <span class="co"># eval.posfd</span></span>
<span id="cb373-40"><a href="simulace3shift.html#cb373-40" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(breaks), <span class="fu">max</span>(breaks),</span>
<span id="cb373-41"><a href="simulace3shift.html#cb373-41" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb373-42"><a href="simulace3shift.html#cb373-42" tabindex="-1"></a></span>
<span id="cb373-43"><a href="simulace3shift.html#cb373-43" tabindex="-1"></a>df_plot_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb373-44"><a href="simulace3shift.html#cb373-44" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb373-45"><a href="simulace3shift.html#cb373-45" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb373-46"><a href="simulace3shift.html#cb373-46" tabindex="-1"></a>  <span class="at">shift =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(breaks), <span class="fu">max</span>(breaks), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb373-47"><a href="simulace3shift.html#cb373-47" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb373-48"><a href="simulace3shift.html#cb373-48" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb373-49"><a href="simulace3shift.html#cb373-49" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb373-50"><a href="simulace3shift.html#cb373-50" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
</details>
<p>To enhance clarity, we will plot the graphs only for a subset of methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb374"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb374-1"><a href="simulace3shift.html#cb374-1" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb374-2"><a href="simulace3shift.html#cb374-2" tabindex="-1"></a>      <span class="st">&#39;$K$ Nearest Neighbors&#39;</span>,</span>
<span id="cb374-3"><a href="simulace3shift.html#cb374-3" tabindex="-1"></a>      <span class="st">&#39;Functional Logistic Regression&#39;</span>,</span>
<span id="cb374-4"><a href="simulace3shift.html#cb374-4" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- Basis Coefficients&#39;</span>,</span>
<span id="cb374-5"><a href="simulace3shift.html#cb374-5" tabindex="-1"></a>      <span class="st">&#39;SVM (Linear) -- Discretization&#39;</span>,</span>
<span id="cb374-6"><a href="simulace3shift.html#cb374-6" tabindex="-1"></a>      <span class="st">&#39;SVM (Linear) -- fPCA&#39;</span>,</span>
<span id="cb374-7"><a href="simulace3shift.html#cb374-7" tabindex="-1"></a>      <span class="st">&#39;SVM (Linear) -- Basis Coefficients&#39;</span>,</span>
<span id="cb374-8"><a href="simulace3shift.html#cb374-8" tabindex="-1"></a>      <span class="st">&#39;SVM (Linear) -- Projection&#39;</span>,</span>
<span id="cb374-9"><a href="simulace3shift.html#cb374-9" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (Linear)&#39;</span></span>
<span id="cb374-10"><a href="simulace3shift.html#cb374-10" tabindex="-1"></a>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb375"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb375-1"><a href="simulace3shift.html#cb375-1" tabindex="-1"></a><span class="co"># For test data</span></span>
<span id="cb375-2"><a href="simulace3shift.html#cb375-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb375-3"><a href="simulace3shift.html#cb375-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb375-4"><a href="simulace3shift.html#cb375-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb375-5"><a href="simulace3shift.html#cb375-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(shift_vector), </span>
<span id="cb375-6"><a href="simulace3shift.html#cb375-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;shift&#39;</span>, </span>
<span id="cb375-7"><a href="simulace3shift.html#cb375-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb375-8"><a href="simulace3shift.html#cb375-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb375-9"><a href="simulace3shift.html#cb375-9" tabindex="-1"></a>         <span class="at">shift =</span> <span class="fu">as.numeric</span>(shift)) <span class="sc">|&gt;</span> </span>
<span id="cb375-10"><a href="simulace3shift.html#cb375-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb375-11"><a href="simulace3shift.html#cb375-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb375-12"><a href="simulace3shift.html#cb375-12" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb375-13"><a href="simulace3shift.html#cb375-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb375-14"><a href="simulace3shift.html#cb375-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb375-15"><a href="simulace3shift.html#cb375-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb375-16"><a href="simulace3shift.html#cb375-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Shift&#39;</span>,</span>
<span id="cb375-17"><a href="simulace3shift.html#cb375-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Training Error&#39;</span>,</span>
<span id="cb375-18"><a href="simulace3shift.html#cb375-18" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb375-19"><a href="simulace3shift.html#cb375-19" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb375-20"><a href="simulace3shift.html#cb375-20" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb375-21"><a href="simulace3shift.html#cb375-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>,</span>
<span id="cb375-22"><a href="simulace3shift.html#cb375-22" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb375-23"><a href="simulace3shift.html#cb375-23" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb375-24"><a href="simulace3shift.html#cb375-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth, <span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb375-25"><a href="simulace3shift.html#cb375-25" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb375-26"><a href="simulace3shift.html#cb375-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.95</span>) <span class="sc">+</span> </span>
<span id="cb375-27"><a href="simulace3shift.html#cb375-27" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;tomato&#39;</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb375-28"><a href="simulace3shift.html#cb375-28" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb375-29"><a href="simulace3shift.html#cb375-29" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;dotdash&#39;</span>, <span class="st">&#39;dashed&#39;</span>, <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dotted&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb375-30"><a href="simulace3shift.html#cb375-30" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb375-31"><a href="simulace3shift.html#cb375-31" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>)),</span>
<span id="cb375-32"><a href="simulace3shift.html#cb375-32" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb375-33"><a href="simulace3shift.html#cb375-33" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)),</span>
<span id="cb375-34"><a href="simulace3shift.html#cb375-34" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>)))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-87"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-87-1.png" alt="Graph of the relationship between test error rates for individual classification methods and the parameter value $\sigma_{x}$." width="672" />
<p class="caption">
Figure 3.5: Graph of the relationship between test error rates for individual classification methods and the parameter value <span class="math inline">\(\sigma_{x}\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb376"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb376-1"><a href="simulace3shift.html#cb376-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03sigma_curvesErr.tex&quot;, device = tikz, width = 9, height = 4.5)</span></span></code></pre></div>
</details>
<p>Now we will do the same for the test error rates.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb377"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb377-1"><a href="simulace3shift.html#cb377-1" tabindex="-1"></a><span class="co"># methods_subset &lt;- c(&#39;KNN&#39;, &#39;LR_functional&#39;, &#39;SVM linear - diskr&#39;,</span></span>
<span id="cb377-2"><a href="simulace3shift.html#cb377-2" tabindex="-1"></a><span class="co">#                     &#39;SVM linear - PCA&#39;, </span></span>
<span id="cb377-3"><a href="simulace3shift.html#cb377-3" tabindex="-1"></a><span class="co">#                     &#39;SVM linear - projection&#39;, &#39;SVM linear - RKHS - radial&#39;)</span></span>
<span id="cb377-4"><a href="simulace3shift.html#cb377-4" tabindex="-1"></a></span>
<span id="cb377-5"><a href="simulace3shift.html#cb377-5" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb377-6"><a href="simulace3shift.html#cb377-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb377-7"><a href="simulace3shift.html#cb377-7" tabindex="-1"></a></span>
<span id="cb377-8"><a href="simulace3shift.html#cb377-8" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> shift_vector</span>
<span id="cb377-9"><a href="simulace3shift.html#cb377-9" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb377-10"><a href="simulace3shift.html#cb377-10" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb377-11"><a href="simulace3shift.html#cb377-11" tabindex="-1"></a></span>
<span id="cb377-12"><a href="simulace3shift.html#cb377-12" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb377-13"><a href="simulace3shift.html#cb377-13" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb377-14"><a href="simulace3shift.html#cb377-14" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb377-15"><a href="simulace3shift.html#cb377-15" tabindex="-1"></a></span>
<span id="cb377-16"><a href="simulace3shift.html#cb377-16" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb377-17"><a href="simulace3shift.html#cb377-17" tabindex="-1"></a></span>
<span id="cb377-18"><a href="simulace3shift.html#cb377-18" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># Vector of lambdas</span></span>
<span id="cb377-19"><a href="simulace3shift.html#cb377-19" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># Empty vector for storing GCV</span></span>
<span id="cb377-20"><a href="simulace3shift.html#cb377-20" tabindex="-1"></a></span>
<span id="cb377-21"><a href="simulace3shift.html#cb377-21" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb377-22"><a href="simulace3shift.html#cb377-22" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb377-23"><a href="simulace3shift.html#cb377-23" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.Fdpar) <span class="co"># Smoothing</span></span>
<span id="cb377-24"><a href="simulace3shift.html#cb377-24" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># Average over all observed curves</span></span>
<span id="cb377-25"><a href="simulace3shift.html#cb377-25" tabindex="-1"></a>}</span>
<span id="cb377-26"><a href="simulace3shift.html#cb377-26" tabindex="-1"></a></span>
<span id="cb377-27"><a href="simulace3shift.html#cb377-27" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb377-28"><a href="simulace3shift.html#cb377-28" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb377-29"><a href="simulace3shift.html#cb377-29" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb377-30"><a href="simulace3shift.html#cb377-30" tabindex="-1"></a>)</span>
<span id="cb377-31"><a href="simulace3shift.html#cb377-31" tabindex="-1"></a></span>
<span id="cb377-32"><a href="simulace3shift.html#cb377-32" tabindex="-1"></a><span class="co"># Find the minimum value</span></span>
<span id="cb377-33"><a href="simulace3shift.html#cb377-33" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb377-34"><a href="simulace3shift.html#cb377-34" tabindex="-1"></a></span>
<span id="cb377-35"><a href="simulace3shift.html#cb377-35" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb377-36"><a href="simulace3shift.html#cb377-36" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.fdPar) <span class="co"># Smooth position</span></span>
<span id="cb377-37"><a href="simulace3shift.html#cb377-37" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd <span class="co"># Wfdobj</span></span>
<span id="cb377-38"><a href="simulace3shift.html#cb377-38" tabindex="-1"></a></span>
<span id="cb377-39"><a href="simulace3shift.html#cb377-39" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd,  <span class="co"># eval.posfd</span></span>
<span id="cb377-40"><a href="simulace3shift.html#cb377-40" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(breaks), <span class="fu">max</span>(breaks),</span>
<span id="cb377-41"><a href="simulace3shift.html#cb377-41" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb377-42"><a href="simulace3shift.html#cb377-42" tabindex="-1"></a></span>
<span id="cb377-43"><a href="simulace3shift.html#cb377-43" tabindex="-1"></a>df_plot_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb377-44"><a href="simulace3shift.html#cb377-44" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb377-45"><a href="simulace3shift.html#cb377-45" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb377-46"><a href="simulace3shift.html#cb377-46" tabindex="-1"></a>  <span class="at">shift =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(breaks), <span class="fu">max</span>(breaks), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb377-47"><a href="simulace3shift.html#cb377-47" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb377-48"><a href="simulace3shift.html#cb377-48" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb377-49"><a href="simulace3shift.html#cb377-49" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb377-50"><a href="simulace3shift.html#cb377-50" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb378"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb378-1"><a href="simulace3shift.html#cb378-1" tabindex="-1"></a><span class="co"># For test data</span></span>
<span id="cb378-2"><a href="simulace3shift.html#cb378-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb378-3"><a href="simulace3shift.html#cb378-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb378-4"><a href="simulace3shift.html#cb378-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb378-5"><a href="simulace3shift.html#cb378-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(shift_vector), </span>
<span id="cb378-6"><a href="simulace3shift.html#cb378-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;shift&#39;</span>, </span>
<span id="cb378-7"><a href="simulace3shift.html#cb378-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb378-8"><a href="simulace3shift.html#cb378-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb378-9"><a href="simulace3shift.html#cb378-9" tabindex="-1"></a>         <span class="at">shift =</span> <span class="fu">as.numeric</span>(shift)) <span class="sc">|&gt;</span> </span>
<span id="cb378-10"><a href="simulace3shift.html#cb378-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb378-11"><a href="simulace3shift.html#cb378-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb378-12"><a href="simulace3shift.html#cb378-12" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb378-13"><a href="simulace3shift.html#cb378-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb378-14"><a href="simulace3shift.html#cb378-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb378-15"><a href="simulace3shift.html#cb378-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb378-16"><a href="simulace3shift.html#cb378-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;$</span><span class="sc">\\</span><span class="st">sigma$&#39;</span>,</span>
<span id="cb378-17"><a href="simulace3shift.html#cb378-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Test Error Rate&#39;</span>,</span>
<span id="cb378-18"><a href="simulace3shift.html#cb378-18" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb378-19"><a href="simulace3shift.html#cb378-19" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb378-20"><a href="simulace3shift.html#cb378-20" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb378-21"><a href="simulace3shift.html#cb378-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>,</span>
<span id="cb378-22"><a href="simulace3shift.html#cb378-22" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb378-23"><a href="simulace3shift.html#cb378-23" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb378-24"><a href="simulace3shift.html#cb378-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth, <span class="fu">aes</span>(<span class="at">x =</span> shift, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb378-25"><a href="simulace3shift.html#cb378-25" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb378-26"><a href="simulace3shift.html#cb378-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb378-27"><a href="simulace3shift.html#cb378-27" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;tomato&#39;</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb378-28"><a href="simulace3shift.html#cb378-28" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb378-29"><a href="simulace3shift.html#cb378-29" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;dotdash&#39;</span>, <span class="st">&#39;dashed&#39;</span>, <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dotted&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb378-30"><a href="simulace3shift.html#cb378-30" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb378-31"><a href="simulace3shift.html#cb378-31" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>)),</span>
<span id="cb378-32"><a href="simulace3shift.html#cb378-32" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb378-33"><a href="simulace3shift.html#cb378-33" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.4</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)),</span>
<span id="cb378-34"><a href="simulace3shift.html#cb378-34" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.7</span>)))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-89"></span>
<img src="03-Simulace_shift_files/figure-html/unnamed-chunk-89-1.png" alt="Graph of the relationship between test error rates for individual classification methods and the parameter value $\sigma_{x}$." width="672" />
<p class="caption">
Figure 2.13: Graph of the relationship between test error rates for individual classification methods and the parameter value <span class="math inline">\(\sigma_{x}\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb379"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb379-1"><a href="simulace3shift.html#cb379-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03shift_curvesErr_subset.tex&quot;, device = tikz, width = 8, height = 5)</span></span></code></pre></div>
</details>
<p>Comments on the graphs can be found in the thesis. It is worth noting that as the value of <span class="math inline">\(\sigma_{shift}\)</span> increases, the test error rate also rises for some methods. At the same time, for methods that classify data with vertical shifts well, there is no degradation in classification strength as the size of the shift increases.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulace3sigma.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace3diskr.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": null,
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/03-Simulace_shift.Rmd",
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  },
  "info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
