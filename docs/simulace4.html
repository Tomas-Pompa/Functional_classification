<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 5 Simulation - Using Derivatives | Functional classification with vertical differences using SVM</title>
  <meta name="description" content="Chapter 5 Simulation - Using Derivatives | Functional classification with vertical differences using SVM" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 5 Simulation - Using Derivatives | Functional classification with vertical differences using SVM" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 5 Simulation - Using Derivatives | Functional classification with vertical differences using SVM" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2024-11-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace3diskr.html"/>
<link rel="next" href="aplikace3.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Functional classification with vertical differences using SVM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace4" class="section level1 hasAnchor" number="5">
<h1><span class="header-section-number">Chapter 5</span> Simulation - Using Derivatives<a href="simulace4.html#simulace4" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this last section concerning simulated data, we will focus on the same data as in Chapter <a href="simulace3.html#simulace3">1</a> (and possibly also in Chapters <a href="simulace3sigma.html#simulace3sigma">2</a> or <a href="simulace3shift.html#simulace3shift">3</a>), specifically generating functional data from functions calculated using interpolation polynomials. As we generated data with a random vertical shift with a standard deviation parameter <span class="math inline">\(\sigma_{shift}\)</span> in Section <a href="simulace3.html#simulace3">1</a>, we could attempt to remove this shift and classify the data after its removal. We observed in Section <a href="simulace3shift.html#simulace3shift">3</a> that the accuracy of especially classical classification methods deteriorates rather dramatically as the value of the standard deviation parameter <span class="math inline">\(\sigma_{shift}\)</span> increases. In contrast, classification methods that account for the functional nature of the data generally behave quite stably, even as <span class="math inline">\(\sigma_{shift}\)</span> increases.</p>
<p>One way to remove vertical shifts, which we will use in the following section, is to classify data based on the estimate of the first derivative of the generated and smoothed curve, since it is known that
<span class="math display">\[
\frac{\text d}{\text d t} \big( x(t) + c \big) = \frac{\text d}{\text d t} x(t)= x&#39;(t).
\]</span></p>
<div id="classification-based-on-the-first-derivative" class="section level2 hasAnchor" number="5.1">
<h2><span class="header-section-number">5.1</span> Classification Based on the First Derivative<a href="simulace4.html#classification-based-on-the-first-derivative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will simulate functions that we will subsequently want to classify. For simplicity, we will consider two classification classes.</p>
<p>To simulate, we will:</p>
<ul>
<li>Choose appropriate functions,</li>
<li>Generate points from the chosen interval that contain, for example, Gaussian noise,</li>
<li>Smooth the obtained discrete points into a functional object using a suitable basis system.</li>
</ul>
<p>This procedure will yield functional objects along with the value of the categorical variable <span class="math inline">\(Y\)</span>, which distinguishes membership in a classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="simulace4.html#cb427-1" tabindex="-1"></a><span class="co"># Load necessary packages </span></span>
<span id="cb427-2"><a href="simulace4.html#cb427-2" tabindex="-1"></a></span>
<span id="cb427-3"><a href="simulace4.html#cb427-3" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb427-4"><a href="simulace4.html#cb427-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb427-5"><a href="simulace4.html#cb427-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb427-6"><a href="simulace4.html#cb427-6" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb427-7"><a href="simulace4.html#cb427-7" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb427-8"><a href="simulace4.html#cb427-8" tabindex="-1"></a><span class="fu">library</span>(polynom)</span>
<span id="cb427-9"><a href="simulace4.html#cb427-9" tabindex="-1"></a><span class="fu">library</span>(tikzDevice)</span>
<span id="cb427-10"><a href="simulace4.html#cb427-10" tabindex="-1"></a></span>
<span id="cb427-11"><a href="simulace4.html#cb427-11" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Let’s consider two classification classes, <span class="math inline">\(Y \in \{0, 1\}\)</span>, with the same number of <code>n</code> generated functions for each class. First, we define two functions, each corresponding to one class, on the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<p>Now, we will create the functions using interpolation polynomials. First, we define the points through which our curve will pass and then fit an interpolation polynomial through these points, which we will use to generate the curves for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="simulace4.html#cb428-1" tabindex="-1"></a><span class="co"># Defining points for class 0</span></span>
<span id="cb428-2"><a href="simulace4.html#cb428-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.65</span>, <span class="fl">0.94</span>, <span class="fl">1.42</span>, <span class="fl">2.26</span>, <span class="fl">2.84</span>, <span class="fl">3.73</span>, <span class="fl">4.50</span>, <span class="fl">5.43</span>, <span class="fl">6.00</span>)</span>
<span id="cb428-3"><a href="simulace4.html#cb428-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.86</span>, <span class="fl">1.49</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.36</span>, <span class="fl">0.23</span>, <span class="dv">0</span>)</span>
<span id="cb428-4"><a href="simulace4.html#cb428-4" tabindex="-1"></a></span>
<span id="cb428-5"><a href="simulace4.html#cb428-5" tabindex="-1"></a><span class="co"># Defining points for class 1</span></span>
<span id="cb428-6"><a href="simulace4.html#cb428-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.51</span>, <span class="fl">0.91</span>, <span class="fl">1.25</span>, <span class="fl">1.51</span>, <span class="fl">2.14</span>, <span class="fl">2.43</span>, <span class="fl">2.96</span>, <span class="fl">3.70</span>, <span class="fl">4.60</span>,</span>
<span id="cb428-7"><a href="simulace4.html#cb428-7" tabindex="-1"></a>         <span class="fl">5.25</span>, <span class="fl">5.67</span>, <span class="fl">6.00</span>)</span>
<span id="cb428-8"><a href="simulace4.html#cb428-8" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.71</span>, <span class="fl">1.08</span>, <span class="fl">1.47</span>, <span class="fl">1.39</span>, <span class="fl">0.81</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb428-9"><a href="simulace4.html#cb428-9" tabindex="-1"></a>         <span class="fl">0.3</span>, <span class="fl">0.37</span>, <span class="dv">0</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="simulace4.html#cb429-1" tabindex="-1"></a><span class="co"># Plotting the points</span></span>
<span id="cb429-2"><a href="simulace4.html#cb429-2" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb429-3"><a href="simulace4.html#cb429-3" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb429-4"><a href="simulace4.html#cb429-4" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb429-5"><a href="simulace4.html#cb429-5" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb429-6"><a href="simulace4.html#cb429-6" tabindex="-1"></a></span>
<span id="cb429-7"><a href="simulace4.html#cb429-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb429-8"><a href="simulace4.html#cb429-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb429-9"><a href="simulace4.html#cb429-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb429-10"><a href="simulace4.html#cb429-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-3-1.png" alt="Points defining both interpolation polynomials." width="672" />
<p class="caption">
Figure 1.1: Points defining both interpolation polynomials.
</p>
</div>
<p>To calculate the interpolation polynomials, we will use the <code>poly.calc()</code> function from the <code>polynom</code> library. We will also define the functions <code>poly.0()</code> and <code>poly.1()</code>, which will compute the values of the polynomials at a given point in the interval. We will use the <code>predict()</code> function for this, where we input the corresponding polynomial and the point at which we want to evaluate the polynomial.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="simulace4.html#cb430-1" tabindex="-1"></a><span class="co"># Calculation of polynomials</span></span>
<span id="cb430-2"><a href="simulace4.html#cb430-2" tabindex="-1"></a>polynom<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>)</span>
<span id="cb430-3"><a href="simulace4.html#cb430-3" tabindex="-1"></a>polynom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="simulace4.html#cb431-1" tabindex="-1"></a>poly<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.0</span>, x))</span>
<span id="cb431-2"><a href="simulace4.html#cb431-2" tabindex="-1"></a>poly<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.1</span>, x))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="simulace4.html#cb432-1" tabindex="-1"></a><span class="co"># Plotting the polynomials</span></span>
<span id="cb432-2"><a href="simulace4.html#cb432-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x<span class="fl">.0</span>), <span class="fu">max</span>(x<span class="fl">.0</span>), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb432-3"><a href="simulace4.html#cb432-3" tabindex="-1"></a>yy<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.0</span>(xx)</span>
<span id="cb432-4"><a href="simulace4.html#cb432-4" tabindex="-1"></a>yy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.1</span>(xx)</span>
<span id="cb432-5"><a href="simulace4.html#cb432-5" tabindex="-1"></a></span>
<span id="cb432-6"><a href="simulace4.html#cb432-6" tabindex="-1"></a>dat_poly_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(xx, xx),</span>
<span id="cb432-7"><a href="simulace4.html#cb432-7" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(yy<span class="fl">.0</span>, yy<span class="fl">.1</span>),</span>
<span id="cb432-8"><a href="simulace4.html#cb432-8" tabindex="-1"></a>                            <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb432-9"><a href="simulace4.html#cb432-9" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="fu">length</span>(xx), <span class="fu">length</span>(xx))))</span>
<span id="cb432-10"><a href="simulace4.html#cb432-10" tabindex="-1"></a></span>
<span id="cb432-11"><a href="simulace4.html#cb432-11" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb432-12"><a href="simulace4.html#cb432-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb432-13"><a href="simulace4.html#cb432-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb432-14"><a href="simulace4.html#cb432-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_plot,</span>
<span id="cb432-15"><a href="simulace4.html#cb432-15" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class),</span>
<span id="cb432-16"><a href="simulace4.html#cb432-16" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb432-17"><a href="simulace4.html#cb432-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-6-1.png" alt="Illustration of two functions on the interval $I = [0, 6]$, from which we generate observations for classes 0 and 1." width="672" />
<p class="caption">
Figure 1.2: Illustration of two functions on the interval <span class="math inline">\(I = [0, 6]\)</span>, from which we generate observations for classes 0 and 1.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="simulace4.html#cb433-1" tabindex="-1"></a><span class="co"># Generating functions for Y = 0 and Y = 1</span></span>
<span id="cb433-2"><a href="simulace4.html#cb433-2" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> poly<span class="fl">.0</span></span>
<span id="cb433-3"><a href="simulace4.html#cb433-3" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> poly<span class="fl">.1</span></span></code></pre></div>
</details>
<p>Now, we will create a function to generate random functions with added noise (i.e., points on a predetermined grid) from the chosen generating function. The argument <code>t</code> represents the vector of values at which we want to evaluate the functions, <code>fun</code> denotes the generating function, <code>n</code> is the number of functions, and <code>sigma</code> is the standard deviation <span class="math inline">\(\sigma\)</span> of the normal distribution <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span> from which we randomly generate Gaussian white noise with <span class="math inline">\(\mu = 0\)</span>. To demonstrate the advantage of using methods that work with functional data, we will also add a random component to each simulated observation that represents a vertical shift of the entire function (the parameter <code>sigma_shift</code>). This shift will be generated from a normal distribution with parameter <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="simulace4.html#cb434-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb434-2"><a href="simulace4.html#cb434-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb434-3"><a href="simulace4.html#cb434-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb434-4"><a href="simulace4.html#cb434-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb434-5"><a href="simulace4.html#cb434-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb434-6"><a href="simulace4.html#cb434-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb434-7"><a href="simulace4.html#cb434-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb434-8"><a href="simulace4.html#cb434-8" tabindex="-1"></a>  </span>
<span id="cb434-9"><a href="simulace4.html#cb434-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb434-10"><a href="simulace4.html#cb434-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb434-11"><a href="simulace4.html#cb434-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb434-12"><a href="simulace4.html#cb434-12" tabindex="-1"></a>  </span>
<span id="cb434-13"><a href="simulace4.html#cb434-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-14"><a href="simulace4.html#cb434-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb434-15"><a href="simulace4.html#cb434-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb434-16"><a href="simulace4.html#cb434-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb434-17"><a href="simulace4.html#cb434-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb434-18"><a href="simulace4.html#cb434-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fun</span>(X) <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb434-19"><a href="simulace4.html#cb434-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can generate functions. In each of the two classes, we will consider 100 observations, thus <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="simulace4.html#cb435-1" tabindex="-1"></a><span class="co"># number of generated observations for each class</span></span>
<span id="cb435-2"><a href="simulace4.html#cb435-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb435-3"><a href="simulace4.html#cb435-3" tabindex="-1"></a><span class="co"># vector of time points evenly spaced on the interval [0, 6]</span></span>
<span id="cb435-4"><a href="simulace4.html#cb435-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb435-5"><a href="simulace4.html#cb435-5" tabindex="-1"></a></span>
<span id="cb435-6"><a href="simulace4.html#cb435-6" tabindex="-1"></a><span class="co"># for Y = 0</span></span>
<span id="cb435-7"><a href="simulace4.html#cb435-7" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb435-8"><a href="simulace4.html#cb435-8" tabindex="-1"></a><span class="co"># for Y = 1</span></span>
<span id="cb435-9"><a href="simulace4.html#cb435-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (not yet smoothed) functions colored by class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb436"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb436-1"><a href="simulace4.html#cb436-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of curves we want to plot from each group</span></span>
<span id="cb436-2"><a href="simulace4.html#cb436-2" tabindex="-1"></a></span>
<span id="cb436-3"><a href="simulace4.html#cb436-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb436-4"><a href="simulace4.html#cb436-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb436-5"><a href="simulace4.html#cb436-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb436-6"><a href="simulace4.html#cb436-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb436-7"><a href="simulace4.html#cb436-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb436-8"><a href="simulace4.html#cb436-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb436-9"><a href="simulace4.html#cb436-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb436-10"><a href="simulace4.html#cb436-10" tabindex="-1"></a>  )</span>
<span id="cb436-11"><a href="simulace4.html#cb436-11" tabindex="-1"></a></span>
<span id="cb436-12"><a href="simulace4.html#cb436-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb436-13"><a href="simulace4.html#cb436-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb436-14"><a href="simulace4.html#cb436-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb436-15"><a href="simulace4.html#cb436-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb436-16"><a href="simulace4.html#cb436-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb436-17"><a href="simulace4.html#cb436-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb436-18"><a href="simulace4.html#cb436-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb436-19"><a href="simulace4.html#cb436-19" tabindex="-1"></a>  )</span>
<span id="cb436-20"><a href="simulace4.html#cb436-20" tabindex="-1"></a></span>
<span id="cb436-21"><a href="simulace4.html#cb436-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb436-22"><a href="simulace4.html#cb436-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb436-23"><a href="simulace4.html#cb436-23" tabindex="-1"></a></span>
<span id="cb436-24"><a href="simulace4.html#cb436-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb436-25"><a href="simulace4.html#cb436-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb436-26"><a href="simulace4.html#cb436-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb436-27"><a href="simulace4.html#cb436-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb436-28"><a href="simulace4.html#cb436-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb436-29"><a href="simulace4.html#cb436-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb436-30"><a href="simulace4.html#cb436-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb436-31"><a href="simulace4.html#cb436-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-11-1.png" alt="The first 10 generated observations from each of the two classification classes. The observed data are not smoothed." width="672" />
<p class="caption">
Figure 2.1: The first 10 generated observations from each of the two classification classes. The observed data are not smoothed.
</p>
</div>
<div id="smoothing-observed-curves-1" class="section level3 hasAnchor" number="5.1.1">
<h3><span class="header-section-number">5.1.1</span> Smoothing Observed Curves<a href="simulace4.html#smoothing-observed-curves-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we will convert the observed discrete values (vectors of values) into functional objects that we will subsequently work with. Again, we will use B-spline basis for smoothing.</p>
<p>We take the entire vector <code>t</code> as knots, and since we consider the first derivative, we choose <code>norder = 5</code>. We will penalize the third derivative of the function, as we now require smooth first derivatives as well.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb437"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb437-1"><a href="simulace4.html#cb437-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb437-2"><a href="simulace4.html#cb437-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb437-3"><a href="simulace4.html#cb437-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb437-4"><a href="simulace4.html#cb437-4" tabindex="-1"></a></span>
<span id="cb437-5"><a href="simulace4.html#cb437-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb437-6"><a href="simulace4.html#cb437-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb437-7"><a href="simulace4.html#cb437-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb437-8"><a href="simulace4.html#cb437-8" tabindex="-1"></a></span>
<span id="cb437-9"><a href="simulace4.html#cb437-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">3</span>) <span class="co"># penalize the 3rd derivative</span></span></code></pre></div>
</details>
<p>We will find a suitable value of the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, that is, generalized cross-validation. We will consider the value of <span class="math inline">\(\lambda\)</span> to be the same for both classification groups, as we would not know in advance which value of $to choose for test observations if different values were chosen for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb438"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb438-1"><a href="simulace4.html#cb438-1" tabindex="-1"></a><span class="co"># combining observations into one matrix</span></span>
<span id="cb438-2"><a href="simulace4.html#cb438-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb438-3"><a href="simulace4.html#cb438-3" tabindex="-1"></a></span>
<span id="cb438-4"><a href="simulace4.html#cb438-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vector of lambdas</span></span>
<span id="cb438-5"><a href="simulace4.html#cb438-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for storing GCV</span></span>
<span id="cb438-6"><a href="simulace4.html#cb438-6" tabindex="-1"></a></span>
<span id="cb438-7"><a href="simulace4.html#cb438-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb438-8"><a href="simulace4.html#cb438-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb438-9"><a href="simulace4.html#cb438-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb438-10"><a href="simulace4.html#cb438-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average across all observed curves</span></span>
<span id="cb438-11"><a href="simulace4.html#cb438-11" tabindex="-1"></a>}</span>
<span id="cb438-12"><a href="simulace4.html#cb438-12" tabindex="-1"></a></span>
<span id="cb438-13"><a href="simulace4.html#cb438-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb438-14"><a href="simulace4.html#cb438-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb438-15"><a href="simulace4.html#cb438-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb438-16"><a href="simulace4.html#cb438-16" tabindex="-1"></a>)</span>
<span id="cb438-17"><a href="simulace4.html#cb438-17" tabindex="-1"></a></span>
<span id="cb438-18"><a href="simulace4.html#cb438-18" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb438-19"><a href="simulace4.html#cb438-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>For better illustration, we will plot the progression of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb439"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb439-1"><a href="simulace4.html#cb439-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb439-2"><a href="simulace4.html#cb439-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb439-3"><a href="simulace4.html#cb439-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb439-4"><a href="simulace4.html#cb439-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb439-5"><a href="simulace4.html#cb439-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb439-6"><a href="simulace4.html#cb439-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb439-7"><a href="simulace4.html#cb439-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb439-8"><a href="simulace4.html#cb439-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-14-1.png" alt="The progression of $GCV(\lambda)$ for the chosen vector $\boldsymbol\lambda$. The x-axis values are plotted on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is shown in red." width="672" />
<p class="caption">
Figure 1.5: The progression of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen vector <span class="math inline">\(\boldsymbol\lambda\)</span>. The x-axis values are plotted on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is shown in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically represent the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb441"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb441-1"><a href="simulace4.html#cb441-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb441-2"><a href="simulace4.html#cb441-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb441-3"><a href="simulace4.html#cb441-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb441-4"><a href="simulace4.html#cb441-4" tabindex="-1"></a></span>
<span id="cb441-5"><a href="simulace4.html#cb441-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb441-6"><a href="simulace4.html#cb441-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb441-7"><a href="simulace4.html#cb441-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb441-8"><a href="simulace4.html#cb441-8" tabindex="-1"></a></span>
<span id="cb441-9"><a href="simulace4.html#cb441-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb441-10"><a href="simulace4.html#cb441-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb441-11"><a href="simulace4.html#cb441-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb441-12"><a href="simulace4.html#cb441-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb441-13"><a href="simulace4.html#cb441-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb441-14"><a href="simulace4.html#cb441-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb441-15"><a href="simulace4.html#cb441-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb441-16"><a href="simulace4.html#cb441-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-15-1.png" alt="The first 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.6: The first 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s visualize all the smoothed curves along with the mean for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb442"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb442-1"><a href="simulace4.html#cb442-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb442-2"><a href="simulace4.html#cb442-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb442-3"><a href="simulace4.html#cb442-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb442-4"><a href="simulace4.html#cb442-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb442-5"><a href="simulace4.html#cb442-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb442-6"><a href="simulace4.html#cb442-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb442-7"><a href="simulace4.html#cb442-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb442-8"><a href="simulace4.html#cb442-8" tabindex="-1"></a>)</span>
<span id="cb442-9"><a href="simulace4.html#cb442-9" tabindex="-1"></a></span>
<span id="cb442-10"><a href="simulace4.html#cb442-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb442-11"><a href="simulace4.html#cb442-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb442-12"><a href="simulace4.html#cb442-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb442-13"><a href="simulace4.html#cb442-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb442-14"><a href="simulace4.html#cb442-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb442-15"><a href="simulace4.html#cb442-15" tabindex="-1"></a>)</span>
<span id="cb442-16"><a href="simulace4.html#cb442-16" tabindex="-1"></a></span>
<span id="cb442-17"><a href="simulace4.html#cb442-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb442-18"><a href="simulace4.html#cb442-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb442-19"><a href="simulace4.html#cb442-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb442-20"><a href="simulace4.html#cb442-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb442-21"><a href="simulace4.html#cb442-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb442-22"><a href="simulace4.html#cb442-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb442-23"><a href="simulace4.html#cb442-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb442-24"><a href="simulace4.html#cb442-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb442-25"><a href="simulace4.html#cb442-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb442-26"><a href="simulace4.html#cb442-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb442-27"><a href="simulace4.html#cb442-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb442-28"><a href="simulace4.html#cb442-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb442-29"><a href="simulace4.html#cb442-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="co">#, limits = c(-1, 2))</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-16-1.png" alt="Plot of all smoothed observed curves, colored by their classification class. The mean for each class is shown with a thick line." width="672" />
<p class="caption">
Figure 1.7: Plot of all smoothed observed curves, colored by their classification class. The mean for each class is shown with a thick line.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb443"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb443-1"><a href="simulace4.html#cb443-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb443-2"><a href="simulace4.html#cb443-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb443-3"><a href="simulace4.html#cb443-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb443-4"><a href="simulace4.html#cb443-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb443-5"><a href="simulace4.html#cb443-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb443-6"><a href="simulace4.html#cb443-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb443-7"><a href="simulace4.html#cb443-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb443-8"><a href="simulace4.html#cb443-8" tabindex="-1"></a>)</span>
<span id="cb443-9"><a href="simulace4.html#cb443-9" tabindex="-1"></a></span>
<span id="cb443-10"><a href="simulace4.html#cb443-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb443-11"><a href="simulace4.html#cb443-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb443-12"><a href="simulace4.html#cb443-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb443-13"><a href="simulace4.html#cb443-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb443-14"><a href="simulace4.html#cb443-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb443-15"><a href="simulace4.html#cb443-15" tabindex="-1"></a>)</span>
<span id="cb443-16"><a href="simulace4.html#cb443-16" tabindex="-1"></a></span>
<span id="cb443-17"><a href="simulace4.html#cb443-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb443-18"><a href="simulace4.html#cb443-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb443-19"><a href="simulace4.html#cb443-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb443-20"><a href="simulace4.html#cb443-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb443-21"><a href="simulace4.html#cb443-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb443-22"><a href="simulace4.html#cb443-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb443-23"><a href="simulace4.html#cb443-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb443-24"><a href="simulace4.html#cb443-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb443-25"><a href="simulace4.html#cb443-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb443-26"><a href="simulace4.html#cb443-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb443-27"><a href="simulace4.html#cb443-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb443-28"><a href="simulace4.html#cb443-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb443-29"><a href="simulace4.html#cb443-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-17-1.png" alt="Plot of all smoothed observed curves, colored by their classification class. The mean for each class is shown with a thick line. Zoomed view." width="672" />
<p class="caption">
Figure 2.2: Plot of all smoothed observed curves, colored by their classification class. The mean for each class is shown with a thick line. Zoomed view.
</p>
</div>
</div>
<div id="calculation-of-derivatives" class="section level3 hasAnchor" number="5.1.2">
<h3><span class="header-section-number">5.1.2</span> Calculation of Derivatives<a href="simulace4.html#calculation-of-derivatives" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To compute the derivative for the functional object, we will use the <code>deriv.fd()</code> function from the <code>fda</code> package in <code>R</code>. Since we want to classify based on the first derivative, we choose the argument <code>Lfdobj = 1</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb444"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb444-1"><a href="simulace4.html#cb444-1" tabindex="-1"></a>XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">1</span>)</span></code></pre></div>
</details>
<p>Now let’s plot the first few first derivatives for both classification classes. Notice from the figure below that the vertical shift due to differentiation has indeed been successfully removed. However, we have somewhat lost the distinctiveness between the curves because, as implied by the figure, the derivative curves for both classes differ primarily towards the end of the interval, specifically for the argument in the range approximately <span class="math inline">\([5, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb445"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb445-1"><a href="simulace4.html#cb445-1" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> t)</span>
<span id="cb445-2"><a href="simulace4.html#cb445-2" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb445-3"><a href="simulace4.html#cb445-3" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb445-4"><a href="simulace4.html#cb445-4" tabindex="-1"></a></span>
<span id="cb445-5"><a href="simulace4.html#cb445-5" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb445-6"><a href="simulace4.html#cb445-6" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb445-7"><a href="simulace4.html#cb445-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb445-8"><a href="simulace4.html#cb445-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb445-9"><a href="simulace4.html#cb445-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb445-10"><a href="simulace4.html#cb445-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb445-11"><a href="simulace4.html#cb445-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb445-12"><a href="simulace4.html#cb445-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<p><img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-19-1.png" width="672" /></p>
<p>Let’s also illustrate all curves including the average separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb446"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb446-1"><a href="simulace4.html#cb446-1" tabindex="-1"></a>abs.labs <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Classification class:&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;$Y = 0$&quot;</span>, <span class="st">&quot;$Y = 1$&quot;</span>))</span>
<span id="cb446-2"><a href="simulace4.html#cb446-2" tabindex="-1"></a><span class="fu">names</span>(abs.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>)</span>
<span id="cb446-3"><a href="simulace4.html#cb446-3" tabindex="-1"></a></span>
<span id="cb446-4"><a href="simulace4.html#cb446-4" tabindex="-1"></a><span class="co"># fdobjSmootheval &lt;- eval.fd(fdobj = XXfd, evalarg = t)</span></span>
<span id="cb446-5"><a href="simulace4.html#cb446-5" tabindex="-1"></a></span>
<span id="cb446-6"><a href="simulace4.html#cb446-6" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb446-7"><a href="simulace4.html#cb446-7" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb446-8"><a href="simulace4.html#cb446-8" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb446-9"><a href="simulace4.html#cb446-9" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb446-10"><a href="simulace4.html#cb446-10" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb446-11"><a href="simulace4.html#cb446-11" tabindex="-1"></a>)</span>
<span id="cb446-12"><a href="simulace4.html#cb446-12" tabindex="-1"></a></span>
<span id="cb446-13"><a href="simulace4.html#cb446-13" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb446-14"><a href="simulace4.html#cb446-14" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb446-15"><a href="simulace4.html#cb446-15" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[<span class="dv">1</span><span class="sc">:</span>n]), <span class="at">evalarg =</span> t),</span>
<span id="cb446-16"><a href="simulace4.html#cb446-16" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> n)]), <span class="at">evalarg =</span> t)),</span>
<span id="cb446-17"><a href="simulace4.html#cb446-17" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb446-18"><a href="simulace4.html#cb446-18" tabindex="-1"></a>)</span>
<span id="cb446-19"><a href="simulace4.html#cb446-19" tabindex="-1"></a></span>
<span id="cb446-20"><a href="simulace4.html#cb446-20" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="co">#group = interaction(time, group), </span></span>
<span id="cb446-21"><a href="simulace4.html#cb446-21" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb446-22"><a href="simulace4.html#cb446-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb446-23"><a href="simulace4.html#cb446-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb446-24"><a href="simulace4.html#cb446-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;$t$&quot;</span>,</span>
<span id="cb446-25"><a href="simulace4.html#cb446-25" tabindex="-1"></a>       <span class="co"># y = &quot;$\\frac{\\text d}{\\text d t} x_i(t)$&quot;,</span></span>
<span id="cb446-26"><a href="simulace4.html#cb446-26" tabindex="-1"></a>       <span class="at">y =</span><span class="st">&quot;$x_i&#39;(t)$&quot;</span>,</span>
<span id="cb446-27"><a href="simulace4.html#cb446-27" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb446-28"><a href="simulace4.html#cb446-28" tabindex="-1"></a>  <span class="co"># geom_line(data = DFsmooth |&gt; </span></span>
<span id="cb446-29"><a href="simulace4.html#cb446-29" tabindex="-1"></a>  <span class="co">#             mutate(group = factor(ifelse(group == &#39;0&#39;, &#39;1&#39;, &#39;0&#39;))) |&gt; </span></span>
<span id="cb446-30"><a href="simulace4.html#cb446-30" tabindex="-1"></a>  <span class="co">#             filter(group == &#39;1&#39;),</span></span>
<span id="cb446-31"><a href="simulace4.html#cb446-31" tabindex="-1"></a>  <span class="co">#           aes(x = t, y = Mean, colour = group), </span></span>
<span id="cb446-32"><a href="simulace4.html#cb446-32" tabindex="-1"></a>  <span class="co">#           colour = &#39;tomato&#39;, linewidth = 0.8, linetype = &#39;solid&#39;) + </span></span>
<span id="cb446-33"><a href="simulace4.html#cb446-33" tabindex="-1"></a>  <span class="co"># geom_line(data = DFsmooth |&gt; </span></span>
<span id="cb446-34"><a href="simulace4.html#cb446-34" tabindex="-1"></a>  <span class="co">#             mutate(group = factor(ifelse(group == &#39;0&#39;, &#39;1&#39;, &#39;0&#39;))) |&gt; </span></span>
<span id="cb446-35"><a href="simulace4.html#cb446-35" tabindex="-1"></a>  <span class="co">#             filter(group == &#39;0&#39;),</span></span>
<span id="cb446-36"><a href="simulace4.html#cb446-36" tabindex="-1"></a>  <span class="co">#           aes(x = t, y = Mean, colour = group), </span></span>
<span id="cb446-37"><a href="simulace4.html#cb446-37" tabindex="-1"></a>  <span class="co">#           colour = &#39;deepskyblue2&#39;, linewidth = 0.8, linetype = &#39;solid&#39;) + </span></span>
<span id="cb446-38"><a href="simulace4.html#cb446-38" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean <span class="sc">|&gt;</span> </span>
<span id="cb446-39"><a href="simulace4.html#cb446-39" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;0&#39;</span>))),</span>
<span id="cb446-40"><a href="simulace4.html#cb446-40" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb446-41"><a href="simulace4.html#cb446-41" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb446-42"><a href="simulace4.html#cb446-42" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb446-43"><a href="simulace4.html#cb446-43" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb446-44"><a href="simulace4.html#cb446-44" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb446-45"><a href="simulace4.html#cb446-45" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group =</span> abs.labs)) <span class="sc">+</span></span>
<span id="cb446-46"><a href="simulace4.html#cb446-46" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb446-47"><a href="simulace4.html#cb446-47" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb446-48"><a href="simulace4.html#cb446-48" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb446-49"><a href="simulace4.html#cb446-49" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.4</span>, <span class="fl">3.5</span>)) <span class="sc">+</span></span>
<span id="cb446-50"><a href="simulace4.html#cb446-50" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-21"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-21-1.png" alt="Plot of all smoothed observed curves, colored differently according to classification class membership. The average for each class is plotted as a solid black line." width="672" />
<p class="caption">
Figure 5.1: Plot of all smoothed observed curves, colored differently according to classification class membership. The average for each class is plotted as a solid black line.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb447"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb447-1"><a href="simulace4.html#cb447-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_04_curves_1der.tex&quot;, device = tikz, width = 8, height = 4)</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb448"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb448-1"><a href="simulace4.html#cb448-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb448-2"><a href="simulace4.html#cb448-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb448-3"><a href="simulace4.html#cb448-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb448-4"><a href="simulace4.html#cb448-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb448-5"><a href="simulace4.html#cb448-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb448-6"><a href="simulace4.html#cb448-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb448-7"><a href="simulace4.html#cb448-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb448-8"><a href="simulace4.html#cb448-8" tabindex="-1"></a>)</span>
<span id="cb448-9"><a href="simulace4.html#cb448-9" tabindex="-1"></a></span>
<span id="cb448-10"><a href="simulace4.html#cb448-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb448-11"><a href="simulace4.html#cb448-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb448-12"><a href="simulace4.html#cb448-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb448-13"><a href="simulace4.html#cb448-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb448-14"><a href="simulace4.html#cb448-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb448-15"><a href="simulace4.html#cb448-15" tabindex="-1"></a>)</span>
<span id="cb448-16"><a href="simulace4.html#cb448-16" tabindex="-1"></a></span>
<span id="cb448-17"><a href="simulace4.html#cb448-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb448-18"><a href="simulace4.html#cb448-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb448-19"><a href="simulace4.html#cb448-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb448-20"><a href="simulace4.html#cb448-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb448-21"><a href="simulace4.html#cb448-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb448-22"><a href="simulace4.html#cb448-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb448-23"><a href="simulace4.html#cb448-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb448-24"><a href="simulace4.html#cb448-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb448-25"><a href="simulace4.html#cb448-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), <span class="at">colour =</span> <span class="st">&#39;grey3&#39;</span>, </span>
<span id="cb448-26"><a href="simulace4.html#cb448-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb448-27"><a href="simulace4.html#cb448-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb448-28"><a href="simulace4.html#cb448-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb448-29"><a href="simulace4.html#cb448-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="fl">1.5</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-22"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-22-1.png" alt="Plot of all smoothed observed curves, colored differently according to classification class membership. The average for each class is plotted as a solid black line. Closer look." width="672" />
<p class="caption">
Figure 5.2: Plot of all smoothed observed curves, colored differently according to classification class membership. The average for each class is plotted as a solid black line. Closer look.
</p>
</div>
</div>
<div id="classification-of-curves-3" class="section level3 hasAnchor" number="5.1.3">
<h3><span class="header-section-number">5.1.3</span> Classification of Curves<a href="simulace4.html#classification-of-curves-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb449"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb449-1"><a href="simulace4.html#cb449-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training sets</span></span>
<span id="cb449-2"><a href="simulace4.html#cb449-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb449-3"><a href="simulace4.html#cb449-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb449-4"><a href="simulace4.html#cb449-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb449-5"><a href="simulace4.html#cb449-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb449-6"><a href="simulace4.html#cb449-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb449-7"><a href="simulace4.html#cb449-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for logistic regression on scores</span></span>
<span id="cb449-8"><a href="simulace4.html#cb449-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for logistic regression on scores</span></span>
<span id="cb449-9"><a href="simulace4.html#cb449-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb449-10"><a href="simulace4.html#cb449-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># decision trees</span></span>
<span id="cb449-11"><a href="simulace4.html#cb449-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># visualization</span></span>
<span id="cb449-12"><a href="simulace4.html#cb449-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb449-13"><a href="simulace4.html#cb449-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># random forest</span></span></code></pre></div>
</details>
<p>To compare individual classifiers, we will split the generated observations into two parts in a 70:30 ratio for training and testing (validation) sets. The training set will be used to construct the classifier, while the test set will be used to calculate the classification error and potentially other characteristics of our model. The resulting classifiers can then be compared based on these computed characteristics in terms of their classification success.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb450"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb450-1"><a href="simulace4.html#cb450-1" tabindex="-1"></a><span class="co"># splitting into test and training sets</span></span>
<span id="cb450-2"><a href="simulace4.html#cb450-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb450-3"><a href="simulace4.html#cb450-3" tabindex="-1"></a></span>
<span id="cb450-4"><a href="simulace4.html#cb450-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb450-5"><a href="simulace4.html#cb450-5" tabindex="-1"></a></span>
<span id="cb450-6"><a href="simulace4.html#cb450-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb450-7"><a href="simulace4.html#cb450-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb450-8"><a href="simulace4.html#cb450-8" tabindex="-1"></a></span>
<span id="cb450-9"><a href="simulace4.html#cb450-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb450-10"><a href="simulace4.html#cb450-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, we will examine the representation of individual groups in the test and training portions of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb451"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb451-1"><a href="simulace4.html#cb451-1" tabindex="-1"></a><span class="co"># absolute representation</span></span>
<span id="cb451-2"><a href="simulace4.html#cb451-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb453"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb453-1"><a href="simulace4.html#cb453-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb455"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb455-1"><a href="simulace4.html#cb455-1" tabindex="-1"></a><span class="co"># relative representation</span></span>
<span id="cb455-2"><a href="simulace4.html#cb455-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb457"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb457-1"><a href="simulace4.html#cb457-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nearest-neighbors-3" class="section level4 hasAnchor" number="5.1.3.1">
<h4><span class="header-section-number">5.1.3.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="simulace4.html#k-nearest-neighbors-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start with a non-parametric classification method, specifically the <span class="math inline">\(K\)</span> nearest neighbors method. First, we will create the necessary objects so that we can work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb459"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb459-1"><a href="simulace4.html#cb459-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb459-2"><a href="simulace4.html#cb459-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and look at its classification success. The last question remains how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>. We could choose this number as the value of <span class="math inline">\(K\)</span> that results in the minimum error rate on the training data. However, this could lead to overfitting the model, so we will use cross-validation. Given the computational complexity and size of the dataset, we will opt for <span class="math inline">\(k\)</span>-fold CV; we will choose a value of <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb460"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb460-1"><a href="simulace4.html#cb460-1" tabindex="-1"></a><span class="co"># model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb460-2"><a href="simulace4.html#cb460-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb460-3"><a href="simulace4.html#cb460-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb460-4"><a href="simulace4.html#cb460-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb460-5"><a href="simulace4.html#cb460-5" tabindex="-1"></a></span>
<span id="cb460-6"><a href="simulace4.html#cb460-6" tabindex="-1"></a><span class="co"># summary(neighb.model) # summary of the model</span></span>
<span id="cb460-7"><a href="simulace4.html#cb460-7" tabindex="-1"></a><span class="co"># plot(neighb.model$gcv, pch = 16) # plot GCV dependence on the number of neighbors K</span></span>
<span id="cb460-8"><a href="simulace4.html#cb460-8" tabindex="-1"></a><span class="co"># neighb.model$max.prob # maximum accuracy</span></span>
<span id="cb460-9"><a href="simulace4.html#cb460-9" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 12</code></pre>
<p>Let’s proceed with the previous procedure for the training data, which we will split into <span class="math inline">\(k\)</span> parts and repeat this code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb462"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb462-1"><a href="simulace4.html#cb462-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb462-2"><a href="simulace4.html#cb462-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb462-3"><a href="simulace4.html#cb462-3" tabindex="-1"></a></span>
<span id="cb462-4"><a href="simulace4.html#cb462-4" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb462-5"><a href="simulace4.html#cb462-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb462-6"><a href="simulace4.html#cb462-6" tabindex="-1"></a></span>
<span id="cb462-7"><a href="simulace4.html#cb462-7" tabindex="-1"></a><span class="co"># empty matrix to store the results</span></span>
<span id="cb462-8"><a href="simulace4.html#cb462-8" tabindex="-1"></a><span class="co"># columns will contain accuracy values for the corresponding part of the training set</span></span>
<span id="cb462-9"><a href="simulace4.html#cb462-9" tabindex="-1"></a><span class="co"># rows will contain values for the given number of neighbors K</span></span>
<span id="cb462-10"><a href="simulace4.html#cb462-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb462-11"><a href="simulace4.html#cb462-11" tabindex="-1"></a></span>
<span id="cb462-12"><a href="simulace4.html#cb462-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb462-13"><a href="simulace4.html#cb462-13" tabindex="-1"></a>  <span class="co"># define the current index set</span></span>
<span id="cb462-14"><a href="simulace4.html#cb462-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb462-15"><a href="simulace4.html#cb462-15" tabindex="-1"></a>    </span>
<span id="cb462-16"><a href="simulace4.html#cb462-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb462-17"><a href="simulace4.html#cb462-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb462-18"><a href="simulace4.html#cb462-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb462-19"><a href="simulace4.html#cb462-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb462-20"><a href="simulace4.html#cb462-20" tabindex="-1"></a>  </span>
<span id="cb462-21"><a href="simulace4.html#cb462-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb462-22"><a href="simulace4.html#cb462-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb462-23"><a href="simulace4.html#cb462-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb462-24"><a href="simulace4.html#cb462-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb462-25"><a href="simulace4.html#cb462-25" tabindex="-1"></a>  </span>
<span id="cb462-26"><a href="simulace4.html#cb462-26" tabindex="-1"></a>  <span class="co"># iterate over each part ... repeat k times</span></span>
<span id="cb462-27"><a href="simulace4.html#cb462-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb462-28"><a href="simulace4.html#cb462-28" tabindex="-1"></a>    <span class="co"># model for specific choice of K</span></span>
<span id="cb462-29"><a href="simulace4.html#cb462-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb462-30"><a href="simulace4.html#cb462-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb462-31"><a href="simulace4.html#cb462-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb462-32"><a href="simulace4.html#cb462-32" tabindex="-1"></a>    <span class="co"># predictions on validation set</span></span>
<span id="cb462-33"><a href="simulace4.html#cb462-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb462-34"><a href="simulace4.html#cb462-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb462-35"><a href="simulace4.html#cb462-35" tabindex="-1"></a>    <span class="co"># accuracy on validation set</span></span>
<span id="cb462-36"><a href="simulace4.html#cb462-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb462-37"><a href="simulace4.html#cb462-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb462-38"><a href="simulace4.html#cb462-38" tabindex="-1"></a>    </span>
<span id="cb462-39"><a href="simulace4.html#cb462-39" tabindex="-1"></a>    <span class="co"># store accuracy in the position for given K and fold</span></span>
<span id="cb462-40"><a href="simulace4.html#cb462-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb462-41"><a href="simulace4.html#cb462-41" tabindex="-1"></a>  }</span>
<span id="cb462-42"><a href="simulace4.html#cb462-42" tabindex="-1"></a>}</span>
<span id="cb462-43"><a href="simulace4.html#cb462-43" tabindex="-1"></a></span>
<span id="cb462-44"><a href="simulace4.html#cb462-44" tabindex="-1"></a><span class="co"># compute average accuracies for individual K across folds</span></span>
<span id="cb462-45"><a href="simulace4.html#cb462-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb462-46"><a href="simulace4.html#cb462-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb462-47"><a href="simulace4.html#cb462-47" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb462-48"><a href="simulace4.html#cb462-48" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>We can see that the best value for the parameter <span class="math inline">\(K\)</span> is 14, with an error rate calculated using 10-fold CV of 0.2594.</p>
<p>For clarity, let’s also plot the validation error rate as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb463"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb463-1"><a href="simulace4.html#cb463-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb463-2"><a href="simulace4.html#cb463-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb463-3"><a href="simulace4.html#cb463-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb463-4"><a href="simulace4.html#cb463-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb463-5"><a href="simulace4.html#cb463-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb463-6"><a href="simulace4.html#cb463-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb463-7"><a href="simulace4.html#cb463-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb463-8"><a href="simulace4.html#cb463-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb463-9"><a href="simulace4.html#cb463-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb463-10"><a href="simulace4.html#cb463-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 24 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-29"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-29-1.png" alt="Dependency of validation error rate on the value of $K$, i.e., on the number of neighbors." width="672" />
<p class="caption">
Figure 5.3: Dependency of validation error rate on the value of <span class="math inline">\(K\)</span>, i.e., on the number of neighbors.
</p>
</div>
<p>Now that we have determined the optimal value of the parameter <span class="math inline">\(K\)</span>, we can build the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb465"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb465-1"><a href="simulace4.html#cb465-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb465-2"><a href="simulace4.html#cb465-2" tabindex="-1"></a></span>
<span id="cb465-3"><a href="simulace4.html#cb465-3" tabindex="-1"></a><span class="co"># predictions</span></span>
<span id="cb465-4"><a href="simulace4.html#cb465-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb465-5"><a href="simulace4.html#cb465-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb465-6"><a href="simulace4.html#cb465-6" tabindex="-1"></a></span>
<span id="cb465-7"><a href="simulace4.html#cb465-7" tabindex="-1"></a><span class="co"># summary(neighb.model)</span></span>
<span id="cb465-8"><a href="simulace4.html#cb465-8" tabindex="-1"></a></span>
<span id="cb465-9"><a href="simulace4.html#cb465-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb465-10"><a href="simulace4.html#cb465-10" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb465-11"><a href="simulace4.html#cb465-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb465-12"><a href="simulace4.html#cb465-12" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb465-13"><a href="simulace4.html#cb465-13" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb465-14"><a href="simulace4.html#cb465-14" tabindex="-1"></a><span class="co"># error rate</span></span>
<span id="cb465-15"><a href="simulace4.html#cb465-15" tabindex="-1"></a><span class="co"># 1 - accuracy</span></span></code></pre></div>
</details>
<p>Thus, the error rate of the model constructed using the <span class="math inline">\(K\)</span>-nearest neighbors method with the optimal choice of <span class="math inline">\(K_{optimal}\)</span> equal to 14, determined by cross-validation, is 0.3071 on the training data and 0.1833 on the test data.</p>
<p>To compare different models, we can use both types of error rates, which we will store in a table for clarity.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb466"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb466-1"><a href="simulace4.html#cb466-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb466-2"><a href="simulace4.html#cb466-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb466-3"><a href="simulace4.html#cb466-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-3" class="section level4 hasAnchor" number="5.1.3.2">
<h4><span class="header-section-number">5.1.3.2</span> Linear Discriminant Analysis<a href="simulace4.html#linear-discriminant-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As the second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied to functional data, we must first discretize the data, which we will do using Functional Principal Component Analysis (FPCA). We will then perform the classification algorithm on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>First, let’s perform the functional principal component analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb467"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb467-1"><a href="simulace4.html#cb467-1" tabindex="-1"></a><span class="co"># principal component analysis</span></span>
<span id="cb467-2"><a href="simulace4.html#cb467-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of PCs</span></span>
<span id="cb467-3"><a href="simulace4.html#cb467-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determine p</span></span>
<span id="cb467-4"><a href="simulace4.html#cb467-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb467-5"><a href="simulace4.html#cb467-5" tabindex="-1"></a></span>
<span id="cb467-6"><a href="simulace4.html#cb467-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb467-7"><a href="simulace4.html#cb467-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p PCs</span></span>
<span id="cb467-8"><a href="simulace4.html#cb467-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># class membership</span></span></code></pre></div>
</details>
<p>In this particular case, we took the number of principal components as <span class="math inline">\(p\)</span> = 3, which together explain 93.96 % of the variability in the data. The first principal component explains 50.6 % and the second 33.44 % of the variability. We can graphically display the scores of the first two principal components, color-coded according to class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb468"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb468-1"><a href="simulace4.html#cb468-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb468-2"><a href="simulace4.html#cb468-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb468-3"><a href="simulace4.html#cb468-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb468-4"><a href="simulace4.html#cb468-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb468-5"><a href="simulace4.html#cb468-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb468-6"><a href="simulace4.html#cb468-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb468-7"><a href="simulace4.html#cb468-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb468-8"><a href="simulace4.html#cb468-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb468-9"><a href="simulace4.html#cb468-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-33"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-33-1.png" alt="Scores of the first two principal components for the training data. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 5.4: Scores of the first two principal components for the training data. Points are color-coded according to class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to calculate the scores for the first 3 principal components for the test data. These scores are determined using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text{ dt},
\]</span></p>
<p>where <span class="math inline">\(\mu(t)\)</span> is the mean function and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb469"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb469-1"><a href="simulace4.html#cb469-1" tabindex="-1"></a><span class="co"># compute scores for test functions</span></span>
<span id="cb469-2"><a href="simulace4.html#cb469-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix </span></span>
<span id="cb469-3"><a href="simulace4.html#cb469-3" tabindex="-1"></a></span>
<span id="cb469-4"><a href="simulace4.html#cb469-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb469-5"><a href="simulace4.html#cb469-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb469-6"><a href="simulace4.html#cb469-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb469-7"><a href="simulace4.html#cb469-7" tabindex="-1"></a>  <span class="co"># scalar product of residuals and eigenfunctions (functional principal components)</span></span>
<span id="cb469-8"><a href="simulace4.html#cb469-8" tabindex="-1"></a>}</span>
<span id="cb469-9"><a href="simulace4.html#cb469-9" tabindex="-1"></a></span>
<span id="cb469-10"><a href="simulace4.html#cb469-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb469-11"><a href="simulace4.html#cb469-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb469-12"><a href="simulace4.html#cb469-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training portion of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb470"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb470-1"><a href="simulace4.html#cb470-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb470-2"><a href="simulace4.html#cb470-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb470-3"><a href="simulace4.html#cb470-3" tabindex="-1"></a></span>
<span id="cb470-4"><a href="simulace4.html#cb470-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb470-5"><a href="simulace4.html#cb470-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb470-6"><a href="simulace4.html#cb470-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb470-7"><a href="simulace4.html#cb470-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb470-8"><a href="simulace4.html#cb470-8" tabindex="-1"></a>  </span>
<span id="cb470-9"><a href="simulace4.html#cb470-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb470-10"><a href="simulace4.html#cb470-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb470-11"><a href="simulace4.html#cb470-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb470-12"><a href="simulace4.html#cb470-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training (31.43 %) and on the test data (23.33 %).</p>
<p>To visually represent the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb471"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb471-1"><a href="simulace4.html#cb471-1" tabindex="-1"></a><span class="co"># add decision boundary</span></span>
<span id="cb471-2"><a href="simulace4.html#cb471-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb471-3"><a href="simulace4.html#cb471-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb471-4"><a href="simulace4.html#cb471-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb471-5"><a href="simulace4.html#cb471-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb471-6"><a href="simulace4.html#cb471-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb471-7"><a href="simulace4.html#cb471-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb471-8"><a href="simulace4.html#cb471-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb471-9"><a href="simulace4.html#cb471-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb471-10"><a href="simulace4.html#cb471-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb471-11"><a href="simulace4.html#cb471-11" tabindex="-1"></a><span class="co"># if p = 3</span></span>
<span id="cb471-12"><a href="simulace4.html#cb471-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb471-13"><a href="simulace4.html#cb471-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb471-14"><a href="simulace4.html#cb471-14" tabindex="-1"></a><span class="co"># if p = 4</span></span>
<span id="cb471-15"><a href="simulace4.html#cb471-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb471-16"><a href="simulace4.html#cb471-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb471-17"><a href="simulace4.html#cb471-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb471-18"><a href="simulace4.html#cb471-18" tabindex="-1"></a><span class="co"># if p = 5</span></span>
<span id="cb471-19"><a href="simulace4.html#cb471-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb471-20"><a href="simulace4.html#cb471-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb471-21"><a href="simulace4.html#cb471-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb471-22"><a href="simulace4.html#cb471-22" tabindex="-1"></a></span>
<span id="cb471-23"><a href="simulace4.html#cb471-23" tabindex="-1"></a><span class="co"># add Y = 0, 1</span></span>
<span id="cb471-24"><a href="simulace4.html#cb471-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb471-25"><a href="simulace4.html#cb471-25" tabindex="-1"></a></span>
<span id="cb471-26"><a href="simulace4.html#cb471-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb471-27"><a href="simulace4.html#cb471-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb471-28"><a href="simulace4.html#cb471-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb471-29"><a href="simulace4.html#cb471-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb471-30"><a href="simulace4.html#cb471-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb471-31"><a href="simulace4.html#cb471-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb471-32"><a href="simulace4.html#cb471-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb471-33"><a href="simulace4.html#cb471-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb471-34"><a href="simulace4.html#cb471-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb471-35"><a href="simulace4.html#cb471-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-36-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black." width="672" />
<p class="caption">
Figure 1.11: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black.
</p>
</div>
<p>We see that the decision boundary is a line, a linear function in the 2D space, which is indeed what we expected from LDA. Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb472"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb472-1"><a href="simulace4.html#cb472-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb472-2"><a href="simulace4.html#cb472-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb472-3"><a href="simulace4.html#cb472-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb472-4"><a href="simulace4.html#cb472-4" tabindex="-1"></a></span>
<span id="cb472-5"><a href="simulace4.html#cb472-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-3" class="section level4 hasAnchor" number="5.1.3.3">
<h4><span class="header-section-number">5.1.3.3</span> Quadratic Discriminant Analysis<a href="simulace4.html#quadratic-discriminant-analysis-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, we will construct a classifier using Quadratic Discriminant Analysis (QDA). This is an analogous case to LDA, with the difference that we now allow for different covariance matrices for each of the classes from which the corresponding scores are drawn. This relaxed assumption of equal covariance matrices leads to a quadratic boundary between the classes.</p>
<p>In <code>R</code>, we perform QDA similarly to how we did LDA in the previous section. We will compute the scores for the training and test functions using the results from the functional Principal Component Analysis (PCA) obtained earlier.</p>
<p>Thus, we can proceed directly to constructing the classifier using the <code>qda()</code> function. We will then calculate the accuracy of the classifier on both test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb473"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb473-1"><a href="simulace4.html#cb473-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb473-2"><a href="simulace4.html#cb473-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb473-3"><a href="simulace4.html#cb473-3" tabindex="-1"></a></span>
<span id="cb473-4"><a href="simulace4.html#cb473-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb473-5"><a href="simulace4.html#cb473-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb473-6"><a href="simulace4.html#cb473-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb473-7"><a href="simulace4.html#cb473-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb473-8"><a href="simulace4.html#cb473-8" tabindex="-1"></a>  </span>
<span id="cb473-9"><a href="simulace4.html#cb473-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb473-10"><a href="simulace4.html#cb473-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb473-11"><a href="simulace4.html#cb473-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb473-12"><a href="simulace4.html#cb473-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training (35 %) and test data (20 %).</p>
<p>To visually represent the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just like in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb474"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb474-1"><a href="simulace4.html#cb474-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb474-2"><a href="simulace4.html#cb474-2" tabindex="-1"></a></span>
<span id="cb474-3"><a href="simulace4.html#cb474-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb474-4"><a href="simulace4.html#cb474-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb474-5"><a href="simulace4.html#cb474-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb474-6"><a href="simulace4.html#cb474-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb474-7"><a href="simulace4.html#cb474-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb474-8"><a href="simulace4.html#cb474-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb474-9"><a href="simulace4.html#cb474-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb474-10"><a href="simulace4.html#cb474-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb474-11"><a href="simulace4.html#cb474-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb474-12"><a href="simulace4.html#cb474-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-39-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is marked in black." width="672" />
<p class="caption">
Figure 4.1: Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is marked in black.
</p>
</div>
<p>Notice that the decision boundary between the classification classes is now a parabola.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb475"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb475-1"><a href="simulace4.html#cb475-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb475-2"><a href="simulace4.html#cb475-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb475-3"><a href="simulace4.html#cb475-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb475-4"><a href="simulace4.html#cb475-4" tabindex="-1"></a></span>
<span id="cb475-5"><a href="simulace4.html#cb475-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-3" class="section level4 hasAnchor" number="5.1.3.4">
<h4><span class="header-section-number">5.1.3.4</span> Logistic Regression<a href="simulace4.html#logistic-regression-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can perform logistic regression in two ways. First, we can use the functional analogue of classical logistic regression, and second, we can apply classical multivariate logistic regression on the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-3" class="section level5 hasAnchor" number="5.1.3.4.1">
<h5><span class="header-section-number">5.1.3.4.1</span> Functional Logistic Regression<a href="simulace4.html#functional-logistic-regression-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Analogous to the case with finite-dimensional input data, we consider the logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span></p>
<p>where <span class="math inline">\(\eta(x)\)</span> is a linear predictor taking values in the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em> (in the case of logistic regression, this is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>), and <span class="math inline">\(\pi(x)\)</span> is the conditional probability:</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is a parametric function. Our goal is to estimate this parametric function.</p>
<p>For functional logistic regression, we will use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package. First, we will create suitable objects for the classifier construction.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb476"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb476-1"><a href="simulace4.html#cb476-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb476-2"><a href="simulace4.html#cb476-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb476-3"><a href="simulace4.html#cb476-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb476-4"><a href="simulace4.html#cb476-4" tabindex="-1"></a></span>
<span id="cb476-5"><a href="simulace4.html#cb476-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb476-6"><a href="simulace4.html#cb476-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb476-7"><a href="simulace4.html#cb476-7" tabindex="-1"></a></span>
<span id="cb476-8"><a href="simulace4.html#cb476-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb476-9"><a href="simulace4.html#cb476-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb476-10"><a href="simulace4.html#cb476-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb476-11"><a href="simulace4.html#cb476-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span></code></pre></div>
</details>
<p>To estimate the parametric function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in our case, a B-spline basis. However, we need to determine a suitable number of basis functions. We could determine this based on the error rate on the training data, but this would lead to a preference for selecting a large number of bases, resulting in overfitting.</p>
<p>Let us illustrate this with the following case. For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 50\}\)</span>, we will train the model on the training data, determine the error rate on the training data, and also calculate the error rate on the test data. We must remember that we cannot use the same data for estimating the test error rate, as this would underestimate the error rate.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb477"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb477-1"><a href="simulace4.html#cb477-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb477-2"><a href="simulace4.html#cb477-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb477-3"><a href="simulace4.html#cb477-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb477-4"><a href="simulace4.html#cb477-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb477-5"><a href="simulace4.html#cb477-5" tabindex="-1"></a></span>
<span id="cb477-6"><a href="simulace4.html#cb477-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb477-7"><a href="simulace4.html#cb477-7" tabindex="-1"></a>  <span class="co"># basis for betas</span></span>
<span id="cb477-8"><a href="simulace4.html#cb477-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb477-9"><a href="simulace4.html#cb477-9" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb477-10"><a href="simulace4.html#cb477-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb477-11"><a href="simulace4.html#cb477-11" tabindex="-1"></a>  <span class="co"># basis for x and betas</span></span>
<span id="cb477-12"><a href="simulace4.html#cb477-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb477-13"><a href="simulace4.html#cb477-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb477-14"><a href="simulace4.html#cb477-14" tabindex="-1"></a>  <span class="co"># input data for the model</span></span>
<span id="cb477-15"><a href="simulace4.html#cb477-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb477-16"><a href="simulace4.html#cb477-16" tabindex="-1"></a>  <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb477-17"><a href="simulace4.html#cb477-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb477-18"><a href="simulace4.html#cb477-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb477-19"><a href="simulace4.html#cb477-19" tabindex="-1"></a>  </span>
<span id="cb477-20"><a href="simulace4.html#cb477-20" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb477-21"><a href="simulace4.html#cb477-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb477-22"><a href="simulace4.html#cb477-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb477-23"><a href="simulace4.html#cb477-23" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb477-24"><a href="simulace4.html#cb477-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb477-25"><a href="simulace4.html#cb477-25" tabindex="-1"></a>    </span>
<span id="cb477-26"><a href="simulace4.html#cb477-26" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb477-27"><a href="simulace4.html#cb477-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb477-28"><a href="simulace4.html#cb477-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb477-29"><a href="simulace4.html#cb477-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb477-30"><a href="simulace4.html#cb477-30" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb477-31"><a href="simulace4.html#cb477-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb477-32"><a href="simulace4.html#cb477-32" tabindex="-1"></a>  </span>
<span id="cb477-33"><a href="simulace4.html#cb477-33" tabindex="-1"></a>  <span class="co"># insert into the matrix</span></span>
<span id="cb477-34"><a href="simulace4.html#cb477-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb477-35"><a href="simulace4.html#cb477-35" tabindex="-1"></a>} </span>
<span id="cb477-36"><a href="simulace4.html#cb477-36" tabindex="-1"></a></span>
<span id="cb477-37"><a href="simulace4.html#cb477-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb477-38"><a href="simulace4.html#cb477-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s visualize the trends of both training and test error rates in a graph based on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb478"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb478-1"><a href="simulace4.html#cb478-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb478-2"><a href="simulace4.html#cb478-2" tabindex="-1"></a></span>
<span id="cb478-3"><a href="simulace4.html#cb478-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb478-4"><a href="simulace4.html#cb478-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb478-5"><a href="simulace4.html#cb478-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb478-6"><a href="simulace4.html#cb478-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb478-7"><a href="simulace4.html#cb478-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb478-8"><a href="simulace4.html#cb478-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb478-9"><a href="simulace4.html#cb478-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb478-10"><a href="simulace4.html#cb478-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb478-11"><a href="simulace4.html#cb478-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb478-12"><a href="simulace4.html#cb478-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb478-13"><a href="simulace4.html#cb478-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb478-14"><a href="simulace4.html#cb478-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb478-15"><a href="simulace4.html#cb478-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error Rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 47 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-43"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-43-1.png" alt="Dependence of test and training error rates on the number of basis functions for $\beta$. The red point represents the optimal number $n_{optimal}$ chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line illustrates the training error rate." width="672" />
<p class="caption">
Figure 1.13: Dependence of test and training error rates on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red point represents the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line illustrates the training error rate.
</p>
</div>
<p>We see that as the number of bases for <span class="math inline">\(\beta(t)\)</span> increases, the training error rate (represented by the blue line) tends to decrease, suggesting that we might choose large values for <span class="math inline">\(n_{basis}\)</span> based solely on it. In contrast, the optimal choice based on the test error rate is <span class="math inline">\(n\)</span> equal to 10, which is significantly smaller than 50. Conversely, as <span class="math inline">\(n\)</span> increases, the test error rate rises, indicating overfitting of the model.</p>
<p>For these reasons, we will use 10-fold cross-validation to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>. The maximum number of basis functions considered is 35, as we observed that exceeding this value leads to overfitting.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb481"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb481-1"><a href="simulace4.html#cb481-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb481-2"><a href="simulace4.html#cb481-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb481-3"><a href="simulace4.html#cb481-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb481-4"><a href="simulace4.html#cb481-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb481-5"><a href="simulace4.html#cb481-5" tabindex="-1"></a><span class="co"># divide the training data into k parts</span></span>
<span id="cb481-6"><a href="simulace4.html#cb481-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb481-7"><a href="simulace4.html#cb481-7" tabindex="-1"></a><span class="do">## elements that do not change during the loop</span></span>
<span id="cb481-8"><a href="simulace4.html#cb481-8" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb481-9"><a href="simulace4.html#cb481-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb481-10"><a href="simulace4.html#cb481-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb481-11"><a href="simulace4.html#cb481-11" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb481-12"><a href="simulace4.html#cb481-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb481-13"><a href="simulace4.html#cb481-13" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb481-14"><a href="simulace4.html#cb481-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb481-15"><a href="simulace4.html#cb481-15" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb481-16"><a href="simulace4.html#cb481-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb481-17"><a href="simulace4.html#cb481-17" tabindex="-1"></a><span class="co"># empty matrix to store results</span></span>
<span id="cb481-18"><a href="simulace4.html#cb481-18" tabindex="-1"></a><span class="co"># columns will contain accuracy values for the respective training subset</span></span>
<span id="cb481-19"><a href="simulace4.html#cb481-19" tabindex="-1"></a><span class="co"># rows will contain values for the respective number of bases</span></span>
<span id="cb481-20"><a href="simulace4.html#cb481-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb481-21"><a href="simulace4.html#cb481-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now that we have everything prepared, we will calculate the error rates for each of the ten subsets of the training set. Subsequently, we will determine the average error and take the argument of the minimum validation error as the optimal <span class="math inline">\(n\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb482"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb482-1"><a href="simulace4.html#cb482-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb482-2"><a href="simulace4.html#cb482-2" tabindex="-1"></a>  <span class="co"># define the index set</span></span>
<span id="cb482-3"><a href="simulace4.html#cb482-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb482-4"><a href="simulace4.html#cb482-4" tabindex="-1"></a>    </span>
<span id="cb482-5"><a href="simulace4.html#cb482-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb482-6"><a href="simulace4.html#cb482-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb482-7"><a href="simulace4.html#cb482-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb482-8"><a href="simulace4.html#cb482-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb482-9"><a href="simulace4.html#cb482-9" tabindex="-1"></a>  </span>
<span id="cb482-10"><a href="simulace4.html#cb482-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb482-11"><a href="simulace4.html#cb482-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb482-12"><a href="simulace4.html#cb482-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb482-13"><a href="simulace4.html#cb482-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb482-14"><a href="simulace4.html#cb482-14" tabindex="-1"></a>  </span>
<span id="cb482-15"><a href="simulace4.html#cb482-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb482-16"><a href="simulace4.html#cb482-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb482-17"><a href="simulace4.html#cb482-17" tabindex="-1"></a>  </span>
<span id="cb482-18"><a href="simulace4.html#cb482-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb482-19"><a href="simulace4.html#cb482-19" tabindex="-1"></a>    <span class="co"># basis for betas</span></span>
<span id="cb482-20"><a href="simulace4.html#cb482-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb482-21"><a href="simulace4.html#cb482-21" tabindex="-1"></a>    </span>
<span id="cb482-22"><a href="simulace4.html#cb482-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb482-23"><a href="simulace4.html#cb482-23" tabindex="-1"></a>    <span class="co"># input data for the model</span></span>
<span id="cb482-24"><a href="simulace4.html#cb482-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb482-25"><a href="simulace4.html#cb482-25" tabindex="-1"></a>    <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb482-26"><a href="simulace4.html#cb482-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb482-27"><a href="simulace4.html#cb482-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb482-28"><a href="simulace4.html#cb482-28" tabindex="-1"></a>    </span>
<span id="cb482-29"><a href="simulace4.html#cb482-29" tabindex="-1"></a>    <span class="co"># accuracy on the validation subset </span></span>
<span id="cb482-30"><a href="simulace4.html#cb482-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb482-31"><a href="simulace4.html#cb482-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb482-32"><a href="simulace4.html#cb482-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb482-33"><a href="simulace4.html#cb482-33" tabindex="-1"></a>    accuracy.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb482-34"><a href="simulace4.html#cb482-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb482-35"><a href="simulace4.html#cb482-35" tabindex="-1"></a>    </span>
<span id="cb482-36"><a href="simulace4.html#cb482-36" tabindex="-1"></a>    <span class="co"># insert into the matrix</span></span>
<span id="cb482-37"><a href="simulace4.html#cb482-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> accuracy.valid</span>
<span id="cb482-38"><a href="simulace4.html#cb482-38" tabindex="-1"></a>  } </span>
<span id="cb482-39"><a href="simulace4.html#cb482-39" tabindex="-1"></a>}</span>
<span id="cb482-40"><a href="simulace4.html#cb482-40" tabindex="-1"></a></span>
<span id="cb482-41"><a href="simulace4.html#cb482-41" tabindex="-1"></a><span class="co"># calculate average accuracies for each n across folds</span></span>
<span id="cb482-42"><a href="simulace4.html#cb482-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb482-43"><a href="simulace4.html#cb482-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb482-44"><a href="simulace4.html#cb482-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb482-45"><a href="simulace4.html#cb482-45" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>Let’s plot the validation error rates, highlighting the optimal value of <span class="math inline">\(n_{optimal}\)</span>, which is 14, with a validation error rate of 0.0684.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb483"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb483-1"><a href="simulace4.html#cb483-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb483-2"><a href="simulace4.html#cb483-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb483-3"><a href="simulace4.html#cb483-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb483-4"><a href="simulace4.html#cb483-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb483-5"><a href="simulace4.html#cb483-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb483-6"><a href="simulace4.html#cb483-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb483-7"><a href="simulace4.html#cb483-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb483-8"><a href="simulace4.html#cb483-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb483-9"><a href="simulace4.html#cb483-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb483-10"><a href="simulace4.html#cb483-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 32 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-46-1.png" alt="Dependence of validation error on the value of $n_{basis}$, i.e., on the number of bases." width="672" />
<p class="caption">
Figure 1.15: Dependence of validation error on the value of <span class="math inline">\(n_{basis}\)</span>, i.e., on the number of bases.
</p>
</div>
<p>We can now define the final model using functional logistic regression, choosing the B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 14 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb485"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb485-1"><a href="simulace4.html#cb485-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb485-2"><a href="simulace4.html#cb485-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb485-3"><a href="simulace4.html#cb485-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb485-4"><a href="simulace4.html#cb485-4" tabindex="-1"></a><span class="co"># bases for x and betas</span></span>
<span id="cb485-5"><a href="simulace4.html#cb485-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb485-6"><a href="simulace4.html#cb485-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb485-7"><a href="simulace4.html#cb485-7" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb485-8"><a href="simulace4.html#cb485-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb485-9"><a href="simulace4.html#cb485-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb485-10"><a href="simulace4.html#cb485-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb485-11"><a href="simulace4.html#cb485-11" tabindex="-1"></a><span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb485-12"><a href="simulace4.html#cb485-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb485-13"><a href="simulace4.html#cb485-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb485-14"><a href="simulace4.html#cb485-14" tabindex="-1"></a></span>
<span id="cb485-15"><a href="simulace4.html#cb485-15" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb485-16"><a href="simulace4.html#cb485-16" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb485-17"><a href="simulace4.html#cb485-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb485-18"><a href="simulace4.html#cb485-18" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb485-19"><a href="simulace4.html#cb485-19" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb485-20"><a href="simulace4.html#cb485-20" tabindex="-1"></a>  </span>
<span id="cb485-21"><a href="simulace4.html#cb485-21" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb485-22"><a href="simulace4.html#cb485-22" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb485-23"><a href="simulace4.html#cb485-23" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb485-24"><a href="simulace4.html#cb485-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb485-25"><a href="simulace4.html#cb485-25" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb485-26"><a href="simulace4.html#cb485-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the training error rate (which is 5 %) and the test error rate (which is 11.67 %). For better visualization, we can also plot the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> on the training data against the values of the linear predictor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb486"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb486-1"><a href="simulace4.html#cb486-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb486-2"><a href="simulace4.html#cb486-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb486-3"><a href="simulace4.html#cb486-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb486-4"><a href="simulace4.html#cb486-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb486-5"><a href="simulace4.html#cb486-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb486-6"><a href="simulace4.html#cb486-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb486-7"><a href="simulace4.html#cb486-7" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb486-8"><a href="simulace4.html#cb486-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb486-9"><a href="simulace4.html#cb486-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb486-10"><a href="simulace4.html#cb486-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb486-11"><a href="simulace4.html#cb486-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probability Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb486-12"><a href="simulace4.html#cb486-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-48"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-48-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to their classification class." width="672" />
<p class="caption">
Figure 5.5: Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to their classification class.
</p>
</div>
<p>For informational purposes, we can also display the progression of the estimated parametric function <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb487"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb487-1"><a href="simulace4.html#cb487-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb487-2"><a href="simulace4.html#cb487-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb487-3"><a href="simulace4.html#cb487-3" tabindex="-1"></a></span>
<span id="cb487-4"><a href="simulace4.html#cb487-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb487-5"><a href="simulace4.html#cb487-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb487-6"><a href="simulace4.html#cb487-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb487-7"><a href="simulace4.html#cb487-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb487-8"><a href="simulace4.html#cb487-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb487-9"><a href="simulace4.html#cb487-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb487-10"><a href="simulace4.html#cb487-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb487-11"><a href="simulace4.html#cb487-11" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb487-12"><a href="simulace4.html#cb487-12" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-49"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-49-1.png" alt="Plot of the estimated parametric function $\beta(t), t \in [0, 6]$." width="672" />
<p class="caption">
Figure 5.6: Plot of the estimated parametric function <span class="math inline">\(\beta(t), t \in [0, 6]\)</span>.
</p>
</div>
<p>Finally, we will add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb488"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb488-1"><a href="simulace4.html#cb488-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb488-2"><a href="simulace4.html#cb488-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb488-3"><a href="simulace4.html#cb488-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb488-4"><a href="simulace4.html#cb488-4" tabindex="-1"></a></span>
<span id="cb488-5"><a href="simulace4.html#cb488-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-with-principal-component-analysis-1" class="section level5 hasAnchor" number="5.1.3.4.2">
<h5><span class="header-section-number">5.1.3.4.2</span> Logistic Regression with Principal Component Analysis<a href="simulace4.html#logistic-regression-with-principal-component-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To construct this classifier, we need to perform functional principal component analysis, determine the appropriate number of components, and calculate the score values for the test data. We have already completed this in the linear discriminant analysis section, so we will use these results in the following section.</p>
<p>We can directly construct the logistic regression model using the <code>glm(, family = binomial)</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb489"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb489-1"><a href="simulace4.html#cb489-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb489-2"><a href="simulace4.html#cb489-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb489-3"><a href="simulace4.html#cb489-3" tabindex="-1"></a></span>
<span id="cb489-4"><a href="simulace4.html#cb489-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb489-5"><a href="simulace4.html#cb489-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb489-6"><a href="simulace4.html#cb489-6" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb489-7"><a href="simulace4.html#cb489-7" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb489-8"><a href="simulace4.html#cb489-8" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb489-9"><a href="simulace4.html#cb489-9" tabindex="-1"></a></span>
<span id="cb489-10"><a href="simulace4.html#cb489-10" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb489-11"><a href="simulace4.html#cb489-11" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb489-12"><a href="simulace4.html#cb489-12" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb489-13"><a href="simulace4.html#cb489-13" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb489-14"><a href="simulace4.html#cb489-14" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (31.43 %) and on the test data (23.33 %).</p>
<p>For graphical representation of the method, we can plot the decision boundary in the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did in the LDA and QDA cases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb490"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb490-1"><a href="simulace4.html#cb490-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb490-2"><a href="simulace4.html#cb490-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb490-3"><a href="simulace4.html#cb490-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb490-4"><a href="simulace4.html#cb490-4" tabindex="-1"></a></span>
<span id="cb490-5"><a href="simulace4.html#cb490-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb490-6"><a href="simulace4.html#cb490-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb490-7"><a href="simulace4.html#cb490-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variance&#39;</span>, </span>
<span id="cb490-8"><a href="simulace4.html#cb490-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb490-9"><a href="simulace4.html#cb490-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb490-10"><a href="simulace4.html#cb490-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb490-11"><a href="simulace4.html#cb490-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb490-12"><a href="simulace4.html#cb490-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb490-13"><a href="simulace4.html#cb490-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb490-14"><a href="simulace4.html#cb490-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-53"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-53-1.png" alt="Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes is indicated in black, constructed using logistic regression." width="672" />
<p class="caption">
Figure 5.7: Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes is indicated in black, constructed using logistic regression.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a line, similar to the case with LDA.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb491"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb491-1"><a href="simulace4.html#cb491-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb491-2"><a href="simulace4.html#cb491-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb491-3"><a href="simulace4.html#cb491-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb491-4"><a href="simulace4.html#cb491-4" tabindex="-1"></a></span>
<span id="cb491-5"><a href="simulace4.html#cb491-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="decision-trees-2" class="section level4 hasAnchor" number="5.1.3.5">
<h4><span class="header-section-number">5.1.3.5</span> Decision Trees<a href="simulace4.html#decision-trees-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section, we will look at a very different approach to constructing a classifier compared to methods such as LDA or logistic regression. Decision trees are a very popular tool for classification; however, like some of the previous methods, they are not directly designed for functional data. There are, however, procedures to convert functional objects into multidimensional ones, allowing us to apply decision tree algorithms. We can consider the following approaches:</p>
<ul>
<li><p>An algorithm built on basis coefficients,</p></li>
<li><p>Utilizing principal component scores,</p></li>
<li><p>Discretizing the interval and evaluating the function only on a finite grid of points.</p></li>
</ul>
<p>We will first focus on discretizing the interval and then compare the results with the other two approaches to constructing decision trees.</p>
<div id="interval-discretization-3" class="section level5 hasAnchor" number="5.1.3.5.1">
<h5><span class="header-section-number">5.1.3.5.1</span> Interval Discretization<a href="simulace4.html#interval-discretization-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>First, we need to define points from the interval <span class="math inline">\(I = [0, 6]\)</span>, where we will evaluate the functions. Next, we will create an object where the rows represent the individual (discretized) functions and the columns represent time. Finally, we will add a column <span class="math inline">\(Y\)</span> containing information about the classification class and repeat the same for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb492"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb492-1"><a href="simulace4.html#cb492-1" tabindex="-1"></a><span class="co"># sequence of points at which we will evaluate the functions</span></span>
<span id="cb492-2"><a href="simulace4.html#cb492-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb492-3"><a href="simulace4.html#cb492-3" tabindex="-1"></a>   </span>
<span id="cb492-4"><a href="simulace4.html#cb492-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb492-5"><a href="simulace4.html#cb492-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for functions in rows</span></span>
<span id="cb492-6"><a href="simulace4.html#cb492-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb492-7"><a href="simulace4.html#cb492-7" tabindex="-1"></a></span>
<span id="cb492-8"><a href="simulace4.html#cb492-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb492-9"><a href="simulace4.html#cb492-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb492-10"><a href="simulace4.html#cb492-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can construct a decision tree where all times from the vector <code>t.seq</code> will serve as predictors. This classification method is not susceptible to multicollinearity, so we do not need to worry about it. We will choose accuracy as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb493"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb493-1"><a href="simulace4.html#cb493-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb493-2"><a href="simulace4.html#cb493-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb493-3"><a href="simulace4.html#cb493-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb493-4"><a href="simulace4.html#cb493-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb493-5"><a href="simulace4.html#cb493-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb493-6"><a href="simulace4.html#cb493-6" tabindex="-1"></a></span>
<span id="cb493-7"><a href="simulace4.html#cb493-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb493-8"><a href="simulace4.html#cb493-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb493-9"><a href="simulace4.html#cb493-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb493-10"><a href="simulace4.html#cb493-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb493-11"><a href="simulace4.html#cb493-11" tabindex="-1"></a>  </span>
<span id="cb493-12"><a href="simulace4.html#cb493-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb493-13"><a href="simulace4.html#cb493-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb493-14"><a href="simulace4.html#cb493-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb493-15"><a href="simulace4.html#cb493-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the classifier on the test data is thus 18.33 %, and on the training data 26.43 %.</p>
<p>We can visualize the decision tree graphically using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb494"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb494-1"><a href="simulace4.html#cb494-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb494-2"><a href="simulace4.html#cb494-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb494-3"><a href="simulace4.html#cb494-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-57"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-57-1.png" alt="Graphical representation of the unpruned decision tree. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 1.18: Graphical representation of the unpruned decision tree. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb495"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb495-1"><a href="simulace4.html#cb495-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb495-2"><a href="simulace4.html#cb495-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb495-3"><a href="simulace4.html#cb495-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb495-4"><a href="simulace4.html#cb495-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb495-5"><a href="simulace4.html#cb495-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb495-6"><a href="simulace4.html#cb495-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb495-7"><a href="simulace4.html#cb495-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb495-8"><a href="simulace4.html#cb495-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-58"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-58-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.8: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb496"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb496-1"><a href="simulace4.html#cb496-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discr.&#39;</span>, </span>
<span id="cb496-2"><a href="simulace4.html#cb496-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb496-3"><a href="simulace4.html#cb496-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb496-4"><a href="simulace4.html#cb496-4" tabindex="-1"></a></span>
<span id="cb496-5"><a href="simulace4.html#cb496-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-5" class="section level5 hasAnchor" number="5.1.3.5.2">
<h5><span class="header-section-number">5.1.3.5.2</span> Principal Component Scores<a href="simulace4.html#principal-component-scores-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another option for constructing a decision tree is to use principal component scores. Since we have already calculated the scores for the previous classification methods, we will utilize this knowledge and construct a decision tree based on the scores of the first 3 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb497"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb497-1"><a href="simulace4.html#cb497-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb497-2"><a href="simulace4.html#cb497-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb497-3"><a href="simulace4.html#cb497-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb497-4"><a href="simulace4.html#cb497-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb497-5"><a href="simulace4.html#cb497-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb497-6"><a href="simulace4.html#cb497-6" tabindex="-1"></a></span>
<span id="cb497-7"><a href="simulace4.html#cb497-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb497-8"><a href="simulace4.html#cb497-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb497-9"><a href="simulace4.html#cb497-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb497-10"><a href="simulace4.html#cb497-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb497-11"><a href="simulace4.html#cb497-11" tabindex="-1"></a>  </span>
<span id="cb497-12"><a href="simulace4.html#cb497-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb497-13"><a href="simulace4.html#cb497-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb497-14"><a href="simulace4.html#cb497-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb497-15"><a href="simulace4.html#cb497-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the test data is thus 23.33 %, and on the training data 30 %.</p>
<p>We can visualize the decision tree constructed on the principal component scores using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb498"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb498-1"><a href="simulace4.html#cb498-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb498-2"><a href="simulace4.html#cb498-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-61"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-61-1.png" alt="Graphical representation of the unpruned decision tree constructed on principal component scores. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 1.20: Graphical representation of the unpruned decision tree constructed on principal component scores. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb499"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb499-1"><a href="simulace4.html#cb499-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb499-2"><a href="simulace4.html#cb499-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb499-3"><a href="simulace4.html#cb499-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb499-4"><a href="simulace4.html#cb499-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb499-5"><a href="simulace4.html#cb499-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb499-6"><a href="simulace4.html#cb499-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-62"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-62-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 3.1: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb500"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb500-1"><a href="simulace4.html#cb500-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb500-2"><a href="simulace4.html#cb500-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb500-3"><a href="simulace4.html#cb500-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb500-4"><a href="simulace4.html#cb500-4" tabindex="-1"></a></span>
<span id="cb500-5"><a href="simulace4.html#cb500-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-2" class="section level5 hasAnchor" number="5.1.3.5.3">
<h5><span class="header-section-number">5.1.3.5.3</span> Basis Coefficients<a href="simulace4.html#basis-coefficients-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The final option we will utilize for constructing a decision tree is to use coefficients in the representation of functions in the B-spline basis.</p>
<p>First, let’s define the necessary datasets with the coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb501"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb501-1"><a href="simulace4.html#cb501-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb501-2"><a href="simulace4.html#cb501-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb501-3"><a href="simulace4.html#cb501-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb501-4"><a href="simulace4.html#cb501-4" tabindex="-1"></a></span>
<span id="cb501-5"><a href="simulace4.html#cb501-5" tabindex="-1"></a><span class="co"># test dataset</span></span>
<span id="cb501-6"><a href="simulace4.html#cb501-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb501-7"><a href="simulace4.html#cb501-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now we can construct the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb502"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb502-1"><a href="simulace4.html#cb502-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb502-2"><a href="simulace4.html#cb502-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb502-3"><a href="simulace4.html#cb502-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb502-4"><a href="simulace4.html#cb502-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb502-5"><a href="simulace4.html#cb502-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb502-6"><a href="simulace4.html#cb502-6" tabindex="-1"></a></span>
<span id="cb502-7"><a href="simulace4.html#cb502-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb502-8"><a href="simulace4.html#cb502-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb502-9"><a href="simulace4.html#cb502-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb502-10"><a href="simulace4.html#cb502-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb502-11"><a href="simulace4.html#cb502-11" tabindex="-1"></a>  </span>
<span id="cb502-12"><a href="simulace4.html#cb502-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb502-13"><a href="simulace4.html#cb502-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb502-14"><a href="simulace4.html#cb502-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb502-15"><a href="simulace4.html#cb502-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the training data is thus 26.43 %, and on the test data 18.33 %.</p>
<p>We can visualize the decision tree constructed on the B-spline coefficient representation using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb503"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb503-1"><a href="simulace4.html#cb503-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb503-2"><a href="simulace4.html#cb503-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-66"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-66-1.png" alt="Graphical representation of the unpruned decision tree constructed on basis coefficients. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 1.22: Graphical representation of the unpruned decision tree constructed on basis coefficients. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb504"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb504-1"><a href="simulace4.html#cb504-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb504-2"><a href="simulace4.html#cb504-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb504-3"><a href="simulace4.html#cb504-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb504-4"><a href="simulace4.html#cb504-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb504-5"><a href="simulace4.html#cb504-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb504-6"><a href="simulace4.html#cb504-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-67"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-67-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.9: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb505"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb505-1"><a href="simulace4.html#cb505-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb505-2"><a href="simulace4.html#cb505-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb505-3"><a href="simulace4.html#cb505-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb505-4"><a href="simulace4.html#cb505-4" tabindex="-1"></a></span>
<span id="cb505-5"><a href="simulace4.html#cb505-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests-3" class="section level4 hasAnchor" number="5.1.3.6">
<h4><span class="header-section-number">5.1.3.6</span> Random Forests<a href="simulace4.html#random-forests-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The classifier constructed using the random forests method consists of building several individual decision trees, which are then combined to create a common classifier (via “voting”).</p>
<p>As with decision trees, we have several options regarding which data (finite-dimensional) we will use to construct the model. We will again consider the three approaches discussed above. The datasets with the corresponding variables for all three approaches have already been prepared from the previous section, so we can directly construct the models, calculate the characteristics of the classifiers, and add the results to the summary table.</p>
<div id="interval-discretization-4" class="section level5 hasAnchor" number="5.1.3.6.1">
<h5><span class="header-section-number">5.1.3.6.1</span> Interval Discretization<a href="simulace4.html#interval-discretization-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the first case, we utilize the evaluation of functions on a given grid of points over the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb506"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb506-1"><a href="simulace4.html#cb506-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb506-2"><a href="simulace4.html#cb506-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb506-3"><a href="simulace4.html#cb506-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb506-4"><a href="simulace4.html#cb506-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb506-5"><a href="simulace4.html#cb506-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb506-6"><a href="simulace4.html#cb506-6" tabindex="-1"></a></span>
<span id="cb506-7"><a href="simulace4.html#cb506-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb506-8"><a href="simulace4.html#cb506-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb506-9"><a href="simulace4.html#cb506-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb506-10"><a href="simulace4.html#cb506-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb506-11"><a href="simulace4.html#cb506-11" tabindex="-1"></a>  </span>
<span id="cb506-12"><a href="simulace4.html#cb506-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb506-13"><a href="simulace4.html#cb506-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb506-14"><a href="simulace4.html#cb506-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb506-15"><a href="simulace4.html#cb506-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 0 %, and on the test data 20 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb507"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb507-1"><a href="simulace4.html#cb507-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discretization&#39;</span>, </span>
<span id="cb507-2"><a href="simulace4.html#cb507-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb507-3"><a href="simulace4.html#cb507-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb507-4"><a href="simulace4.html#cb507-4" tabindex="-1"></a></span>
<span id="cb507-5"><a href="simulace4.html#cb507-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-6" class="section level5 hasAnchor" number="5.1.3.6.2">
<h5><span class="header-section-number">5.1.3.6.2</span> Principal Component Scores<a href="simulace4.html#principal-component-scores-6" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this case, we will use the scores of the first $p = $ 3 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb508"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb508-1"><a href="simulace4.html#cb508-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb508-2"><a href="simulace4.html#cb508-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb508-3"><a href="simulace4.html#cb508-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb508-4"><a href="simulace4.html#cb508-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb508-5"><a href="simulace4.html#cb508-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb508-6"><a href="simulace4.html#cb508-6" tabindex="-1"></a></span>
<span id="cb508-7"><a href="simulace4.html#cb508-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb508-8"><a href="simulace4.html#cb508-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb508-9"><a href="simulace4.html#cb508-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb508-10"><a href="simulace4.html#cb508-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb508-11"><a href="simulace4.html#cb508-11" tabindex="-1"></a>  </span>
<span id="cb508-12"><a href="simulace4.html#cb508-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb508-13"><a href="simulace4.html#cb508-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb508-14"><a href="simulace4.html#cb508-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb508-15"><a href="simulace4.html#cb508-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate on the training data is thus 1.43 %, and on the test data 30 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb509"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb509-1"><a href="simulace4.html#cb509-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb509-2"><a href="simulace4.html#cb509-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb509-3"><a href="simulace4.html#cb509-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb509-4"><a href="simulace4.html#cb509-4" tabindex="-1"></a></span>
<span id="cb509-5"><a href="simulace4.html#cb509-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-3" class="section level5 hasAnchor" number="5.1.3.6.3">
<h5><span class="header-section-number">5.1.3.6.3</span> Basis Coefficients<a href="simulace4.html#basis-coefficients-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Finally, we will use the representation of functions through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb510"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb510-1"><a href="simulace4.html#cb510-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb510-2"><a href="simulace4.html#cb510-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb510-3"><a href="simulace4.html#cb510-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb510-4"><a href="simulace4.html#cb510-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb510-5"><a href="simulace4.html#cb510-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb510-6"><a href="simulace4.html#cb510-6" tabindex="-1"></a></span>
<span id="cb510-7"><a href="simulace4.html#cb510-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb510-8"><a href="simulace4.html#cb510-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb510-9"><a href="simulace4.html#cb510-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb510-10"><a href="simulace4.html#cb510-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb510-11"><a href="simulace4.html#cb510-11" tabindex="-1"></a>  </span>
<span id="cb510-12"><a href="simulace4.html#cb510-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb510-13"><a href="simulace4.html#cb510-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb510-14"><a href="simulace4.html#cb510-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb510-15"><a href="simulace4.html#cb510-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 0 %, and on the test data 18.33 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb511"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb511-1"><a href="simulace4.html#cb511-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb511-2"><a href="simulace4.html#cb511-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb511-3"><a href="simulace4.html#cb511-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb511-4"><a href="simulace4.html#cb511-4" tabindex="-1"></a></span>
<span id="cb511-5"><a href="simulace4.html#cb511-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-4" class="section level4 hasAnchor" number="5.1.3.7">
<h4><span class="header-section-number">5.1.3.7</span> Support Vector Machines<a href="simulace4.html#support-vector-machines-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let’s look at classifying our simulated curves using the Support Vector Machines (SVM) method. The advantage of this classification method is its computational efficiency, as it defines the boundary curve between classes using only a few (often very few) observations.</p>
<p>In the case of functional data, we have several options for applying the SVM method. The simplest variant is to use this classification method directly on the discretized function (section <a href="simulace4.html#diskr1der">5.1.3.7.2</a>). Another option is to utilize the principal component scores to classify curves based on their representation <a href="simulace4.html#PCA-SVM1der">5.1.3.7.3</a>. A straightforward variant is to use the representation of curves through the B-spline basis and classify curves based on the coefficients of their representation in this basis (section <a href="simulace4.html#basis-SVM1der">5.1.3.7.4</a>).</p>
<p>A more complex consideration can lead us to several additional options that leverage the functional nature of the data. We can utilize projections of functions onto a subspace generated, for example, by B-spline functions (section <a href="simulace4.html#projection-SVM1der">5.1.3.7.5</a>). The final method we will use for classifying functional data involves combining projection onto a certain subspace generated by functions (Reproducing Kernel Hilbert Space, RKHS) and classifying the corresponding representation. This method utilizes not only the classical SVM but also SVM for regression, as discussed in section RKHS + SVM <a href="simulace4.html#RKHS-SVM1der">5.1.3.7.6</a>.</p>
<div id="svm-for-functional-data-2" class="section level5 hasAnchor" number="5.1.3.7.1">
<h5><span class="header-section-number">5.1.3.7.1</span> SVM for Functional Data<a href="simulace4.html#svm-for-functional-data-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the <code>fda.usc</code> library, we will use the function <code>classif.svm()</code> to apply the SVM method directly to functional data. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb512"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb512-1"><a href="simulace4.html#cb512-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb512-2"><a href="simulace4.html#cb512-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb512-3"><a href="simulace4.html#cb512-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb512-4"><a href="simulace4.html#cb512-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb512-5"><a href="simulace4.html#cb512-5" tabindex="-1"></a>}</span>
<span id="cb512-6"><a href="simulace4.html#cb512-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXder </span>
<span id="cb512-7"><a href="simulace4.html#cb512-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb512-8"><a href="simulace4.html#cb512-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb512-9"><a href="simulace4.html#cb512-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb512-10"><a href="simulace4.html#cb512-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb512-11"><a href="simulace4.html#cb512-11" tabindex="-1"></a></span>
<span id="cb512-12"><a href="simulace4.html#cb512-12" tabindex="-1"></a><span class="co"># split into test and training sets</span></span>
<span id="cb512-13"><a href="simulace4.html#cb512-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb512-14"><a href="simulace4.html#cb512-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb512-15"><a href="simulace4.html#cb512-15" tabindex="-1"></a></span>
<span id="cb512-16"><a href="simulace4.html#cb512-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb512-17"><a href="simulace4.html#cb512-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb512-18"><a href="simulace4.html#cb512-18" tabindex="-1"></a></span>
<span id="cb512-19"><a href="simulace4.html#cb512-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb512-20"><a href="simulace4.html#cb512-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb512-21"><a href="simulace4.html#cb512-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb512-22"><a href="simulace4.html#cb512-22" tabindex="-1"></a></span>
<span id="cb512-23"><a href="simulace4.html#cb512-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb512-24"><a href="simulace4.html#cb512-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb512-25"><a href="simulace4.html#cb512-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb513"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb513-1"><a href="simulace4.html#cb513-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb513-2"><a href="simulace4.html#cb513-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb513-3"><a href="simulace4.html#cb513-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb513-4"><a href="simulace4.html#cb513-4" tabindex="-1"></a></span>
<span id="cb513-5"><a href="simulace4.html#cb513-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb513-6"><a href="simulace4.html#cb513-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb513-7"><a href="simulace4.html#cb513-7" tabindex="-1"></a></span>
<span id="cb513-8"><a href="simulace4.html#cb513-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb513-9"><a href="simulace4.html#cb513-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb513-10"><a href="simulace4.html#cb513-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb513-11"><a href="simulace4.html#cb513-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span></code></pre></div>
</details>
<p>Finally, we can construct the classifiers on the entire training data with the hyperparameter values (determined previously by CV). We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb514"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb514-1"><a href="simulace4.html#cb514-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb514-2"><a href="simulace4.html#cb514-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb514-3"><a href="simulace4.html#cb514-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb514-4"><a href="simulace4.html#cb514-4" tabindex="-1"></a></span>
<span id="cb514-5"><a href="simulace4.html#cb514-5" tabindex="-1"></a><span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb514-6"><a href="simulace4.html#cb514-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb514-7"><a href="simulace4.html#cb514-7" tabindex="-1"></a></span>
<span id="cb514-8"><a href="simulace4.html#cb514-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb514-9"><a href="simulace4.html#cb514-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb514-10"><a href="simulace4.html#cb514-10" tabindex="-1"></a><span class="co"># B-spline basis</span></span>
<span id="cb514-11"><a href="simulace4.html#cb514-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb514-12"><a href="simulace4.html#cb514-12" tabindex="-1"></a></span>
<span id="cb514-13"><a href="simulace4.html#cb514-13" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb514-14"><a href="simulace4.html#cb514-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb514-15"><a href="simulace4.html#cb514-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb514-16"><a href="simulace4.html#cb514-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb514-17"><a href="simulace4.html#cb514-17" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb514-18"><a href="simulace4.html#cb514-18" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb515"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb515-1"><a href="simulace4.html#cb515-1" tabindex="-1"></a>model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb515-2"><a href="simulace4.html#cb515-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb515-3"><a href="simulace4.html#cb515-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb515-4"><a href="simulace4.html#cb515-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb515-5"><a href="simulace4.html#cb515-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb515-6"><a href="simulace4.html#cb515-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb515-7"><a href="simulace4.html#cb515-7" tabindex="-1"></a>            <span class="at">cost =</span> <span class="dv">10</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in Minverse(t(B) %*% B): System is computationally singular (rank  54)
## 
##           The  matrix inverse is computed by svd (effective rank 52)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb517"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb517-1"><a href="simulace4.html#cb517-1" tabindex="-1"></a>model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb517-2"><a href="simulace4.html#cb517-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb517-3"><a href="simulace4.html#cb517-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb517-4"><a href="simulace4.html#cb517-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb517-5"><a href="simulace4.html#cb517-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb517-6"><a href="simulace4.html#cb517-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb517-7"><a href="simulace4.html#cb517-7" tabindex="-1"></a>            <span class="at">degree =</span> <span class="dv">3</span>,</span>
<span id="cb517-8"><a href="simulace4.html#cb517-8" tabindex="-1"></a>            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb517-9"><a href="simulace4.html#cb517-9" tabindex="-1"></a>            <span class="at">cost =</span> <span class="dv">10</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in Minverse(t(B) %*% B): System is computationally singular (rank  54)
## 
##           The  matrix inverse is computed by svd (effective rank 52)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb519"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb519-1"><a href="simulace4.html#cb519-1" tabindex="-1"></a>model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb519-2"><a href="simulace4.html#cb519-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb519-3"><a href="simulace4.html#cb519-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb519-4"><a href="simulace4.html#cb519-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb519-5"><a href="simulace4.html#cb519-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb519-6"><a href="simulace4.html#cb519-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb519-7"><a href="simulace4.html#cb519-7" tabindex="-1"></a>            <span class="at">gamma =</span> <span class="fl">0.001</span>,</span>
<span id="cb519-8"><a href="simulace4.html#cb519-8" tabindex="-1"></a>            <span class="at">cost =</span> <span class="dv">100</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in Minverse(t(B) %*% B): System is computationally singular (rank  54)
## 
##           The  matrix inverse is computed by svd (effective rank 52)</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb521"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb521-1"><a href="simulace4.html#cb521-1" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb521-2"><a href="simulace4.html#cb521-2" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb521-3"><a href="simulace4.html#cb521-3" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-4"><a href="simulace4.html#cb521-4" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb521-5"><a href="simulace4.html#cb521-5" tabindex="-1"></a></span>
<span id="cb521-6"><a href="simulace4.html#cb521-6" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-7"><a href="simulace4.html#cb521-7" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb521-8"><a href="simulace4.html#cb521-8" tabindex="-1"></a></span>
<span id="cb521-9"><a href="simulace4.html#cb521-9" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-10"><a href="simulace4.html#cb521-10" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb521-11"><a href="simulace4.html#cb521-11" tabindex="-1"></a>  </span>
<span id="cb521-12"><a href="simulace4.html#cb521-12" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb521-13"><a href="simulace4.html#cb521-13" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb521-14"><a href="simulace4.html#cb521-14" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-15"><a href="simulace4.html#cb521-15" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb521-16"><a href="simulace4.html#cb521-16" tabindex="-1"></a></span>
<span id="cb521-17"><a href="simulace4.html#cb521-17" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-18"><a href="simulace4.html#cb521-18" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb521-19"><a href="simulace4.html#cb521-19" tabindex="-1"></a></span>
<span id="cb521-20"><a href="simulace4.html#cb521-20" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb521-21"><a href="simulace4.html#cb521-21" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 15.7143 % for the linear kernel, 12.1429 % for the polynomial kernel, and 15.7143 % for the Gaussian kernel. On the test data, the error rate of the method is 16.6667 % for the linear kernel, 25 % for the polynomial kernel, and 23.3333 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb522"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb522-1"><a href="simulace4.html#cb522-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb522-2"><a href="simulace4.html#cb522-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb522-3"><a href="simulace4.html#cb522-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb522-4"><a href="simulace4.html#cb522-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb522-5"><a href="simulace4.html#cb522-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb522-6"><a href="simulace4.html#cb522-6" tabindex="-1"></a></span>
<span id="cb522-7"><a href="simulace4.html#cb522-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="diskr1der" class="section level5 hasAnchor" number="5.1.3.7.2">
<h5><span class="header-section-number">5.1.3.7.2</span> Interval Discretization<a href="simulace4.html#diskr1der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s continue by applying the Support Vector Machines method directly to the discretized data (evaluation of the function on a grid of points over the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three aforementioned kernel functions.</p>
<p>We will now classify the normalized data using the classic SVM method, selecting parameters as follows. For one generated dataset, we will determine parameters using cross-validation (CV), and these parameters will then be applied to other simulated data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb523"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb523-1"><a href="simulace4.html#cb523-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb523-2"><a href="simulace4.html#cb523-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb523-3"><a href="simulace4.html#cb523-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb523-4"><a href="simulace4.html#cb523-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb523-5"><a href="simulace4.html#cb523-5" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">25</span>,</span>
<span id="cb523-6"><a href="simulace4.html#cb523-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb523-7"><a href="simulace4.html#cb523-7" tabindex="-1"></a></span>
<span id="cb523-8"><a href="simulace4.html#cb523-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb523-9"><a href="simulace4.html#cb523-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb523-10"><a href="simulace4.html#cb523-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb523-11"><a href="simulace4.html#cb523-11" tabindex="-1"></a>                 <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb523-12"><a href="simulace4.html#cb523-12" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="fl">0.7</span>,</span>
<span id="cb523-13"><a href="simulace4.html#cb523-13" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb523-14"><a href="simulace4.html#cb523-14" tabindex="-1"></a></span>
<span id="cb523-15"><a href="simulace4.html#cb523-15" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb523-16"><a href="simulace4.html#cb523-16" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb523-17"><a href="simulace4.html#cb523-17" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb523-18"><a href="simulace4.html#cb523-18" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">55</span>,</span>
<span id="cb523-19"><a href="simulace4.html#cb523-19" tabindex="-1"></a>                 <span class="at">gamma =</span> <span class="fl">0.0005</span>,</span>
<span id="cb523-20"><a href="simulace4.html#cb523-20" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb523-21"><a href="simulace4.html#cb523-21" tabindex="-1"></a></span>
<span id="cb523-22"><a href="simulace4.html#cb523-22" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb523-23"><a href="simulace4.html#cb523-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb523-24"><a href="simulace4.html#cb523-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb523-25"><a href="simulace4.html#cb523-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb523-26"><a href="simulace4.html#cb523-26" tabindex="-1"></a></span>
<span id="cb523-27"><a href="simulace4.html#cb523-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb523-28"><a href="simulace4.html#cb523-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb523-29"><a href="simulace4.html#cb523-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb523-30"><a href="simulace4.html#cb523-30" tabindex="-1"></a></span>
<span id="cb523-31"><a href="simulace4.html#cb523-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb523-32"><a href="simulace4.html#cb523-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb523-33"><a href="simulace4.html#cb523-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb523-34"><a href="simulace4.html#cb523-34" tabindex="-1"></a></span>
<span id="cb523-35"><a href="simulace4.html#cb523-35" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb523-36"><a href="simulace4.html#cb523-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb523-37"><a href="simulace4.html#cb523-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb523-38"><a href="simulace4.html#cb523-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb523-39"><a href="simulace4.html#cb523-39" tabindex="-1"></a></span>
<span id="cb523-40"><a href="simulace4.html#cb523-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb523-41"><a href="simulace4.html#cb523-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb523-42"><a href="simulace4.html#cb523-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb523-43"><a href="simulace4.html#cb523-43" tabindex="-1"></a></span>
<span id="cb523-44"><a href="simulace4.html#cb523-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb523-45"><a href="simulace4.html#cb523-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb523-46"><a href="simulace4.html#cb523-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 7.86 % for the linear kernel, 12.86 % for the polynomial kernel, and 14.29 % for the Gaussian kernel. On the test data, the error rates are 10 % for the linear kernel, 23.33 % for the polynomial kernel, and 23.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb524"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb524-1"><a href="simulace4.html#cb524-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discretization&#39;</span>, </span>
<span id="cb524-2"><a href="simulace4.html#cb524-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - discretization&#39;</span>, </span>
<span id="cb524-3"><a href="simulace4.html#cb524-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - discretization&#39;</span>), </span>
<span id="cb524-4"><a href="simulace4.html#cb524-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb524-5"><a href="simulace4.html#cb524-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb524-6"><a href="simulace4.html#cb524-6" tabindex="-1"></a></span>
<span id="cb524-7"><a href="simulace4.html#cb524-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVM1der" class="section level5 hasAnchor" number="5.1.3.7.3">
<h5><span class="header-section-number">5.1.3.7.3</span> Principal Component Scores<a href="simulace4.html#PCA-SVM1der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 3 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb525"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb525-1"><a href="simulace4.html#cb525-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb525-2"><a href="simulace4.html#cb525-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb525-3"><a href="simulace4.html#cb525-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb525-4"><a href="simulace4.html#cb525-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb525-5"><a href="simulace4.html#cb525-5" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.1</span>,</span>
<span id="cb525-6"><a href="simulace4.html#cb525-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb525-7"><a href="simulace4.html#cb525-7" tabindex="-1"></a></span>
<span id="cb525-8"><a href="simulace4.html#cb525-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb525-9"><a href="simulace4.html#cb525-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb525-10"><a href="simulace4.html#cb525-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb525-11"><a href="simulace4.html#cb525-11" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb525-12"><a href="simulace4.html#cb525-12" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb525-13"><a href="simulace4.html#cb525-13" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb525-14"><a href="simulace4.html#cb525-14" tabindex="-1"></a></span>
<span id="cb525-15"><a href="simulace4.html#cb525-15" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb525-16"><a href="simulace4.html#cb525-16" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb525-17"><a href="simulace4.html#cb525-17" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb525-18"><a href="simulace4.html#cb525-18" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">1</span>,</span>
<span id="cb525-19"><a href="simulace4.html#cb525-19" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb525-20"><a href="simulace4.html#cb525-20" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb525-21"><a href="simulace4.html#cb525-21" tabindex="-1"></a></span>
<span id="cb525-22"><a href="simulace4.html#cb525-22" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb525-23"><a href="simulace4.html#cb525-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb525-24"><a href="simulace4.html#cb525-24" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb525-25"><a href="simulace4.html#cb525-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb525-26"><a href="simulace4.html#cb525-26" tabindex="-1"></a></span>
<span id="cb525-27"><a href="simulace4.html#cb525-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb525-28"><a href="simulace4.html#cb525-28" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb525-29"><a href="simulace4.html#cb525-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb525-30"><a href="simulace4.html#cb525-30" tabindex="-1"></a></span>
<span id="cb525-31"><a href="simulace4.html#cb525-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb525-32"><a href="simulace4.html#cb525-32" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb525-33"><a href="simulace4.html#cb525-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb525-34"><a href="simulace4.html#cb525-34" tabindex="-1"></a>  </span>
<span id="cb525-35"><a href="simulace4.html#cb525-35" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb525-36"><a href="simulace4.html#cb525-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb525-37"><a href="simulace4.html#cb525-37" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb525-38"><a href="simulace4.html#cb525-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb525-39"><a href="simulace4.html#cb525-39" tabindex="-1"></a></span>
<span id="cb525-40"><a href="simulace4.html#cb525-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb525-41"><a href="simulace4.html#cb525-41" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb525-42"><a href="simulace4.html#cb525-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb525-43"><a href="simulace4.html#cb525-43" tabindex="-1"></a></span>
<span id="cb525-44"><a href="simulace4.html#cb525-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb525-45"><a href="simulace4.html#cb525-45" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb525-46"><a href="simulace4.html#cb525-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the principal component scores on the training data is therefore 31.43 % for the linear kernel, 31.43 % for the polynomial kernel, and 32.14 % for the Gaussian kernel. On the test data, the error rate is then 23.33 % for the linear kernel, 23.33 % for the polynomial kernel, and 23.33 % for the radial kernel.</p>
<p>To graphically illustrate the method, we can mark the decision boundary on the graph of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did in previous cases when plotting the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb526"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb526-1"><a href="simulace4.html#cb526-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb526-2"><a href="simulace4.html#cb526-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb526-3"><a href="simulace4.html#cb526-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb526-4"><a href="simulace4.html#cb526-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb526-5"><a href="simulace4.html#cb526-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb526-6"><a href="simulace4.html#cb526-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb526-7"><a href="simulace4.html#cb526-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb526-8"><a href="simulace4.html#cb526-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))))</span>
<span id="cb526-9"><a href="simulace4.html#cb526-9" tabindex="-1"></a></span>
<span id="cb526-10"><a href="simulace4.html#cb526-10" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb526-11"><a href="simulace4.html#cb526-11" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb526-12"><a href="simulace4.html#cb526-12" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb526-13"><a href="simulace4.html#cb526-13" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb526-14"><a href="simulace4.html#cb526-14" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb526-15"><a href="simulace4.html#cb526-15" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb526-16"><a href="simulace4.html#cb526-16" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>, </span>
<span id="cb526-17"><a href="simulace4.html#cb526-17" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel type&#39;</span>) <span class="sc">+</span></span>
<span id="cb526-18"><a href="simulace4.html#cb526-18" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb526-19"><a href="simulace4.html#cb526-19" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb526-20"><a href="simulace4.html#cb526-20" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb526-21"><a href="simulace4.html#cb526-21" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb526-22"><a href="simulace4.html#cb526-22" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb526-23"><a href="simulace4.html#cb526-23" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb526-24"><a href="simulace4.html#cb526-24" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb526-25"><a href="simulace4.html#cb526-25" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-86"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-86-1.png" alt="Scores of the first two principal components, color-coded according to classification group membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is highlighted in black." width="672" />
<p class="caption">
Figure 5.10: Scores of the first two principal components, color-coded according to classification group membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is highlighted in black.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb527"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb527-1"><a href="simulace4.html#cb527-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb527-2"><a href="simulace4.html#cb527-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb527-3"><a href="simulace4.html#cb527-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb527-4"><a href="simulace4.html#cb527-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb527-5"><a href="simulace4.html#cb527-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb527-6"><a href="simulace4.html#cb527-6" tabindex="-1"></a></span>
<span id="cb527-7"><a href="simulace4.html#cb527-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVM1der" class="section level5 hasAnchor" number="5.1.3.7.4">
<h5><span class="header-section-number">5.1.3.7.4</span> B-spline Coefficients<a href="simulace4.html#basis-SVM1der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Finally, we will use function representations through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb528"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb528-1"><a href="simulace4.html#cb528-1" tabindex="-1"></a><span class="co"># Building the model</span></span>
<span id="cb528-2"><a href="simulace4.html#cb528-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb528-3"><a href="simulace4.html#cb528-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb528-4"><a href="simulace4.html#cb528-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb528-5"><a href="simulace4.html#cb528-5" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">50</span>,</span>
<span id="cb528-6"><a href="simulace4.html#cb528-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb528-7"><a href="simulace4.html#cb528-7" tabindex="-1"></a></span>
<span id="cb528-8"><a href="simulace4.html#cb528-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb528-9"><a href="simulace4.html#cb528-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb528-10"><a href="simulace4.html#cb528-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb528-11"><a href="simulace4.html#cb528-11" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb528-12"><a href="simulace4.html#cb528-12" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="fl">0.1</span>,</span>
<span id="cb528-13"><a href="simulace4.html#cb528-13" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb528-14"><a href="simulace4.html#cb528-14" tabindex="-1"></a></span>
<span id="cb528-15"><a href="simulace4.html#cb528-15" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb528-16"><a href="simulace4.html#cb528-16" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb528-17"><a href="simulace4.html#cb528-17" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb528-18"><a href="simulace4.html#cb528-18" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb528-19"><a href="simulace4.html#cb528-19" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="fl">0.001</span>,</span>
<span id="cb528-20"><a href="simulace4.html#cb528-20" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb528-21"><a href="simulace4.html#cb528-21" tabindex="-1"></a></span>
<span id="cb528-22"><a href="simulace4.html#cb528-22" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb528-23"><a href="simulace4.html#cb528-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb528-24"><a href="simulace4.html#cb528-24" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb528-25"><a href="simulace4.html#cb528-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb528-26"><a href="simulace4.html#cb528-26" tabindex="-1"></a></span>
<span id="cb528-27"><a href="simulace4.html#cb528-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb528-28"><a href="simulace4.html#cb528-28" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb528-29"><a href="simulace4.html#cb528-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb528-30"><a href="simulace4.html#cb528-30" tabindex="-1"></a></span>
<span id="cb528-31"><a href="simulace4.html#cb528-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb528-32"><a href="simulace4.html#cb528-32" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb528-33"><a href="simulace4.html#cb528-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb528-34"><a href="simulace4.html#cb528-34" tabindex="-1"></a>  </span>
<span id="cb528-35"><a href="simulace4.html#cb528-35" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb528-36"><a href="simulace4.html#cb528-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb528-37"><a href="simulace4.html#cb528-37" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb528-38"><a href="simulace4.html#cb528-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb528-39"><a href="simulace4.html#cb528-39" tabindex="-1"></a></span>
<span id="cb528-40"><a href="simulace4.html#cb528-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb528-41"><a href="simulace4.html#cb528-41" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb528-42"><a href="simulace4.html#cb528-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb528-43"><a href="simulace4.html#cb528-43" tabindex="-1"></a></span>
<span id="cb528-44"><a href="simulace4.html#cb528-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb528-45"><a href="simulace4.html#cb528-45" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb528-46"><a href="simulace4.html#cb528-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the B-spline coefficients on the training data is therefore 7.14 % for the linear kernel, 20 % for the polynomial kernel, and 12.86 % for the Gaussian kernel. On the test data, the error rate of the method is 6.67 % for the linear kernel, 21.67 % for the polynomial kernel, and 20 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb529"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb529-1"><a href="simulace4.html#cb529-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb529-2"><a href="simulace4.html#cb529-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb529-3"><a href="simulace4.html#cb529-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb529-4"><a href="simulace4.html#cb529-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb529-5"><a href="simulace4.html#cb529-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb529-6"><a href="simulace4.html#cb529-6" tabindex="-1"></a></span>
<span id="cb529-7"><a href="simulace4.html#cb529-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVM1der" class="section level5 hasAnchor" number="5.1.3.7.5">
<h5><span class="header-section-number">5.1.3.7.5</span> Projection onto B-spline Basis<a href="simulace4.html#projection-SVM1der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another option for using the classical SVM method for functional data is to project the original data onto some <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal{H}\)</span>, denoted as <span class="math inline">\(V_d\)</span>. Assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>. We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, so we can write:</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Now we can use the coefficients from the orthogonal projection for classification, that is, we apply the standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>. By using this transformation, we have defined a new so-called adapted kernel, which consists of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector method. Thus, we have (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>. This is a dimensionality reduction method, which we can call <em>filtering</em>.</p>
<p>For the projection itself, we will use the <code>project.basis()</code> function from the <code>fda</code> library in <code>R</code>. Its input will be a matrix of the original discrete (non-smoothed) data, the values at which we measure values in the original data matrix, and the basis object onto which we want to project the data. We will choose projection onto a B-spline basis since the use of a Fourier basis is not suitable for our non-periodic data.</p>
<p>We choose the dimension <span class="math inline">\(d\)</span> either from some prior expert knowledge or by using cross-validation. In our case, we will determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (we choose <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method, often <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span>). We require B-splines of order 4, for which the relationship for the number of basis functions holds:</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>. Therefore, the minimum dimension (for <span class="math inline">\(n_{breaks} = 1\)</span>) is chosen as <span class="math inline">\(n_{basis} = 3\)</span>, and the maximum (for <span class="math inline">\(n_{breaks} = 51\)</span>, corresponding to the number of original discrete data points) is <span class="math inline">\(n_{basis} = 53\)</span>. However, in <code>R</code>, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and for large values of <span class="math inline">\(n_{basis}\)</span>, we already experience model overfitting; therefore, we choose a maximum <span class="math inline">\(n_{basis}\)</span> of a smaller number, say 43.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb530"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb530-1"><a href="simulace4.html#cb530-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb530-2"><a href="simulace4.html#cb530-2" tabindex="-1"></a></span>
<span id="cb530-3"><a href="simulace4.html#cb530-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb530-4"><a href="simulace4.html#cb530-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb530-5"><a href="simulace4.html#cb530-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb530-6"><a href="simulace4.html#cb530-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb530-7"><a href="simulace4.html#cb530-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb530-8"><a href="simulace4.html#cb530-8" tabindex="-1"></a></span>
<span id="cb530-9"><a href="simulace4.html#cb530-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># all dimensions we want to try</span></span>
<span id="cb530-10"><a href="simulace4.html#cb530-10" tabindex="-1"></a></span>
<span id="cb530-11"><a href="simulace4.html#cb530-11" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb530-12"><a href="simulace4.html#cb530-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb530-13"><a href="simulace4.html#cb530-13" tabindex="-1"></a></span>
<span id="cb530-14"><a href="simulace4.html#cb530-14" tabindex="-1"></a><span class="co"># List with three components ... matrices for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb530-15"><a href="simulace4.html#cb530-15" tabindex="-1"></a><span class="co"># An empty matrix where we will insert individual results</span></span>
<span id="cb530-16"><a href="simulace4.html#cb530-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for each part of the training set</span></span>
<span id="cb530-17"><a href="simulace4.html#cb530-17" tabindex="-1"></a><span class="co"># Rows will contain values for each dimension value</span></span>
<span id="cb530-18"><a href="simulace4.html#cb530-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb530-19"><a href="simulace4.html#cb530-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb530-20"><a href="simulace4.html#cb530-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb530-21"><a href="simulace4.html#cb530-21" tabindex="-1"></a></span>
<span id="cb530-22"><a href="simulace4.html#cb530-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb530-23"><a href="simulace4.html#cb530-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb530-24"><a href="simulace4.html#cb530-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb530-25"><a href="simulace4.html#cb530-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb530-26"><a href="simulace4.html#cb530-26" tabindex="-1"></a>  </span>
<span id="cb530-27"><a href="simulace4.html#cb530-27" tabindex="-1"></a>  <span class="co"># Projection of discrete data onto the B-spline basis of dimension d</span></span>
<span id="cb530-28"><a href="simulace4.html#cb530-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="co"># matrix of discrete data</span></span>
<span id="cb530-29"><a href="simulace4.html#cb530-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t.seq, <span class="co"># vector of arguments</span></span>
<span id="cb530-30"><a href="simulace4.html#cb530-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb530-31"><a href="simulace4.html#cb530-31" tabindex="-1"></a>  </span>
<span id="cb530-32"><a href="simulace4.html#cb530-32" tabindex="-1"></a>  <span class="co"># Splitting into training and test data within CV</span></span>
<span id="cb530-33"><a href="simulace4.html#cb530-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection) <span class="co"># subset(t(Projection), split == TRUE)</span></span>
<span id="cb530-34"><a href="simulace4.html#cb530-34" tabindex="-1"></a>  </span>
<span id="cb530-35"><a href="simulace4.html#cb530-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb530-36"><a href="simulace4.html#cb530-36" tabindex="-1"></a>    <span class="co"># Definition of test and training parts for CV</span></span>
<span id="cb530-37"><a href="simulace4.html#cb530-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb530-38"><a href="simulace4.html#cb530-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb530-39"><a href="simulace4.html#cb530-39" tabindex="-1"></a>    </span>
<span id="cb530-40"><a href="simulace4.html#cb530-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb530-41"><a href="simulace4.html#cb530-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb530-42"><a href="simulace4.html#cb530-42" tabindex="-1"></a>    </span>
<span id="cb530-43"><a href="simulace4.html#cb530-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb530-44"><a href="simulace4.html#cb530-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb530-45"><a href="simulace4.html#cb530-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb530-46"><a href="simulace4.html#cb530-46" tabindex="-1"></a>  </span>
<span id="cb530-47"><a href="simulace4.html#cb530-47" tabindex="-1"></a>    <span class="co"># Building the models</span></span>
<span id="cb530-48"><a href="simulace4.html#cb530-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb530-49"><a href="simulace4.html#cb530-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb530-50"><a href="simulace4.html#cb530-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb530-51"><a href="simulace4.html#cb530-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb530-52"><a href="simulace4.html#cb530-52" tabindex="-1"></a>    </span>
<span id="cb530-53"><a href="simulace4.html#cb530-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb530-54"><a href="simulace4.html#cb530-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb530-55"><a href="simulace4.html#cb530-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb530-56"><a href="simulace4.html#cb530-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb530-57"><a href="simulace4.html#cb530-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb530-58"><a href="simulace4.html#cb530-58" tabindex="-1"></a>    </span>
<span id="cb530-59"><a href="simulace4.html#cb530-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb530-60"><a href="simulace4.html#cb530-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb530-61"><a href="simulace4.html#cb530-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb530-62"><a href="simulace4.html#cb530-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb530-63"><a href="simulace4.html#cb530-63" tabindex="-1"></a>      </span>
<span id="cb530-64"><a href="simulace4.html#cb530-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb530-65"><a href="simulace4.html#cb530-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb530-66"><a href="simulace4.html#cb530-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb530-67"><a href="simulace4.html#cb530-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb530-68"><a href="simulace4.html#cb530-68" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb530-69"><a href="simulace4.html#cb530-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb530-70"><a href="simulace4.html#cb530-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb530-71"><a href="simulace4.html#cb530-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb530-72"><a href="simulace4.html#cb530-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb530-73"><a href="simulace4.html#cb530-73" tabindex="-1"></a>    accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb530-74"><a href="simulace4.html#cb530-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb530-75"><a href="simulace4.html#cb530-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb530-76"><a href="simulace4.html#cb530-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb530-77"><a href="simulace4.html#cb530-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb530-78"><a href="simulace4.html#cb530-78" tabindex="-1"></a>    accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb530-79"><a href="simulace4.html#cb530-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb530-80"><a href="simulace4.html#cb530-80" tabindex="-1"></a>    </span>
<span id="cb530-81"><a href="simulace4.html#cb530-81" tabindex="-1"></a>    <span class="co"># Insert accuracies into positions for given d and fold</span></span>
<span id="cb530-82"><a href="simulace4.html#cb530-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb530-83"><a href="simulace4.html#cb530-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb530-84"><a href="simulace4.html#cb530-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb530-85"><a href="simulace4.html#cb530-85" tabindex="-1"></a>  }</span>
<span id="cb530-86"><a href="simulace4.html#cb530-86" tabindex="-1"></a>}</span>
<span id="cb530-87"><a href="simulace4.html#cb530-87" tabindex="-1"></a>  </span>
<span id="cb530-88"><a href="simulace4.html#cb530-88" tabindex="-1"></a><span class="co"># Compute average accuracies for individual d across folds</span></span>
<span id="cb530-89"><a href="simulace4.html#cb530-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb530-90"><a href="simulace4.html#cb530-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb530-91"><a href="simulace4.html#cb530-91" tabindex="-1"></a>}</span>
<span id="cb530-92"><a href="simulace4.html#cb530-92" tabindex="-1"></a></span>
<span id="cb530-93"><a href="simulace4.html#cb530-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb530-94"><a href="simulace4.html#cb530-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb530-95"><a href="simulace4.html#cb530-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb530-96"><a href="simulace4.html#cb530-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb530-97"><a href="simulace4.html#cb530-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb530-98"><a href="simulace4.html#cb530-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb530-99"><a href="simulace4.html#cb530-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb530-100"><a href="simulace4.html#cb530-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt       ERR
## linear    11 0.1890476
## poly      13 0.1869963
## radial     7 0.2012821</code></pre>
<p>We see that the best value for the parameter <span class="math inline">\(d\)</span> is 11 for the linear kernel, with an error rate calculated using 10-fold CV of 0.189, 13 for the polynomial kernel with an error rate of 0.187, and 7 for the radial kernel with an error rate of 0.2013.</p>
<p>To clarify, let’s plot the validation error rates as a function of the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb532"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb532-1"><a href="simulace4.html#cb532-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb532-2"><a href="simulace4.html#cb532-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb532-3"><a href="simulace4.html#cb532-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb532-4"><a href="simulace4.html#cb532-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb532-5"><a href="simulace4.html#cb532-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb532-6"><a href="simulace4.html#cb532-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb532-7"><a href="simulace4.html#cb532-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb532-8"><a href="simulace4.html#cb532-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb532-9"><a href="simulace4.html#cb532-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb532-10"><a href="simulace4.html#cb532-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb532-11"><a href="simulace4.html#cb532-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb532-12"><a href="simulace4.html#cb532-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb532-13"><a href="simulace4.html#cb532-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb532-14"><a href="simulace4.html#cb532-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb532-15"><a href="simulace4.html#cb532-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb532-16"><a href="simulace4.html#cb532-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb532-17"><a href="simulace4.html#cb532-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-91-1.png" alt="Dependency of validation error rate on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The optimal values of the dimension $V_d$ for each kernel function are marked with black points." width="672" />
<p class="caption">
Figure 1.23: Dependency of validation error rate on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The optimal values of the dimension <span class="math inline">\(V_d\)</span> for each kernel function are marked with black points.
</p>
</div>
<p>Now we can train the individual classifiers on all training data and examine their performance on the test data. For each kernel function, we choose the dimension of the subspace to project onto according to the results of cross-validation.</p>
<p>The variable <code>Projection</code> stores the matrix of coefficients from the orthogonal projection, that is,</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb533"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb533-1"><a href="simulace4.html#cb533-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb533-2"><a href="simulace4.html#cb533-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb533-3"><a href="simulace4.html#cb533-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb533-4"><a href="simulace4.html#cb533-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb533-5"><a href="simulace4.html#cb533-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb533-6"><a href="simulace4.html#cb533-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb533-7"><a href="simulace4.html#cb533-7" tabindex="-1"></a></span>
<span id="cb533-8"><a href="simulace4.html#cb533-8" tabindex="-1"></a><span class="co"># Loop through each kernel</span></span>
<span id="cb533-9"><a href="simulace4.html#cb533-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb533-10"><a href="simulace4.html#cb533-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb533-11"><a href="simulace4.html#cb533-11" tabindex="-1"></a>  <span class="co"># Base object</span></span>
<span id="cb533-12"><a href="simulace4.html#cb533-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb533-13"><a href="simulace4.html#cb533-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb533-14"><a href="simulace4.html#cb533-14" tabindex="-1"></a>  </span>
<span id="cb533-15"><a href="simulace4.html#cb533-15" tabindex="-1"></a>  <span class="co"># Project discrete data onto B-spline basis</span></span>
<span id="cb533-16"><a href="simulace4.html#cb533-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> <span class="fu">rbind</span>(</span>
<span id="cb533-17"><a href="simulace4.html#cb533-17" tabindex="-1"></a>    grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)),</span>
<span id="cb533-18"><a href="simulace4.html#cb533-18" tabindex="-1"></a>    grid.data.test <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb533-19"><a href="simulace4.html#cb533-19" tabindex="-1"></a>      <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="co"># Matrix of discrete data</span></span>
<span id="cb533-20"><a href="simulace4.html#cb533-20" tabindex="-1"></a>                              <span class="at">argvals =</span> t.seq, <span class="co"># Vector of arguments</span></span>
<span id="cb533-21"><a href="simulace4.html#cb533-21" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># Basis object</span></span>
<span id="cb533-22"><a href="simulace4.html#cb533-22" tabindex="-1"></a>  </span>
<span id="cb533-23"><a href="simulace4.html#cb533-23" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb533-24"><a href="simulace4.html#cb533-24" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), ]</span>
<span id="cb533-25"><a href="simulace4.html#cb533-25" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[(<span class="fu">sum</span>(split) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(split), ]</span>
<span id="cb533-26"><a href="simulace4.html#cb533-26" tabindex="-1"></a>  </span>
<span id="cb533-27"><a href="simulace4.html#cb533-27" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb533-28"><a href="simulace4.html#cb533-28" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb533-29"><a href="simulace4.html#cb533-29" tabindex="-1"></a>  </span>
<span id="cb533-30"><a href="simulace4.html#cb533-30" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb533-31"><a href="simulace4.html#cb533-31" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb533-32"><a href="simulace4.html#cb533-32" tabindex="-1"></a>  </span>
<span id="cb533-33"><a href="simulace4.html#cb533-33" tabindex="-1"></a>  <span class="co"># Construct the model</span></span>
<span id="cb533-34"><a href="simulace4.html#cb533-34" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb533-35"><a href="simulace4.html#cb533-35" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb533-36"><a href="simulace4.html#cb533-36" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb533-37"><a href="simulace4.html#cb533-37" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb533-38"><a href="simulace4.html#cb533-38" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb533-39"><a href="simulace4.html#cb533-39" tabindex="-1"></a>  </span>
<span id="cb533-40"><a href="simulace4.html#cb533-40" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb533-41"><a href="simulace4.html#cb533-41" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb533-42"><a href="simulace4.html#cb533-42" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb533-43"><a href="simulace4.html#cb533-43" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb533-44"><a href="simulace4.html#cb533-44" tabindex="-1"></a>    </span>
<span id="cb533-45"><a href="simulace4.html#cb533-45" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb533-46"><a href="simulace4.html#cb533-46" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb533-47"><a href="simulace4.html#cb533-47" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb533-48"><a href="simulace4.html#cb533-48" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb533-49"><a href="simulace4.html#cb533-49" tabindex="-1"></a>  </span>
<span id="cb533-50"><a href="simulace4.html#cb533-50" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb533-51"><a href="simulace4.html#cb533-51" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb533-52"><a href="simulace4.html#cb533-52" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is therefore 12.14 % for the linear kernel, 12.86 % for the polynomial kernel, and 13.57 % for the Gaussian kernel. On the test data, the error rates are 20 % for the linear kernel, 25 % for the polynomial kernel, and 28.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb534"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb534-1"><a href="simulace4.html#cb534-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVM1der" class="section level5 hasAnchor" number="5.1.3.7.6">
<h5><span class="header-section-number">5.1.3.7.6</span> RKHS + SVM<a href="simulace4.html#RKHS-SVM1der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this section, we will explore another way to utilize support vector machines (SVM) for classifying functional data. Here, we will again rely on the familiar principle of first expressing functional data as finite-dimensional objects and then applying the traditional SVM method to these objects.</p>
<p>However, this time we will use the SVM method for the representation of functional data itself via a certain finite-dimensional object. As the name suggests, this involves a combination of two concepts: the support vector machine method and a space referred to in English literature as <em>Reproducing Kernel Hilbert Space</em> (RKHS). A key concept in this space is the <em>kernel</em>.</p>
<div id="implementation-of-the-method-in-r-1" class="section level6 hasAnchor" number="5.1.3.7.6.1">
<h6><span class="header-section-number">5.1.3.7.6.1</span> Implementation of the Method in <code>R</code><a href="simulace4.html#implementation-of-the-method-in-r-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>From the last part of Theorem <a href="simulace3.html#thm:MaG">1.3</a>, we can see how to compute the representations of curves in practice. We will work with discretized data after smoothing the curves. First, let’s define a kernel for the RKHS space. We will use the Gaussian kernel with a parameter <span class="math inline">\(\gamma\)</span>. The value of this hyperparameter significantly affects the behavior and success of the method, so we must pay special attention to its choice (we select it using cross-validation).</p>
</div>
<div id="gaussian-kernel-3" class="section level6 hasAnchor" number="5.1.3.7.6.2">
<h6><span class="header-section-number">5.1.3.7.6.2</span> Gaussian Kernel<a href="simulace4.html#gaussian-kernel-3" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb535"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb535-1"><a href="simulace4.html#cb535-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb535-2"><a href="simulace4.html#cb535-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb535-3"><a href="simulace4.html#cb535-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb535-4"><a href="simulace4.html#cb535-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb535-5"><a href="simulace4.html#cb535-5" tabindex="-1"></a></span>
<span id="cb535-6"><a href="simulace4.html#cb535-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb535-7"><a href="simulace4.html#cb535-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb535-8"><a href="simulace4.html#cb535-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb535-9"><a href="simulace4.html#cb535-9" tabindex="-1"></a>}</span>
<span id="cb535-10"><a href="simulace4.html#cb535-10" tabindex="-1"></a></span>
<span id="cb535-11"><a href="simulace4.html#cb535-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb535-12"><a href="simulace4.html#cb535-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb535-13"><a href="simulace4.html#cb535-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb535-14"><a href="simulace4.html#cb535-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb535-15"><a href="simulace4.html#cb535-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb535-16"><a href="simulace4.html#cb535-16" tabindex="-1"></a>    }</span>
<span id="cb535-17"><a href="simulace4.html#cb535-17" tabindex="-1"></a>  }</span>
<span id="cb535-18"><a href="simulace4.html#cb535-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb535-19"><a href="simulace4.html#cb535-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s compute the matrix <span class="math inline">\(K_S\)</span> along with its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb536"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb536-1"><a href="simulace4.html#cb536-1" tabindex="-1"></a><span class="co"># Compute the matrix K</span></span>
<span id="cb536-2"><a href="simulace4.html#cb536-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Fixed value for gamma; optimal will be determined using CV</span></span>
<span id="cb536-3"><a href="simulace4.html#cb536-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb536-4"><a href="simulace4.html#cb536-4" tabindex="-1"></a></span>
<span id="cb536-5"><a href="simulace4.html#cb536-5" tabindex="-1"></a><span class="co"># Determine eigenvalues and vectors</span></span>
<span id="cb536-6"><a href="simulace4.html#cb536-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb536-7"><a href="simulace4.html#cb536-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb536-8"><a href="simulace4.html#cb536-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To compute the coefficients in the representation of the curves, that is, to calculate the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we also need the coefficients from SVM. Unlike the classification problem, we are now solving a regression problem, as we are trying to express our observed curves in some basis chosen by the kernel <span class="math inline">\(K\)</span>. Therefore, we will use the <em>Support Vector Regression</em> method, from which we will obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb537"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb537-1"><a href="simulace4.html#cb537-1" tabindex="-1"></a><span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb537-2"><a href="simulace4.html#cb537-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb537-3"><a href="simulace4.html#cb537-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb537-4"><a href="simulace4.html#cb537-4" tabindex="-1"></a></span>
<span id="cb537-5"><a href="simulace4.html#cb537-5" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb537-6"><a href="simulace4.html#cb537-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb537-7"><a href="simulace4.html#cb537-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb537-8"><a href="simulace4.html#cb537-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb537-9"><a href="simulace4.html#cb537-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb537-10"><a href="simulace4.html#cb537-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb537-11"><a href="simulace4.html#cb537-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb537-12"><a href="simulace4.html#cb537-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb537-13"><a href="simulace4.html#cb537-13" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb537-14"><a href="simulace4.html#cb537-14" tabindex="-1"></a>  <span class="co"># Determine alpha</span></span>
<span id="cb537-15"><a href="simulace4.html#cb537-15" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb537-16"><a href="simulace4.html#cb537-16" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can compute the representations of the individual curves. First, let’s choose <span class="math inline">\(\hat d\)</span> to be the entire dimension, that is, <span class="math inline">\(\hat d = m ={}\)</span> 101, and then determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb538"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb538-1"><a href="simulace4.html#cb538-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb538-2"><a href="simulace4.html#cb538-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb538-3"><a href="simulace4.html#cb538-3" tabindex="-1"></a></span>
<span id="cb538-4"><a href="simulace4.html#cb538-4" tabindex="-1"></a><span class="co"># Determine the vector lambda</span></span>
<span id="cb538-5"><a href="simulace4.html#cb538-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb538-6"><a href="simulace4.html#cb538-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb538-7"><a href="simulace4.html#cb538-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># Create an empty object</span></span>
<span id="cb538-8"><a href="simulace4.html#cb538-8" tabindex="-1"></a></span>
<span id="cb538-9"><a href="simulace4.html#cb538-9" tabindex="-1"></a><span class="co"># Compute the representation</span></span>
<span id="cb538-10"><a href="simulace4.html#cb538-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb538-11"><a href="simulace4.html#cb538-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb538-12"><a href="simulace4.html#cb538-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have stored the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> for each curve in the <code>Lambda.RKHS</code> matrix. We will use these vectors as representations of the given curves and classify the data based on this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb539"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb539-1"><a href="simulace4.html#cb539-1" tabindex="-1"></a><span class="co"># Split into training and testing data</span></span>
<span id="cb539-2"><a href="simulace4.html#cb539-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb539-3"><a href="simulace4.html#cb539-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb539-4"><a href="simulace4.html#cb539-4" tabindex="-1"></a></span>
<span id="cb539-5"><a href="simulace4.html#cb539-5" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb539-6"><a href="simulace4.html#cb539-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb539-7"><a href="simulace4.html#cb539-7" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb539-8"><a href="simulace4.html#cb539-8" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb539-9"><a href="simulace4.html#cb539-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb539-10"><a href="simulace4.html#cb539-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb539-11"><a href="simulace4.html#cb539-11" tabindex="-1"></a></span>
<span id="cb539-12"><a href="simulace4.html#cb539-12" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb539-13"><a href="simulace4.html#cb539-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb539-14"><a href="simulace4.html#cb539-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb539-15"><a href="simulace4.html#cb539-15" tabindex="-1"></a></span>
<span id="cb539-16"><a href="simulace4.html#cb539-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb539-17"><a href="simulace4.html#cb539-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb539-18"><a href="simulace4.html#cb539-18" tabindex="-1"></a>  </span>
<span id="cb539-19"><a href="simulace4.html#cb539-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb539-20"><a href="simulace4.html#cb539-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb539-21"><a href="simulace4.html#cb539-21" tabindex="-1"></a>  </span>
<span id="cb539-22"><a href="simulace4.html#cb539-22" tabindex="-1"></a>  <span class="co"># Construct the models</span></span>
<span id="cb539-23"><a href="simulace4.html#cb539-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb539-24"><a href="simulace4.html#cb539-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb539-25"><a href="simulace4.html#cb539-25" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb539-26"><a href="simulace4.html#cb539-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb539-27"><a href="simulace4.html#cb539-27" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb539-28"><a href="simulace4.html#cb539-28" tabindex="-1"></a>  </span>
<span id="cb539-29"><a href="simulace4.html#cb539-29" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb539-30"><a href="simulace4.html#cb539-30" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb539-31"><a href="simulace4.html#cb539-31" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb539-32"><a href="simulace4.html#cb539-32" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb539-33"><a href="simulace4.html#cb539-33" tabindex="-1"></a>    </span>
<span id="cb539-34"><a href="simulace4.html#cb539-34" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb539-35"><a href="simulace4.html#cb539-35" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb539-36"><a href="simulace4.html#cb539-36" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb539-37"><a href="simulace4.html#cb539-37" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb539-38"><a href="simulace4.html#cb539-38" tabindex="-1"></a>  </span>
<span id="cb539-39"><a href="simulace4.html#cb539-39" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb539-40"><a href="simulace4.html#cb539-40" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb539-41"><a href="simulace4.html#cb539-41" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-99">Table 5.1: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.0000</td>
<td align="center">0.4833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0000</td>
<td align="center">0.4167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0214</td>
<td align="center">0.3000</td>
</tr>
</tbody>
</table>
<p>We observe that the model performs very well on the training data for all three kernels, while its success on the testing data is not good at all. It is evident that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb540"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb540-1"><a href="simulace4.html#cb540-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb540-2"><a href="simulace4.html#cb540-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb540-3"><a href="simulace4.html#cb540-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb540-4"><a href="simulace4.html#cb540-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb540-5"><a href="simulace4.html#cb540-5" tabindex="-1"></a></span>
<span id="cb540-6"><a href="simulace4.html#cb540-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb540-7"><a href="simulace4.html#cb540-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of values for d</span></span>
<span id="cb540-8"><a href="simulace4.html#cb540-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb540-9"><a href="simulace4.html#cb540-9" tabindex="-1"></a></span>
<span id="cb540-10"><a href="simulace4.html#cb540-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb540-11"><a href="simulace4.html#cb540-11" tabindex="-1"></a><span class="co"># Empty matrix where we will store individual results</span></span>
<span id="cb540-12"><a href="simulace4.html#cb540-12" tabindex="-1"></a><span class="co"># Columns will represent accuracy values for given gamma, and rows will correspond to folds</span></span>
<span id="cb540-13"><a href="simulace4.html#cb540-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb540-14"><a href="simulace4.html#cb540-14" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb540-15"><a href="simulace4.html#cb540-15" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb540-16"><a href="simulace4.html#cb540-16" tabindex="-1"></a></span>
<span id="cb540-17"><a href="simulace4.html#cb540-17" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb540-18"><a href="simulace4.html#cb540-18" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb540-19"><a href="simulace4.html#cb540-19" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb540-20"><a href="simulace4.html#cb540-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb540-21"><a href="simulace4.html#cb540-21" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb540-22"><a href="simulace4.html#cb540-22" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb540-23"><a href="simulace4.html#cb540-23" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb541"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb541-1"><a href="simulace4.html#cb541-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb541-2"><a href="simulace4.html#cb541-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb541-3"><a href="simulace4.html#cb541-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb541-4"><a href="simulace4.html#cb541-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb541-5"><a href="simulace4.html#cb541-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb541-6"><a href="simulace4.html#cb541-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb541-7"><a href="simulace4.html#cb541-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb541-8"><a href="simulace4.html#cb541-8" tabindex="-1"></a>  </span>
<span id="cb541-9"><a href="simulace4.html#cb541-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb541-10"><a href="simulace4.html#cb541-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb541-11"><a href="simulace4.html#cb541-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb541-12"><a href="simulace4.html#cb541-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb541-13"><a href="simulace4.html#cb541-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb541-14"><a href="simulace4.html#cb541-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb541-15"><a href="simulace4.html#cb541-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb541-16"><a href="simulace4.html#cb541-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb541-17"><a href="simulace4.html#cb541-17" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb541-18"><a href="simulace4.html#cb541-18" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb541-19"><a href="simulace4.html#cb541-19" tabindex="-1"></a>  }</span>
<span id="cb541-20"><a href="simulace4.html#cb541-20" tabindex="-1"></a>  </span>
<span id="cb541-21"><a href="simulace4.html#cb541-21" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb541-22"><a href="simulace4.html#cb541-22" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb541-23"><a href="simulace4.html#cb541-23" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb541-24"><a href="simulace4.html#cb541-24" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb541-25"><a href="simulace4.html#cb541-25" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb541-26"><a href="simulace4.html#cb541-26" tabindex="-1"></a>    <span class="co"># Calculate representation</span></span>
<span id="cb541-27"><a href="simulace4.html#cb541-27" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb541-28"><a href="simulace4.html#cb541-28" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb541-29"><a href="simulace4.html#cb541-29" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb541-30"><a href="simulace4.html#cb541-30" tabindex="-1"></a>    }</span>
<span id="cb541-31"><a href="simulace4.html#cb541-31" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb541-32"><a href="simulace4.html#cb541-32" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb541-33"><a href="simulace4.html#cb541-33" tabindex="-1"></a>      <span class="co"># Define test and training portions for CV</span></span>
<span id="cb541-34"><a href="simulace4.html#cb541-34" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb541-35"><a href="simulace4.html#cb541-35" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb541-36"><a href="simulace4.html#cb541-36" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb541-37"><a href="simulace4.html#cb541-37" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb541-38"><a href="simulace4.html#cb541-38" tabindex="-1"></a>      <span class="co"># Prepare a data frame to store results</span></span>
<span id="cb541-39"><a href="simulace4.html#cb541-39" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb541-40"><a href="simulace4.html#cb541-40" tabindex="-1"></a>                                   <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb541-41"><a href="simulace4.html#cb541-41" tabindex="-1"></a>                                   <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb541-42"><a href="simulace4.html#cb541-42" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb541-43"><a href="simulace4.html#cb541-43" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb541-44"><a href="simulace4.html#cb541-44" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb541-45"><a href="simulace4.html#cb541-45" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb541-46"><a href="simulace4.html#cb541-46" tabindex="-1"></a>      </span>
<span id="cb541-47"><a href="simulace4.html#cb541-47" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb541-48"><a href="simulace4.html#cb541-48" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb541-49"><a href="simulace4.html#cb541-49" tabindex="-1"></a>        </span>
<span id="cb541-50"><a href="simulace4.html#cb541-50" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb541-51"><a href="simulace4.html#cb541-51" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb541-52"><a href="simulace4.html#cb541-52" tabindex="-1"></a>        </span>
<span id="cb541-53"><a href="simulace4.html#cb541-53" tabindex="-1"></a>        <span class="co"># Construct the models</span></span>
<span id="cb541-54"><a href="simulace4.html#cb541-54" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb541-55"><a href="simulace4.html#cb541-55" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb541-56"><a href="simulace4.html#cb541-56" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb541-57"><a href="simulace4.html#cb541-57" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb541-58"><a href="simulace4.html#cb541-58" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb541-59"><a href="simulace4.html#cb541-59" tabindex="-1"></a>        </span>
<span id="cb541-60"><a href="simulace4.html#cb541-60" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb541-61"><a href="simulace4.html#cb541-61" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb541-62"><a href="simulace4.html#cb541-62" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb541-63"><a href="simulace4.html#cb541-63" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb541-64"><a href="simulace4.html#cb541-64" tabindex="-1"></a>        </span>
<span id="cb541-65"><a href="simulace4.html#cb541-65" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb541-66"><a href="simulace4.html#cb541-66" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb541-67"><a href="simulace4.html#cb541-67" tabindex="-1"></a>      }</span>
<span id="cb541-68"><a href="simulace4.html#cb541-68" tabindex="-1"></a>      <span class="co"># Store accuracies for the respective d, gamma, and fold</span></span>
<span id="cb541-69"><a href="simulace4.html#cb541-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb541-70"><a href="simulace4.html#cb541-70" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb541-71"><a href="simulace4.html#cb541-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb541-72"><a href="simulace4.html#cb541-72" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb541-73"><a href="simulace4.html#cb541-73" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb541-74"><a href="simulace4.html#cb541-74" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb541-75"><a href="simulace4.html#cb541-75" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb541-76"><a href="simulace4.html#cb541-76" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb541-77"><a href="simulace4.html#cb541-77" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb541-78"><a href="simulace4.html#cb541-78" tabindex="-1"></a>    }</span>
<span id="cb541-79"><a href="simulace4.html#cb541-79" tabindex="-1"></a>  }</span>
<span id="cb541-80"><a href="simulace4.html#cb541-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb542"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb542-1"><a href="simulace4.html#cb542-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb542-2"><a href="simulace4.html#cb542-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb542-3"><a href="simulace4.html#cb542-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb542-4"><a href="simulace4.html#cb542-4" tabindex="-1"></a>}</span>
<span id="cb542-5"><a href="simulace4.html#cb542-5" tabindex="-1"></a></span>
<span id="cb542-6"><a href="simulace4.html#cb542-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb542-7"><a href="simulace4.html#cb542-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb542-8"><a href="simulace4.html#cb542-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb542-9"><a href="simulace4.html#cb542-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb542-10"><a href="simulace4.html#cb542-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb542-11"><a href="simulace4.html#cb542-11" tabindex="-1"></a></span>
<span id="cb542-12"><a href="simulace4.html#cb542-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb542-13"><a href="simulace4.html#cb542-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb542-14"><a href="simulace4.html#cb542-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb542-15"><a href="simulace4.html#cb542-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb542-16"><a href="simulace4.html#cb542-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb542-17"><a href="simulace4.html#cb542-17" tabindex="-1"></a></span>
<span id="cb542-18"><a href="simulace4.html#cb542-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb542-19"><a href="simulace4.html#cb542-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb542-20"><a href="simulace4.html#cb542-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb542-21"><a href="simulace4.html#cb542-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb542-22"><a href="simulace4.html#cb542-22" tabindex="-1"></a>                          <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb542-23"><a href="simulace4.html#cb542-23" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-102">Table 5.2: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">34</td>
<td align="right">1000.0000</td>
<td align="right">0.1271</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">37</td>
<td align="right">1000.0000</td>
<td align="right">0.1863</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">10</td>
<td align="right">0.2683</td>
<td align="right">0.1785</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best parameter value is <span class="math inline">\(d={}\)</span> 34 and <span class="math inline">\(\gamma={}\)</span> 1000 for the linear kernel with an error value calculated using 10-fold CV of 0.1271, <span class="math inline">\(d={}\)</span> 37 and <span class="math inline">\(\gamma={}\)</span> 1000 for the polynomial kernel with an error value calculated using 10-fold CV of 0.1863 and <span class="math inline">\(d={}\)</span> 10 and <span class="math inline">\(\gamma={}\)</span> 0.2683 for the radial kernel with an error value of 0.1785.
For curiosity, let’s also plot the validation error function depending on the dimension <span class="math inline">\(d\)</span> and the hyperparameter value <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb543"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb543-1"><a href="simulace4.html#cb543-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb543-2"><a href="simulace4.html#cb543-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb543-3"><a href="simulace4.html#cb543-3" tabindex="-1"></a>                              <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb543-4"><a href="simulace4.html#cb543-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb543-5"><a href="simulace4.html#cb543-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb543-6"><a href="simulace4.html#cb543-6" tabindex="-1"></a>                              <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb543-7"><a href="simulace4.html#cb543-7" tabindex="-1"></a>                                           <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb543-8"><a href="simulace4.html#cb543-8" tabindex="-1"></a>                                             <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb543-9"><a href="simulace4.html#cb543-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb543-10"><a href="simulace4.html#cb543-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb543-11"><a href="simulace4.html#cb543-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb543-12"><a href="simulace4.html#cb543-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb543-13"><a href="simulace4.html#cb543-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb543-14"><a href="simulace4.html#cb543-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb543-15"><a href="simulace4.html#cb543-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb543-16"><a href="simulace4.html#cb543-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb543-17"><a href="simulace4.html#cb543-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb543-18"><a href="simulace4.html#cb543-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb543-19"><a href="simulace4.html#cb543-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-103"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-103-1.png" alt="Dependency of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 5.11: Dependency of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>Since we have already found the optimal values for the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb544"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb544-1"><a href="simulace4.html#cb544-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb544-2"><a href="simulace4.html#cb544-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb544-3"><a href="simulace4.html#cb544-3" tabindex="-1"></a><span class="co"># Add the test data</span></span>
<span id="cb544-4"><a href="simulace4.html#cb544-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb545"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb545-1"><a href="simulace4.html#cb545-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb545-2"><a href="simulace4.html#cb545-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb545-3"><a href="simulace4.html#cb545-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb545-4"><a href="simulace4.html#cb545-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb545-5"><a href="simulace4.html#cb545-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb545-6"><a href="simulace4.html#cb545-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb545-7"><a href="simulace4.html#cb545-7" tabindex="-1"></a></span>
<span id="cb545-8"><a href="simulace4.html#cb545-8" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb545-9"><a href="simulace4.html#cb545-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb545-10"><a href="simulace4.html#cb545-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb545-11"><a href="simulace4.html#cb545-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># Gamma value from CV</span></span>
<span id="cb545-12"><a href="simulace4.html#cb545-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb545-13"><a href="simulace4.html#cb545-13" tabindex="-1"></a>  </span>
<span id="cb545-14"><a href="simulace4.html#cb545-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb545-15"><a href="simulace4.html#cb545-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb545-16"><a href="simulace4.html#cb545-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb545-17"><a href="simulace4.html#cb545-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb545-18"><a href="simulace4.html#cb545-18" tabindex="-1"></a>  </span>
<span id="cb545-19"><a href="simulace4.html#cb545-19" tabindex="-1"></a>  <span class="co"># Determine the alpha coefficients from SVM</span></span>
<span id="cb545-20"><a href="simulace4.html#cb545-20" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb545-21"><a href="simulace4.html#cb545-21" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb545-22"><a href="simulace4.html#cb545-22" tabindex="-1"></a>  </span>
<span id="cb545-23"><a href="simulace4.html#cb545-23" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb545-24"><a href="simulace4.html#cb545-24" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb545-25"><a href="simulace4.html#cb545-25" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb545-26"><a href="simulace4.html#cb545-26" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb545-27"><a href="simulace4.html#cb545-27" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb545-28"><a href="simulace4.html#cb545-28" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb545-29"><a href="simulace4.html#cb545-29" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb545-30"><a href="simulace4.html#cb545-30" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb545-31"><a href="simulace4.html#cb545-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb545-32"><a href="simulace4.html#cb545-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb545-33"><a href="simulace4.html#cb545-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb545-34"><a href="simulace4.html#cb545-34" tabindex="-1"></a>  }</span>
<span id="cb545-35"><a href="simulace4.html#cb545-35" tabindex="-1"></a>  </span>
<span id="cb545-36"><a href="simulace4.html#cb545-36" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb545-37"><a href="simulace4.html#cb545-37" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb545-38"><a href="simulace4.html#cb545-38" tabindex="-1"></a>  </span>
<span id="cb545-39"><a href="simulace4.html#cb545-39" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb545-40"><a href="simulace4.html#cb545-40" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb545-41"><a href="simulace4.html#cb545-41" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb545-42"><a href="simulace4.html#cb545-42" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># Create empty object</span></span>
<span id="cb545-43"><a href="simulace4.html#cb545-43" tabindex="-1"></a>  </span>
<span id="cb545-44"><a href="simulace4.html#cb545-44" tabindex="-1"></a>  <span class="co"># Compute representation</span></span>
<span id="cb545-45"><a href="simulace4.html#cb545-45" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb545-46"><a href="simulace4.html#cb545-46" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb545-47"><a href="simulace4.html#cb545-47" tabindex="-1"></a>  }</span>
<span id="cb545-48"><a href="simulace4.html#cb545-48" tabindex="-1"></a>  </span>
<span id="cb545-49"><a href="simulace4.html#cb545-49" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb545-50"><a href="simulace4.html#cb545-50" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb545-51"><a href="simulace4.html#cb545-51" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb545-52"><a href="simulace4.html#cb545-52" tabindex="-1"></a></span>
<span id="cb545-53"><a href="simulace4.html#cb545-53" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb545-54"><a href="simulace4.html#cb545-54" tabindex="-1"></a></span>
<span id="cb545-55"><a href="simulace4.html#cb545-55" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb545-56"><a href="simulace4.html#cb545-56" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb545-57"><a href="simulace4.html#cb545-57" tabindex="-1"></a>  </span>
<span id="cb545-58"><a href="simulace4.html#cb545-58" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb545-59"><a href="simulace4.html#cb545-59" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb545-60"><a href="simulace4.html#cb545-60" tabindex="-1"></a>  </span>
<span id="cb545-61"><a href="simulace4.html#cb545-61" tabindex="-1"></a>  <span class="co"># Construct models</span></span>
<span id="cb545-62"><a href="simulace4.html#cb545-62" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb545-63"><a href="simulace4.html#cb545-63" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb545-64"><a href="simulace4.html#cb545-64" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb545-65"><a href="simulace4.html#cb545-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb545-66"><a href="simulace4.html#cb545-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb545-67"><a href="simulace4.html#cb545-67" tabindex="-1"></a>  </span>
<span id="cb545-68"><a href="simulace4.html#cb545-68" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb545-69"><a href="simulace4.html#cb545-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb545-70"><a href="simulace4.html#cb545-70" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb545-71"><a href="simulace4.html#cb545-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb545-72"><a href="simulace4.html#cb545-72" tabindex="-1"></a>    </span>
<span id="cb545-73"><a href="simulace4.html#cb545-73" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb545-74"><a href="simulace4.html#cb545-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb545-75"><a href="simulace4.html#cb545-75" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb545-76"><a href="simulace4.html#cb545-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb545-77"><a href="simulace4.html#cb545-77" tabindex="-1"></a>  </span>
<span id="cb545-78"><a href="simulace4.html#cb545-78" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb545-79"><a href="simulace4.html#cb545-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb545-80"><a href="simulace4.html#cb545-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-106">Table 1.1: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.1071</td>
<td align="center">0.2833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.1429</td>
<td align="center">0.2667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.1357</td>
<td align="center">0.3167</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with the projection on the Reproducing Kernel Hilbert Space is thus equal to 10.71 % for the linear kernel, 14.29 % for the polynomial kernel, and 13.57 % for the Gaussian kernel on the training data. On the testing data, the error rate of the method is 28.33 % for the linear kernel, 26.67 % for the polynomial kernel, and 31.67 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb546"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb546-1"><a href="simulace4.html#cb546-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomial-kernel-1" class="section level6 hasAnchor" number="5.1.3.7.6.3">
<h6><span class="header-section-number">5.1.3.7.6.3</span> Polynomial Kernel<a href="simulace4.html#polynomial-kernel-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb547"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb547-1"><a href="simulace4.html#cb547-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb547-2"><a href="simulace4.html#cb547-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb547-3"><a href="simulace4.html#cb547-3" tabindex="-1"></a><span class="co"># Include test data as well</span></span>
<span id="cb547-4"><a href="simulace4.html#cb547-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb547-5"><a href="simulace4.html#cb547-5" tabindex="-1"></a></span>
<span id="cb547-6"><a href="simulace4.html#cb547-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb547-7"><a href="simulace4.html#cb547-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb547-8"><a href="simulace4.html#cb547-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb547-9"><a href="simulace4.html#cb547-9" tabindex="-1"></a>}</span>
<span id="cb547-10"><a href="simulace4.html#cb547-10" tabindex="-1"></a></span>
<span id="cb547-11"><a href="simulace4.html#cb547-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb547-12"><a href="simulace4.html#cb547-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb547-13"><a href="simulace4.html#cb547-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb547-14"><a href="simulace4.html#cb547-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb547-15"><a href="simulace4.html#cb547-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb547-16"><a href="simulace4.html#cb547-16" tabindex="-1"></a>    }</span>
<span id="cb547-17"><a href="simulace4.html#cb547-17" tabindex="-1"></a>  }</span>
<span id="cb547-18"><a href="simulace4.html#cb547-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb547-19"><a href="simulace4.html#cb547-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb548"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb548-1"><a href="simulace4.html#cb548-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb548-2"><a href="simulace4.html#cb548-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb548-3"><a href="simulace4.html#cb548-3" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb548-4"><a href="simulace4.html#cb548-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb548-5"><a href="simulace4.html#cb548-5" tabindex="-1"></a></span>
<span id="cb548-6"><a href="simulace4.html#cb548-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb548-7"><a href="simulace4.html#cb548-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of d values</span></span>
<span id="cb548-8"><a href="simulace4.html#cb548-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb548-9"><a href="simulace4.html#cb548-9" tabindex="-1"></a></span>
<span id="cb548-10"><a href="simulace4.html#cb548-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb548-11"><a href="simulace4.html#cb548-11" tabindex="-1"></a><span class="co"># Empty matrix to insert individual results</span></span>
<span id="cb548-12"><a href="simulace4.html#cb548-12" tabindex="-1"></a><span class="co"># Columns will hold accuracy values for given parameters</span></span>
<span id="cb548-13"><a href="simulace4.html#cb548-13" tabindex="-1"></a><span class="co"># Rows will hold values for given p and layers corresponding to folds</span></span>
<span id="cb548-14"><a href="simulace4.html#cb548-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb548-15"><a href="simulace4.html#cb548-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb548-16"><a href="simulace4.html#cb548-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb548-17"><a href="simulace4.html#cb548-17" tabindex="-1"></a></span>
<span id="cb548-18"><a href="simulace4.html#cb548-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb548-19"><a href="simulace4.html#cb548-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb548-20"><a href="simulace4.html#cb548-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb548-21"><a href="simulace4.html#cb548-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb548-22"><a href="simulace4.html#cb548-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb548-23"><a href="simulace4.html#cb548-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb548-24"><a href="simulace4.html#cb548-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb549"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb549-1"><a href="simulace4.html#cb549-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb549-2"><a href="simulace4.html#cb549-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb549-3"><a href="simulace4.html#cb549-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb549-4"><a href="simulace4.html#cb549-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb549-5"><a href="simulace4.html#cb549-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb549-6"><a href="simulace4.html#cb549-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb549-7"><a href="simulace4.html#cb549-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb549-8"><a href="simulace4.html#cb549-8" tabindex="-1"></a>  </span>
<span id="cb549-9"><a href="simulace4.html#cb549-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb549-10"><a href="simulace4.html#cb549-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb549-11"><a href="simulace4.html#cb549-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb549-12"><a href="simulace4.html#cb549-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb549-13"><a href="simulace4.html#cb549-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb549-14"><a href="simulace4.html#cb549-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb549-15"><a href="simulace4.html#cb549-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb549-16"><a href="simulace4.html#cb549-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb549-17"><a href="simulace4.html#cb549-17" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb549-18"><a href="simulace4.html#cb549-18" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb549-19"><a href="simulace4.html#cb549-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb549-20"><a href="simulace4.html#cb549-20" tabindex="-1"></a>  }</span>
<span id="cb549-21"><a href="simulace4.html#cb549-21" tabindex="-1"></a>  </span>
<span id="cb549-22"><a href="simulace4.html#cb549-22" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb549-23"><a href="simulace4.html#cb549-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb549-24"><a href="simulace4.html#cb549-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb549-25"><a href="simulace4.html#cb549-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb549-26"><a href="simulace4.html#cb549-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb549-27"><a href="simulace4.html#cb549-27" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb549-28"><a href="simulace4.html#cb549-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb549-29"><a href="simulace4.html#cb549-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb549-30"><a href="simulace4.html#cb549-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb549-31"><a href="simulace4.html#cb549-31" tabindex="-1"></a>    }</span>
<span id="cb549-32"><a href="simulace4.html#cb549-32" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb549-33"><a href="simulace4.html#cb549-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb549-34"><a href="simulace4.html#cb549-34" tabindex="-1"></a>      <span class="co"># Define test and training portions for CV</span></span>
<span id="cb549-35"><a href="simulace4.html#cb549-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb549-36"><a href="simulace4.html#cb549-36" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb549-37"><a href="simulace4.html#cb549-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb549-38"><a href="simulace4.html#cb549-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb549-39"><a href="simulace4.html#cb549-39" tabindex="-1"></a>      <span class="co"># Prepare a data frame to store results</span></span>
<span id="cb549-40"><a href="simulace4.html#cb549-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb549-41"><a href="simulace4.html#cb549-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb549-42"><a href="simulace4.html#cb549-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb549-43"><a href="simulace4.html#cb549-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb549-44"><a href="simulace4.html#cb549-44" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb549-45"><a href="simulace4.html#cb549-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb549-46"><a href="simulace4.html#cb549-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb549-47"><a href="simulace4.html#cb549-47" tabindex="-1"></a>      </span>
<span id="cb549-48"><a href="simulace4.html#cb549-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb549-49"><a href="simulace4.html#cb549-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb549-50"><a href="simulace4.html#cb549-50" tabindex="-1"></a>        </span>
<span id="cb549-51"><a href="simulace4.html#cb549-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb549-52"><a href="simulace4.html#cb549-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb549-53"><a href="simulace4.html#cb549-53" tabindex="-1"></a>        </span>
<span id="cb549-54"><a href="simulace4.html#cb549-54" tabindex="-1"></a>        <span class="co"># Construct models</span></span>
<span id="cb549-55"><a href="simulace4.html#cb549-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb549-56"><a href="simulace4.html#cb549-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb549-57"><a href="simulace4.html#cb549-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb549-58"><a href="simulace4.html#cb549-58" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb549-59"><a href="simulace4.html#cb549-59" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb549-60"><a href="simulace4.html#cb549-60" tabindex="-1"></a>        </span>
<span id="cb549-61"><a href="simulace4.html#cb549-61" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb549-62"><a href="simulace4.html#cb549-62" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb549-63"><a href="simulace4.html#cb549-63" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb549-64"><a href="simulace4.html#cb549-64" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb549-65"><a href="simulace4.html#cb549-65" tabindex="-1"></a>        </span>
<span id="cb549-66"><a href="simulace4.html#cb549-66" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb549-67"><a href="simulace4.html#cb549-67" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb549-68"><a href="simulace4.html#cb549-68" tabindex="-1"></a>      }</span>
<span id="cb549-69"><a href="simulace4.html#cb549-69" tabindex="-1"></a>      <span class="co"># Store accuracies in positions for given d, gamma, and fold</span></span>
<span id="cb549-70"><a href="simulace4.html#cb549-70" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb549-71"><a href="simulace4.html#cb549-71" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb549-72"><a href="simulace4.html#cb549-72" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb549-73"><a href="simulace4.html#cb549-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb549-74"><a href="simulace4.html#cb549-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb549-75"><a href="simulace4.html#cb549-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb549-76"><a href="simulace4.html#cb549-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb549-77"><a href="simulace4.html#cb549-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb549-78"><a href="simulace4.html#cb549-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb549-79"><a href="simulace4.html#cb549-79" tabindex="-1"></a>    }</span>
<span id="cb549-80"><a href="simulace4.html#cb549-80" tabindex="-1"></a>  }</span>
<span id="cb549-81"><a href="simulace4.html#cb549-81" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb550"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb550-1"><a href="simulace4.html#cb550-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb550-2"><a href="simulace4.html#cb550-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb550-3"><a href="simulace4.html#cb550-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb550-4"><a href="simulace4.html#cb550-4" tabindex="-1"></a>}</span>
<span id="cb550-5"><a href="simulace4.html#cb550-5" tabindex="-1"></a></span>
<span id="cb550-6"><a href="simulace4.html#cb550-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb550-7"><a href="simulace4.html#cb550-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb550-8"><a href="simulace4.html#cb550-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb550-9"><a href="simulace4.html#cb550-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb550-10"><a href="simulace4.html#cb550-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb550-11"><a href="simulace4.html#cb550-11" tabindex="-1"></a></span>
<span id="cb550-12"><a href="simulace4.html#cb550-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb550-13"><a href="simulace4.html#cb550-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb550-14"><a href="simulace4.html#cb550-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb550-15"><a href="simulace4.html#cb550-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb550-16"><a href="simulace4.html#cb550-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb550-17"><a href="simulace4.html#cb550-17" tabindex="-1"></a></span>
<span id="cb550-18"><a href="simulace4.html#cb550-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb550-19"><a href="simulace4.html#cb550-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb550-20"><a href="simulace4.html#cb550-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb550-21"><a href="simulace4.html#cb550-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb550-22"><a href="simulace4.html#cb550-22" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb550-23"><a href="simulace4.html#cb550-23" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-111">Table 5.3: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">40</td>
<td align="right">5</td>
<td align="right">0.1940</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">3</td>
<td align="right">5</td>
<td align="right">0.1874</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">21</td>
<td align="right">3</td>
<td align="right">0.2068</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best values for parameter <span class="math inline">\(d={}\)</span> 40 and <span class="math inline">\(p={}\)</span> 5 are for the linear kernel with an error calculated using 10-fold CV 0.194, <span class="math inline">\(d={}\)</span> 3 and <span class="math inline">\(p={}\)</span> 5 for the polynomial kernel with an error calculated using 10-fold CV 0.1874, and <span class="math inline">\(d={}\)</span> 21 and <span class="math inline">\(p={}\)</span> 3 for the radial kernel with an error 0.2068.</p>
<p>Since we have found the optimal values for the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb551"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb551-1"><a href="simulace4.html#cb551-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb551-2"><a href="simulace4.html#cb551-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb551-3"><a href="simulace4.html#cb551-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb551-4"><a href="simulace4.html#cb551-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb552"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb552-1"><a href="simulace4.html#cb552-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb552-2"><a href="simulace4.html#cb552-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb552-3"><a href="simulace4.html#cb552-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb552-4"><a href="simulace4.html#cb552-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb552-5"><a href="simulace4.html#cb552-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb552-6"><a href="simulace4.html#cb552-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb552-7"><a href="simulace4.html#cb552-7" tabindex="-1"></a></span>
<span id="cb552-8"><a href="simulace4.html#cb552-8" tabindex="-1"></a><span class="co"># Iterate over the individual kernels</span></span>
<span id="cb552-9"><a href="simulace4.html#cb552-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb552-10"><a href="simulace4.html#cb552-10" tabindex="-1"></a>  <span class="co"># Calculate the matrix K</span></span>
<span id="cb552-11"><a href="simulace4.html#cb552-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># CV-derived parameter value</span></span>
<span id="cb552-12"><a href="simulace4.html#cb552-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb552-13"><a href="simulace4.html#cb552-13" tabindex="-1"></a>  </span>
<span id="cb552-14"><a href="simulace4.html#cb552-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb552-15"><a href="simulace4.html#cb552-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb552-16"><a href="simulace4.html#cb552-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb552-17"><a href="simulace4.html#cb552-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb552-18"><a href="simulace4.html#cb552-18" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb552-19"><a href="simulace4.html#cb552-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb552-20"><a href="simulace4.html#cb552-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb552-21"><a href="simulace4.html#cb552-21" tabindex="-1"></a>  </span>
<span id="cb552-22"><a href="simulace4.html#cb552-22" tabindex="-1"></a>  <span class="co"># Model fitting</span></span>
<span id="cb552-23"><a href="simulace4.html#cb552-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb552-24"><a href="simulace4.html#cb552-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb552-25"><a href="simulace4.html#cb552-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb552-26"><a href="simulace4.html#cb552-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb552-27"><a href="simulace4.html#cb552-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb552-28"><a href="simulace4.html#cb552-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb552-29"><a href="simulace4.html#cb552-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb552-30"><a href="simulace4.html#cb552-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb552-31"><a href="simulace4.html#cb552-31" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb552-32"><a href="simulace4.html#cb552-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb552-33"><a href="simulace4.html#cb552-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb552-34"><a href="simulace4.html#cb552-34" tabindex="-1"></a>  }</span>
<span id="cb552-35"><a href="simulace4.html#cb552-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb552-36"><a href="simulace4.html#cb552-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb552-37"><a href="simulace4.html#cb552-37" tabindex="-1"></a>  </span>
<span id="cb552-38"><a href="simulace4.html#cb552-38" tabindex="-1"></a>  <span class="co"># Determine lambda vector</span></span>
<span id="cb552-39"><a href="simulace4.html#cb552-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb552-40"><a href="simulace4.html#cb552-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb552-41"><a href="simulace4.html#cb552-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb552-42"><a href="simulace4.html#cb552-42" tabindex="-1"></a>  </span>
<span id="cb552-43"><a href="simulace4.html#cb552-43" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb552-44"><a href="simulace4.html#cb552-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb552-45"><a href="simulace4.html#cb552-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb552-46"><a href="simulace4.html#cb552-46" tabindex="-1"></a>  }</span>
<span id="cb552-47"><a href="simulace4.html#cb552-47" tabindex="-1"></a>  </span>
<span id="cb552-48"><a href="simulace4.html#cb552-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb552-49"><a href="simulace4.html#cb552-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb552-50"><a href="simulace4.html#cb552-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb552-51"><a href="simulace4.html#cb552-51" tabindex="-1"></a></span>
<span id="cb552-52"><a href="simulace4.html#cb552-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb552-53"><a href="simulace4.html#cb552-53" tabindex="-1"></a></span>
<span id="cb552-54"><a href="simulace4.html#cb552-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb552-55"><a href="simulace4.html#cb552-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb552-56"><a href="simulace4.html#cb552-56" tabindex="-1"></a>  </span>
<span id="cb552-57"><a href="simulace4.html#cb552-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb552-58"><a href="simulace4.html#cb552-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb552-59"><a href="simulace4.html#cb552-59" tabindex="-1"></a>  </span>
<span id="cb552-60"><a href="simulace4.html#cb552-60" tabindex="-1"></a>  <span class="co"># Build the models</span></span>
<span id="cb552-61"><a href="simulace4.html#cb552-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb552-62"><a href="simulace4.html#cb552-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb552-63"><a href="simulace4.html#cb552-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb552-64"><a href="simulace4.html#cb552-64" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb552-65"><a href="simulace4.html#cb552-65" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb552-66"><a href="simulace4.html#cb552-66" tabindex="-1"></a>  </span>
<span id="cb552-67"><a href="simulace4.html#cb552-67" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb552-68"><a href="simulace4.html#cb552-68" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb552-69"><a href="simulace4.html#cb552-69" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb552-70"><a href="simulace4.html#cb552-70" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb552-71"><a href="simulace4.html#cb552-71" tabindex="-1"></a>    </span>
<span id="cb552-72"><a href="simulace4.html#cb552-72" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb552-73"><a href="simulace4.html#cb552-73" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb552-74"><a href="simulace4.html#cb552-74" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb552-75"><a href="simulace4.html#cb552-75" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb552-76"><a href="simulace4.html#cb552-76" tabindex="-1"></a>  </span>
<span id="cb552-77"><a href="simulace4.html#cb552-77" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb552-78"><a href="simulace4.html#cb552-78" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb552-79"><a href="simulace4.html#cb552-79" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-114">Table 5.4: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0929</td>
<td align="center">0.3</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.1714</td>
<td align="center">0.3</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.1357</td>
<td align="center">0.3</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus on the training data equal to 9.29 % for the linear kernel, 17.14 % for the polynomial kernel, and 13.57 % for the Gaussian kernel. On the test data, the error rate of the method is 30 % for the linear kernel, 30 % for the polynomial kernel, and 30 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb553"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb553-1"><a href="simulace4.html#cb553-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="linear-kernel-1" class="section level6 hasAnchor" number="5.1.3.7.6.4">
<h6><span class="header-section-number">5.1.3.7.6.4</span> Linear Kernel<a href="simulace4.html#linear-kernel-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb554"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb554-1"><a href="simulace4.html#cb554-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb554-2"><a href="simulace4.html#cb554-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb554-3"><a href="simulace4.html#cb554-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb554-4"><a href="simulace4.html#cb554-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb554-5"><a href="simulace4.html#cb554-5" tabindex="-1"></a></span>
<span id="cb554-6"><a href="simulace4.html#cb554-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb554-7"><a href="simulace4.html#cb554-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb554-8"><a href="simulace4.html#cb554-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb554-9"><a href="simulace4.html#cb554-9" tabindex="-1"></a>}</span>
<span id="cb554-10"><a href="simulace4.html#cb554-10" tabindex="-1"></a></span>
<span id="cb554-11"><a href="simulace4.html#cb554-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb554-12"><a href="simulace4.html#cb554-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb554-13"><a href="simulace4.html#cb554-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb554-14"><a href="simulace4.html#cb554-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb554-15"><a href="simulace4.html#cb554-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb554-16"><a href="simulace4.html#cb554-16" tabindex="-1"></a>    }</span>
<span id="cb554-17"><a href="simulace4.html#cb554-17" tabindex="-1"></a>  }</span>
<span id="cb554-18"><a href="simulace4.html#cb554-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb554-19"><a href="simulace4.html#cb554-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb555"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb555-1"><a href="simulace4.html#cb555-1" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb555-2"><a href="simulace4.html#cb555-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb555-3"><a href="simulace4.html#cb555-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb555-4"><a href="simulace4.html#cb555-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb555-5"><a href="simulace4.html#cb555-5" tabindex="-1"></a></span>
<span id="cb555-6"><a href="simulace4.html#cb555-6" tabindex="-1"></a><span class="co"># Values of hyperparameters that we will traverse</span></span>
<span id="cb555-7"><a href="simulace4.html#cb555-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of values for d</span></span>
<span id="cb555-8"><a href="simulace4.html#cb555-8" tabindex="-1"></a></span>
<span id="cb555-9"><a href="simulace4.html#cb555-9" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb555-10"><a href="simulace4.html#cb555-10" tabindex="-1"></a><span class="co"># Empty matrix to store the individual results</span></span>
<span id="cb555-11"><a href="simulace4.html#cb555-11" tabindex="-1"></a><span class="co"># In columns, there will be accuracy values for given d</span></span>
<span id="cb555-12"><a href="simulace4.html#cb555-12" tabindex="-1"></a><span class="co"># In rows, there will be values for layers corresponding to folds</span></span>
<span id="cb555-13"><a href="simulace4.html#cb555-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb555-14"><a href="simulace4.html#cb555-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb555-15"><a href="simulace4.html#cb555-15" tabindex="-1"></a></span>
<span id="cb555-16"><a href="simulace4.html#cb555-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb555-17"><a href="simulace4.html#cb555-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb555-18"><a href="simulace4.html#cb555-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb555-19"><a href="simulace4.html#cb555-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb555-20"><a href="simulace4.html#cb555-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb555-21"><a href="simulace4.html#cb555-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb555-22"><a href="simulace4.html#cb555-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb556"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb556-1"><a href="simulace4.html#cb556-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb556-2"><a href="simulace4.html#cb556-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb556-3"><a href="simulace4.html#cb556-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb556-4"><a href="simulace4.html#cb556-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb556-5"><a href="simulace4.html#cb556-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb556-6"><a href="simulace4.html#cb556-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb556-7"><a href="simulace4.html#cb556-7" tabindex="-1"></a></span>
<span id="cb556-8"><a href="simulace4.html#cb556-8" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb556-9"><a href="simulace4.html#cb556-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb556-10"><a href="simulace4.html#cb556-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb556-11"><a href="simulace4.html#cb556-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb556-12"><a href="simulace4.html#cb556-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb556-13"><a href="simulace4.html#cb556-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb556-14"><a href="simulace4.html#cb556-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb556-15"><a href="simulace4.html#cb556-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb556-16"><a href="simulace4.html#cb556-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb556-17"><a href="simulace4.html#cb556-17" tabindex="-1"></a>}</span>
<span id="cb556-18"><a href="simulace4.html#cb556-18" tabindex="-1"></a></span>
<span id="cb556-19"><a href="simulace4.html#cb556-19" tabindex="-1"></a><span class="co"># Traverse dimensions</span></span>
<span id="cb556-20"><a href="simulace4.html#cb556-20" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb556-21"><a href="simulace4.html#cb556-21" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb556-22"><a href="simulace4.html#cb556-22" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb556-23"><a href="simulace4.html#cb556-23" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb556-24"><a href="simulace4.html#cb556-24" tabindex="-1"></a>  <span class="co"># Calculation of representation</span></span>
<span id="cb556-25"><a href="simulace4.html#cb556-25" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb556-26"><a href="simulace4.html#cb556-26" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb556-27"><a href="simulace4.html#cb556-27" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb556-28"><a href="simulace4.html#cb556-28" tabindex="-1"></a>  }</span>
<span id="cb556-29"><a href="simulace4.html#cb556-29" tabindex="-1"></a>  <span class="co"># Traverse folds</span></span>
<span id="cb556-30"><a href="simulace4.html#cb556-30" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb556-31"><a href="simulace4.html#cb556-31" tabindex="-1"></a>    <span class="co"># Define test and training portions for CV</span></span>
<span id="cb556-32"><a href="simulace4.html#cb556-32" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb556-33"><a href="simulace4.html#cb556-33" tabindex="-1"></a>    <span class="co"># Split into training and validation data</span></span>
<span id="cb556-34"><a href="simulace4.html#cb556-34" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb556-35"><a href="simulace4.html#cb556-35" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb556-36"><a href="simulace4.html#cb556-36" tabindex="-1"></a>    <span class="co"># Prepare a data table to store results</span></span>
<span id="cb556-37"><a href="simulace4.html#cb556-37" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb556-38"><a href="simulace4.html#cb556-38" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb556-39"><a href="simulace4.html#cb556-39" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb556-40"><a href="simulace4.html#cb556-40" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb556-41"><a href="simulace4.html#cb556-41" tabindex="-1"></a>    <span class="co"># Traverse individual kernels</span></span>
<span id="cb556-42"><a href="simulace4.html#cb556-42" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb556-43"><a href="simulace4.html#cb556-43" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb556-44"><a href="simulace4.html#cb556-44" tabindex="-1"></a>    </span>
<span id="cb556-45"><a href="simulace4.html#cb556-45" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb556-46"><a href="simulace4.html#cb556-46" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb556-47"><a href="simulace4.html#cb556-47" tabindex="-1"></a>      </span>
<span id="cb556-48"><a href="simulace4.html#cb556-48" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb556-49"><a href="simulace4.html#cb556-49" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb556-50"><a href="simulace4.html#cb556-50" tabindex="-1"></a>      </span>
<span id="cb556-51"><a href="simulace4.html#cb556-51" tabindex="-1"></a>      <span class="co"># Build models</span></span>
<span id="cb556-52"><a href="simulace4.html#cb556-52" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb556-53"><a href="simulace4.html#cb556-53" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb556-54"><a href="simulace4.html#cb556-54" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb556-55"><a href="simulace4.html#cb556-55" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb556-56"><a href="simulace4.html#cb556-56" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type)</span>
<span id="cb556-57"><a href="simulace4.html#cb556-57" tabindex="-1"></a>      </span>
<span id="cb556-58"><a href="simulace4.html#cb556-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb556-59"><a href="simulace4.html#cb556-59" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb556-60"><a href="simulace4.html#cb556-60" tabindex="-1"></a>      accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb556-61"><a href="simulace4.html#cb556-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb556-62"><a href="simulace4.html#cb556-62" tabindex="-1"></a>      </span>
<span id="cb556-63"><a href="simulace4.html#cb556-63" tabindex="-1"></a>      <span class="co"># Store results</span></span>
<span id="cb556-64"><a href="simulace4.html#cb556-64" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb556-65"><a href="simulace4.html#cb556-65" tabindex="-1"></a>    }</span>
<span id="cb556-66"><a href="simulace4.html#cb556-66" tabindex="-1"></a>    <span class="co"># Store accuracies in positions for given d, gamma, and fold</span></span>
<span id="cb556-67"><a href="simulace4.html#cb556-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb556-68"><a href="simulace4.html#cb556-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb556-69"><a href="simulace4.html#cb556-69" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb556-70"><a href="simulace4.html#cb556-70" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb556-71"><a href="simulace4.html#cb556-71" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb556-72"><a href="simulace4.html#cb556-72" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb556-73"><a href="simulace4.html#cb556-73" tabindex="-1"></a>  }</span>
<span id="cb556-74"><a href="simulace4.html#cb556-74" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb557"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb557-1"><a href="simulace4.html#cb557-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb557-2"><a href="simulace4.html#cb557-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb557-3"><a href="simulace4.html#cb557-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb557-4"><a href="simulace4.html#cb557-4" tabindex="-1"></a>}</span>
<span id="cb557-5"><a href="simulace4.html#cb557-5" tabindex="-1"></a></span>
<span id="cb557-6"><a href="simulace4.html#cb557-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb557-7"><a href="simulace4.html#cb557-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb557-8"><a href="simulace4.html#cb557-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb557-9"><a href="simulace4.html#cb557-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb557-10"><a href="simulace4.html#cb557-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb557-11"><a href="simulace4.html#cb557-11" tabindex="-1"></a></span>
<span id="cb557-12"><a href="simulace4.html#cb557-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb557-13"><a href="simulace4.html#cb557-13" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb557-14"><a href="simulace4.html#cb557-14" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb557-15"><a href="simulace4.html#cb557-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb557-16"><a href="simulace4.html#cb557-16" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb557-17"><a href="simulace4.html#cb557-17" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-119">Table 5.5: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">9</td>
<td align="right">0.3317</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">35</td>
<td align="right">0.3645</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">10</td>
<td align="right">0.3240</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter value is <span class="math inline">\(d={}\)</span> 9 for the linear kernel with an error rate calculated using 10-fold CV of 0.3317, <span class="math inline">\(d={}\)</span> 35 for the polynomial kernel with an error rate of 0.3645, and <span class="math inline">\(d={}\)</span> 10 for the radial kernel with an error rate of 0.324.</p>
<p>Now that we have found the optimal hyperparameter values, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb558"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb558-1"><a href="simulace4.html#cb558-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb558-2"><a href="simulace4.html#cb558-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb558-3"><a href="simulace4.html#cb558-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb558-4"><a href="simulace4.html#cb558-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb559"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb559-1"><a href="simulace4.html#cb559-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store the results</span></span>
<span id="cb559-2"><a href="simulace4.html#cb559-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb559-3"><a href="simulace4.html#cb559-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb559-4"><a href="simulace4.html#cb559-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb559-5"><a href="simulace4.html#cb559-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb559-6"><a href="simulace4.html#cb559-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb559-7"><a href="simulace4.html#cb559-7" tabindex="-1"></a></span>
<span id="cb559-8"><a href="simulace4.html#cb559-8" tabindex="-1"></a><span class="co"># Iterate over the individual kernels</span></span>
<span id="cb559-9"><a href="simulace4.html#cb559-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb559-10"><a href="simulace4.html#cb559-10" tabindex="-1"></a>  <span class="co"># Compute the K matrix</span></span>
<span id="cb559-11"><a href="simulace4.html#cb559-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb559-12"><a href="simulace4.html#cb559-12" tabindex="-1"></a>  </span>
<span id="cb559-13"><a href="simulace4.html#cb559-13" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb559-14"><a href="simulace4.html#cb559-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb559-15"><a href="simulace4.html#cb559-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb559-16"><a href="simulace4.html#cb559-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb559-17"><a href="simulace4.html#cb559-17" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb559-18"><a href="simulace4.html#cb559-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb559-19"><a href="simulace4.html#cb559-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb559-20"><a href="simulace4.html#cb559-20" tabindex="-1"></a>  </span>
<span id="cb559-21"><a href="simulace4.html#cb559-21" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb559-22"><a href="simulace4.html#cb559-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb559-23"><a href="simulace4.html#cb559-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb559-24"><a href="simulace4.html#cb559-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb559-25"><a href="simulace4.html#cb559-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb559-26"><a href="simulace4.html#cb559-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb559-27"><a href="simulace4.html#cb559-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb559-28"><a href="simulace4.html#cb559-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb559-29"><a href="simulace4.html#cb559-29" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb559-30"><a href="simulace4.html#cb559-30" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb559-31"><a href="simulace4.html#cb559-31" tabindex="-1"></a>  }</span>
<span id="cb559-32"><a href="simulace4.html#cb559-32" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb559-33"><a href="simulace4.html#cb559-33" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb559-34"><a href="simulace4.html#cb559-34" tabindex="-1"></a>  </span>
<span id="cb559-35"><a href="simulace4.html#cb559-35" tabindex="-1"></a>  <span class="co"># Determine lambda vector</span></span>
<span id="cb559-36"><a href="simulace4.html#cb559-36" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb559-37"><a href="simulace4.html#cb559-37" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb559-38"><a href="simulace4.html#cb559-38" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb559-39"><a href="simulace4.html#cb559-39" tabindex="-1"></a>  </span>
<span id="cb559-40"><a href="simulace4.html#cb559-40" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb559-41"><a href="simulace4.html#cb559-41" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb559-42"><a href="simulace4.html#cb559-42" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb559-43"><a href="simulace4.html#cb559-43" tabindex="-1"></a>  }</span>
<span id="cb559-44"><a href="simulace4.html#cb559-44" tabindex="-1"></a>  </span>
<span id="cb559-45"><a href="simulace4.html#cb559-45" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb559-46"><a href="simulace4.html#cb559-46" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb559-47"><a href="simulace4.html#cb559-47" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb559-48"><a href="simulace4.html#cb559-48" tabindex="-1"></a></span>
<span id="cb559-49"><a href="simulace4.html#cb559-49" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb559-50"><a href="simulace4.html#cb559-50" tabindex="-1"></a></span>
<span id="cb559-51"><a href="simulace4.html#cb559-51" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb559-52"><a href="simulace4.html#cb559-52" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb559-53"><a href="simulace4.html#cb559-53" tabindex="-1"></a>  </span>
<span id="cb559-54"><a href="simulace4.html#cb559-54" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb559-55"><a href="simulace4.html#cb559-55" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb559-56"><a href="simulace4.html#cb559-56" tabindex="-1"></a>  </span>
<span id="cb559-57"><a href="simulace4.html#cb559-57" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb559-58"><a href="simulace4.html#cb559-58" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb559-59"><a href="simulace4.html#cb559-59" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb559-60"><a href="simulace4.html#cb559-60" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb559-61"><a href="simulace4.html#cb559-61" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb559-62"><a href="simulace4.html#cb559-62" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb559-63"><a href="simulace4.html#cb559-63" tabindex="-1"></a>  </span>
<span id="cb559-64"><a href="simulace4.html#cb559-64" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb559-65"><a href="simulace4.html#cb559-65" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb559-66"><a href="simulace4.html#cb559-66" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb559-67"><a href="simulace4.html#cb559-67" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb559-68"><a href="simulace4.html#cb559-68" tabindex="-1"></a>    </span>
<span id="cb559-69"><a href="simulace4.html#cb559-69" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb559-70"><a href="simulace4.html#cb559-70" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb559-71"><a href="simulace4.html#cb559-71" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb559-72"><a href="simulace4.html#cb559-72" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb559-73"><a href="simulace4.html#cb559-73" tabindex="-1"></a>  </span>
<span id="cb559-74"><a href="simulace4.html#cb559-74" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb559-75"><a href="simulace4.html#cb559-75" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb559-76"><a href="simulace4.html#cb559-76" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-122">Table 5.6: </span>Summary of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.3000</td>
<td align="center">0.2833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.2333</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 30 % for the linear kernel, 30.71 % for the polynomial kernel, and 30.71 % for the Gaussian kernel. For the test data, the error rate is 28.33 % for the linear kernel, 30 % for the polynomial kernel, and 23.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb560"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb560-1"><a href="simulace4.html#cb560-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="results-table-3" class="section level4 hasAnchor" number="5.1.3.8">
<h4><span class="header-section-number">5.1.3.8</span> Results Table<a href="simulace4.html#results-table-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-124">Table 5.7: </span>Summary of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.3071</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.3143</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3500</td>
<td align="center">0.2000</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0500</td>
<td align="center">0.1167</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.3143</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">Tree - discr.</td>
<td align="center">0.2643</td>
<td align="center">0.1833</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.3000</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.2643</td>
<td align="center">0.1833</td>
</tr>
<tr class="odd">
<td align="left">RForest - discretization</td>
<td align="center">0.0000</td>
<td align="center">0.2000</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0143</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0000</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM linear - func</td>
<td align="center">0.1571</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - func</td>
<td align="center">0.1214</td>
<td align="center">0.2500</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - func</td>
<td align="center">0.1571</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discretization</td>
<td align="center">0.0786</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - discretization</td>
<td align="center">0.1286</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - discretization</td>
<td align="center">0.1429</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.3143</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.3143</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.3214</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0714</td>
<td align="center">0.0667</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.2000</td>
<td align="center">0.2167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.1286</td>
<td align="center">0.2000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.1214</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.1286</td>
<td align="center">0.2500</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.1357</td>
<td align="center">0.2833</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.1071</td>
<td align="center">0.2833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.1429</td>
<td align="center">0.2667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.1357</td>
<td align="center">0.3167</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0929</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.1714</td>
<td align="center">0.3000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.1357</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.3000</td>
<td align="center">0.2833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.2333</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simulation-study-3" class="section level3 hasAnchor" number="5.1.4">
<h3><span class="header-section-number">5.1.4</span> Simulation Study<a href="simulace4.html#simulation-study-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the entire previous section, we focused only on one randomly generated set of functions from two classification classes, which we then randomly split into test and training parts. We evaluated the individual classifiers obtained using the considered methods based on test and training error rates.</p>
<p>Since the generated data (and their division into two parts) can differ significantly with each repetition, the error rates of the individual classification algorithms may vary greatly as well. Therefore, drawing any conclusions about the methods and comparing them based on a single generated data set can be very misleading.</p>
<p>For this reason, in this section, we will repeat the entire previous procedure for different generated data sets. We will store the results in a table and ultimately calculate the average characteristics of the models across individual repetitions. To ensure our conclusions are sufficiently general, we will choose the number of repetitions as <span class="math inline">\(n_{sim} = 100\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb561"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb561-1"><a href="simulace4.html#cb561-1" tabindex="-1"></a><span class="co"># Set seed for the pseudorandom number generator</span></span>
<span id="cb561-2"><a href="simulace4.html#cb561-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb561-3"><a href="simulace4.html#cb561-3" tabindex="-1"></a></span>
<span id="cb561-4"><a href="simulace4.html#cb561-4" tabindex="-1"></a><span class="co"># Number of simulations</span></span>
<span id="cb561-5"><a href="simulace4.html#cb561-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb561-6"><a href="simulace4.html#cb561-6" tabindex="-1"></a></span>
<span id="cb561-7"><a href="simulace4.html#cb561-7" tabindex="-1"></a><span class="do">## List to store error rates</span></span>
<span id="cb561-8"><a href="simulace4.html#cb561-8" tabindex="-1"></a><span class="co"># Columns will represent methods</span></span>
<span id="cb561-9"><a href="simulace4.html#cb561-9" tabindex="-1"></a><span class="co"># Rows will represent individual repetitions</span></span>
<span id="cb561-10"><a href="simulace4.html#cb561-10" tabindex="-1"></a><span class="co"># The list has two entries: train and test</span></span>
<span id="cb561-11"><a href="simulace4.html#cb561-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb561-12"><a href="simulace4.html#cb561-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb561-13"><a href="simulace4.html#cb561-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - func&#39;</span>, <span class="st">&#39;SVM poly - func&#39;</span>, <span class="st">&#39;SVM rbf - func&#39;</span>,</span>
<span id="cb561-14"><a href="simulace4.html#cb561-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb561-15"><a href="simulace4.html#cb561-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb561-16"><a href="simulace4.html#cb561-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb561-17"><a href="simulace4.html#cb561-17" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb561-18"><a href="simulace4.html#cb561-18" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb561-19"><a href="simulace4.html#cb561-19" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb561-20"><a href="simulace4.html#cb561-20" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb561-21"><a href="simulace4.html#cb561-21" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb561-22"><a href="simulace4.html#cb561-22" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb561-23"><a href="simulace4.html#cb561-23" tabindex="-1"></a></span>
<span id="cb561-24"><a href="simulace4.html#cb561-24" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb561-25"><a href="simulace4.html#cb561-25" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb561-26"><a href="simulace4.html#cb561-26" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb561-27"><a href="simulace4.html#cb561-27" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb561-28"><a href="simulace4.html#cb561-28" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb561-29"><a href="simulace4.html#cb561-29" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb561-30"><a href="simulace4.html#cb561-30" tabindex="-1"></a></span>
<span id="cb561-31"><a href="simulace4.html#cb561-31" tabindex="-1"></a><span class="co"># Object to store optimal hyperparameter values determined via CV</span></span>
<span id="cb561-32"><a href="simulace4.html#cb561-32" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb561-33"><a href="simulace4.html#cb561-33" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb561-34"><a href="simulace4.html#cb561-34" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb561-35"><a href="simulace4.html#cb561-35" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb561-36"><a href="simulace4.html#cb561-36" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb561-37"><a href="simulace4.html#cb561-37" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb561-38"><a href="simulace4.html#cb561-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-39"><a href="simulace4.html#cb561-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-40"><a href="simulace4.html#cb561-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-41"><a href="simulace4.html#cb561-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-42"><a href="simulace4.html#cb561-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-43"><a href="simulace4.html#cb561-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-44"><a href="simulace4.html#cb561-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-45"><a href="simulace4.html#cb561-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-46"><a href="simulace4.html#cb561-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-47"><a href="simulace4.html#cb561-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-48"><a href="simulace4.html#cb561-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-49"><a href="simulace4.html#cb561-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-50"><a href="simulace4.html#cb561-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-51"><a href="simulace4.html#cb561-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb561-52"><a href="simulace4.html#cb561-52" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Now we will repeat the entire previous section 100 times, and we will store the error rates in the list <code>SIMULACE</code>. We will also store the optimal hyperparameter values in the data table <code>CV_RESULTS</code> — for the <span class="math inline">\(K\)</span> nearest neighbors method and for SVM, the value of dimension <span class="math inline">\(d\)</span> in the case of projection onto the B-spline basis. Additionally, we will save all hyperparameter values for the SVM + RKHS method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb562"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb562-1"><a href="simulace4.html#cb562-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb562-2"><a href="simulace4.html#cb562-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb562-3"><a href="simulace4.html#cb562-3" tabindex="-1"></a></span>
<span id="cb562-4"><a href="simulace4.html#cb562-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb562-5"><a href="simulace4.html#cb562-5" tabindex="-1"></a></span>
<span id="cb562-6"><a href="simulace4.html#cb562-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb562-7"><a href="simulace4.html#cb562-7" tabindex="-1"></a>  <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb562-8"><a href="simulace4.html#cb562-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb562-9"><a href="simulace4.html#cb562-9" tabindex="-1"></a>  <span class="co"># vektor casu ekvidistantni na intervalu [0, 6]</span></span>
<span id="cb562-10"><a href="simulace4.html#cb562-10" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb562-11"><a href="simulace4.html#cb562-11" tabindex="-1"></a>  </span>
<span id="cb562-12"><a href="simulace4.html#cb562-12" tabindex="-1"></a>  <span class="co"># pro Y = 0</span></span>
<span id="cb562-13"><a href="simulace4.html#cb562-13" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb562-14"><a href="simulace4.html#cb562-14" tabindex="-1"></a>  <span class="co"># pro Y = 1</span></span>
<span id="cb562-15"><a href="simulace4.html#cb562-15" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb562-16"><a href="simulace4.html#cb562-16" tabindex="-1"></a>  </span>
<span id="cb562-17"><a href="simulace4.html#cb562-17" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb562-18"><a href="simulace4.html#cb562-18" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb562-19"><a href="simulace4.html#cb562-19" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">5</span></span>
<span id="cb562-20"><a href="simulace4.html#cb562-20" tabindex="-1"></a>  </span>
<span id="cb562-21"><a href="simulace4.html#cb562-21" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb562-22"><a href="simulace4.html#cb562-22" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb562-23"><a href="simulace4.html#cb562-23" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb562-24"><a href="simulace4.html#cb562-24" tabindex="-1"></a>  </span>
<span id="cb562-25"><a href="simulace4.html#cb562-25" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">3</span>) </span>
<span id="cb562-26"><a href="simulace4.html#cb562-26" tabindex="-1"></a>  <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb562-27"><a href="simulace4.html#cb562-27" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb562-28"><a href="simulace4.html#cb562-28" tabindex="-1"></a>  </span>
<span id="cb562-29"><a href="simulace4.html#cb562-29" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">3</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb562-30"><a href="simulace4.html#cb562-30" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb562-31"><a href="simulace4.html#cb562-31" tabindex="-1"></a>  </span>
<span id="cb562-32"><a href="simulace4.html#cb562-32" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb562-33"><a href="simulace4.html#cb562-33" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb562-34"><a href="simulace4.html#cb562-34" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb562-35"><a href="simulace4.html#cb562-35" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb562-36"><a href="simulace4.html#cb562-36" tabindex="-1"></a>  }</span>
<span id="cb562-37"><a href="simulace4.html#cb562-37" tabindex="-1"></a>  </span>
<span id="cb562-38"><a href="simulace4.html#cb562-38" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb562-39"><a href="simulace4.html#cb562-39" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb562-40"><a href="simulace4.html#cb562-40" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb562-41"><a href="simulace4.html#cb562-41" tabindex="-1"></a>  )</span>
<span id="cb562-42"><a href="simulace4.html#cb562-42" tabindex="-1"></a>  </span>
<span id="cb562-43"><a href="simulace4.html#cb562-43" tabindex="-1"></a>  <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb562-44"><a href="simulace4.html#cb562-44" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb562-45"><a href="simulace4.html#cb562-45" tabindex="-1"></a>  </span>
<span id="cb562-46"><a href="simulace4.html#cb562-46" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb562-47"><a href="simulace4.html#cb562-47" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb562-48"><a href="simulace4.html#cb562-48" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb562-49"><a href="simulace4.html#cb562-49" tabindex="-1"></a>  </span>
<span id="cb562-50"><a href="simulace4.html#cb562-50" tabindex="-1"></a>  <span class="co"># vypocet derivace</span></span>
<span id="cb562-51"><a href="simulace4.html#cb562-51" tabindex="-1"></a>  XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">1</span>)</span>
<span id="cb562-52"><a href="simulace4.html#cb562-52" tabindex="-1"></a>  </span>
<span id="cb562-53"><a href="simulace4.html#cb562-53" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> t)</span>
<span id="cb562-54"><a href="simulace4.html#cb562-54" tabindex="-1"></a>  </span>
<span id="cb562-55"><a href="simulace4.html#cb562-55" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb562-56"><a href="simulace4.html#cb562-56" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb562-57"><a href="simulace4.html#cb562-57" tabindex="-1"></a>  </span>
<span id="cb562-58"><a href="simulace4.html#cb562-58" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb562-59"><a href="simulace4.html#cb562-59" tabindex="-1"></a>  </span>
<span id="cb562-60"><a href="simulace4.html#cb562-60" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb562-61"><a href="simulace4.html#cb562-61" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb562-62"><a href="simulace4.html#cb562-62" tabindex="-1"></a>  </span>
<span id="cb562-63"><a href="simulace4.html#cb562-63" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb562-64"><a href="simulace4.html#cb562-64" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb562-65"><a href="simulace4.html#cb562-65" tabindex="-1"></a>  </span>
<span id="cb562-66"><a href="simulace4.html#cb562-66" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb562-67"><a href="simulace4.html#cb562-67" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb562-68"><a href="simulace4.html#cb562-68" tabindex="-1"></a>  </span>
<span id="cb562-69"><a href="simulace4.html#cb562-69" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb562-70"><a href="simulace4.html#cb562-70" tabindex="-1"></a>  </span>
<span id="cb562-71"><a href="simulace4.html#cb562-71" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb562-72"><a href="simulace4.html#cb562-72" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> <span class="co">#c(1:(2 * ceiling(sqrt(length(y.train))))) # pocet sousedu </span></span>
<span id="cb562-73"><a href="simulace4.html#cb562-73" tabindex="-1"></a>  </span>
<span id="cb562-74"><a href="simulace4.html#cb562-74" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb562-75"><a href="simulace4.html#cb562-75" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-76"><a href="simulace4.html#cb562-76" tabindex="-1"></a>  </span>
<span id="cb562-77"><a href="simulace4.html#cb562-77" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb562-78"><a href="simulace4.html#cb562-78" tabindex="-1"></a>  </span>
<span id="cb562-79"><a href="simulace4.html#cb562-79" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-80"><a href="simulace4.html#cb562-80" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb562-81"><a href="simulace4.html#cb562-81" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb562-82"><a href="simulace4.html#cb562-82" tabindex="-1"></a>      </span>
<span id="cb562-83"><a href="simulace4.html#cb562-83" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-84"><a href="simulace4.html#cb562-84" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb562-85"><a href="simulace4.html#cb562-85" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-86"><a href="simulace4.html#cb562-86" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb562-87"><a href="simulace4.html#cb562-87" tabindex="-1"></a>    </span>
<span id="cb562-88"><a href="simulace4.html#cb562-88" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-89"><a href="simulace4.html#cb562-89" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb562-90"><a href="simulace4.html#cb562-90" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-91"><a href="simulace4.html#cb562-91" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb562-92"><a href="simulace4.html#cb562-92" tabindex="-1"></a>    </span>
<span id="cb562-93"><a href="simulace4.html#cb562-93" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb562-94"><a href="simulace4.html#cb562-94" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb562-95"><a href="simulace4.html#cb562-95" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb562-96"><a href="simulace4.html#cb562-96" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb562-97"><a href="simulace4.html#cb562-97" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb562-98"><a href="simulace4.html#cb562-98" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb562-99"><a href="simulace4.html#cb562-99" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb562-100"><a href="simulace4.html#cb562-100" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb562-101"><a href="simulace4.html#cb562-101" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb562-102"><a href="simulace4.html#cb562-102" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb562-103"><a href="simulace4.html#cb562-103" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb562-104"><a href="simulace4.html#cb562-104" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-105"><a href="simulace4.html#cb562-105" tabindex="-1"></a>      </span>
<span id="cb562-106"><a href="simulace4.html#cb562-106" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb562-107"><a href="simulace4.html#cb562-107" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb562-108"><a href="simulace4.html#cb562-108" tabindex="-1"></a>    }</span>
<span id="cb562-109"><a href="simulace4.html#cb562-109" tabindex="-1"></a>  }</span>
<span id="cb562-110"><a href="simulace4.html#cb562-110" tabindex="-1"></a>  </span>
<span id="cb562-111"><a href="simulace4.html#cb562-111" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb562-112"><a href="simulace4.html#cb562-112" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb562-113"><a href="simulace4.html#cb562-113" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb562-114"><a href="simulace4.html#cb562-114" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb562-115"><a href="simulace4.html#cb562-115" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb562-116"><a href="simulace4.html#cb562-116" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb562-117"><a href="simulace4.html#cb562-117" tabindex="-1"></a>  </span>
<span id="cb562-118"><a href="simulace4.html#cb562-118" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb562-119"><a href="simulace4.html#cb562-119" tabindex="-1"></a>  </span>
<span id="cb562-120"><a href="simulace4.html#cb562-120" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb562-121"><a href="simulace4.html#cb562-121" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb562-122"><a href="simulace4.html#cb562-122" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb562-123"><a href="simulace4.html#cb562-123" tabindex="-1"></a>  </span>
<span id="cb562-124"><a href="simulace4.html#cb562-124" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb562-125"><a href="simulace4.html#cb562-125" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb562-126"><a href="simulace4.html#cb562-126" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb562-127"><a href="simulace4.html#cb562-127" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb562-128"><a href="simulace4.html#cb562-128" tabindex="-1"></a>  </span>
<span id="cb562-129"><a href="simulace4.html#cb562-129" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb562-130"><a href="simulace4.html#cb562-130" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb562-131"><a href="simulace4.html#cb562-131" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb562-132"><a href="simulace4.html#cb562-132" tabindex="-1"></a>  </span>
<span id="cb562-133"><a href="simulace4.html#cb562-133" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb562-134"><a href="simulace4.html#cb562-134" tabindex="-1"></a>  </span>
<span id="cb562-135"><a href="simulace4.html#cb562-135" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb562-136"><a href="simulace4.html#cb562-136" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb562-137"><a href="simulace4.html#cb562-137" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb562-138"><a href="simulace4.html#cb562-138" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb562-139"><a href="simulace4.html#cb562-139" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb562-140"><a href="simulace4.html#cb562-140" tabindex="-1"></a>  </span>
<span id="cb562-141"><a href="simulace4.html#cb562-141" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb562-142"><a href="simulace4.html#cb562-142" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb562-143"><a href="simulace4.html#cb562-143" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb562-144"><a href="simulace4.html#cb562-144" tabindex="-1"></a>  </span>
<span id="cb562-145"><a href="simulace4.html#cb562-145" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb562-146"><a href="simulace4.html#cb562-146" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb562-147"><a href="simulace4.html#cb562-147" tabindex="-1"></a>  </span>
<span id="cb562-148"><a href="simulace4.html#cb562-148" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb562-149"><a href="simulace4.html#cb562-149" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb562-150"><a href="simulace4.html#cb562-150" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb562-151"><a href="simulace4.html#cb562-151" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb562-152"><a href="simulace4.html#cb562-152" tabindex="-1"></a>  }</span>
<span id="cb562-153"><a href="simulace4.html#cb562-153" tabindex="-1"></a>  </span>
<span id="cb562-154"><a href="simulace4.html#cb562-154" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb562-155"><a href="simulace4.html#cb562-155" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-156"><a href="simulace4.html#cb562-156" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb562-157"><a href="simulace4.html#cb562-157" tabindex="-1"></a>  </span>
<span id="cb562-158"><a href="simulace4.html#cb562-158" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb562-159"><a href="simulace4.html#cb562-159" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb562-160"><a href="simulace4.html#cb562-160" tabindex="-1"></a>  </span>
<span id="cb562-161"><a href="simulace4.html#cb562-161" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-162"><a href="simulace4.html#cb562-162" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-163"><a href="simulace4.html#cb562-163" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb562-164"><a href="simulace4.html#cb562-164" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-165"><a href="simulace4.html#cb562-165" tabindex="-1"></a>    </span>
<span id="cb562-166"><a href="simulace4.html#cb562-166" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-167"><a href="simulace4.html#cb562-167" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-168"><a href="simulace4.html#cb562-168" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb562-169"><a href="simulace4.html#cb562-169" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-170"><a href="simulace4.html#cb562-170" tabindex="-1"></a>  </span>
<span id="cb562-171"><a href="simulace4.html#cb562-171" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb562-172"><a href="simulace4.html#cb562-172" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-173"><a href="simulace4.html#cb562-173" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-174"><a href="simulace4.html#cb562-174" tabindex="-1"></a>  </span>
<span id="cb562-175"><a href="simulace4.html#cb562-175" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-176"><a href="simulace4.html#cb562-176" tabindex="-1"></a>  </span>
<span id="cb562-177"><a href="simulace4.html#cb562-177" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb562-178"><a href="simulace4.html#cb562-178" tabindex="-1"></a>  </span>
<span id="cb562-179"><a href="simulace4.html#cb562-179" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb562-180"><a href="simulace4.html#cb562-180" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb562-181"><a href="simulace4.html#cb562-181" tabindex="-1"></a>  </span>
<span id="cb562-182"><a href="simulace4.html#cb562-182" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-183"><a href="simulace4.html#cb562-183" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-184"><a href="simulace4.html#cb562-184" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb562-185"><a href="simulace4.html#cb562-185" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-186"><a href="simulace4.html#cb562-186" tabindex="-1"></a>    </span>
<span id="cb562-187"><a href="simulace4.html#cb562-187" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-188"><a href="simulace4.html#cb562-188" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-189"><a href="simulace4.html#cb562-189" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb562-190"><a href="simulace4.html#cb562-190" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-191"><a href="simulace4.html#cb562-191" tabindex="-1"></a>  </span>
<span id="cb562-192"><a href="simulace4.html#cb562-192" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb562-193"><a href="simulace4.html#cb562-193" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-194"><a href="simulace4.html#cb562-194" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-195"><a href="simulace4.html#cb562-195" tabindex="-1"></a>  </span>
<span id="cb562-196"><a href="simulace4.html#cb562-196" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-197"><a href="simulace4.html#cb562-197" tabindex="-1"></a>  </span>
<span id="cb562-198"><a href="simulace4.html#cb562-198" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb562-199"><a href="simulace4.html#cb562-199" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb562-200"><a href="simulace4.html#cb562-200" tabindex="-1"></a>  </span>
<span id="cb562-201"><a href="simulace4.html#cb562-201" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb562-202"><a href="simulace4.html#cb562-202" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb562-203"><a href="simulace4.html#cb562-203" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb562-204"><a href="simulace4.html#cb562-204" tabindex="-1"></a>  </span>
<span id="cb562-205"><a href="simulace4.html#cb562-205" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb562-206"><a href="simulace4.html#cb562-206" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb562-207"><a href="simulace4.html#cb562-207" tabindex="-1"></a>  </span>
<span id="cb562-208"><a href="simulace4.html#cb562-208" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb562-209"><a href="simulace4.html#cb562-209" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb562-210"><a href="simulace4.html#cb562-210" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb562-211"><a href="simulace4.html#cb562-211" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb562-212"><a href="simulace4.html#cb562-212" tabindex="-1"></a>  </span>
<span id="cb562-213"><a href="simulace4.html#cb562-213" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb562-214"><a href="simulace4.html#cb562-214" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb562-215"><a href="simulace4.html#cb562-215" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb562-216"><a href="simulace4.html#cb562-216" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb562-217"><a href="simulace4.html#cb562-217" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb562-218"><a href="simulace4.html#cb562-218" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-219"><a href="simulace4.html#cb562-219" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb562-220"><a href="simulace4.html#cb562-220" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb562-221"><a href="simulace4.html#cb562-221" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb562-222"><a href="simulace4.html#cb562-222" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb562-223"><a href="simulace4.html#cb562-223" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb562-224"><a href="simulace4.html#cb562-224" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb562-225"><a href="simulace4.html#cb562-225" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb562-226"><a href="simulace4.html#cb562-226" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb562-227"><a href="simulace4.html#cb562-227" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb562-228"><a href="simulace4.html#cb562-228" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb562-229"><a href="simulace4.html#cb562-229" tabindex="-1"></a>  </span>
<span id="cb562-230"><a href="simulace4.html#cb562-230" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb562-231"><a href="simulace4.html#cb562-231" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb562-232"><a href="simulace4.html#cb562-232" tabindex="-1"></a>  </span>
<span id="cb562-233"><a href="simulace4.html#cb562-233" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-234"><a href="simulace4.html#cb562-234" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb562-235"><a href="simulace4.html#cb562-235" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb562-236"><a href="simulace4.html#cb562-236" tabindex="-1"></a>      </span>
<span id="cb562-237"><a href="simulace4.html#cb562-237" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-238"><a href="simulace4.html#cb562-238" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb562-239"><a href="simulace4.html#cb562-239" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-240"><a href="simulace4.html#cb562-240" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb562-241"><a href="simulace4.html#cb562-241" tabindex="-1"></a>    </span>
<span id="cb562-242"><a href="simulace4.html#cb562-242" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-243"><a href="simulace4.html#cb562-243" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb562-244"><a href="simulace4.html#cb562-244" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb562-245"><a href="simulace4.html#cb562-245" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb562-246"><a href="simulace4.html#cb562-246" tabindex="-1"></a>    </span>
<span id="cb562-247"><a href="simulace4.html#cb562-247" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb562-248"><a href="simulace4.html#cb562-248" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb562-249"><a href="simulace4.html#cb562-249" tabindex="-1"></a>    </span>
<span id="cb562-250"><a href="simulace4.html#cb562-250" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb562-251"><a href="simulace4.html#cb562-251" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb562-252"><a href="simulace4.html#cb562-252" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb562-253"><a href="simulace4.html#cb562-253" tabindex="-1"></a>      </span>
<span id="cb562-254"><a href="simulace4.html#cb562-254" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb562-255"><a href="simulace4.html#cb562-255" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb562-256"><a href="simulace4.html#cb562-256" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb562-257"><a href="simulace4.html#cb562-257" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb562-258"><a href="simulace4.html#cb562-258" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb562-259"><a href="simulace4.html#cb562-259" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb562-260"><a href="simulace4.html#cb562-260" tabindex="-1"></a>      </span>
<span id="cb562-261"><a href="simulace4.html#cb562-261" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb562-262"><a href="simulace4.html#cb562-262" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb562-263"><a href="simulace4.html#cb562-263" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb562-264"><a href="simulace4.html#cb562-264" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb562-265"><a href="simulace4.html#cb562-265" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb562-266"><a href="simulace4.html#cb562-266" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-267"><a href="simulace4.html#cb562-267" tabindex="-1"></a>      </span>
<span id="cb562-268"><a href="simulace4.html#cb562-268" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb562-269"><a href="simulace4.html#cb562-269" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb562-270"><a href="simulace4.html#cb562-270" tabindex="-1"></a>    } </span>
<span id="cb562-271"><a href="simulace4.html#cb562-271" tabindex="-1"></a>  }</span>
<span id="cb562-272"><a href="simulace4.html#cb562-272" tabindex="-1"></a>  </span>
<span id="cb562-273"><a href="simulace4.html#cb562-273" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb562-274"><a href="simulace4.html#cb562-274" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb562-275"><a href="simulace4.html#cb562-275" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb562-276"><a href="simulace4.html#cb562-276" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb562-277"><a href="simulace4.html#cb562-277" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb562-278"><a href="simulace4.html#cb562-278" tabindex="-1"></a>  </span>
<span id="cb562-279"><a href="simulace4.html#cb562-279" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb562-280"><a href="simulace4.html#cb562-280" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb562-281"><a href="simulace4.html#cb562-281" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb562-282"><a href="simulace4.html#cb562-282" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb562-283"><a href="simulace4.html#cb562-283" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb562-284"><a href="simulace4.html#cb562-284" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb562-285"><a href="simulace4.html#cb562-285" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb562-286"><a href="simulace4.html#cb562-286" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb562-287"><a href="simulace4.html#cb562-287" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb562-288"><a href="simulace4.html#cb562-288" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb562-289"><a href="simulace4.html#cb562-289" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb562-290"><a href="simulace4.html#cb562-290" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb562-291"><a href="simulace4.html#cb562-291" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb562-292"><a href="simulace4.html#cb562-292" tabindex="-1"></a>  </span>
<span id="cb562-293"><a href="simulace4.html#cb562-293" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-294"><a href="simulace4.html#cb562-294" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb562-295"><a href="simulace4.html#cb562-295" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb562-296"><a href="simulace4.html#cb562-296" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb562-297"><a href="simulace4.html#cb562-297" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-298"><a href="simulace4.html#cb562-298" tabindex="-1"></a>    </span>
<span id="cb562-299"><a href="simulace4.html#cb562-299" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-300"><a href="simulace4.html#cb562-300" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb562-301"><a href="simulace4.html#cb562-301" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb562-302"><a href="simulace4.html#cb562-302" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb562-303"><a href="simulace4.html#cb562-303" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb562-304"><a href="simulace4.html#cb562-304" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-305"><a href="simulace4.html#cb562-305" tabindex="-1"></a>  </span>
<span id="cb562-306"><a href="simulace4.html#cb562-306" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb562-307"><a href="simulace4.html#cb562-307" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-308"><a href="simulace4.html#cb562-308" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-309"><a href="simulace4.html#cb562-309" tabindex="-1"></a>  </span>
<span id="cb562-310"><a href="simulace4.html#cb562-310" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-311"><a href="simulace4.html#cb562-311" tabindex="-1"></a>  </span>
<span id="cb562-312"><a href="simulace4.html#cb562-312" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb562-313"><a href="simulace4.html#cb562-313" tabindex="-1"></a>  </span>
<span id="cb562-314"><a href="simulace4.html#cb562-314" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb562-315"><a href="simulace4.html#cb562-315" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb562-316"><a href="simulace4.html#cb562-316" tabindex="-1"></a>  </span>
<span id="cb562-317"><a href="simulace4.html#cb562-317" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-318"><a href="simulace4.html#cb562-318" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb562-319"><a href="simulace4.html#cb562-319" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb562-320"><a href="simulace4.html#cb562-320" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-321"><a href="simulace4.html#cb562-321" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-322"><a href="simulace4.html#cb562-322" tabindex="-1"></a>    </span>
<span id="cb562-323"><a href="simulace4.html#cb562-323" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-324"><a href="simulace4.html#cb562-324" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb562-325"><a href="simulace4.html#cb562-325" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb562-326"><a href="simulace4.html#cb562-326" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-327"><a href="simulace4.html#cb562-327" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-328"><a href="simulace4.html#cb562-328" tabindex="-1"></a>  </span>
<span id="cb562-329"><a href="simulace4.html#cb562-329" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb562-330"><a href="simulace4.html#cb562-330" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-331"><a href="simulace4.html#cb562-331" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-332"><a href="simulace4.html#cb562-332" tabindex="-1"></a>  </span>
<span id="cb562-333"><a href="simulace4.html#cb562-333" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-334"><a href="simulace4.html#cb562-334" tabindex="-1"></a>  </span>
<span id="cb562-335"><a href="simulace4.html#cb562-335" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb562-336"><a href="simulace4.html#cb562-336" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb562-337"><a href="simulace4.html#cb562-337" tabindex="-1"></a>  </span>
<span id="cb562-338"><a href="simulace4.html#cb562-338" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb562-339"><a href="simulace4.html#cb562-339" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb562-340"><a href="simulace4.html#cb562-340" tabindex="-1"></a>     </span>
<span id="cb562-341"><a href="simulace4.html#cb562-341" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb562-342"><a href="simulace4.html#cb562-342" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb562-343"><a href="simulace4.html#cb562-343" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb562-344"><a href="simulace4.html#cb562-344" tabindex="-1"></a>  </span>
<span id="cb562-345"><a href="simulace4.html#cb562-345" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb562-346"><a href="simulace4.html#cb562-346" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb562-347"><a href="simulace4.html#cb562-347" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb562-348"><a href="simulace4.html#cb562-348" tabindex="-1"></a>  </span>
<span id="cb562-349"><a href="simulace4.html#cb562-349" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-350"><a href="simulace4.html#cb562-350" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb562-351"><a href="simulace4.html#cb562-351" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb562-352"><a href="simulace4.html#cb562-352" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb562-353"><a href="simulace4.html#cb562-353" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb562-354"><a href="simulace4.html#cb562-354" tabindex="-1"></a>  </span>
<span id="cb562-355"><a href="simulace4.html#cb562-355" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-356"><a href="simulace4.html#cb562-356" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb562-357"><a href="simulace4.html#cb562-357" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-358"><a href="simulace4.html#cb562-358" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-359"><a href="simulace4.html#cb562-359" tabindex="-1"></a>    </span>
<span id="cb562-360"><a href="simulace4.html#cb562-360" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-361"><a href="simulace4.html#cb562-361" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb562-362"><a href="simulace4.html#cb562-362" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-363"><a href="simulace4.html#cb562-363" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-364"><a href="simulace4.html#cb562-364" tabindex="-1"></a>  </span>
<span id="cb562-365"><a href="simulace4.html#cb562-365" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb562-366"><a href="simulace4.html#cb562-366" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-367"><a href="simulace4.html#cb562-367" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-368"><a href="simulace4.html#cb562-368" tabindex="-1"></a>  </span>
<span id="cb562-369"><a href="simulace4.html#cb562-369" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-370"><a href="simulace4.html#cb562-370" tabindex="-1"></a>  </span>
<span id="cb562-371"><a href="simulace4.html#cb562-371" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb562-372"><a href="simulace4.html#cb562-372" tabindex="-1"></a>  </span>
<span id="cb562-373"><a href="simulace4.html#cb562-373" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-374"><a href="simulace4.html#cb562-374" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb562-375"><a href="simulace4.html#cb562-375" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb562-376"><a href="simulace4.html#cb562-376" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb562-377"><a href="simulace4.html#cb562-377" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb562-378"><a href="simulace4.html#cb562-378" tabindex="-1"></a>  </span>
<span id="cb562-379"><a href="simulace4.html#cb562-379" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-380"><a href="simulace4.html#cb562-380" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-381"><a href="simulace4.html#cb562-381" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-382"><a href="simulace4.html#cb562-382" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-383"><a href="simulace4.html#cb562-383" tabindex="-1"></a>    </span>
<span id="cb562-384"><a href="simulace4.html#cb562-384" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-385"><a href="simulace4.html#cb562-385" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-386"><a href="simulace4.html#cb562-386" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-387"><a href="simulace4.html#cb562-387" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-388"><a href="simulace4.html#cb562-388" tabindex="-1"></a>  </span>
<span id="cb562-389"><a href="simulace4.html#cb562-389" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb562-390"><a href="simulace4.html#cb562-390" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-391"><a href="simulace4.html#cb562-391" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-392"><a href="simulace4.html#cb562-392" tabindex="-1"></a>  </span>
<span id="cb562-393"><a href="simulace4.html#cb562-393" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-394"><a href="simulace4.html#cb562-394" tabindex="-1"></a>  </span>
<span id="cb562-395"><a href="simulace4.html#cb562-395" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb562-396"><a href="simulace4.html#cb562-396" tabindex="-1"></a>  </span>
<span id="cb562-397"><a href="simulace4.html#cb562-397" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb562-398"><a href="simulace4.html#cb562-398" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb562-399"><a href="simulace4.html#cb562-399" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb562-400"><a href="simulace4.html#cb562-400" tabindex="-1"></a>  </span>
<span id="cb562-401"><a href="simulace4.html#cb562-401" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb562-402"><a href="simulace4.html#cb562-402" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb562-403"><a href="simulace4.html#cb562-403" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-404"><a href="simulace4.html#cb562-404" tabindex="-1"></a>  </span>
<span id="cb562-405"><a href="simulace4.html#cb562-405" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-406"><a href="simulace4.html#cb562-406" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb562-407"><a href="simulace4.html#cb562-407" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb562-408"><a href="simulace4.html#cb562-408" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb562-409"><a href="simulace4.html#cb562-409" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb562-410"><a href="simulace4.html#cb562-410" tabindex="-1"></a>  </span>
<span id="cb562-411"><a href="simulace4.html#cb562-411" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-412"><a href="simulace4.html#cb562-412" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb562-413"><a href="simulace4.html#cb562-413" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-414"><a href="simulace4.html#cb562-414" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-415"><a href="simulace4.html#cb562-415" tabindex="-1"></a>    </span>
<span id="cb562-416"><a href="simulace4.html#cb562-416" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-417"><a href="simulace4.html#cb562-417" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb562-418"><a href="simulace4.html#cb562-418" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-419"><a href="simulace4.html#cb562-419" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-420"><a href="simulace4.html#cb562-420" tabindex="-1"></a>  </span>
<span id="cb562-421"><a href="simulace4.html#cb562-421" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb562-422"><a href="simulace4.html#cb562-422" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-423"><a href="simulace4.html#cb562-423" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-424"><a href="simulace4.html#cb562-424" tabindex="-1"></a>  </span>
<span id="cb562-425"><a href="simulace4.html#cb562-425" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-426"><a href="simulace4.html#cb562-426" tabindex="-1"></a>  </span>
<span id="cb562-427"><a href="simulace4.html#cb562-427" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb562-428"><a href="simulace4.html#cb562-428" tabindex="-1"></a>  </span>
<span id="cb562-429"><a href="simulace4.html#cb562-429" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb562-430"><a href="simulace4.html#cb562-430" tabindex="-1"></a>  </span>
<span id="cb562-431"><a href="simulace4.html#cb562-431" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-432"><a href="simulace4.html#cb562-432" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb562-433"><a href="simulace4.html#cb562-433" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb562-434"><a href="simulace4.html#cb562-434" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-435"><a href="simulace4.html#cb562-435" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb562-436"><a href="simulace4.html#cb562-436" tabindex="-1"></a>  </span>
<span id="cb562-437"><a href="simulace4.html#cb562-437" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-438"><a href="simulace4.html#cb562-438" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb562-439"><a href="simulace4.html#cb562-439" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-440"><a href="simulace4.html#cb562-440" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-441"><a href="simulace4.html#cb562-441" tabindex="-1"></a>    </span>
<span id="cb562-442"><a href="simulace4.html#cb562-442" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-443"><a href="simulace4.html#cb562-443" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb562-444"><a href="simulace4.html#cb562-444" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-445"><a href="simulace4.html#cb562-445" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-446"><a href="simulace4.html#cb562-446" tabindex="-1"></a>  </span>
<span id="cb562-447"><a href="simulace4.html#cb562-447" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb562-448"><a href="simulace4.html#cb562-448" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-449"><a href="simulace4.html#cb562-449" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-450"><a href="simulace4.html#cb562-450" tabindex="-1"></a>  </span>
<span id="cb562-451"><a href="simulace4.html#cb562-451" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-452"><a href="simulace4.html#cb562-452" tabindex="-1"></a>  </span>
<span id="cb562-453"><a href="simulace4.html#cb562-453" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb562-454"><a href="simulace4.html#cb562-454" tabindex="-1"></a>  </span>
<span id="cb562-455"><a href="simulace4.html#cb562-455" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-456"><a href="simulace4.html#cb562-456" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb562-457"><a href="simulace4.html#cb562-457" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb562-458"><a href="simulace4.html#cb562-458" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-459"><a href="simulace4.html#cb562-459" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb562-460"><a href="simulace4.html#cb562-460" tabindex="-1"></a>  </span>
<span id="cb562-461"><a href="simulace4.html#cb562-461" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-462"><a href="simulace4.html#cb562-462" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-463"><a href="simulace4.html#cb562-463" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-464"><a href="simulace4.html#cb562-464" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-465"><a href="simulace4.html#cb562-465" tabindex="-1"></a>    </span>
<span id="cb562-466"><a href="simulace4.html#cb562-466" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-467"><a href="simulace4.html#cb562-467" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-468"><a href="simulace4.html#cb562-468" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-469"><a href="simulace4.html#cb562-469" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-470"><a href="simulace4.html#cb562-470" tabindex="-1"></a>  </span>
<span id="cb562-471"><a href="simulace4.html#cb562-471" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb562-472"><a href="simulace4.html#cb562-472" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-473"><a href="simulace4.html#cb562-473" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-474"><a href="simulace4.html#cb562-474" tabindex="-1"></a>  </span>
<span id="cb562-475"><a href="simulace4.html#cb562-475" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-476"><a href="simulace4.html#cb562-476" tabindex="-1"></a>  </span>
<span id="cb562-477"><a href="simulace4.html#cb562-477" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb562-478"><a href="simulace4.html#cb562-478" tabindex="-1"></a>  </span>
<span id="cb562-479"><a href="simulace4.html#cb562-479" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-480"><a href="simulace4.html#cb562-480" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb562-481"><a href="simulace4.html#cb562-481" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb562-482"><a href="simulace4.html#cb562-482" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-483"><a href="simulace4.html#cb562-483" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb562-484"><a href="simulace4.html#cb562-484" tabindex="-1"></a>  </span>
<span id="cb562-485"><a href="simulace4.html#cb562-485" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-486"><a href="simulace4.html#cb562-486" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb562-487"><a href="simulace4.html#cb562-487" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-488"><a href="simulace4.html#cb562-488" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-489"><a href="simulace4.html#cb562-489" tabindex="-1"></a>    </span>
<span id="cb562-490"><a href="simulace4.html#cb562-490" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-491"><a href="simulace4.html#cb562-491" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb562-492"><a href="simulace4.html#cb562-492" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-493"><a href="simulace4.html#cb562-493" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-494"><a href="simulace4.html#cb562-494" tabindex="-1"></a>  </span>
<span id="cb562-495"><a href="simulace4.html#cb562-495" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb562-496"><a href="simulace4.html#cb562-496" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb562-497"><a href="simulace4.html#cb562-497" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb562-498"><a href="simulace4.html#cb562-498" tabindex="-1"></a>  </span>
<span id="cb562-499"><a href="simulace4.html#cb562-499" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-500"><a href="simulace4.html#cb562-500" tabindex="-1"></a>  </span>
<span id="cb562-501"><a href="simulace4.html#cb562-501" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb562-502"><a href="simulace4.html#cb562-502" tabindex="-1"></a>  </span>
<span id="cb562-503"><a href="simulace4.html#cb562-503" tabindex="-1"></a>  <span class="co"># normovani dat</span></span>
<span id="cb562-504"><a href="simulace4.html#cb562-504" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb562-505"><a href="simulace4.html#cb562-505" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb562-506"><a href="simulace4.html#cb562-506" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb562-507"><a href="simulace4.html#cb562-507" tabindex="-1"></a>    }</span>
<span id="cb562-508"><a href="simulace4.html#cb562-508" tabindex="-1"></a>  XXfd_norm <span class="ot">&lt;-</span> XXder</span>
<span id="cb562-509"><a href="simulace4.html#cb562-509" tabindex="-1"></a>  XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb562-510"><a href="simulace4.html#cb562-510" tabindex="-1"></a>                                              <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb562-511"><a href="simulace4.html#cb562-511" tabindex="-1"></a>                                              <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb562-512"><a href="simulace4.html#cb562-512" tabindex="-1"></a>                                              <span class="at">byrow =</span> T)</span>
<span id="cb562-513"><a href="simulace4.html#cb562-513" tabindex="-1"></a>  </span>
<span id="cb562-514"><a href="simulace4.html#cb562-514" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb562-515"><a href="simulace4.html#cb562-515" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb562-516"><a href="simulace4.html#cb562-516" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb562-517"><a href="simulace4.html#cb562-517" tabindex="-1"></a>  </span>
<span id="cb562-518"><a href="simulace4.html#cb562-518" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb562-519"><a href="simulace4.html#cb562-519" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb562-520"><a href="simulace4.html#cb562-520" tabindex="-1"></a>  </span>
<span id="cb562-521"><a href="simulace4.html#cb562-521" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb562-522"><a href="simulace4.html#cb562-522" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb562-523"><a href="simulace4.html#cb562-523" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb562-524"><a href="simulace4.html#cb562-524" tabindex="-1"></a>  </span>
<span id="cb562-525"><a href="simulace4.html#cb562-525" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb562-526"><a href="simulace4.html#cb562-526" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb562-527"><a href="simulace4.html#cb562-527" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb562-528"><a href="simulace4.html#cb562-528" tabindex="-1"></a>  </span>
<span id="cb562-529"><a href="simulace4.html#cb562-529" tabindex="-1"></a>  <span class="do">### 7.0) SVM for functional data</span></span>
<span id="cb562-530"><a href="simulace4.html#cb562-530" tabindex="-1"></a>  </span>
<span id="cb562-531"><a href="simulace4.html#cb562-531" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb562-532"><a href="simulace4.html#cb562-532" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb562-533"><a href="simulace4.html#cb562-533" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb562-534"><a href="simulace4.html#cb562-534" tabindex="-1"></a>  </span>
<span id="cb562-535"><a href="simulace4.html#cb562-535" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb562-536"><a href="simulace4.html#cb562-536" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb562-537"><a href="simulace4.html#cb562-537" tabindex="-1"></a>  </span>
<span id="cb562-538"><a href="simulace4.html#cb562-538" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb562-539"><a href="simulace4.html#cb562-539" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb562-540"><a href="simulace4.html#cb562-540" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb562-541"><a href="simulace4.html#cb562-541" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb562-542"><a href="simulace4.html#cb562-542" tabindex="-1"></a>  </span>
<span id="cb562-543"><a href="simulace4.html#cb562-543" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb562-544"><a href="simulace4.html#cb562-544" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb562-545"><a href="simulace4.html#cb562-545" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb562-546"><a href="simulace4.html#cb562-546" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb562-547"><a href="simulace4.html#cb562-547" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb562-548"><a href="simulace4.html#cb562-548" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb562-549"><a href="simulace4.html#cb562-549" tabindex="-1"></a>  </span>
<span id="cb562-550"><a href="simulace4.html#cb562-550" tabindex="-1"></a>  model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb562-551"><a href="simulace4.html#cb562-551" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb562-552"><a href="simulace4.html#cb562-552" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb562-553"><a href="simulace4.html#cb562-553" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb562-554"><a href="simulace4.html#cb562-554" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-555"><a href="simulace4.html#cb562-555" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-556"><a href="simulace4.html#cb562-556" tabindex="-1"></a>              <span class="at">cost =</span> <span class="dv">10</span>)</span>
<span id="cb562-557"><a href="simulace4.html#cb562-557" tabindex="-1"></a>  </span>
<span id="cb562-558"><a href="simulace4.html#cb562-558" tabindex="-1"></a>  model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb562-559"><a href="simulace4.html#cb562-559" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb562-560"><a href="simulace4.html#cb562-560" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb562-561"><a href="simulace4.html#cb562-561" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb562-562"><a href="simulace4.html#cb562-562" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-563"><a href="simulace4.html#cb562-563" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-564"><a href="simulace4.html#cb562-564" tabindex="-1"></a>              <span class="at">degree =</span> <span class="dv">3</span>,</span>
<span id="cb562-565"><a href="simulace4.html#cb562-565" tabindex="-1"></a>              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-566"><a href="simulace4.html#cb562-566" tabindex="-1"></a>              <span class="at">cost =</span> <span class="dv">10</span>)</span>
<span id="cb562-567"><a href="simulace4.html#cb562-567" tabindex="-1"></a>  </span>
<span id="cb562-568"><a href="simulace4.html#cb562-568" tabindex="-1"></a>  model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb562-569"><a href="simulace4.html#cb562-569" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb562-570"><a href="simulace4.html#cb562-570" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb562-571"><a href="simulace4.html#cb562-571" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb562-572"><a href="simulace4.html#cb562-572" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-573"><a href="simulace4.html#cb562-573" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-574"><a href="simulace4.html#cb562-574" tabindex="-1"></a>              <span class="at">gamma =</span> <span class="fl">0.001</span>,</span>
<span id="cb562-575"><a href="simulace4.html#cb562-575" tabindex="-1"></a>              <span class="at">cost =</span> <span class="dv">100</span>)</span>
<span id="cb562-576"><a href="simulace4.html#cb562-576" tabindex="-1"></a>  </span>
<span id="cb562-577"><a href="simulace4.html#cb562-577" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-578"><a href="simulace4.html#cb562-578" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb562-579"><a href="simulace4.html#cb562-579" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-580"><a href="simulace4.html#cb562-580" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb562-581"><a href="simulace4.html#cb562-581" tabindex="-1"></a>  </span>
<span id="cb562-582"><a href="simulace4.html#cb562-582" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-583"><a href="simulace4.html#cb562-583" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb562-584"><a href="simulace4.html#cb562-584" tabindex="-1"></a>  </span>
<span id="cb562-585"><a href="simulace4.html#cb562-585" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-586"><a href="simulace4.html#cb562-586" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb562-587"><a href="simulace4.html#cb562-587" tabindex="-1"></a>    </span>
<span id="cb562-588"><a href="simulace4.html#cb562-588" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-589"><a href="simulace4.html#cb562-589" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb562-590"><a href="simulace4.html#cb562-590" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-591"><a href="simulace4.html#cb562-591" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb562-592"><a href="simulace4.html#cb562-592" tabindex="-1"></a>  </span>
<span id="cb562-593"><a href="simulace4.html#cb562-593" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-594"><a href="simulace4.html#cb562-594" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb562-595"><a href="simulace4.html#cb562-595" tabindex="-1"></a>  </span>
<span id="cb562-596"><a href="simulace4.html#cb562-596" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb562-597"><a href="simulace4.html#cb562-597" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span>
<span id="cb562-598"><a href="simulace4.html#cb562-598" tabindex="-1"></a>  </span>
<span id="cb562-599"><a href="simulace4.html#cb562-599" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb562-600"><a href="simulace4.html#cb562-600" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb562-601"><a href="simulace4.html#cb562-601" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb562-602"><a href="simulace4.html#cb562-602" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb562-603"><a href="simulace4.html#cb562-603" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb562-604"><a href="simulace4.html#cb562-604" tabindex="-1"></a>  </span>
<span id="cb562-605"><a href="simulace4.html#cb562-605" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-606"><a href="simulace4.html#cb562-606" tabindex="-1"></a>  </span>
<span id="cb562-607"><a href="simulace4.html#cb562-607" tabindex="-1"></a>  </span>
<span id="cb562-608"><a href="simulace4.html#cb562-608" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb562-609"><a href="simulace4.html#cb562-609" tabindex="-1"></a>  </span>
<span id="cb562-610"><a href="simulace4.html#cb562-610" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb562-611"><a href="simulace4.html#cb562-611" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-612"><a href="simulace4.html#cb562-612" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-613"><a href="simulace4.html#cb562-613" tabindex="-1"></a>                   <span class="at">cost =</span> <span class="dv">25</span>,</span>
<span id="cb562-614"><a href="simulace4.html#cb562-614" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb562-615"><a href="simulace4.html#cb562-615" tabindex="-1"></a>  </span>
<span id="cb562-616"><a href="simulace4.html#cb562-616" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb562-617"><a href="simulace4.html#cb562-617" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-618"><a href="simulace4.html#cb562-618" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-619"><a href="simulace4.html#cb562-619" tabindex="-1"></a>                   <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-620"><a href="simulace4.html#cb562-620" tabindex="-1"></a>                   <span class="at">cost =</span> <span class="fl">0.7</span>,</span>
<span id="cb562-621"><a href="simulace4.html#cb562-621" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb562-622"><a href="simulace4.html#cb562-622" tabindex="-1"></a>  </span>
<span id="cb562-623"><a href="simulace4.html#cb562-623" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb562-624"><a href="simulace4.html#cb562-624" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-625"><a href="simulace4.html#cb562-625" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-626"><a href="simulace4.html#cb562-626" tabindex="-1"></a>                   <span class="at">cost =</span> <span class="dv">55</span>,</span>
<span id="cb562-627"><a href="simulace4.html#cb562-627" tabindex="-1"></a>                   <span class="at">gamma =</span> <span class="fl">0.0005</span>,</span>
<span id="cb562-628"><a href="simulace4.html#cb562-628" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb562-629"><a href="simulace4.html#cb562-629" tabindex="-1"></a>  </span>
<span id="cb562-630"><a href="simulace4.html#cb562-630" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-631"><a href="simulace4.html#cb562-631" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb562-632"><a href="simulace4.html#cb562-632" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb562-633"><a href="simulace4.html#cb562-633" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-634"><a href="simulace4.html#cb562-634" tabindex="-1"></a>  </span>
<span id="cb562-635"><a href="simulace4.html#cb562-635" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb562-636"><a href="simulace4.html#cb562-636" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb562-637"><a href="simulace4.html#cb562-637" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-638"><a href="simulace4.html#cb562-638" tabindex="-1"></a>  </span>
<span id="cb562-639"><a href="simulace4.html#cb562-639" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb562-640"><a href="simulace4.html#cb562-640" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb562-641"><a href="simulace4.html#cb562-641" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-642"><a href="simulace4.html#cb562-642" tabindex="-1"></a>  </span>
<span id="cb562-643"><a href="simulace4.html#cb562-643" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-644"><a href="simulace4.html#cb562-644" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb562-645"><a href="simulace4.html#cb562-645" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb562-646"><a href="simulace4.html#cb562-646" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-647"><a href="simulace4.html#cb562-647" tabindex="-1"></a>  </span>
<span id="cb562-648"><a href="simulace4.html#cb562-648" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb562-649"><a href="simulace4.html#cb562-649" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb562-650"><a href="simulace4.html#cb562-650" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-651"><a href="simulace4.html#cb562-651" tabindex="-1"></a>  </span>
<span id="cb562-652"><a href="simulace4.html#cb562-652" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb562-653"><a href="simulace4.html#cb562-653" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb562-654"><a href="simulace4.html#cb562-654" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-655"><a href="simulace4.html#cb562-655" tabindex="-1"></a>  </span>
<span id="cb562-656"><a href="simulace4.html#cb562-656" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb562-657"><a href="simulace4.html#cb562-657" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb562-658"><a href="simulace4.html#cb562-658" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb562-659"><a href="simulace4.html#cb562-659" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb562-660"><a href="simulace4.html#cb562-660" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb562-661"><a href="simulace4.html#cb562-661" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb562-662"><a href="simulace4.html#cb562-662" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb562-663"><a href="simulace4.html#cb562-663" tabindex="-1"></a>  </span>
<span id="cb562-664"><a href="simulace4.html#cb562-664" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-665"><a href="simulace4.html#cb562-665" tabindex="-1"></a>  </span>
<span id="cb562-666"><a href="simulace4.html#cb562-666" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb562-667"><a href="simulace4.html#cb562-667" tabindex="-1"></a>  </span>
<span id="cb562-668"><a href="simulace4.html#cb562-668" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-669"><a href="simulace4.html#cb562-669" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb562-670"><a href="simulace4.html#cb562-670" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-671"><a href="simulace4.html#cb562-671" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-672"><a href="simulace4.html#cb562-672" tabindex="-1"></a>                       <span class="at">cost =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-673"><a href="simulace4.html#cb562-673" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb562-674"><a href="simulace4.html#cb562-674" tabindex="-1"></a>  </span>
<span id="cb562-675"><a href="simulace4.html#cb562-675" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb562-676"><a href="simulace4.html#cb562-676" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-677"><a href="simulace4.html#cb562-677" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-678"><a href="simulace4.html#cb562-678" tabindex="-1"></a>                       <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-679"><a href="simulace4.html#cb562-679" tabindex="-1"></a>                       <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb562-680"><a href="simulace4.html#cb562-680" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb562-681"><a href="simulace4.html#cb562-681" tabindex="-1"></a>  </span>
<span id="cb562-682"><a href="simulace4.html#cb562-682" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb562-683"><a href="simulace4.html#cb562-683" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-684"><a href="simulace4.html#cb562-684" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-685"><a href="simulace4.html#cb562-685" tabindex="-1"></a>                       <span class="at">cost =</span> <span class="dv">1</span>,</span>
<span id="cb562-686"><a href="simulace4.html#cb562-686" tabindex="-1"></a>                       <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb562-687"><a href="simulace4.html#cb562-687" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb562-688"><a href="simulace4.html#cb562-688" tabindex="-1"></a>  </span>
<span id="cb562-689"><a href="simulace4.html#cb562-689" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-690"><a href="simulace4.html#cb562-690" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-691"><a href="simulace4.html#cb562-691" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb562-692"><a href="simulace4.html#cb562-692" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-693"><a href="simulace4.html#cb562-693" tabindex="-1"></a>  </span>
<span id="cb562-694"><a href="simulace4.html#cb562-694" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-695"><a href="simulace4.html#cb562-695" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb562-696"><a href="simulace4.html#cb562-696" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-697"><a href="simulace4.html#cb562-697" tabindex="-1"></a>  </span>
<span id="cb562-698"><a href="simulace4.html#cb562-698" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb562-699"><a href="simulace4.html#cb562-699" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb562-700"><a href="simulace4.html#cb562-700" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-701"><a href="simulace4.html#cb562-701" tabindex="-1"></a>    </span>
<span id="cb562-702"><a href="simulace4.html#cb562-702" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-703"><a href="simulace4.html#cb562-703" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-704"><a href="simulace4.html#cb562-704" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb562-705"><a href="simulace4.html#cb562-705" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-706"><a href="simulace4.html#cb562-706" tabindex="-1"></a>  </span>
<span id="cb562-707"><a href="simulace4.html#cb562-707" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-708"><a href="simulace4.html#cb562-708" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb562-709"><a href="simulace4.html#cb562-709" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-710"><a href="simulace4.html#cb562-710" tabindex="-1"></a>  </span>
<span id="cb562-711"><a href="simulace4.html#cb562-711" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb562-712"><a href="simulace4.html#cb562-712" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb562-713"><a href="simulace4.html#cb562-713" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-714"><a href="simulace4.html#cb562-714" tabindex="-1"></a>  </span>
<span id="cb562-715"><a href="simulace4.html#cb562-715" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb562-716"><a href="simulace4.html#cb562-716" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb562-717"><a href="simulace4.html#cb562-717" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb562-718"><a href="simulace4.html#cb562-718" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb562-719"><a href="simulace4.html#cb562-719" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb562-720"><a href="simulace4.html#cb562-720" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb562-721"><a href="simulace4.html#cb562-721" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb562-722"><a href="simulace4.html#cb562-722" tabindex="-1"></a>  </span>
<span id="cb562-723"><a href="simulace4.html#cb562-723" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-724"><a href="simulace4.html#cb562-724" tabindex="-1"></a>  </span>
<span id="cb562-725"><a href="simulace4.html#cb562-725" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb562-726"><a href="simulace4.html#cb562-726" tabindex="-1"></a>  </span>
<span id="cb562-727"><a href="simulace4.html#cb562-727" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-728"><a href="simulace4.html#cb562-728" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb562-729"><a href="simulace4.html#cb562-729" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-730"><a href="simulace4.html#cb562-730" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-731"><a href="simulace4.html#cb562-731" tabindex="-1"></a>                          <span class="at">cost =</span> <span class="dv">50</span>,</span>
<span id="cb562-732"><a href="simulace4.html#cb562-732" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb562-733"><a href="simulace4.html#cb562-733" tabindex="-1"></a>  </span>
<span id="cb562-734"><a href="simulace4.html#cb562-734" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb562-735"><a href="simulace4.html#cb562-735" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-736"><a href="simulace4.html#cb562-736" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-737"><a href="simulace4.html#cb562-737" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-738"><a href="simulace4.html#cb562-738" tabindex="-1"></a>                          <span class="at">cost =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-739"><a href="simulace4.html#cb562-739" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb562-740"><a href="simulace4.html#cb562-740" tabindex="-1"></a>  </span>
<span id="cb562-741"><a href="simulace4.html#cb562-741" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb562-742"><a href="simulace4.html#cb562-742" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-743"><a href="simulace4.html#cb562-743" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-744"><a href="simulace4.html#cb562-744" tabindex="-1"></a>                          <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb562-745"><a href="simulace4.html#cb562-745" tabindex="-1"></a>                          <span class="at">gamma =</span> <span class="fl">0.001</span>,</span>
<span id="cb562-746"><a href="simulace4.html#cb562-746" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb562-747"><a href="simulace4.html#cb562-747" tabindex="-1"></a>    </span>
<span id="cb562-748"><a href="simulace4.html#cb562-748" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-749"><a href="simulace4.html#cb562-749" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb562-750"><a href="simulace4.html#cb562-750" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb562-751"><a href="simulace4.html#cb562-751" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-752"><a href="simulace4.html#cb562-752" tabindex="-1"></a>  </span>
<span id="cb562-753"><a href="simulace4.html#cb562-753" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb562-754"><a href="simulace4.html#cb562-754" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb562-755"><a href="simulace4.html#cb562-755" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-756"><a href="simulace4.html#cb562-756" tabindex="-1"></a>  </span>
<span id="cb562-757"><a href="simulace4.html#cb562-757" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb562-758"><a href="simulace4.html#cb562-758" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb562-759"><a href="simulace4.html#cb562-759" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-760"><a href="simulace4.html#cb562-760" tabindex="-1"></a>    </span>
<span id="cb562-761"><a href="simulace4.html#cb562-761" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-762"><a href="simulace4.html#cb562-762" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb562-763"><a href="simulace4.html#cb562-763" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb562-764"><a href="simulace4.html#cb562-764" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-765"><a href="simulace4.html#cb562-765" tabindex="-1"></a>  </span>
<span id="cb562-766"><a href="simulace4.html#cb562-766" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb562-767"><a href="simulace4.html#cb562-767" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb562-768"><a href="simulace4.html#cb562-768" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-769"><a href="simulace4.html#cb562-769" tabindex="-1"></a>  </span>
<span id="cb562-770"><a href="simulace4.html#cb562-770" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb562-771"><a href="simulace4.html#cb562-771" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb562-772"><a href="simulace4.html#cb562-772" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-773"><a href="simulace4.html#cb562-773" tabindex="-1"></a>  </span>
<span id="cb562-774"><a href="simulace4.html#cb562-774" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb562-775"><a href="simulace4.html#cb562-775" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb562-776"><a href="simulace4.html#cb562-776" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb562-777"><a href="simulace4.html#cb562-777" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb562-778"><a href="simulace4.html#cb562-778" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb562-779"><a href="simulace4.html#cb562-779" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb562-780"><a href="simulace4.html#cb562-780" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb562-781"><a href="simulace4.html#cb562-781" tabindex="-1"></a></span>
<span id="cb562-782"><a href="simulace4.html#cb562-782" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-783"><a href="simulace4.html#cb562-783" tabindex="-1"></a>  </span>
<span id="cb562-784"><a href="simulace4.html#cb562-784" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb562-785"><a href="simulace4.html#cb562-785" tabindex="-1"></a>  </span>
<span id="cb562-786"><a href="simulace4.html#cb562-786" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb562-787"><a href="simulace4.html#cb562-787" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb562-788"><a href="simulace4.html#cb562-788" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb562-789"><a href="simulace4.html#cb562-789" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb562-790"><a href="simulace4.html#cb562-790" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co">#length(t) + norder - 2 - 10</span></span>
<span id="cb562-791"><a href="simulace4.html#cb562-791" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb562-792"><a href="simulace4.html#cb562-792" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-793"><a href="simulace4.html#cb562-793" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb562-794"><a href="simulace4.html#cb562-794" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb562-795"><a href="simulace4.html#cb562-795" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb562-796"><a href="simulace4.html#cb562-796" tabindex="-1"></a>  </span>
<span id="cb562-797"><a href="simulace4.html#cb562-797" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb562-798"><a href="simulace4.html#cb562-798" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb562-799"><a href="simulace4.html#cb562-799" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb562-800"><a href="simulace4.html#cb562-800" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb562-801"><a href="simulace4.html#cb562-801" tabindex="-1"></a>                                  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), </span>
<span id="cb562-802"><a href="simulace4.html#cb562-802" tabindex="-1"></a>                                <span class="at">argvals =</span> t.seq, <span class="at">basisobj =</span> bbasis)</span>
<span id="cb562-803"><a href="simulace4.html#cb562-803" tabindex="-1"></a>    </span>
<span id="cb562-804"><a href="simulace4.html#cb562-804" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data v ramci CV</span></span>
<span id="cb562-805"><a href="simulace4.html#cb562-805" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection) </span>
<span id="cb562-806"><a href="simulace4.html#cb562-806" tabindex="-1"></a>  </span>
<span id="cb562-807"><a href="simulace4.html#cb562-807" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-808"><a href="simulace4.html#cb562-808" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb562-809"><a href="simulace4.html#cb562-809" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb562-810"><a href="simulace4.html#cb562-810" tabindex="-1"></a>      </span>
<span id="cb562-811"><a href="simulace4.html#cb562-811" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb562-812"><a href="simulace4.html#cb562-812" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb562-813"><a href="simulace4.html#cb562-813" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb562-814"><a href="simulace4.html#cb562-814" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb562-815"><a href="simulace4.html#cb562-815" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb562-816"><a href="simulace4.html#cb562-816" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-817"><a href="simulace4.html#cb562-817" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb562-818"><a href="simulace4.html#cb562-818" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-819"><a href="simulace4.html#cb562-819" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-820"><a href="simulace4.html#cb562-820" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb562-821"><a href="simulace4.html#cb562-821" tabindex="-1"></a>      </span>
<span id="cb562-822"><a href="simulace4.html#cb562-822" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb562-823"><a href="simulace4.html#cb562-823" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-824"><a href="simulace4.html#cb562-824" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-825"><a href="simulace4.html#cb562-825" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-826"><a href="simulace4.html#cb562-826" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb562-827"><a href="simulace4.html#cb562-827" tabindex="-1"></a>      </span>
<span id="cb562-828"><a href="simulace4.html#cb562-828" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb562-829"><a href="simulace4.html#cb562-829" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-830"><a href="simulace4.html#cb562-830" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-831"><a href="simulace4.html#cb562-831" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb562-832"><a href="simulace4.html#cb562-832" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb562-833"><a href="simulace4.html#cb562-833" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb562-834"><a href="simulace4.html#cb562-834" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb562-835"><a href="simulace4.html#cb562-835" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb562-836"><a href="simulace4.html#cb562-836" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb562-837"><a href="simulace4.html#cb562-837" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-838"><a href="simulace4.html#cb562-838" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb562-839"><a href="simulace4.html#cb562-839" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb562-840"><a href="simulace4.html#cb562-840" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb562-841"><a href="simulace4.html#cb562-841" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb562-842"><a href="simulace4.html#cb562-842" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-843"><a href="simulace4.html#cb562-843" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb562-844"><a href="simulace4.html#cb562-844" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb562-845"><a href="simulace4.html#cb562-845" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb562-846"><a href="simulace4.html#cb562-846" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb562-847"><a href="simulace4.html#cb562-847" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-848"><a href="simulace4.html#cb562-848" tabindex="-1"></a>      </span>
<span id="cb562-849"><a href="simulace4.html#cb562-849" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb562-850"><a href="simulace4.html#cb562-850" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb562-851"><a href="simulace4.html#cb562-851" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb562-852"><a href="simulace4.html#cb562-852" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb562-853"><a href="simulace4.html#cb562-853" tabindex="-1"></a>    }</span>
<span id="cb562-854"><a href="simulace4.html#cb562-854" tabindex="-1"></a>  }</span>
<span id="cb562-855"><a href="simulace4.html#cb562-855" tabindex="-1"></a>  </span>
<span id="cb562-856"><a href="simulace4.html#cb562-856" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb562-857"><a href="simulace4.html#cb562-857" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb562-858"><a href="simulace4.html#cb562-858" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb562-859"><a href="simulace4.html#cb562-859" tabindex="-1"></a>  }</span>
<span id="cb562-860"><a href="simulace4.html#cb562-860" tabindex="-1"></a>  </span>
<span id="cb562-861"><a href="simulace4.html#cb562-861" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb562-862"><a href="simulace4.html#cb562-862" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb562-863"><a href="simulace4.html#cb562-863" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb562-864"><a href="simulace4.html#cb562-864" tabindex="-1"></a>  </span>
<span id="cb562-865"><a href="simulace4.html#cb562-865" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb562-866"><a href="simulace4.html#cb562-866" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb562-867"><a href="simulace4.html#cb562-867" tabindex="-1"></a>  </span>
<span id="cb562-868"><a href="simulace4.html#cb562-868" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-869"><a href="simulace4.html#cb562-869" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb562-870"><a href="simulace4.html#cb562-870" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb562-871"><a href="simulace4.html#cb562-871" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb562-872"><a href="simulace4.html#cb562-872" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb562-873"><a href="simulace4.html#cb562-873" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-874"><a href="simulace4.html#cb562-874" tabindex="-1"></a>  </span>
<span id="cb562-875"><a href="simulace4.html#cb562-875" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-876"><a href="simulace4.html#cb562-876" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-877"><a href="simulace4.html#cb562-877" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb562-878"><a href="simulace4.html#cb562-878" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb562-879"><a href="simulace4.html#cb562-879" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> <span class="fu">rbind</span>(</span>
<span id="cb562-880"><a href="simulace4.html#cb562-880" tabindex="-1"></a>      grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)),</span>
<span id="cb562-881"><a href="simulace4.html#cb562-881" tabindex="-1"></a>      grid.data.test <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb562-882"><a href="simulace4.html#cb562-882" tabindex="-1"></a>        <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">argvals =</span> t.seq, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb562-883"><a href="simulace4.html#cb562-883" tabindex="-1"></a></span>
<span id="cb562-884"><a href="simulace4.html#cb562-884" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), ]</span>
<span id="cb562-885"><a href="simulace4.html#cb562-885" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[(<span class="fu">sum</span>(split) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(split), ]</span>
<span id="cb562-886"><a href="simulace4.html#cb562-886" tabindex="-1"></a>    </span>
<span id="cb562-887"><a href="simulace4.html#cb562-887" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb562-888"><a href="simulace4.html#cb562-888" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb562-889"><a href="simulace4.html#cb562-889" tabindex="-1"></a>    </span>
<span id="cb562-890"><a href="simulace4.html#cb562-890" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb562-891"><a href="simulace4.html#cb562-891" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-892"><a href="simulace4.html#cb562-892" tabindex="-1"></a>    </span>
<span id="cb562-893"><a href="simulace4.html#cb562-893" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-894"><a href="simulace4.html#cb562-894" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb562-895"><a href="simulace4.html#cb562-895" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-896"><a href="simulace4.html#cb562-896" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-897"><a href="simulace4.html#cb562-897" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-898"><a href="simulace4.html#cb562-898" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-899"><a href="simulace4.html#cb562-899" tabindex="-1"></a>    </span>
<span id="cb562-900"><a href="simulace4.html#cb562-900" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-901"><a href="simulace4.html#cb562-901" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb562-902"><a href="simulace4.html#cb562-902" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-903"><a href="simulace4.html#cb562-903" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-904"><a href="simulace4.html#cb562-904" tabindex="-1"></a>      </span>
<span id="cb562-905"><a href="simulace4.html#cb562-905" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-906"><a href="simulace4.html#cb562-906" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb562-907"><a href="simulace4.html#cb562-907" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-908"><a href="simulace4.html#cb562-908" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-909"><a href="simulace4.html#cb562-909" tabindex="-1"></a>    </span>
<span id="cb562-910"><a href="simulace4.html#cb562-910" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-911"><a href="simulace4.html#cb562-911" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb562-912"><a href="simulace4.html#cb562-912" tabindex="-1"></a>  }</span>
<span id="cb562-913"><a href="simulace4.html#cb562-913" tabindex="-1"></a>  </span>
<span id="cb562-914"><a href="simulace4.html#cb562-914" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-915"><a href="simulace4.html#cb562-915" tabindex="-1"></a>  </span>
<span id="cb562-916"><a href="simulace4.html#cb562-916" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb562-917"><a href="simulace4.html#cb562-917" tabindex="-1"></a>  </span>
<span id="cb562-918"><a href="simulace4.html#cb562-918" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb562-919"><a href="simulace4.html#cb562-919" tabindex="-1"></a>  </span>
<span id="cb562-920"><a href="simulace4.html#cb562-920" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb562-921"><a href="simulace4.html#cb562-921" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb562-922"><a href="simulace4.html#cb562-922" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb562-923"><a href="simulace4.html#cb562-923" tabindex="-1"></a>  }</span>
<span id="cb562-924"><a href="simulace4.html#cb562-924" tabindex="-1"></a>  </span>
<span id="cb562-925"><a href="simulace4.html#cb562-925" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb562-926"><a href="simulace4.html#cb562-926" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb562-927"><a href="simulace4.html#cb562-927" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb562-928"><a href="simulace4.html#cb562-928" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb562-929"><a href="simulace4.html#cb562-929" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb562-930"><a href="simulace4.html#cb562-930" tabindex="-1"></a>      }</span>
<span id="cb562-931"><a href="simulace4.html#cb562-931" tabindex="-1"></a>    }</span>
<span id="cb562-932"><a href="simulace4.html#cb562-932" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb562-933"><a href="simulace4.html#cb562-933" tabindex="-1"></a>  }</span>
<span id="cb562-934"><a href="simulace4.html#cb562-934" tabindex="-1"></a>  </span>
<span id="cb562-935"><a href="simulace4.html#cb562-935" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb562-936"><a href="simulace4.html#cb562-936" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-937"><a href="simulace4.html#cb562-937" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-938"><a href="simulace4.html#cb562-938" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-939"><a href="simulace4.html#cb562-939" tabindex="-1"></a>  </span>
<span id="cb562-940"><a href="simulace4.html#cb562-940" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb562-941"><a href="simulace4.html#cb562-941" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb562-942"><a href="simulace4.html#cb562-942" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb562-943"><a href="simulace4.html#cb562-943" tabindex="-1"></a>  </span>
<span id="cb562-944"><a href="simulace4.html#cb562-944" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb562-945"><a href="simulace4.html#cb562-945" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb562-946"><a href="simulace4.html#cb562-946" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb562-947"><a href="simulace4.html#cb562-947" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb562-948"><a href="simulace4.html#cb562-948" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb562-949"><a href="simulace4.html#cb562-949" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb562-950"><a href="simulace4.html#cb562-950" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb562-951"><a href="simulace4.html#cb562-951" tabindex="-1"></a>  </span>
<span id="cb562-952"><a href="simulace4.html#cb562-952" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb562-953"><a href="simulace4.html#cb562-953" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-954"><a href="simulace4.html#cb562-954" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-955"><a href="simulace4.html#cb562-955" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-956"><a href="simulace4.html#cb562-956" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-957"><a href="simulace4.html#cb562-957" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-958"><a href="simulace4.html#cb562-958" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb562-959"><a href="simulace4.html#cb562-959" tabindex="-1"></a>  </span>
<span id="cb562-960"><a href="simulace4.html#cb562-960" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb562-961"><a href="simulace4.html#cb562-961" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb562-962"><a href="simulace4.html#cb562-962" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb562-963"><a href="simulace4.html#cb562-963" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-964"><a href="simulace4.html#cb562-964" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-965"><a href="simulace4.html#cb562-965" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-966"><a href="simulace4.html#cb562-966" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb562-967"><a href="simulace4.html#cb562-967" tabindex="-1"></a>    </span>
<span id="cb562-968"><a href="simulace4.html#cb562-968" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb562-969"><a href="simulace4.html#cb562-969" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-970"><a href="simulace4.html#cb562-970" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-971"><a href="simulace4.html#cb562-971" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-972"><a href="simulace4.html#cb562-972" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-973"><a href="simulace4.html#cb562-973" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb562-974"><a href="simulace4.html#cb562-974" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-975"><a href="simulace4.html#cb562-975" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-976"><a href="simulace4.html#cb562-976" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb562-977"><a href="simulace4.html#cb562-977" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb562-978"><a href="simulace4.html#cb562-978" tabindex="-1"></a>    }</span>
<span id="cb562-979"><a href="simulace4.html#cb562-979" tabindex="-1"></a>    </span>
<span id="cb562-980"><a href="simulace4.html#cb562-980" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb562-981"><a href="simulace4.html#cb562-981" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb562-982"><a href="simulace4.html#cb562-982" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-983"><a href="simulace4.html#cb562-983" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-984"><a href="simulace4.html#cb562-984" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb562-985"><a href="simulace4.html#cb562-985" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-986"><a href="simulace4.html#cb562-986" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-987"><a href="simulace4.html#cb562-987" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb562-988"><a href="simulace4.html#cb562-988" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-989"><a href="simulace4.html#cb562-989" tabindex="-1"></a>      }</span>
<span id="cb562-990"><a href="simulace4.html#cb562-990" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb562-991"><a href="simulace4.html#cb562-991" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-992"><a href="simulace4.html#cb562-992" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb562-993"><a href="simulace4.html#cb562-993" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb562-994"><a href="simulace4.html#cb562-994" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb562-995"><a href="simulace4.html#cb562-995" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb562-996"><a href="simulace4.html#cb562-996" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb562-997"><a href="simulace4.html#cb562-997" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-998"><a href="simulace4.html#cb562-998" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb562-999"><a href="simulace4.html#cb562-999" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb562-1000"><a href="simulace4.html#cb562-1000" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb562-1001"><a href="simulace4.html#cb562-1001" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1002"><a href="simulace4.html#cb562-1002" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1003"><a href="simulace4.html#cb562-1003" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1004"><a href="simulace4.html#cb562-1004" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1005"><a href="simulace4.html#cb562-1005" tabindex="-1"></a>        </span>
<span id="cb562-1006"><a href="simulace4.html#cb562-1006" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1007"><a href="simulace4.html#cb562-1007" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb562-1008"><a href="simulace4.html#cb562-1008" tabindex="-1"></a>          </span>
<span id="cb562-1009"><a href="simulace4.html#cb562-1009" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1010"><a href="simulace4.html#cb562-1010" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb562-1011"><a href="simulace4.html#cb562-1011" tabindex="-1"></a>          </span>
<span id="cb562-1012"><a href="simulace4.html#cb562-1012" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1013"><a href="simulace4.html#cb562-1013" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1014"><a href="simulace4.html#cb562-1014" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1015"><a href="simulace4.html#cb562-1015" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1016"><a href="simulace4.html#cb562-1016" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1017"><a href="simulace4.html#cb562-1017" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1018"><a href="simulace4.html#cb562-1018" tabindex="-1"></a>          </span>
<span id="cb562-1019"><a href="simulace4.html#cb562-1019" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb562-1020"><a href="simulace4.html#cb562-1020" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1021"><a href="simulace4.html#cb562-1021" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1022"><a href="simulace4.html#cb562-1022" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1023"><a href="simulace4.html#cb562-1023" tabindex="-1"></a>          </span>
<span id="cb562-1024"><a href="simulace4.html#cb562-1024" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1025"><a href="simulace4.html#cb562-1025" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb562-1026"><a href="simulace4.html#cb562-1026" tabindex="-1"></a>        }</span>
<span id="cb562-1027"><a href="simulace4.html#cb562-1027" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb562-1028"><a href="simulace4.html#cb562-1028" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb562-1029"><a href="simulace4.html#cb562-1029" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1030"><a href="simulace4.html#cb562-1030" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb562-1031"><a href="simulace4.html#cb562-1031" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb562-1032"><a href="simulace4.html#cb562-1032" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1033"><a href="simulace4.html#cb562-1033" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb562-1034"><a href="simulace4.html#cb562-1034" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb562-1035"><a href="simulace4.html#cb562-1035" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1036"><a href="simulace4.html#cb562-1036" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb562-1037"><a href="simulace4.html#cb562-1037" tabindex="-1"></a>      }</span>
<span id="cb562-1038"><a href="simulace4.html#cb562-1038" tabindex="-1"></a>    }</span>
<span id="cb562-1039"><a href="simulace4.html#cb562-1039" tabindex="-1"></a>  }</span>
<span id="cb562-1040"><a href="simulace4.html#cb562-1040" tabindex="-1"></a>  </span>
<span id="cb562-1041"><a href="simulace4.html#cb562-1041" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb562-1042"><a href="simulace4.html#cb562-1042" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb562-1043"><a href="simulace4.html#cb562-1043" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb562-1044"><a href="simulace4.html#cb562-1044" tabindex="-1"></a>  }</span>
<span id="cb562-1045"><a href="simulace4.html#cb562-1045" tabindex="-1"></a>  </span>
<span id="cb562-1046"><a href="simulace4.html#cb562-1046" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb562-1047"><a href="simulace4.html#cb562-1047" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb562-1048"><a href="simulace4.html#cb562-1048" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb562-1049"><a href="simulace4.html#cb562-1049" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb562-1050"><a href="simulace4.html#cb562-1050" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb562-1051"><a href="simulace4.html#cb562-1051" tabindex="-1"></a>  </span>
<span id="cb562-1052"><a href="simulace4.html#cb562-1052" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1053"><a href="simulace4.html#cb562-1053" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1054"><a href="simulace4.html#cb562-1054" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb562-1055"><a href="simulace4.html#cb562-1055" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb562-1056"><a href="simulace4.html#cb562-1056" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb562-1057"><a href="simulace4.html#cb562-1057" tabindex="-1"></a>  </span>
<span id="cb562-1058"><a href="simulace4.html#cb562-1058" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb562-1059"><a href="simulace4.html#cb562-1059" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb562-1060"><a href="simulace4.html#cb562-1060" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb562-1061"><a href="simulace4.html#cb562-1061" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb562-1062"><a href="simulace4.html#cb562-1062" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb562-1063"><a href="simulace4.html#cb562-1063" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb562-1064"><a href="simulace4.html#cb562-1064" tabindex="-1"></a>  </span>
<span id="cb562-1065"><a href="simulace4.html#cb562-1065" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb562-1066"><a href="simulace4.html#cb562-1066" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb562-1067"><a href="simulace4.html#cb562-1067" tabindex="-1"></a>  </span>
<span id="cb562-1068"><a href="simulace4.html#cb562-1068" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-1069"><a href="simulace4.html#cb562-1069" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-1070"><a href="simulace4.html#cb562-1070" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb562-1071"><a href="simulace4.html#cb562-1071" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb562-1072"><a href="simulace4.html#cb562-1072" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-1073"><a href="simulace4.html#cb562-1073" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb562-1074"><a href="simulace4.html#cb562-1074" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb562-1075"><a href="simulace4.html#cb562-1075" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb562-1076"><a href="simulace4.html#cb562-1076" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb562-1077"><a href="simulace4.html#cb562-1077" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1078"><a href="simulace4.html#cb562-1078" tabindex="-1"></a>  </span>
<span id="cb562-1079"><a href="simulace4.html#cb562-1079" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1080"><a href="simulace4.html#cb562-1080" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1081"><a href="simulace4.html#cb562-1081" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb562-1082"><a href="simulace4.html#cb562-1082" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb562-1083"><a href="simulace4.html#cb562-1083" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb562-1084"><a href="simulace4.html#cb562-1084" tabindex="-1"></a>    </span>
<span id="cb562-1085"><a href="simulace4.html#cb562-1085" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb562-1086"><a href="simulace4.html#cb562-1086" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-1087"><a href="simulace4.html#cb562-1087" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-1088"><a href="simulace4.html#cb562-1088" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-1089"><a href="simulace4.html#cb562-1089" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb562-1090"><a href="simulace4.html#cb562-1090" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb562-1091"><a href="simulace4.html#cb562-1091" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb562-1092"><a href="simulace4.html#cb562-1092" tabindex="-1"></a>    </span>
<span id="cb562-1093"><a href="simulace4.html#cb562-1093" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb562-1094"><a href="simulace4.html#cb562-1094" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1095"><a href="simulace4.html#cb562-1095" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-1096"><a href="simulace4.html#cb562-1096" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-1097"><a href="simulace4.html#cb562-1097" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-1098"><a href="simulace4.html#cb562-1098" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb562-1099"><a href="simulace4.html#cb562-1099" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-1100"><a href="simulace4.html#cb562-1100" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-1101"><a href="simulace4.html#cb562-1101" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb562-1102"><a href="simulace4.html#cb562-1102" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb562-1103"><a href="simulace4.html#cb562-1103" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb562-1104"><a href="simulace4.html#cb562-1104" tabindex="-1"></a>    }</span>
<span id="cb562-1105"><a href="simulace4.html#cb562-1105" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb562-1106"><a href="simulace4.html#cb562-1106" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb562-1107"><a href="simulace4.html#cb562-1107" tabindex="-1"></a>    </span>
<span id="cb562-1108"><a href="simulace4.html#cb562-1108" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb562-1109"><a href="simulace4.html#cb562-1109" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-1110"><a href="simulace4.html#cb562-1110" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-1111"><a href="simulace4.html#cb562-1111" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb562-1112"><a href="simulace4.html#cb562-1112" tabindex="-1"></a>    </span>
<span id="cb562-1113"><a href="simulace4.html#cb562-1113" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-1114"><a href="simulace4.html#cb562-1114" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1115"><a href="simulace4.html#cb562-1115" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-1116"><a href="simulace4.html#cb562-1116" tabindex="-1"></a>    }</span>
<span id="cb562-1117"><a href="simulace4.html#cb562-1117" tabindex="-1"></a>    </span>
<span id="cb562-1118"><a href="simulace4.html#cb562-1118" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb562-1119"><a href="simulace4.html#cb562-1119" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb562-1120"><a href="simulace4.html#cb562-1120" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb562-1121"><a href="simulace4.html#cb562-1121" tabindex="-1"></a>  </span>
<span id="cb562-1122"><a href="simulace4.html#cb562-1122" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1123"><a href="simulace4.html#cb562-1123" tabindex="-1"></a>  </span>
<span id="cb562-1124"><a href="simulace4.html#cb562-1124" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1125"><a href="simulace4.html#cb562-1125" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb562-1126"><a href="simulace4.html#cb562-1126" tabindex="-1"></a>    </span>
<span id="cb562-1127"><a href="simulace4.html#cb562-1127" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1128"><a href="simulace4.html#cb562-1128" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-1129"><a href="simulace4.html#cb562-1129" tabindex="-1"></a>    </span>
<span id="cb562-1130"><a href="simulace4.html#cb562-1130" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1131"><a href="simulace4.html#cb562-1131" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1132"><a href="simulace4.html#cb562-1132" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1133"><a href="simulace4.html#cb562-1133" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1134"><a href="simulace4.html#cb562-1134" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1135"><a href="simulace4.html#cb562-1135" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1136"><a href="simulace4.html#cb562-1136" tabindex="-1"></a>    </span>
<span id="cb562-1137"><a href="simulace4.html#cb562-1137" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-1138"><a href="simulace4.html#cb562-1138" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb562-1139"><a href="simulace4.html#cb562-1139" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-1140"><a href="simulace4.html#cb562-1140" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1141"><a href="simulace4.html#cb562-1141" tabindex="-1"></a>      </span>
<span id="cb562-1142"><a href="simulace4.html#cb562-1142" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-1143"><a href="simulace4.html#cb562-1143" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1144"><a href="simulace4.html#cb562-1144" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1145"><a href="simulace4.html#cb562-1145" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1146"><a href="simulace4.html#cb562-1146" tabindex="-1"></a>    </span>
<span id="cb562-1147"><a href="simulace4.html#cb562-1147" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1148"><a href="simulace4.html#cb562-1148" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb562-1149"><a href="simulace4.html#cb562-1149" tabindex="-1"></a>  }</span>
<span id="cb562-1150"><a href="simulace4.html#cb562-1150" tabindex="-1"></a>  </span>
<span id="cb562-1151"><a href="simulace4.html#cb562-1151" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-1152"><a href="simulace4.html#cb562-1152" tabindex="-1"></a></span>
<span id="cb562-1153"><a href="simulace4.html#cb562-1153" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb562-1154"><a href="simulace4.html#cb562-1154" tabindex="-1"></a>  </span>
<span id="cb562-1155"><a href="simulace4.html#cb562-1155" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb562-1156"><a href="simulace4.html#cb562-1156" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb562-1157"><a href="simulace4.html#cb562-1157" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb562-1158"><a href="simulace4.html#cb562-1158" tabindex="-1"></a>  }</span>
<span id="cb562-1159"><a href="simulace4.html#cb562-1159" tabindex="-1"></a>  </span>
<span id="cb562-1160"><a href="simulace4.html#cb562-1160" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb562-1161"><a href="simulace4.html#cb562-1161" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb562-1162"><a href="simulace4.html#cb562-1162" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb562-1163"><a href="simulace4.html#cb562-1163" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb562-1164"><a href="simulace4.html#cb562-1164" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb562-1165"><a href="simulace4.html#cb562-1165" tabindex="-1"></a>      }</span>
<span id="cb562-1166"><a href="simulace4.html#cb562-1166" tabindex="-1"></a>    }</span>
<span id="cb562-1167"><a href="simulace4.html#cb562-1167" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb562-1168"><a href="simulace4.html#cb562-1168" tabindex="-1"></a>  }</span>
<span id="cb562-1169"><a href="simulace4.html#cb562-1169" tabindex="-1"></a>  </span>
<span id="cb562-1170"><a href="simulace4.html#cb562-1170" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb562-1171"><a href="simulace4.html#cb562-1171" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-1172"><a href="simulace4.html#cb562-1172" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-1173"><a href="simulace4.html#cb562-1173" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-1174"><a href="simulace4.html#cb562-1174" tabindex="-1"></a>  </span>
<span id="cb562-1175"><a href="simulace4.html#cb562-1175" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb562-1176"><a href="simulace4.html#cb562-1176" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb562-1177"><a href="simulace4.html#cb562-1177" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb562-1178"><a href="simulace4.html#cb562-1178" tabindex="-1"></a>  </span>
<span id="cb562-1179"><a href="simulace4.html#cb562-1179" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb562-1180"><a href="simulace4.html#cb562-1180" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb562-1181"><a href="simulace4.html#cb562-1181" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb562-1182"><a href="simulace4.html#cb562-1182" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb562-1183"><a href="simulace4.html#cb562-1183" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb562-1184"><a href="simulace4.html#cb562-1184" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb562-1185"><a href="simulace4.html#cb562-1185" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb562-1186"><a href="simulace4.html#cb562-1186" tabindex="-1"></a>  </span>
<span id="cb562-1187"><a href="simulace4.html#cb562-1187" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb562-1188"><a href="simulace4.html#cb562-1188" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1189"><a href="simulace4.html#cb562-1189" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-1190"><a href="simulace4.html#cb562-1190" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1191"><a href="simulace4.html#cb562-1191" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-1192"><a href="simulace4.html#cb562-1192" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1193"><a href="simulace4.html#cb562-1193" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb562-1194"><a href="simulace4.html#cb562-1194" tabindex="-1"></a>  </span>
<span id="cb562-1195"><a href="simulace4.html#cb562-1195" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb562-1196"><a href="simulace4.html#cb562-1196" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb562-1197"><a href="simulace4.html#cb562-1197" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb562-1198"><a href="simulace4.html#cb562-1198" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-1199"><a href="simulace4.html#cb562-1199" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-1200"><a href="simulace4.html#cb562-1200" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-1201"><a href="simulace4.html#cb562-1201" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb562-1202"><a href="simulace4.html#cb562-1202" tabindex="-1"></a>    </span>
<span id="cb562-1203"><a href="simulace4.html#cb562-1203" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb562-1204"><a href="simulace4.html#cb562-1204" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1205"><a href="simulace4.html#cb562-1205" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-1206"><a href="simulace4.html#cb562-1206" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-1207"><a href="simulace4.html#cb562-1207" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-1208"><a href="simulace4.html#cb562-1208" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb562-1209"><a href="simulace4.html#cb562-1209" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-1210"><a href="simulace4.html#cb562-1210" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-1211"><a href="simulace4.html#cb562-1211" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1212"><a href="simulace4.html#cb562-1212" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb562-1213"><a href="simulace4.html#cb562-1213" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb562-1214"><a href="simulace4.html#cb562-1214" tabindex="-1"></a>    }</span>
<span id="cb562-1215"><a href="simulace4.html#cb562-1215" tabindex="-1"></a>    </span>
<span id="cb562-1216"><a href="simulace4.html#cb562-1216" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb562-1217"><a href="simulace4.html#cb562-1217" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb562-1218"><a href="simulace4.html#cb562-1218" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-1219"><a href="simulace4.html#cb562-1219" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-1220"><a href="simulace4.html#cb562-1220" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb562-1221"><a href="simulace4.html#cb562-1221" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-1222"><a href="simulace4.html#cb562-1222" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1223"><a href="simulace4.html#cb562-1223" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb562-1224"><a href="simulace4.html#cb562-1224" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-1225"><a href="simulace4.html#cb562-1225" tabindex="-1"></a>      }</span>
<span id="cb562-1226"><a href="simulace4.html#cb562-1226" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb562-1227"><a href="simulace4.html#cb562-1227" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-1228"><a href="simulace4.html#cb562-1228" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb562-1229"><a href="simulace4.html#cb562-1229" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb562-1230"><a href="simulace4.html#cb562-1230" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb562-1231"><a href="simulace4.html#cb562-1231" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb562-1232"><a href="simulace4.html#cb562-1232" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb562-1233"><a href="simulace4.html#cb562-1233" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-1234"><a href="simulace4.html#cb562-1234" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb562-1235"><a href="simulace4.html#cb562-1235" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb562-1236"><a href="simulace4.html#cb562-1236" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb562-1237"><a href="simulace4.html#cb562-1237" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1238"><a href="simulace4.html#cb562-1238" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1239"><a href="simulace4.html#cb562-1239" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1240"><a href="simulace4.html#cb562-1240" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1241"><a href="simulace4.html#cb562-1241" tabindex="-1"></a>        </span>
<span id="cb562-1242"><a href="simulace4.html#cb562-1242" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1243"><a href="simulace4.html#cb562-1243" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb562-1244"><a href="simulace4.html#cb562-1244" tabindex="-1"></a>          </span>
<span id="cb562-1245"><a href="simulace4.html#cb562-1245" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1246"><a href="simulace4.html#cb562-1246" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb562-1247"><a href="simulace4.html#cb562-1247" tabindex="-1"></a>          </span>
<span id="cb562-1248"><a href="simulace4.html#cb562-1248" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1249"><a href="simulace4.html#cb562-1249" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1250"><a href="simulace4.html#cb562-1250" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1251"><a href="simulace4.html#cb562-1251" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1252"><a href="simulace4.html#cb562-1252" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1253"><a href="simulace4.html#cb562-1253" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1254"><a href="simulace4.html#cb562-1254" tabindex="-1"></a>          </span>
<span id="cb562-1255"><a href="simulace4.html#cb562-1255" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb562-1256"><a href="simulace4.html#cb562-1256" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1257"><a href="simulace4.html#cb562-1257" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1258"><a href="simulace4.html#cb562-1258" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1259"><a href="simulace4.html#cb562-1259" tabindex="-1"></a>          </span>
<span id="cb562-1260"><a href="simulace4.html#cb562-1260" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1261"><a href="simulace4.html#cb562-1261" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb562-1262"><a href="simulace4.html#cb562-1262" tabindex="-1"></a>        }</span>
<span id="cb562-1263"><a href="simulace4.html#cb562-1263" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb562-1264"><a href="simulace4.html#cb562-1264" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb562-1265"><a href="simulace4.html#cb562-1265" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1266"><a href="simulace4.html#cb562-1266" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb562-1267"><a href="simulace4.html#cb562-1267" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb562-1268"><a href="simulace4.html#cb562-1268" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1269"><a href="simulace4.html#cb562-1269" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb562-1270"><a href="simulace4.html#cb562-1270" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb562-1271"><a href="simulace4.html#cb562-1271" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1272"><a href="simulace4.html#cb562-1272" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb562-1273"><a href="simulace4.html#cb562-1273" tabindex="-1"></a>      }</span>
<span id="cb562-1274"><a href="simulace4.html#cb562-1274" tabindex="-1"></a>    }</span>
<span id="cb562-1275"><a href="simulace4.html#cb562-1275" tabindex="-1"></a>  }</span>
<span id="cb562-1276"><a href="simulace4.html#cb562-1276" tabindex="-1"></a>  </span>
<span id="cb562-1277"><a href="simulace4.html#cb562-1277" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb562-1278"><a href="simulace4.html#cb562-1278" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb562-1279"><a href="simulace4.html#cb562-1279" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb562-1280"><a href="simulace4.html#cb562-1280" tabindex="-1"></a>  }</span>
<span id="cb562-1281"><a href="simulace4.html#cb562-1281" tabindex="-1"></a>  </span>
<span id="cb562-1282"><a href="simulace4.html#cb562-1282" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb562-1283"><a href="simulace4.html#cb562-1283" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb562-1284"><a href="simulace4.html#cb562-1284" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb562-1285"><a href="simulace4.html#cb562-1285" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb562-1286"><a href="simulace4.html#cb562-1286" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb562-1287"><a href="simulace4.html#cb562-1287" tabindex="-1"></a>  </span>
<span id="cb562-1288"><a href="simulace4.html#cb562-1288" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1289"><a href="simulace4.html#cb562-1289" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1290"><a href="simulace4.html#cb562-1290" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb562-1291"><a href="simulace4.html#cb562-1291" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb562-1292"><a href="simulace4.html#cb562-1292" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb562-1293"><a href="simulace4.html#cb562-1293" tabindex="-1"></a>  </span>
<span id="cb562-1294"><a href="simulace4.html#cb562-1294" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb562-1295"><a href="simulace4.html#cb562-1295" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb562-1296"><a href="simulace4.html#cb562-1296" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb562-1297"><a href="simulace4.html#cb562-1297" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb562-1298"><a href="simulace4.html#cb562-1298" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb562-1299"><a href="simulace4.html#cb562-1299" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb562-1300"><a href="simulace4.html#cb562-1300" tabindex="-1"></a>  </span>
<span id="cb562-1301"><a href="simulace4.html#cb562-1301" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb562-1302"><a href="simulace4.html#cb562-1302" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb562-1303"><a href="simulace4.html#cb562-1303" tabindex="-1"></a>  </span>
<span id="cb562-1304"><a href="simulace4.html#cb562-1304" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-1305"><a href="simulace4.html#cb562-1305" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-1306"><a href="simulace4.html#cb562-1306" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb562-1307"><a href="simulace4.html#cb562-1307" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb562-1308"><a href="simulace4.html#cb562-1308" tabindex="-1"></a>  </span>
<span id="cb562-1309"><a href="simulace4.html#cb562-1309" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-1310"><a href="simulace4.html#cb562-1310" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb562-1311"><a href="simulace4.html#cb562-1311" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb562-1312"><a href="simulace4.html#cb562-1312" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb562-1313"><a href="simulace4.html#cb562-1313" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb562-1314"><a href="simulace4.html#cb562-1314" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1315"><a href="simulace4.html#cb562-1315" tabindex="-1"></a>  </span>
<span id="cb562-1316"><a href="simulace4.html#cb562-1316" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1317"><a href="simulace4.html#cb562-1317" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1318"><a href="simulace4.html#cb562-1318" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb562-1319"><a href="simulace4.html#cb562-1319" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb562-1320"><a href="simulace4.html#cb562-1320" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb562-1321"><a href="simulace4.html#cb562-1321" tabindex="-1"></a>    </span>
<span id="cb562-1322"><a href="simulace4.html#cb562-1322" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb562-1323"><a href="simulace4.html#cb562-1323" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-1324"><a href="simulace4.html#cb562-1324" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-1325"><a href="simulace4.html#cb562-1325" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-1326"><a href="simulace4.html#cb562-1326" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb562-1327"><a href="simulace4.html#cb562-1327" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb562-1328"><a href="simulace4.html#cb562-1328" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb562-1329"><a href="simulace4.html#cb562-1329" tabindex="-1"></a>    </span>
<span id="cb562-1330"><a href="simulace4.html#cb562-1330" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb562-1331"><a href="simulace4.html#cb562-1331" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1332"><a href="simulace4.html#cb562-1332" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-1333"><a href="simulace4.html#cb562-1333" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-1334"><a href="simulace4.html#cb562-1334" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-1335"><a href="simulace4.html#cb562-1335" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb562-1336"><a href="simulace4.html#cb562-1336" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-1337"><a href="simulace4.html#cb562-1337" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb562-1338"><a href="simulace4.html#cb562-1338" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1339"><a href="simulace4.html#cb562-1339" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb562-1340"><a href="simulace4.html#cb562-1340" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb562-1341"><a href="simulace4.html#cb562-1341" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb562-1342"><a href="simulace4.html#cb562-1342" tabindex="-1"></a>    }</span>
<span id="cb562-1343"><a href="simulace4.html#cb562-1343" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb562-1344"><a href="simulace4.html#cb562-1344" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb562-1345"><a href="simulace4.html#cb562-1345" tabindex="-1"></a>    </span>
<span id="cb562-1346"><a href="simulace4.html#cb562-1346" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb562-1347"><a href="simulace4.html#cb562-1347" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-1348"><a href="simulace4.html#cb562-1348" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-1349"><a href="simulace4.html#cb562-1349" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb562-1350"><a href="simulace4.html#cb562-1350" tabindex="-1"></a>    </span>
<span id="cb562-1351"><a href="simulace4.html#cb562-1351" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-1352"><a href="simulace4.html#cb562-1352" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1353"><a href="simulace4.html#cb562-1353" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-1354"><a href="simulace4.html#cb562-1354" tabindex="-1"></a>    }</span>
<span id="cb562-1355"><a href="simulace4.html#cb562-1355" tabindex="-1"></a>    </span>
<span id="cb562-1356"><a href="simulace4.html#cb562-1356" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb562-1357"><a href="simulace4.html#cb562-1357" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb562-1358"><a href="simulace4.html#cb562-1358" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb562-1359"><a href="simulace4.html#cb562-1359" tabindex="-1"></a>  </span>
<span id="cb562-1360"><a href="simulace4.html#cb562-1360" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1361"><a href="simulace4.html#cb562-1361" tabindex="-1"></a>  </span>
<span id="cb562-1362"><a href="simulace4.html#cb562-1362" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1363"><a href="simulace4.html#cb562-1363" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb562-1364"><a href="simulace4.html#cb562-1364" tabindex="-1"></a>    </span>
<span id="cb562-1365"><a href="simulace4.html#cb562-1365" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1366"><a href="simulace4.html#cb562-1366" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-1367"><a href="simulace4.html#cb562-1367" tabindex="-1"></a>    </span>
<span id="cb562-1368"><a href="simulace4.html#cb562-1368" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1369"><a href="simulace4.html#cb562-1369" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1370"><a href="simulace4.html#cb562-1370" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1371"><a href="simulace4.html#cb562-1371" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1372"><a href="simulace4.html#cb562-1372" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1373"><a href="simulace4.html#cb562-1373" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1374"><a href="simulace4.html#cb562-1374" tabindex="-1"></a>    </span>
<span id="cb562-1375"><a href="simulace4.html#cb562-1375" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-1376"><a href="simulace4.html#cb562-1376" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb562-1377"><a href="simulace4.html#cb562-1377" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-1378"><a href="simulace4.html#cb562-1378" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1379"><a href="simulace4.html#cb562-1379" tabindex="-1"></a>      </span>
<span id="cb562-1380"><a href="simulace4.html#cb562-1380" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-1381"><a href="simulace4.html#cb562-1381" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1382"><a href="simulace4.html#cb562-1382" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1383"><a href="simulace4.html#cb562-1383" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1384"><a href="simulace4.html#cb562-1384" tabindex="-1"></a>    </span>
<span id="cb562-1385"><a href="simulace4.html#cb562-1385" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1386"><a href="simulace4.html#cb562-1386" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb562-1387"><a href="simulace4.html#cb562-1387" tabindex="-1"></a>  }</span>
<span id="cb562-1388"><a href="simulace4.html#cb562-1388" tabindex="-1"></a>  </span>
<span id="cb562-1389"><a href="simulace4.html#cb562-1389" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-1390"><a href="simulace4.html#cb562-1390" tabindex="-1"></a>  </span>
<span id="cb562-1391"><a href="simulace4.html#cb562-1391" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb562-1392"><a href="simulace4.html#cb562-1392" tabindex="-1"></a>  </span>
<span id="cb562-1393"><a href="simulace4.html#cb562-1393" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb562-1394"><a href="simulace4.html#cb562-1394" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb562-1395"><a href="simulace4.html#cb562-1395" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb562-1396"><a href="simulace4.html#cb562-1396" tabindex="-1"></a>  }</span>
<span id="cb562-1397"><a href="simulace4.html#cb562-1397" tabindex="-1"></a>  </span>
<span id="cb562-1398"><a href="simulace4.html#cb562-1398" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb562-1399"><a href="simulace4.html#cb562-1399" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb562-1400"><a href="simulace4.html#cb562-1400" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb562-1401"><a href="simulace4.html#cb562-1401" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb562-1402"><a href="simulace4.html#cb562-1402" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb562-1403"><a href="simulace4.html#cb562-1403" tabindex="-1"></a>      }</span>
<span id="cb562-1404"><a href="simulace4.html#cb562-1404" tabindex="-1"></a>    }</span>
<span id="cb562-1405"><a href="simulace4.html#cb562-1405" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb562-1406"><a href="simulace4.html#cb562-1406" tabindex="-1"></a>  }</span>
<span id="cb562-1407"><a href="simulace4.html#cb562-1407" tabindex="-1"></a>  </span>
<span id="cb562-1408"><a href="simulace4.html#cb562-1408" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb562-1409"><a href="simulace4.html#cb562-1409" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb562-1410"><a href="simulace4.html#cb562-1410" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-1411"><a href="simulace4.html#cb562-1411" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-1412"><a href="simulace4.html#cb562-1412" tabindex="-1"></a>  </span>
<span id="cb562-1413"><a href="simulace4.html#cb562-1413" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb562-1414"><a href="simulace4.html#cb562-1414" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb562-1415"><a href="simulace4.html#cb562-1415" tabindex="-1"></a>  </span>
<span id="cb562-1416"><a href="simulace4.html#cb562-1416" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb562-1417"><a href="simulace4.html#cb562-1417" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb562-1418"><a href="simulace4.html#cb562-1418" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb562-1419"><a href="simulace4.html#cb562-1419" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb562-1420"><a href="simulace4.html#cb562-1420" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb562-1421"><a href="simulace4.html#cb562-1421" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb562-1422"><a href="simulace4.html#cb562-1422" tabindex="-1"></a>  </span>
<span id="cb562-1423"><a href="simulace4.html#cb562-1423" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb562-1424"><a href="simulace4.html#cb562-1424" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1425"><a href="simulace4.html#cb562-1425" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-1426"><a href="simulace4.html#cb562-1426" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1427"><a href="simulace4.html#cb562-1427" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb562-1428"><a href="simulace4.html#cb562-1428" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb562-1429"><a href="simulace4.html#cb562-1429" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb562-1430"><a href="simulace4.html#cb562-1430" tabindex="-1"></a>  </span>
<span id="cb562-1431"><a href="simulace4.html#cb562-1431" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb562-1432"><a href="simulace4.html#cb562-1432" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb562-1433"><a href="simulace4.html#cb562-1433" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-1434"><a href="simulace4.html#cb562-1434" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-1435"><a href="simulace4.html#cb562-1435" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-1436"><a href="simulace4.html#cb562-1436" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb562-1437"><a href="simulace4.html#cb562-1437" tabindex="-1"></a>  </span>
<span id="cb562-1438"><a href="simulace4.html#cb562-1438" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb562-1439"><a href="simulace4.html#cb562-1439" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1440"><a href="simulace4.html#cb562-1440" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-1441"><a href="simulace4.html#cb562-1441" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-1442"><a href="simulace4.html#cb562-1442" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-1443"><a href="simulace4.html#cb562-1443" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb562-1444"><a href="simulace4.html#cb562-1444" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-1445"><a href="simulace4.html#cb562-1445" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb562-1446"><a href="simulace4.html#cb562-1446" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb562-1447"><a href="simulace4.html#cb562-1447" tabindex="-1"></a>  }</span>
<span id="cb562-1448"><a href="simulace4.html#cb562-1448" tabindex="-1"></a>  </span>
<span id="cb562-1449"><a href="simulace4.html#cb562-1449" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb562-1450"><a href="simulace4.html#cb562-1450" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb562-1451"><a href="simulace4.html#cb562-1451" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-1452"><a href="simulace4.html#cb562-1452" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-1453"><a href="simulace4.html#cb562-1453" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb562-1454"><a href="simulace4.html#cb562-1454" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-1455"><a href="simulace4.html#cb562-1455" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1456"><a href="simulace4.html#cb562-1456" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb562-1457"><a href="simulace4.html#cb562-1457" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-1458"><a href="simulace4.html#cb562-1458" tabindex="-1"></a>    }</span>
<span id="cb562-1459"><a href="simulace4.html#cb562-1459" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb562-1460"><a href="simulace4.html#cb562-1460" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb562-1461"><a href="simulace4.html#cb562-1461" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb562-1462"><a href="simulace4.html#cb562-1462" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb562-1463"><a href="simulace4.html#cb562-1463" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb562-1464"><a href="simulace4.html#cb562-1464" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb562-1465"><a href="simulace4.html#cb562-1465" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb562-1466"><a href="simulace4.html#cb562-1466" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-1467"><a href="simulace4.html#cb562-1467" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb562-1468"><a href="simulace4.html#cb562-1468" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb562-1469"><a href="simulace4.html#cb562-1469" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb562-1470"><a href="simulace4.html#cb562-1470" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1471"><a href="simulace4.html#cb562-1471" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1472"><a href="simulace4.html#cb562-1472" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1473"><a href="simulace4.html#cb562-1473" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1474"><a href="simulace4.html#cb562-1474" tabindex="-1"></a>      </span>
<span id="cb562-1475"><a href="simulace4.html#cb562-1475" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1476"><a href="simulace4.html#cb562-1476" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb562-1477"><a href="simulace4.html#cb562-1477" tabindex="-1"></a>        </span>
<span id="cb562-1478"><a href="simulace4.html#cb562-1478" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1479"><a href="simulace4.html#cb562-1479" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb562-1480"><a href="simulace4.html#cb562-1480" tabindex="-1"></a>        </span>
<span id="cb562-1481"><a href="simulace4.html#cb562-1481" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1482"><a href="simulace4.html#cb562-1482" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1483"><a href="simulace4.html#cb562-1483" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1484"><a href="simulace4.html#cb562-1484" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1485"><a href="simulace4.html#cb562-1485" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1486"><a href="simulace4.html#cb562-1486" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1487"><a href="simulace4.html#cb562-1487" tabindex="-1"></a>        </span>
<span id="cb562-1488"><a href="simulace4.html#cb562-1488" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb562-1489"><a href="simulace4.html#cb562-1489" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1490"><a href="simulace4.html#cb562-1490" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1491"><a href="simulace4.html#cb562-1491" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1492"><a href="simulace4.html#cb562-1492" tabindex="-1"></a>        </span>
<span id="cb562-1493"><a href="simulace4.html#cb562-1493" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1494"><a href="simulace4.html#cb562-1494" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb562-1495"><a href="simulace4.html#cb562-1495" tabindex="-1"></a>      }</span>
<span id="cb562-1496"><a href="simulace4.html#cb562-1496" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb562-1497"><a href="simulace4.html#cb562-1497" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1498"><a href="simulace4.html#cb562-1498" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb562-1499"><a href="simulace4.html#cb562-1499" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1500"><a href="simulace4.html#cb562-1500" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb562-1501"><a href="simulace4.html#cb562-1501" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb562-1502"><a href="simulace4.html#cb562-1502" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb562-1503"><a href="simulace4.html#cb562-1503" tabindex="-1"></a>    }</span>
<span id="cb562-1504"><a href="simulace4.html#cb562-1504" tabindex="-1"></a>  }</span>
<span id="cb562-1505"><a href="simulace4.html#cb562-1505" tabindex="-1"></a>  </span>
<span id="cb562-1506"><a href="simulace4.html#cb562-1506" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb562-1507"><a href="simulace4.html#cb562-1507" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb562-1508"><a href="simulace4.html#cb562-1508" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb562-1509"><a href="simulace4.html#cb562-1509" tabindex="-1"></a>  }</span>
<span id="cb562-1510"><a href="simulace4.html#cb562-1510" tabindex="-1"></a>  </span>
<span id="cb562-1511"><a href="simulace4.html#cb562-1511" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1512"><a href="simulace4.html#cb562-1512" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb562-1513"><a href="simulace4.html#cb562-1513" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb562-1514"><a href="simulace4.html#cb562-1514" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb562-1515"><a href="simulace4.html#cb562-1515" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb562-1516"><a href="simulace4.html#cb562-1516" tabindex="-1"></a>  </span>
<span id="cb562-1517"><a href="simulace4.html#cb562-1517" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb562-1518"><a href="simulace4.html#cb562-1518" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb562-1519"><a href="simulace4.html#cb562-1519" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb562-1520"><a href="simulace4.html#cb562-1520" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb562-1521"><a href="simulace4.html#cb562-1521" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb562-1522"><a href="simulace4.html#cb562-1522" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb562-1523"><a href="simulace4.html#cb562-1523" tabindex="-1"></a>  </span>
<span id="cb562-1524"><a href="simulace4.html#cb562-1524" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb562-1525"><a href="simulace4.html#cb562-1525" tabindex="-1"></a>  </span>
<span id="cb562-1526"><a href="simulace4.html#cb562-1526" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb562-1527"><a href="simulace4.html#cb562-1527" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb562-1528"><a href="simulace4.html#cb562-1528" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb562-1529"><a href="simulace4.html#cb562-1529" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb562-1530"><a href="simulace4.html#cb562-1530" tabindex="-1"></a>  </span>
<span id="cb562-1531"><a href="simulace4.html#cb562-1531" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb562-1532"><a href="simulace4.html#cb562-1532" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb562-1533"><a href="simulace4.html#cb562-1533" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb562-1534"><a href="simulace4.html#cb562-1534" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb562-1535"><a href="simulace4.html#cb562-1535" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb562-1536"><a href="simulace4.html#cb562-1536" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb562-1537"><a href="simulace4.html#cb562-1537" tabindex="-1"></a>  </span>
<span id="cb562-1538"><a href="simulace4.html#cb562-1538" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb562-1539"><a href="simulace4.html#cb562-1539" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb562-1540"><a href="simulace4.html#cb562-1540" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb562-1541"><a href="simulace4.html#cb562-1541" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb562-1542"><a href="simulace4.html#cb562-1542" tabindex="-1"></a>    </span>
<span id="cb562-1543"><a href="simulace4.html#cb562-1543" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb562-1544"><a href="simulace4.html#cb562-1544" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb562-1545"><a href="simulace4.html#cb562-1545" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb562-1546"><a href="simulace4.html#cb562-1546" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb562-1547"><a href="simulace4.html#cb562-1547" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb562-1548"><a href="simulace4.html#cb562-1548" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb562-1549"><a href="simulace4.html#cb562-1549" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb562-1550"><a href="simulace4.html#cb562-1550" tabindex="-1"></a>    </span>
<span id="cb562-1551"><a href="simulace4.html#cb562-1551" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb562-1552"><a href="simulace4.html#cb562-1552" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1553"><a href="simulace4.html#cb562-1553" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb562-1554"><a href="simulace4.html#cb562-1554" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb562-1555"><a href="simulace4.html#cb562-1555" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb562-1556"><a href="simulace4.html#cb562-1556" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb562-1557"><a href="simulace4.html#cb562-1557" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb562-1558"><a href="simulace4.html#cb562-1558" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb562-1559"><a href="simulace4.html#cb562-1559" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb562-1560"><a href="simulace4.html#cb562-1560" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb562-1561"><a href="simulace4.html#cb562-1561" tabindex="-1"></a>    }</span>
<span id="cb562-1562"><a href="simulace4.html#cb562-1562" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb562-1563"><a href="simulace4.html#cb562-1563" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb562-1564"><a href="simulace4.html#cb562-1564" tabindex="-1"></a>    </span>
<span id="cb562-1565"><a href="simulace4.html#cb562-1565" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb562-1566"><a href="simulace4.html#cb562-1566" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb562-1567"><a href="simulace4.html#cb562-1567" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb562-1568"><a href="simulace4.html#cb562-1568" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb562-1569"><a href="simulace4.html#cb562-1569" tabindex="-1"></a>    </span>
<span id="cb562-1570"><a href="simulace4.html#cb562-1570" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb562-1571"><a href="simulace4.html#cb562-1571" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb562-1572"><a href="simulace4.html#cb562-1572" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb562-1573"><a href="simulace4.html#cb562-1573" tabindex="-1"></a>    }</span>
<span id="cb562-1574"><a href="simulace4.html#cb562-1574" tabindex="-1"></a>    </span>
<span id="cb562-1575"><a href="simulace4.html#cb562-1575" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb562-1576"><a href="simulace4.html#cb562-1576" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb562-1577"><a href="simulace4.html#cb562-1577" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb562-1578"><a href="simulace4.html#cb562-1578" tabindex="-1"></a>  </span>
<span id="cb562-1579"><a href="simulace4.html#cb562-1579" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb562-1580"><a href="simulace4.html#cb562-1580" tabindex="-1"></a>  </span>
<span id="cb562-1581"><a href="simulace4.html#cb562-1581" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb562-1582"><a href="simulace4.html#cb562-1582" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb562-1583"><a href="simulace4.html#cb562-1583" tabindex="-1"></a>    </span>
<span id="cb562-1584"><a href="simulace4.html#cb562-1584" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb562-1585"><a href="simulace4.html#cb562-1585" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb562-1586"><a href="simulace4.html#cb562-1586" tabindex="-1"></a>    </span>
<span id="cb562-1587"><a href="simulace4.html#cb562-1587" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb562-1588"><a href="simulace4.html#cb562-1588" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb562-1589"><a href="simulace4.html#cb562-1589" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb562-1590"><a href="simulace4.html#cb562-1590" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb562-1591"><a href="simulace4.html#cb562-1591" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb562-1592"><a href="simulace4.html#cb562-1592" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb562-1593"><a href="simulace4.html#cb562-1593" tabindex="-1"></a>    </span>
<span id="cb562-1594"><a href="simulace4.html#cb562-1594" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb562-1595"><a href="simulace4.html#cb562-1595" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb562-1596"><a href="simulace4.html#cb562-1596" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb562-1597"><a href="simulace4.html#cb562-1597" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1598"><a href="simulace4.html#cb562-1598" tabindex="-1"></a>      </span>
<span id="cb562-1599"><a href="simulace4.html#cb562-1599" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb562-1600"><a href="simulace4.html#cb562-1600" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb562-1601"><a href="simulace4.html#cb562-1601" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb562-1602"><a href="simulace4.html#cb562-1602" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb562-1603"><a href="simulace4.html#cb562-1603" tabindex="-1"></a>    </span>
<span id="cb562-1604"><a href="simulace4.html#cb562-1604" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb562-1605"><a href="simulace4.html#cb562-1605" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb562-1606"><a href="simulace4.html#cb562-1606" tabindex="-1"></a>  }</span>
<span id="cb562-1607"><a href="simulace4.html#cb562-1607" tabindex="-1"></a>  </span>
<span id="cb562-1608"><a href="simulace4.html#cb562-1608" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb562-1609"><a href="simulace4.html#cb562-1609" tabindex="-1"></a>  </span>
<span id="cb562-1610"><a href="simulace4.html#cb562-1610" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb562-1611"><a href="simulace4.html#cb562-1611" tabindex="-1"></a>  </span>
<span id="cb562-1612"><a href="simulace4.html#cb562-1612" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb562-1613"><a href="simulace4.html#cb562-1613" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb562-1614"><a href="simulace4.html#cb562-1614" tabindex="-1"></a>  </span>
<span id="cb562-1615"><a href="simulace4.html#cb562-1615" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb562-1616"><a href="simulace4.html#cb562-1616" tabindex="-1"></a>}</span>
<span id="cb562-1617"><a href="simulace4.html#cb562-1617" tabindex="-1"></a></span>
<span id="cb562-1618"><a href="simulace4.html#cb562-1618" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb562-1619"><a href="simulace4.html#cb562-1619" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/simulace_04_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Calculate average training and testing error rates for each classification method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb563"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb563-1"><a href="simulace4.html#cb563-1" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb563-2"><a href="simulace4.html#cb563-2" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb563-3"><a href="simulace4.html#cb563-3" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb563-4"><a href="simulace4.html#cb563-4" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb563-5"><a href="simulace4.html#cb563-5" tabindex="-1"></a></span>
<span id="cb563-6"><a href="simulace4.html#cb563-6" tabindex="-1"></a><span class="co"># Save the final values </span></span>
<span id="cb563-7"><a href="simulace4.html#cb563-7" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/simulace_04_res_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="results-1" class="section level4 hasAnchor" number="5.1.4.1">
<h4><span class="header-section-number">5.1.4.1</span> Results<a href="simulace4.html#results-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-129">Table 1.7: </span>Summary of results for the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error rate, <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates the test error rate, <span class="math inline">\(\widehat{SD}_{train}\)</span> is the estimated standard deviation of training errors, and <span class="math inline">\(\widehat{SD}_{test}\)</span> is the estimated standard deviation of test errors.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.2196</td>
<td align="right">0.2377</td>
<td align="right">0.0476</td>
<td align="right">0.0685</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.2204</td>
<td align="right">0.2370</td>
<td align="right">0.0453</td>
<td align="right">0.0674</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.2130</td>
<td align="right">0.2432</td>
<td align="right">0.0468</td>
<td align="right">0.0647</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0418</td>
<td align="right">0.1037</td>
<td align="right">0.0259</td>
<td align="right">0.0432</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.2213</td>
<td align="right">0.2360</td>
<td align="right">0.0462</td>
<td align="right">0.0664</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1754</td>
<td align="right">0.2538</td>
<td align="right">0.0587</td>
<td align="right">0.0740</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.2076</td>
<td align="right">0.2665</td>
<td align="right">0.0590</td>
<td align="right">0.0755</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1729</td>
<td align="right">0.2448</td>
<td align="right">0.0464</td>
<td align="right">0.0658</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0086</td>
<td align="right">0.2257</td>
<td align="right">0.0074</td>
<td align="right">0.0778</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0316</td>
<td align="right">0.2542</td>
<td align="right">0.0182</td>
<td align="right">0.0729</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0104</td>
<td align="right">0.2232</td>
<td align="right">0.0078</td>
<td align="right">0.0773</td>
</tr>
<tr class="even">
<td>SVM linear - func</td>
<td align="right">0.1073</td>
<td align="right">0.1507</td>
<td align="right">0.0488</td>
<td align="right">0.0508</td>
</tr>
<tr class="odd">
<td>SVM poly - func</td>
<td align="right">0.0671</td>
<td align="right">0.2277</td>
<td align="right">0.0540</td>
<td align="right">0.0704</td>
</tr>
<tr class="even">
<td>SVM rbf - func</td>
<td align="right">0.1273</td>
<td align="right">0.1713</td>
<td align="right">0.0534</td>
<td align="right">0.0726</td>
</tr>
<tr class="odd">
<td>SVM linear - diskr</td>
<td align="right">0.0615</td>
<td align="right">0.1095</td>
<td align="right">0.0275</td>
<td align="right">0.0372</td>
</tr>
<tr class="even">
<td>SVM poly - diskr</td>
<td align="right">0.1040</td>
<td align="right">0.2038</td>
<td align="right">0.0547</td>
<td align="right">0.0735</td>
</tr>
<tr class="odd">
<td>SVM rbf - diskr</td>
<td align="right">0.1278</td>
<td align="right">0.1707</td>
<td align="right">0.0507</td>
<td align="right">0.0680</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.2224</td>
<td align="right">0.2392</td>
<td align="right">0.0452</td>
<td align="right">0.0643</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.2296</td>
<td align="right">0.2757</td>
<td align="right">0.0463</td>
<td align="right">0.0729</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.2218</td>
<td align="right">0.2448</td>
<td align="right">0.0457</td>
<td align="right">0.0637</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0514</td>
<td align="right">0.1000</td>
<td align="right">0.0257</td>
<td align="right">0.0420</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.1464</td>
<td align="right">0.2133</td>
<td align="right">0.0486</td>
<td align="right">0.0699</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.1051</td>
<td align="right">0.1702</td>
<td align="right">0.0494</td>
<td align="right">0.0677</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.1109</td>
<td align="right">0.1448</td>
<td align="right">0.0459</td>
<td align="right">0.0628</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0884</td>
<td align="right">0.1880</td>
<td align="right">0.0555</td>
<td align="right">0.0706</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.1169</td>
<td align="right">0.1835</td>
<td align="right">0.0522</td>
<td align="right">0.0701</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.1036</td>
<td align="right">0.1695</td>
<td align="right">0.0455</td>
<td align="right">0.0615</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0646</td>
<td align="right">0.1992</td>
<td align="right">0.0421</td>
<td align="right">0.0653</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0961</td>
<td align="right">0.1868</td>
<td align="right">0.0463</td>
<td align="right">0.0734</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.1274</td>
<td align="right">0.2293</td>
<td align="right">0.0602</td>
<td align="right">0.0826</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0759</td>
<td align="right">0.2400</td>
<td align="right">0.0547</td>
<td align="right">0.0831</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.1305</td>
<td align="right">0.2200</td>
<td align="right">0.0499</td>
<td align="right">0.0878</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.2758</td>
<td align="right">0.3300</td>
<td align="right">0.0865</td>
<td align="right">0.1030</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.2329</td>
<td align="right">0.3328</td>
<td align="right">0.1009</td>
<td align="right">0.0966</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.2602</td>
<td align="right">0.3213</td>
<td align="right">0.0831</td>
<td align="right">0.0995</td>
</tr>
</tbody>
</table>
<p>The table above lists all computed characteristics. Standard deviations are also included to compare the stability or variability of the individual methods.</p>
<p>Finally, we can graphically display the calculated values from the simulation for each classification method using box plots, separately for training and testing errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb564"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb564-1"><a href="simulace4.html#cb564-1" tabindex="-1"></a><span class="co"># Set the names of classification methods differently</span></span>
<span id="cb564-2"><a href="simulace4.html#cb564-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb564-3"><a href="simulace4.html#cb564-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb564-4"><a href="simulace4.html#cb564-4" tabindex="-1"></a>      <span class="st">&#39;Linear Discriminant Analysis&#39;</span>,</span>
<span id="cb564-5"><a href="simulace4.html#cb564-5" tabindex="-1"></a>      <span class="st">&#39;Quadratic Discriminant Analysis&#39;</span>,</span>
<span id="cb564-6"><a href="simulace4.html#cb564-6" tabindex="-1"></a>      <span class="st">&#39;Functional Logistic Regression&#39;</span>,</span>
<span id="cb564-7"><a href="simulace4.html#cb564-7" tabindex="-1"></a>      <span class="st">&#39;Logistic Regression with fPCA&#39;</span>,</span>
<span id="cb564-8"><a href="simulace4.html#cb564-8" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- Discretization&#39;</span>,</span>
<span id="cb564-9"><a href="simulace4.html#cb564-9" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- fPCA&#39;</span>,</span>
<span id="cb564-10"><a href="simulace4.html#cb564-10" tabindex="-1"></a>      <span class="st">&#39;Decision Tree -- Basis Coefficients&#39;</span>,</span>
<span id="cb564-11"><a href="simulace4.html#cb564-11" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- Discretization&#39;</span>,</span>
<span id="cb564-12"><a href="simulace4.html#cb564-12" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- fPCA&#39;</span>,</span>
<span id="cb564-13"><a href="simulace4.html#cb564-13" tabindex="-1"></a>      <span class="st">&#39;Random Forest -- Basis Coefficients&#39;</span>,</span>
<span id="cb564-14"><a href="simulace4.html#cb564-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- functional&#39;</span>,</span>
<span id="cb564-15"><a href="simulace4.html#cb564-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- functional&#39;</span>,</span>
<span id="cb564-16"><a href="simulace4.html#cb564-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- functional&#39;</span>,</span>
<span id="cb564-17"><a href="simulace4.html#cb564-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Discretization&#39;</span>,</span>
<span id="cb564-18"><a href="simulace4.html#cb564-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Discretization&#39;</span>,</span>
<span id="cb564-19"><a href="simulace4.html#cb564-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Discretization&#39;</span>,</span>
<span id="cb564-20"><a href="simulace4.html#cb564-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb564-21"><a href="simulace4.html#cb564-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb564-22"><a href="simulace4.html#cb564-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb564-23"><a href="simulace4.html#cb564-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Basis Coefficients&#39;</span>,</span>
<span id="cb564-24"><a href="simulace4.html#cb564-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Basis Coefficients&#39;</span>,</span>
<span id="cb564-25"><a href="simulace4.html#cb564-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Basis Coefficients&#39;</span>,</span>
<span id="cb564-26"><a href="simulace4.html#cb564-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Projection&#39;</span>,</span>
<span id="cb564-27"><a href="simulace4.html#cb564-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Projection&#39;</span>,</span>
<span id="cb564-28"><a href="simulace4.html#cb564-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Projection&#39;</span>,</span>
<span id="cb564-29"><a href="simulace4.html#cb564-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb564-30"><a href="simulace4.html#cb564-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb564-31"><a href="simulace4.html#cb564-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb564-32"><a href="simulace4.html#cb564-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb564-33"><a href="simulace4.html#cb564-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb564-34"><a href="simulace4.html#cb564-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb564-35"><a href="simulace4.html#cb564-35" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb564-36"><a href="simulace4.html#cb564-36" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb564-37"><a href="simulace4.html#cb564-37" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb564-38"><a href="simulace4.html#cb564-38" tabindex="-1"></a>)</span>
<span id="cb564-39"><a href="simulace4.html#cb564-39" tabindex="-1"></a></span>
<span id="cb564-40"><a href="simulace4.html#cb564-40" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb564-41"><a href="simulace4.html#cb564-41" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb564-42"><a href="simulace4.html#cb564-42" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb564-43"><a href="simulace4.html#cb564-43" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb564-44"><a href="simulace4.html#cb564-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb564-45"><a href="simulace4.html#cb564-45" tabindex="-1"></a></span>
<span id="cb564-46"><a href="simulace4.html#cb564-46" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb564-47"><a href="simulace4.html#cb564-47" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb564-48"><a href="simulace4.html#cb564-48" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb564-49"><a href="simulace4.html#cb564-49" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb565"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb565-1"><a href="simulace4.html#cb565-1" tabindex="-1"></a><span class="co"># For training data</span></span>
<span id="cb565-2"><a href="simulace4.html#cb565-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb565-3"><a href="simulace4.html#cb565-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb565-4"><a href="simulace4.html#cb565-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb565-5"><a href="simulace4.html#cb565-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb565-6"><a href="simulace4.html#cb565-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb565-7"><a href="simulace4.html#cb565-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb565-8"><a href="simulace4.html#cb565-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb565-9"><a href="simulace4.html#cb565-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb565-10"><a href="simulace4.html#cb565-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb565-11"><a href="simulace4.html#cb565-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb565-12"><a href="simulace4.html#cb565-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb565-13"><a href="simulace4.html#cb565-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb565-14"><a href="simulace4.html#cb565-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb565-15"><a href="simulace4.html#cb565-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb565-16"><a href="simulace4.html#cb565-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb565-17"><a href="simulace4.html#cb565-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb565-18"><a href="simulace4.html#cb565-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb565-19"><a href="simulace4.html#cb565-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-131"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-131-1.png" alt="Box plots of training errors for 100 simulations separately for each classification method. The averages are marked with black $+$ symbols." width="672" />
<p class="caption">
Figure 5.12: Box plots of training errors for 100 simulations separately for each classification method. The averages are marked with black <span class="math inline">\(+\)</span> symbols.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb566"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb566-1"><a href="simulace4.html#cb566-1" tabindex="-1"></a><span class="co"># For testing data</span></span>
<span id="cb566-2"><a href="simulace4.html#cb566-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb566-3"><a href="simulace4.html#cb566-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb566-4"><a href="simulace4.html#cb566-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb566-5"><a href="simulace4.html#cb566-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb566-6"><a href="simulace4.html#cb566-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span> </span>
<span id="cb566-7"><a href="simulace4.html#cb566-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb566-8"><a href="simulace4.html#cb566-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb566-9"><a href="simulace4.html#cb566-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb566-10"><a href="simulace4.html#cb566-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb566-11"><a href="simulace4.html#cb566-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test])</span>
<span id="cb566-12"><a href="simulace4.html#cb566-12" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb566-13"><a href="simulace4.html#cb566-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb566-14"><a href="simulace4.html#cb566-14" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">50</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb566-15"><a href="simulace4.html#cb566-15" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb566-16"><a href="simulace4.html#cb566-16" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb566-17"><a href="simulace4.html#cb566-17" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb566-18"><a href="simulace4.html#cb566-18" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">3</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>) <span class="sc">+</span></span>
<span id="cb566-19"><a href="simulace4.html#cb566-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb566-20"><a href="simulace4.html#cb566-20" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;gray20&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-133"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-133-1.png" alt="Box plots of testing errors for 100 simulations separately for each classification method. The averages are marked with black $+$ symbols." width="672" />
<p class="caption">
Figure 5.13: Box plots of testing errors for 100 simulations separately for each classification method. The averages are marked with black <span class="math inline">\(+\)</span> symbols.
</p>
</div>
<p>We would now like to formally test whether some classification methods are better than others based on the previous simulation on this data, or show that we can consider them equally successful. Due to the violation of normality assumptions, we cannot use the classic paired t-test. We will use its non-parametric alternative—the paired Wilcoxon test. However, we must be cautious in our interpretation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb567"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb567-1"><a href="simulace4.html#cb567-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.1473608</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb569"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb569-1"><a href="simulace4.html#cb569-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - Bbasis&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;g&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.2346987</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb571"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb571-1"><a href="simulace4.html#cb571-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - Bbasis&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;g&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.002554202</code></pre>
<p>We are testing at the adjusted significance level <span class="math inline">\(\alpha_{adj} = 0.05 / 3 = 0.0167\)</span>.</p>
<table>
<caption><span id="tab:unnamed-chunk-136">Table 1.9: </span>Medians of hyperparameter values for selected methods where a hyperparameter was determined using cross-validation.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Median Hyperparameter Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">12.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">11.0</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">11.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">3.2</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">3.2</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">3.2</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">15.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">15.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">15.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">3.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">27.5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">15.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">20.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">20.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb573"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb573-1"><a href="simulace4.html#cb573-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb573-2"><a href="simulace4.html#cb573-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb573-3"><a href="simulace4.html#cb573-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb573-4"><a href="simulace4.html#cb573-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb573-5"><a href="simulace4.html#cb573-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb573-6"><a href="simulace4.html#cb573-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb573-7"><a href="simulace4.html#cb573-7" tabindex="-1"></a></span>
<span id="cb573-8"><a href="simulace4.html#cb573-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb573-9"><a href="simulace4.html#cb573-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb573-10"><a href="simulace4.html#cb573-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb573-11"><a href="simulace4.html#cb573-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb573-12"><a href="simulace4.html#cb573-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb573-13"><a href="simulace4.html#cb573-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb573-14"><a href="simulace4.html#cb573-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb573-15"><a href="simulace4.html#cb573-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb573-16"><a href="simulace4.html#cb573-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb573-17"><a href="simulace4.html#cb573-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-137"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-137-1.png" alt="Histograms of hyperparameter values for KNN, functional logistic regression, and the number of principal components." width="672" />
<p class="caption">
Figure 5.14: Histograms of hyperparameter values for KNN, functional logistic regression, and the number of principal components.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb574"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb574-1"><a href="simulace4.html#cb574-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb574-2"><a href="simulace4.html#cb574-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb574-3"><a href="simulace4.html#cb574-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb574-4"><a href="simulace4.html#cb574-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb574-5"><a href="simulace4.html#cb574-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb574-6"><a href="simulace4.html#cb574-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb574-7"><a href="simulace4.html#cb574-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb574-8"><a href="simulace4.html#cb574-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb574-9"><a href="simulace4.html#cb574-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb574-10"><a href="simulace4.html#cb574-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-139"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-139-1.png" alt="Histograms of hyperparameter values for SVM with projection onto B-spline basis." width="672" />
<p class="caption">
Figure 5.15: Histograms of hyperparameter values for SVM with projection onto B-spline basis.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb575"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb575-1"><a href="simulace4.html#cb575-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb575-2"><a href="simulace4.html#cb575-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb575-3"><a href="simulace4.html#cb575-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb575-4"><a href="simulace4.html#cb575-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb575-5"><a href="simulace4.html#cb575-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb575-6"><a href="simulace4.html#cb575-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb575-7"><a href="simulace4.html#cb575-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb575-8"><a href="simulace4.html#cb575-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb575-9"><a href="simulace4.html#cb575-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb575-10"><a href="simulace4.html#cb575-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb575-11"><a href="simulace4.html#cb575-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb575-12"><a href="simulace4.html#cb575-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-141"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-141-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with radial kernel." width="672" />
<p class="caption">
Figure 5.16: Histograms of hyperparameter values for RKHS + SVM with radial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb576"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb576-1"><a href="simulace4.html#cb576-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb576-2"><a href="simulace4.html#cb576-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb576-3"><a href="simulace4.html#cb576-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb576-4"><a href="simulace4.html#cb576-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb576-5"><a href="simulace4.html#cb576-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb576-6"><a href="simulace4.html#cb576-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb576-7"><a href="simulace4.html#cb576-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb576-8"><a href="simulace4.html#cb576-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb576-9"><a href="simulace4.html#cb576-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb576-10"><a href="simulace4.html#cb576-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb576-11"><a href="simulace4.html#cb576-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb576-12"><a href="simulace4.html#cb576-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-143"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-143-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with polynomial kernel." width="672" />
<p class="caption">
Figure 5.17: Histograms of hyperparameter values for RKHS + SVM with polynomial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb577"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb577-1"><a href="simulace4.html#cb577-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb577-2"><a href="simulace4.html#cb577-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb577-3"><a href="simulace4.html#cb577-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb577-4"><a href="simulace4.html#cb577-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb577-5"><a href="simulace4.html#cb577-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb577-6"><a href="simulace4.html#cb577-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb577-7"><a href="simulace4.html#cb577-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb577-8"><a href="simulace4.html#cb577-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb577-9"><a href="simulace4.html#cb577-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb577-10"><a href="simulace4.html#cb577-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb577-11"><a href="simulace4.html#cb577-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-145"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-145-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with linear kernel." width="672" />
<p class="caption">
Figure 5.18: Histograms of hyperparameter values for RKHS + SVM with linear kernel.
</p>
</div>
</div>
</div>
</div>
<div id="classification-based-on-the-second-derivative" class="section level2 hasAnchor" number="5.2">
<h2><span class="header-section-number">5.2</span> Classification Based on the Second Derivative<a href="simulace4.html#classification-based-on-the-second-derivative" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the previous section, we considered the first derivative of the curves. Now, let’s repeat the entire process with the second derivatives.
In each of the two classes, we will consider 100 observations, i.e., <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb578"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb578-1"><a href="simulace4.html#cb578-1" tabindex="-1"></a><span class="co"># number of generated observations for each class</span></span>
<span id="cb578-2"><a href="simulace4.html#cb578-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb578-3"><a href="simulace4.html#cb578-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb578-4"><a href="simulace4.html#cb578-4" tabindex="-1"></a><span class="co"># equidistant time vector on the interval [0, 6]</span></span>
<span id="cb578-5"><a href="simulace4.html#cb578-5" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb578-6"><a href="simulace4.html#cb578-6" tabindex="-1"></a></span>
<span id="cb578-7"><a href="simulace4.html#cb578-7" tabindex="-1"></a><span class="co"># for Y = 0</span></span>
<span id="cb578-8"><a href="simulace4.html#cb578-8" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb578-9"><a href="simulace4.html#cb578-9" tabindex="-1"></a><span class="co"># for Y = 1</span></span>
<span id="cb578-10"><a href="simulace4.html#cb578-10" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (yet unsmoothed) functions in color according to the class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb579"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb579-1"><a href="simulace4.html#cb579-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of curves to be plotted from each group</span></span>
<span id="cb579-2"><a href="simulace4.html#cb579-2" tabindex="-1"></a></span>
<span id="cb579-3"><a href="simulace4.html#cb579-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb579-4"><a href="simulace4.html#cb579-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb579-5"><a href="simulace4.html#cb579-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb579-6"><a href="simulace4.html#cb579-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb579-7"><a href="simulace4.html#cb579-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb579-8"><a href="simulace4.html#cb579-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb579-9"><a href="simulace4.html#cb579-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb579-10"><a href="simulace4.html#cb579-10" tabindex="-1"></a>  )</span>
<span id="cb579-11"><a href="simulace4.html#cb579-11" tabindex="-1"></a></span>
<span id="cb579-12"><a href="simulace4.html#cb579-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb579-13"><a href="simulace4.html#cb579-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb579-14"><a href="simulace4.html#cb579-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb579-15"><a href="simulace4.html#cb579-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb579-16"><a href="simulace4.html#cb579-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb579-17"><a href="simulace4.html#cb579-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb579-18"><a href="simulace4.html#cb579-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb579-19"><a href="simulace4.html#cb579-19" tabindex="-1"></a>  )</span>
<span id="cb579-20"><a href="simulace4.html#cb579-20" tabindex="-1"></a></span>
<span id="cb579-21"><a href="simulace4.html#cb579-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb579-22"><a href="simulace4.html#cb579-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb579-23"><a href="simulace4.html#cb579-23" tabindex="-1"></a></span>
<span id="cb579-24"><a href="simulace4.html#cb579-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb579-25"><a href="simulace4.html#cb579-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb579-26"><a href="simulace4.html#cb579-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb579-27"><a href="simulace4.html#cb579-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb579-28"><a href="simulace4.html#cb579-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb579-29"><a href="simulace4.html#cb579-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb579-30"><a href="simulace4.html#cb579-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb579-31"><a href="simulace4.html#cb579-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-148"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-148-1.png" alt="First 10 generated observations from each of the two classification classes. Observed data are not smoothed." width="672" />
<p class="caption">
Figure 5.19: First 10 generated observations from each of the two classification classes. Observed data are not smoothed.
</p>
</div>
<div id="smoothing-of-observed-curves" class="section level3 hasAnchor" number="5.2.1">
<h3><span class="header-section-number">5.2.1</span> Smoothing of Observed Curves<a href="simulace4.html#smoothing-of-observed-curves" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now we convert the observed discrete values (vectors of values) into functional objects, which we will work with subsequently.
We will again use the B-spline basis for smoothing.</p>
<p>We take the entire vector <code>t</code> as knots; since we are considering the first derivative, we set <code>norder = 6</code>.
We will penalize the fourth derivative of the functions, as we now require smooth second derivatives as well.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb580"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb580-1"><a href="simulace4.html#cb580-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb580-2"><a href="simulace4.html#cb580-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb580-3"><a href="simulace4.html#cb580-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb580-4"><a href="simulace4.html#cb580-4" tabindex="-1"></a></span>
<span id="cb580-5"><a href="simulace4.html#cb580-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb580-6"><a href="simulace4.html#cb580-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb580-7"><a href="simulace4.html#cb580-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb580-8"><a href="simulace4.html#cb580-8" tabindex="-1"></a></span>
<span id="cb580-9"><a href="simulace4.html#cb580-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">4</span>) <span class="co"># penalizing the 4th derivative</span></span></code></pre></div>
</details>
<p>We will find a suitable value for the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, i.e., generalized cross-validation.
We will consider the same value of <span class="math inline">\(\lambda\)</span> for both classification groups, as we would not know in advance which value of <span class="math inline">\(\lambda\)</span> to choose for test observations if different values were chosen for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb581"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb581-1"><a href="simulace4.html#cb581-1" tabindex="-1"></a><span class="co"># combining observations into a single matrix</span></span>
<span id="cb581-2"><a href="simulace4.html#cb581-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb581-3"><a href="simulace4.html#cb581-3" tabindex="-1"></a></span>
<span id="cb581-4"><a href="simulace4.html#cb581-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># lambda vector</span></span>
<span id="cb581-5"><a href="simulace4.html#cb581-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for storing GCV</span></span>
<span id="cb581-6"><a href="simulace4.html#cb581-6" tabindex="-1"></a></span>
<span id="cb581-7"><a href="simulace4.html#cb581-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb581-8"><a href="simulace4.html#cb581-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb581-9"><a href="simulace4.html#cb581-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb581-10"><a href="simulace4.html#cb581-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb581-11"><a href="simulace4.html#cb581-11" tabindex="-1"></a>}</span>
<span id="cb581-12"><a href="simulace4.html#cb581-12" tabindex="-1"></a></span>
<span id="cb581-13"><a href="simulace4.html#cb581-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb581-14"><a href="simulace4.html#cb581-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb581-15"><a href="simulace4.html#cb581-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb581-16"><a href="simulace4.html#cb581-16" tabindex="-1"></a>)</span>
<span id="cb581-17"><a href="simulace4.html#cb581-17" tabindex="-1"></a></span>
<span id="cb581-18"><a href="simulace4.html#cb581-18" tabindex="-1"></a><span class="co"># finding the minimum value</span></span>
<span id="cb581-19"><a href="simulace4.html#cb581-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>For better visualization, we will plot the course of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb582"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb582-1"><a href="simulace4.html#cb582-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb582-2"><a href="simulace4.html#cb582-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb582-3"><a href="simulace4.html#cb582-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb582-4"><a href="simulace4.html#cb582-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb582-5"><a href="simulace4.html#cb582-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb582-6"><a href="simulace4.html#cb582-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb582-7"><a href="simulace4.html#cb582-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb582-8"><a href="simulace4.html#cb582-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-151"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-151-1.png" alt="Course of $GCV(\lambda)$ for the chosen vector $\boldsymbol\lambda$. Values on the $x$ axis are displayed on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is shown in red." width="672" />
<p class="caption">
Figure 5.20: Course of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen vector <span class="math inline">\(\boldsymbol\lambda\)</span>. Values on the <span class="math inline">\(x\)</span> axis are displayed on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is shown in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically illustrate the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb584"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb584-1"><a href="simulace4.html#cb584-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb584-2"><a href="simulace4.html#cb584-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb584-3"><a href="simulace4.html#cb584-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb584-4"><a href="simulace4.html#cb584-4" tabindex="-1"></a></span>
<span id="cb584-5"><a href="simulace4.html#cb584-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb584-6"><a href="simulace4.html#cb584-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb584-7"><a href="simulace4.html#cb584-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb584-8"><a href="simulace4.html#cb584-8" tabindex="-1"></a></span>
<span id="cb584-9"><a href="simulace4.html#cb584-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb584-10"><a href="simulace4.html#cb584-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb584-11"><a href="simulace4.html#cb584-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb584-12"><a href="simulace4.html#cb584-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb584-13"><a href="simulace4.html#cb584-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb584-14"><a href="simulace4.html#cb584-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb584-15"><a href="simulace4.html#cb584-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb584-16"><a href="simulace4.html#cb584-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-152"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-152-1.png" alt="First 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.29: First 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s also illustrate all curves, including the mean, separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb585"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb585-1"><a href="simulace4.html#cb585-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb585-2"><a href="simulace4.html#cb585-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb585-3"><a href="simulace4.html#cb585-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb585-4"><a href="simulace4.html#cb585-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb585-5"><a href="simulace4.html#cb585-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb585-6"><a href="simulace4.html#cb585-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb585-7"><a href="simulace4.html#cb585-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb585-8"><a href="simulace4.html#cb585-8" tabindex="-1"></a>)</span>
<span id="cb585-9"><a href="simulace4.html#cb585-9" tabindex="-1"></a></span>
<span id="cb585-10"><a href="simulace4.html#cb585-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb585-11"><a href="simulace4.html#cb585-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb585-12"><a href="simulace4.html#cb585-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb585-13"><a href="simulace4.html#cb585-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb585-14"><a href="simulace4.html#cb585-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb585-15"><a href="simulace4.html#cb585-15" tabindex="-1"></a>)</span>
<span id="cb585-16"><a href="simulace4.html#cb585-16" tabindex="-1"></a></span>
<span id="cb585-17"><a href="simulace4.html#cb585-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb585-18"><a href="simulace4.html#cb585-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb585-19"><a href="simulace4.html#cb585-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb585-20"><a href="simulace4.html#cb585-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb585-21"><a href="simulace4.html#cb585-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb585-22"><a href="simulace4.html#cb585-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb585-23"><a href="simulace4.html#cb585-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb585-24"><a href="simulace4.html#cb585-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb585-25"><a href="simulace4.html#cb585-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb585-26"><a href="simulace4.html#cb585-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb585-27"><a href="simulace4.html#cb585-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb585-28"><a href="simulace4.html#cb585-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb585-29"><a href="simulace4.html#cb585-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="co">#, limits = c(-1, 2))</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-153"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-153-1.png" alt="Plot of all smoothed observed curves, with curves color-coded by classification class. The mean for each class is shown with a thick line." width="672" />
<p class="caption">
Figure 5.21: Plot of all smoothed observed curves, with curves color-coded by classification class. The mean for each class is shown with a thick line.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb586"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb586-1"><a href="simulace4.html#cb586-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb586-2"><a href="simulace4.html#cb586-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb586-3"><a href="simulace4.html#cb586-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb586-4"><a href="simulace4.html#cb586-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb586-5"><a href="simulace4.html#cb586-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb586-6"><a href="simulace4.html#cb586-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb586-7"><a href="simulace4.html#cb586-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb586-8"><a href="simulace4.html#cb586-8" tabindex="-1"></a>)</span>
<span id="cb586-9"><a href="simulace4.html#cb586-9" tabindex="-1"></a></span>
<span id="cb586-10"><a href="simulace4.html#cb586-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb586-11"><a href="simulace4.html#cb586-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb586-12"><a href="simulace4.html#cb586-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb586-13"><a href="simulace4.html#cb586-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb586-14"><a href="simulace4.html#cb586-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb586-15"><a href="simulace4.html#cb586-15" tabindex="-1"></a>)</span>
<span id="cb586-16"><a href="simulace4.html#cb586-16" tabindex="-1"></a></span>
<span id="cb586-17"><a href="simulace4.html#cb586-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb586-18"><a href="simulace4.html#cb586-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb586-19"><a href="simulace4.html#cb586-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb586-20"><a href="simulace4.html#cb586-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb586-21"><a href="simulace4.html#cb586-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb586-22"><a href="simulace4.html#cb586-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb586-23"><a href="simulace4.html#cb586-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb586-24"><a href="simulace4.html#cb586-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb586-25"><a href="simulace4.html#cb586-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb586-26"><a href="simulace4.html#cb586-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb586-27"><a href="simulace4.html#cb586-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb586-28"><a href="simulace4.html#cb586-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb586-29"><a href="simulace4.html#cb586-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-154"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-154-1.png" alt="Plot of all smoothed observed curves, with curves color-coded by classification class. The mean for each class is shown with a thick line. Close-up view." width="672" />
<p class="caption">
Figure 1.30: Plot of all smoothed observed curves, with curves color-coded by classification class. The mean for each class is shown with a thick line. Close-up view.
</p>
</div>
</div>
<div id="derivative-calculation" class="section level3 hasAnchor" number="5.2.2">
<h3><span class="header-section-number">5.2.2</span> Derivative Calculation<a href="simulace4.html#derivative-calculation" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>To calculate the derivative for a functional object, we use the <code>deriv.fd()</code> function from the <code>fda</code> package in <code>R</code>. Since we aim to classify based on the second derivative, we set the argument <code>Lfdobj = 2</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb587"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb587-1"><a href="simulace4.html#cb587-1" tabindex="-1"></a>XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>Now, let’s plot the first few derivatives for both classification classes. Notice from the figure below that the vertical shift was effectively removed through differentiation. However, this also reduced the distinctiveness between the curves, as the differences in the derivative curves between the two classes primarily occur toward the end of the interval, approximately in the range <span class="math inline">\([5, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb588"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb588-1"><a href="simulace4.html#cb588-1" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> t)</span>
<span id="cb588-2"><a href="simulace4.html#cb588-2" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb588-3"><a href="simulace4.html#cb588-3" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb588-4"><a href="simulace4.html#cb588-4" tabindex="-1"></a></span>
<span id="cb588-5"><a href="simulace4.html#cb588-5" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb588-6"><a href="simulace4.html#cb588-6" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb588-7"><a href="simulace4.html#cb588-7" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb588-8"><a href="simulace4.html#cb588-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb588-9"><a href="simulace4.html#cb588-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb588-10"><a href="simulace4.html#cb588-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb588-11"><a href="simulace4.html#cb588-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb588-12"><a href="simulace4.html#cb588-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<p><img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-156-1.png" width="672" /></p>
<p>Let’s now illustrate all curves, including the mean for each class separately.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb589"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb589-1"><a href="simulace4.html#cb589-1" tabindex="-1"></a>abs.labs <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Class:&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;$Y = 0$&quot;</span>, <span class="st">&quot;$Y = 1$&quot;</span>))</span>
<span id="cb589-2"><a href="simulace4.html#cb589-2" tabindex="-1"></a><span class="fu">names</span>(abs.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>)</span>
<span id="cb589-3"><a href="simulace4.html#cb589-3" tabindex="-1"></a></span>
<span id="cb589-4"><a href="simulace4.html#cb589-4" tabindex="-1"></a>tt <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(t), <span class="fu">max</span>(t), <span class="at">length =</span> <span class="dv">91</span>)</span>
<span id="cb589-5"><a href="simulace4.html#cb589-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> tt)</span>
<span id="cb589-6"><a href="simulace4.html#cb589-6" tabindex="-1"></a></span>
<span id="cb589-7"><a href="simulace4.html#cb589-7" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb589-8"><a href="simulace4.html#cb589-8" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(tt, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb589-9"><a href="simulace4.html#cb589-9" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(tt)), <span class="dv">2</span>),</span>
<span id="cb589-10"><a href="simulace4.html#cb589-10" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb589-11"><a href="simulace4.html#cb589-11" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(tt)))</span>
<span id="cb589-12"><a href="simulace4.html#cb589-12" tabindex="-1"></a>)</span>
<span id="cb589-13"><a href="simulace4.html#cb589-13" tabindex="-1"></a></span>
<span id="cb589-14"><a href="simulace4.html#cb589-14" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb589-15"><a href="simulace4.html#cb589-15" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(tt, <span class="dv">2</span>),</span>
<span id="cb589-16"><a href="simulace4.html#cb589-16" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[<span class="dv">1</span><span class="sc">:</span>n]), <span class="at">evalarg =</span> tt),</span>
<span id="cb589-17"><a href="simulace4.html#cb589-17" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXder[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> n)]), <span class="at">evalarg =</span> tt)),</span>
<span id="cb589-18"><a href="simulace4.html#cb589-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(tt)))</span>
<span id="cb589-19"><a href="simulace4.html#cb589-19" tabindex="-1"></a>)</span>
<span id="cb589-20"><a href="simulace4.html#cb589-20" tabindex="-1"></a></span>
<span id="cb589-21"><a href="simulace4.html#cb589-21" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb589-22"><a href="simulace4.html#cb589-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb589-23"><a href="simulace4.html#cb589-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb589-24"><a href="simulace4.html#cb589-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;$t$&quot;</span>,</span>
<span id="cb589-25"><a href="simulace4.html#cb589-25" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$x_i&#39;(t)$&quot;</span>,</span>
<span id="cb589-26"><a href="simulace4.html#cb589-26" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb589-27"><a href="simulace4.html#cb589-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean <span class="sc">|&gt;</span> </span>
<span id="cb589-28"><a href="simulace4.html#cb589-28" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;0&#39;</span>))),</span>
<span id="cb589-29"><a href="simulace4.html#cb589-29" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb589-30"><a href="simulace4.html#cb589-30" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb589-31"><a href="simulace4.html#cb589-31" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb589-32"><a href="simulace4.html#cb589-32" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb589-33"><a href="simulace4.html#cb589-33" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb589-34"><a href="simulace4.html#cb589-34" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group =</span> abs.labs)) <span class="sc">+</span></span>
<span id="cb589-35"><a href="simulace4.html#cb589-35" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb589-36"><a href="simulace4.html#cb589-36" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb589-37"><a href="simulace4.html#cb589-37" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb589-38"><a href="simulace4.html#cb589-38" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">20</span>, <span class="dv">20</span>)) <span class="sc">+</span></span>
<span id="cb589-39"><a href="simulace4.html#cb589-39" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-158"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-158-1.png" alt="Plotting all smoothed observed curves, with color differentiation according to class. The mean for each class is shown by a black line." width="672" />
<p class="caption">
Figure 1.32: Plotting all smoothed observed curves, with color differentiation according to class. The mean for each class is shown by a black line.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb590"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb590-1"><a href="simulace4.html#cb590-1" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> t)</span>
<span id="cb590-2"><a href="simulace4.html#cb590-2" tabindex="-1"></a></span>
<span id="cb590-3"><a href="simulace4.html#cb590-3" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb590-4"><a href="simulace4.html#cb590-4" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb590-5"><a href="simulace4.html#cb590-5" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb590-6"><a href="simulace4.html#cb590-6" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb590-7"><a href="simulace4.html#cb590-7" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb590-8"><a href="simulace4.html#cb590-8" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb590-9"><a href="simulace4.html#cb590-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb590-10"><a href="simulace4.html#cb590-10" tabindex="-1"></a>)</span>
<span id="cb590-11"><a href="simulace4.html#cb590-11" tabindex="-1"></a></span>
<span id="cb590-12"><a href="simulace4.html#cb590-12" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb590-13"><a href="simulace4.html#cb590-13" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb590-14"><a href="simulace4.html#cb590-14" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb590-15"><a href="simulace4.html#cb590-15" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb590-16"><a href="simulace4.html#cb590-16" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb590-17"><a href="simulace4.html#cb590-17" tabindex="-1"></a>)</span>
<span id="cb590-18"><a href="simulace4.html#cb590-18" tabindex="-1"></a></span>
<span id="cb590-19"><a href="simulace4.html#cb590-19" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb590-20"><a href="simulace4.html#cb590-20" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb590-21"><a href="simulace4.html#cb590-21" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb590-22"><a href="simulace4.html#cb590-22" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb590-23"><a href="simulace4.html#cb590-23" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb590-24"><a href="simulace4.html#cb590-24" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb590-25"><a href="simulace4.html#cb590-25" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb590-26"><a href="simulace4.html#cb590-26" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb590-27"><a href="simulace4.html#cb590-27" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean), <span class="at">colour =</span> <span class="st">&#39;grey3&#39;</span>, </span>
<span id="cb590-28"><a href="simulace4.html#cb590-28" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.7</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb590-29"><a href="simulace4.html#cb590-29" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb590-30"><a href="simulace4.html#cb590-30" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">12</span>, <span class="dv">10</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-159"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-159-1.png" alt="Plotting all smoothed observed curves, with color differentiation according to class. The mean for each class is shown by a black line. Zoomed view." width="672" />
<p class="caption">
Figure 5.22: Plotting all smoothed observed curves, with color differentiation according to class. The mean for each class is shown by a black line. Zoomed view.
</p>
</div>
</div>
<div id="classification-of-curves-4" class="section level3 hasAnchor" number="5.2.3">
<h3><span class="header-section-number">5.2.3</span> Classification of Curves<a href="simulace4.html#classification-of-curves-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb591"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb591-1"><a href="simulace4.html#cb591-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training sets</span></span>
<span id="cb591-2"><a href="simulace4.html#cb591-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb591-3"><a href="simulace4.html#cb591-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb591-4"><a href="simulace4.html#cb591-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb591-5"><a href="simulace4.html#cb591-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb591-6"><a href="simulace4.html#cb591-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb591-7"><a href="simulace4.html#cb591-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for logistic regression on scores</span></span>
<span id="cb591-8"><a href="simulace4.html#cb591-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for logistic regression on scores</span></span>
<span id="cb591-9"><a href="simulace4.html#cb591-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb591-10"><a href="simulace4.html#cb591-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># decision trees</span></span>
<span id="cb591-11"><a href="simulace4.html#cb591-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># visualization</span></span>
<span id="cb591-12"><a href="simulace4.html#cb591-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb591-13"><a href="simulace4.html#cb591-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># random forest</span></span></code></pre></div>
</details>
<p>To compare individual classifiers, we will split the generated observations into two parts in a 70:30 ratio for training and testing (validation) sets. The training set will be used to construct the classifier, while the test set will be used to calculate the classification error and potentially other characteristics of our model. The resulting classifiers can then be compared based on these computed characteristics in terms of their classification success.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb592"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb592-1"><a href="simulace4.html#cb592-1" tabindex="-1"></a><span class="co"># splitting into test and training sets</span></span>
<span id="cb592-2"><a href="simulace4.html#cb592-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb592-3"><a href="simulace4.html#cb592-3" tabindex="-1"></a></span>
<span id="cb592-4"><a href="simulace4.html#cb592-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb592-5"><a href="simulace4.html#cb592-5" tabindex="-1"></a></span>
<span id="cb592-6"><a href="simulace4.html#cb592-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb592-7"><a href="simulace4.html#cb592-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb592-8"><a href="simulace4.html#cb592-8" tabindex="-1"></a></span>
<span id="cb592-9"><a href="simulace4.html#cb592-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb592-10"><a href="simulace4.html#cb592-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, we will examine the representation of individual groups in the test and training portions of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb593"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb593-1"><a href="simulace4.html#cb593-1" tabindex="-1"></a><span class="co"># absolute representation</span></span>
<span id="cb593-2"><a href="simulace4.html#cb593-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb595"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb595-1"><a href="simulace4.html#cb595-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb597"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb597-1"><a href="simulace4.html#cb597-1" tabindex="-1"></a><span class="co"># relative representation</span></span>
<span id="cb597-2"><a href="simulace4.html#cb597-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb599"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb599-1"><a href="simulace4.html#cb599-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nearest-neighbors-4" class="section level4 hasAnchor" number="5.2.3.1">
<h4><span class="header-section-number">5.2.3.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="simulace4.html#k-nearest-neighbors-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start with a non-parametric classification method, specifically the <span class="math inline">\(K\)</span> nearest neighbors method. First, we will create the necessary objects so that we can work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb601"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb601-1"><a href="simulace4.html#cb601-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb601-2"><a href="simulace4.html#cb601-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and look at its classification success. The last question remains how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>. We could choose this number as the value of <span class="math inline">\(K\)</span> that results in the minimum error rate on the training data. However, this could lead to overfitting the model, so we will use cross-validation. Given the computational complexity and size of the dataset, we will opt for <span class="math inline">\(k\)</span>-fold CV; we will choose a value of <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb602"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb602-1"><a href="simulace4.html#cb602-1" tabindex="-1"></a><span class="co"># model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb602-2"><a href="simulace4.html#cb602-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb602-3"><a href="simulace4.html#cb602-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb602-4"><a href="simulace4.html#cb602-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb602-5"><a href="simulace4.html#cb602-5" tabindex="-1"></a></span>
<span id="cb602-6"><a href="simulace4.html#cb602-6" tabindex="-1"></a><span class="co"># summary(neighb.model) # summary of the model</span></span>
<span id="cb602-7"><a href="simulace4.html#cb602-7" tabindex="-1"></a><span class="co"># plot(neighb.model$gcv, pch = 16) # plot GCV dependence on the number of neighbors K</span></span>
<span id="cb602-8"><a href="simulace4.html#cb602-8" tabindex="-1"></a><span class="co"># neighb.model$max.prob # maximum accuracy</span></span>
<span id="cb602-9"><a href="simulace4.html#cb602-9" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 12</code></pre>
<p>Let’s proceed with the previous procedure for the training data, which we will split into <span class="math inline">\(k\)</span> parts and repeat this code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb604"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb604-1"><a href="simulace4.html#cb604-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb604-2"><a href="simulace4.html#cb604-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb604-3"><a href="simulace4.html#cb604-3" tabindex="-1"></a></span>
<span id="cb604-4"><a href="simulace4.html#cb604-4" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb604-5"><a href="simulace4.html#cb604-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb604-6"><a href="simulace4.html#cb604-6" tabindex="-1"></a></span>
<span id="cb604-7"><a href="simulace4.html#cb604-7" tabindex="-1"></a><span class="co"># empty matrix to store the results</span></span>
<span id="cb604-8"><a href="simulace4.html#cb604-8" tabindex="-1"></a><span class="co"># columns will contain accuracy values for the corresponding part of the training set</span></span>
<span id="cb604-9"><a href="simulace4.html#cb604-9" tabindex="-1"></a><span class="co"># rows will contain values for the given number of neighbors K</span></span>
<span id="cb604-10"><a href="simulace4.html#cb604-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb604-11"><a href="simulace4.html#cb604-11" tabindex="-1"></a></span>
<span id="cb604-12"><a href="simulace4.html#cb604-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb604-13"><a href="simulace4.html#cb604-13" tabindex="-1"></a>  <span class="co"># define the current index set</span></span>
<span id="cb604-14"><a href="simulace4.html#cb604-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb604-15"><a href="simulace4.html#cb604-15" tabindex="-1"></a>    </span>
<span id="cb604-16"><a href="simulace4.html#cb604-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb604-17"><a href="simulace4.html#cb604-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb604-18"><a href="simulace4.html#cb604-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb604-19"><a href="simulace4.html#cb604-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb604-20"><a href="simulace4.html#cb604-20" tabindex="-1"></a>  </span>
<span id="cb604-21"><a href="simulace4.html#cb604-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb604-22"><a href="simulace4.html#cb604-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb604-23"><a href="simulace4.html#cb604-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb604-24"><a href="simulace4.html#cb604-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb604-25"><a href="simulace4.html#cb604-25" tabindex="-1"></a>  </span>
<span id="cb604-26"><a href="simulace4.html#cb604-26" tabindex="-1"></a>  <span class="co"># iterate over each part ... repeat k times</span></span>
<span id="cb604-27"><a href="simulace4.html#cb604-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb604-28"><a href="simulace4.html#cb604-28" tabindex="-1"></a>    <span class="co"># model for specific choice of K</span></span>
<span id="cb604-29"><a href="simulace4.html#cb604-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb604-30"><a href="simulace4.html#cb604-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb604-31"><a href="simulace4.html#cb604-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb604-32"><a href="simulace4.html#cb604-32" tabindex="-1"></a>    <span class="co"># predictions on validation set</span></span>
<span id="cb604-33"><a href="simulace4.html#cb604-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb604-34"><a href="simulace4.html#cb604-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb604-35"><a href="simulace4.html#cb604-35" tabindex="-1"></a>    <span class="co"># accuracy on validation set</span></span>
<span id="cb604-36"><a href="simulace4.html#cb604-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb604-37"><a href="simulace4.html#cb604-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb604-38"><a href="simulace4.html#cb604-38" tabindex="-1"></a>    </span>
<span id="cb604-39"><a href="simulace4.html#cb604-39" tabindex="-1"></a>    <span class="co"># store accuracy in the position for given K and fold</span></span>
<span id="cb604-40"><a href="simulace4.html#cb604-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb604-41"><a href="simulace4.html#cb604-41" tabindex="-1"></a>  }</span>
<span id="cb604-42"><a href="simulace4.html#cb604-42" tabindex="-1"></a>}</span>
<span id="cb604-43"><a href="simulace4.html#cb604-43" tabindex="-1"></a></span>
<span id="cb604-44"><a href="simulace4.html#cb604-44" tabindex="-1"></a><span class="co"># compute average accuracies for individual K across folds</span></span>
<span id="cb604-45"><a href="simulace4.html#cb604-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb604-46"><a href="simulace4.html#cb604-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb604-47"><a href="simulace4.html#cb604-47" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb604-48"><a href="simulace4.html#cb604-48" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>We can see that the best value for the parameter <span class="math inline">\(K\)</span> is 12, with an error rate calculated using 10-fold CV of 0.1617.</p>
<p>For clarity, let’s also plot the validation error rate as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb605"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb605-1"><a href="simulace4.html#cb605-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb605-2"><a href="simulace4.html#cb605-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb605-3"><a href="simulace4.html#cb605-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb605-4"><a href="simulace4.html#cb605-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb605-5"><a href="simulace4.html#cb605-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb605-6"><a href="simulace4.html#cb605-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb605-7"><a href="simulace4.html#cb605-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb605-8"><a href="simulace4.html#cb605-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb605-9"><a href="simulace4.html#cb605-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb605-10"><a href="simulace4.html#cb605-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 24 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-166"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-166-1.png" alt="Dependency of validation error rate on the value of $K$, i.e., on the number of neighbors." width="672" />
<p class="caption">
Figure 5.23: Dependency of validation error rate on the value of <span class="math inline">\(K\)</span>, i.e., on the number of neighbors.
</p>
</div>
<p>Now that we have determined the optimal value of the parameter <span class="math inline">\(K\)</span>, we can build the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb607"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb607-1"><a href="simulace4.html#cb607-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb607-2"><a href="simulace4.html#cb607-2" tabindex="-1"></a></span>
<span id="cb607-3"><a href="simulace4.html#cb607-3" tabindex="-1"></a><span class="co"># predictions</span></span>
<span id="cb607-4"><a href="simulace4.html#cb607-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb607-5"><a href="simulace4.html#cb607-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb607-6"><a href="simulace4.html#cb607-6" tabindex="-1"></a></span>
<span id="cb607-7"><a href="simulace4.html#cb607-7" tabindex="-1"></a><span class="co"># summary(neighb.model)</span></span>
<span id="cb607-8"><a href="simulace4.html#cb607-8" tabindex="-1"></a></span>
<span id="cb607-9"><a href="simulace4.html#cb607-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb607-10"><a href="simulace4.html#cb607-10" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb607-11"><a href="simulace4.html#cb607-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb607-12"><a href="simulace4.html#cb607-12" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb607-13"><a href="simulace4.html#cb607-13" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb607-14"><a href="simulace4.html#cb607-14" tabindex="-1"></a><span class="co"># error rate</span></span>
<span id="cb607-15"><a href="simulace4.html#cb607-15" tabindex="-1"></a><span class="co"># 1 - accuracy</span></span></code></pre></div>
</details>
<p>Thus, the error rate of the model constructed using the <span class="math inline">\(K\)</span>-nearest neighbors method with the optimal choice of <span class="math inline">\(K_{optimal}\)</span> equal to 12, determined by cross-validation, is 0.15 on the training data and 0.15 on the test data.</p>
<p>To compare different models, we can use both types of error rates, which we will store in a table for clarity.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb608"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb608-1"><a href="simulace4.html#cb608-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb608-2"><a href="simulace4.html#cb608-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb608-3"><a href="simulace4.html#cb608-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-4" class="section level4 hasAnchor" number="5.2.3.2">
<h4><span class="header-section-number">5.2.3.2</span> Linear Discriminant Analysis<a href="simulace4.html#linear-discriminant-analysis-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>As the second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied to functional data, we must first discretize the data, which we will do using Functional Principal Component Analysis (FPCA). We will then perform the classification algorithm on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>First, let’s perform the functional principal component analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb609"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb609-1"><a href="simulace4.html#cb609-1" tabindex="-1"></a><span class="co"># principal component analysis</span></span>
<span id="cb609-2"><a href="simulace4.html#cb609-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of PCs</span></span>
<span id="cb609-3"><a href="simulace4.html#cb609-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determine p</span></span>
<span id="cb609-4"><a href="simulace4.html#cb609-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb609-5"><a href="simulace4.html#cb609-5" tabindex="-1"></a></span>
<span id="cb609-6"><a href="simulace4.html#cb609-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb609-7"><a href="simulace4.html#cb609-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p PCs</span></span>
<span id="cb609-8"><a href="simulace4.html#cb609-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># class membership</span></span></code></pre></div>
</details>
<p>In this particular case, we took the number of principal components as <span class="math inline">\(p\)</span> = 3, which together explain 90.88 % of the variability in the data. The first principal component explains 45.83 % and the second 36.91 % of the variability. We can graphically display the scores of the first two principal components, color-coded according to class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb610"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb610-1"><a href="simulace4.html#cb610-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb610-2"><a href="simulace4.html#cb610-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb610-3"><a href="simulace4.html#cb610-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb610-4"><a href="simulace4.html#cb610-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb610-5"><a href="simulace4.html#cb610-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb610-6"><a href="simulace4.html#cb610-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb610-7"><a href="simulace4.html#cb610-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb610-8"><a href="simulace4.html#cb610-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb610-9"><a href="simulace4.html#cb610-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-170"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-170-1.png" alt="Scores of the first two principal components for the training data. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 5.24: Scores of the first two principal components for the training data. Points are color-coded according to class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to calculate the scores for the first 3 principal components for the test data. These scores are determined using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text{ dt},
\]</span></p>
<p>where <span class="math inline">\(\mu(t)\)</span> is the mean function and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb611"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb611-1"><a href="simulace4.html#cb611-1" tabindex="-1"></a><span class="co"># compute scores for test functions</span></span>
<span id="cb611-2"><a href="simulace4.html#cb611-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix </span></span>
<span id="cb611-3"><a href="simulace4.html#cb611-3" tabindex="-1"></a></span>
<span id="cb611-4"><a href="simulace4.html#cb611-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb611-5"><a href="simulace4.html#cb611-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb611-6"><a href="simulace4.html#cb611-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb611-7"><a href="simulace4.html#cb611-7" tabindex="-1"></a>  <span class="co"># scalar product of residuals and eigenfunctions (functional principal components)</span></span>
<span id="cb611-8"><a href="simulace4.html#cb611-8" tabindex="-1"></a>}</span>
<span id="cb611-9"><a href="simulace4.html#cb611-9" tabindex="-1"></a></span>
<span id="cb611-10"><a href="simulace4.html#cb611-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb611-11"><a href="simulace4.html#cb611-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb611-12"><a href="simulace4.html#cb611-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training portion of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb612"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb612-1"><a href="simulace4.html#cb612-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb612-2"><a href="simulace4.html#cb612-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb612-3"><a href="simulace4.html#cb612-3" tabindex="-1"></a></span>
<span id="cb612-4"><a href="simulace4.html#cb612-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb612-5"><a href="simulace4.html#cb612-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb612-6"><a href="simulace4.html#cb612-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb612-7"><a href="simulace4.html#cb612-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb612-8"><a href="simulace4.html#cb612-8" tabindex="-1"></a>  </span>
<span id="cb612-9"><a href="simulace4.html#cb612-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb612-10"><a href="simulace4.html#cb612-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb612-11"><a href="simulace4.html#cb612-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb612-12"><a href="simulace4.html#cb612-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training (13.57 %) and on the test data (18.33 %).</p>
<p>To visually represent the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb613"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb613-1"><a href="simulace4.html#cb613-1" tabindex="-1"></a><span class="co"># add decision boundary</span></span>
<span id="cb613-2"><a href="simulace4.html#cb613-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb613-3"><a href="simulace4.html#cb613-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb613-4"><a href="simulace4.html#cb613-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb613-5"><a href="simulace4.html#cb613-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb613-6"><a href="simulace4.html#cb613-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb613-7"><a href="simulace4.html#cb613-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb613-8"><a href="simulace4.html#cb613-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb613-9"><a href="simulace4.html#cb613-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb613-10"><a href="simulace4.html#cb613-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb613-11"><a href="simulace4.html#cb613-11" tabindex="-1"></a><span class="co"># if p = 3</span></span>
<span id="cb613-12"><a href="simulace4.html#cb613-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb613-13"><a href="simulace4.html#cb613-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb613-14"><a href="simulace4.html#cb613-14" tabindex="-1"></a><span class="co"># if p = 4</span></span>
<span id="cb613-15"><a href="simulace4.html#cb613-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb613-16"><a href="simulace4.html#cb613-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb613-17"><a href="simulace4.html#cb613-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb613-18"><a href="simulace4.html#cb613-18" tabindex="-1"></a><span class="co"># if p = 5</span></span>
<span id="cb613-19"><a href="simulace4.html#cb613-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb613-20"><a href="simulace4.html#cb613-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb613-21"><a href="simulace4.html#cb613-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb613-22"><a href="simulace4.html#cb613-22" tabindex="-1"></a></span>
<span id="cb613-23"><a href="simulace4.html#cb613-23" tabindex="-1"></a><span class="co"># add Y = 0, 1</span></span>
<span id="cb613-24"><a href="simulace4.html#cb613-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb613-25"><a href="simulace4.html#cb613-25" tabindex="-1"></a></span>
<span id="cb613-26"><a href="simulace4.html#cb613-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb613-27"><a href="simulace4.html#cb613-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb613-28"><a href="simulace4.html#cb613-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb613-29"><a href="simulace4.html#cb613-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb613-30"><a href="simulace4.html#cb613-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb613-31"><a href="simulace4.html#cb613-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb613-32"><a href="simulace4.html#cb613-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb613-33"><a href="simulace4.html#cb613-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb613-34"><a href="simulace4.html#cb613-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb613-35"><a href="simulace4.html#cb613-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-173"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-173-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black." width="672" />
<p class="caption">
Figure 5.25: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black.
</p>
</div>
<p>We see that the decision boundary is a line, a linear function in the 2D space, which is indeed what we expected from LDA. Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb614"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb614-1"><a href="simulace4.html#cb614-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb614-2"><a href="simulace4.html#cb614-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb614-3"><a href="simulace4.html#cb614-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb614-4"><a href="simulace4.html#cb614-4" tabindex="-1"></a></span>
<span id="cb614-5"><a href="simulace4.html#cb614-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-4" class="section level4 hasAnchor" number="5.2.3.3">
<h4><span class="header-section-number">5.2.3.3</span> Quadratic Discriminant Analysis<a href="simulace4.html#quadratic-discriminant-analysis-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Next, we will construct a classifier using Quadratic Discriminant Analysis (QDA). This is an analogous case to LDA, with the difference that we now allow for different covariance matrices for each of the classes from which the corresponding scores are drawn. This relaxed assumption of equal covariance matrices leads to a quadratic boundary between the classes.</p>
<p>In <code>R</code>, we perform QDA similarly to how we did LDA in the previous section. We will compute the scores for the training and test functions using the results from the functional Principal Component Analysis (PCA) obtained earlier.</p>
<p>Thus, we can proceed directly to constructing the classifier using the <code>qda()</code> function. We will then calculate the accuracy of the classifier on both test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb615"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb615-1"><a href="simulace4.html#cb615-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb615-2"><a href="simulace4.html#cb615-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb615-3"><a href="simulace4.html#cb615-3" tabindex="-1"></a></span>
<span id="cb615-4"><a href="simulace4.html#cb615-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb615-5"><a href="simulace4.html#cb615-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb615-6"><a href="simulace4.html#cb615-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb615-7"><a href="simulace4.html#cb615-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb615-8"><a href="simulace4.html#cb615-8" tabindex="-1"></a>  </span>
<span id="cb615-9"><a href="simulace4.html#cb615-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb615-10"><a href="simulace4.html#cb615-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb615-11"><a href="simulace4.html#cb615-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb615-12"><a href="simulace4.html#cb615-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training (14.29 %) and test data (15 %).</p>
<p>To visually represent the method, we can indicate the decision boundary in the plot of the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just like in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb616"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb616-1"><a href="simulace4.html#cb616-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb616-2"><a href="simulace4.html#cb616-2" tabindex="-1"></a></span>
<span id="cb616-3"><a href="simulace4.html#cb616-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb616-4"><a href="simulace4.html#cb616-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb616-5"><a href="simulace4.html#cb616-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb616-6"><a href="simulace4.html#cb616-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb616-7"><a href="simulace4.html#cb616-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb616-8"><a href="simulace4.html#cb616-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb616-9"><a href="simulace4.html#cb616-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb616-10"><a href="simulace4.html#cb616-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb616-11"><a href="simulace4.html#cb616-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb616-12"><a href="simulace4.html#cb616-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-176"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-176-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is marked in black." width="672" />
<p class="caption">
Figure 5.26: Scores of the first two principal components, color-coded according to class membership. The decision boundary (parabola in the plane of the first two principal components) between the classes constructed using QDA is marked in black.
</p>
</div>
<p>Notice that the decision boundary between the classification classes is now a parabola.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb617"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb617-1"><a href="simulace4.html#cb617-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb617-2"><a href="simulace4.html#cb617-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb617-3"><a href="simulace4.html#cb617-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb617-4"><a href="simulace4.html#cb617-4" tabindex="-1"></a></span>
<span id="cb617-5"><a href="simulace4.html#cb617-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-4" class="section level4 hasAnchor" number="5.2.3.4">
<h4><span class="header-section-number">5.2.3.4</span> Logistic Regression<a href="simulace4.html#logistic-regression-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>We can perform logistic regression in two ways. First, we can use the functional analogue of classical logistic regression, and second, we can apply classical multivariate logistic regression on the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-4" class="section level5 hasAnchor" number="5.2.3.4.1">
<h5><span class="header-section-number">5.2.3.4.1</span> Functional Logistic Regression<a href="simulace4.html#functional-logistic-regression-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Analogous to the case with finite-dimensional input data, we consider the logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span></p>
<p>where <span class="math inline">\(\eta(x)\)</span> is a linear predictor taking values in the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em> (in the case of logistic regression, this is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>), and <span class="math inline">\(\pi(x)\)</span> is the conditional probability:</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is a parametric function. Our goal is to estimate this parametric function.</p>
<p>For functional logistic regression, we will use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package. First, we will create suitable objects for the classifier construction.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb618"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb618-1"><a href="simulace4.html#cb618-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb618-2"><a href="simulace4.html#cb618-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb618-3"><a href="simulace4.html#cb618-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb618-4"><a href="simulace4.html#cb618-4" tabindex="-1"></a></span>
<span id="cb618-5"><a href="simulace4.html#cb618-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb618-6"><a href="simulace4.html#cb618-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb618-7"><a href="simulace4.html#cb618-7" tabindex="-1"></a></span>
<span id="cb618-8"><a href="simulace4.html#cb618-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb618-9"><a href="simulace4.html#cb618-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb618-10"><a href="simulace4.html#cb618-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb618-11"><a href="simulace4.html#cb618-11" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train$basis</span></span>
<span id="cb618-12"><a href="simulace4.html#cb618-12" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb618-13"><a href="simulace4.html#cb618-13" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb618-14"><a href="simulace4.html#cb618-14" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb618-15"><a href="simulace4.html#cb618-15" tabindex="-1"></a>                               <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<p>To estimate the parametric function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in our case, a B-spline basis. However, we need to determine a suitable number of basis functions. We could determine this based on the error rate on the training data, but this would lead to a preference for selecting a large number of bases, resulting in overfitting.</p>
<p>Let us illustrate this with the following case. For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 50\}\)</span>, we will train the model on the training data, determine the error rate on the training data, and also calculate the error rate on the test data. We must remember that we cannot use the same data for estimating the test error rate, as this would underestimate the error rate.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb619"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb619-1"><a href="simulace4.html#cb619-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb619-2"><a href="simulace4.html#cb619-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb619-3"><a href="simulace4.html#cb619-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb619-4"><a href="simulace4.html#cb619-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb619-5"><a href="simulace4.html#cb619-5" tabindex="-1"></a></span>
<span id="cb619-6"><a href="simulace4.html#cb619-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb619-7"><a href="simulace4.html#cb619-7" tabindex="-1"></a>  <span class="co"># basis for betas</span></span>
<span id="cb619-8"><a href="simulace4.html#cb619-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb619-9"><a href="simulace4.html#cb619-9" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb619-10"><a href="simulace4.html#cb619-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb619-11"><a href="simulace4.html#cb619-11" tabindex="-1"></a>  <span class="co"># basis for x and betas</span></span>
<span id="cb619-12"><a href="simulace4.html#cb619-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb619-13"><a href="simulace4.html#cb619-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb619-14"><a href="simulace4.html#cb619-14" tabindex="-1"></a>  <span class="co"># input data for the model</span></span>
<span id="cb619-15"><a href="simulace4.html#cb619-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb619-16"><a href="simulace4.html#cb619-16" tabindex="-1"></a>  <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb619-17"><a href="simulace4.html#cb619-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb619-18"><a href="simulace4.html#cb619-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb619-19"><a href="simulace4.html#cb619-19" tabindex="-1"></a>  </span>
<span id="cb619-20"><a href="simulace4.html#cb619-20" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb619-21"><a href="simulace4.html#cb619-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb619-22"><a href="simulace4.html#cb619-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb619-23"><a href="simulace4.html#cb619-23" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb619-24"><a href="simulace4.html#cb619-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb619-25"><a href="simulace4.html#cb619-25" tabindex="-1"></a>    </span>
<span id="cb619-26"><a href="simulace4.html#cb619-26" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb619-27"><a href="simulace4.html#cb619-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb619-28"><a href="simulace4.html#cb619-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb619-29"><a href="simulace4.html#cb619-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb619-30"><a href="simulace4.html#cb619-30" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb619-31"><a href="simulace4.html#cb619-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb619-32"><a href="simulace4.html#cb619-32" tabindex="-1"></a>  </span>
<span id="cb619-33"><a href="simulace4.html#cb619-33" tabindex="-1"></a>  <span class="co"># insert into the matrix</span></span>
<span id="cb619-34"><a href="simulace4.html#cb619-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb619-35"><a href="simulace4.html#cb619-35" tabindex="-1"></a>} </span>
<span id="cb619-36"><a href="simulace4.html#cb619-36" tabindex="-1"></a></span>
<span id="cb619-37"><a href="simulace4.html#cb619-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb619-38"><a href="simulace4.html#cb619-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s visualize the trends of both training and test error rates in a graph based on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb620"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb620-1"><a href="simulace4.html#cb620-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb620-2"><a href="simulace4.html#cb620-2" tabindex="-1"></a></span>
<span id="cb620-3"><a href="simulace4.html#cb620-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb620-4"><a href="simulace4.html#cb620-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb620-5"><a href="simulace4.html#cb620-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb620-6"><a href="simulace4.html#cb620-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb620-7"><a href="simulace4.html#cb620-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb620-8"><a href="simulace4.html#cb620-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb620-9"><a href="simulace4.html#cb620-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb620-10"><a href="simulace4.html#cb620-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb620-11"><a href="simulace4.html#cb620-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb620-12"><a href="simulace4.html#cb620-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb620-13"><a href="simulace4.html#cb620-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb620-14"><a href="simulace4.html#cb620-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb620-15"><a href="simulace4.html#cb620-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error Rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 47 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-180"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-180-1.png" alt="Dependence of test and training error rates on the number of basis functions for $\beta$. The red point represents the optimal number $n_{optimal}$ chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line illustrates the training error rate." width="672" />
<p class="caption">
Figure 5.27: Dependence of test and training error rates on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red point represents the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line illustrates the training error rate.
</p>
</div>
<p>We see that as the number of bases for <span class="math inline">\(\beta(t)\)</span> increases, the training error rate (represented by the blue line) tends to decrease, suggesting that we might choose large values for <span class="math inline">\(n_{basis}\)</span> based solely on it. In contrast, the optimal choice based on the test error rate is <span class="math inline">\(n\)</span> equal to 8, which is significantly smaller than 50. Conversely, as <span class="math inline">\(n\)</span> increases, the test error rate rises, indicating overfitting of the model.</p>
<p>For these reasons, we will use 10-fold cross-validation to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>. The maximum number of basis functions considered is 35, as we observed that exceeding this value leads to overfitting.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb623"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb623-1"><a href="simulace4.html#cb623-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb623-2"><a href="simulace4.html#cb623-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb623-3"><a href="simulace4.html#cb623-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb623-4"><a href="simulace4.html#cb623-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb623-5"><a href="simulace4.html#cb623-5" tabindex="-1"></a><span class="co"># divide the training data into k parts</span></span>
<span id="cb623-6"><a href="simulace4.html#cb623-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb623-7"><a href="simulace4.html#cb623-7" tabindex="-1"></a><span class="do">## elements that do not change during the loop</span></span>
<span id="cb623-8"><a href="simulace4.html#cb623-8" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb623-9"><a href="simulace4.html#cb623-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb623-10"><a href="simulace4.html#cb623-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb623-11"><a href="simulace4.html#cb623-11" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb623-12"><a href="simulace4.html#cb623-12" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train$basis</span></span>
<span id="cb623-13"><a href="simulace4.html#cb623-13" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb623-14"><a href="simulace4.html#cb623-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb623-15"><a href="simulace4.html#cb623-15" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb623-16"><a href="simulace4.html#cb623-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb623-17"><a href="simulace4.html#cb623-17" tabindex="-1"></a><span class="co"># empty matrix to store results</span></span>
<span id="cb623-18"><a href="simulace4.html#cb623-18" tabindex="-1"></a><span class="co"># columns will contain accuracy values for the respective training subset</span></span>
<span id="cb623-19"><a href="simulace4.html#cb623-19" tabindex="-1"></a><span class="co"># rows will contain values for the respective number of bases</span></span>
<span id="cb623-20"><a href="simulace4.html#cb623-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb623-21"><a href="simulace4.html#cb623-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now that we have everything prepared, we will calculate the error rates for each of the ten subsets of the training set. Subsequently, we will determine the average error and take the argument of the minimum validation error as the optimal <span class="math inline">\(n\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb624"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb624-1"><a href="simulace4.html#cb624-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb624-2"><a href="simulace4.html#cb624-2" tabindex="-1"></a>  <span class="co"># define the index set</span></span>
<span id="cb624-3"><a href="simulace4.html#cb624-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb624-4"><a href="simulace4.html#cb624-4" tabindex="-1"></a>    </span>
<span id="cb624-5"><a href="simulace4.html#cb624-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb624-6"><a href="simulace4.html#cb624-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb624-7"><a href="simulace4.html#cb624-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb624-8"><a href="simulace4.html#cb624-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb624-9"><a href="simulace4.html#cb624-9" tabindex="-1"></a>  </span>
<span id="cb624-10"><a href="simulace4.html#cb624-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb624-11"><a href="simulace4.html#cb624-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb624-12"><a href="simulace4.html#cb624-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb624-13"><a href="simulace4.html#cb624-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb624-14"><a href="simulace4.html#cb624-14" tabindex="-1"></a>  </span>
<span id="cb624-15"><a href="simulace4.html#cb624-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb624-16"><a href="simulace4.html#cb624-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb624-17"><a href="simulace4.html#cb624-17" tabindex="-1"></a>  </span>
<span id="cb624-18"><a href="simulace4.html#cb624-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb624-19"><a href="simulace4.html#cb624-19" tabindex="-1"></a>    <span class="co"># basis for betas</span></span>
<span id="cb624-20"><a href="simulace4.html#cb624-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb624-21"><a href="simulace4.html#cb624-21" tabindex="-1"></a>    </span>
<span id="cb624-22"><a href="simulace4.html#cb624-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb624-23"><a href="simulace4.html#cb624-23" tabindex="-1"></a>    <span class="co"># input data for the model</span></span>
<span id="cb624-24"><a href="simulace4.html#cb624-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb624-25"><a href="simulace4.html#cb624-25" tabindex="-1"></a>    <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb624-26"><a href="simulace4.html#cb624-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb624-27"><a href="simulace4.html#cb624-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb624-28"><a href="simulace4.html#cb624-28" tabindex="-1"></a>    </span>
<span id="cb624-29"><a href="simulace4.html#cb624-29" tabindex="-1"></a>    <span class="co"># accuracy on the validation subset </span></span>
<span id="cb624-30"><a href="simulace4.html#cb624-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb624-31"><a href="simulace4.html#cb624-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb624-32"><a href="simulace4.html#cb624-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb624-33"><a href="simulace4.html#cb624-33" tabindex="-1"></a>    accuracy.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb624-34"><a href="simulace4.html#cb624-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb624-35"><a href="simulace4.html#cb624-35" tabindex="-1"></a>    </span>
<span id="cb624-36"><a href="simulace4.html#cb624-36" tabindex="-1"></a>    <span class="co"># insert into the matrix</span></span>
<span id="cb624-37"><a href="simulace4.html#cb624-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> accuracy.valid</span>
<span id="cb624-38"><a href="simulace4.html#cb624-38" tabindex="-1"></a>  } </span>
<span id="cb624-39"><a href="simulace4.html#cb624-39" tabindex="-1"></a>}</span>
<span id="cb624-40"><a href="simulace4.html#cb624-40" tabindex="-1"></a></span>
<span id="cb624-41"><a href="simulace4.html#cb624-41" tabindex="-1"></a><span class="co"># calculate average accuracies for each n across folds</span></span>
<span id="cb624-42"><a href="simulace4.html#cb624-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb624-43"><a href="simulace4.html#cb624-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb624-44"><a href="simulace4.html#cb624-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb624-45"><a href="simulace4.html#cb624-45" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>Let’s plot the validation error rates, highlighting the optimal value of <span class="math inline">\(n_{optimal}\)</span>, which is 15, with a validation error rate of 0.1026.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb625"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb625-1"><a href="simulace4.html#cb625-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb625-2"><a href="simulace4.html#cb625-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb625-3"><a href="simulace4.html#cb625-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb625-4"><a href="simulace4.html#cb625-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb625-5"><a href="simulace4.html#cb625-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb625-6"><a href="simulace4.html#cb625-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb625-7"><a href="simulace4.html#cb625-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb625-8"><a href="simulace4.html#cb625-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb625-9"><a href="simulace4.html#cb625-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb625-10"><a href="simulace4.html#cb625-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 32 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-183"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-183-1.png" alt="Dependence of validation error on the value of $n_{basis}$, i.e., on the number of bases." width="672" />
<p class="caption">
Figure 5.28: Dependence of validation error on the value of <span class="math inline">\(n_{basis}\)</span>, i.e., on the number of bases.
</p>
</div>
<p>We can now define the final model using functional logistic regression, choosing the B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 15 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb627"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb627-1"><a href="simulace4.html#cb627-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb627-2"><a href="simulace4.html#cb627-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb627-3"><a href="simulace4.html#cb627-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb627-4"><a href="simulace4.html#cb627-4" tabindex="-1"></a><span class="co"># bases for x and betas</span></span>
<span id="cb627-5"><a href="simulace4.html#cb627-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb627-6"><a href="simulace4.html#cb627-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb627-7"><a href="simulace4.html#cb627-7" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb627-8"><a href="simulace4.html#cb627-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb627-9"><a href="simulace4.html#cb627-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb627-10"><a href="simulace4.html#cb627-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb627-11"><a href="simulace4.html#cb627-11" tabindex="-1"></a><span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb627-12"><a href="simulace4.html#cb627-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb627-13"><a href="simulace4.html#cb627-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb627-14"><a href="simulace4.html#cb627-14" tabindex="-1"></a></span>
<span id="cb627-15"><a href="simulace4.html#cb627-15" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb627-16"><a href="simulace4.html#cb627-16" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb627-17"><a href="simulace4.html#cb627-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb627-18"><a href="simulace4.html#cb627-18" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb627-19"><a href="simulace4.html#cb627-19" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb627-20"><a href="simulace4.html#cb627-20" tabindex="-1"></a>  </span>
<span id="cb627-21"><a href="simulace4.html#cb627-21" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb627-22"><a href="simulace4.html#cb627-22" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb627-23"><a href="simulace4.html#cb627-23" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb627-24"><a href="simulace4.html#cb627-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb627-25"><a href="simulace4.html#cb627-25" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb627-26"><a href="simulace4.html#cb627-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the training error rate (which is 4.29 %) and the test error rate (which is 8.33 %). For better visualization, we can also plot the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> on the training data against the values of the linear predictor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb628"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb628-1"><a href="simulace4.html#cb628-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb628-2"><a href="simulace4.html#cb628-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb628-3"><a href="simulace4.html#cb628-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb628-4"><a href="simulace4.html#cb628-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb628-5"><a href="simulace4.html#cb628-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb628-6"><a href="simulace4.html#cb628-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb628-7"><a href="simulace4.html#cb628-7" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb628-8"><a href="simulace4.html#cb628-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb628-9"><a href="simulace4.html#cb628-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb628-10"><a href="simulace4.html#cb628-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb628-11"><a href="simulace4.html#cb628-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probability Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb628-12"><a href="simulace4.html#cb628-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-185"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-185-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to their classification class." width="672" />
<p class="caption">
Figure 5.29: Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to their classification class.
</p>
</div>
<p>For informational purposes, we can also display the progression of the estimated parametric function <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb629"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb629-1"><a href="simulace4.html#cb629-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb629-2"><a href="simulace4.html#cb629-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb629-3"><a href="simulace4.html#cb629-3" tabindex="-1"></a></span>
<span id="cb629-4"><a href="simulace4.html#cb629-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb629-5"><a href="simulace4.html#cb629-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb629-6"><a href="simulace4.html#cb629-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb629-7"><a href="simulace4.html#cb629-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb629-8"><a href="simulace4.html#cb629-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb629-9"><a href="simulace4.html#cb629-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb629-10"><a href="simulace4.html#cb629-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb629-11"><a href="simulace4.html#cb629-11" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb629-12"><a href="simulace4.html#cb629-12" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-186"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-186-1.png" alt="Plot of the estimated parametric function $\beta(t), t \in [0, 6]$." width="672" />
<p class="caption">
Figure 5.30: Plot of the estimated parametric function <span class="math inline">\(\beta(t), t \in [0, 6]\)</span>.
</p>
</div>
<p>Finally, we will add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb630"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb630-1"><a href="simulace4.html#cb630-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb630-2"><a href="simulace4.html#cb630-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb630-3"><a href="simulace4.html#cb630-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb630-4"><a href="simulace4.html#cb630-4" tabindex="-1"></a></span>
<span id="cb630-5"><a href="simulace4.html#cb630-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-with-principal-component-analysis-2" class="section level5 hasAnchor" number="5.2.3.4.2">
<h5><span class="header-section-number">5.2.3.4.2</span> Logistic Regression with Principal Component Analysis<a href="simulace4.html#logistic-regression-with-principal-component-analysis-2" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>To construct this classifier, we need to perform functional principal component analysis, determine the appropriate number of components, and calculate the score values for the test data. We have already completed this in the linear discriminant analysis section, so we will use these results in the following section.</p>
<p>We can directly construct the logistic regression model using the <code>glm(, family = binomial)</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb631"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb631-1"><a href="simulace4.html#cb631-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb631-2"><a href="simulace4.html#cb631-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb631-3"><a href="simulace4.html#cb631-3" tabindex="-1"></a></span>
<span id="cb631-4"><a href="simulace4.html#cb631-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb631-5"><a href="simulace4.html#cb631-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb631-6"><a href="simulace4.html#cb631-6" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb631-7"><a href="simulace4.html#cb631-7" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb631-8"><a href="simulace4.html#cb631-8" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb631-9"><a href="simulace4.html#cb631-9" tabindex="-1"></a></span>
<span id="cb631-10"><a href="simulace4.html#cb631-10" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb631-11"><a href="simulace4.html#cb631-11" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb631-12"><a href="simulace4.html#cb631-12" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb631-13"><a href="simulace4.html#cb631-13" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb631-14"><a href="simulace4.html#cb631-14" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (13.57 %) and on the test data (18.33 %).</p>
<p>For graphical representation of the method, we can plot the decision boundary in the scores of the first two principal components. We will compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did in the LDA and QDA cases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb632"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb632-1"><a href="simulace4.html#cb632-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb632-2"><a href="simulace4.html#cb632-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb632-3"><a href="simulace4.html#cb632-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb632-4"><a href="simulace4.html#cb632-4" tabindex="-1"></a></span>
<span id="cb632-5"><a href="simulace4.html#cb632-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb632-6"><a href="simulace4.html#cb632-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb632-7"><a href="simulace4.html#cb632-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variance&#39;</span>, </span>
<span id="cb632-8"><a href="simulace4.html#cb632-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb632-9"><a href="simulace4.html#cb632-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb632-10"><a href="simulace4.html#cb632-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb632-11"><a href="simulace4.html#cb632-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb632-12"><a href="simulace4.html#cb632-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb632-13"><a href="simulace4.html#cb632-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb632-14"><a href="simulace4.html#cb632-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-190"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-190-1.png" alt="Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes is indicated in black, constructed using logistic regression." width="672" />
<p class="caption">
Figure 5.31: Scores of the first two principal components, color-coded according to classification class. The decision boundary (a line in the plane of the first two principal components) between classes is indicated in black, constructed using logistic regression.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a line, similar to the case with LDA.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb633"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb633-1"><a href="simulace4.html#cb633-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb633-2"><a href="simulace4.html#cb633-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb633-3"><a href="simulace4.html#cb633-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb633-4"><a href="simulace4.html#cb633-4" tabindex="-1"></a></span>
<span id="cb633-5"><a href="simulace4.html#cb633-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="decision-trees-3" class="section level4 hasAnchor" number="5.2.3.5">
<h4><span class="header-section-number">5.2.3.5</span> Decision Trees<a href="simulace4.html#decision-trees-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section, we will look at a very different approach to constructing a classifier compared to methods such as LDA or logistic regression. Decision trees are a very popular tool for classification; however, like some of the previous methods, they are not directly designed for functional data. There are, however, procedures to convert functional objects into multidimensional ones, allowing us to apply decision tree algorithms. We can consider the following approaches:</p>
<ul>
<li><p>An algorithm built on basis coefficients,</p></li>
<li><p>Utilizing principal component scores,</p></li>
<li><p>Discretizing the interval and evaluating the function only on a finite grid of points.</p></li>
</ul>
<p>We will first focus on discretizing the interval and then compare the results with the other two approaches to constructing decision trees.</p>
<div id="interval-discretization-5" class="section level5 hasAnchor" number="5.2.3.5.1">
<h5><span class="header-section-number">5.2.3.5.1</span> Interval Discretization<a href="simulace4.html#interval-discretization-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>First, we need to define points from the interval <span class="math inline">\(I = [0, 6]\)</span>, where we will evaluate the functions. Next, we will create an object where the rows represent the individual (discretized) functions and the columns represent time. Finally, we will add a column <span class="math inline">\(Y\)</span> containing information about the classification class and repeat the same for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb634"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb634-1"><a href="simulace4.html#cb634-1" tabindex="-1"></a><span class="co"># sequence of points at which we will evaluate the functions</span></span>
<span id="cb634-2"><a href="simulace4.html#cb634-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb634-3"><a href="simulace4.html#cb634-3" tabindex="-1"></a>   </span>
<span id="cb634-4"><a href="simulace4.html#cb634-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb634-5"><a href="simulace4.html#cb634-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for functions in rows</span></span>
<span id="cb634-6"><a href="simulace4.html#cb634-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb634-7"><a href="simulace4.html#cb634-7" tabindex="-1"></a></span>
<span id="cb634-8"><a href="simulace4.html#cb634-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb634-9"><a href="simulace4.html#cb634-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb634-10"><a href="simulace4.html#cb634-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can construct a decision tree where all times from the vector <code>t.seq</code> will serve as predictors. This classification method is not susceptible to multicollinearity, so we do not need to worry about it. We will choose accuracy as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb635"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb635-1"><a href="simulace4.html#cb635-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb635-2"><a href="simulace4.html#cb635-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb635-3"><a href="simulace4.html#cb635-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb635-4"><a href="simulace4.html#cb635-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb635-5"><a href="simulace4.html#cb635-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb635-6"><a href="simulace4.html#cb635-6" tabindex="-1"></a></span>
<span id="cb635-7"><a href="simulace4.html#cb635-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb635-8"><a href="simulace4.html#cb635-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb635-9"><a href="simulace4.html#cb635-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb635-10"><a href="simulace4.html#cb635-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb635-11"><a href="simulace4.html#cb635-11" tabindex="-1"></a>  </span>
<span id="cb635-12"><a href="simulace4.html#cb635-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb635-13"><a href="simulace4.html#cb635-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb635-14"><a href="simulace4.html#cb635-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb635-15"><a href="simulace4.html#cb635-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the classifier on the test data is thus 15 %, and on the training data 8.57 %.</p>
<p>We can visualize the decision tree graphically using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb636"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb636-1"><a href="simulace4.html#cb636-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb636-2"><a href="simulace4.html#cb636-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb636-3"><a href="simulace4.html#cb636-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-194"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-194-1.png" alt="Graphical representation of the unpruned decision tree. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 5.32: Graphical representation of the unpruned decision tree. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb637"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb637-1"><a href="simulace4.html#cb637-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb637-2"><a href="simulace4.html#cb637-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb637-3"><a href="simulace4.html#cb637-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb637-4"><a href="simulace4.html#cb637-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb637-5"><a href="simulace4.html#cb637-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb637-6"><a href="simulace4.html#cb637-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb637-7"><a href="simulace4.html#cb637-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb637-8"><a href="simulace4.html#cb637-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-195"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-195-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.33: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb638"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb638-1"><a href="simulace4.html#cb638-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discr.&#39;</span>, </span>
<span id="cb638-2"><a href="simulace4.html#cb638-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb638-3"><a href="simulace4.html#cb638-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb638-4"><a href="simulace4.html#cb638-4" tabindex="-1"></a></span>
<span id="cb638-5"><a href="simulace4.html#cb638-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-7" class="section level5 hasAnchor" number="5.2.3.5.2">
<h5><span class="header-section-number">5.2.3.5.2</span> Principal Component Scores<a href="simulace4.html#principal-component-scores-7" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another option for constructing a decision tree is to use principal component scores. Since we have already calculated the scores for the previous classification methods, we will utilize this knowledge and construct a decision tree based on the scores of the first 3 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb639"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb639-1"><a href="simulace4.html#cb639-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb639-2"><a href="simulace4.html#cb639-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb639-3"><a href="simulace4.html#cb639-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb639-4"><a href="simulace4.html#cb639-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb639-5"><a href="simulace4.html#cb639-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb639-6"><a href="simulace4.html#cb639-6" tabindex="-1"></a></span>
<span id="cb639-7"><a href="simulace4.html#cb639-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb639-8"><a href="simulace4.html#cb639-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb639-9"><a href="simulace4.html#cb639-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb639-10"><a href="simulace4.html#cb639-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb639-11"><a href="simulace4.html#cb639-11" tabindex="-1"></a>  </span>
<span id="cb639-12"><a href="simulace4.html#cb639-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb639-13"><a href="simulace4.html#cb639-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb639-14"><a href="simulace4.html#cb639-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb639-15"><a href="simulace4.html#cb639-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the test data is thus 28.33 %, and on the training data 16.43 %.</p>
<p>We can visualize the decision tree constructed on the principal component scores using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb640"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb640-1"><a href="simulace4.html#cb640-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb640-2"><a href="simulace4.html#cb640-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-198"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-198-1.png" alt="Graphical representation of the unpruned decision tree constructed on principal component scores. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 5.34: Graphical representation of the unpruned decision tree constructed on principal component scores. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb641"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb641-1"><a href="simulace4.html#cb641-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb641-2"><a href="simulace4.html#cb641-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb641-3"><a href="simulace4.html#cb641-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb641-4"><a href="simulace4.html#cb641-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb641-5"><a href="simulace4.html#cb641-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb641-6"><a href="simulace4.html#cb641-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-199"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-199-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.35: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb642"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb642-1"><a href="simulace4.html#cb642-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb642-2"><a href="simulace4.html#cb642-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb642-3"><a href="simulace4.html#cb642-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb642-4"><a href="simulace4.html#cb642-4" tabindex="-1"></a></span>
<span id="cb642-5"><a href="simulace4.html#cb642-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-4" class="section level5 hasAnchor" number="5.2.3.5.3">
<h5><span class="header-section-number">5.2.3.5.3</span> Basis Coefficients<a href="simulace4.html#basis-coefficients-4" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The final option we will utilize for constructing a decision tree is to use coefficients in the representation of functions in the B-spline basis.</p>
<p>First, let’s define the necessary datasets with the coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb643"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb643-1"><a href="simulace4.html#cb643-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb643-2"><a href="simulace4.html#cb643-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb643-3"><a href="simulace4.html#cb643-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb643-4"><a href="simulace4.html#cb643-4" tabindex="-1"></a></span>
<span id="cb643-5"><a href="simulace4.html#cb643-5" tabindex="-1"></a><span class="co"># test dataset</span></span>
<span id="cb643-6"><a href="simulace4.html#cb643-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb643-7"><a href="simulace4.html#cb643-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now we can construct the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb644"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb644-1"><a href="simulace4.html#cb644-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb644-2"><a href="simulace4.html#cb644-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb644-3"><a href="simulace4.html#cb644-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb644-4"><a href="simulace4.html#cb644-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb644-5"><a href="simulace4.html#cb644-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb644-6"><a href="simulace4.html#cb644-6" tabindex="-1"></a></span>
<span id="cb644-7"><a href="simulace4.html#cb644-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb644-8"><a href="simulace4.html#cb644-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb644-9"><a href="simulace4.html#cb644-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb644-10"><a href="simulace4.html#cb644-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb644-11"><a href="simulace4.html#cb644-11" tabindex="-1"></a>  </span>
<span id="cb644-12"><a href="simulace4.html#cb644-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb644-13"><a href="simulace4.html#cb644-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb644-14"><a href="simulace4.html#cb644-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb644-15"><a href="simulace4.html#cb644-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the training data is thus 10 %, and on the test data 11.67 %.</p>
<p>We can visualize the decision tree constructed on the B-spline coefficient representation using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb645"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb645-1"><a href="simulace4.html#cb645-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb645-2"><a href="simulace4.html#cb645-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-203"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-203-1.png" alt="Graphical representation of the unpruned decision tree constructed on basis coefficients. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0." width="672" />
<p class="caption">
Figure 5.36: Graphical representation of the unpruned decision tree constructed on basis coefficients. Blue shades represent nodes belonging to classification class 1, and red shades represent class 0.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb646"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb646-1"><a href="simulace4.html#cb646-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># final model </span></span>
<span id="cb646-2"><a href="simulace4.html#cb646-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb646-3"><a href="simulace4.html#cb646-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb646-4"><a href="simulace4.html#cb646-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb646-5"><a href="simulace4.html#cb646-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb646-6"><a href="simulace4.html#cb646-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-204"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-204-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 5.37: Final pruned decision tree.
</p>
</div>
<p>Finally, we will again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb647"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb647-1"><a href="simulace4.html#cb647-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb647-2"><a href="simulace4.html#cb647-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb647-3"><a href="simulace4.html#cb647-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb647-4"><a href="simulace4.html#cb647-4" tabindex="-1"></a></span>
<span id="cb647-5"><a href="simulace4.html#cb647-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests-4" class="section level4 hasAnchor" number="5.2.3.6">
<h4><span class="header-section-number">5.2.3.6</span> Random Forests<a href="simulace4.html#random-forests-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The classifier constructed using the random forests method consists of building several individual decision trees, which are then combined to create a common classifier (via “voting”).</p>
<p>As with decision trees, we have several options regarding which data (finite-dimensional) we will use to construct the model. We will again consider the three approaches discussed above. The datasets with the corresponding variables for all three approaches have already been prepared from the previous section, so we can directly construct the models, calculate the characteristics of the classifiers, and add the results to the summary table.</p>
<div id="interval-discretization-6" class="section level5 hasAnchor" number="5.2.3.6.1">
<h5><span class="header-section-number">5.2.3.6.1</span> Interval Discretization<a href="simulace4.html#interval-discretization-6" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the first case, we utilize the evaluation of functions on a given grid of points over the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb648"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb648-1"><a href="simulace4.html#cb648-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb648-2"><a href="simulace4.html#cb648-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb648-3"><a href="simulace4.html#cb648-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb648-4"><a href="simulace4.html#cb648-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb648-5"><a href="simulace4.html#cb648-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb648-6"><a href="simulace4.html#cb648-6" tabindex="-1"></a></span>
<span id="cb648-7"><a href="simulace4.html#cb648-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb648-8"><a href="simulace4.html#cb648-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb648-9"><a href="simulace4.html#cb648-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb648-10"><a href="simulace4.html#cb648-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb648-11"><a href="simulace4.html#cb648-11" tabindex="-1"></a>  </span>
<span id="cb648-12"><a href="simulace4.html#cb648-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb648-13"><a href="simulace4.html#cb648-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb648-14"><a href="simulace4.html#cb648-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb648-15"><a href="simulace4.html#cb648-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is thus 0.71 %, and on the test data 13.33 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb649"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb649-1"><a href="simulace4.html#cb649-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discretization&#39;</span>, </span>
<span id="cb649-2"><a href="simulace4.html#cb649-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb649-3"><a href="simulace4.html#cb649-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb649-4"><a href="simulace4.html#cb649-4" tabindex="-1"></a></span>
<span id="cb649-5"><a href="simulace4.html#cb649-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-8" class="section level5 hasAnchor" number="5.2.3.6.2">
<h5><span class="header-section-number">5.2.3.6.2</span> Principal Component Scores<a href="simulace4.html#principal-component-scores-8" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this case, we will use the scores of the first $p = $ 3 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb650"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb650-1"><a href="simulace4.html#cb650-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb650-2"><a href="simulace4.html#cb650-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb650-3"><a href="simulace4.html#cb650-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb650-4"><a href="simulace4.html#cb650-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb650-5"><a href="simulace4.html#cb650-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb650-6"><a href="simulace4.html#cb650-6" tabindex="-1"></a></span>
<span id="cb650-7"><a href="simulace4.html#cb650-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb650-8"><a href="simulace4.html#cb650-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb650-9"><a href="simulace4.html#cb650-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb650-10"><a href="simulace4.html#cb650-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb650-11"><a href="simulace4.html#cb650-11" tabindex="-1"></a>  </span>
<span id="cb650-12"><a href="simulace4.html#cb650-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb650-13"><a href="simulace4.html#cb650-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb650-14"><a href="simulace4.html#cb650-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb650-15"><a href="simulace4.html#cb650-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate on the training data is thus 2.86 %, and on the test data 20 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb651"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb651-1"><a href="simulace4.html#cb651-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb651-2"><a href="simulace4.html#cb651-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb651-3"><a href="simulace4.html#cb651-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb651-4"><a href="simulace4.html#cb651-4" tabindex="-1"></a></span>
<span id="cb651-5"><a href="simulace4.html#cb651-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-5" class="section level5 hasAnchor" number="5.2.3.6.3">
<h5><span class="header-section-number">5.2.3.6.3</span> Basis Coefficients<a href="simulace4.html#basis-coefficients-5" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Finally, we will use the representation of functions through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb652"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb652-1"><a href="simulace4.html#cb652-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb652-2"><a href="simulace4.html#cb652-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb652-3"><a href="simulace4.html#cb652-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb652-4"><a href="simulace4.html#cb652-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb652-5"><a href="simulace4.html#cb652-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb652-6"><a href="simulace4.html#cb652-6" tabindex="-1"></a></span>
<span id="cb652-7"><a href="simulace4.html#cb652-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb652-8"><a href="simulace4.html#cb652-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb652-9"><a href="simulace4.html#cb652-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb652-10"><a href="simulace4.html#cb652-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb652-11"><a href="simulace4.html#cb652-11" tabindex="-1"></a>  </span>
<span id="cb652-12"><a href="simulace4.html#cb652-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb652-13"><a href="simulace4.html#cb652-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb652-14"><a href="simulace4.html#cb652-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb652-15"><a href="simulace4.html#cb652-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 0.71 %, and on the test data 10 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb653"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb653-1"><a href="simulace4.html#cb653-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb653-2"><a href="simulace4.html#cb653-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb653-3"><a href="simulace4.html#cb653-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb653-4"><a href="simulace4.html#cb653-4" tabindex="-1"></a></span>
<span id="cb653-5"><a href="simulace4.html#cb653-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-5" class="section level4 hasAnchor" number="5.2.3.7">
<h4><span class="header-section-number">5.2.3.7</span> Support Vector Machines<a href="simulace4.html#support-vector-machines-5" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Now let’s look at classifying our simulated curves using the Support Vector Machines (SVM) method. The advantage of this classification method is its computational efficiency, as it defines the boundary curve between classes using only a few (often very few) observations.</p>
<p>In the case of functional data, we have several options for applying the SVM method. The simplest variant is to use this classification method directly on the discretized function (section <a href="simulace4.html#diskr2der">5.2.3.7.2</a>). Another option is to utilize the principal component scores to classify curves based on their representation <a href="simulace4.html#PCA-SVM2der">5.2.3.7.3</a>. A straightforward variant is to use the representation of curves through the B-spline basis and classify curves based on the coefficients of their representation in this basis (section <a href="simulace4.html#basis-SVM2der">5.2.3.7.4</a>).</p>
<p>A more complex consideration can lead us to several additional options that leverage the functional nature of the data. We can utilize projections of functions onto a subspace generated, for example, by B-spline functions (section <a href="simulace4.html#projection-SVM2der">5.2.3.7.5</a>). The final method we will use for classifying functional data involves combining projection onto a certain subspace generated by functions (Reproducing Kernel Hilbert Space, RKHS) and classifying the corresponding representation. This method utilizes not only the classical SVM but also SVM for regression, as discussed in section RKHS + SVM <a href="simulace4.html#RKHS-SVM2der">5.2.3.7.6</a>.</p>
<div id="svm-for-functional-data-3" class="section level5 hasAnchor" number="5.2.3.7.1">
<h5><span class="header-section-number">5.2.3.7.1</span> SVM for Functional Data<a href="simulace4.html#svm-for-functional-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In the <code>fda.usc</code> library, we will use the function <code>classif.svm()</code> to apply the SVM method directly to functional data. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb654"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb654-1"><a href="simulace4.html#cb654-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb654-2"><a href="simulace4.html#cb654-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb654-3"><a href="simulace4.html#cb654-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb654-4"><a href="simulace4.html#cb654-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb654-5"><a href="simulace4.html#cb654-5" tabindex="-1"></a>}</span>
<span id="cb654-6"><a href="simulace4.html#cb654-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXder </span>
<span id="cb654-7"><a href="simulace4.html#cb654-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb654-8"><a href="simulace4.html#cb654-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb654-9"><a href="simulace4.html#cb654-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb654-10"><a href="simulace4.html#cb654-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb654-11"><a href="simulace4.html#cb654-11" tabindex="-1"></a></span>
<span id="cb654-12"><a href="simulace4.html#cb654-12" tabindex="-1"></a><span class="co"># split into test and training sets</span></span>
<span id="cb654-13"><a href="simulace4.html#cb654-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb654-14"><a href="simulace4.html#cb654-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb654-15"><a href="simulace4.html#cb654-15" tabindex="-1"></a></span>
<span id="cb654-16"><a href="simulace4.html#cb654-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb654-17"><a href="simulace4.html#cb654-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb654-18"><a href="simulace4.html#cb654-18" tabindex="-1"></a></span>
<span id="cb654-19"><a href="simulace4.html#cb654-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb654-20"><a href="simulace4.html#cb654-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb654-21"><a href="simulace4.html#cb654-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb654-22"><a href="simulace4.html#cb654-22" tabindex="-1"></a></span>
<span id="cb654-23"><a href="simulace4.html#cb654-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb654-24"><a href="simulace4.html#cb654-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb654-25"><a href="simulace4.html#cb654-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb655"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb655-1"><a href="simulace4.html#cb655-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb655-2"><a href="simulace4.html#cb655-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb655-3"><a href="simulace4.html#cb655-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb655-4"><a href="simulace4.html#cb655-4" tabindex="-1"></a></span>
<span id="cb655-5"><a href="simulace4.html#cb655-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb655-6"><a href="simulace4.html#cb655-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb655-7"><a href="simulace4.html#cb655-7" tabindex="-1"></a></span>
<span id="cb655-8"><a href="simulace4.html#cb655-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb655-9"><a href="simulace4.html#cb655-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb655-10"><a href="simulace4.html#cb655-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb655-11"><a href="simulace4.html#cb655-11" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb655-12"><a href="simulace4.html#cb655-12" tabindex="-1"></a>nbasis.x <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb655-13"><a href="simulace4.html#cb655-13" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb655-14"><a href="simulace4.html#cb655-14" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb655-15"><a href="simulace4.html#cb655-15" tabindex="-1"></a>                               <span class="at">nbasis =</span> nbasis.x)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb656"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb656-1"><a href="simulace4.html#cb656-1" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb656-2"><a href="simulace4.html#cb656-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb656-3"><a href="simulace4.html#cb656-3" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb656-4"><a href="simulace4.html#cb656-4" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb656-5"><a href="simulace4.html#cb656-5" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb656-6"><a href="simulace4.html#cb656-6" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb656-7"><a href="simulace4.html#cb656-7" tabindex="-1"></a><span class="co"># SVM model</span></span>
<span id="cb656-8"><a href="simulace4.html#cb656-8" tabindex="-1"></a>model.svm.f <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb656-9"><a href="simulace4.html#cb656-9" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb656-10"><a href="simulace4.html#cb656-10" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb656-11"><a href="simulace4.html#cb656-11" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, <span class="at">cost =</span> <span class="fl">1e2</span>)</span>
<span id="cb656-12"><a href="simulace4.html#cb656-12" tabindex="-1"></a></span>
<span id="cb656-13"><a href="simulace4.html#cb656-13" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb656-14"><a href="simulace4.html#cb656-14" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb656-15"><a href="simulace4.html#cb656-15" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb656-16"><a href="simulace4.html#cb656-16" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train)</span>
<span id="cb656-17"><a href="simulace4.html#cb656-17" tabindex="-1"></a>  </span>
<span id="cb656-18"><a href="simulace4.html#cb656-18" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb656-19"><a href="simulace4.html#cb656-19" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb656-20"><a href="simulace4.html#cb656-20" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb656-21"><a href="simulace4.html#cb656-21" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test)</span></code></pre></div>
</details>
<p>We calculated the training error (which is 4.29 %) and the test error (which is 8.33 %).</p>
<p>Now let’s attempt, unlike the procedure in the previous chapters, to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, acknowledging that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will explore the values of the hyperparameter <span class="math inline">\(C\)</span> in the range <span class="math inline">\([10^{-2}, 10^{5}]\)</span>, while for the polynomial kernel, we will consider the value of the hyperparameter <span class="math inline">\(p\)</span> to be 3, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use <span class="math inline">\(r k_cv\)</span>-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the range <span class="math inline">\([10^{-5}, 10^{-2}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb657"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb657-1"><a href="simulace4.html#cb657-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb657-2"><a href="simulace4.html#cb657-2" tabindex="-1"></a></span>
<span id="cb657-3"><a href="simulace4.html#cb657-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb657-4"><a href="simulace4.html#cb657-4" tabindex="-1"></a></span>
<span id="cb657-5"><a href="simulace4.html#cb657-5" tabindex="-1"></a><span class="co"># We split the training data into k parts</span></span>
<span id="cb657-6"><a href="simulace4.html#cb657-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb657-7"><a href="simulace4.html#cb657-7" tabindex="-1"></a></span>
<span id="cb657-8"><a href="simulace4.html#cb657-8" tabindex="-1"></a><span class="co"># Which values of gamma do we want to consider</span></span>
<span id="cb657-9"><a href="simulace4.html#cb657-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">4</span>)</span>
<span id="cb657-10"><a href="simulace4.html#cb657-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">8</span>)</span>
<span id="cb657-11"><a href="simulace4.html#cb657-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb657-12"><a href="simulace4.html#cb657-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb657-13"><a href="simulace4.html#cb657-13" tabindex="-1"></a></span>
<span id="cb657-14"><a href="simulace4.html#cb657-14" tabindex="-1"></a><span class="co"># A list with three components... an array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb657-15"><a href="simulace4.html#cb657-15" tabindex="-1"></a><span class="co"># An empty matrix where we will place individual results</span></span>
<span id="cb657-16"><a href="simulace4.html#cb657-16" tabindex="-1"></a><span class="co"># The columns will contain the accuracy values for each</span></span>
<span id="cb657-17"><a href="simulace4.html#cb657-17" tabindex="-1"></a><span class="co"># The rows will correspond to the values for a given gamma and the layers correspond to folds</span></span>
<span id="cb657-18"><a href="simulace4.html#cb657-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb657-19"><a href="simulace4.html#cb657-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb657-20"><a href="simulace4.html#cb657-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb657-21"><a href="simulace4.html#cb657-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb657-22"><a href="simulace4.html#cb657-22" tabindex="-1"></a>)</span>
<span id="cb657-23"><a href="simulace4.html#cb657-23" tabindex="-1"></a></span>
<span id="cb657-24"><a href="simulace4.html#cb657-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb657-25"><a href="simulace4.html#cb657-25" tabindex="-1"></a><span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb657-26"><a href="simulace4.html#cb657-26" tabindex="-1"></a>  <span class="co"># We go through the individual folds</span></span>
<span id="cb657-27"><a href="simulace4.html#cb657-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb657-28"><a href="simulace4.html#cb657-28" tabindex="-1"></a>    <span class="co"># Definition of the test and training parts for CV</span></span>
<span id="cb657-29"><a href="simulace4.html#cb657-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb657-30"><a href="simulace4.html#cb657-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb657-31"><a href="simulace4.html#cb657-31" tabindex="-1"></a>    </span>
<span id="cb657-32"><a href="simulace4.html#cb657-32" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb657-33"><a href="simulace4.html#cb657-33" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb657-34"><a href="simulace4.html#cb657-34" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb657-35"><a href="simulace4.html#cb657-35" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb657-36"><a href="simulace4.html#cb657-36" tabindex="-1"></a>    </span>
<span id="cb657-37"><a href="simulace4.html#cb657-37" tabindex="-1"></a>    <span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb657-38"><a href="simulace4.html#cb657-38" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb657-39"><a href="simulace4.html#cb657-39" tabindex="-1"></a>    </span>
<span id="cb657-40"><a href="simulace4.html#cb657-40" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb657-41"><a href="simulace4.html#cb657-41" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb657-42"><a href="simulace4.html#cb657-42" tabindex="-1"></a>    <span class="co"># B-spline basis</span></span>
<span id="cb657-43"><a href="simulace4.html#cb657-43" tabindex="-1"></a>    <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb657-44"><a href="simulace4.html#cb657-44" tabindex="-1"></a>    <span class="co"># Formula</span></span>
<span id="cb657-45"><a href="simulace4.html#cb657-45" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb657-46"><a href="simulace4.html#cb657-46" tabindex="-1"></a>    <span class="co"># Basis for x</span></span>
<span id="cb657-47"><a href="simulace4.html#cb657-47" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb657-48"><a href="simulace4.html#cb657-48" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb657-49"><a href="simulace4.html#cb657-49" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb657-50"><a href="simulace4.html#cb657-50" tabindex="-1"></a>    </span>
<span id="cb657-51"><a href="simulace4.html#cb657-51" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb657-52"><a href="simulace4.html#cb657-52" tabindex="-1"></a>    <span class="co"># SVM model</span></span>
<span id="cb657-53"><a href="simulace4.html#cb657-53" tabindex="-1"></a>    clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb657-54"><a href="simulace4.html#cb657-54" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb657-55"><a href="simulace4.html#cb657-55" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb657-56"><a href="simulace4.html#cb657-56" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb657-57"><a href="simulace4.html#cb657-57" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb657-58"><a href="simulace4.html#cb657-58" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb657-59"><a href="simulace4.html#cb657-59" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb657-60"><a href="simulace4.html#cb657-60" tabindex="-1"></a>      </span>
<span id="cb657-61"><a href="simulace4.html#cb657-61" tabindex="-1"></a>    <span class="co"># Accuracy on the test data</span></span>
<span id="cb657-62"><a href="simulace4.html#cb657-62" tabindex="-1"></a>    newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb657-63"><a href="simulace4.html#cb657-63" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb657-64"><a href="simulace4.html#cb657-64" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb657-65"><a href="simulace4.html#cb657-65" tabindex="-1"></a>    </span>
<span id="cb657-66"><a href="simulace4.html#cb657-66" tabindex="-1"></a>    <span class="co"># We insert the accuracies into positions for the given C and fold</span></span>
<span id="cb657-67"><a href="simulace4.html#cb657-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb657-68"><a href="simulace4.html#cb657-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb657-69"><a href="simulace4.html#cb657-69" tabindex="-1"></a>    </span>
<span id="cb657-70"><a href="simulace4.html#cb657-70" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb657-71"><a href="simulace4.html#cb657-71" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb657-72"><a href="simulace4.html#cb657-72" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb657-73"><a href="simulace4.html#cb657-73" tabindex="-1"></a>      clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb657-74"><a href="simulace4.html#cb657-74" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb657-75"><a href="simulace4.html#cb657-75" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb657-76"><a href="simulace4.html#cb657-76" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb657-77"><a href="simulace4.html#cb657-77" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb657-78"><a href="simulace4.html#cb657-78" tabindex="-1"></a>                <span class="at">coef0 =</span> coef0,</span>
<span id="cb657-79"><a href="simulace4.html#cb657-79" tabindex="-1"></a>                <span class="at">degree =</span> p,</span>
<span id="cb657-80"><a href="simulace4.html#cb657-80" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb657-81"><a href="simulace4.html#cb657-81" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb657-82"><a href="simulace4.html#cb657-82" tabindex="-1"></a>        </span>
<span id="cb657-83"><a href="simulace4.html#cb657-83" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb657-84"><a href="simulace4.html#cb657-84" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb657-85"><a href="simulace4.html#cb657-85" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb657-86"><a href="simulace4.html#cb657-86" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb657-87"><a href="simulace4.html#cb657-87" tabindex="-1"></a>      </span>
<span id="cb657-88"><a href="simulace4.html#cb657-88" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, p, and fold</span></span>
<span id="cb657-89"><a href="simulace4.html#cb657-89" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb657-90"><a href="simulace4.html#cb657-90" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb657-91"><a href="simulace4.html#cb657-91" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb657-92"><a href="simulace4.html#cb657-92" tabindex="-1"></a>    }</span>
<span id="cb657-93"><a href="simulace4.html#cb657-93" tabindex="-1"></a>        </span>
<span id="cb657-94"><a href="simulace4.html#cb657-94" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb657-95"><a href="simulace4.html#cb657-95" tabindex="-1"></a>    <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb657-96"><a href="simulace4.html#cb657-96" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb657-97"><a href="simulace4.html#cb657-97" tabindex="-1"></a>      clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb657-98"><a href="simulace4.html#cb657-98" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb657-99"><a href="simulace4.html#cb657-99" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb657-100"><a href="simulace4.html#cb657-100" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb657-101"><a href="simulace4.html#cb657-101" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb657-102"><a href="simulace4.html#cb657-102" tabindex="-1"></a>                <span class="at">gamma =</span> gam.cv,</span>
<span id="cb657-103"><a href="simulace4.html#cb657-103" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb657-104"><a href="simulace4.html#cb657-104" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb657-105"><a href="simulace4.html#cb657-105" tabindex="-1"></a>        </span>
<span id="cb657-106"><a href="simulace4.html#cb657-106" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb657-107"><a href="simulace4.html#cb657-107" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb657-108"><a href="simulace4.html#cb657-108" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb657-109"><a href="simulace4.html#cb657-109" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb657-110"><a href="simulace4.html#cb657-110" tabindex="-1"></a>      </span>
<span id="cb657-111"><a href="simulace4.html#cb657-111" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, gamma, and fold</span></span>
<span id="cb657-112"><a href="simulace4.html#cb657-112" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb657-113"><a href="simulace4.html#cb657-113" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb657-114"><a href="simulace4.html#cb657-114" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb657-115"><a href="simulace4.html#cb657-115" tabindex="-1"></a>    }</span>
<span id="cb657-116"><a href="simulace4.html#cb657-116" tabindex="-1"></a>  }</span>
<span id="cb657-117"><a href="simulace4.html#cb657-117" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of 10-fold CV so that we have one estimate of validation error for one value of the hyperparameter (or one combination of values). At the same time, we will determine the optimal values of the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb658"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb658-1"><a href="simulace4.html#cb658-1" tabindex="-1"></a><span class="co"># We calculate the average accuracies for individual C across folds</span></span>
<span id="cb658-2"><a href="simulace4.html#cb658-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb658-3"><a href="simulace4.html#cb658-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb658-4"><a href="simulace4.html#cb658-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb658-5"><a href="simulace4.html#cb658-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb658-6"><a href="simulace4.html#cb658-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb658-7"><a href="simulace4.html#cb658-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb658-8"><a href="simulace4.html#cb658-8" tabindex="-1"></a></span>
<span id="cb658-9"><a href="simulace4.html#cb658-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb658-10"><a href="simulace4.html#cb658-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb658-11"><a href="simulace4.html#cb658-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb658-12"><a href="simulace4.html#cb658-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb658-13"><a href="simulace4.html#cb658-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb658-14"><a href="simulace4.html#cb658-14" tabindex="-1"></a></span>
<span id="cb658-15"><a href="simulace4.html#cb658-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb658-16"><a href="simulace4.html#cb658-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb658-17"><a href="simulace4.html#cb658-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb658-18"><a href="simulace4.html#cb658-18" tabindex="-1"></a></span>
<span id="cb658-19"><a href="simulace4.html#cb658-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb658-20"><a href="simulace4.html#cb658-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb658-21"><a href="simulace4.html#cb658-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb658-22"><a href="simulace4.html#cb658-22" tabindex="-1"></a></span>
<span id="cb658-23"><a href="simulace4.html#cb658-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb658-24"><a href="simulace4.html#cb658-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb658-25"><a href="simulace4.html#cb658-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s take a look at how the optimal values turned out. For <em>linear kernel</em>, we have the optimal value <span class="math inline">\(C\)</span> equal to 0.1, for <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 1, and for <em>radial kernel</em>, we have two optimal values, for <span class="math inline">\(C\)</span> the optimal value is 10^{4} and for <span class="math inline">\(\gamma\)</span> it is 10^{-4}. The validation error rates are 0.1046566 for linear, 0.1266346 for polynomial, and 0.1117995 for radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb659"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb659-1"><a href="simulace4.html#cb659-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb659-2"><a href="simulace4.html#cb659-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb659-3"><a href="simulace4.html#cb659-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb659-4"><a href="simulace4.html#cb659-4" tabindex="-1"></a></span>
<span id="cb659-5"><a href="simulace4.html#cb659-5" tabindex="-1"></a><span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb659-6"><a href="simulace4.html#cb659-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb659-7"><a href="simulace4.html#cb659-7" tabindex="-1"></a></span>
<span id="cb659-8"><a href="simulace4.html#cb659-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb659-9"><a href="simulace4.html#cb659-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb659-10"><a href="simulace4.html#cb659-10" tabindex="-1"></a><span class="co"># B-spline basis</span></span>
<span id="cb659-11"><a href="simulace4.html#cb659-11" tabindex="-1"></a><span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb659-12"><a href="simulace4.html#cb659-12" tabindex="-1"></a></span>
<span id="cb659-13"><a href="simulace4.html#cb659-13" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb659-14"><a href="simulace4.html#cb659-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb659-15"><a href="simulace4.html#cb659-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb659-16"><a href="simulace4.html#cb659-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb659-17"><a href="simulace4.html#cb659-17" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb659-18"><a href="simulace4.html#cb659-18" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb660"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb660-1"><a href="simulace4.html#cb660-1" tabindex="-1"></a>model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb660-2"><a href="simulace4.html#cb660-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb660-3"><a href="simulace4.html#cb660-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb660-4"><a href="simulace4.html#cb660-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb660-5"><a href="simulace4.html#cb660-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb660-6"><a href="simulace4.html#cb660-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb660-7"><a href="simulace4.html#cb660-7" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb660-8"><a href="simulace4.html#cb660-8" tabindex="-1"></a></span>
<span id="cb660-9"><a href="simulace4.html#cb660-9" tabindex="-1"></a>model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb660-10"><a href="simulace4.html#cb660-10" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb660-11"><a href="simulace4.html#cb660-11" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb660-12"><a href="simulace4.html#cb660-12" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb660-13"><a href="simulace4.html#cb660-13" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb660-14"><a href="simulace4.html#cb660-14" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb660-15"><a href="simulace4.html#cb660-15" tabindex="-1"></a>            <span class="at">degree =</span> p.opt,</span>
<span id="cb660-16"><a href="simulace4.html#cb660-16" tabindex="-1"></a>            <span class="at">coef0 =</span> coef0,</span>
<span id="cb660-17"><a href="simulace4.html#cb660-17" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb660-18"><a href="simulace4.html#cb660-18" tabindex="-1"></a></span>
<span id="cb660-19"><a href="simulace4.html#cb660-19" tabindex="-1"></a>model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb660-20"><a href="simulace4.html#cb660-20" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb660-21"><a href="simulace4.html#cb660-21" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb660-22"><a href="simulace4.html#cb660-22" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb660-23"><a href="simulace4.html#cb660-23" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb660-24"><a href="simulace4.html#cb660-24" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb660-25"><a href="simulace4.html#cb660-25" tabindex="-1"></a>            <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb660-26"><a href="simulace4.html#cb660-26" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb660-27"><a href="simulace4.html#cb660-27" tabindex="-1"></a></span>
<span id="cb660-28"><a href="simulace4.html#cb660-28" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb660-29"><a href="simulace4.html#cb660-29" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb660-30"><a href="simulace4.html#cb660-30" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-31"><a href="simulace4.html#cb660-31" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb660-32"><a href="simulace4.html#cb660-32" tabindex="-1"></a></span>
<span id="cb660-33"><a href="simulace4.html#cb660-33" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-34"><a href="simulace4.html#cb660-34" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb660-35"><a href="simulace4.html#cb660-35" tabindex="-1"></a></span>
<span id="cb660-36"><a href="simulace4.html#cb660-36" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-37"><a href="simulace4.html#cb660-37" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb660-38"><a href="simulace4.html#cb660-38" tabindex="-1"></a>  </span>
<span id="cb660-39"><a href="simulace4.html#cb660-39" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb660-40"><a href="simulace4.html#cb660-40" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb660-41"><a href="simulace4.html#cb660-41" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-42"><a href="simulace4.html#cb660-42" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb660-43"><a href="simulace4.html#cb660-43" tabindex="-1"></a></span>
<span id="cb660-44"><a href="simulace4.html#cb660-44" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-45"><a href="simulace4.html#cb660-45" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb660-46"><a href="simulace4.html#cb660-46" tabindex="-1"></a></span>
<span id="cb660-47"><a href="simulace4.html#cb660-47" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb660-48"><a href="simulace4.html#cb660-48" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 7.8571 % for the linear kernel, 7.1429 % for the polynomial kernel, and 5.7143 % for the Gaussian kernel. On the test data, the error rate of the method is 8.3333 % for the linear kernel, 10 % for the polynomial kernel, and 8.3333 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb661"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb661-1"><a href="simulace4.html#cb661-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb661-2"><a href="simulace4.html#cb661-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb661-3"><a href="simulace4.html#cb661-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb661-4"><a href="simulace4.html#cb661-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb661-5"><a href="simulace4.html#cb661-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb661-6"><a href="simulace4.html#cb661-6" tabindex="-1"></a></span>
<span id="cb661-7"><a href="simulace4.html#cb661-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="diskr2der" class="section level5 hasAnchor" number="5.2.3.7.2">
<h5><span class="header-section-number">5.2.3.7.2</span> Interval Discretization<a href="simulace4.html#diskr2der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Let’s continue by applying the Support Vector Machines method directly to the discretized data (evaluation of the function on a grid of points over the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three aforementioned kernel functions.</p>
<p>Now, let’s attempt to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, and we allow its optimal value to differ among kernels.</p>
<p>For all three kernels, we will go through the values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{4}]\)</span>, while for the polynomial kernel we will fix the hyperparameter <span class="math inline">\(p\)</span> at a value of 3, since other integer values do not yield nearly as good results. On the other hand, for the radial kernel, we will use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-5}, 10^{-1}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb662"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb662-1"><a href="simulace4.html#cb662-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb662-2"><a href="simulace4.html#cb662-2" tabindex="-1"></a></span>
<span id="cb662-3"><a href="simulace4.html#cb662-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb662-4"><a href="simulace4.html#cb662-4" tabindex="-1"></a></span>
<span id="cb662-5"><a href="simulace4.html#cb662-5" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb662-6"><a href="simulace4.html#cb662-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb662-7"><a href="simulace4.html#cb662-7" tabindex="-1"></a></span>
<span id="cb662-8"><a href="simulace4.html#cb662-8" tabindex="-1"></a><span class="co"># Values of gamma to consider</span></span>
<span id="cb662-9"><a href="simulace4.html#cb662-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb662-10"><a href="simulace4.html#cb662-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb662-11"><a href="simulace4.html#cb662-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb662-12"><a href="simulace4.html#cb662-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb662-13"><a href="simulace4.html#cb662-13" tabindex="-1"></a></span>
<span id="cb662-14"><a href="simulace4.html#cb662-14" tabindex="-1"></a><span class="co"># List with three components ... arrays for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb662-15"><a href="simulace4.html#cb662-15" tabindex="-1"></a><span class="co"># Empty matrices to store the results</span></span>
<span id="cb662-16"><a href="simulace4.html#cb662-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given C</span></span>
<span id="cb662-17"><a href="simulace4.html#cb662-17" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb662-18"><a href="simulace4.html#cb662-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb662-19"><a href="simulace4.html#cb662-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb662-20"><a href="simulace4.html#cb662-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb662-21"><a href="simulace4.html#cb662-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb662-22"><a href="simulace4.html#cb662-22" tabindex="-1"></a>)</span>
<span id="cb662-23"><a href="simulace4.html#cb662-23" tabindex="-1"></a></span>
<span id="cb662-24"><a href="simulace4.html#cb662-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb662-25"><a href="simulace4.html#cb662-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb662-26"><a href="simulace4.html#cb662-26" tabindex="-1"></a>  <span class="co"># Go through individual folds</span></span>
<span id="cb662-27"><a href="simulace4.html#cb662-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb662-28"><a href="simulace4.html#cb662-28" tabindex="-1"></a>    <span class="co"># Definition of test and training parts for CV</span></span>
<span id="cb662-29"><a href="simulace4.html#cb662-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb662-30"><a href="simulace4.html#cb662-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb662-31"><a href="simulace4.html#cb662-31" tabindex="-1"></a>    </span>
<span id="cb662-32"><a href="simulace4.html#cb662-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb662-33"><a href="simulace4.html#cb662-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb662-34"><a href="simulace4.html#cb662-34" tabindex="-1"></a>    </span>
<span id="cb662-35"><a href="simulace4.html#cb662-35" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb662-36"><a href="simulace4.html#cb662-36" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb662-37"><a href="simulace4.html#cb662-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb662-38"><a href="simulace4.html#cb662-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb662-39"><a href="simulace4.html#cb662-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb662-40"><a href="simulace4.html#cb662-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb662-41"><a href="simulace4.html#cb662-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb662-42"><a href="simulace4.html#cb662-42" tabindex="-1"></a>    </span>
<span id="cb662-43"><a href="simulace4.html#cb662-43" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb662-44"><a href="simulace4.html#cb662-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb662-45"><a href="simulace4.html#cb662-45" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb662-46"><a href="simulace4.html#cb662-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb662-47"><a href="simulace4.html#cb662-47" tabindex="-1"></a>    </span>
<span id="cb662-48"><a href="simulace4.html#cb662-48" tabindex="-1"></a>    <span class="co"># Store accuracy for given C and fold</span></span>
<span id="cb662-49"><a href="simulace4.html#cb662-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb662-50"><a href="simulace4.html#cb662-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb662-51"><a href="simulace4.html#cb662-51" tabindex="-1"></a>    </span>
<span id="cb662-52"><a href="simulace4.html#cb662-52" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb662-53"><a href="simulace4.html#cb662-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb662-54"><a href="simulace4.html#cb662-54" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb662-55"><a href="simulace4.html#cb662-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb662-56"><a href="simulace4.html#cb662-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb662-57"><a href="simulace4.html#cb662-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb662-58"><a href="simulace4.html#cb662-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb662-59"><a href="simulace4.html#cb662-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb662-60"><a href="simulace4.html#cb662-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb662-61"><a href="simulace4.html#cb662-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb662-62"><a href="simulace4.html#cb662-62" tabindex="-1"></a>      </span>
<span id="cb662-63"><a href="simulace4.html#cb662-63" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb662-64"><a href="simulace4.html#cb662-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb662-65"><a href="simulace4.html#cb662-65" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb662-66"><a href="simulace4.html#cb662-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb662-67"><a href="simulace4.html#cb662-67" tabindex="-1"></a>      </span>
<span id="cb662-68"><a href="simulace4.html#cb662-68" tabindex="-1"></a>      <span class="co"># Store accuracy for given C, p, and fold</span></span>
<span id="cb662-69"><a href="simulace4.html#cb662-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb662-70"><a href="simulace4.html#cb662-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb662-71"><a href="simulace4.html#cb662-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb662-72"><a href="simulace4.html#cb662-72" tabindex="-1"></a>    }</span>
<span id="cb662-73"><a href="simulace4.html#cb662-73" tabindex="-1"></a>        </span>
<span id="cb662-74"><a href="simulace4.html#cb662-74" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb662-75"><a href="simulace4.html#cb662-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb662-76"><a href="simulace4.html#cb662-76" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb662-77"><a href="simulace4.html#cb662-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb662-78"><a href="simulace4.html#cb662-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb662-79"><a href="simulace4.html#cb662-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb662-80"><a href="simulace4.html#cb662-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb662-81"><a href="simulace4.html#cb662-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb662-82"><a href="simulace4.html#cb662-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb662-83"><a href="simulace4.html#cb662-83" tabindex="-1"></a>      </span>
<span id="cb662-84"><a href="simulace4.html#cb662-84" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb662-85"><a href="simulace4.html#cb662-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb662-86"><a href="simulace4.html#cb662-86" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb662-87"><a href="simulace4.html#cb662-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb662-88"><a href="simulace4.html#cb662-88" tabindex="-1"></a>      </span>
<span id="cb662-89"><a href="simulace4.html#cb662-89" tabindex="-1"></a>      <span class="co"># Store accuracy for given C, gamma, and fold</span></span>
<span id="cb662-90"><a href="simulace4.html#cb662-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb662-91"><a href="simulace4.html#cb662-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb662-92"><a href="simulace4.html#cb662-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb662-93"><a href="simulace4.html#cb662-93" tabindex="-1"></a>    }</span>
<span id="cb662-94"><a href="simulace4.html#cb662-94" tabindex="-1"></a>  }</span>
<span id="cb662-95"><a href="simulace4.html#cb662-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now, let’s average the results of the 10-fold CV so that for each value of the hyperparameter (or one combination of values), we have one estimate of the validation error. In this process, we will also determine the optimal values for the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb663"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb663-1"><a href="simulace4.html#cb663-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each C across folds</span></span>
<span id="cb663-2"><a href="simulace4.html#cb663-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb663-3"><a href="simulace4.html#cb663-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb663-4"><a href="simulace4.html#cb663-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb663-5"><a href="simulace4.html#cb663-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb663-6"><a href="simulace4.html#cb663-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb663-7"><a href="simulace4.html#cb663-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb663-8"><a href="simulace4.html#cb663-8" tabindex="-1"></a></span>
<span id="cb663-9"><a href="simulace4.html#cb663-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb663-10"><a href="simulace4.html#cb663-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb663-11"><a href="simulace4.html#cb663-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb663-12"><a href="simulace4.html#cb663-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb663-13"><a href="simulace4.html#cb663-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb663-14"><a href="simulace4.html#cb663-14" tabindex="-1"></a></span>
<span id="cb663-15"><a href="simulace4.html#cb663-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb663-16"><a href="simulace4.html#cb663-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb663-17"><a href="simulace4.html#cb663-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb663-18"><a href="simulace4.html#cb663-18" tabindex="-1"></a></span>
<span id="cb663-19"><a href="simulace4.html#cb663-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb663-20"><a href="simulace4.html#cb663-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb663-21"><a href="simulace4.html#cb663-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb663-22"><a href="simulace4.html#cb663-22" tabindex="-1"></a></span>
<span id="cb663-23"><a href="simulace4.html#cb663-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb663-24"><a href="simulace4.html#cb663-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb663-25"><a href="simulace4.html#cb663-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For the <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 0.01, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is 0.1, and for the <em>radial kernel</em>, we have two optimal values: for <span class="math inline">\(C\)</span>, the optimal value is 1000, and for <span class="math inline">\(\gamma\)</span>, it is 10^{-4}. The validation errors are 0.1067399 for linear, 0.1373031 for polynomial, and 0.0991804 for radial kernels.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined by 10-fold CV. We will also determine the errors on both test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb664"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb664-1"><a href="simulace4.html#cb664-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb664-2"><a href="simulace4.html#cb664-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb664-3"><a href="simulace4.html#cb664-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb664-4"><a href="simulace4.html#cb664-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb664-5"><a href="simulace4.html#cb664-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb664-6"><a href="simulace4.html#cb664-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb664-7"><a href="simulace4.html#cb664-7" tabindex="-1"></a></span>
<span id="cb664-8"><a href="simulace4.html#cb664-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb664-9"><a href="simulace4.html#cb664-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb664-10"><a href="simulace4.html#cb664-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb664-11"><a href="simulace4.html#cb664-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb664-12"><a href="simulace4.html#cb664-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb664-13"><a href="simulace4.html#cb664-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb664-14"><a href="simulace4.html#cb664-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb664-15"><a href="simulace4.html#cb664-15" tabindex="-1"></a></span>
<span id="cb664-16"><a href="simulace4.html#cb664-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb664-17"><a href="simulace4.html#cb664-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb664-18"><a href="simulace4.html#cb664-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb664-19"><a href="simulace4.html#cb664-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb664-20"><a href="simulace4.html#cb664-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb664-21"><a href="simulace4.html#cb664-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb664-22"><a href="simulace4.html#cb664-22" tabindex="-1"></a></span>
<span id="cb664-23"><a href="simulace4.html#cb664-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb664-24"><a href="simulace4.html#cb664-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb664-25"><a href="simulace4.html#cb664-25" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb664-26"><a href="simulace4.html#cb664-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb664-27"><a href="simulace4.html#cb664-27" tabindex="-1"></a></span>
<span id="cb664-28"><a href="simulace4.html#cb664-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb664-29"><a href="simulace4.html#cb664-29" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb664-30"><a href="simulace4.html#cb664-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb664-31"><a href="simulace4.html#cb664-31" tabindex="-1"></a></span>
<span id="cb664-32"><a href="simulace4.html#cb664-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb664-33"><a href="simulace4.html#cb664-33" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb664-34"><a href="simulace4.html#cb664-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb664-35"><a href="simulace4.html#cb664-35" tabindex="-1"></a></span>
<span id="cb664-36"><a href="simulace4.html#cb664-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb664-37"><a href="simulace4.html#cb664-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb664-38"><a href="simulace4.html#cb664-38" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb664-39"><a href="simulace4.html#cb664-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb664-40"><a href="simulace4.html#cb664-40" tabindex="-1"></a></span>
<span id="cb664-41"><a href="simulace4.html#cb664-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb664-42"><a href="simulace4.html#cb664-42" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb664-43"><a href="simulace4.html#cb664-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb664-44"><a href="simulace4.html#cb664-44" tabindex="-1"></a></span>
<span id="cb664-45"><a href="simulace4.html#cb664-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb664-46"><a href="simulace4.html#cb664-46" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb664-47"><a href="simulace4.html#cb664-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is 9.2857 % for the linear kernel, 9.2857 % for the polynomial kernel, and 6.4286 % for the Gaussian kernel. On the test data, the error rate is 10 % for the linear kernel, 10 % for the polynomial kernel, and 10 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb665"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb665-1"><a href="simulace4.html#cb665-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb665-2"><a href="simulace4.html#cb665-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb665-3"><a href="simulace4.html#cb665-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb665-4"><a href="simulace4.html#cb665-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb665-5"><a href="simulace4.html#cb665-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb665-6"><a href="simulace4.html#cb665-6" tabindex="-1"></a></span>
<span id="cb665-7"><a href="simulace4.html#cb665-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVM2der" class="section level5 hasAnchor" number="5.2.3.7.3">
<h5><span class="header-section-number">5.2.3.7.3</span> Principal Component Scores<a href="simulace4.html#PCA-SVM2der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 3 principal components.</p>
<p>Now, let’s try, unlike the approach in previous chapters, to estimate the classifier hyperparameters from the data using 10-fold cross-validation. Given that each kernel has different hyperparameters in its definition, we will treat each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, although we allow that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will test values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{3}]\)</span>. For the polynomial kernel, we fix the hyperparameter <span class="math inline">\(p\)</span> at the value of 3, as for other integer values, the method does not give nearly as good results. In contrast, for the radial kernel, we will use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-5}, 10^{-2}]\)</span>. We set <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb666"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb666-1"><a href="simulace4.html#cb666-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb666-2"><a href="simulace4.html#cb666-2" tabindex="-1"></a></span>
<span id="cb666-3"><a href="simulace4.html#cb666-3" tabindex="-1"></a><span class="co"># gamma values to consider</span></span>
<span id="cb666-4"><a href="simulace4.html#cb666-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">4</span>)</span>
<span id="cb666-5"><a href="simulace4.html#cb666-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb666-6"><a href="simulace4.html#cb666-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb666-7"><a href="simulace4.html#cb666-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb666-8"><a href="simulace4.html#cb666-8" tabindex="-1"></a></span>
<span id="cb666-9"><a href="simulace4.html#cb666-9" tabindex="-1"></a><span class="co"># list with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb666-10"><a href="simulace4.html#cb666-10" tabindex="-1"></a><span class="co"># empty matrix to store results</span></span>
<span id="cb666-11"><a href="simulace4.html#cb666-11" tabindex="-1"></a><span class="co"># columns will have accuracy values for a given</span></span>
<span id="cb666-12"><a href="simulace4.html#cb666-12" tabindex="-1"></a><span class="co"># rows will have values for given gamma and layers correspond to folds</span></span>
<span id="cb666-13"><a href="simulace4.html#cb666-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb666-14"><a href="simulace4.html#cb666-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb666-15"><a href="simulace4.html#cb666-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb666-16"><a href="simulace4.html#cb666-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb666-17"><a href="simulace4.html#cb666-17" tabindex="-1"></a>)</span>
<span id="cb666-18"><a href="simulace4.html#cb666-18" tabindex="-1"></a></span>
<span id="cb666-19"><a href="simulace4.html#cb666-19" tabindex="-1"></a><span class="co"># first, go through C values</span></span>
<span id="cb666-20"><a href="simulace4.html#cb666-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb666-21"><a href="simulace4.html#cb666-21" tabindex="-1"></a>  <span class="co"># iterate over each fold</span></span>
<span id="cb666-22"><a href="simulace4.html#cb666-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb666-23"><a href="simulace4.html#cb666-23" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb666-24"><a href="simulace4.html#cb666-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb666-25"><a href="simulace4.html#cb666-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb666-26"><a href="simulace4.html#cb666-26" tabindex="-1"></a>    </span>
<span id="cb666-27"><a href="simulace4.html#cb666-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb666-28"><a href="simulace4.html#cb666-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb666-29"><a href="simulace4.html#cb666-29" tabindex="-1"></a>    </span>
<span id="cb666-30"><a href="simulace4.html#cb666-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb666-31"><a href="simulace4.html#cb666-31" tabindex="-1"></a>    <span class="co"># build model</span></span>
<span id="cb666-32"><a href="simulace4.html#cb666-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb666-33"><a href="simulace4.html#cb666-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb666-34"><a href="simulace4.html#cb666-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb666-35"><a href="simulace4.html#cb666-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb666-36"><a href="simulace4.html#cb666-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb666-37"><a href="simulace4.html#cb666-37" tabindex="-1"></a>    </span>
<span id="cb666-38"><a href="simulace4.html#cb666-38" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb666-39"><a href="simulace4.html#cb666-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb666-40"><a href="simulace4.html#cb666-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb666-41"><a href="simulace4.html#cb666-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb666-42"><a href="simulace4.html#cb666-42" tabindex="-1"></a>    </span>
<span id="cb666-43"><a href="simulace4.html#cb666-43" tabindex="-1"></a>    <span class="co"># store accuracies for given C and fold</span></span>
<span id="cb666-44"><a href="simulace4.html#cb666-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb666-45"><a href="simulace4.html#cb666-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb666-46"><a href="simulace4.html#cb666-46" tabindex="-1"></a>    </span>
<span id="cb666-47"><a href="simulace4.html#cb666-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb666-48"><a href="simulace4.html#cb666-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb666-49"><a href="simulace4.html#cb666-49" tabindex="-1"></a>      <span class="co"># build model</span></span>
<span id="cb666-50"><a href="simulace4.html#cb666-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb666-51"><a href="simulace4.html#cb666-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb666-52"><a href="simulace4.html#cb666-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb666-53"><a href="simulace4.html#cb666-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb666-54"><a href="simulace4.html#cb666-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb666-55"><a href="simulace4.html#cb666-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb666-56"><a href="simulace4.html#cb666-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb666-57"><a href="simulace4.html#cb666-57" tabindex="-1"></a>      </span>
<span id="cb666-58"><a href="simulace4.html#cb666-58" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb666-59"><a href="simulace4.html#cb666-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb666-60"><a href="simulace4.html#cb666-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb666-61"><a href="simulace4.html#cb666-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb666-62"><a href="simulace4.html#cb666-62" tabindex="-1"></a>      </span>
<span id="cb666-63"><a href="simulace4.html#cb666-63" tabindex="-1"></a>      <span class="co"># store accuracies for given C, p, and fold</span></span>
<span id="cb666-64"><a href="simulace4.html#cb666-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb666-65"><a href="simulace4.html#cb666-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb666-66"><a href="simulace4.html#cb666-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb666-67"><a href="simulace4.html#cb666-67" tabindex="-1"></a>    }</span>
<span id="cb666-68"><a href="simulace4.html#cb666-68" tabindex="-1"></a>        </span>
<span id="cb666-69"><a href="simulace4.html#cb666-69" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb666-70"><a href="simulace4.html#cb666-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb666-71"><a href="simulace4.html#cb666-71" tabindex="-1"></a>      <span class="co"># build model</span></span>
<span id="cb666-72"><a href="simulace4.html#cb666-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb666-73"><a href="simulace4.html#cb666-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb666-74"><a href="simulace4.html#cb666-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb666-75"><a href="simulace4.html#cb666-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb666-76"><a href="simulace4.html#cb666-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb666-77"><a href="simulace4.html#cb666-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb666-78"><a href="simulace4.html#cb666-78" tabindex="-1"></a>      </span>
<span id="cb666-79"><a href="simulace4.html#cb666-79" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb666-80"><a href="simulace4.html#cb666-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb666-81"><a href="simulace4.html#cb666-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb666-82"><a href="simulace4.html#cb666-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb666-83"><a href="simulace4.html#cb666-83" tabindex="-1"></a>      </span>
<span id="cb666-84"><a href="simulace4.html#cb666-84" tabindex="-1"></a>      <span class="co"># store accuracies for given C, gamma, and fold</span></span>
<span id="cb666-85"><a href="simulace4.html#cb666-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb666-86"><a href="simulace4.html#cb666-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb666-87"><a href="simulace4.html#cb666-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb666-88"><a href="simulace4.html#cb666-88" tabindex="-1"></a>    }</span>
<span id="cb666-89"><a href="simulace4.html#cb666-89" tabindex="-1"></a>  }</span>
<span id="cb666-90"><a href="simulace4.html#cb666-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results of the 10-fold CV to obtain a single estimate of validation error for each hyperparameter value (or combination of values). We also determine the optimal values of each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb667"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb667-1"><a href="simulace4.html#cb667-1" tabindex="-1"></a><span class="co"># calculate average accuracies for individual C over folds</span></span>
<span id="cb667-2"><a href="simulace4.html#cb667-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb667-3"><a href="simulace4.html#cb667-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb667-4"><a href="simulace4.html#cb667-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb667-5"><a href="simulace4.html#cb667-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb667-6"><a href="simulace4.html#cb667-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb667-7"><a href="simulace4.html#cb667-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb667-8"><a href="simulace4.html#cb667-8" tabindex="-1"></a></span>
<span id="cb667-9"><a href="simulace4.html#cb667-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb667-10"><a href="simulace4.html#cb667-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb667-11"><a href="simulace4.html#cb667-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb667-12"><a href="simulace4.html#cb667-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb667-13"><a href="simulace4.html#cb667-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb667-14"><a href="simulace4.html#cb667-14" tabindex="-1"></a></span>
<span id="cb667-15"><a href="simulace4.html#cb667-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb667-16"><a href="simulace4.html#cb667-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb667-17"><a href="simulace4.html#cb667-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb667-18"><a href="simulace4.html#cb667-18" tabindex="-1"></a></span>
<span id="cb667-19"><a href="simulace4.html#cb667-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb667-20"><a href="simulace4.html#cb667-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb667-21"><a href="simulace4.html#cb667-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb667-22"><a href="simulace4.html#cb667-22" tabindex="-1"></a></span>
<span id="cb667-23"><a href="simulace4.html#cb667-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb667-24"><a href="simulace4.html#cb667-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb667-25"><a href="simulace4.html#cb667-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For the <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 0.01, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is 0.01, and for the <em>radial kernel</em>, there are two optimal values: <span class="math inline">\(C\)</span> is 100 and <span class="math inline">\(\gamma\)</span> is 0.01. The validation errors are 0.128837 for linear, 0.1227198 for polynomial, and 0.1216941 for the radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training dataset with hyperparameter values determined using 10-fold CV. We also calculate errors on the test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb668"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb668-1"><a href="simulace4.html#cb668-1" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb668-2"><a href="simulace4.html#cb668-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb668-3"><a href="simulace4.html#cb668-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb668-4"><a href="simulace4.html#cb668-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb668-5"><a href="simulace4.html#cb668-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb668-6"><a href="simulace4.html#cb668-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb668-7"><a href="simulace4.html#cb668-7" tabindex="-1"></a></span>
<span id="cb668-8"><a href="simulace4.html#cb668-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb668-9"><a href="simulace4.html#cb668-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb668-10"><a href="simulace4.html#cb668-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb668-11"><a href="simulace4.html#cb668-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb668-12"><a href="simulace4.html#cb668-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb668-13"><a href="simulace4.html#cb668-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb668-14"><a href="simulace4.html#cb668-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb668-15"><a href="simulace4.html#cb668-15" tabindex="-1"></a></span>
<span id="cb668-16"><a href="simulace4.html#cb668-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb668-17"><a href="simulace4.html#cb668-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb668-18"><a href="simulace4.html#cb668-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb668-19"><a href="simulace4.html#cb668-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb668-20"><a href="simulace4.html#cb668-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb668-21"><a href="simulace4.html#cb668-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb668-22"><a href="simulace4.html#cb668-22" tabindex="-1"></a></span>
<span id="cb668-23"><a href="simulace4.html#cb668-23" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb668-24"><a href="simulace4.html#cb668-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb668-25"><a href="simulace4.html#cb668-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb668-26"><a href="simulace4.html#cb668-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb668-27"><a href="simulace4.html#cb668-27" tabindex="-1"></a></span>
<span id="cb668-28"><a href="simulace4.html#cb668-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb668-29"><a href="simulace4.html#cb668-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb668-30"><a href="simulace4.html#cb668-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb668-31"><a href="simulace4.html#cb668-31" tabindex="-1"></a></span>
<span id="cb668-32"><a href="simulace4.html#cb668-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb668-33"><a href="simulace4.html#cb668-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb668-34"><a href="simulace4.html#cb668-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb668-35"><a href="simulace4.html#cb668-35" tabindex="-1"></a>  </span>
<span id="cb668-36"><a href="simulace4.html#cb668-36" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb668-37"><a href="simulace4.html#cb668-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb668-38"><a href="simulace4.html#cb668-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb668-39"><a href="simulace4.html#cb668-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb668-40"><a href="simulace4.html#cb668-40" tabindex="-1"></a></span>
<span id="cb668-41"><a href="simulace4.html#cb668-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb668-42"><a href="simulace4.html#cb668-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb668-43"><a href="simulace4.html#cb668-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb668-44"><a href="simulace4.html#cb668-44" tabindex="-1"></a></span>
<span id="cb668-45"><a href="simulace4.html#cb668-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb668-46"><a href="simulace4.html#cb668-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb668-47"><a href="simulace4.html#cb668-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The training accuracies are 0.8642857 for linear, 0.8714286 for polynomial, and 0.8642857 for radial kernels, and the test accuracies are 0.8166667 for linear, 0.8166667 for polynomial, and 0.8333333 for radial.</p>
<p>To visualize the method, we can plot the decision boundary on a graph of the scores for the first two principal components. We compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as in previous cases where we also plotted the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb669"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb669-1"><a href="simulace4.html#cb669-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb669-2"><a href="simulace4.html#cb669-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb669-3"><a href="simulace4.html#cb669-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb669-4"><a href="simulace4.html#cb669-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb669-5"><a href="simulace4.html#cb669-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb669-6"><a href="simulace4.html#cb669-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb669-7"><a href="simulace4.html#cb669-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb669-8"><a href="simulace4.html#cb669-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb669-9"><a href="simulace4.html#cb669-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb669-10"><a href="simulace4.html#cb669-10" tabindex="-1"></a></span>
<span id="cb669-11"><a href="simulace4.html#cb669-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb669-12"><a href="simulace4.html#cb669-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb669-13"><a href="simulace4.html#cb669-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variance&#39;</span>, </span>
<span id="cb669-14"><a href="simulace4.html#cb669-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb669-15"><a href="simulace4.html#cb669-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb669-16"><a href="simulace4.html#cb669-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb669-17"><a href="simulace4.html#cb669-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>, </span>
<span id="cb669-18"><a href="simulace4.html#cb669-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span></span>
<span id="cb669-19"><a href="simulace4.html#cb669-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb669-20"><a href="simulace4.html#cb669-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb669-21"><a href="simulace4.html#cb669-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb669-22"><a href="simulace4.html#cb669-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-228"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-228-1.png" alt="Scores of the first two principal components, color-coded by classification group. The decision boundary (either a line or curves in the plane of the first two principal components) between classes is displayed in black, created using the SVM method." width="672" />
<p class="caption">
Figure 5.38: Scores of the first two principal components, color-coded by classification group. The decision boundary (either a line or curves in the plane of the first two principal components) between classes is displayed in black, created using the SVM method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb670"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb670-1"><a href="simulace4.html#cb670-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb670-2"><a href="simulace4.html#cb670-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb670-3"><a href="simulace4.html#cb670-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb670-4"><a href="simulace4.html#cb670-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb670-5"><a href="simulace4.html#cb670-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb670-6"><a href="simulace4.html#cb670-6" tabindex="-1"></a></span>
<span id="cb670-7"><a href="simulace4.html#cb670-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVM2der" class="section level5 hasAnchor" number="5.2.3.7.4">
<h5><span class="header-section-number">5.2.3.7.4</span> B-spline Coefficients<a href="simulace4.html#basis-SVM2der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Finally, we use a B-spline basis to express the functions. For all three kernels, we examine the values of hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-1}, 10^{3}]\)</span>. For the polynomial kernel, we fix the hyperparameter <span class="math inline">\(p\)</span> at 3, as other integer values do not yield nearly as good results. On the other hand, for the radial kernel, we again use 10-fold CV to select the optimal value of hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-5}, 10^{-1}]\)</span>. We set <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb671"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb671-1"><a href="simulace4.html#cb671-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb671-2"><a href="simulace4.html#cb671-2" tabindex="-1"></a></span>
<span id="cb671-3"><a href="simulace4.html#cb671-3" tabindex="-1"></a><span class="co"># gamma values to consider</span></span>
<span id="cb671-4"><a href="simulace4.html#cb671-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb671-5"><a href="simulace4.html#cb671-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb671-6"><a href="simulace4.html#cb671-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb671-7"><a href="simulace4.html#cb671-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb671-8"><a href="simulace4.html#cb671-8" tabindex="-1"></a></span>
<span id="cb671-9"><a href="simulace4.html#cb671-9" tabindex="-1"></a><span class="co"># list with three components...array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb671-10"><a href="simulace4.html#cb671-10" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb671-11"><a href="simulace4.html#cb671-11" tabindex="-1"></a><span class="co"># columns hold accuracy values for given</span></span>
<span id="cb671-12"><a href="simulace4.html#cb671-12" tabindex="-1"></a><span class="co"># rows represent values for given gamma, and layers correspond to folds</span></span>
<span id="cb671-13"><a href="simulace4.html#cb671-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb671-14"><a href="simulace4.html#cb671-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb671-15"><a href="simulace4.html#cb671-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb671-16"><a href="simulace4.html#cb671-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb671-17"><a href="simulace4.html#cb671-17" tabindex="-1"></a>)</span>
<span id="cb671-18"><a href="simulace4.html#cb671-18" tabindex="-1"></a></span>
<span id="cb671-19"><a href="simulace4.html#cb671-19" tabindex="-1"></a><span class="co"># first iterate through values of C</span></span>
<span id="cb671-20"><a href="simulace4.html#cb671-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb671-21"><a href="simulace4.html#cb671-21" tabindex="-1"></a>  <span class="co"># iterate over individual folds</span></span>
<span id="cb671-22"><a href="simulace4.html#cb671-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb671-23"><a href="simulace4.html#cb671-23" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb671-24"><a href="simulace4.html#cb671-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb671-25"><a href="simulace4.html#cb671-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb671-26"><a href="simulace4.html#cb671-26" tabindex="-1"></a>    </span>
<span id="cb671-27"><a href="simulace4.html#cb671-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb671-28"><a href="simulace4.html#cb671-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb671-29"><a href="simulace4.html#cb671-29" tabindex="-1"></a>    </span>
<span id="cb671-30"><a href="simulace4.html#cb671-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb671-31"><a href="simulace4.html#cb671-31" tabindex="-1"></a>    <span class="co"># model creation</span></span>
<span id="cb671-32"><a href="simulace4.html#cb671-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb671-33"><a href="simulace4.html#cb671-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb671-34"><a href="simulace4.html#cb671-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb671-35"><a href="simulace4.html#cb671-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb671-36"><a href="simulace4.html#cb671-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb671-37"><a href="simulace4.html#cb671-37" tabindex="-1"></a>    </span>
<span id="cb671-38"><a href="simulace4.html#cb671-38" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb671-39"><a href="simulace4.html#cb671-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb671-40"><a href="simulace4.html#cb671-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb671-41"><a href="simulace4.html#cb671-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb671-42"><a href="simulace4.html#cb671-42" tabindex="-1"></a>    </span>
<span id="cb671-43"><a href="simulace4.html#cb671-43" tabindex="-1"></a>    <span class="co"># insert accuracies in positions for given C and fold</span></span>
<span id="cb671-44"><a href="simulace4.html#cb671-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb671-45"><a href="simulace4.html#cb671-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb671-46"><a href="simulace4.html#cb671-46" tabindex="-1"></a>    </span>
<span id="cb671-47"><a href="simulace4.html#cb671-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb671-48"><a href="simulace4.html#cb671-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb671-49"><a href="simulace4.html#cb671-49" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb671-50"><a href="simulace4.html#cb671-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb671-51"><a href="simulace4.html#cb671-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb671-52"><a href="simulace4.html#cb671-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb671-53"><a href="simulace4.html#cb671-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb671-54"><a href="simulace4.html#cb671-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb671-55"><a href="simulace4.html#cb671-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb671-56"><a href="simulace4.html#cb671-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb671-57"><a href="simulace4.html#cb671-57" tabindex="-1"></a>      </span>
<span id="cb671-58"><a href="simulace4.html#cb671-58" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb671-59"><a href="simulace4.html#cb671-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb671-60"><a href="simulace4.html#cb671-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb671-61"><a href="simulace4.html#cb671-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb671-62"><a href="simulace4.html#cb671-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb671-63"><a href="simulace4.html#cb671-63" tabindex="-1"></a>      </span>
<span id="cb671-64"><a href="simulace4.html#cb671-64" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, p, and fold</span></span>
<span id="cb671-65"><a href="simulace4.html#cb671-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb671-66"><a href="simulace4.html#cb671-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb671-67"><a href="simulace4.html#cb671-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb671-68"><a href="simulace4.html#cb671-68" tabindex="-1"></a>    }</span>
<span id="cb671-69"><a href="simulace4.html#cb671-69" tabindex="-1"></a>        </span>
<span id="cb671-70"><a href="simulace4.html#cb671-70" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb671-71"><a href="simulace4.html#cb671-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb671-72"><a href="simulace4.html#cb671-72" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb671-73"><a href="simulace4.html#cb671-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb671-74"><a href="simulace4.html#cb671-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb671-75"><a href="simulace4.html#cb671-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb671-76"><a href="simulace4.html#cb671-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb671-77"><a href="simulace4.html#cb671-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb671-78"><a href="simulace4.html#cb671-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb671-79"><a href="simulace4.html#cb671-79" tabindex="-1"></a>      </span>
<span id="cb671-80"><a href="simulace4.html#cb671-80" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb671-81"><a href="simulace4.html#cb671-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb671-82"><a href="simulace4.html#cb671-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb671-83"><a href="simulace4.html#cb671-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb671-84"><a href="simulace4.html#cb671-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb671-85"><a href="simulace4.html#cb671-85" tabindex="-1"></a>      </span>
<span id="cb671-86"><a href="simulace4.html#cb671-86" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, gamma, and fold</span></span>
<span id="cb671-87"><a href="simulace4.html#cb671-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb671-88"><a href="simulace4.html#cb671-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb671-89"><a href="simulace4.html#cb671-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb671-90"><a href="simulace4.html#cb671-90" tabindex="-1"></a>    }</span>
<span id="cb671-91"><a href="simulace4.html#cb671-91" tabindex="-1"></a>  }</span>
<span id="cb671-92"><a href="simulace4.html#cb671-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results from 10-fold CV so that we have a single estimate of validation error for each hyperparameter value (or combination of values). We also determine the optimal values of each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb672"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb672-1"><a href="simulace4.html#cb672-1" tabindex="-1"></a><span class="co"># calculate average accuracies for each C across folds</span></span>
<span id="cb672-2"><a href="simulace4.html#cb672-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb672-3"><a href="simulace4.html#cb672-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb672-4"><a href="simulace4.html#cb672-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb672-5"><a href="simulace4.html#cb672-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb672-6"><a href="simulace4.html#cb672-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb672-7"><a href="simulace4.html#cb672-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb672-8"><a href="simulace4.html#cb672-8" tabindex="-1"></a></span>
<span id="cb672-9"><a href="simulace4.html#cb672-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb672-10"><a href="simulace4.html#cb672-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb672-11"><a href="simulace4.html#cb672-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb672-12"><a href="simulace4.html#cb672-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb672-13"><a href="simulace4.html#cb672-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb672-14"><a href="simulace4.html#cb672-14" tabindex="-1"></a></span>
<span id="cb672-15"><a href="simulace4.html#cb672-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb672-16"><a href="simulace4.html#cb672-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb672-17"><a href="simulace4.html#cb672-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb672-18"><a href="simulace4.html#cb672-18" tabindex="-1"></a></span>
<span id="cb672-19"><a href="simulace4.html#cb672-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb672-20"><a href="simulace4.html#cb672-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb672-21"><a href="simulace4.html#cb672-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb672-22"><a href="simulace4.html#cb672-22" tabindex="-1"></a></span>
<span id="cb672-23"><a href="simulace4.html#cb672-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb672-24"><a href="simulace4.html#cb672-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb672-25"><a href="simulace4.html#cb672-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s see how the optimal values turned out. For the <em>linear kernel</em>, the optimal <span class="math inline">\(C\)</span> value is 0.1, for the <em>polynomial kernel</em>, <span class="math inline">\(C\)</span> is 0.1, and for the <em>radial kernel</em>, we have two optimal values: <span class="math inline">\(C\)</span> is 10, and <span class="math inline">\(\gamma\)</span> is 0.01. The validation error rates are 0.099359 for linear, 0.1208013 for polynomial, and 0.0792399 for radial kernels.</p>
<p>Finally, we can construct the final classifiers on the entire training dataset using the hyperparameter values determined by 10-fold CV. We will also calculate the error rates on both the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb673"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb673-1"><a href="simulace4.html#cb673-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb673-2"><a href="simulace4.html#cb673-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb673-3"><a href="simulace4.html#cb673-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb673-4"><a href="simulace4.html#cb673-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb673-5"><a href="simulace4.html#cb673-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb673-6"><a href="simulace4.html#cb673-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb673-7"><a href="simulace4.html#cb673-7" tabindex="-1"></a></span>
<span id="cb673-8"><a href="simulace4.html#cb673-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb673-9"><a href="simulace4.html#cb673-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb673-10"><a href="simulace4.html#cb673-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb673-11"><a href="simulace4.html#cb673-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb673-12"><a href="simulace4.html#cb673-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb673-13"><a href="simulace4.html#cb673-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb673-14"><a href="simulace4.html#cb673-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb673-15"><a href="simulace4.html#cb673-15" tabindex="-1"></a></span>
<span id="cb673-16"><a href="simulace4.html#cb673-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb673-17"><a href="simulace4.html#cb673-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb673-18"><a href="simulace4.html#cb673-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb673-19"><a href="simulace4.html#cb673-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb673-20"><a href="simulace4.html#cb673-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb673-21"><a href="simulace4.html#cb673-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb673-22"><a href="simulace4.html#cb673-22" tabindex="-1"></a></span>
<span id="cb673-23"><a href="simulace4.html#cb673-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb673-24"><a href="simulace4.html#cb673-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb673-25"><a href="simulace4.html#cb673-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb673-26"><a href="simulace4.html#cb673-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb673-27"><a href="simulace4.html#cb673-27" tabindex="-1"></a></span>
<span id="cb673-28"><a href="simulace4.html#cb673-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb673-29"><a href="simulace4.html#cb673-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb673-30"><a href="simulace4.html#cb673-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb673-31"><a href="simulace4.html#cb673-31" tabindex="-1"></a></span>
<span id="cb673-32"><a href="simulace4.html#cb673-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb673-33"><a href="simulace4.html#cb673-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb673-34"><a href="simulace4.html#cb673-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb673-35"><a href="simulace4.html#cb673-35" tabindex="-1"></a>  </span>
<span id="cb673-36"><a href="simulace4.html#cb673-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb673-37"><a href="simulace4.html#cb673-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb673-38"><a href="simulace4.html#cb673-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb673-39"><a href="simulace4.html#cb673-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb673-40"><a href="simulace4.html#cb673-40" tabindex="-1"></a></span>
<span id="cb673-41"><a href="simulace4.html#cb673-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb673-42"><a href="simulace4.html#cb673-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb673-43"><a href="simulace4.html#cb673-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb673-44"><a href="simulace4.html#cb673-44" tabindex="-1"></a></span>
<span id="cb673-45"><a href="simulace4.html#cb673-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb673-46"><a href="simulace4.html#cb673-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb673-47"><a href="simulace4.html#cb673-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is 5.71% for the linear kernel, 9.29% for the polynomial kernel, and 1.43% for the Gaussian kernel.<br />
On the test data, the error rate is 6.6667% for the linear kernel, 6.6667% for the polynomial kernel, and 8.3333% for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb674"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb674-1"><a href="simulace4.html#cb674-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb674-2"><a href="simulace4.html#cb674-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb674-3"><a href="simulace4.html#cb674-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb674-4"><a href="simulace4.html#cb674-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb674-5"><a href="simulace4.html#cb674-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb674-6"><a href="simulace4.html#cb674-6" tabindex="-1"></a></span>
<span id="cb674-7"><a href="simulace4.html#cb674-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVM2der" class="section level5 hasAnchor" number="5.2.3.7.5">
<h5><span class="header-section-number">5.2.3.7.5</span> Projection onto B-spline Basis<a href="simulace4.html#projection-SVM2der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Another option for using the classical SVM method for functional data is to project the original data onto some <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal{H}\)</span>, denoted as <span class="math inline">\(V_d\)</span>. Assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>. We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, so we can write:</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>Now we can use the coefficients from the orthogonal projection for classification, that is, we apply the standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>. By using this transformation, we have defined a new so-called adapted kernel, which consists of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector method. Thus, we have (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>. This is a dimensionality reduction method, which we can call <em>filtering</em>.</p>
<p>For the projection itself, we will use the <code>project.basis()</code> function from the <code>fda</code> library in <code>R</code>. Its input will be a matrix of the original discrete (non-smoothed) data, the values at which we measure values in the original data matrix, and the basis object onto which we want to project the data. We will choose projection onto a B-spline basis since the use of a Fourier basis is not suitable for our non-periodic data.</p>
<p>We choose the dimension <span class="math inline">\(d\)</span> either from some prior expert knowledge or by using cross-validation. In our case, we will determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (we choose <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method, often <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span>). We require B-splines of order 4, for which the relationship for the number of basis functions holds:</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>. Therefore, the minimum dimension (for <span class="math inline">\(n_{breaks} = 1\)</span>) is chosen as <span class="math inline">\(n_{basis} = 3\)</span>, and the maximum (for <span class="math inline">\(n_{breaks} = 51\)</span>, corresponding to the number of original discrete data points) is <span class="math inline">\(n_{basis} = 53\)</span>. However, in <code>R</code>, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and for large values of <span class="math inline">\(n_{basis}\)</span>, we already experience model overfitting; therefore, we choose a maximum <span class="math inline">\(n_{basis}\)</span> of a smaller number, say 43.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb675"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb675-1"><a href="simulace4.html#cb675-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb675-2"><a href="simulace4.html#cb675-2" tabindex="-1"></a></span>
<span id="cb675-3"><a href="simulace4.html#cb675-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb675-4"><a href="simulace4.html#cb675-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb675-5"><a href="simulace4.html#cb675-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb675-6"><a href="simulace4.html#cb675-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb675-7"><a href="simulace4.html#cb675-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb675-8"><a href="simulace4.html#cb675-8" tabindex="-1"></a></span>
<span id="cb675-9"><a href="simulace4.html#cb675-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># all dimensions we want to try</span></span>
<span id="cb675-10"><a href="simulace4.html#cb675-10" tabindex="-1"></a></span>
<span id="cb675-11"><a href="simulace4.html#cb675-11" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb675-12"><a href="simulace4.html#cb675-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb675-13"><a href="simulace4.html#cb675-13" tabindex="-1"></a></span>
<span id="cb675-14"><a href="simulace4.html#cb675-14" tabindex="-1"></a><span class="co"># List with three components ... matrices for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb675-15"><a href="simulace4.html#cb675-15" tabindex="-1"></a><span class="co"># An empty matrix where we will insert individual results</span></span>
<span id="cb675-16"><a href="simulace4.html#cb675-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for each part of the training set</span></span>
<span id="cb675-17"><a href="simulace4.html#cb675-17" tabindex="-1"></a><span class="co"># Rows will contain values for each dimension value</span></span>
<span id="cb675-18"><a href="simulace4.html#cb675-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb675-19"><a href="simulace4.html#cb675-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb675-20"><a href="simulace4.html#cb675-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb675-21"><a href="simulace4.html#cb675-21" tabindex="-1"></a></span>
<span id="cb675-22"><a href="simulace4.html#cb675-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb675-23"><a href="simulace4.html#cb675-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb675-24"><a href="simulace4.html#cb675-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb675-25"><a href="simulace4.html#cb675-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb675-26"><a href="simulace4.html#cb675-26" tabindex="-1"></a>  </span>
<span id="cb675-27"><a href="simulace4.html#cb675-27" tabindex="-1"></a>  <span class="co"># Projection of discrete data onto the B-spline basis of dimension d</span></span>
<span id="cb675-28"><a href="simulace4.html#cb675-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)) <span class="sc">|&gt;</span> <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="co"># matrix of discrete data</span></span>
<span id="cb675-29"><a href="simulace4.html#cb675-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t.seq, <span class="co"># vector of arguments</span></span>
<span id="cb675-30"><a href="simulace4.html#cb675-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb675-31"><a href="simulace4.html#cb675-31" tabindex="-1"></a>  </span>
<span id="cb675-32"><a href="simulace4.html#cb675-32" tabindex="-1"></a>  <span class="co"># Splitting into training and test data within CV</span></span>
<span id="cb675-33"><a href="simulace4.html#cb675-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection) <span class="co"># subset(t(Projection), split == TRUE)</span></span>
<span id="cb675-34"><a href="simulace4.html#cb675-34" tabindex="-1"></a>  </span>
<span id="cb675-35"><a href="simulace4.html#cb675-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb675-36"><a href="simulace4.html#cb675-36" tabindex="-1"></a>    <span class="co"># Definition of test and training parts for CV</span></span>
<span id="cb675-37"><a href="simulace4.html#cb675-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb675-38"><a href="simulace4.html#cb675-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb675-39"><a href="simulace4.html#cb675-39" tabindex="-1"></a>    </span>
<span id="cb675-40"><a href="simulace4.html#cb675-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb675-41"><a href="simulace4.html#cb675-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb675-42"><a href="simulace4.html#cb675-42" tabindex="-1"></a>    </span>
<span id="cb675-43"><a href="simulace4.html#cb675-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb675-44"><a href="simulace4.html#cb675-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb675-45"><a href="simulace4.html#cb675-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb675-46"><a href="simulace4.html#cb675-46" tabindex="-1"></a>  </span>
<span id="cb675-47"><a href="simulace4.html#cb675-47" tabindex="-1"></a>    <span class="co"># Building the models</span></span>
<span id="cb675-48"><a href="simulace4.html#cb675-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb675-49"><a href="simulace4.html#cb675-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb675-50"><a href="simulace4.html#cb675-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb675-51"><a href="simulace4.html#cb675-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb675-52"><a href="simulace4.html#cb675-52" tabindex="-1"></a>    </span>
<span id="cb675-53"><a href="simulace4.html#cb675-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb675-54"><a href="simulace4.html#cb675-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb675-55"><a href="simulace4.html#cb675-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb675-56"><a href="simulace4.html#cb675-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb675-57"><a href="simulace4.html#cb675-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb675-58"><a href="simulace4.html#cb675-58" tabindex="-1"></a>    </span>
<span id="cb675-59"><a href="simulace4.html#cb675-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb675-60"><a href="simulace4.html#cb675-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb675-61"><a href="simulace4.html#cb675-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb675-62"><a href="simulace4.html#cb675-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb675-63"><a href="simulace4.html#cb675-63" tabindex="-1"></a>      </span>
<span id="cb675-64"><a href="simulace4.html#cb675-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb675-65"><a href="simulace4.html#cb675-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb675-66"><a href="simulace4.html#cb675-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb675-67"><a href="simulace4.html#cb675-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb675-68"><a href="simulace4.html#cb675-68" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb675-69"><a href="simulace4.html#cb675-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb675-70"><a href="simulace4.html#cb675-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb675-71"><a href="simulace4.html#cb675-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb675-72"><a href="simulace4.html#cb675-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb675-73"><a href="simulace4.html#cb675-73" tabindex="-1"></a>    accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb675-74"><a href="simulace4.html#cb675-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb675-75"><a href="simulace4.html#cb675-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb675-76"><a href="simulace4.html#cb675-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb675-77"><a href="simulace4.html#cb675-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb675-78"><a href="simulace4.html#cb675-78" tabindex="-1"></a>    accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb675-79"><a href="simulace4.html#cb675-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb675-80"><a href="simulace4.html#cb675-80" tabindex="-1"></a>    </span>
<span id="cb675-81"><a href="simulace4.html#cb675-81" tabindex="-1"></a>    <span class="co"># Insert accuracies into positions for given d and fold</span></span>
<span id="cb675-82"><a href="simulace4.html#cb675-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb675-83"><a href="simulace4.html#cb675-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb675-84"><a href="simulace4.html#cb675-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb675-85"><a href="simulace4.html#cb675-85" tabindex="-1"></a>  }</span>
<span id="cb675-86"><a href="simulace4.html#cb675-86" tabindex="-1"></a>}</span>
<span id="cb675-87"><a href="simulace4.html#cb675-87" tabindex="-1"></a>  </span>
<span id="cb675-88"><a href="simulace4.html#cb675-88" tabindex="-1"></a><span class="co"># Compute average accuracies for individual d across folds</span></span>
<span id="cb675-89"><a href="simulace4.html#cb675-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb675-90"><a href="simulace4.html#cb675-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb675-91"><a href="simulace4.html#cb675-91" tabindex="-1"></a>}</span>
<span id="cb675-92"><a href="simulace4.html#cb675-92" tabindex="-1"></a></span>
<span id="cb675-93"><a href="simulace4.html#cb675-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb675-94"><a href="simulace4.html#cb675-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb675-95"><a href="simulace4.html#cb675-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb675-96"><a href="simulace4.html#cb675-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb675-97"><a href="simulace4.html#cb675-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb675-98"><a href="simulace4.html#cb675-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb675-99"><a href="simulace4.html#cb675-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb675-100"><a href="simulace4.html#cb675-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear    16 0.10007326
## poly      11 0.11804945
## radial    11 0.09126374</code></pre>
<p>We see that the best value for the parameter <span class="math inline">\(d\)</span> is 16 for the linear kernel, with an error rate calculated using 10-fold CV of 0.1001, 11 for the polynomial kernel with an error rate of 0.118, and 11 for the radial kernel with an error rate of 0.0913.</p>
<p>To clarify, let’s plot the validation error rates as a function of the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb677"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb677-1"><a href="simulace4.html#cb677-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb677-2"><a href="simulace4.html#cb677-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb677-3"><a href="simulace4.html#cb677-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb677-4"><a href="simulace4.html#cb677-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb677-5"><a href="simulace4.html#cb677-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb677-6"><a href="simulace4.html#cb677-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb677-7"><a href="simulace4.html#cb677-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb677-8"><a href="simulace4.html#cb677-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb677-9"><a href="simulace4.html#cb677-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb677-10"><a href="simulace4.html#cb677-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb677-11"><a href="simulace4.html#cb677-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb677-12"><a href="simulace4.html#cb677-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb677-13"><a href="simulace4.html#cb677-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb677-14"><a href="simulace4.html#cb677-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb677-15"><a href="simulace4.html#cb677-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb677-16"><a href="simulace4.html#cb677-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb677-17"><a href="simulace4.html#cb677-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-235"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-235-1.png" alt="Dependency of validation error rate on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The optimal values of the dimension $V_d$ for each kernel function are marked with black points." width="672" />
<p class="caption">
Figure 5.39: Dependency of validation error rate on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The optimal values of the dimension <span class="math inline">\(V_d\)</span> for each kernel function are marked with black points.
</p>
</div>
<p>Now we can train the individual classifiers on all training data and examine their performance on the test data. For each kernel function, we choose the dimension of the subspace to project onto according to the results of cross-validation.</p>
<p>The variable <code>Projection</code> stores the matrix of coefficients from the orthogonal projection, that is,</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb678"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb678-1"><a href="simulace4.html#cb678-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb678-2"><a href="simulace4.html#cb678-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb678-3"><a href="simulace4.html#cb678-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb678-4"><a href="simulace4.html#cb678-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb678-5"><a href="simulace4.html#cb678-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb678-6"><a href="simulace4.html#cb678-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb678-7"><a href="simulace4.html#cb678-7" tabindex="-1"></a></span>
<span id="cb678-8"><a href="simulace4.html#cb678-8" tabindex="-1"></a><span class="co"># Loop through each kernel</span></span>
<span id="cb678-9"><a href="simulace4.html#cb678-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb678-10"><a href="simulace4.html#cb678-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb678-11"><a href="simulace4.html#cb678-11" tabindex="-1"></a>  <span class="co"># Base object</span></span>
<span id="cb678-12"><a href="simulace4.html#cb678-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb678-13"><a href="simulace4.html#cb678-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb678-14"><a href="simulace4.html#cb678-14" tabindex="-1"></a>  </span>
<span id="cb678-15"><a href="simulace4.html#cb678-15" tabindex="-1"></a>  <span class="co"># Project discrete data onto B-spline basis</span></span>
<span id="cb678-16"><a href="simulace4.html#cb678-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> <span class="fu">rbind</span>(</span>
<span id="cb678-17"><a href="simulace4.html#cb678-17" tabindex="-1"></a>    grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)),</span>
<span id="cb678-18"><a href="simulace4.html#cb678-18" tabindex="-1"></a>    grid.data.test <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb678-19"><a href="simulace4.html#cb678-19" tabindex="-1"></a>      <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="co"># Matrix of discrete data</span></span>
<span id="cb678-20"><a href="simulace4.html#cb678-20" tabindex="-1"></a>                              <span class="at">argvals =</span> t.seq, <span class="co"># Vector of arguments</span></span>
<span id="cb678-21"><a href="simulace4.html#cb678-21" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># Basis object</span></span>
<span id="cb678-22"><a href="simulace4.html#cb678-22" tabindex="-1"></a>  </span>
<span id="cb678-23"><a href="simulace4.html#cb678-23" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb678-24"><a href="simulace4.html#cb678-24" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), ]</span>
<span id="cb678-25"><a href="simulace4.html#cb678-25" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[(<span class="fu">sum</span>(split) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(split), ]</span>
<span id="cb678-26"><a href="simulace4.html#cb678-26" tabindex="-1"></a>  </span>
<span id="cb678-27"><a href="simulace4.html#cb678-27" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb678-28"><a href="simulace4.html#cb678-28" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb678-29"><a href="simulace4.html#cb678-29" tabindex="-1"></a>  </span>
<span id="cb678-30"><a href="simulace4.html#cb678-30" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb678-31"><a href="simulace4.html#cb678-31" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb678-32"><a href="simulace4.html#cb678-32" tabindex="-1"></a>  </span>
<span id="cb678-33"><a href="simulace4.html#cb678-33" tabindex="-1"></a>  <span class="co"># Construct the model</span></span>
<span id="cb678-34"><a href="simulace4.html#cb678-34" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb678-35"><a href="simulace4.html#cb678-35" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb678-36"><a href="simulace4.html#cb678-36" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb678-37"><a href="simulace4.html#cb678-37" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb678-38"><a href="simulace4.html#cb678-38" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb678-39"><a href="simulace4.html#cb678-39" tabindex="-1"></a>  </span>
<span id="cb678-40"><a href="simulace4.html#cb678-40" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb678-41"><a href="simulace4.html#cb678-41" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb678-42"><a href="simulace4.html#cb678-42" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb678-43"><a href="simulace4.html#cb678-43" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb678-44"><a href="simulace4.html#cb678-44" tabindex="-1"></a>    </span>
<span id="cb678-45"><a href="simulace4.html#cb678-45" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb678-46"><a href="simulace4.html#cb678-46" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb678-47"><a href="simulace4.html#cb678-47" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb678-48"><a href="simulace4.html#cb678-48" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb678-49"><a href="simulace4.html#cb678-49" tabindex="-1"></a>  </span>
<span id="cb678-50"><a href="simulace4.html#cb678-50" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb678-51"><a href="simulace4.html#cb678-51" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb678-52"><a href="simulace4.html#cb678-52" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is therefore 5 % for the linear kernel, 2.86 % for the polynomial kernel, and 5 % for the Gaussian kernel. On the test data, the error rates are 8.33 % for the linear kernel, 11.67 % for the polynomial kernel, and 8.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb679"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb679-1"><a href="simulace4.html#cb679-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVM2der" class="section level5 hasAnchor" number="5.2.3.7.6">
<h5><span class="header-section-number">5.2.3.7.6</span> RKHS + SVM<a href="simulace4.html#RKHS-SVM2der" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>In this section, we will explore another way to utilize support vector machines (SVM) for classifying functional data. Here, we will again rely on the familiar principle of first expressing functional data as finite-dimensional objects and then applying the traditional SVM method to these objects.</p>
<p>However, this time we will use the SVM method for the representation of functional data itself via a certain finite-dimensional object. As the name suggests, this involves a combination of two concepts: the support vector machine method and a space referred to in English literature as <em>Reproducing Kernel Hilbert Space</em> (RKHS). A key concept in this space is the <em>kernel</em>.</p>
<div id="implementation-of-the-method-in-r-2" class="section level6 hasAnchor" number="5.2.3.7.6.1">
<h6><span class="header-section-number">5.2.3.7.6.1</span> Implementation of the Method in <code>R</code><a href="simulace4.html#implementation-of-the-method-in-r-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<p>From the last part of Theorem <a href="simulace3.html#thm:MaG">1.3</a>, we can see how to compute the representations of curves in practice. We will work with discretized data after smoothing the curves. First, let’s define a kernel for the RKHS space. We will use the Gaussian kernel with a parameter <span class="math inline">\(\gamma\)</span>. The value of this hyperparameter significantly affects the behaviour and success of the method, so we must pay special attention to its choice (we select it using cross-validation).</p>
</div>
<div id="gaussian-kernel-4" class="section level6 hasAnchor" number="5.2.3.7.6.2">
<h6><span class="header-section-number">5.2.3.7.6.2</span> Gaussian Kernel<a href="simulace4.html#gaussian-kernel-4" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb680"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb680-1"><a href="simulace4.html#cb680-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb680-2"><a href="simulace4.html#cb680-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb680-3"><a href="simulace4.html#cb680-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb680-4"><a href="simulace4.html#cb680-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb680-5"><a href="simulace4.html#cb680-5" tabindex="-1"></a></span>
<span id="cb680-6"><a href="simulace4.html#cb680-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb680-7"><a href="simulace4.html#cb680-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb680-8"><a href="simulace4.html#cb680-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb680-9"><a href="simulace4.html#cb680-9" tabindex="-1"></a>}</span>
<span id="cb680-10"><a href="simulace4.html#cb680-10" tabindex="-1"></a></span>
<span id="cb680-11"><a href="simulace4.html#cb680-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb680-12"><a href="simulace4.html#cb680-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb680-13"><a href="simulace4.html#cb680-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb680-14"><a href="simulace4.html#cb680-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb680-15"><a href="simulace4.html#cb680-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb680-16"><a href="simulace4.html#cb680-16" tabindex="-1"></a>    }</span>
<span id="cb680-17"><a href="simulace4.html#cb680-17" tabindex="-1"></a>  }</span>
<span id="cb680-18"><a href="simulace4.html#cb680-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb680-19"><a href="simulace4.html#cb680-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s compute the matrix <span class="math inline">\(K_S\)</span> along with its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb681"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb681-1"><a href="simulace4.html#cb681-1" tabindex="-1"></a><span class="co"># Compute the matrix K</span></span>
<span id="cb681-2"><a href="simulace4.html#cb681-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Fixed value for gamma; optimal will be determined using CV</span></span>
<span id="cb681-3"><a href="simulace4.html#cb681-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb681-4"><a href="simulace4.html#cb681-4" tabindex="-1"></a></span>
<span id="cb681-5"><a href="simulace4.html#cb681-5" tabindex="-1"></a><span class="co"># Determine eigenvalues and vectors</span></span>
<span id="cb681-6"><a href="simulace4.html#cb681-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb681-7"><a href="simulace4.html#cb681-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb681-8"><a href="simulace4.html#cb681-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To compute the coefficients in the representation of the curves, that is, to calculate the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we also need the coefficients from SVM. Unlike the classification problem, we are now solving a regression problem, as we are trying to express our observed curves in some basis chosen by the kernel <span class="math inline">\(K\)</span>. Therefore, we will use the <em>Support Vector Regression</em> method, from which we will obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb682"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb682-1"><a href="simulace4.html#cb682-1" tabindex="-1"></a><span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb682-2"><a href="simulace4.html#cb682-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb682-3"><a href="simulace4.html#cb682-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb682-4"><a href="simulace4.html#cb682-4" tabindex="-1"></a></span>
<span id="cb682-5"><a href="simulace4.html#cb682-5" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb682-6"><a href="simulace4.html#cb682-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb682-7"><a href="simulace4.html#cb682-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb682-8"><a href="simulace4.html#cb682-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb682-9"><a href="simulace4.html#cb682-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb682-10"><a href="simulace4.html#cb682-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb682-11"><a href="simulace4.html#cb682-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb682-12"><a href="simulace4.html#cb682-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb682-13"><a href="simulace4.html#cb682-13" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb682-14"><a href="simulace4.html#cb682-14" tabindex="-1"></a>  <span class="co"># Determine alpha</span></span>
<span id="cb682-15"><a href="simulace4.html#cb682-15" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb682-16"><a href="simulace4.html#cb682-16" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can compute the representations of the individual curves. First, let’s choose <span class="math inline">\(\hat d\)</span> to be the entire dimension, that is, <span class="math inline">\(\hat d = m ={}\)</span> 101, and then determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb683"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb683-1"><a href="simulace4.html#cb683-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb683-2"><a href="simulace4.html#cb683-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb683-3"><a href="simulace4.html#cb683-3" tabindex="-1"></a></span>
<span id="cb683-4"><a href="simulace4.html#cb683-4" tabindex="-1"></a><span class="co"># Determine the vector lambda</span></span>
<span id="cb683-5"><a href="simulace4.html#cb683-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb683-6"><a href="simulace4.html#cb683-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb683-7"><a href="simulace4.html#cb683-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># Create an empty object</span></span>
<span id="cb683-8"><a href="simulace4.html#cb683-8" tabindex="-1"></a></span>
<span id="cb683-9"><a href="simulace4.html#cb683-9" tabindex="-1"></a><span class="co"># Compute the representation</span></span>
<span id="cb683-10"><a href="simulace4.html#cb683-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb683-11"><a href="simulace4.html#cb683-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb683-12"><a href="simulace4.html#cb683-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have stored the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> for each curve in the <code>Lambda.RKHS</code> matrix. We will use these vectors as representations of the given curves and classify the data based on this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb684"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb684-1"><a href="simulace4.html#cb684-1" tabindex="-1"></a><span class="co"># Split into training and testing data</span></span>
<span id="cb684-2"><a href="simulace4.html#cb684-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb684-3"><a href="simulace4.html#cb684-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb684-4"><a href="simulace4.html#cb684-4" tabindex="-1"></a></span>
<span id="cb684-5"><a href="simulace4.html#cb684-5" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb684-6"><a href="simulace4.html#cb684-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb684-7"><a href="simulace4.html#cb684-7" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb684-8"><a href="simulace4.html#cb684-8" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb684-9"><a href="simulace4.html#cb684-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb684-10"><a href="simulace4.html#cb684-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb684-11"><a href="simulace4.html#cb684-11" tabindex="-1"></a></span>
<span id="cb684-12"><a href="simulace4.html#cb684-12" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb684-13"><a href="simulace4.html#cb684-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb684-14"><a href="simulace4.html#cb684-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb684-15"><a href="simulace4.html#cb684-15" tabindex="-1"></a></span>
<span id="cb684-16"><a href="simulace4.html#cb684-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb684-17"><a href="simulace4.html#cb684-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb684-18"><a href="simulace4.html#cb684-18" tabindex="-1"></a>  </span>
<span id="cb684-19"><a href="simulace4.html#cb684-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb684-20"><a href="simulace4.html#cb684-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb684-21"><a href="simulace4.html#cb684-21" tabindex="-1"></a>  </span>
<span id="cb684-22"><a href="simulace4.html#cb684-22" tabindex="-1"></a>  <span class="co"># Construct the models</span></span>
<span id="cb684-23"><a href="simulace4.html#cb684-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb684-24"><a href="simulace4.html#cb684-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb684-25"><a href="simulace4.html#cb684-25" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb684-26"><a href="simulace4.html#cb684-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb684-27"><a href="simulace4.html#cb684-27" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb684-28"><a href="simulace4.html#cb684-28" tabindex="-1"></a>  </span>
<span id="cb684-29"><a href="simulace4.html#cb684-29" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb684-30"><a href="simulace4.html#cb684-30" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb684-31"><a href="simulace4.html#cb684-31" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb684-32"><a href="simulace4.html#cb684-32" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb684-33"><a href="simulace4.html#cb684-33" tabindex="-1"></a>    </span>
<span id="cb684-34"><a href="simulace4.html#cb684-34" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb684-35"><a href="simulace4.html#cb684-35" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb684-36"><a href="simulace4.html#cb684-36" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb684-37"><a href="simulace4.html#cb684-37" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb684-38"><a href="simulace4.html#cb684-38" tabindex="-1"></a>  </span>
<span id="cb684-39"><a href="simulace4.html#cb684-39" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb684-40"><a href="simulace4.html#cb684-40" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb684-41"><a href="simulace4.html#cb684-41" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-243">Table 5.8: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.0000</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0000</td>
<td align="center">0.2500</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0143</td>
<td align="center">0.2333</td>
</tr>
</tbody>
</table>
<p>We observe that the model performs very well on the training data for all three kernels, while its success on the testing data is not good at all. It is evident that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb685"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb685-1"><a href="simulace4.html#cb685-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb685-2"><a href="simulace4.html#cb685-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb685-3"><a href="simulace4.html#cb685-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb685-4"><a href="simulace4.html#cb685-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb685-5"><a href="simulace4.html#cb685-5" tabindex="-1"></a></span>
<span id="cb685-6"><a href="simulace4.html#cb685-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb685-7"><a href="simulace4.html#cb685-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of values for d</span></span>
<span id="cb685-8"><a href="simulace4.html#cb685-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb685-9"><a href="simulace4.html#cb685-9" tabindex="-1"></a></span>
<span id="cb685-10"><a href="simulace4.html#cb685-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb685-11"><a href="simulace4.html#cb685-11" tabindex="-1"></a><span class="co"># Empty matrix where we will store individual results</span></span>
<span id="cb685-12"><a href="simulace4.html#cb685-12" tabindex="-1"></a><span class="co"># Columns will represent accuracy values for given gamma, and rows will correspond to folds</span></span>
<span id="cb685-13"><a href="simulace4.html#cb685-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb685-14"><a href="simulace4.html#cb685-14" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb685-15"><a href="simulace4.html#cb685-15" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb685-16"><a href="simulace4.html#cb685-16" tabindex="-1"></a></span>
<span id="cb685-17"><a href="simulace4.html#cb685-17" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb685-18"><a href="simulace4.html#cb685-18" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb685-19"><a href="simulace4.html#cb685-19" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb685-20"><a href="simulace4.html#cb685-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb685-21"><a href="simulace4.html#cb685-21" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb685-22"><a href="simulace4.html#cb685-22" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb685-23"><a href="simulace4.html#cb685-23" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb686"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb686-1"><a href="simulace4.html#cb686-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb686-2"><a href="simulace4.html#cb686-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb686-3"><a href="simulace4.html#cb686-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb686-4"><a href="simulace4.html#cb686-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb686-5"><a href="simulace4.html#cb686-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb686-6"><a href="simulace4.html#cb686-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb686-7"><a href="simulace4.html#cb686-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb686-8"><a href="simulace4.html#cb686-8" tabindex="-1"></a>  </span>
<span id="cb686-9"><a href="simulace4.html#cb686-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb686-10"><a href="simulace4.html#cb686-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb686-11"><a href="simulace4.html#cb686-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb686-12"><a href="simulace4.html#cb686-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb686-13"><a href="simulace4.html#cb686-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb686-14"><a href="simulace4.html#cb686-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb686-15"><a href="simulace4.html#cb686-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb686-16"><a href="simulace4.html#cb686-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb686-17"><a href="simulace4.html#cb686-17" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb686-18"><a href="simulace4.html#cb686-18" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb686-19"><a href="simulace4.html#cb686-19" tabindex="-1"></a>  }</span>
<span id="cb686-20"><a href="simulace4.html#cb686-20" tabindex="-1"></a>  </span>
<span id="cb686-21"><a href="simulace4.html#cb686-21" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb686-22"><a href="simulace4.html#cb686-22" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb686-23"><a href="simulace4.html#cb686-23" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb686-24"><a href="simulace4.html#cb686-24" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb686-25"><a href="simulace4.html#cb686-25" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb686-26"><a href="simulace4.html#cb686-26" tabindex="-1"></a>    <span class="co"># Calculate representation</span></span>
<span id="cb686-27"><a href="simulace4.html#cb686-27" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb686-28"><a href="simulace4.html#cb686-28" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb686-29"><a href="simulace4.html#cb686-29" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb686-30"><a href="simulace4.html#cb686-30" tabindex="-1"></a>    }</span>
<span id="cb686-31"><a href="simulace4.html#cb686-31" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb686-32"><a href="simulace4.html#cb686-32" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb686-33"><a href="simulace4.html#cb686-33" tabindex="-1"></a>      <span class="co"># Define test and training portions for CV</span></span>
<span id="cb686-34"><a href="simulace4.html#cb686-34" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb686-35"><a href="simulace4.html#cb686-35" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb686-36"><a href="simulace4.html#cb686-36" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb686-37"><a href="simulace4.html#cb686-37" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb686-38"><a href="simulace4.html#cb686-38" tabindex="-1"></a>      <span class="co"># Prepare a data frame to store results</span></span>
<span id="cb686-39"><a href="simulace4.html#cb686-39" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb686-40"><a href="simulace4.html#cb686-40" tabindex="-1"></a>                                   <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb686-41"><a href="simulace4.html#cb686-41" tabindex="-1"></a>                                   <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb686-42"><a href="simulace4.html#cb686-42" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb686-43"><a href="simulace4.html#cb686-43" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb686-44"><a href="simulace4.html#cb686-44" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb686-45"><a href="simulace4.html#cb686-45" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb686-46"><a href="simulace4.html#cb686-46" tabindex="-1"></a>      </span>
<span id="cb686-47"><a href="simulace4.html#cb686-47" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb686-48"><a href="simulace4.html#cb686-48" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb686-49"><a href="simulace4.html#cb686-49" tabindex="-1"></a>        </span>
<span id="cb686-50"><a href="simulace4.html#cb686-50" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb686-51"><a href="simulace4.html#cb686-51" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb686-52"><a href="simulace4.html#cb686-52" tabindex="-1"></a>        </span>
<span id="cb686-53"><a href="simulace4.html#cb686-53" tabindex="-1"></a>        <span class="co"># Construct the models</span></span>
<span id="cb686-54"><a href="simulace4.html#cb686-54" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb686-55"><a href="simulace4.html#cb686-55" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb686-56"><a href="simulace4.html#cb686-56" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb686-57"><a href="simulace4.html#cb686-57" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb686-58"><a href="simulace4.html#cb686-58" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb686-59"><a href="simulace4.html#cb686-59" tabindex="-1"></a>        </span>
<span id="cb686-60"><a href="simulace4.html#cb686-60" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb686-61"><a href="simulace4.html#cb686-61" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb686-62"><a href="simulace4.html#cb686-62" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb686-63"><a href="simulace4.html#cb686-63" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb686-64"><a href="simulace4.html#cb686-64" tabindex="-1"></a>        </span>
<span id="cb686-65"><a href="simulace4.html#cb686-65" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb686-66"><a href="simulace4.html#cb686-66" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb686-67"><a href="simulace4.html#cb686-67" tabindex="-1"></a>      }</span>
<span id="cb686-68"><a href="simulace4.html#cb686-68" tabindex="-1"></a>      <span class="co"># Store accuracies for the respective d, gamma, and fold</span></span>
<span id="cb686-69"><a href="simulace4.html#cb686-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb686-70"><a href="simulace4.html#cb686-70" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb686-71"><a href="simulace4.html#cb686-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb686-72"><a href="simulace4.html#cb686-72" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb686-73"><a href="simulace4.html#cb686-73" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb686-74"><a href="simulace4.html#cb686-74" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb686-75"><a href="simulace4.html#cb686-75" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb686-76"><a href="simulace4.html#cb686-76" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb686-77"><a href="simulace4.html#cb686-77" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb686-78"><a href="simulace4.html#cb686-78" tabindex="-1"></a>    }</span>
<span id="cb686-79"><a href="simulace4.html#cb686-79" tabindex="-1"></a>  }</span>
<span id="cb686-80"><a href="simulace4.html#cb686-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb687"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb687-1"><a href="simulace4.html#cb687-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb687-2"><a href="simulace4.html#cb687-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb687-3"><a href="simulace4.html#cb687-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb687-4"><a href="simulace4.html#cb687-4" tabindex="-1"></a>}</span>
<span id="cb687-5"><a href="simulace4.html#cb687-5" tabindex="-1"></a></span>
<span id="cb687-6"><a href="simulace4.html#cb687-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb687-7"><a href="simulace4.html#cb687-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb687-8"><a href="simulace4.html#cb687-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb687-9"><a href="simulace4.html#cb687-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb687-10"><a href="simulace4.html#cb687-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb687-11"><a href="simulace4.html#cb687-11" tabindex="-1"></a></span>
<span id="cb687-12"><a href="simulace4.html#cb687-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb687-13"><a href="simulace4.html#cb687-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb687-14"><a href="simulace4.html#cb687-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb687-15"><a href="simulace4.html#cb687-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb687-16"><a href="simulace4.html#cb687-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb687-17"><a href="simulace4.html#cb687-17" tabindex="-1"></a></span>
<span id="cb687-18"><a href="simulace4.html#cb687-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb687-19"><a href="simulace4.html#cb687-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb687-20"><a href="simulace4.html#cb687-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb687-21"><a href="simulace4.html#cb687-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb687-22"><a href="simulace4.html#cb687-22" tabindex="-1"></a>                          <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb687-23"><a href="simulace4.html#cb687-23" tabindex="-1"></a>                          <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-246">Table 5.9: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">39</td>
<td align="right">1.3895</td>
<td align="right">0.0629</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">40</td>
<td align="right">1.3895</td>
<td align="right">0.0876</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">31</td>
<td align="right">1.3895</td>
<td align="right">0.0782</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best parameter value is <span class="math inline">\(d={}\)</span> 39 and <span class="math inline">\(\gamma={}\)</span> 1.3895 for the linear kernel with an error value calculated using 10-fold CV of 0.0629, <span class="math inline">\(d={}\)</span> 40 and <span class="math inline">\(\gamma={}\)</span> 1.3895 for the polynomial kernel with an error value calculated using 10-fold CV of 0.0876 and <span class="math inline">\(d={}\)</span> 31 and <span class="math inline">\(\gamma={}\)</span> 1.3895 for the radial kernel with an error value of 0.0782.
For curiosity, let’s also plot the validation error function depending on the dimension <span class="math inline">\(d\)</span> and the hyperparameter value <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb688"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb688-1"><a href="simulace4.html#cb688-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb688-2"><a href="simulace4.html#cb688-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb688-3"><a href="simulace4.html#cb688-3" tabindex="-1"></a>                              <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb688-4"><a href="simulace4.html#cb688-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb688-5"><a href="simulace4.html#cb688-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb688-6"><a href="simulace4.html#cb688-6" tabindex="-1"></a>                              <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb688-7"><a href="simulace4.html#cb688-7" tabindex="-1"></a>                                           <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb688-8"><a href="simulace4.html#cb688-8" tabindex="-1"></a>                                             <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb688-9"><a href="simulace4.html#cb688-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb688-10"><a href="simulace4.html#cb688-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb688-11"><a href="simulace4.html#cb688-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb688-12"><a href="simulace4.html#cb688-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb688-13"><a href="simulace4.html#cb688-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb688-14"><a href="simulace4.html#cb688-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb688-15"><a href="simulace4.html#cb688-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb688-16"><a href="simulace4.html#cb688-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb688-17"><a href="simulace4.html#cb688-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb688-18"><a href="simulace4.html#cb688-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb688-19"><a href="simulace4.html#cb688-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-247"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-247-1.png" alt="Dependency of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 5.40: Dependency of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>Since we have already found the optimal values for the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb689"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb689-1"><a href="simulace4.html#cb689-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb689-2"><a href="simulace4.html#cb689-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb689-3"><a href="simulace4.html#cb689-3" tabindex="-1"></a><span class="co"># Add the test data</span></span>
<span id="cb689-4"><a href="simulace4.html#cb689-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb690"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb690-1"><a href="simulace4.html#cb690-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb690-2"><a href="simulace4.html#cb690-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb690-3"><a href="simulace4.html#cb690-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb690-4"><a href="simulace4.html#cb690-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb690-5"><a href="simulace4.html#cb690-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb690-6"><a href="simulace4.html#cb690-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb690-7"><a href="simulace4.html#cb690-7" tabindex="-1"></a></span>
<span id="cb690-8"><a href="simulace4.html#cb690-8" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb690-9"><a href="simulace4.html#cb690-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb690-10"><a href="simulace4.html#cb690-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb690-11"><a href="simulace4.html#cb690-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># Gamma value from CV</span></span>
<span id="cb690-12"><a href="simulace4.html#cb690-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb690-13"><a href="simulace4.html#cb690-13" tabindex="-1"></a>  </span>
<span id="cb690-14"><a href="simulace4.html#cb690-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb690-15"><a href="simulace4.html#cb690-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb690-16"><a href="simulace4.html#cb690-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb690-17"><a href="simulace4.html#cb690-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb690-18"><a href="simulace4.html#cb690-18" tabindex="-1"></a>  </span>
<span id="cb690-19"><a href="simulace4.html#cb690-19" tabindex="-1"></a>  <span class="co"># Determine the alpha coefficients from SVM</span></span>
<span id="cb690-20"><a href="simulace4.html#cb690-20" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb690-21"><a href="simulace4.html#cb690-21" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb690-22"><a href="simulace4.html#cb690-22" tabindex="-1"></a>  </span>
<span id="cb690-23"><a href="simulace4.html#cb690-23" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb690-24"><a href="simulace4.html#cb690-24" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb690-25"><a href="simulace4.html#cb690-25" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb690-26"><a href="simulace4.html#cb690-26" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb690-27"><a href="simulace4.html#cb690-27" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb690-28"><a href="simulace4.html#cb690-28" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb690-29"><a href="simulace4.html#cb690-29" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb690-30"><a href="simulace4.html#cb690-30" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb690-31"><a href="simulace4.html#cb690-31" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb690-32"><a href="simulace4.html#cb690-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb690-33"><a href="simulace4.html#cb690-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb690-34"><a href="simulace4.html#cb690-34" tabindex="-1"></a>  }</span>
<span id="cb690-35"><a href="simulace4.html#cb690-35" tabindex="-1"></a>  </span>
<span id="cb690-36"><a href="simulace4.html#cb690-36" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb690-37"><a href="simulace4.html#cb690-37" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb690-38"><a href="simulace4.html#cb690-38" tabindex="-1"></a>  </span>
<span id="cb690-39"><a href="simulace4.html#cb690-39" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb690-40"><a href="simulace4.html#cb690-40" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb690-41"><a href="simulace4.html#cb690-41" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb690-42"><a href="simulace4.html#cb690-42" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># Create empty object</span></span>
<span id="cb690-43"><a href="simulace4.html#cb690-43" tabindex="-1"></a>  </span>
<span id="cb690-44"><a href="simulace4.html#cb690-44" tabindex="-1"></a>  <span class="co"># Compute representation</span></span>
<span id="cb690-45"><a href="simulace4.html#cb690-45" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb690-46"><a href="simulace4.html#cb690-46" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb690-47"><a href="simulace4.html#cb690-47" tabindex="-1"></a>  }</span>
<span id="cb690-48"><a href="simulace4.html#cb690-48" tabindex="-1"></a>  </span>
<span id="cb690-49"><a href="simulace4.html#cb690-49" tabindex="-1"></a>  <span class="co"># Split into training and testing data</span></span>
<span id="cb690-50"><a href="simulace4.html#cb690-50" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb690-51"><a href="simulace4.html#cb690-51" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb690-52"><a href="simulace4.html#cb690-52" tabindex="-1"></a></span>
<span id="cb690-53"><a href="simulace4.html#cb690-53" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb690-54"><a href="simulace4.html#cb690-54" tabindex="-1"></a></span>
<span id="cb690-55"><a href="simulace4.html#cb690-55" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb690-56"><a href="simulace4.html#cb690-56" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb690-57"><a href="simulace4.html#cb690-57" tabindex="-1"></a>  </span>
<span id="cb690-58"><a href="simulace4.html#cb690-58" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb690-59"><a href="simulace4.html#cb690-59" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb690-60"><a href="simulace4.html#cb690-60" tabindex="-1"></a>  </span>
<span id="cb690-61"><a href="simulace4.html#cb690-61" tabindex="-1"></a>  <span class="co"># Construct models</span></span>
<span id="cb690-62"><a href="simulace4.html#cb690-62" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb690-63"><a href="simulace4.html#cb690-63" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb690-64"><a href="simulace4.html#cb690-64" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb690-65"><a href="simulace4.html#cb690-65" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb690-66"><a href="simulace4.html#cb690-66" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb690-67"><a href="simulace4.html#cb690-67" tabindex="-1"></a>  </span>
<span id="cb690-68"><a href="simulace4.html#cb690-68" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb690-69"><a href="simulace4.html#cb690-69" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb690-70"><a href="simulace4.html#cb690-70" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb690-71"><a href="simulace4.html#cb690-71" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb690-72"><a href="simulace4.html#cb690-72" tabindex="-1"></a>    </span>
<span id="cb690-73"><a href="simulace4.html#cb690-73" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb690-74"><a href="simulace4.html#cb690-74" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb690-75"><a href="simulace4.html#cb690-75" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb690-76"><a href="simulace4.html#cb690-76" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb690-77"><a href="simulace4.html#cb690-77" tabindex="-1"></a>  </span>
<span id="cb690-78"><a href="simulace4.html#cb690-78" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb690-79"><a href="simulace4.html#cb690-79" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb690-80"><a href="simulace4.html#cb690-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-250">Table 5.10: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.1500</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1000</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with the projection on the Reproducing Kernel Hilbert Space is thus equal to 0 % for the linear kernel, 0 % for the polynomial kernel, and 2.14 % for the Gaussian kernel on the training data. On the testing data, the error rate of the method is 18.33 % for the linear kernel, 15 % for the polynomial kernel, and 10 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb691"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb691-1"><a href="simulace4.html#cb691-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomial-kernel-2" class="section level6 hasAnchor" number="5.2.3.7.6.3">
<h6><span class="header-section-number">5.2.3.7.6.3</span> Polynomial Kernel<a href="simulace4.html#polynomial-kernel-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb692"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb692-1"><a href="simulace4.html#cb692-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb692-2"><a href="simulace4.html#cb692-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb692-3"><a href="simulace4.html#cb692-3" tabindex="-1"></a><span class="co"># Include test data as well</span></span>
<span id="cb692-4"><a href="simulace4.html#cb692-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb692-5"><a href="simulace4.html#cb692-5" tabindex="-1"></a></span>
<span id="cb692-6"><a href="simulace4.html#cb692-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb692-7"><a href="simulace4.html#cb692-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb692-8"><a href="simulace4.html#cb692-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb692-9"><a href="simulace4.html#cb692-9" tabindex="-1"></a>}</span>
<span id="cb692-10"><a href="simulace4.html#cb692-10" tabindex="-1"></a></span>
<span id="cb692-11"><a href="simulace4.html#cb692-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb692-12"><a href="simulace4.html#cb692-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb692-13"><a href="simulace4.html#cb692-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb692-14"><a href="simulace4.html#cb692-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb692-15"><a href="simulace4.html#cb692-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb692-16"><a href="simulace4.html#cb692-16" tabindex="-1"></a>    }</span>
<span id="cb692-17"><a href="simulace4.html#cb692-17" tabindex="-1"></a>  }</span>
<span id="cb692-18"><a href="simulace4.html#cb692-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb692-19"><a href="simulace4.html#cb692-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb693"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb693-1"><a href="simulace4.html#cb693-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb693-2"><a href="simulace4.html#cb693-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb693-3"><a href="simulace4.html#cb693-3" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb693-4"><a href="simulace4.html#cb693-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb693-5"><a href="simulace4.html#cb693-5" tabindex="-1"></a></span>
<span id="cb693-6"><a href="simulace4.html#cb693-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb693-7"><a href="simulace4.html#cb693-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of d values</span></span>
<span id="cb693-8"><a href="simulace4.html#cb693-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb693-9"><a href="simulace4.html#cb693-9" tabindex="-1"></a></span>
<span id="cb693-10"><a href="simulace4.html#cb693-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb693-11"><a href="simulace4.html#cb693-11" tabindex="-1"></a><span class="co"># Empty matrix to insert individual results</span></span>
<span id="cb693-12"><a href="simulace4.html#cb693-12" tabindex="-1"></a><span class="co"># Columns will hold accuracy values for given parameters</span></span>
<span id="cb693-13"><a href="simulace4.html#cb693-13" tabindex="-1"></a><span class="co"># Rows will hold values for given p and layers corresponding to folds</span></span>
<span id="cb693-14"><a href="simulace4.html#cb693-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb693-15"><a href="simulace4.html#cb693-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb693-16"><a href="simulace4.html#cb693-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb693-17"><a href="simulace4.html#cb693-17" tabindex="-1"></a></span>
<span id="cb693-18"><a href="simulace4.html#cb693-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb693-19"><a href="simulace4.html#cb693-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb693-20"><a href="simulace4.html#cb693-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb693-21"><a href="simulace4.html#cb693-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb693-22"><a href="simulace4.html#cb693-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb693-23"><a href="simulace4.html#cb693-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb693-24"><a href="simulace4.html#cb693-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb694"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb694-1"><a href="simulace4.html#cb694-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb694-2"><a href="simulace4.html#cb694-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb694-3"><a href="simulace4.html#cb694-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb694-4"><a href="simulace4.html#cb694-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb694-5"><a href="simulace4.html#cb694-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb694-6"><a href="simulace4.html#cb694-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb694-7"><a href="simulace4.html#cb694-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb694-8"><a href="simulace4.html#cb694-8" tabindex="-1"></a>  </span>
<span id="cb694-9"><a href="simulace4.html#cb694-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb694-10"><a href="simulace4.html#cb694-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb694-11"><a href="simulace4.html#cb694-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb694-12"><a href="simulace4.html#cb694-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb694-13"><a href="simulace4.html#cb694-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb694-14"><a href="simulace4.html#cb694-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb694-15"><a href="simulace4.html#cb694-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb694-16"><a href="simulace4.html#cb694-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb694-17"><a href="simulace4.html#cb694-17" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb694-18"><a href="simulace4.html#cb694-18" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb694-19"><a href="simulace4.html#cb694-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb694-20"><a href="simulace4.html#cb694-20" tabindex="-1"></a>  }</span>
<span id="cb694-21"><a href="simulace4.html#cb694-21" tabindex="-1"></a>  </span>
<span id="cb694-22"><a href="simulace4.html#cb694-22" tabindex="-1"></a>  <span class="co"># Iterate through dimensions</span></span>
<span id="cb694-23"><a href="simulace4.html#cb694-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb694-24"><a href="simulace4.html#cb694-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb694-25"><a href="simulace4.html#cb694-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb694-26"><a href="simulace4.html#cb694-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb694-27"><a href="simulace4.html#cb694-27" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb694-28"><a href="simulace4.html#cb694-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb694-29"><a href="simulace4.html#cb694-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb694-30"><a href="simulace4.html#cb694-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb694-31"><a href="simulace4.html#cb694-31" tabindex="-1"></a>    }</span>
<span id="cb694-32"><a href="simulace4.html#cb694-32" tabindex="-1"></a>    <span class="co"># Iterate through folds</span></span>
<span id="cb694-33"><a href="simulace4.html#cb694-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb694-34"><a href="simulace4.html#cb694-34" tabindex="-1"></a>      <span class="co"># Define test and training portions for CV</span></span>
<span id="cb694-35"><a href="simulace4.html#cb694-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb694-36"><a href="simulace4.html#cb694-36" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb694-37"><a href="simulace4.html#cb694-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb694-38"><a href="simulace4.html#cb694-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb694-39"><a href="simulace4.html#cb694-39" tabindex="-1"></a>      <span class="co"># Prepare a data frame to store results</span></span>
<span id="cb694-40"><a href="simulace4.html#cb694-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb694-41"><a href="simulace4.html#cb694-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb694-42"><a href="simulace4.html#cb694-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb694-43"><a href="simulace4.html#cb694-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb694-44"><a href="simulace4.html#cb694-44" tabindex="-1"></a>      <span class="co"># Iterate through individual kernels</span></span>
<span id="cb694-45"><a href="simulace4.html#cb694-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb694-46"><a href="simulace4.html#cb694-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb694-47"><a href="simulace4.html#cb694-47" tabindex="-1"></a>      </span>
<span id="cb694-48"><a href="simulace4.html#cb694-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb694-49"><a href="simulace4.html#cb694-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb694-50"><a href="simulace4.html#cb694-50" tabindex="-1"></a>        </span>
<span id="cb694-51"><a href="simulace4.html#cb694-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb694-52"><a href="simulace4.html#cb694-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb694-53"><a href="simulace4.html#cb694-53" tabindex="-1"></a>        </span>
<span id="cb694-54"><a href="simulace4.html#cb694-54" tabindex="-1"></a>        <span class="co"># Construct models</span></span>
<span id="cb694-55"><a href="simulace4.html#cb694-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb694-56"><a href="simulace4.html#cb694-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb694-57"><a href="simulace4.html#cb694-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb694-58"><a href="simulace4.html#cb694-58" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb694-59"><a href="simulace4.html#cb694-59" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb694-60"><a href="simulace4.html#cb694-60" tabindex="-1"></a>        </span>
<span id="cb694-61"><a href="simulace4.html#cb694-61" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb694-62"><a href="simulace4.html#cb694-62" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb694-63"><a href="simulace4.html#cb694-63" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb694-64"><a href="simulace4.html#cb694-64" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb694-65"><a href="simulace4.html#cb694-65" tabindex="-1"></a>        </span>
<span id="cb694-66"><a href="simulace4.html#cb694-66" tabindex="-1"></a>        <span class="co"># Store results</span></span>
<span id="cb694-67"><a href="simulace4.html#cb694-67" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb694-68"><a href="simulace4.html#cb694-68" tabindex="-1"></a>      }</span>
<span id="cb694-69"><a href="simulace4.html#cb694-69" tabindex="-1"></a>      <span class="co"># Store accuracies in positions for given d, gamma, and fold</span></span>
<span id="cb694-70"><a href="simulace4.html#cb694-70" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb694-71"><a href="simulace4.html#cb694-71" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb694-72"><a href="simulace4.html#cb694-72" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb694-73"><a href="simulace4.html#cb694-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb694-74"><a href="simulace4.html#cb694-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb694-75"><a href="simulace4.html#cb694-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb694-76"><a href="simulace4.html#cb694-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb694-77"><a href="simulace4.html#cb694-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb694-78"><a href="simulace4.html#cb694-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb694-79"><a href="simulace4.html#cb694-79" tabindex="-1"></a>    }</span>
<span id="cb694-80"><a href="simulace4.html#cb694-80" tabindex="-1"></a>  }</span>
<span id="cb694-81"><a href="simulace4.html#cb694-81" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb695"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb695-1"><a href="simulace4.html#cb695-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb695-2"><a href="simulace4.html#cb695-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb695-3"><a href="simulace4.html#cb695-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb695-4"><a href="simulace4.html#cb695-4" tabindex="-1"></a>}</span>
<span id="cb695-5"><a href="simulace4.html#cb695-5" tabindex="-1"></a></span>
<span id="cb695-6"><a href="simulace4.html#cb695-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb695-7"><a href="simulace4.html#cb695-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb695-8"><a href="simulace4.html#cb695-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb695-9"><a href="simulace4.html#cb695-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb695-10"><a href="simulace4.html#cb695-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb695-11"><a href="simulace4.html#cb695-11" tabindex="-1"></a></span>
<span id="cb695-12"><a href="simulace4.html#cb695-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb695-13"><a href="simulace4.html#cb695-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb695-14"><a href="simulace4.html#cb695-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb695-15"><a href="simulace4.html#cb695-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb695-16"><a href="simulace4.html#cb695-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb695-17"><a href="simulace4.html#cb695-17" tabindex="-1"></a></span>
<span id="cb695-18"><a href="simulace4.html#cb695-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb695-19"><a href="simulace4.html#cb695-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb695-20"><a href="simulace4.html#cb695-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb695-21"><a href="simulace4.html#cb695-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb695-22"><a href="simulace4.html#cb695-22" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb695-23"><a href="simulace4.html#cb695-23" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-255">Table 5.11: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">20</td>
<td align="right">2</td>
<td align="right">0.0967</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">17</td>
<td align="right">4</td>
<td align="right">0.1119</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">22</td>
<td align="right">5</td>
<td align="right">0.1248</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best values for parameter <span class="math inline">\(d={}\)</span> 20 and <span class="math inline">\(p={}\)</span> 2 are for the linear kernel with an error calculated using 10-fold CV 0.0967, <span class="math inline">\(d={}\)</span> 17 and <span class="math inline">\(p={}\)</span> 4 for the polynomial kernel with an error calculated using 10-fold CV 0.1119, and <span class="math inline">\(d={}\)</span> 22 and <span class="math inline">\(p={}\)</span> 5 for the radial kernel with an error 0.1248.</p>
<p>Since we have found the optimal values for the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb696"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb696-1"><a href="simulace4.html#cb696-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb696-2"><a href="simulace4.html#cb696-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb696-3"><a href="simulace4.html#cb696-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb696-4"><a href="simulace4.html#cb696-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb697"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb697-1"><a href="simulace4.html#cb697-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store results</span></span>
<span id="cb697-2"><a href="simulace4.html#cb697-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb697-3"><a href="simulace4.html#cb697-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb697-4"><a href="simulace4.html#cb697-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb697-5"><a href="simulace4.html#cb697-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb697-6"><a href="simulace4.html#cb697-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb697-7"><a href="simulace4.html#cb697-7" tabindex="-1"></a></span>
<span id="cb697-8"><a href="simulace4.html#cb697-8" tabindex="-1"></a><span class="co"># Iterate over the individual kernels</span></span>
<span id="cb697-9"><a href="simulace4.html#cb697-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb697-10"><a href="simulace4.html#cb697-10" tabindex="-1"></a>  <span class="co"># Calculate the matrix K</span></span>
<span id="cb697-11"><a href="simulace4.html#cb697-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># CV-derived parameter value</span></span>
<span id="cb697-12"><a href="simulace4.html#cb697-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb697-13"><a href="simulace4.html#cb697-13" tabindex="-1"></a>  </span>
<span id="cb697-14"><a href="simulace4.html#cb697-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb697-15"><a href="simulace4.html#cb697-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb697-16"><a href="simulace4.html#cb697-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb697-17"><a href="simulace4.html#cb697-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb697-18"><a href="simulace4.html#cb697-18" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb697-19"><a href="simulace4.html#cb697-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb697-20"><a href="simulace4.html#cb697-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb697-21"><a href="simulace4.html#cb697-21" tabindex="-1"></a>  </span>
<span id="cb697-22"><a href="simulace4.html#cb697-22" tabindex="-1"></a>  <span class="co"># Model fitting</span></span>
<span id="cb697-23"><a href="simulace4.html#cb697-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb697-24"><a href="simulace4.html#cb697-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb697-25"><a href="simulace4.html#cb697-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb697-26"><a href="simulace4.html#cb697-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb697-27"><a href="simulace4.html#cb697-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb697-28"><a href="simulace4.html#cb697-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb697-29"><a href="simulace4.html#cb697-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb697-30"><a href="simulace4.html#cb697-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb697-31"><a href="simulace4.html#cb697-31" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb697-32"><a href="simulace4.html#cb697-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb697-33"><a href="simulace4.html#cb697-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb697-34"><a href="simulace4.html#cb697-34" tabindex="-1"></a>  }</span>
<span id="cb697-35"><a href="simulace4.html#cb697-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb697-36"><a href="simulace4.html#cb697-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb697-37"><a href="simulace4.html#cb697-37" tabindex="-1"></a>  </span>
<span id="cb697-38"><a href="simulace4.html#cb697-38" tabindex="-1"></a>  <span class="co"># Determine lambda vector</span></span>
<span id="cb697-39"><a href="simulace4.html#cb697-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb697-40"><a href="simulace4.html#cb697-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb697-41"><a href="simulace4.html#cb697-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb697-42"><a href="simulace4.html#cb697-42" tabindex="-1"></a>  </span>
<span id="cb697-43"><a href="simulace4.html#cb697-43" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb697-44"><a href="simulace4.html#cb697-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb697-45"><a href="simulace4.html#cb697-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb697-46"><a href="simulace4.html#cb697-46" tabindex="-1"></a>  }</span>
<span id="cb697-47"><a href="simulace4.html#cb697-47" tabindex="-1"></a>  </span>
<span id="cb697-48"><a href="simulace4.html#cb697-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb697-49"><a href="simulace4.html#cb697-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb697-50"><a href="simulace4.html#cb697-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb697-51"><a href="simulace4.html#cb697-51" tabindex="-1"></a></span>
<span id="cb697-52"><a href="simulace4.html#cb697-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb697-53"><a href="simulace4.html#cb697-53" tabindex="-1"></a></span>
<span id="cb697-54"><a href="simulace4.html#cb697-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb697-55"><a href="simulace4.html#cb697-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb697-56"><a href="simulace4.html#cb697-56" tabindex="-1"></a>  </span>
<span id="cb697-57"><a href="simulace4.html#cb697-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb697-58"><a href="simulace4.html#cb697-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb697-59"><a href="simulace4.html#cb697-59" tabindex="-1"></a>  </span>
<span id="cb697-60"><a href="simulace4.html#cb697-60" tabindex="-1"></a>  <span class="co"># Build the models</span></span>
<span id="cb697-61"><a href="simulace4.html#cb697-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb697-62"><a href="simulace4.html#cb697-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb697-63"><a href="simulace4.html#cb697-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb697-64"><a href="simulace4.html#cb697-64" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb697-65"><a href="simulace4.html#cb697-65" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb697-66"><a href="simulace4.html#cb697-66" tabindex="-1"></a>  </span>
<span id="cb697-67"><a href="simulace4.html#cb697-67" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb697-68"><a href="simulace4.html#cb697-68" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb697-69"><a href="simulace4.html#cb697-69" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb697-70"><a href="simulace4.html#cb697-70" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb697-71"><a href="simulace4.html#cb697-71" tabindex="-1"></a>    </span>
<span id="cb697-72"><a href="simulace4.html#cb697-72" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb697-73"><a href="simulace4.html#cb697-73" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb697-74"><a href="simulace4.html#cb697-74" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb697-75"><a href="simulace4.html#cb697-75" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb697-76"><a href="simulace4.html#cb697-76" tabindex="-1"></a>  </span>
<span id="cb697-77"><a href="simulace4.html#cb697-77" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb697-78"><a href="simulace4.html#cb697-78" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb697-79"><a href="simulace4.html#cb697-79" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-258">Table 5.12: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.1167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0929</td>
<td align="center">0.1333</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus on the training data equal to 6.43 % for the linear kernel, 6.43 % for the polynomial kernel, and 9.29 % for the Gaussian kernel. On the test data, the error rate of the method is 23.33 % for the linear kernel, 11.67 % for the polynomial kernel, and 13.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb698"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb698-1"><a href="simulace4.html#cb698-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="linear-kernel-2" class="section level6 hasAnchor" number="5.2.3.7.6.4">
<h6><span class="header-section-number">5.2.3.7.6.4</span> Linear Kernel<a href="simulace4.html#linear-kernel-2" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb699"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb699-1"><a href="simulace4.html#cb699-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb699-2"><a href="simulace4.html#cb699-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb699-3"><a href="simulace4.html#cb699-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb699-4"><a href="simulace4.html#cb699-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb699-5"><a href="simulace4.html#cb699-5" tabindex="-1"></a></span>
<span id="cb699-6"><a href="simulace4.html#cb699-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb699-7"><a href="simulace4.html#cb699-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb699-8"><a href="simulace4.html#cb699-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb699-9"><a href="simulace4.html#cb699-9" tabindex="-1"></a>}</span>
<span id="cb699-10"><a href="simulace4.html#cb699-10" tabindex="-1"></a></span>
<span id="cb699-11"><a href="simulace4.html#cb699-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb699-12"><a href="simulace4.html#cb699-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb699-13"><a href="simulace4.html#cb699-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb699-14"><a href="simulace4.html#cb699-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb699-15"><a href="simulace4.html#cb699-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb699-16"><a href="simulace4.html#cb699-16" tabindex="-1"></a>    }</span>
<span id="cb699-17"><a href="simulace4.html#cb699-17" tabindex="-1"></a>  }</span>
<span id="cb699-18"><a href="simulace4.html#cb699-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb699-19"><a href="simulace4.html#cb699-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb700"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb700-1"><a href="simulace4.html#cb700-1" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb700-2"><a href="simulace4.html#cb700-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb700-3"><a href="simulace4.html#cb700-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb700-4"><a href="simulace4.html#cb700-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb700-5"><a href="simulace4.html#cb700-5" tabindex="-1"></a></span>
<span id="cb700-6"><a href="simulace4.html#cb700-6" tabindex="-1"></a><span class="co"># Values of hyperparameters that we will traverse</span></span>
<span id="cb700-7"><a href="simulace4.html#cb700-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of values for d</span></span>
<span id="cb700-8"><a href="simulace4.html#cb700-8" tabindex="-1"></a></span>
<span id="cb700-9"><a href="simulace4.html#cb700-9" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb700-10"><a href="simulace4.html#cb700-10" tabindex="-1"></a><span class="co"># Empty matrix to store the individual results</span></span>
<span id="cb700-11"><a href="simulace4.html#cb700-11" tabindex="-1"></a><span class="co"># In columns, there will be accuracy values for given d</span></span>
<span id="cb700-12"><a href="simulace4.html#cb700-12" tabindex="-1"></a><span class="co"># In rows, there will be values for layers corresponding to folds</span></span>
<span id="cb700-13"><a href="simulace4.html#cb700-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb700-14"><a href="simulace4.html#cb700-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb700-15"><a href="simulace4.html#cb700-15" tabindex="-1"></a></span>
<span id="cb700-16"><a href="simulace4.html#cb700-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb700-17"><a href="simulace4.html#cb700-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb700-18"><a href="simulace4.html#cb700-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb700-19"><a href="simulace4.html#cb700-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb700-20"><a href="simulace4.html#cb700-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb700-21"><a href="simulace4.html#cb700-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb700-22"><a href="simulace4.html#cb700-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb701"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb701-1"><a href="simulace4.html#cb701-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb701-2"><a href="simulace4.html#cb701-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb701-3"><a href="simulace4.html#cb701-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb701-4"><a href="simulace4.html#cb701-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb701-5"><a href="simulace4.html#cb701-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb701-6"><a href="simulace4.html#cb701-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb701-7"><a href="simulace4.html#cb701-7" tabindex="-1"></a></span>
<span id="cb701-8"><a href="simulace4.html#cb701-8" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb701-9"><a href="simulace4.html#cb701-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb701-10"><a href="simulace4.html#cb701-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb701-11"><a href="simulace4.html#cb701-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb701-12"><a href="simulace4.html#cb701-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb701-13"><a href="simulace4.html#cb701-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb701-14"><a href="simulace4.html#cb701-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb701-15"><a href="simulace4.html#cb701-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb701-16"><a href="simulace4.html#cb701-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb701-17"><a href="simulace4.html#cb701-17" tabindex="-1"></a>}</span>
<span id="cb701-18"><a href="simulace4.html#cb701-18" tabindex="-1"></a></span>
<span id="cb701-19"><a href="simulace4.html#cb701-19" tabindex="-1"></a><span class="co"># Traverse dimensions</span></span>
<span id="cb701-20"><a href="simulace4.html#cb701-20" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb701-21"><a href="simulace4.html#cb701-21" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb701-22"><a href="simulace4.html#cb701-22" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb701-23"><a href="simulace4.html#cb701-23" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb701-24"><a href="simulace4.html#cb701-24" tabindex="-1"></a>  <span class="co"># Calculation of representation</span></span>
<span id="cb701-25"><a href="simulace4.html#cb701-25" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb701-26"><a href="simulace4.html#cb701-26" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb701-27"><a href="simulace4.html#cb701-27" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb701-28"><a href="simulace4.html#cb701-28" tabindex="-1"></a>  }</span>
<span id="cb701-29"><a href="simulace4.html#cb701-29" tabindex="-1"></a>  <span class="co"># Traverse folds</span></span>
<span id="cb701-30"><a href="simulace4.html#cb701-30" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb701-31"><a href="simulace4.html#cb701-31" tabindex="-1"></a>    <span class="co"># Define test and training portions for CV</span></span>
<span id="cb701-32"><a href="simulace4.html#cb701-32" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb701-33"><a href="simulace4.html#cb701-33" tabindex="-1"></a>    <span class="co"># Split into training and validation data</span></span>
<span id="cb701-34"><a href="simulace4.html#cb701-34" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb701-35"><a href="simulace4.html#cb701-35" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb701-36"><a href="simulace4.html#cb701-36" tabindex="-1"></a>    <span class="co"># Prepare a data table to store results</span></span>
<span id="cb701-37"><a href="simulace4.html#cb701-37" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb701-38"><a href="simulace4.html#cb701-38" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb701-39"><a href="simulace4.html#cb701-39" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb701-40"><a href="simulace4.html#cb701-40" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb701-41"><a href="simulace4.html#cb701-41" tabindex="-1"></a>    <span class="co"># Traverse individual kernels</span></span>
<span id="cb701-42"><a href="simulace4.html#cb701-42" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb701-43"><a href="simulace4.html#cb701-43" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb701-44"><a href="simulace4.html#cb701-44" tabindex="-1"></a>    </span>
<span id="cb701-45"><a href="simulace4.html#cb701-45" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb701-46"><a href="simulace4.html#cb701-46" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb701-47"><a href="simulace4.html#cb701-47" tabindex="-1"></a>      </span>
<span id="cb701-48"><a href="simulace4.html#cb701-48" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb701-49"><a href="simulace4.html#cb701-49" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb701-50"><a href="simulace4.html#cb701-50" tabindex="-1"></a>      </span>
<span id="cb701-51"><a href="simulace4.html#cb701-51" tabindex="-1"></a>      <span class="co"># Build models</span></span>
<span id="cb701-52"><a href="simulace4.html#cb701-52" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb701-53"><a href="simulace4.html#cb701-53" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb701-54"><a href="simulace4.html#cb701-54" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb701-55"><a href="simulace4.html#cb701-55" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb701-56"><a href="simulace4.html#cb701-56" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type)</span>
<span id="cb701-57"><a href="simulace4.html#cb701-57" tabindex="-1"></a>      </span>
<span id="cb701-58"><a href="simulace4.html#cb701-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb701-59"><a href="simulace4.html#cb701-59" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb701-60"><a href="simulace4.html#cb701-60" tabindex="-1"></a>      accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb701-61"><a href="simulace4.html#cb701-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb701-62"><a href="simulace4.html#cb701-62" tabindex="-1"></a>      </span>
<span id="cb701-63"><a href="simulace4.html#cb701-63" tabindex="-1"></a>      <span class="co"># Store results</span></span>
<span id="cb701-64"><a href="simulace4.html#cb701-64" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb701-65"><a href="simulace4.html#cb701-65" tabindex="-1"></a>    }</span>
<span id="cb701-66"><a href="simulace4.html#cb701-66" tabindex="-1"></a>    <span class="co"># Store accuracies in positions for given d, gamma, and fold</span></span>
<span id="cb701-67"><a href="simulace4.html#cb701-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb701-68"><a href="simulace4.html#cb701-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb701-69"><a href="simulace4.html#cb701-69" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb701-70"><a href="simulace4.html#cb701-70" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb701-71"><a href="simulace4.html#cb701-71" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb701-72"><a href="simulace4.html#cb701-72" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb701-73"><a href="simulace4.html#cb701-73" tabindex="-1"></a>  }</span>
<span id="cb701-74"><a href="simulace4.html#cb701-74" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb702"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb702-1"><a href="simulace4.html#cb702-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb702-2"><a href="simulace4.html#cb702-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb702-3"><a href="simulace4.html#cb702-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb702-4"><a href="simulace4.html#cb702-4" tabindex="-1"></a>}</span>
<span id="cb702-5"><a href="simulace4.html#cb702-5" tabindex="-1"></a></span>
<span id="cb702-6"><a href="simulace4.html#cb702-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb702-7"><a href="simulace4.html#cb702-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb702-8"><a href="simulace4.html#cb702-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb702-9"><a href="simulace4.html#cb702-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb702-10"><a href="simulace4.html#cb702-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb702-11"><a href="simulace4.html#cb702-11" tabindex="-1"></a></span>
<span id="cb702-12"><a href="simulace4.html#cb702-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb702-13"><a href="simulace4.html#cb702-13" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb702-14"><a href="simulace4.html#cb702-14" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb702-15"><a href="simulace4.html#cb702-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb702-16"><a href="simulace4.html#cb702-16" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb702-17"><a href="simulace4.html#cb702-17" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-263">Table 5.13: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">14</td>
<td align="right">0.1509</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">16</td>
<td align="right">0.1642</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">36</td>
<td align="right">0.1510</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter value is <span class="math inline">\(d={}\)</span> 14 for the linear kernel with an error rate calculated using 10-fold CV of 0.1509, <span class="math inline">\(d={}\)</span> 16 for the polynomial kernel with an error rate of 0.1642, and <span class="math inline">\(d={}\)</span> 36 for the radial kernel with an error rate of 0.151.</p>
<p>Now that we have found the optimal hyperparameter values, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb703"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb703-1"><a href="simulace4.html#cb703-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb703-2"><a href="simulace4.html#cb703-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb703-3"><a href="simulace4.html#cb703-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb703-4"><a href="simulace4.html#cb703-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb704"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb704-1"><a href="simulace4.html#cb704-1" tabindex="-1"></a><span class="co"># Prepare a data frame to store the results</span></span>
<span id="cb704-2"><a href="simulace4.html#cb704-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb704-3"><a href="simulace4.html#cb704-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb704-4"><a href="simulace4.html#cb704-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb704-5"><a href="simulace4.html#cb704-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb704-6"><a href="simulace4.html#cb704-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb704-7"><a href="simulace4.html#cb704-7" tabindex="-1"></a></span>
<span id="cb704-8"><a href="simulace4.html#cb704-8" tabindex="-1"></a><span class="co"># Iterate over the individual kernels</span></span>
<span id="cb704-9"><a href="simulace4.html#cb704-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb704-10"><a href="simulace4.html#cb704-10" tabindex="-1"></a>  <span class="co"># Compute the K matrix</span></span>
<span id="cb704-11"><a href="simulace4.html#cb704-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb704-12"><a href="simulace4.html#cb704-12" tabindex="-1"></a>  </span>
<span id="cb704-13"><a href="simulace4.html#cb704-13" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb704-14"><a href="simulace4.html#cb704-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb704-15"><a href="simulace4.html#cb704-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb704-16"><a href="simulace4.html#cb704-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb704-17"><a href="simulace4.html#cb704-17" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb704-18"><a href="simulace4.html#cb704-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb704-19"><a href="simulace4.html#cb704-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb704-20"><a href="simulace4.html#cb704-20" tabindex="-1"></a>  </span>
<span id="cb704-21"><a href="simulace4.html#cb704-21" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb704-22"><a href="simulace4.html#cb704-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb704-23"><a href="simulace4.html#cb704-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb704-24"><a href="simulace4.html#cb704-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb704-25"><a href="simulace4.html#cb704-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb704-26"><a href="simulace4.html#cb704-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb704-27"><a href="simulace4.html#cb704-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb704-28"><a href="simulace4.html#cb704-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb704-29"><a href="simulace4.html#cb704-29" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb704-30"><a href="simulace4.html#cb704-30" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb704-31"><a href="simulace4.html#cb704-31" tabindex="-1"></a>  }</span>
<span id="cb704-32"><a href="simulace4.html#cb704-32" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb704-33"><a href="simulace4.html#cb704-33" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb704-34"><a href="simulace4.html#cb704-34" tabindex="-1"></a>  </span>
<span id="cb704-35"><a href="simulace4.html#cb704-35" tabindex="-1"></a>  <span class="co"># Determine lambda vector</span></span>
<span id="cb704-36"><a href="simulace4.html#cb704-36" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb704-37"><a href="simulace4.html#cb704-37" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb704-38"><a href="simulace4.html#cb704-38" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create empty object</span></span>
<span id="cb704-39"><a href="simulace4.html#cb704-39" tabindex="-1"></a>  </span>
<span id="cb704-40"><a href="simulace4.html#cb704-40" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb704-41"><a href="simulace4.html#cb704-41" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb704-42"><a href="simulace4.html#cb704-42" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb704-43"><a href="simulace4.html#cb704-43" tabindex="-1"></a>  }</span>
<span id="cb704-44"><a href="simulace4.html#cb704-44" tabindex="-1"></a>  </span>
<span id="cb704-45"><a href="simulace4.html#cb704-45" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb704-46"><a href="simulace4.html#cb704-46" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb704-47"><a href="simulace4.html#cb704-47" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb704-48"><a href="simulace4.html#cb704-48" tabindex="-1"></a></span>
<span id="cb704-49"><a href="simulace4.html#cb704-49" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb704-50"><a href="simulace4.html#cb704-50" tabindex="-1"></a></span>
<span id="cb704-51"><a href="simulace4.html#cb704-51" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb704-52"><a href="simulace4.html#cb704-52" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb704-53"><a href="simulace4.html#cb704-53" tabindex="-1"></a>  </span>
<span id="cb704-54"><a href="simulace4.html#cb704-54" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb704-55"><a href="simulace4.html#cb704-55" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb704-56"><a href="simulace4.html#cb704-56" tabindex="-1"></a>  </span>
<span id="cb704-57"><a href="simulace4.html#cb704-57" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb704-58"><a href="simulace4.html#cb704-58" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb704-59"><a href="simulace4.html#cb704-59" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb704-60"><a href="simulace4.html#cb704-60" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb704-61"><a href="simulace4.html#cb704-61" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb704-62"><a href="simulace4.html#cb704-62" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb704-63"><a href="simulace4.html#cb704-63" tabindex="-1"></a>  </span>
<span id="cb704-64"><a href="simulace4.html#cb704-64" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb704-65"><a href="simulace4.html#cb704-65" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb704-66"><a href="simulace4.html#cb704-66" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb704-67"><a href="simulace4.html#cb704-67" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb704-68"><a href="simulace4.html#cb704-68" tabindex="-1"></a>    </span>
<span id="cb704-69"><a href="simulace4.html#cb704-69" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb704-70"><a href="simulace4.html#cb704-70" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb704-71"><a href="simulace4.html#cb704-71" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb704-72"><a href="simulace4.html#cb704-72" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb704-73"><a href="simulace4.html#cb704-73" tabindex="-1"></a>  </span>
<span id="cb704-74"><a href="simulace4.html#cb704-74" tabindex="-1"></a>  <span class="co"># Store the results</span></span>
<span id="cb704-75"><a href="simulace4.html#cb704-75" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb704-76"><a href="simulace4.html#cb704-76" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-266">Table 5.14: </span>Summary of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.1214</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0571</td>
<td align="center">0.2167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0714</td>
<td align="center">0.1500</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 12.14 % for the linear kernel, 5.71 % for the polynomial kernel, and 7.14 % for the Gaussian kernel. For the test data, the error rate is 23.33 % for the linear kernel, 21.67 % for the polynomial kernel, and 15 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb705"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb705-1"><a href="simulace4.html#cb705-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="results-table-4" class="section level4 hasAnchor" number="5.2.3.8">
<h4><span class="header-section-number">5.2.3.8</span> Results Table<a href="simulace4.html#results-table-4" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-268">Table 5.15: </span>Summary of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.1500</td>
<td align="center">0.1500</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.1357</td>
<td align="center">0.1833</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.1429</td>
<td align="center">0.1500</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0429</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.1357</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">Tree - discr.</td>
<td align="center">0.0857</td>
<td align="center">0.1500</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.1643</td>
<td align="center">0.2833</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.1000</td>
<td align="center">0.1167</td>
</tr>
<tr class="odd">
<td align="left">RForest - discretization</td>
<td align="center">0.0071</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0286</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0071</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - func</td>
<td align="center">0.0786</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - func</td>
<td align="center">0.0714</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - func</td>
<td align="center">0.0571</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discr</td>
<td align="center">0.0929</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - discr</td>
<td align="center">0.0929</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - discr</td>
<td align="center">0.0643</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.1357</td>
<td align="center">0.1833</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.1286</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.1357</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0571</td>
<td align="center">0.0667</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0929</td>
<td align="center">0.0667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0143</td>
<td align="center">0.0833</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.0500</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.0286</td>
<td align="center">0.1167</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0500</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.1833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0000</td>
<td align="center">0.1500</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0214</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.1167</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.0929</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.1214</td>
<td align="center">0.2333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.0571</td>
<td align="center">0.2167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.0714</td>
<td align="center">0.1500</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simulation-study-4" class="section level3 hasAnchor" number="5.2.4">
<h3><span class="header-section-number">5.2.4</span> Simulation Study<a href="simulace4.html#simulation-study-4" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In the entire previous section, we dealt with only one randomly generated set of functions from two classification classes, which we subsequently divided randomly into test and training parts.<br />
Then we evaluated each classifier obtained by the considered methods based on the test and training error rates.</p>
<p>Since the generated data (and their division into two parts) may vary significantly with each repetition, the error rates of the individual classification algorithms will also vary considerably.<br />
Therefore, drawing any conclusions about the methods and comparing them with each other based on a single generated dataset can be very misleading.</p>
<p>For this reason, in this section, we will focus on repeating the entire previous procedure for different generated datasets.<br />
We will store the results in a table and, in the end, calculate the average model characteristics across the individual repetitions.<br />
To ensure our conclusions are sufficiently general, we will choose the number of repetitions <span class="math inline">\(n_{sim} = 100\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb706"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb706-1"><a href="simulace4.html#cb706-1" tabindex="-1"></a><span class="co"># Setting the pseudorandom number generator</span></span>
<span id="cb706-2"><a href="simulace4.html#cb706-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb706-3"><a href="simulace4.html#cb706-3" tabindex="-1"></a></span>
<span id="cb706-4"><a href="simulace4.html#cb706-4" tabindex="-1"></a><span class="co"># Number of simulations</span></span>
<span id="cb706-5"><a href="simulace4.html#cb706-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb706-6"><a href="simulace4.html#cb706-6" tabindex="-1"></a></span>
<span id="cb706-7"><a href="simulace4.html#cb706-7" tabindex="-1"></a><span class="do">## List to store error rates</span></span>
<span id="cb706-8"><a href="simulace4.html#cb706-8" tabindex="-1"></a><span class="co"># Columns represent methods</span></span>
<span id="cb706-9"><a href="simulace4.html#cb706-9" tabindex="-1"></a><span class="co"># Rows represent individual repetitions</span></span>
<span id="cb706-10"><a href="simulace4.html#cb706-10" tabindex="-1"></a><span class="co"># The list has two items ... train and test</span></span>
<span id="cb706-11"><a href="simulace4.html#cb706-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb706-12"><a href="simulace4.html#cb706-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb706-13"><a href="simulace4.html#cb706-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - func&#39;</span>, <span class="st">&#39;SVM poly - func&#39;</span>, <span class="st">&#39;SVM rbf - func&#39;</span>,</span>
<span id="cb706-14"><a href="simulace4.html#cb706-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb706-15"><a href="simulace4.html#cb706-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb706-16"><a href="simulace4.html#cb706-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb706-17"><a href="simulace4.html#cb706-17" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb706-18"><a href="simulace4.html#cb706-18" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb706-19"><a href="simulace4.html#cb706-19" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb706-20"><a href="simulace4.html#cb706-20" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb706-21"><a href="simulace4.html#cb706-21" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb706-22"><a href="simulace4.html#cb706-22" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb706-23"><a href="simulace4.html#cb706-23" tabindex="-1"></a></span>
<span id="cb706-24"><a href="simulace4.html#cb706-24" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb706-25"><a href="simulace4.html#cb706-25" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb706-26"><a href="simulace4.html#cb706-26" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb706-27"><a href="simulace4.html#cb706-27" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb706-28"><a href="simulace4.html#cb706-28" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb706-29"><a href="simulace4.html#cb706-29" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb706-30"><a href="simulace4.html#cb706-30" tabindex="-1"></a></span>
<span id="cb706-31"><a href="simulace4.html#cb706-31" tabindex="-1"></a><span class="co"># Object to store optimal hyperparameter values, determined by CV</span></span>
<span id="cb706-32"><a href="simulace4.html#cb706-32" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb706-33"><a href="simulace4.html#cb706-33" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb706-34"><a href="simulace4.html#cb706-34" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb706-35"><a href="simulace4.html#cb706-35" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb706-36"><a href="simulace4.html#cb706-36" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb706-37"><a href="simulace4.html#cb706-37" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb706-38"><a href="simulace4.html#cb706-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-39"><a href="simulace4.html#cb706-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-40"><a href="simulace4.html#cb706-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-41"><a href="simulace4.html#cb706-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-42"><a href="simulace4.html#cb706-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-43"><a href="simulace4.html#cb706-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-44"><a href="simulace4.html#cb706-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-45"><a href="simulace4.html#cb706-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-46"><a href="simulace4.html#cb706-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-47"><a href="simulace4.html#cb706-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-48"><a href="simulace4.html#cb706-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-49"><a href="simulace4.html#cb706-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-50"><a href="simulace4.html#cb706-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-51"><a href="simulace4.html#cb706-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb706-52"><a href="simulace4.html#cb706-52" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Now we will repeat the entire previous part 100 times, and we will store the error rate values in the list <code>SIMULACE</code>.<br />
In the data table <code>CV_RESULTS</code>, we will store the optimal hyperparameter values—specifically for the <span class="math inline">\(K\)</span>-nearest neighbors method and the SVM dimension <span class="math inline">\(d\)</span> in the case of projection onto a B-spline basis.<br />
We will also save all hyperparameter values for the SVM + RKHS method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb707"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb707-1"><a href="simulace4.html#cb707-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb707-2"><a href="simulace4.html#cb707-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb707-3"><a href="simulace4.html#cb707-3" tabindex="-1"></a></span>
<span id="cb707-4"><a href="simulace4.html#cb707-4" tabindex="-1"></a><span class="do">## SIMULACE</span></span>
<span id="cb707-5"><a href="simulace4.html#cb707-5" tabindex="-1"></a></span>
<span id="cb707-6"><a href="simulace4.html#cb707-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb707-7"><a href="simulace4.html#cb707-7" tabindex="-1"></a>  <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb707-8"><a href="simulace4.html#cb707-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb707-9"><a href="simulace4.html#cb707-9" tabindex="-1"></a>  <span class="co"># vektor casu ekvidistantni na intervalu [0, 6]</span></span>
<span id="cb707-10"><a href="simulace4.html#cb707-10" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb707-11"><a href="simulace4.html#cb707-11" tabindex="-1"></a>  </span>
<span id="cb707-12"><a href="simulace4.html#cb707-12" tabindex="-1"></a>  <span class="co"># pro Y = 0</span></span>
<span id="cb707-13"><a href="simulace4.html#cb707-13" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb707-14"><a href="simulace4.html#cb707-14" tabindex="-1"></a>  <span class="co"># pro Y = 1</span></span>
<span id="cb707-15"><a href="simulace4.html#cb707-15" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb707-16"><a href="simulace4.html#cb707-16" tabindex="-1"></a>  </span>
<span id="cb707-17"><a href="simulace4.html#cb707-17" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb707-18"><a href="simulace4.html#cb707-18" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb707-19"><a href="simulace4.html#cb707-19" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb707-20"><a href="simulace4.html#cb707-20" tabindex="-1"></a>  </span>
<span id="cb707-21"><a href="simulace4.html#cb707-21" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-22"><a href="simulace4.html#cb707-22" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb707-23"><a href="simulace4.html#cb707-23" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb707-24"><a href="simulace4.html#cb707-24" tabindex="-1"></a>  </span>
<span id="cb707-25"><a href="simulace4.html#cb707-25" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">4</span>) </span>
<span id="cb707-26"><a href="simulace4.html#cb707-26" tabindex="-1"></a>  <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb707-27"><a href="simulace4.html#cb707-27" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb707-28"><a href="simulace4.html#cb707-28" tabindex="-1"></a>  </span>
<span id="cb707-29"><a href="simulace4.html#cb707-29" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="fl">4.5</span>, <span class="at">to =</span> <span class="sc">-</span><span class="fl">1.5</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vektor lambd</span></span>
<span id="cb707-30"><a href="simulace4.html#cb707-30" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb707-31"><a href="simulace4.html#cb707-31" tabindex="-1"></a>  </span>
<span id="cb707-32"><a href="simulace4.html#cb707-32" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb707-33"><a href="simulace4.html#cb707-33" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb707-34"><a href="simulace4.html#cb707-34" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb707-35"><a href="simulace4.html#cb707-35" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb707-36"><a href="simulace4.html#cb707-36" tabindex="-1"></a>  }</span>
<span id="cb707-37"><a href="simulace4.html#cb707-37" tabindex="-1"></a>  </span>
<span id="cb707-38"><a href="simulace4.html#cb707-38" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb707-39"><a href="simulace4.html#cb707-39" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb707-40"><a href="simulace4.html#cb707-40" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb707-41"><a href="simulace4.html#cb707-41" tabindex="-1"></a>  )</span>
<span id="cb707-42"><a href="simulace4.html#cb707-42" tabindex="-1"></a>  </span>
<span id="cb707-43"><a href="simulace4.html#cb707-43" tabindex="-1"></a>  <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb707-44"><a href="simulace4.html#cb707-44" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb707-45"><a href="simulace4.html#cb707-45" tabindex="-1"></a>  </span>
<span id="cb707-46"><a href="simulace4.html#cb707-46" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb707-47"><a href="simulace4.html#cb707-47" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb707-48"><a href="simulace4.html#cb707-48" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb707-49"><a href="simulace4.html#cb707-49" tabindex="-1"></a>  </span>
<span id="cb707-50"><a href="simulace4.html#cb707-50" tabindex="-1"></a>  <span class="co"># vypocet derivace</span></span>
<span id="cb707-51"><a href="simulace4.html#cb707-51" tabindex="-1"></a>  XXder <span class="ot">&lt;-</span> <span class="fu">deriv.fd</span>(XXfd, <span class="dv">2</span>)</span>
<span id="cb707-52"><a href="simulace4.html#cb707-52" tabindex="-1"></a>  </span>
<span id="cb707-53"><a href="simulace4.html#cb707-53" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXder, <span class="at">evalarg =</span> t)</span>
<span id="cb707-54"><a href="simulace4.html#cb707-54" tabindex="-1"></a>  </span>
<span id="cb707-55"><a href="simulace4.html#cb707-55" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb707-56"><a href="simulace4.html#cb707-56" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXder<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb707-57"><a href="simulace4.html#cb707-57" tabindex="-1"></a>  </span>
<span id="cb707-58"><a href="simulace4.html#cb707-58" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb707-59"><a href="simulace4.html#cb707-59" tabindex="-1"></a>  </span>
<span id="cb707-60"><a href="simulace4.html#cb707-60" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-61"><a href="simulace4.html#cb707-61" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXder, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb707-62"><a href="simulace4.html#cb707-62" tabindex="-1"></a>  </span>
<span id="cb707-63"><a href="simulace4.html#cb707-63" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-64"><a href="simulace4.html#cb707-64" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb707-65"><a href="simulace4.html#cb707-65" tabindex="-1"></a>  </span>
<span id="cb707-66"><a href="simulace4.html#cb707-66" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb707-67"><a href="simulace4.html#cb707-67" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb707-68"><a href="simulace4.html#cb707-68" tabindex="-1"></a>  </span>
<span id="cb707-69"><a href="simulace4.html#cb707-69" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb707-70"><a href="simulace4.html#cb707-70" tabindex="-1"></a>  </span>
<span id="cb707-71"><a href="simulace4.html#cb707-71" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb707-72"><a href="simulace4.html#cb707-72" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">20</span> <span class="co">#c(1:(2 * ceiling(sqrt(length(y.train))))) # pocet sousedu </span></span>
<span id="cb707-73"><a href="simulace4.html#cb707-73" tabindex="-1"></a>  </span>
<span id="cb707-74"><a href="simulace4.html#cb707-74" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-75"><a href="simulace4.html#cb707-75" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-76"><a href="simulace4.html#cb707-76" tabindex="-1"></a>  </span>
<span id="cb707-77"><a href="simulace4.html#cb707-77" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb707-78"><a href="simulace4.html#cb707-78" tabindex="-1"></a>  </span>
<span id="cb707-79"><a href="simulace4.html#cb707-79" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-80"><a href="simulace4.html#cb707-80" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb707-81"><a href="simulace4.html#cb707-81" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb707-82"><a href="simulace4.html#cb707-82" tabindex="-1"></a>      </span>
<span id="cb707-83"><a href="simulace4.html#cb707-83" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-84"><a href="simulace4.html#cb707-84" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb707-85"><a href="simulace4.html#cb707-85" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-86"><a href="simulace4.html#cb707-86" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb707-87"><a href="simulace4.html#cb707-87" tabindex="-1"></a>    </span>
<span id="cb707-88"><a href="simulace4.html#cb707-88" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-89"><a href="simulace4.html#cb707-89" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb707-90"><a href="simulace4.html#cb707-90" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-91"><a href="simulace4.html#cb707-91" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb707-92"><a href="simulace4.html#cb707-92" tabindex="-1"></a>    </span>
<span id="cb707-93"><a href="simulace4.html#cb707-93" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb707-94"><a href="simulace4.html#cb707-94" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb707-95"><a href="simulace4.html#cb707-95" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb707-96"><a href="simulace4.html#cb707-96" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb707-97"><a href="simulace4.html#cb707-97" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb707-98"><a href="simulace4.html#cb707-98" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb707-99"><a href="simulace4.html#cb707-99" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb707-100"><a href="simulace4.html#cb707-100" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb707-101"><a href="simulace4.html#cb707-101" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb707-102"><a href="simulace4.html#cb707-102" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb707-103"><a href="simulace4.html#cb707-103" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb707-104"><a href="simulace4.html#cb707-104" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-105"><a href="simulace4.html#cb707-105" tabindex="-1"></a>      </span>
<span id="cb707-106"><a href="simulace4.html#cb707-106" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb707-107"><a href="simulace4.html#cb707-107" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb707-108"><a href="simulace4.html#cb707-108" tabindex="-1"></a>    }</span>
<span id="cb707-109"><a href="simulace4.html#cb707-109" tabindex="-1"></a>  }</span>
<span id="cb707-110"><a href="simulace4.html#cb707-110" tabindex="-1"></a>  </span>
<span id="cb707-111"><a href="simulace4.html#cb707-111" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb707-112"><a href="simulace4.html#cb707-112" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb707-113"><a href="simulace4.html#cb707-113" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb707-114"><a href="simulace4.html#cb707-114" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb707-115"><a href="simulace4.html#cb707-115" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb707-116"><a href="simulace4.html#cb707-116" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb707-117"><a href="simulace4.html#cb707-117" tabindex="-1"></a>  </span>
<span id="cb707-118"><a href="simulace4.html#cb707-118" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb707-119"><a href="simulace4.html#cb707-119" tabindex="-1"></a>  </span>
<span id="cb707-120"><a href="simulace4.html#cb707-120" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb707-121"><a href="simulace4.html#cb707-121" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb707-122"><a href="simulace4.html#cb707-122" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb707-123"><a href="simulace4.html#cb707-123" tabindex="-1"></a>  </span>
<span id="cb707-124"><a href="simulace4.html#cb707-124" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb707-125"><a href="simulace4.html#cb707-125" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb707-126"><a href="simulace4.html#cb707-126" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb707-127"><a href="simulace4.html#cb707-127" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb707-128"><a href="simulace4.html#cb707-128" tabindex="-1"></a>  </span>
<span id="cb707-129"><a href="simulace4.html#cb707-129" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb707-130"><a href="simulace4.html#cb707-130" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb707-131"><a href="simulace4.html#cb707-131" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb707-132"><a href="simulace4.html#cb707-132" tabindex="-1"></a>  </span>
<span id="cb707-133"><a href="simulace4.html#cb707-133" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb707-134"><a href="simulace4.html#cb707-134" tabindex="-1"></a>  </span>
<span id="cb707-135"><a href="simulace4.html#cb707-135" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb707-136"><a href="simulace4.html#cb707-136" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb707-137"><a href="simulace4.html#cb707-137" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb707-138"><a href="simulace4.html#cb707-138" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb707-139"><a href="simulace4.html#cb707-139" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb707-140"><a href="simulace4.html#cb707-140" tabindex="-1"></a>  </span>
<span id="cb707-141"><a href="simulace4.html#cb707-141" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb707-142"><a href="simulace4.html#cb707-142" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb707-143"><a href="simulace4.html#cb707-143" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb707-144"><a href="simulace4.html#cb707-144" tabindex="-1"></a>  </span>
<span id="cb707-145"><a href="simulace4.html#cb707-145" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb707-146"><a href="simulace4.html#cb707-146" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb707-147"><a href="simulace4.html#cb707-147" tabindex="-1"></a>  </span>
<span id="cb707-148"><a href="simulace4.html#cb707-148" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb707-149"><a href="simulace4.html#cb707-149" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb707-150"><a href="simulace4.html#cb707-150" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb707-151"><a href="simulace4.html#cb707-151" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb707-152"><a href="simulace4.html#cb707-152" tabindex="-1"></a>  }</span>
<span id="cb707-153"><a href="simulace4.html#cb707-153" tabindex="-1"></a>  </span>
<span id="cb707-154"><a href="simulace4.html#cb707-154" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb707-155"><a href="simulace4.html#cb707-155" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-156"><a href="simulace4.html#cb707-156" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb707-157"><a href="simulace4.html#cb707-157" tabindex="-1"></a>  </span>
<span id="cb707-158"><a href="simulace4.html#cb707-158" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb707-159"><a href="simulace4.html#cb707-159" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb707-160"><a href="simulace4.html#cb707-160" tabindex="-1"></a>  </span>
<span id="cb707-161"><a href="simulace4.html#cb707-161" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-162"><a href="simulace4.html#cb707-162" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-163"><a href="simulace4.html#cb707-163" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb707-164"><a href="simulace4.html#cb707-164" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-165"><a href="simulace4.html#cb707-165" tabindex="-1"></a>    </span>
<span id="cb707-166"><a href="simulace4.html#cb707-166" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-167"><a href="simulace4.html#cb707-167" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-168"><a href="simulace4.html#cb707-168" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb707-169"><a href="simulace4.html#cb707-169" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-170"><a href="simulace4.html#cb707-170" tabindex="-1"></a>  </span>
<span id="cb707-171"><a href="simulace4.html#cb707-171" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb707-172"><a href="simulace4.html#cb707-172" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-173"><a href="simulace4.html#cb707-173" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-174"><a href="simulace4.html#cb707-174" tabindex="-1"></a>  </span>
<span id="cb707-175"><a href="simulace4.html#cb707-175" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-176"><a href="simulace4.html#cb707-176" tabindex="-1"></a>  </span>
<span id="cb707-177"><a href="simulace4.html#cb707-177" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb707-178"><a href="simulace4.html#cb707-178" tabindex="-1"></a>  </span>
<span id="cb707-179"><a href="simulace4.html#cb707-179" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb707-180"><a href="simulace4.html#cb707-180" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb707-181"><a href="simulace4.html#cb707-181" tabindex="-1"></a>  </span>
<span id="cb707-182"><a href="simulace4.html#cb707-182" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-183"><a href="simulace4.html#cb707-183" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-184"><a href="simulace4.html#cb707-184" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb707-185"><a href="simulace4.html#cb707-185" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-186"><a href="simulace4.html#cb707-186" tabindex="-1"></a>    </span>
<span id="cb707-187"><a href="simulace4.html#cb707-187" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-188"><a href="simulace4.html#cb707-188" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-189"><a href="simulace4.html#cb707-189" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb707-190"><a href="simulace4.html#cb707-190" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-191"><a href="simulace4.html#cb707-191" tabindex="-1"></a>  </span>
<span id="cb707-192"><a href="simulace4.html#cb707-192" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb707-193"><a href="simulace4.html#cb707-193" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-194"><a href="simulace4.html#cb707-194" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-195"><a href="simulace4.html#cb707-195" tabindex="-1"></a>  </span>
<span id="cb707-196"><a href="simulace4.html#cb707-196" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-197"><a href="simulace4.html#cb707-197" tabindex="-1"></a>  </span>
<span id="cb707-198"><a href="simulace4.html#cb707-198" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb707-199"><a href="simulace4.html#cb707-199" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb707-200"><a href="simulace4.html#cb707-200" tabindex="-1"></a>  </span>
<span id="cb707-201"><a href="simulace4.html#cb707-201" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb707-202"><a href="simulace4.html#cb707-202" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb707-203"><a href="simulace4.html#cb707-203" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb707-204"><a href="simulace4.html#cb707-204" tabindex="-1"></a>  </span>
<span id="cb707-205"><a href="simulace4.html#cb707-205" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb707-206"><a href="simulace4.html#cb707-206" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb707-207"><a href="simulace4.html#cb707-207" tabindex="-1"></a>  </span>
<span id="cb707-208"><a href="simulace4.html#cb707-208" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb707-209"><a href="simulace4.html#cb707-209" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb707-210"><a href="simulace4.html#cb707-210" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb707-211"><a href="simulace4.html#cb707-211" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train$basis</span></span>
<span id="cb707-212"><a href="simulace4.html#cb707-212" tabindex="-1"></a>  nbasis.x <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb707-213"><a href="simulace4.html#cb707-213" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb707-214"><a href="simulace4.html#cb707-214" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">6</span></span>
<span id="cb707-215"><a href="simulace4.html#cb707-215" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-216"><a href="simulace4.html#cb707-216" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb707-217"><a href="simulace4.html#cb707-217" tabindex="-1"></a>                                 <span class="at">nbasis =</span> nbasis.x)</span>
<span id="cb707-218"><a href="simulace4.html#cb707-218" tabindex="-1"></a>  </span>
<span id="cb707-219"><a href="simulace4.html#cb707-219" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb707-220"><a href="simulace4.html#cb707-220" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">15</span></span>
<span id="cb707-221"><a href="simulace4.html#cb707-221" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb707-222"><a href="simulace4.html#cb707-222" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb707-223"><a href="simulace4.html#cb707-223" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-224"><a href="simulace4.html#cb707-224" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-225"><a href="simulace4.html#cb707-225" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb707-226"><a href="simulace4.html#cb707-226" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb707-227"><a href="simulace4.html#cb707-227" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb707-228"><a href="simulace4.html#cb707-228" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb707-229"><a href="simulace4.html#cb707-229" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train$basis</span></span>
<span id="cb707-230"><a href="simulace4.html#cb707-230" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-231"><a href="simulace4.html#cb707-231" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb707-232"><a href="simulace4.html#cb707-232" tabindex="-1"></a>                                 <span class="at">nbasis =</span> <span class="dv">50</span>)</span>
<span id="cb707-233"><a href="simulace4.html#cb707-233" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb707-234"><a href="simulace4.html#cb707-234" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb707-235"><a href="simulace4.html#cb707-235" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb707-236"><a href="simulace4.html#cb707-236" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb707-237"><a href="simulace4.html#cb707-237" tabindex="-1"></a>  </span>
<span id="cb707-238"><a href="simulace4.html#cb707-238" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb707-239"><a href="simulace4.html#cb707-239" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb707-240"><a href="simulace4.html#cb707-240" tabindex="-1"></a>  </span>
<span id="cb707-241"><a href="simulace4.html#cb707-241" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-242"><a href="simulace4.html#cb707-242" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb707-243"><a href="simulace4.html#cb707-243" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb707-244"><a href="simulace4.html#cb707-244" tabindex="-1"></a>      </span>
<span id="cb707-245"><a href="simulace4.html#cb707-245" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-246"><a href="simulace4.html#cb707-246" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb707-247"><a href="simulace4.html#cb707-247" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-248"><a href="simulace4.html#cb707-248" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb707-249"><a href="simulace4.html#cb707-249" tabindex="-1"></a>    </span>
<span id="cb707-250"><a href="simulace4.html#cb707-250" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-251"><a href="simulace4.html#cb707-251" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb707-252"><a href="simulace4.html#cb707-252" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb707-253"><a href="simulace4.html#cb707-253" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb707-254"><a href="simulace4.html#cb707-254" tabindex="-1"></a>    </span>
<span id="cb707-255"><a href="simulace4.html#cb707-255" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb707-256"><a href="simulace4.html#cb707-256" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb707-257"><a href="simulace4.html#cb707-257" tabindex="-1"></a>    </span>
<span id="cb707-258"><a href="simulace4.html#cb707-258" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb707-259"><a href="simulace4.html#cb707-259" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb707-260"><a href="simulace4.html#cb707-260" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb707-261"><a href="simulace4.html#cb707-261" tabindex="-1"></a>      </span>
<span id="cb707-262"><a href="simulace4.html#cb707-262" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb707-263"><a href="simulace4.html#cb707-263" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb707-264"><a href="simulace4.html#cb707-264" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb707-265"><a href="simulace4.html#cb707-265" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb707-266"><a href="simulace4.html#cb707-266" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb707-267"><a href="simulace4.html#cb707-267" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb707-268"><a href="simulace4.html#cb707-268" tabindex="-1"></a>      </span>
<span id="cb707-269"><a href="simulace4.html#cb707-269" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb707-270"><a href="simulace4.html#cb707-270" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb707-271"><a href="simulace4.html#cb707-271" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb707-272"><a href="simulace4.html#cb707-272" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb707-273"><a href="simulace4.html#cb707-273" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb707-274"><a href="simulace4.html#cb707-274" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-275"><a href="simulace4.html#cb707-275" tabindex="-1"></a>      </span>
<span id="cb707-276"><a href="simulace4.html#cb707-276" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb707-277"><a href="simulace4.html#cb707-277" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb707-278"><a href="simulace4.html#cb707-278" tabindex="-1"></a>    } </span>
<span id="cb707-279"><a href="simulace4.html#cb707-279" tabindex="-1"></a>  }</span>
<span id="cb707-280"><a href="simulace4.html#cb707-280" tabindex="-1"></a>  </span>
<span id="cb707-281"><a href="simulace4.html#cb707-281" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb707-282"><a href="simulace4.html#cb707-282" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb707-283"><a href="simulace4.html#cb707-283" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb707-284"><a href="simulace4.html#cb707-284" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb707-285"><a href="simulace4.html#cb707-285" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb707-286"><a href="simulace4.html#cb707-286" tabindex="-1"></a>  </span>
<span id="cb707-287"><a href="simulace4.html#cb707-287" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb707-288"><a href="simulace4.html#cb707-288" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb707-289"><a href="simulace4.html#cb707-289" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb707-290"><a href="simulace4.html#cb707-290" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb707-291"><a href="simulace4.html#cb707-291" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb707-292"><a href="simulace4.html#cb707-292" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb707-293"><a href="simulace4.html#cb707-293" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb707-294"><a href="simulace4.html#cb707-294" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb707-295"><a href="simulace4.html#cb707-295" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb707-296"><a href="simulace4.html#cb707-296" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb707-297"><a href="simulace4.html#cb707-297" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb707-298"><a href="simulace4.html#cb707-298" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb707-299"><a href="simulace4.html#cb707-299" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb707-300"><a href="simulace4.html#cb707-300" tabindex="-1"></a>  </span>
<span id="cb707-301"><a href="simulace4.html#cb707-301" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-302"><a href="simulace4.html#cb707-302" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb707-303"><a href="simulace4.html#cb707-303" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb707-304"><a href="simulace4.html#cb707-304" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb707-305"><a href="simulace4.html#cb707-305" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-306"><a href="simulace4.html#cb707-306" tabindex="-1"></a>    </span>
<span id="cb707-307"><a href="simulace4.html#cb707-307" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-308"><a href="simulace4.html#cb707-308" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb707-309"><a href="simulace4.html#cb707-309" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb707-310"><a href="simulace4.html#cb707-310" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb707-311"><a href="simulace4.html#cb707-311" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb707-312"><a href="simulace4.html#cb707-312" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-313"><a href="simulace4.html#cb707-313" tabindex="-1"></a>  </span>
<span id="cb707-314"><a href="simulace4.html#cb707-314" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb707-315"><a href="simulace4.html#cb707-315" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-316"><a href="simulace4.html#cb707-316" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-317"><a href="simulace4.html#cb707-317" tabindex="-1"></a>  </span>
<span id="cb707-318"><a href="simulace4.html#cb707-318" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-319"><a href="simulace4.html#cb707-319" tabindex="-1"></a>  </span>
<span id="cb707-320"><a href="simulace4.html#cb707-320" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb707-321"><a href="simulace4.html#cb707-321" tabindex="-1"></a>  </span>
<span id="cb707-322"><a href="simulace4.html#cb707-322" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb707-323"><a href="simulace4.html#cb707-323" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb707-324"><a href="simulace4.html#cb707-324" tabindex="-1"></a>  </span>
<span id="cb707-325"><a href="simulace4.html#cb707-325" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-326"><a href="simulace4.html#cb707-326" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb707-327"><a href="simulace4.html#cb707-327" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb707-328"><a href="simulace4.html#cb707-328" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-329"><a href="simulace4.html#cb707-329" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-330"><a href="simulace4.html#cb707-330" tabindex="-1"></a>    </span>
<span id="cb707-331"><a href="simulace4.html#cb707-331" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-332"><a href="simulace4.html#cb707-332" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb707-333"><a href="simulace4.html#cb707-333" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb707-334"><a href="simulace4.html#cb707-334" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-335"><a href="simulace4.html#cb707-335" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-336"><a href="simulace4.html#cb707-336" tabindex="-1"></a>  </span>
<span id="cb707-337"><a href="simulace4.html#cb707-337" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb707-338"><a href="simulace4.html#cb707-338" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-339"><a href="simulace4.html#cb707-339" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-340"><a href="simulace4.html#cb707-340" tabindex="-1"></a>  </span>
<span id="cb707-341"><a href="simulace4.html#cb707-341" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-342"><a href="simulace4.html#cb707-342" tabindex="-1"></a>  </span>
<span id="cb707-343"><a href="simulace4.html#cb707-343" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb707-344"><a href="simulace4.html#cb707-344" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb707-345"><a href="simulace4.html#cb707-345" tabindex="-1"></a>  </span>
<span id="cb707-346"><a href="simulace4.html#cb707-346" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb707-347"><a href="simulace4.html#cb707-347" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb707-348"><a href="simulace4.html#cb707-348" tabindex="-1"></a>     </span>
<span id="cb707-349"><a href="simulace4.html#cb707-349" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb707-350"><a href="simulace4.html#cb707-350" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb707-351"><a href="simulace4.html#cb707-351" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb707-352"><a href="simulace4.html#cb707-352" tabindex="-1"></a>  </span>
<span id="cb707-353"><a href="simulace4.html#cb707-353" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb707-354"><a href="simulace4.html#cb707-354" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb707-355"><a href="simulace4.html#cb707-355" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb707-356"><a href="simulace4.html#cb707-356" tabindex="-1"></a>  </span>
<span id="cb707-357"><a href="simulace4.html#cb707-357" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-358"><a href="simulace4.html#cb707-358" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb707-359"><a href="simulace4.html#cb707-359" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb707-360"><a href="simulace4.html#cb707-360" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb707-361"><a href="simulace4.html#cb707-361" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb707-362"><a href="simulace4.html#cb707-362" tabindex="-1"></a>  </span>
<span id="cb707-363"><a href="simulace4.html#cb707-363" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-364"><a href="simulace4.html#cb707-364" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb707-365"><a href="simulace4.html#cb707-365" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-366"><a href="simulace4.html#cb707-366" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-367"><a href="simulace4.html#cb707-367" tabindex="-1"></a>    </span>
<span id="cb707-368"><a href="simulace4.html#cb707-368" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-369"><a href="simulace4.html#cb707-369" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb707-370"><a href="simulace4.html#cb707-370" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-371"><a href="simulace4.html#cb707-371" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-372"><a href="simulace4.html#cb707-372" tabindex="-1"></a>  </span>
<span id="cb707-373"><a href="simulace4.html#cb707-373" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb707-374"><a href="simulace4.html#cb707-374" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-375"><a href="simulace4.html#cb707-375" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-376"><a href="simulace4.html#cb707-376" tabindex="-1"></a>  </span>
<span id="cb707-377"><a href="simulace4.html#cb707-377" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-378"><a href="simulace4.html#cb707-378" tabindex="-1"></a>  </span>
<span id="cb707-379"><a href="simulace4.html#cb707-379" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb707-380"><a href="simulace4.html#cb707-380" tabindex="-1"></a>  </span>
<span id="cb707-381"><a href="simulace4.html#cb707-381" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-382"><a href="simulace4.html#cb707-382" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb707-383"><a href="simulace4.html#cb707-383" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb707-384"><a href="simulace4.html#cb707-384" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb707-385"><a href="simulace4.html#cb707-385" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb707-386"><a href="simulace4.html#cb707-386" tabindex="-1"></a>  </span>
<span id="cb707-387"><a href="simulace4.html#cb707-387" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-388"><a href="simulace4.html#cb707-388" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-389"><a href="simulace4.html#cb707-389" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-390"><a href="simulace4.html#cb707-390" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-391"><a href="simulace4.html#cb707-391" tabindex="-1"></a>    </span>
<span id="cb707-392"><a href="simulace4.html#cb707-392" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-393"><a href="simulace4.html#cb707-393" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-394"><a href="simulace4.html#cb707-394" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-395"><a href="simulace4.html#cb707-395" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-396"><a href="simulace4.html#cb707-396" tabindex="-1"></a>  </span>
<span id="cb707-397"><a href="simulace4.html#cb707-397" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb707-398"><a href="simulace4.html#cb707-398" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-399"><a href="simulace4.html#cb707-399" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-400"><a href="simulace4.html#cb707-400" tabindex="-1"></a>  </span>
<span id="cb707-401"><a href="simulace4.html#cb707-401" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-402"><a href="simulace4.html#cb707-402" tabindex="-1"></a>  </span>
<span id="cb707-403"><a href="simulace4.html#cb707-403" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb707-404"><a href="simulace4.html#cb707-404" tabindex="-1"></a>  </span>
<span id="cb707-405"><a href="simulace4.html#cb707-405" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb707-406"><a href="simulace4.html#cb707-406" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb707-407"><a href="simulace4.html#cb707-407" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb707-408"><a href="simulace4.html#cb707-408" tabindex="-1"></a>  </span>
<span id="cb707-409"><a href="simulace4.html#cb707-409" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb707-410"><a href="simulace4.html#cb707-410" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb707-411"><a href="simulace4.html#cb707-411" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-412"><a href="simulace4.html#cb707-412" tabindex="-1"></a>  </span>
<span id="cb707-413"><a href="simulace4.html#cb707-413" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-414"><a href="simulace4.html#cb707-414" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb707-415"><a href="simulace4.html#cb707-415" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb707-416"><a href="simulace4.html#cb707-416" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb707-417"><a href="simulace4.html#cb707-417" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb707-418"><a href="simulace4.html#cb707-418" tabindex="-1"></a>  </span>
<span id="cb707-419"><a href="simulace4.html#cb707-419" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-420"><a href="simulace4.html#cb707-420" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb707-421"><a href="simulace4.html#cb707-421" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-422"><a href="simulace4.html#cb707-422" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-423"><a href="simulace4.html#cb707-423" tabindex="-1"></a>    </span>
<span id="cb707-424"><a href="simulace4.html#cb707-424" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-425"><a href="simulace4.html#cb707-425" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb707-426"><a href="simulace4.html#cb707-426" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-427"><a href="simulace4.html#cb707-427" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-428"><a href="simulace4.html#cb707-428" tabindex="-1"></a>  </span>
<span id="cb707-429"><a href="simulace4.html#cb707-429" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb707-430"><a href="simulace4.html#cb707-430" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-431"><a href="simulace4.html#cb707-431" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-432"><a href="simulace4.html#cb707-432" tabindex="-1"></a>  </span>
<span id="cb707-433"><a href="simulace4.html#cb707-433" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-434"><a href="simulace4.html#cb707-434" tabindex="-1"></a>  </span>
<span id="cb707-435"><a href="simulace4.html#cb707-435" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb707-436"><a href="simulace4.html#cb707-436" tabindex="-1"></a>  </span>
<span id="cb707-437"><a href="simulace4.html#cb707-437" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb707-438"><a href="simulace4.html#cb707-438" tabindex="-1"></a>  </span>
<span id="cb707-439"><a href="simulace4.html#cb707-439" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-440"><a href="simulace4.html#cb707-440" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb707-441"><a href="simulace4.html#cb707-441" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb707-442"><a href="simulace4.html#cb707-442" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-443"><a href="simulace4.html#cb707-443" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb707-444"><a href="simulace4.html#cb707-444" tabindex="-1"></a>  </span>
<span id="cb707-445"><a href="simulace4.html#cb707-445" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-446"><a href="simulace4.html#cb707-446" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb707-447"><a href="simulace4.html#cb707-447" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-448"><a href="simulace4.html#cb707-448" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-449"><a href="simulace4.html#cb707-449" tabindex="-1"></a>    </span>
<span id="cb707-450"><a href="simulace4.html#cb707-450" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-451"><a href="simulace4.html#cb707-451" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb707-452"><a href="simulace4.html#cb707-452" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-453"><a href="simulace4.html#cb707-453" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-454"><a href="simulace4.html#cb707-454" tabindex="-1"></a>  </span>
<span id="cb707-455"><a href="simulace4.html#cb707-455" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb707-456"><a href="simulace4.html#cb707-456" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-457"><a href="simulace4.html#cb707-457" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-458"><a href="simulace4.html#cb707-458" tabindex="-1"></a>  </span>
<span id="cb707-459"><a href="simulace4.html#cb707-459" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-460"><a href="simulace4.html#cb707-460" tabindex="-1"></a>  </span>
<span id="cb707-461"><a href="simulace4.html#cb707-461" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb707-462"><a href="simulace4.html#cb707-462" tabindex="-1"></a>  </span>
<span id="cb707-463"><a href="simulace4.html#cb707-463" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-464"><a href="simulace4.html#cb707-464" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb707-465"><a href="simulace4.html#cb707-465" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb707-466"><a href="simulace4.html#cb707-466" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-467"><a href="simulace4.html#cb707-467" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb707-468"><a href="simulace4.html#cb707-468" tabindex="-1"></a>  </span>
<span id="cb707-469"><a href="simulace4.html#cb707-469" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-470"><a href="simulace4.html#cb707-470" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-471"><a href="simulace4.html#cb707-471" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-472"><a href="simulace4.html#cb707-472" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-473"><a href="simulace4.html#cb707-473" tabindex="-1"></a>    </span>
<span id="cb707-474"><a href="simulace4.html#cb707-474" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-475"><a href="simulace4.html#cb707-475" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-476"><a href="simulace4.html#cb707-476" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-477"><a href="simulace4.html#cb707-477" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-478"><a href="simulace4.html#cb707-478" tabindex="-1"></a>  </span>
<span id="cb707-479"><a href="simulace4.html#cb707-479" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb707-480"><a href="simulace4.html#cb707-480" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-481"><a href="simulace4.html#cb707-481" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-482"><a href="simulace4.html#cb707-482" tabindex="-1"></a>  </span>
<span id="cb707-483"><a href="simulace4.html#cb707-483" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-484"><a href="simulace4.html#cb707-484" tabindex="-1"></a>  </span>
<span id="cb707-485"><a href="simulace4.html#cb707-485" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb707-486"><a href="simulace4.html#cb707-486" tabindex="-1"></a>  </span>
<span id="cb707-487"><a href="simulace4.html#cb707-487" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-488"><a href="simulace4.html#cb707-488" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb707-489"><a href="simulace4.html#cb707-489" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb707-490"><a href="simulace4.html#cb707-490" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-491"><a href="simulace4.html#cb707-491" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb707-492"><a href="simulace4.html#cb707-492" tabindex="-1"></a>  </span>
<span id="cb707-493"><a href="simulace4.html#cb707-493" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-494"><a href="simulace4.html#cb707-494" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb707-495"><a href="simulace4.html#cb707-495" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-496"><a href="simulace4.html#cb707-496" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-497"><a href="simulace4.html#cb707-497" tabindex="-1"></a>    </span>
<span id="cb707-498"><a href="simulace4.html#cb707-498" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-499"><a href="simulace4.html#cb707-499" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb707-500"><a href="simulace4.html#cb707-500" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-501"><a href="simulace4.html#cb707-501" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-502"><a href="simulace4.html#cb707-502" tabindex="-1"></a>  </span>
<span id="cb707-503"><a href="simulace4.html#cb707-503" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb707-504"><a href="simulace4.html#cb707-504" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb707-505"><a href="simulace4.html#cb707-505" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb707-506"><a href="simulace4.html#cb707-506" tabindex="-1"></a>  </span>
<span id="cb707-507"><a href="simulace4.html#cb707-507" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-508"><a href="simulace4.html#cb707-508" tabindex="-1"></a>  </span>
<span id="cb707-509"><a href="simulace4.html#cb707-509" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb707-510"><a href="simulace4.html#cb707-510" tabindex="-1"></a>  </span>
<span id="cb707-511"><a href="simulace4.html#cb707-511" tabindex="-1"></a>  <span class="co"># normovani dat</span></span>
<span id="cb707-512"><a href="simulace4.html#cb707-512" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb707-513"><a href="simulace4.html#cb707-513" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb707-514"><a href="simulace4.html#cb707-514" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXder[i])))</span>
<span id="cb707-515"><a href="simulace4.html#cb707-515" tabindex="-1"></a>    }</span>
<span id="cb707-516"><a href="simulace4.html#cb707-516" tabindex="-1"></a>  XXfd_norm <span class="ot">&lt;-</span> XXder</span>
<span id="cb707-517"><a href="simulace4.html#cb707-517" tabindex="-1"></a>  XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb707-518"><a href="simulace4.html#cb707-518" tabindex="-1"></a>                                              <span class="at">ncol =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb707-519"><a href="simulace4.html#cb707-519" tabindex="-1"></a>                                              <span class="at">nrow =</span> <span class="fu">dim</span>(XXder<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb707-520"><a href="simulace4.html#cb707-520" tabindex="-1"></a>                                              <span class="at">byrow =</span> T)</span>
<span id="cb707-521"><a href="simulace4.html#cb707-521" tabindex="-1"></a>  </span>
<span id="cb707-522"><a href="simulace4.html#cb707-522" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb707-523"><a href="simulace4.html#cb707-523" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-524"><a href="simulace4.html#cb707-524" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb707-525"><a href="simulace4.html#cb707-525" tabindex="-1"></a>  </span>
<span id="cb707-526"><a href="simulace4.html#cb707-526" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-527"><a href="simulace4.html#cb707-527" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb707-528"><a href="simulace4.html#cb707-528" tabindex="-1"></a>  </span>
<span id="cb707-529"><a href="simulace4.html#cb707-529" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb707-530"><a href="simulace4.html#cb707-530" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb707-531"><a href="simulace4.html#cb707-531" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb707-532"><a href="simulace4.html#cb707-532" tabindex="-1"></a>  </span>
<span id="cb707-533"><a href="simulace4.html#cb707-533" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb707-534"><a href="simulace4.html#cb707-534" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb707-535"><a href="simulace4.html#cb707-535" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb707-536"><a href="simulace4.html#cb707-536" tabindex="-1"></a>  </span>
<span id="cb707-537"><a href="simulace4.html#cb707-537" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb707-538"><a href="simulace4.html#cb707-538" tabindex="-1"></a>  </span>
<span id="cb707-539"><a href="simulace4.html#cb707-539" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-540"><a href="simulace4.html#cb707-540" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-541"><a href="simulace4.html#cb707-541" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb707-542"><a href="simulace4.html#cb707-542" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb707-543"><a href="simulace4.html#cb707-543" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-544"><a href="simulace4.html#cb707-544" tabindex="-1"></a>  }</span>
<span id="cb707-545"><a href="simulace4.html#cb707-545" tabindex="-1"></a>  </span>
<span id="cb707-546"><a href="simulace4.html#cb707-546" tabindex="-1"></a>  <span class="do">### 7.0) SVM for functional data</span></span>
<span id="cb707-547"><a href="simulace4.html#cb707-547" tabindex="-1"></a>  </span>
<span id="cb707-548"><a href="simulace4.html#cb707-548" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb707-549"><a href="simulace4.html#cb707-549" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-550"><a href="simulace4.html#cb707-550" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-551"><a href="simulace4.html#cb707-551" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb707-552"><a href="simulace4.html#cb707-552" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb707-553"><a href="simulace4.html#cb707-553" tabindex="-1"></a>  </span>
<span id="cb707-554"><a href="simulace4.html#cb707-554" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-555"><a href="simulace4.html#cb707-555" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-556"><a href="simulace4.html#cb707-556" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-557"><a href="simulace4.html#cb707-557" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb707-558"><a href="simulace4.html#cb707-558" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-559"><a href="simulace4.html#cb707-559" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb707-560"><a href="simulace4.html#cb707-560" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb707-561"><a href="simulace4.html#cb707-561" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb707-562"><a href="simulace4.html#cb707-562" tabindex="-1"></a>  )</span>
<span id="cb707-563"><a href="simulace4.html#cb707-563" tabindex="-1"></a>  </span>
<span id="cb707-564"><a href="simulace4.html#cb707-564" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb707-565"><a href="simulace4.html#cb707-565" tabindex="-1"></a>  <span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb707-566"><a href="simulace4.html#cb707-566" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb707-567"><a href="simulace4.html#cb707-567" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-568"><a href="simulace4.html#cb707-568" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-569"><a href="simulace4.html#cb707-569" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-570"><a href="simulace4.html#cb707-570" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb707-571"><a href="simulace4.html#cb707-571" tabindex="-1"></a>      </span>
<span id="cb707-572"><a href="simulace4.html#cb707-572" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb707-573"><a href="simulace4.html#cb707-573" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb707-574"><a href="simulace4.html#cb707-574" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb707-575"><a href="simulace4.html#cb707-575" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb707-576"><a href="simulace4.html#cb707-576" tabindex="-1"></a>      </span>
<span id="cb707-577"><a href="simulace4.html#cb707-577" tabindex="-1"></a>      <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb707-578"><a href="simulace4.html#cb707-578" tabindex="-1"></a>      tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb707-579"><a href="simulace4.html#cb707-579" tabindex="-1"></a>      </span>
<span id="cb707-580"><a href="simulace4.html#cb707-580" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb707-581"><a href="simulace4.html#cb707-581" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb707-582"><a href="simulace4.html#cb707-582" tabindex="-1"></a>      <span class="co"># B-spline baze </span></span>
<span id="cb707-583"><a href="simulace4.html#cb707-583" tabindex="-1"></a>      <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb707-584"><a href="simulace4.html#cb707-584" tabindex="-1"></a>      nbasis.x <span class="ot">&lt;-</span> <span class="dv">20</span></span>
<span id="cb707-585"><a href="simulace4.html#cb707-585" tabindex="-1"></a>      basis1 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-586"><a href="simulace4.html#cb707-586" tabindex="-1"></a>                                     <span class="at">norder =</span> norder, </span>
<span id="cb707-587"><a href="simulace4.html#cb707-587" tabindex="-1"></a>                                     <span class="at">nbasis =</span> <span class="dv">50</span>)</span>
<span id="cb707-588"><a href="simulace4.html#cb707-588" tabindex="-1"></a>      <span class="co"># formula</span></span>
<span id="cb707-589"><a href="simulace4.html#cb707-589" tabindex="-1"></a>      f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb707-590"><a href="simulace4.html#cb707-590" tabindex="-1"></a>      <span class="co"># baze pro x</span></span>
<span id="cb707-591"><a href="simulace4.html#cb707-591" tabindex="-1"></a>      basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb707-592"><a href="simulace4.html#cb707-592" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb707-593"><a href="simulace4.html#cb707-593" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb707-594"><a href="simulace4.html#cb707-594" tabindex="-1"></a>      </span>
<span id="cb707-595"><a href="simulace4.html#cb707-595" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb707-596"><a href="simulace4.html#cb707-596" tabindex="-1"></a>      <span class="co"># model SVM</span></span>
<span id="cb707-597"><a href="simulace4.html#cb707-597" tabindex="-1"></a>      clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-598"><a href="simulace4.html#cb707-598" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb707-599"><a href="simulace4.html#cb707-599" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-600"><a href="simulace4.html#cb707-600" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb707-601"><a href="simulace4.html#cb707-601" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb707-602"><a href="simulace4.html#cb707-602" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-603"><a href="simulace4.html#cb707-603" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-604"><a href="simulace4.html#cb707-604" tabindex="-1"></a>        </span>
<span id="cb707-605"><a href="simulace4.html#cb707-605" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-606"><a href="simulace4.html#cb707-606" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb707-607"><a href="simulace4.html#cb707-607" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-608"><a href="simulace4.html#cb707-608" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb707-609"><a href="simulace4.html#cb707-609" tabindex="-1"></a>      </span>
<span id="cb707-610"><a href="simulace4.html#cb707-610" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb707-611"><a href="simulace4.html#cb707-611" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb707-612"><a href="simulace4.html#cb707-612" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb707-613"><a href="simulace4.html#cb707-613" tabindex="-1"></a>      </span>
<span id="cb707-614"><a href="simulace4.html#cb707-614" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb707-615"><a href="simulace4.html#cb707-615" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb707-616"><a href="simulace4.html#cb707-616" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-617"><a href="simulace4.html#cb707-617" tabindex="-1"></a>        clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-618"><a href="simulace4.html#cb707-618" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb707-619"><a href="simulace4.html#cb707-619" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-620"><a href="simulace4.html#cb707-620" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb707-621"><a href="simulace4.html#cb707-621" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb707-622"><a href="simulace4.html#cb707-622" tabindex="-1"></a>                  <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-623"><a href="simulace4.html#cb707-623" tabindex="-1"></a>                  <span class="at">degree =</span> p,</span>
<span id="cb707-624"><a href="simulace4.html#cb707-624" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-625"><a href="simulace4.html#cb707-625" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-626"><a href="simulace4.html#cb707-626" tabindex="-1"></a>          </span>
<span id="cb707-627"><a href="simulace4.html#cb707-627" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-628"><a href="simulace4.html#cb707-628" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb707-629"><a href="simulace4.html#cb707-629" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-630"><a href="simulace4.html#cb707-630" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb707-631"><a href="simulace4.html#cb707-631" tabindex="-1"></a>        </span>
<span id="cb707-632"><a href="simulace4.html#cb707-632" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb707-633"><a href="simulace4.html#cb707-633" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb707-634"><a href="simulace4.html#cb707-634" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb707-635"><a href="simulace4.html#cb707-635" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb707-636"><a href="simulace4.html#cb707-636" tabindex="-1"></a>      }</span>
<span id="cb707-637"><a href="simulace4.html#cb707-637" tabindex="-1"></a>          </span>
<span id="cb707-638"><a href="simulace4.html#cb707-638" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb707-639"><a href="simulace4.html#cb707-639" tabindex="-1"></a>      <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb707-640"><a href="simulace4.html#cb707-640" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-641"><a href="simulace4.html#cb707-641" tabindex="-1"></a>        clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-642"><a href="simulace4.html#cb707-642" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb707-643"><a href="simulace4.html#cb707-643" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-644"><a href="simulace4.html#cb707-644" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb707-645"><a href="simulace4.html#cb707-645" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb707-646"><a href="simulace4.html#cb707-646" tabindex="-1"></a>                  <span class="at">gamma =</span> gam.cv,</span>
<span id="cb707-647"><a href="simulace4.html#cb707-647" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-648"><a href="simulace4.html#cb707-648" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb707-649"><a href="simulace4.html#cb707-649" tabindex="-1"></a>          </span>
<span id="cb707-650"><a href="simulace4.html#cb707-650" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-651"><a href="simulace4.html#cb707-651" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb707-652"><a href="simulace4.html#cb707-652" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-653"><a href="simulace4.html#cb707-653" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb707-654"><a href="simulace4.html#cb707-654" tabindex="-1"></a>        </span>
<span id="cb707-655"><a href="simulace4.html#cb707-655" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb707-656"><a href="simulace4.html#cb707-656" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb707-657"><a href="simulace4.html#cb707-657" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb707-658"><a href="simulace4.html#cb707-658" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb707-659"><a href="simulace4.html#cb707-659" tabindex="-1"></a>      }</span>
<span id="cb707-660"><a href="simulace4.html#cb707-660" tabindex="-1"></a>    }</span>
<span id="cb707-661"><a href="simulace4.html#cb707-661" tabindex="-1"></a>  }</span>
<span id="cb707-662"><a href="simulace4.html#cb707-662" tabindex="-1"></a>  </span>
<span id="cb707-663"><a href="simulace4.html#cb707-663" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb707-664"><a href="simulace4.html#cb707-664" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb707-665"><a href="simulace4.html#cb707-665" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb707-666"><a href="simulace4.html#cb707-666" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb707-667"><a href="simulace4.html#cb707-667" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-668"><a href="simulace4.html#cb707-668" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb707-669"><a href="simulace4.html#cb707-669" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-670"><a href="simulace4.html#cb707-670" tabindex="-1"></a>  </span>
<span id="cb707-671"><a href="simulace4.html#cb707-671" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-672"><a href="simulace4.html#cb707-672" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb707-673"><a href="simulace4.html#cb707-673" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb707-674"><a href="simulace4.html#cb707-674" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb707-675"><a href="simulace4.html#cb707-675" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb707-676"><a href="simulace4.html#cb707-676" tabindex="-1"></a>  </span>
<span id="cb707-677"><a href="simulace4.html#cb707-677" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-678"><a href="simulace4.html#cb707-678" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-679"><a href="simulace4.html#cb707-679" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb707-680"><a href="simulace4.html#cb707-680" tabindex="-1"></a>  </span>
<span id="cb707-681"><a href="simulace4.html#cb707-681" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-682"><a href="simulace4.html#cb707-682" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-683"><a href="simulace4.html#cb707-683" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb707-684"><a href="simulace4.html#cb707-684" tabindex="-1"></a>  </span>
<span id="cb707-685"><a href="simulace4.html#cb707-685" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-686"><a href="simulace4.html#cb707-686" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-687"><a href="simulace4.html#cb707-687" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-688"><a href="simulace4.html#cb707-688" tabindex="-1"></a>  </span>
<span id="cb707-689"><a href="simulace4.html#cb707-689" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb707-690"><a href="simulace4.html#cb707-690" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb707-691"><a href="simulace4.html#cb707-691" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb707-692"><a href="simulace4.html#cb707-692" tabindex="-1"></a>  </span>
<span id="cb707-693"><a href="simulace4.html#cb707-693" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb707-694"><a href="simulace4.html#cb707-694" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb707-695"><a href="simulace4.html#cb707-695" tabindex="-1"></a>  </span>
<span id="cb707-696"><a href="simulace4.html#cb707-696" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb707-697"><a href="simulace4.html#cb707-697" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb707-698"><a href="simulace4.html#cb707-698" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb707-699"><a href="simulace4.html#cb707-699" tabindex="-1"></a>  <span class="co"># basis1 &lt;- X.train_norm$basis</span></span>
<span id="cb707-700"><a href="simulace4.html#cb707-700" tabindex="-1"></a>  </span>
<span id="cb707-701"><a href="simulace4.html#cb707-701" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb707-702"><a href="simulace4.html#cb707-702" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb707-703"><a href="simulace4.html#cb707-703" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb707-704"><a href="simulace4.html#cb707-704" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb707-705"><a href="simulace4.html#cb707-705" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb707-706"><a href="simulace4.html#cb707-706" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb707-707"><a href="simulace4.html#cb707-707" tabindex="-1"></a>  </span>
<span id="cb707-708"><a href="simulace4.html#cb707-708" tabindex="-1"></a>  model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-709"><a href="simulace4.html#cb707-709" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb707-710"><a href="simulace4.html#cb707-710" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-711"><a href="simulace4.html#cb707-711" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb707-712"><a href="simulace4.html#cb707-712" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-713"><a href="simulace4.html#cb707-713" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-714"><a href="simulace4.html#cb707-714" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb707-715"><a href="simulace4.html#cb707-715" tabindex="-1"></a>  </span>
<span id="cb707-716"><a href="simulace4.html#cb707-716" tabindex="-1"></a>  model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-717"><a href="simulace4.html#cb707-717" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb707-718"><a href="simulace4.html#cb707-718" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-719"><a href="simulace4.html#cb707-719" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb707-720"><a href="simulace4.html#cb707-720" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-721"><a href="simulace4.html#cb707-721" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-722"><a href="simulace4.html#cb707-722" tabindex="-1"></a>              <span class="at">degree =</span> p.opt,</span>
<span id="cb707-723"><a href="simulace4.html#cb707-723" tabindex="-1"></a>              <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-724"><a href="simulace4.html#cb707-724" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb707-725"><a href="simulace4.html#cb707-725" tabindex="-1"></a>  </span>
<span id="cb707-726"><a href="simulace4.html#cb707-726" tabindex="-1"></a>  model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb707-727"><a href="simulace4.html#cb707-727" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb707-728"><a href="simulace4.html#cb707-728" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb707-729"><a href="simulace4.html#cb707-729" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb707-730"><a href="simulace4.html#cb707-730" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-731"><a href="simulace4.html#cb707-731" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-732"><a href="simulace4.html#cb707-732" tabindex="-1"></a>              <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb707-733"><a href="simulace4.html#cb707-733" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb707-734"><a href="simulace4.html#cb707-734" tabindex="-1"></a>  </span>
<span id="cb707-735"><a href="simulace4.html#cb707-735" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-736"><a href="simulace4.html#cb707-736" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb707-737"><a href="simulace4.html#cb707-737" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-738"><a href="simulace4.html#cb707-738" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb707-739"><a href="simulace4.html#cb707-739" tabindex="-1"></a>  </span>
<span id="cb707-740"><a href="simulace4.html#cb707-740" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-741"><a href="simulace4.html#cb707-741" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb707-742"><a href="simulace4.html#cb707-742" tabindex="-1"></a>  </span>
<span id="cb707-743"><a href="simulace4.html#cb707-743" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-744"><a href="simulace4.html#cb707-744" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb707-745"><a href="simulace4.html#cb707-745" tabindex="-1"></a>    </span>
<span id="cb707-746"><a href="simulace4.html#cb707-746" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-747"><a href="simulace4.html#cb707-747" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb707-748"><a href="simulace4.html#cb707-748" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-749"><a href="simulace4.html#cb707-749" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb707-750"><a href="simulace4.html#cb707-750" tabindex="-1"></a>  </span>
<span id="cb707-751"><a href="simulace4.html#cb707-751" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-752"><a href="simulace4.html#cb707-752" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb707-753"><a href="simulace4.html#cb707-753" tabindex="-1"></a>  </span>
<span id="cb707-754"><a href="simulace4.html#cb707-754" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb707-755"><a href="simulace4.html#cb707-755" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span>
<span id="cb707-756"><a href="simulace4.html#cb707-756" tabindex="-1"></a>  </span>
<span id="cb707-757"><a href="simulace4.html#cb707-757" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb707-758"><a href="simulace4.html#cb707-758" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb707-759"><a href="simulace4.html#cb707-759" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb707-760"><a href="simulace4.html#cb707-760" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb707-761"><a href="simulace4.html#cb707-761" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb707-762"><a href="simulace4.html#cb707-762" tabindex="-1"></a>  </span>
<span id="cb707-763"><a href="simulace4.html#cb707-763" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-764"><a href="simulace4.html#cb707-764" tabindex="-1"></a>  </span>
<span id="cb707-765"><a href="simulace4.html#cb707-765" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb707-766"><a href="simulace4.html#cb707-766" tabindex="-1"></a>  </span>
<span id="cb707-767"><a href="simulace4.html#cb707-767" tabindex="-1"></a>  <span class="co"># ktere hodnoty chceme uvazovat</span></span>
<span id="cb707-768"><a href="simulace4.html#cb707-768" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-769"><a href="simulace4.html#cb707-769" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb707-770"><a href="simulace4.html#cb707-770" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb707-771"><a href="simulace4.html#cb707-771" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb707-772"><a href="simulace4.html#cb707-772" tabindex="-1"></a>  </span>
<span id="cb707-773"><a href="simulace4.html#cb707-773" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-774"><a href="simulace4.html#cb707-774" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-775"><a href="simulace4.html#cb707-775" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-776"><a href="simulace4.html#cb707-776" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb707-777"><a href="simulace4.html#cb707-777" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-778"><a href="simulace4.html#cb707-778" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb707-779"><a href="simulace4.html#cb707-779" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb707-780"><a href="simulace4.html#cb707-780" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb707-781"><a href="simulace4.html#cb707-781" tabindex="-1"></a>  )</span>
<span id="cb707-782"><a href="simulace4.html#cb707-782" tabindex="-1"></a>  </span>
<span id="cb707-783"><a href="simulace4.html#cb707-783" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb707-784"><a href="simulace4.html#cb707-784" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb707-785"><a href="simulace4.html#cb707-785" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb707-786"><a href="simulace4.html#cb707-786" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-787"><a href="simulace4.html#cb707-787" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-788"><a href="simulace4.html#cb707-788" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-789"><a href="simulace4.html#cb707-789" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb707-790"><a href="simulace4.html#cb707-790" tabindex="-1"></a>      </span>
<span id="cb707-791"><a href="simulace4.html#cb707-791" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb707-792"><a href="simulace4.html#cb707-792" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb707-793"><a href="simulace4.html#cb707-793" tabindex="-1"></a>      </span>
<span id="cb707-794"><a href="simulace4.html#cb707-794" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb707-795"><a href="simulace4.html#cb707-795" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-796"><a href="simulace4.html#cb707-796" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb707-797"><a href="simulace4.html#cb707-797" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-798"><a href="simulace4.html#cb707-798" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-799"><a href="simulace4.html#cb707-799" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb707-800"><a href="simulace4.html#cb707-800" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-801"><a href="simulace4.html#cb707-801" tabindex="-1"></a>      </span>
<span id="cb707-802"><a href="simulace4.html#cb707-802" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-803"><a href="simulace4.html#cb707-803" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb707-804"><a href="simulace4.html#cb707-804" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-805"><a href="simulace4.html#cb707-805" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-806"><a href="simulace4.html#cb707-806" tabindex="-1"></a>      </span>
<span id="cb707-807"><a href="simulace4.html#cb707-807" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb707-808"><a href="simulace4.html#cb707-808" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-809"><a href="simulace4.html#cb707-809" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb707-810"><a href="simulace4.html#cb707-810" tabindex="-1"></a>      </span>
<span id="cb707-811"><a href="simulace4.html#cb707-811" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb707-812"><a href="simulace4.html#cb707-812" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb707-813"><a href="simulace4.html#cb707-813" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-814"><a href="simulace4.html#cb707-814" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb707-815"><a href="simulace4.html#cb707-815" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-816"><a href="simulace4.html#cb707-816" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-817"><a href="simulace4.html#cb707-817" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-818"><a href="simulace4.html#cb707-818" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-819"><a href="simulace4.html#cb707-819" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb707-820"><a href="simulace4.html#cb707-820" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-821"><a href="simulace4.html#cb707-821" tabindex="-1"></a>        </span>
<span id="cb707-822"><a href="simulace4.html#cb707-822" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-823"><a href="simulace4.html#cb707-823" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb707-824"><a href="simulace4.html#cb707-824" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb707-825"><a href="simulace4.html#cb707-825" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-826"><a href="simulace4.html#cb707-826" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-827"><a href="simulace4.html#cb707-827" tabindex="-1"></a>        </span>
<span id="cb707-828"><a href="simulace4.html#cb707-828" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb707-829"><a href="simulace4.html#cb707-829" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-830"><a href="simulace4.html#cb707-830" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb707-831"><a href="simulace4.html#cb707-831" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb707-832"><a href="simulace4.html#cb707-832" tabindex="-1"></a>      }</span>
<span id="cb707-833"><a href="simulace4.html#cb707-833" tabindex="-1"></a>          </span>
<span id="cb707-834"><a href="simulace4.html#cb707-834" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb707-835"><a href="simulace4.html#cb707-835" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb707-836"><a href="simulace4.html#cb707-836" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-837"><a href="simulace4.html#cb707-837" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb707-838"><a href="simulace4.html#cb707-838" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-839"><a href="simulace4.html#cb707-839" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-840"><a href="simulace4.html#cb707-840" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-841"><a href="simulace4.html#cb707-841" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb707-842"><a href="simulace4.html#cb707-842" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-843"><a href="simulace4.html#cb707-843" tabindex="-1"></a>        </span>
<span id="cb707-844"><a href="simulace4.html#cb707-844" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-845"><a href="simulace4.html#cb707-845" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb707-846"><a href="simulace4.html#cb707-846" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-847"><a href="simulace4.html#cb707-847" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-848"><a href="simulace4.html#cb707-848" tabindex="-1"></a>        </span>
<span id="cb707-849"><a href="simulace4.html#cb707-849" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb707-850"><a href="simulace4.html#cb707-850" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-851"><a href="simulace4.html#cb707-851" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb707-852"><a href="simulace4.html#cb707-852" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb707-853"><a href="simulace4.html#cb707-853" tabindex="-1"></a>      }</span>
<span id="cb707-854"><a href="simulace4.html#cb707-854" tabindex="-1"></a>    }</span>
<span id="cb707-855"><a href="simulace4.html#cb707-855" tabindex="-1"></a>  }</span>
<span id="cb707-856"><a href="simulace4.html#cb707-856" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb707-857"><a href="simulace4.html#cb707-857" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb707-858"><a href="simulace4.html#cb707-858" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb707-859"><a href="simulace4.html#cb707-859" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb707-860"><a href="simulace4.html#cb707-860" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-861"><a href="simulace4.html#cb707-861" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb707-862"><a href="simulace4.html#cb707-862" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-863"><a href="simulace4.html#cb707-863" tabindex="-1"></a>  </span>
<span id="cb707-864"><a href="simulace4.html#cb707-864" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-865"><a href="simulace4.html#cb707-865" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb707-866"><a href="simulace4.html#cb707-866" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb707-867"><a href="simulace4.html#cb707-867" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb707-868"><a href="simulace4.html#cb707-868" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb707-869"><a href="simulace4.html#cb707-869" tabindex="-1"></a>  </span>
<span id="cb707-870"><a href="simulace4.html#cb707-870" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-871"><a href="simulace4.html#cb707-871" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-872"><a href="simulace4.html#cb707-872" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb707-873"><a href="simulace4.html#cb707-873" tabindex="-1"></a>  </span>
<span id="cb707-874"><a href="simulace4.html#cb707-874" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-875"><a href="simulace4.html#cb707-875" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-876"><a href="simulace4.html#cb707-876" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb707-877"><a href="simulace4.html#cb707-877" tabindex="-1"></a>  </span>
<span id="cb707-878"><a href="simulace4.html#cb707-878" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-879"><a href="simulace4.html#cb707-879" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-880"><a href="simulace4.html#cb707-880" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-881"><a href="simulace4.html#cb707-881" tabindex="-1"></a>  </span>
<span id="cb707-882"><a href="simulace4.html#cb707-882" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-883"><a href="simulace4.html#cb707-883" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb707-884"><a href="simulace4.html#cb707-884" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-885"><a href="simulace4.html#cb707-885" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-886"><a href="simulace4.html#cb707-886" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb707-887"><a href="simulace4.html#cb707-887" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-888"><a href="simulace4.html#cb707-888" tabindex="-1"></a>  </span>
<span id="cb707-889"><a href="simulace4.html#cb707-889" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb707-890"><a href="simulace4.html#cb707-890" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-891"><a href="simulace4.html#cb707-891" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-892"><a href="simulace4.html#cb707-892" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb707-893"><a href="simulace4.html#cb707-893" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb707-894"><a href="simulace4.html#cb707-894" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-895"><a href="simulace4.html#cb707-895" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-896"><a href="simulace4.html#cb707-896" tabindex="-1"></a>  </span>
<span id="cb707-897"><a href="simulace4.html#cb707-897" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb707-898"><a href="simulace4.html#cb707-898" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-899"><a href="simulace4.html#cb707-899" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb707-900"><a href="simulace4.html#cb707-900" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb707-901"><a href="simulace4.html#cb707-901" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb707-902"><a href="simulace4.html#cb707-902" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-903"><a href="simulace4.html#cb707-903" tabindex="-1"></a>  </span>
<span id="cb707-904"><a href="simulace4.html#cb707-904" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-905"><a href="simulace4.html#cb707-905" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb707-906"><a href="simulace4.html#cb707-906" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb707-907"><a href="simulace4.html#cb707-907" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-908"><a href="simulace4.html#cb707-908" tabindex="-1"></a>  </span>
<span id="cb707-909"><a href="simulace4.html#cb707-909" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb707-910"><a href="simulace4.html#cb707-910" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb707-911"><a href="simulace4.html#cb707-911" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-912"><a href="simulace4.html#cb707-912" tabindex="-1"></a>  </span>
<span id="cb707-913"><a href="simulace4.html#cb707-913" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb707-914"><a href="simulace4.html#cb707-914" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb707-915"><a href="simulace4.html#cb707-915" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-916"><a href="simulace4.html#cb707-916" tabindex="-1"></a>  </span>
<span id="cb707-917"><a href="simulace4.html#cb707-917" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-918"><a href="simulace4.html#cb707-918" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb707-919"><a href="simulace4.html#cb707-919" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-920"><a href="simulace4.html#cb707-920" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-921"><a href="simulace4.html#cb707-921" tabindex="-1"></a>  </span>
<span id="cb707-922"><a href="simulace4.html#cb707-922" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb707-923"><a href="simulace4.html#cb707-923" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-924"><a href="simulace4.html#cb707-924" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-925"><a href="simulace4.html#cb707-925" tabindex="-1"></a>  </span>
<span id="cb707-926"><a href="simulace4.html#cb707-926" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb707-927"><a href="simulace4.html#cb707-927" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-928"><a href="simulace4.html#cb707-928" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-929"><a href="simulace4.html#cb707-929" tabindex="-1"></a>  </span>
<span id="cb707-930"><a href="simulace4.html#cb707-930" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb707-931"><a href="simulace4.html#cb707-931" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb707-932"><a href="simulace4.html#cb707-932" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb707-933"><a href="simulace4.html#cb707-933" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb707-934"><a href="simulace4.html#cb707-934" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb707-935"><a href="simulace4.html#cb707-935" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb707-936"><a href="simulace4.html#cb707-936" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb707-937"><a href="simulace4.html#cb707-937" tabindex="-1"></a>  </span>
<span id="cb707-938"><a href="simulace4.html#cb707-938" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-939"><a href="simulace4.html#cb707-939" tabindex="-1"></a>  </span>
<span id="cb707-940"><a href="simulace4.html#cb707-940" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb707-941"><a href="simulace4.html#cb707-941" tabindex="-1"></a>  </span>
<span id="cb707-942"><a href="simulace4.html#cb707-942" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-943"><a href="simulace4.html#cb707-943" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-944"><a href="simulace4.html#cb707-944" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb707-945"><a href="simulace4.html#cb707-945" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb707-946"><a href="simulace4.html#cb707-946" tabindex="-1"></a>  </span>
<span id="cb707-947"><a href="simulace4.html#cb707-947" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-948"><a href="simulace4.html#cb707-948" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-949"><a href="simulace4.html#cb707-949" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-950"><a href="simulace4.html#cb707-950" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb707-951"><a href="simulace4.html#cb707-951" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-952"><a href="simulace4.html#cb707-952" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb707-953"><a href="simulace4.html#cb707-953" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb707-954"><a href="simulace4.html#cb707-954" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb707-955"><a href="simulace4.html#cb707-955" tabindex="-1"></a>  )</span>
<span id="cb707-956"><a href="simulace4.html#cb707-956" tabindex="-1"></a>  </span>
<span id="cb707-957"><a href="simulace4.html#cb707-957" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb707-958"><a href="simulace4.html#cb707-958" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb707-959"><a href="simulace4.html#cb707-959" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb707-960"><a href="simulace4.html#cb707-960" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-961"><a href="simulace4.html#cb707-961" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-962"><a href="simulace4.html#cb707-962" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-963"><a href="simulace4.html#cb707-963" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb707-964"><a href="simulace4.html#cb707-964" tabindex="-1"></a>      </span>
<span id="cb707-965"><a href="simulace4.html#cb707-965" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb707-966"><a href="simulace4.html#cb707-966" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb707-967"><a href="simulace4.html#cb707-967" tabindex="-1"></a>      </span>
<span id="cb707-968"><a href="simulace4.html#cb707-968" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb707-969"><a href="simulace4.html#cb707-969" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-970"><a href="simulace4.html#cb707-970" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb707-971"><a href="simulace4.html#cb707-971" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-972"><a href="simulace4.html#cb707-972" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-973"><a href="simulace4.html#cb707-973" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb707-974"><a href="simulace4.html#cb707-974" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-975"><a href="simulace4.html#cb707-975" tabindex="-1"></a>      </span>
<span id="cb707-976"><a href="simulace4.html#cb707-976" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-977"><a href="simulace4.html#cb707-977" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb707-978"><a href="simulace4.html#cb707-978" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-979"><a href="simulace4.html#cb707-979" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-980"><a href="simulace4.html#cb707-980" tabindex="-1"></a>      </span>
<span id="cb707-981"><a href="simulace4.html#cb707-981" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb707-982"><a href="simulace4.html#cb707-982" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-983"><a href="simulace4.html#cb707-983" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb707-984"><a href="simulace4.html#cb707-984" tabindex="-1"></a>      </span>
<span id="cb707-985"><a href="simulace4.html#cb707-985" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb707-986"><a href="simulace4.html#cb707-986" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb707-987"><a href="simulace4.html#cb707-987" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-988"><a href="simulace4.html#cb707-988" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb707-989"><a href="simulace4.html#cb707-989" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-990"><a href="simulace4.html#cb707-990" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-991"><a href="simulace4.html#cb707-991" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-992"><a href="simulace4.html#cb707-992" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-993"><a href="simulace4.html#cb707-993" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb707-994"><a href="simulace4.html#cb707-994" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-995"><a href="simulace4.html#cb707-995" tabindex="-1"></a>        </span>
<span id="cb707-996"><a href="simulace4.html#cb707-996" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-997"><a href="simulace4.html#cb707-997" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb707-998"><a href="simulace4.html#cb707-998" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-999"><a href="simulace4.html#cb707-999" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1000"><a href="simulace4.html#cb707-1000" tabindex="-1"></a>        </span>
<span id="cb707-1001"><a href="simulace4.html#cb707-1001" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb707-1002"><a href="simulace4.html#cb707-1002" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-1003"><a href="simulace4.html#cb707-1003" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb707-1004"><a href="simulace4.html#cb707-1004" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb707-1005"><a href="simulace4.html#cb707-1005" tabindex="-1"></a>      }</span>
<span id="cb707-1006"><a href="simulace4.html#cb707-1006" tabindex="-1"></a>          </span>
<span id="cb707-1007"><a href="simulace4.html#cb707-1007" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb707-1008"><a href="simulace4.html#cb707-1008" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb707-1009"><a href="simulace4.html#cb707-1009" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1010"><a href="simulace4.html#cb707-1010" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb707-1011"><a href="simulace4.html#cb707-1011" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1012"><a href="simulace4.html#cb707-1012" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1013"><a href="simulace4.html#cb707-1013" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-1014"><a href="simulace4.html#cb707-1014" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb707-1015"><a href="simulace4.html#cb707-1015" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-1016"><a href="simulace4.html#cb707-1016" tabindex="-1"></a>        </span>
<span id="cb707-1017"><a href="simulace4.html#cb707-1017" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1018"><a href="simulace4.html#cb707-1018" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb707-1019"><a href="simulace4.html#cb707-1019" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1020"><a href="simulace4.html#cb707-1020" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1021"><a href="simulace4.html#cb707-1021" tabindex="-1"></a>        </span>
<span id="cb707-1022"><a href="simulace4.html#cb707-1022" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb707-1023"><a href="simulace4.html#cb707-1023" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-1024"><a href="simulace4.html#cb707-1024" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb707-1025"><a href="simulace4.html#cb707-1025" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb707-1026"><a href="simulace4.html#cb707-1026" tabindex="-1"></a>      }</span>
<span id="cb707-1027"><a href="simulace4.html#cb707-1027" tabindex="-1"></a>    }</span>
<span id="cb707-1028"><a href="simulace4.html#cb707-1028" tabindex="-1"></a>  }</span>
<span id="cb707-1029"><a href="simulace4.html#cb707-1029" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb707-1030"><a href="simulace4.html#cb707-1030" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb707-1031"><a href="simulace4.html#cb707-1031" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb707-1032"><a href="simulace4.html#cb707-1032" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb707-1033"><a href="simulace4.html#cb707-1033" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1034"><a href="simulace4.html#cb707-1034" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb707-1035"><a href="simulace4.html#cb707-1035" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1036"><a href="simulace4.html#cb707-1036" tabindex="-1"></a>  </span>
<span id="cb707-1037"><a href="simulace4.html#cb707-1037" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1038"><a href="simulace4.html#cb707-1038" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb707-1039"><a href="simulace4.html#cb707-1039" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb707-1040"><a href="simulace4.html#cb707-1040" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb707-1041"><a href="simulace4.html#cb707-1041" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb707-1042"><a href="simulace4.html#cb707-1042" tabindex="-1"></a>  </span>
<span id="cb707-1043"><a href="simulace4.html#cb707-1043" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-1044"><a href="simulace4.html#cb707-1044" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-1045"><a href="simulace4.html#cb707-1045" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb707-1046"><a href="simulace4.html#cb707-1046" tabindex="-1"></a>  </span>
<span id="cb707-1047"><a href="simulace4.html#cb707-1047" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-1048"><a href="simulace4.html#cb707-1048" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-1049"><a href="simulace4.html#cb707-1049" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb707-1050"><a href="simulace4.html#cb707-1050" tabindex="-1"></a>  </span>
<span id="cb707-1051"><a href="simulace4.html#cb707-1051" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1052"><a href="simulace4.html#cb707-1052" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-1053"><a href="simulace4.html#cb707-1053" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-1054"><a href="simulace4.html#cb707-1054" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1055"><a href="simulace4.html#cb707-1055" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb707-1056"><a href="simulace4.html#cb707-1056" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1057"><a href="simulace4.html#cb707-1057" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1058"><a href="simulace4.html#cb707-1058" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb707-1059"><a href="simulace4.html#cb707-1059" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-1060"><a href="simulace4.html#cb707-1060" tabindex="-1"></a>  </span>
<span id="cb707-1061"><a href="simulace4.html#cb707-1061" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb707-1062"><a href="simulace4.html#cb707-1062" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1063"><a href="simulace4.html#cb707-1063" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1064"><a href="simulace4.html#cb707-1064" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb707-1065"><a href="simulace4.html#cb707-1065" tabindex="-1"></a>                       <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1066"><a href="simulace4.html#cb707-1066" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb707-1067"><a href="simulace4.html#cb707-1067" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-1068"><a href="simulace4.html#cb707-1068" tabindex="-1"></a>  </span>
<span id="cb707-1069"><a href="simulace4.html#cb707-1069" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb707-1070"><a href="simulace4.html#cb707-1070" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1071"><a href="simulace4.html#cb707-1071" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1072"><a href="simulace4.html#cb707-1072" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb707-1073"><a href="simulace4.html#cb707-1073" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb707-1074"><a href="simulace4.html#cb707-1074" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-1075"><a href="simulace4.html#cb707-1075" tabindex="-1"></a>  </span>
<span id="cb707-1076"><a href="simulace4.html#cb707-1076" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1077"><a href="simulace4.html#cb707-1077" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-1078"><a href="simulace4.html#cb707-1078" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1079"><a href="simulace4.html#cb707-1079" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1080"><a href="simulace4.html#cb707-1080" tabindex="-1"></a>  </span>
<span id="cb707-1081"><a href="simulace4.html#cb707-1081" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-1082"><a href="simulace4.html#cb707-1082" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1083"><a href="simulace4.html#cb707-1083" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1084"><a href="simulace4.html#cb707-1084" tabindex="-1"></a>  </span>
<span id="cb707-1085"><a href="simulace4.html#cb707-1085" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb707-1086"><a href="simulace4.html#cb707-1086" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1087"><a href="simulace4.html#cb707-1087" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1088"><a href="simulace4.html#cb707-1088" tabindex="-1"></a>    </span>
<span id="cb707-1089"><a href="simulace4.html#cb707-1089" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-1090"><a href="simulace4.html#cb707-1090" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-1091"><a href="simulace4.html#cb707-1091" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1092"><a href="simulace4.html#cb707-1092" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1093"><a href="simulace4.html#cb707-1093" tabindex="-1"></a>  </span>
<span id="cb707-1094"><a href="simulace4.html#cb707-1094" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-1095"><a href="simulace4.html#cb707-1095" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1096"><a href="simulace4.html#cb707-1096" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1097"><a href="simulace4.html#cb707-1097" tabindex="-1"></a>  </span>
<span id="cb707-1098"><a href="simulace4.html#cb707-1098" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb707-1099"><a href="simulace4.html#cb707-1099" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1100"><a href="simulace4.html#cb707-1100" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1101"><a href="simulace4.html#cb707-1101" tabindex="-1"></a>  </span>
<span id="cb707-1102"><a href="simulace4.html#cb707-1102" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb707-1103"><a href="simulace4.html#cb707-1103" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb707-1104"><a href="simulace4.html#cb707-1104" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb707-1105"><a href="simulace4.html#cb707-1105" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb707-1106"><a href="simulace4.html#cb707-1106" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb707-1107"><a href="simulace4.html#cb707-1107" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb707-1108"><a href="simulace4.html#cb707-1108" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb707-1109"><a href="simulace4.html#cb707-1109" tabindex="-1"></a>  </span>
<span id="cb707-1110"><a href="simulace4.html#cb707-1110" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-1111"><a href="simulace4.html#cb707-1111" tabindex="-1"></a>  </span>
<span id="cb707-1112"><a href="simulace4.html#cb707-1112" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb707-1113"><a href="simulace4.html#cb707-1113" tabindex="-1"></a>  </span>
<span id="cb707-1114"><a href="simulace4.html#cb707-1114" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-1115"><a href="simulace4.html#cb707-1115" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb707-1116"><a href="simulace4.html#cb707-1116" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb707-1117"><a href="simulace4.html#cb707-1117" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb707-1118"><a href="simulace4.html#cb707-1118" tabindex="-1"></a>  </span>
<span id="cb707-1119"><a href="simulace4.html#cb707-1119" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-1120"><a href="simulace4.html#cb707-1120" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-1121"><a href="simulace4.html#cb707-1121" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-1122"><a href="simulace4.html#cb707-1122" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb707-1123"><a href="simulace4.html#cb707-1123" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-1124"><a href="simulace4.html#cb707-1124" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb707-1125"><a href="simulace4.html#cb707-1125" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb707-1126"><a href="simulace4.html#cb707-1126" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb707-1127"><a href="simulace4.html#cb707-1127" tabindex="-1"></a>  )</span>
<span id="cb707-1128"><a href="simulace4.html#cb707-1128" tabindex="-1"></a>  </span>
<span id="cb707-1129"><a href="simulace4.html#cb707-1129" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb707-1130"><a href="simulace4.html#cb707-1130" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb707-1131"><a href="simulace4.html#cb707-1131" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb707-1132"><a href="simulace4.html#cb707-1132" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-1133"><a href="simulace4.html#cb707-1133" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-1134"><a href="simulace4.html#cb707-1134" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-1135"><a href="simulace4.html#cb707-1135" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb707-1136"><a href="simulace4.html#cb707-1136" tabindex="-1"></a>      </span>
<span id="cb707-1137"><a href="simulace4.html#cb707-1137" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb707-1138"><a href="simulace4.html#cb707-1138" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb707-1139"><a href="simulace4.html#cb707-1139" tabindex="-1"></a>      </span>
<span id="cb707-1140"><a href="simulace4.html#cb707-1140" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb707-1141"><a href="simulace4.html#cb707-1141" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1142"><a href="simulace4.html#cb707-1142" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb707-1143"><a href="simulace4.html#cb707-1143" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1144"><a href="simulace4.html#cb707-1144" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1145"><a href="simulace4.html#cb707-1145" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb707-1146"><a href="simulace4.html#cb707-1146" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-1147"><a href="simulace4.html#cb707-1147" tabindex="-1"></a>      </span>
<span id="cb707-1148"><a href="simulace4.html#cb707-1148" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1149"><a href="simulace4.html#cb707-1149" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb707-1150"><a href="simulace4.html#cb707-1150" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1151"><a href="simulace4.html#cb707-1151" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1152"><a href="simulace4.html#cb707-1152" tabindex="-1"></a>      </span>
<span id="cb707-1153"><a href="simulace4.html#cb707-1153" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb707-1154"><a href="simulace4.html#cb707-1154" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-1155"><a href="simulace4.html#cb707-1155" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb707-1156"><a href="simulace4.html#cb707-1156" tabindex="-1"></a>      </span>
<span id="cb707-1157"><a href="simulace4.html#cb707-1157" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb707-1158"><a href="simulace4.html#cb707-1158" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb707-1159"><a href="simulace4.html#cb707-1159" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1160"><a href="simulace4.html#cb707-1160" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb707-1161"><a href="simulace4.html#cb707-1161" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1162"><a href="simulace4.html#cb707-1162" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1163"><a href="simulace4.html#cb707-1163" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-1164"><a href="simulace4.html#cb707-1164" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb707-1165"><a href="simulace4.html#cb707-1165" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb707-1166"><a href="simulace4.html#cb707-1166" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-1167"><a href="simulace4.html#cb707-1167" tabindex="-1"></a>        </span>
<span id="cb707-1168"><a href="simulace4.html#cb707-1168" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1169"><a href="simulace4.html#cb707-1169" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb707-1170"><a href="simulace4.html#cb707-1170" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb707-1171"><a href="simulace4.html#cb707-1171" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1172"><a href="simulace4.html#cb707-1172" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1173"><a href="simulace4.html#cb707-1173" tabindex="-1"></a>        </span>
<span id="cb707-1174"><a href="simulace4.html#cb707-1174" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb707-1175"><a href="simulace4.html#cb707-1175" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-1176"><a href="simulace4.html#cb707-1176" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb707-1177"><a href="simulace4.html#cb707-1177" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb707-1178"><a href="simulace4.html#cb707-1178" tabindex="-1"></a>      }</span>
<span id="cb707-1179"><a href="simulace4.html#cb707-1179" tabindex="-1"></a>          </span>
<span id="cb707-1180"><a href="simulace4.html#cb707-1180" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb707-1181"><a href="simulace4.html#cb707-1181" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb707-1182"><a href="simulace4.html#cb707-1182" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1183"><a href="simulace4.html#cb707-1183" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb707-1184"><a href="simulace4.html#cb707-1184" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1185"><a href="simulace4.html#cb707-1185" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1186"><a href="simulace4.html#cb707-1186" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb707-1187"><a href="simulace4.html#cb707-1187" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb707-1188"><a href="simulace4.html#cb707-1188" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-1189"><a href="simulace4.html#cb707-1189" tabindex="-1"></a>        </span>
<span id="cb707-1190"><a href="simulace4.html#cb707-1190" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1191"><a href="simulace4.html#cb707-1191" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb707-1192"><a href="simulace4.html#cb707-1192" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb707-1193"><a href="simulace4.html#cb707-1193" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1194"><a href="simulace4.html#cb707-1194" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1195"><a href="simulace4.html#cb707-1195" tabindex="-1"></a>        </span>
<span id="cb707-1196"><a href="simulace4.html#cb707-1196" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb707-1197"><a href="simulace4.html#cb707-1197" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb707-1198"><a href="simulace4.html#cb707-1198" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb707-1199"><a href="simulace4.html#cb707-1199" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb707-1200"><a href="simulace4.html#cb707-1200" tabindex="-1"></a>      }</span>
<span id="cb707-1201"><a href="simulace4.html#cb707-1201" tabindex="-1"></a>    }</span>
<span id="cb707-1202"><a href="simulace4.html#cb707-1202" tabindex="-1"></a>  }</span>
<span id="cb707-1203"><a href="simulace4.html#cb707-1203" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb707-1204"><a href="simulace4.html#cb707-1204" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb707-1205"><a href="simulace4.html#cb707-1205" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb707-1206"><a href="simulace4.html#cb707-1206" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb707-1207"><a href="simulace4.html#cb707-1207" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1208"><a href="simulace4.html#cb707-1208" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb707-1209"><a href="simulace4.html#cb707-1209" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1210"><a href="simulace4.html#cb707-1210" tabindex="-1"></a>  </span>
<span id="cb707-1211"><a href="simulace4.html#cb707-1211" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1212"><a href="simulace4.html#cb707-1212" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb707-1213"><a href="simulace4.html#cb707-1213" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb707-1214"><a href="simulace4.html#cb707-1214" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb707-1215"><a href="simulace4.html#cb707-1215" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb707-1216"><a href="simulace4.html#cb707-1216" tabindex="-1"></a>  </span>
<span id="cb707-1217"><a href="simulace4.html#cb707-1217" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-1218"><a href="simulace4.html#cb707-1218" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-1219"><a href="simulace4.html#cb707-1219" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb707-1220"><a href="simulace4.html#cb707-1220" tabindex="-1"></a>  </span>
<span id="cb707-1221"><a href="simulace4.html#cb707-1221" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-1222"><a href="simulace4.html#cb707-1222" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb707-1223"><a href="simulace4.html#cb707-1223" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb707-1224"><a href="simulace4.html#cb707-1224" tabindex="-1"></a>  </span>
<span id="cb707-1225"><a href="simulace4.html#cb707-1225" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1226"><a href="simulace4.html#cb707-1226" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-1227"><a href="simulace4.html#cb707-1227" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-1228"><a href="simulace4.html#cb707-1228" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1229"><a href="simulace4.html#cb707-1229" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb707-1230"><a href="simulace4.html#cb707-1230" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1231"><a href="simulace4.html#cb707-1231" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1232"><a href="simulace4.html#cb707-1232" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb707-1233"><a href="simulace4.html#cb707-1233" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-1234"><a href="simulace4.html#cb707-1234" tabindex="-1"></a>  </span>
<span id="cb707-1235"><a href="simulace4.html#cb707-1235" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb707-1236"><a href="simulace4.html#cb707-1236" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1237"><a href="simulace4.html#cb707-1237" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1238"><a href="simulace4.html#cb707-1238" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb707-1239"><a href="simulace4.html#cb707-1239" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1240"><a href="simulace4.html#cb707-1240" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb707-1241"><a href="simulace4.html#cb707-1241" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-1242"><a href="simulace4.html#cb707-1242" tabindex="-1"></a>  </span>
<span id="cb707-1243"><a href="simulace4.html#cb707-1243" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb707-1244"><a href="simulace4.html#cb707-1244" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1245"><a href="simulace4.html#cb707-1245" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1246"><a href="simulace4.html#cb707-1246" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb707-1247"><a href="simulace4.html#cb707-1247" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb707-1248"><a href="simulace4.html#cb707-1248" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-1249"><a href="simulace4.html#cb707-1249" tabindex="-1"></a>  </span>
<span id="cb707-1250"><a href="simulace4.html#cb707-1250" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1251"><a href="simulace4.html#cb707-1251" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb707-1252"><a href="simulace4.html#cb707-1252" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1253"><a href="simulace4.html#cb707-1253" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1254"><a href="simulace4.html#cb707-1254" tabindex="-1"></a>  </span>
<span id="cb707-1255"><a href="simulace4.html#cb707-1255" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb707-1256"><a href="simulace4.html#cb707-1256" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1257"><a href="simulace4.html#cb707-1257" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1258"><a href="simulace4.html#cb707-1258" tabindex="-1"></a>  </span>
<span id="cb707-1259"><a href="simulace4.html#cb707-1259" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb707-1260"><a href="simulace4.html#cb707-1260" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1261"><a href="simulace4.html#cb707-1261" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1262"><a href="simulace4.html#cb707-1262" tabindex="-1"></a>    </span>
<span id="cb707-1263"><a href="simulace4.html#cb707-1263" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-1264"><a href="simulace4.html#cb707-1264" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb707-1265"><a href="simulace4.html#cb707-1265" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1266"><a href="simulace4.html#cb707-1266" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1267"><a href="simulace4.html#cb707-1267" tabindex="-1"></a>  </span>
<span id="cb707-1268"><a href="simulace4.html#cb707-1268" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb707-1269"><a href="simulace4.html#cb707-1269" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1270"><a href="simulace4.html#cb707-1270" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1271"><a href="simulace4.html#cb707-1271" tabindex="-1"></a>  </span>
<span id="cb707-1272"><a href="simulace4.html#cb707-1272" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb707-1273"><a href="simulace4.html#cb707-1273" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1274"><a href="simulace4.html#cb707-1274" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1275"><a href="simulace4.html#cb707-1275" tabindex="-1"></a></span>
<span id="cb707-1276"><a href="simulace4.html#cb707-1276" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb707-1277"><a href="simulace4.html#cb707-1277" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb707-1278"><a href="simulace4.html#cb707-1278" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb707-1279"><a href="simulace4.html#cb707-1279" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb707-1280"><a href="simulace4.html#cb707-1280" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb707-1281"><a href="simulace4.html#cb707-1281" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb707-1282"><a href="simulace4.html#cb707-1282" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb707-1283"><a href="simulace4.html#cb707-1283" tabindex="-1"></a></span>
<span id="cb707-1284"><a href="simulace4.html#cb707-1284" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-1285"><a href="simulace4.html#cb707-1285" tabindex="-1"></a>  </span>
<span id="cb707-1286"><a href="simulace4.html#cb707-1286" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb707-1287"><a href="simulace4.html#cb707-1287" tabindex="-1"></a>  </span>
<span id="cb707-1288"><a href="simulace4.html#cb707-1288" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb707-1289"><a href="simulace4.html#cb707-1289" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb707-1290"><a href="simulace4.html#cb707-1290" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb707-1291"><a href="simulace4.html#cb707-1291" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb707-1292"><a href="simulace4.html#cb707-1292" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># length(t) + norder - 2 - 10</span></span>
<span id="cb707-1293"><a href="simulace4.html#cb707-1293" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb707-1294"><a href="simulace4.html#cb707-1294" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-1295"><a href="simulace4.html#cb707-1295" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb707-1296"><a href="simulace4.html#cb707-1296" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb707-1297"><a href="simulace4.html#cb707-1297" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb707-1298"><a href="simulace4.html#cb707-1298" tabindex="-1"></a>  </span>
<span id="cb707-1299"><a href="simulace4.html#cb707-1299" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb707-1300"><a href="simulace4.html#cb707-1300" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-1301"><a href="simulace4.html#cb707-1301" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb707-1302"><a href="simulace4.html#cb707-1302" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb707-1303"><a href="simulace4.html#cb707-1303" tabindex="-1"></a>                                  <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), </span>
<span id="cb707-1304"><a href="simulace4.html#cb707-1304" tabindex="-1"></a>                                <span class="at">argvals =</span> t.seq, <span class="at">basisobj =</span> bbasis)</span>
<span id="cb707-1305"><a href="simulace4.html#cb707-1305" tabindex="-1"></a>    </span>
<span id="cb707-1306"><a href="simulace4.html#cb707-1306" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data v ramci CV</span></span>
<span id="cb707-1307"><a href="simulace4.html#cb707-1307" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection) </span>
<span id="cb707-1308"><a href="simulace4.html#cb707-1308" tabindex="-1"></a>  </span>
<span id="cb707-1309"><a href="simulace4.html#cb707-1309" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-1310"><a href="simulace4.html#cb707-1310" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-1311"><a href="simulace4.html#cb707-1311" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb707-1312"><a href="simulace4.html#cb707-1312" tabindex="-1"></a>      </span>
<span id="cb707-1313"><a href="simulace4.html#cb707-1313" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb707-1314"><a href="simulace4.html#cb707-1314" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb707-1315"><a href="simulace4.html#cb707-1315" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb707-1316"><a href="simulace4.html#cb707-1316" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb707-1317"><a href="simulace4.html#cb707-1317" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb707-1318"><a href="simulace4.html#cb707-1318" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1319"><a href="simulace4.html#cb707-1319" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb707-1320"><a href="simulace4.html#cb707-1320" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1321"><a href="simulace4.html#cb707-1321" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1322"><a href="simulace4.html#cb707-1322" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb707-1323"><a href="simulace4.html#cb707-1323" tabindex="-1"></a>      </span>
<span id="cb707-1324"><a href="simulace4.html#cb707-1324" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb707-1325"><a href="simulace4.html#cb707-1325" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1326"><a href="simulace4.html#cb707-1326" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1327"><a href="simulace4.html#cb707-1327" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1328"><a href="simulace4.html#cb707-1328" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb707-1329"><a href="simulace4.html#cb707-1329" tabindex="-1"></a>      </span>
<span id="cb707-1330"><a href="simulace4.html#cb707-1330" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb707-1331"><a href="simulace4.html#cb707-1331" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1332"><a href="simulace4.html#cb707-1332" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1333"><a href="simulace4.html#cb707-1333" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb707-1334"><a href="simulace4.html#cb707-1334" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1335"><a href="simulace4.html#cb707-1335" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb707-1336"><a href="simulace4.html#cb707-1336" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb707-1337"><a href="simulace4.html#cb707-1337" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb707-1338"><a href="simulace4.html#cb707-1338" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb707-1339"><a href="simulace4.html#cb707-1339" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1340"><a href="simulace4.html#cb707-1340" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb707-1341"><a href="simulace4.html#cb707-1341" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb707-1342"><a href="simulace4.html#cb707-1342" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb707-1343"><a href="simulace4.html#cb707-1343" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb707-1344"><a href="simulace4.html#cb707-1344" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1345"><a href="simulace4.html#cb707-1345" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb707-1346"><a href="simulace4.html#cb707-1346" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb707-1347"><a href="simulace4.html#cb707-1347" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb707-1348"><a href="simulace4.html#cb707-1348" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb707-1349"><a href="simulace4.html#cb707-1349" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1350"><a href="simulace4.html#cb707-1350" tabindex="-1"></a>      </span>
<span id="cb707-1351"><a href="simulace4.html#cb707-1351" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb707-1352"><a href="simulace4.html#cb707-1352" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb707-1353"><a href="simulace4.html#cb707-1353" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb707-1354"><a href="simulace4.html#cb707-1354" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb707-1355"><a href="simulace4.html#cb707-1355" tabindex="-1"></a>    }</span>
<span id="cb707-1356"><a href="simulace4.html#cb707-1356" tabindex="-1"></a>  }</span>
<span id="cb707-1357"><a href="simulace4.html#cb707-1357" tabindex="-1"></a>  </span>
<span id="cb707-1358"><a href="simulace4.html#cb707-1358" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb707-1359"><a href="simulace4.html#cb707-1359" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb707-1360"><a href="simulace4.html#cb707-1360" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb707-1361"><a href="simulace4.html#cb707-1361" tabindex="-1"></a>  }</span>
<span id="cb707-1362"><a href="simulace4.html#cb707-1362" tabindex="-1"></a>  </span>
<span id="cb707-1363"><a href="simulace4.html#cb707-1363" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb707-1364"><a href="simulace4.html#cb707-1364" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb707-1365"><a href="simulace4.html#cb707-1365" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb707-1366"><a href="simulace4.html#cb707-1366" tabindex="-1"></a>  </span>
<span id="cb707-1367"><a href="simulace4.html#cb707-1367" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb707-1368"><a href="simulace4.html#cb707-1368" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb707-1369"><a href="simulace4.html#cb707-1369" tabindex="-1"></a>  </span>
<span id="cb707-1370"><a href="simulace4.html#cb707-1370" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1371"><a href="simulace4.html#cb707-1371" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb707-1372"><a href="simulace4.html#cb707-1372" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb707-1373"><a href="simulace4.html#cb707-1373" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb707-1374"><a href="simulace4.html#cb707-1374" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb707-1375"><a href="simulace4.html#cb707-1375" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1376"><a href="simulace4.html#cb707-1376" tabindex="-1"></a>  </span>
<span id="cb707-1377"><a href="simulace4.html#cb707-1377" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1378"><a href="simulace4.html#cb707-1378" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1379"><a href="simulace4.html#cb707-1379" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb707-1380"><a href="simulace4.html#cb707-1380" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb707-1381"><a href="simulace4.html#cb707-1381" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> <span class="fu">rbind</span>(</span>
<span id="cb707-1382"><a href="simulace4.html#cb707-1382" tabindex="-1"></a>      grid.data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>)),</span>
<span id="cb707-1383"><a href="simulace4.html#cb707-1383" tabindex="-1"></a>      grid.data.test <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">!</span><span class="fu">contains</span>(<span class="st">&#39;Y&#39;</span>))) <span class="sc">|&gt;</span></span>
<span id="cb707-1384"><a href="simulace4.html#cb707-1384" tabindex="-1"></a>        <span class="fu">as.matrix</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">argvals =</span> t.seq, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb707-1385"><a href="simulace4.html#cb707-1385" tabindex="-1"></a></span>
<span id="cb707-1386"><a href="simulace4.html#cb707-1386" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), ]</span>
<span id="cb707-1387"><a href="simulace4.html#cb707-1387" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">t</span>(Projection)[(<span class="fu">sum</span>(split) <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">length</span>(split), ]</span>
<span id="cb707-1388"><a href="simulace4.html#cb707-1388" tabindex="-1"></a>    </span>
<span id="cb707-1389"><a href="simulace4.html#cb707-1389" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb707-1390"><a href="simulace4.html#cb707-1390" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb707-1391"><a href="simulace4.html#cb707-1391" tabindex="-1"></a>    </span>
<span id="cb707-1392"><a href="simulace4.html#cb707-1392" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb707-1393"><a href="simulace4.html#cb707-1393" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-1394"><a href="simulace4.html#cb707-1394" tabindex="-1"></a>    </span>
<span id="cb707-1395"><a href="simulace4.html#cb707-1395" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1396"><a href="simulace4.html#cb707-1396" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb707-1397"><a href="simulace4.html#cb707-1397" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1398"><a href="simulace4.html#cb707-1398" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1399"><a href="simulace4.html#cb707-1399" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1400"><a href="simulace4.html#cb707-1400" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1401"><a href="simulace4.html#cb707-1401" tabindex="-1"></a>    </span>
<span id="cb707-1402"><a href="simulace4.html#cb707-1402" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1403"><a href="simulace4.html#cb707-1403" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb707-1404"><a href="simulace4.html#cb707-1404" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-1405"><a href="simulace4.html#cb707-1405" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1406"><a href="simulace4.html#cb707-1406" tabindex="-1"></a>      </span>
<span id="cb707-1407"><a href="simulace4.html#cb707-1407" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1408"><a href="simulace4.html#cb707-1408" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb707-1409"><a href="simulace4.html#cb707-1409" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1410"><a href="simulace4.html#cb707-1410" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1411"><a href="simulace4.html#cb707-1411" tabindex="-1"></a>    </span>
<span id="cb707-1412"><a href="simulace4.html#cb707-1412" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1413"><a href="simulace4.html#cb707-1413" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb707-1414"><a href="simulace4.html#cb707-1414" tabindex="-1"></a>  }</span>
<span id="cb707-1415"><a href="simulace4.html#cb707-1415" tabindex="-1"></a>  </span>
<span id="cb707-1416"><a href="simulace4.html#cb707-1416" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-1417"><a href="simulace4.html#cb707-1417" tabindex="-1"></a>  </span>
<span id="cb707-1418"><a href="simulace4.html#cb707-1418" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb707-1419"><a href="simulace4.html#cb707-1419" tabindex="-1"></a>  </span>
<span id="cb707-1420"><a href="simulace4.html#cb707-1420" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb707-1421"><a href="simulace4.html#cb707-1421" tabindex="-1"></a>  </span>
<span id="cb707-1422"><a href="simulace4.html#cb707-1422" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb707-1423"><a href="simulace4.html#cb707-1423" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb707-1424"><a href="simulace4.html#cb707-1424" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb707-1425"><a href="simulace4.html#cb707-1425" tabindex="-1"></a>  }</span>
<span id="cb707-1426"><a href="simulace4.html#cb707-1426" tabindex="-1"></a>  </span>
<span id="cb707-1427"><a href="simulace4.html#cb707-1427" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb707-1428"><a href="simulace4.html#cb707-1428" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb707-1429"><a href="simulace4.html#cb707-1429" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb707-1430"><a href="simulace4.html#cb707-1430" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb707-1431"><a href="simulace4.html#cb707-1431" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb707-1432"><a href="simulace4.html#cb707-1432" tabindex="-1"></a>      }</span>
<span id="cb707-1433"><a href="simulace4.html#cb707-1433" tabindex="-1"></a>    }</span>
<span id="cb707-1434"><a href="simulace4.html#cb707-1434" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb707-1435"><a href="simulace4.html#cb707-1435" tabindex="-1"></a>  }</span>
<span id="cb707-1436"><a href="simulace4.html#cb707-1436" tabindex="-1"></a>  </span>
<span id="cb707-1437"><a href="simulace4.html#cb707-1437" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-1438"><a href="simulace4.html#cb707-1438" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-1439"><a href="simulace4.html#cb707-1439" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-1440"><a href="simulace4.html#cb707-1440" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-1441"><a href="simulace4.html#cb707-1441" tabindex="-1"></a>  </span>
<span id="cb707-1442"><a href="simulace4.html#cb707-1442" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb707-1443"><a href="simulace4.html#cb707-1443" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb707-1444"><a href="simulace4.html#cb707-1444" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">3</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb707-1445"><a href="simulace4.html#cb707-1445" tabindex="-1"></a>  </span>
<span id="cb707-1446"><a href="simulace4.html#cb707-1446" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-1447"><a href="simulace4.html#cb707-1447" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-1448"><a href="simulace4.html#cb707-1448" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-1449"><a href="simulace4.html#cb707-1449" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb707-1450"><a href="simulace4.html#cb707-1450" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb707-1451"><a href="simulace4.html#cb707-1451" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb707-1452"><a href="simulace4.html#cb707-1452" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb707-1453"><a href="simulace4.html#cb707-1453" tabindex="-1"></a>  </span>
<span id="cb707-1454"><a href="simulace4.html#cb707-1454" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-1455"><a href="simulace4.html#cb707-1455" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1456"><a href="simulace4.html#cb707-1456" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1457"><a href="simulace4.html#cb707-1457" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1458"><a href="simulace4.html#cb707-1458" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1459"><a href="simulace4.html#cb707-1459" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1460"><a href="simulace4.html#cb707-1460" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb707-1461"><a href="simulace4.html#cb707-1461" tabindex="-1"></a>  </span>
<span id="cb707-1462"><a href="simulace4.html#cb707-1462" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb707-1463"><a href="simulace4.html#cb707-1463" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb707-1464"><a href="simulace4.html#cb707-1464" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb707-1465"><a href="simulace4.html#cb707-1465" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-1466"><a href="simulace4.html#cb707-1466" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-1467"><a href="simulace4.html#cb707-1467" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-1468"><a href="simulace4.html#cb707-1468" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb707-1469"><a href="simulace4.html#cb707-1469" tabindex="-1"></a>    </span>
<span id="cb707-1470"><a href="simulace4.html#cb707-1470" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb707-1471"><a href="simulace4.html#cb707-1471" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1472"><a href="simulace4.html#cb707-1472" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-1473"><a href="simulace4.html#cb707-1473" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-1474"><a href="simulace4.html#cb707-1474" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-1475"><a href="simulace4.html#cb707-1475" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb707-1476"><a href="simulace4.html#cb707-1476" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-1477"><a href="simulace4.html#cb707-1477" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb707-1478"><a href="simulace4.html#cb707-1478" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb707-1479"><a href="simulace4.html#cb707-1479" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb707-1480"><a href="simulace4.html#cb707-1480" tabindex="-1"></a>    }</span>
<span id="cb707-1481"><a href="simulace4.html#cb707-1481" tabindex="-1"></a>    </span>
<span id="cb707-1482"><a href="simulace4.html#cb707-1482" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb707-1483"><a href="simulace4.html#cb707-1483" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb707-1484"><a href="simulace4.html#cb707-1484" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-1485"><a href="simulace4.html#cb707-1485" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-1486"><a href="simulace4.html#cb707-1486" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb707-1487"><a href="simulace4.html#cb707-1487" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-1488"><a href="simulace4.html#cb707-1488" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1489"><a href="simulace4.html#cb707-1489" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb707-1490"><a href="simulace4.html#cb707-1490" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-1491"><a href="simulace4.html#cb707-1491" tabindex="-1"></a>      }</span>
<span id="cb707-1492"><a href="simulace4.html#cb707-1492" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb707-1493"><a href="simulace4.html#cb707-1493" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-1494"><a href="simulace4.html#cb707-1494" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-1495"><a href="simulace4.html#cb707-1495" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-1496"><a href="simulace4.html#cb707-1496" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb707-1497"><a href="simulace4.html#cb707-1497" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb707-1498"><a href="simulace4.html#cb707-1498" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb707-1499"><a href="simulace4.html#cb707-1499" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1500"><a href="simulace4.html#cb707-1500" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb707-1501"><a href="simulace4.html#cb707-1501" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb707-1502"><a href="simulace4.html#cb707-1502" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb707-1503"><a href="simulace4.html#cb707-1503" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1504"><a href="simulace4.html#cb707-1504" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-1505"><a href="simulace4.html#cb707-1505" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1506"><a href="simulace4.html#cb707-1506" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1507"><a href="simulace4.html#cb707-1507" tabindex="-1"></a>        </span>
<span id="cb707-1508"><a href="simulace4.html#cb707-1508" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-1509"><a href="simulace4.html#cb707-1509" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb707-1510"><a href="simulace4.html#cb707-1510" tabindex="-1"></a>          </span>
<span id="cb707-1511"><a href="simulace4.html#cb707-1511" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-1512"><a href="simulace4.html#cb707-1512" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb707-1513"><a href="simulace4.html#cb707-1513" tabindex="-1"></a>          </span>
<span id="cb707-1514"><a href="simulace4.html#cb707-1514" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1515"><a href="simulace4.html#cb707-1515" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-1516"><a href="simulace4.html#cb707-1516" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1517"><a href="simulace4.html#cb707-1517" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1518"><a href="simulace4.html#cb707-1518" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1519"><a href="simulace4.html#cb707-1519" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1520"><a href="simulace4.html#cb707-1520" tabindex="-1"></a>          </span>
<span id="cb707-1521"><a href="simulace4.html#cb707-1521" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1522"><a href="simulace4.html#cb707-1522" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-1523"><a href="simulace4.html#cb707-1523" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1524"><a href="simulace4.html#cb707-1524" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1525"><a href="simulace4.html#cb707-1525" tabindex="-1"></a>          </span>
<span id="cb707-1526"><a href="simulace4.html#cb707-1526" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1527"><a href="simulace4.html#cb707-1527" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb707-1528"><a href="simulace4.html#cb707-1528" tabindex="-1"></a>        }</span>
<span id="cb707-1529"><a href="simulace4.html#cb707-1529" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb707-1530"><a href="simulace4.html#cb707-1530" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb707-1531"><a href="simulace4.html#cb707-1531" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1532"><a href="simulace4.html#cb707-1532" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb707-1533"><a href="simulace4.html#cb707-1533" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb707-1534"><a href="simulace4.html#cb707-1534" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1535"><a href="simulace4.html#cb707-1535" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb707-1536"><a href="simulace4.html#cb707-1536" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb707-1537"><a href="simulace4.html#cb707-1537" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1538"><a href="simulace4.html#cb707-1538" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb707-1539"><a href="simulace4.html#cb707-1539" tabindex="-1"></a>      }</span>
<span id="cb707-1540"><a href="simulace4.html#cb707-1540" tabindex="-1"></a>    }</span>
<span id="cb707-1541"><a href="simulace4.html#cb707-1541" tabindex="-1"></a>  }</span>
<span id="cb707-1542"><a href="simulace4.html#cb707-1542" tabindex="-1"></a>  </span>
<span id="cb707-1543"><a href="simulace4.html#cb707-1543" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb707-1544"><a href="simulace4.html#cb707-1544" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb707-1545"><a href="simulace4.html#cb707-1545" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1546"><a href="simulace4.html#cb707-1546" tabindex="-1"></a>  }</span>
<span id="cb707-1547"><a href="simulace4.html#cb707-1547" tabindex="-1"></a>  </span>
<span id="cb707-1548"><a href="simulace4.html#cb707-1548" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb707-1549"><a href="simulace4.html#cb707-1549" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb707-1550"><a href="simulace4.html#cb707-1550" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb707-1551"><a href="simulace4.html#cb707-1551" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb707-1552"><a href="simulace4.html#cb707-1552" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb707-1553"><a href="simulace4.html#cb707-1553" tabindex="-1"></a>  </span>
<span id="cb707-1554"><a href="simulace4.html#cb707-1554" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-1555"><a href="simulace4.html#cb707-1555" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-1556"><a href="simulace4.html#cb707-1556" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb707-1557"><a href="simulace4.html#cb707-1557" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb707-1558"><a href="simulace4.html#cb707-1558" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb707-1559"><a href="simulace4.html#cb707-1559" tabindex="-1"></a>  </span>
<span id="cb707-1560"><a href="simulace4.html#cb707-1560" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1561"><a href="simulace4.html#cb707-1561" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-1562"><a href="simulace4.html#cb707-1562" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-1563"><a href="simulace4.html#cb707-1563" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb707-1564"><a href="simulace4.html#cb707-1564" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb707-1565"><a href="simulace4.html#cb707-1565" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb707-1566"><a href="simulace4.html#cb707-1566" tabindex="-1"></a>  </span>
<span id="cb707-1567"><a href="simulace4.html#cb707-1567" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb707-1568"><a href="simulace4.html#cb707-1568" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb707-1569"><a href="simulace4.html#cb707-1569" tabindex="-1"></a>  </span>
<span id="cb707-1570"><a href="simulace4.html#cb707-1570" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-1571"><a href="simulace4.html#cb707-1571" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-1572"><a href="simulace4.html#cb707-1572" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb707-1573"><a href="simulace4.html#cb707-1573" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb707-1574"><a href="simulace4.html#cb707-1574" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1575"><a href="simulace4.html#cb707-1575" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb707-1576"><a href="simulace4.html#cb707-1576" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb707-1577"><a href="simulace4.html#cb707-1577" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb707-1578"><a href="simulace4.html#cb707-1578" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb707-1579"><a href="simulace4.html#cb707-1579" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1580"><a href="simulace4.html#cb707-1580" tabindex="-1"></a>  </span>
<span id="cb707-1581"><a href="simulace4.html#cb707-1581" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-1582"><a href="simulace4.html#cb707-1582" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1583"><a href="simulace4.html#cb707-1583" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb707-1584"><a href="simulace4.html#cb707-1584" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb707-1585"><a href="simulace4.html#cb707-1585" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb707-1586"><a href="simulace4.html#cb707-1586" tabindex="-1"></a>    </span>
<span id="cb707-1587"><a href="simulace4.html#cb707-1587" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb707-1588"><a href="simulace4.html#cb707-1588" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-1589"><a href="simulace4.html#cb707-1589" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-1590"><a href="simulace4.html#cb707-1590" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-1591"><a href="simulace4.html#cb707-1591" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb707-1592"><a href="simulace4.html#cb707-1592" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb707-1593"><a href="simulace4.html#cb707-1593" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb707-1594"><a href="simulace4.html#cb707-1594" tabindex="-1"></a>    </span>
<span id="cb707-1595"><a href="simulace4.html#cb707-1595" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb707-1596"><a href="simulace4.html#cb707-1596" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1597"><a href="simulace4.html#cb707-1597" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-1598"><a href="simulace4.html#cb707-1598" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-1599"><a href="simulace4.html#cb707-1599" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-1600"><a href="simulace4.html#cb707-1600" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb707-1601"><a href="simulace4.html#cb707-1601" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-1602"><a href="simulace4.html#cb707-1602" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb707-1603"><a href="simulace4.html#cb707-1603" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb707-1604"><a href="simulace4.html#cb707-1604" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb707-1605"><a href="simulace4.html#cb707-1605" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb707-1606"><a href="simulace4.html#cb707-1606" tabindex="-1"></a>    }</span>
<span id="cb707-1607"><a href="simulace4.html#cb707-1607" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb707-1608"><a href="simulace4.html#cb707-1608" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb707-1609"><a href="simulace4.html#cb707-1609" tabindex="-1"></a>    </span>
<span id="cb707-1610"><a href="simulace4.html#cb707-1610" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb707-1611"><a href="simulace4.html#cb707-1611" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-1612"><a href="simulace4.html#cb707-1612" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-1613"><a href="simulace4.html#cb707-1613" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb707-1614"><a href="simulace4.html#cb707-1614" tabindex="-1"></a>    </span>
<span id="cb707-1615"><a href="simulace4.html#cb707-1615" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-1616"><a href="simulace4.html#cb707-1616" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1617"><a href="simulace4.html#cb707-1617" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-1618"><a href="simulace4.html#cb707-1618" tabindex="-1"></a>    }</span>
<span id="cb707-1619"><a href="simulace4.html#cb707-1619" tabindex="-1"></a>    </span>
<span id="cb707-1620"><a href="simulace4.html#cb707-1620" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb707-1621"><a href="simulace4.html#cb707-1621" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb707-1622"><a href="simulace4.html#cb707-1622" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb707-1623"><a href="simulace4.html#cb707-1623" tabindex="-1"></a>  </span>
<span id="cb707-1624"><a href="simulace4.html#cb707-1624" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1625"><a href="simulace4.html#cb707-1625" tabindex="-1"></a>  </span>
<span id="cb707-1626"><a href="simulace4.html#cb707-1626" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-1627"><a href="simulace4.html#cb707-1627" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb707-1628"><a href="simulace4.html#cb707-1628" tabindex="-1"></a>    </span>
<span id="cb707-1629"><a href="simulace4.html#cb707-1629" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-1630"><a href="simulace4.html#cb707-1630" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-1631"><a href="simulace4.html#cb707-1631" tabindex="-1"></a>    </span>
<span id="cb707-1632"><a href="simulace4.html#cb707-1632" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1633"><a href="simulace4.html#cb707-1633" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-1634"><a href="simulace4.html#cb707-1634" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1635"><a href="simulace4.html#cb707-1635" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1636"><a href="simulace4.html#cb707-1636" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1637"><a href="simulace4.html#cb707-1637" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1638"><a href="simulace4.html#cb707-1638" tabindex="-1"></a>    </span>
<span id="cb707-1639"><a href="simulace4.html#cb707-1639" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1640"><a href="simulace4.html#cb707-1640" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb707-1641"><a href="simulace4.html#cb707-1641" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-1642"><a href="simulace4.html#cb707-1642" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1643"><a href="simulace4.html#cb707-1643" tabindex="-1"></a>      </span>
<span id="cb707-1644"><a href="simulace4.html#cb707-1644" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-1645"><a href="simulace4.html#cb707-1645" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-1646"><a href="simulace4.html#cb707-1646" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1647"><a href="simulace4.html#cb707-1647" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1648"><a href="simulace4.html#cb707-1648" tabindex="-1"></a>    </span>
<span id="cb707-1649"><a href="simulace4.html#cb707-1649" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1650"><a href="simulace4.html#cb707-1650" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb707-1651"><a href="simulace4.html#cb707-1651" tabindex="-1"></a>  }</span>
<span id="cb707-1652"><a href="simulace4.html#cb707-1652" tabindex="-1"></a>  </span>
<span id="cb707-1653"><a href="simulace4.html#cb707-1653" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-1654"><a href="simulace4.html#cb707-1654" tabindex="-1"></a></span>
<span id="cb707-1655"><a href="simulace4.html#cb707-1655" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb707-1656"><a href="simulace4.html#cb707-1656" tabindex="-1"></a>  </span>
<span id="cb707-1657"><a href="simulace4.html#cb707-1657" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb707-1658"><a href="simulace4.html#cb707-1658" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb707-1659"><a href="simulace4.html#cb707-1659" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb707-1660"><a href="simulace4.html#cb707-1660" tabindex="-1"></a>  }</span>
<span id="cb707-1661"><a href="simulace4.html#cb707-1661" tabindex="-1"></a>  </span>
<span id="cb707-1662"><a href="simulace4.html#cb707-1662" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb707-1663"><a href="simulace4.html#cb707-1663" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb707-1664"><a href="simulace4.html#cb707-1664" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb707-1665"><a href="simulace4.html#cb707-1665" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb707-1666"><a href="simulace4.html#cb707-1666" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb707-1667"><a href="simulace4.html#cb707-1667" tabindex="-1"></a>      }</span>
<span id="cb707-1668"><a href="simulace4.html#cb707-1668" tabindex="-1"></a>    }</span>
<span id="cb707-1669"><a href="simulace4.html#cb707-1669" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb707-1670"><a href="simulace4.html#cb707-1670" tabindex="-1"></a>  }</span>
<span id="cb707-1671"><a href="simulace4.html#cb707-1671" tabindex="-1"></a>  </span>
<span id="cb707-1672"><a href="simulace4.html#cb707-1672" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-1673"><a href="simulace4.html#cb707-1673" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-1674"><a href="simulace4.html#cb707-1674" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-1675"><a href="simulace4.html#cb707-1675" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-1676"><a href="simulace4.html#cb707-1676" tabindex="-1"></a>  </span>
<span id="cb707-1677"><a href="simulace4.html#cb707-1677" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb707-1678"><a href="simulace4.html#cb707-1678" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb707-1679"><a href="simulace4.html#cb707-1679" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb707-1680"><a href="simulace4.html#cb707-1680" tabindex="-1"></a>  </span>
<span id="cb707-1681"><a href="simulace4.html#cb707-1681" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-1682"><a href="simulace4.html#cb707-1682" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-1683"><a href="simulace4.html#cb707-1683" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb707-1684"><a href="simulace4.html#cb707-1684" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb707-1685"><a href="simulace4.html#cb707-1685" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb707-1686"><a href="simulace4.html#cb707-1686" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb707-1687"><a href="simulace4.html#cb707-1687" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb707-1688"><a href="simulace4.html#cb707-1688" tabindex="-1"></a>  </span>
<span id="cb707-1689"><a href="simulace4.html#cb707-1689" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-1690"><a href="simulace4.html#cb707-1690" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1691"><a href="simulace4.html#cb707-1691" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1692"><a href="simulace4.html#cb707-1692" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1693"><a href="simulace4.html#cb707-1693" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1694"><a href="simulace4.html#cb707-1694" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1695"><a href="simulace4.html#cb707-1695" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb707-1696"><a href="simulace4.html#cb707-1696" tabindex="-1"></a>  </span>
<span id="cb707-1697"><a href="simulace4.html#cb707-1697" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb707-1698"><a href="simulace4.html#cb707-1698" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb707-1699"><a href="simulace4.html#cb707-1699" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb707-1700"><a href="simulace4.html#cb707-1700" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-1701"><a href="simulace4.html#cb707-1701" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-1702"><a href="simulace4.html#cb707-1702" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-1703"><a href="simulace4.html#cb707-1703" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb707-1704"><a href="simulace4.html#cb707-1704" tabindex="-1"></a>    </span>
<span id="cb707-1705"><a href="simulace4.html#cb707-1705" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb707-1706"><a href="simulace4.html#cb707-1706" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1707"><a href="simulace4.html#cb707-1707" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-1708"><a href="simulace4.html#cb707-1708" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-1709"><a href="simulace4.html#cb707-1709" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-1710"><a href="simulace4.html#cb707-1710" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb707-1711"><a href="simulace4.html#cb707-1711" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-1712"><a href="simulace4.html#cb707-1712" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb707-1713"><a href="simulace4.html#cb707-1713" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1714"><a href="simulace4.html#cb707-1714" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb707-1715"><a href="simulace4.html#cb707-1715" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb707-1716"><a href="simulace4.html#cb707-1716" tabindex="-1"></a>    }</span>
<span id="cb707-1717"><a href="simulace4.html#cb707-1717" tabindex="-1"></a>    </span>
<span id="cb707-1718"><a href="simulace4.html#cb707-1718" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb707-1719"><a href="simulace4.html#cb707-1719" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb707-1720"><a href="simulace4.html#cb707-1720" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-1721"><a href="simulace4.html#cb707-1721" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-1722"><a href="simulace4.html#cb707-1722" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb707-1723"><a href="simulace4.html#cb707-1723" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-1724"><a href="simulace4.html#cb707-1724" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1725"><a href="simulace4.html#cb707-1725" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb707-1726"><a href="simulace4.html#cb707-1726" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-1727"><a href="simulace4.html#cb707-1727" tabindex="-1"></a>      }</span>
<span id="cb707-1728"><a href="simulace4.html#cb707-1728" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb707-1729"><a href="simulace4.html#cb707-1729" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-1730"><a href="simulace4.html#cb707-1730" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-1731"><a href="simulace4.html#cb707-1731" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-1732"><a href="simulace4.html#cb707-1732" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb707-1733"><a href="simulace4.html#cb707-1733" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb707-1734"><a href="simulace4.html#cb707-1734" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb707-1735"><a href="simulace4.html#cb707-1735" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1736"><a href="simulace4.html#cb707-1736" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb707-1737"><a href="simulace4.html#cb707-1737" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb707-1738"><a href="simulace4.html#cb707-1738" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb707-1739"><a href="simulace4.html#cb707-1739" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1740"><a href="simulace4.html#cb707-1740" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-1741"><a href="simulace4.html#cb707-1741" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1742"><a href="simulace4.html#cb707-1742" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1743"><a href="simulace4.html#cb707-1743" tabindex="-1"></a>        </span>
<span id="cb707-1744"><a href="simulace4.html#cb707-1744" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-1745"><a href="simulace4.html#cb707-1745" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb707-1746"><a href="simulace4.html#cb707-1746" tabindex="-1"></a>          </span>
<span id="cb707-1747"><a href="simulace4.html#cb707-1747" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-1748"><a href="simulace4.html#cb707-1748" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb707-1749"><a href="simulace4.html#cb707-1749" tabindex="-1"></a>          </span>
<span id="cb707-1750"><a href="simulace4.html#cb707-1750" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1751"><a href="simulace4.html#cb707-1751" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-1752"><a href="simulace4.html#cb707-1752" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1753"><a href="simulace4.html#cb707-1753" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1754"><a href="simulace4.html#cb707-1754" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1755"><a href="simulace4.html#cb707-1755" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1756"><a href="simulace4.html#cb707-1756" tabindex="-1"></a>          </span>
<span id="cb707-1757"><a href="simulace4.html#cb707-1757" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1758"><a href="simulace4.html#cb707-1758" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-1759"><a href="simulace4.html#cb707-1759" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1760"><a href="simulace4.html#cb707-1760" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1761"><a href="simulace4.html#cb707-1761" tabindex="-1"></a>          </span>
<span id="cb707-1762"><a href="simulace4.html#cb707-1762" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1763"><a href="simulace4.html#cb707-1763" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb707-1764"><a href="simulace4.html#cb707-1764" tabindex="-1"></a>        }</span>
<span id="cb707-1765"><a href="simulace4.html#cb707-1765" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb707-1766"><a href="simulace4.html#cb707-1766" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb707-1767"><a href="simulace4.html#cb707-1767" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1768"><a href="simulace4.html#cb707-1768" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb707-1769"><a href="simulace4.html#cb707-1769" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb707-1770"><a href="simulace4.html#cb707-1770" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1771"><a href="simulace4.html#cb707-1771" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb707-1772"><a href="simulace4.html#cb707-1772" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb707-1773"><a href="simulace4.html#cb707-1773" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-1774"><a href="simulace4.html#cb707-1774" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb707-1775"><a href="simulace4.html#cb707-1775" tabindex="-1"></a>      }</span>
<span id="cb707-1776"><a href="simulace4.html#cb707-1776" tabindex="-1"></a>    }</span>
<span id="cb707-1777"><a href="simulace4.html#cb707-1777" tabindex="-1"></a>  }</span>
<span id="cb707-1778"><a href="simulace4.html#cb707-1778" tabindex="-1"></a>  </span>
<span id="cb707-1779"><a href="simulace4.html#cb707-1779" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb707-1780"><a href="simulace4.html#cb707-1780" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb707-1781"><a href="simulace4.html#cb707-1781" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb707-1782"><a href="simulace4.html#cb707-1782" tabindex="-1"></a>  }</span>
<span id="cb707-1783"><a href="simulace4.html#cb707-1783" tabindex="-1"></a>  </span>
<span id="cb707-1784"><a href="simulace4.html#cb707-1784" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb707-1785"><a href="simulace4.html#cb707-1785" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb707-1786"><a href="simulace4.html#cb707-1786" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb707-1787"><a href="simulace4.html#cb707-1787" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb707-1788"><a href="simulace4.html#cb707-1788" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb707-1789"><a href="simulace4.html#cb707-1789" tabindex="-1"></a>  </span>
<span id="cb707-1790"><a href="simulace4.html#cb707-1790" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-1791"><a href="simulace4.html#cb707-1791" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-1792"><a href="simulace4.html#cb707-1792" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb707-1793"><a href="simulace4.html#cb707-1793" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb707-1794"><a href="simulace4.html#cb707-1794" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb707-1795"><a href="simulace4.html#cb707-1795" tabindex="-1"></a>  </span>
<span id="cb707-1796"><a href="simulace4.html#cb707-1796" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-1797"><a href="simulace4.html#cb707-1797" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-1798"><a href="simulace4.html#cb707-1798" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-1799"><a href="simulace4.html#cb707-1799" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb707-1800"><a href="simulace4.html#cb707-1800" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb707-1801"><a href="simulace4.html#cb707-1801" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb707-1802"><a href="simulace4.html#cb707-1802" tabindex="-1"></a>  </span>
<span id="cb707-1803"><a href="simulace4.html#cb707-1803" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb707-1804"><a href="simulace4.html#cb707-1804" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb707-1805"><a href="simulace4.html#cb707-1805" tabindex="-1"></a>  </span>
<span id="cb707-1806"><a href="simulace4.html#cb707-1806" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-1807"><a href="simulace4.html#cb707-1807" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-1808"><a href="simulace4.html#cb707-1808" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb707-1809"><a href="simulace4.html#cb707-1809" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb707-1810"><a href="simulace4.html#cb707-1810" tabindex="-1"></a>  </span>
<span id="cb707-1811"><a href="simulace4.html#cb707-1811" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1812"><a href="simulace4.html#cb707-1812" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb707-1813"><a href="simulace4.html#cb707-1813" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb707-1814"><a href="simulace4.html#cb707-1814" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb707-1815"><a href="simulace4.html#cb707-1815" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb707-1816"><a href="simulace4.html#cb707-1816" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1817"><a href="simulace4.html#cb707-1817" tabindex="-1"></a>  </span>
<span id="cb707-1818"><a href="simulace4.html#cb707-1818" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-1819"><a href="simulace4.html#cb707-1819" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1820"><a href="simulace4.html#cb707-1820" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb707-1821"><a href="simulace4.html#cb707-1821" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb707-1822"><a href="simulace4.html#cb707-1822" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb707-1823"><a href="simulace4.html#cb707-1823" tabindex="-1"></a>    </span>
<span id="cb707-1824"><a href="simulace4.html#cb707-1824" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb707-1825"><a href="simulace4.html#cb707-1825" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-1826"><a href="simulace4.html#cb707-1826" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-1827"><a href="simulace4.html#cb707-1827" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-1828"><a href="simulace4.html#cb707-1828" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb707-1829"><a href="simulace4.html#cb707-1829" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb707-1830"><a href="simulace4.html#cb707-1830" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb707-1831"><a href="simulace4.html#cb707-1831" tabindex="-1"></a>    </span>
<span id="cb707-1832"><a href="simulace4.html#cb707-1832" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb707-1833"><a href="simulace4.html#cb707-1833" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1834"><a href="simulace4.html#cb707-1834" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-1835"><a href="simulace4.html#cb707-1835" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-1836"><a href="simulace4.html#cb707-1836" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-1837"><a href="simulace4.html#cb707-1837" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb707-1838"><a href="simulace4.html#cb707-1838" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-1839"><a href="simulace4.html#cb707-1839" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb707-1840"><a href="simulace4.html#cb707-1840" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1841"><a href="simulace4.html#cb707-1841" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb707-1842"><a href="simulace4.html#cb707-1842" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb707-1843"><a href="simulace4.html#cb707-1843" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb707-1844"><a href="simulace4.html#cb707-1844" tabindex="-1"></a>    }</span>
<span id="cb707-1845"><a href="simulace4.html#cb707-1845" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb707-1846"><a href="simulace4.html#cb707-1846" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb707-1847"><a href="simulace4.html#cb707-1847" tabindex="-1"></a>    </span>
<span id="cb707-1848"><a href="simulace4.html#cb707-1848" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb707-1849"><a href="simulace4.html#cb707-1849" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-1850"><a href="simulace4.html#cb707-1850" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-1851"><a href="simulace4.html#cb707-1851" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb707-1852"><a href="simulace4.html#cb707-1852" tabindex="-1"></a>    </span>
<span id="cb707-1853"><a href="simulace4.html#cb707-1853" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-1854"><a href="simulace4.html#cb707-1854" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1855"><a href="simulace4.html#cb707-1855" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-1856"><a href="simulace4.html#cb707-1856" tabindex="-1"></a>    }</span>
<span id="cb707-1857"><a href="simulace4.html#cb707-1857" tabindex="-1"></a>    </span>
<span id="cb707-1858"><a href="simulace4.html#cb707-1858" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb707-1859"><a href="simulace4.html#cb707-1859" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb707-1860"><a href="simulace4.html#cb707-1860" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb707-1861"><a href="simulace4.html#cb707-1861" tabindex="-1"></a>  </span>
<span id="cb707-1862"><a href="simulace4.html#cb707-1862" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1863"><a href="simulace4.html#cb707-1863" tabindex="-1"></a>  </span>
<span id="cb707-1864"><a href="simulace4.html#cb707-1864" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-1865"><a href="simulace4.html#cb707-1865" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb707-1866"><a href="simulace4.html#cb707-1866" tabindex="-1"></a>    </span>
<span id="cb707-1867"><a href="simulace4.html#cb707-1867" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-1868"><a href="simulace4.html#cb707-1868" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-1869"><a href="simulace4.html#cb707-1869" tabindex="-1"></a>    </span>
<span id="cb707-1870"><a href="simulace4.html#cb707-1870" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1871"><a href="simulace4.html#cb707-1871" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-1872"><a href="simulace4.html#cb707-1872" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1873"><a href="simulace4.html#cb707-1873" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1874"><a href="simulace4.html#cb707-1874" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1875"><a href="simulace4.html#cb707-1875" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1876"><a href="simulace4.html#cb707-1876" tabindex="-1"></a>    </span>
<span id="cb707-1877"><a href="simulace4.html#cb707-1877" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-1878"><a href="simulace4.html#cb707-1878" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb707-1879"><a href="simulace4.html#cb707-1879" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-1880"><a href="simulace4.html#cb707-1880" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1881"><a href="simulace4.html#cb707-1881" tabindex="-1"></a>      </span>
<span id="cb707-1882"><a href="simulace4.html#cb707-1882" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-1883"><a href="simulace4.html#cb707-1883" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-1884"><a href="simulace4.html#cb707-1884" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1885"><a href="simulace4.html#cb707-1885" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1886"><a href="simulace4.html#cb707-1886" tabindex="-1"></a>    </span>
<span id="cb707-1887"><a href="simulace4.html#cb707-1887" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1888"><a href="simulace4.html#cb707-1888" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb707-1889"><a href="simulace4.html#cb707-1889" tabindex="-1"></a>  }</span>
<span id="cb707-1890"><a href="simulace4.html#cb707-1890" tabindex="-1"></a>  </span>
<span id="cb707-1891"><a href="simulace4.html#cb707-1891" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-1892"><a href="simulace4.html#cb707-1892" tabindex="-1"></a>  </span>
<span id="cb707-1893"><a href="simulace4.html#cb707-1893" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb707-1894"><a href="simulace4.html#cb707-1894" tabindex="-1"></a>  </span>
<span id="cb707-1895"><a href="simulace4.html#cb707-1895" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb707-1896"><a href="simulace4.html#cb707-1896" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb707-1897"><a href="simulace4.html#cb707-1897" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb707-1898"><a href="simulace4.html#cb707-1898" tabindex="-1"></a>  }</span>
<span id="cb707-1899"><a href="simulace4.html#cb707-1899" tabindex="-1"></a>  </span>
<span id="cb707-1900"><a href="simulace4.html#cb707-1900" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb707-1901"><a href="simulace4.html#cb707-1901" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb707-1902"><a href="simulace4.html#cb707-1902" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb707-1903"><a href="simulace4.html#cb707-1903" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb707-1904"><a href="simulace4.html#cb707-1904" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb707-1905"><a href="simulace4.html#cb707-1905" tabindex="-1"></a>      }</span>
<span id="cb707-1906"><a href="simulace4.html#cb707-1906" tabindex="-1"></a>    }</span>
<span id="cb707-1907"><a href="simulace4.html#cb707-1907" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb707-1908"><a href="simulace4.html#cb707-1908" tabindex="-1"></a>  }</span>
<span id="cb707-1909"><a href="simulace4.html#cb707-1909" tabindex="-1"></a>  </span>
<span id="cb707-1910"><a href="simulace4.html#cb707-1910" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb707-1911"><a href="simulace4.html#cb707-1911" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb707-1912"><a href="simulace4.html#cb707-1912" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-1913"><a href="simulace4.html#cb707-1913" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-1914"><a href="simulace4.html#cb707-1914" tabindex="-1"></a>  </span>
<span id="cb707-1915"><a href="simulace4.html#cb707-1915" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb707-1916"><a href="simulace4.html#cb707-1916" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">5</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb707-1917"><a href="simulace4.html#cb707-1917" tabindex="-1"></a>  </span>
<span id="cb707-1918"><a href="simulace4.html#cb707-1918" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb707-1919"><a href="simulace4.html#cb707-1919" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb707-1920"><a href="simulace4.html#cb707-1920" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb707-1921"><a href="simulace4.html#cb707-1921" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb707-1922"><a href="simulace4.html#cb707-1922" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb707-1923"><a href="simulace4.html#cb707-1923" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb707-1924"><a href="simulace4.html#cb707-1924" tabindex="-1"></a>  </span>
<span id="cb707-1925"><a href="simulace4.html#cb707-1925" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb707-1926"><a href="simulace4.html#cb707-1926" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1927"><a href="simulace4.html#cb707-1927" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1928"><a href="simulace4.html#cb707-1928" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1929"><a href="simulace4.html#cb707-1929" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb707-1930"><a href="simulace4.html#cb707-1930" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb707-1931"><a href="simulace4.html#cb707-1931" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb707-1932"><a href="simulace4.html#cb707-1932" tabindex="-1"></a>  </span>
<span id="cb707-1933"><a href="simulace4.html#cb707-1933" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb707-1934"><a href="simulace4.html#cb707-1934" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb707-1935"><a href="simulace4.html#cb707-1935" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-1936"><a href="simulace4.html#cb707-1936" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-1937"><a href="simulace4.html#cb707-1937" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-1938"><a href="simulace4.html#cb707-1938" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb707-1939"><a href="simulace4.html#cb707-1939" tabindex="-1"></a>  </span>
<span id="cb707-1940"><a href="simulace4.html#cb707-1940" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb707-1941"><a href="simulace4.html#cb707-1941" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1942"><a href="simulace4.html#cb707-1942" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-1943"><a href="simulace4.html#cb707-1943" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-1944"><a href="simulace4.html#cb707-1944" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-1945"><a href="simulace4.html#cb707-1945" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb707-1946"><a href="simulace4.html#cb707-1946" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-1947"><a href="simulace4.html#cb707-1947" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb707-1948"><a href="simulace4.html#cb707-1948" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb707-1949"><a href="simulace4.html#cb707-1949" tabindex="-1"></a>  }</span>
<span id="cb707-1950"><a href="simulace4.html#cb707-1950" tabindex="-1"></a>  </span>
<span id="cb707-1951"><a href="simulace4.html#cb707-1951" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb707-1952"><a href="simulace4.html#cb707-1952" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb707-1953"><a href="simulace4.html#cb707-1953" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-1954"><a href="simulace4.html#cb707-1954" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-1955"><a href="simulace4.html#cb707-1955" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb707-1956"><a href="simulace4.html#cb707-1956" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-1957"><a href="simulace4.html#cb707-1957" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-1958"><a href="simulace4.html#cb707-1958" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb707-1959"><a href="simulace4.html#cb707-1959" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-1960"><a href="simulace4.html#cb707-1960" tabindex="-1"></a>    }</span>
<span id="cb707-1961"><a href="simulace4.html#cb707-1961" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb707-1962"><a href="simulace4.html#cb707-1962" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb707-1963"><a href="simulace4.html#cb707-1963" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb707-1964"><a href="simulace4.html#cb707-1964" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb707-1965"><a href="simulace4.html#cb707-1965" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb707-1966"><a href="simulace4.html#cb707-1966" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb707-1967"><a href="simulace4.html#cb707-1967" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb707-1968"><a href="simulace4.html#cb707-1968" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-1969"><a href="simulace4.html#cb707-1969" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb707-1970"><a href="simulace4.html#cb707-1970" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb707-1971"><a href="simulace4.html#cb707-1971" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb707-1972"><a href="simulace4.html#cb707-1972" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-1973"><a href="simulace4.html#cb707-1973" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-1974"><a href="simulace4.html#cb707-1974" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-1975"><a href="simulace4.html#cb707-1975" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-1976"><a href="simulace4.html#cb707-1976" tabindex="-1"></a>      </span>
<span id="cb707-1977"><a href="simulace4.html#cb707-1977" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-1978"><a href="simulace4.html#cb707-1978" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb707-1979"><a href="simulace4.html#cb707-1979" tabindex="-1"></a>        </span>
<span id="cb707-1980"><a href="simulace4.html#cb707-1980" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-1981"><a href="simulace4.html#cb707-1981" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb707-1982"><a href="simulace4.html#cb707-1982" tabindex="-1"></a>        </span>
<span id="cb707-1983"><a href="simulace4.html#cb707-1983" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-1984"><a href="simulace4.html#cb707-1984" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-1985"><a href="simulace4.html#cb707-1985" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-1986"><a href="simulace4.html#cb707-1986" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-1987"><a href="simulace4.html#cb707-1987" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-1988"><a href="simulace4.html#cb707-1988" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-1989"><a href="simulace4.html#cb707-1989" tabindex="-1"></a>        </span>
<span id="cb707-1990"><a href="simulace4.html#cb707-1990" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb707-1991"><a href="simulace4.html#cb707-1991" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-1992"><a href="simulace4.html#cb707-1992" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-1993"><a href="simulace4.html#cb707-1993" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-1994"><a href="simulace4.html#cb707-1994" tabindex="-1"></a>        </span>
<span id="cb707-1995"><a href="simulace4.html#cb707-1995" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-1996"><a href="simulace4.html#cb707-1996" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb707-1997"><a href="simulace4.html#cb707-1997" tabindex="-1"></a>      }</span>
<span id="cb707-1998"><a href="simulace4.html#cb707-1998" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb707-1999"><a href="simulace4.html#cb707-1999" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-2000"><a href="simulace4.html#cb707-2000" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb707-2001"><a href="simulace4.html#cb707-2001" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-2002"><a href="simulace4.html#cb707-2002" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb707-2003"><a href="simulace4.html#cb707-2003" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb707-2004"><a href="simulace4.html#cb707-2004" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb707-2005"><a href="simulace4.html#cb707-2005" tabindex="-1"></a>    }</span>
<span id="cb707-2006"><a href="simulace4.html#cb707-2006" tabindex="-1"></a>  }</span>
<span id="cb707-2007"><a href="simulace4.html#cb707-2007" tabindex="-1"></a>  </span>
<span id="cb707-2008"><a href="simulace4.html#cb707-2008" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb707-2009"><a href="simulace4.html#cb707-2009" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb707-2010"><a href="simulace4.html#cb707-2010" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb707-2011"><a href="simulace4.html#cb707-2011" tabindex="-1"></a>  }</span>
<span id="cb707-2012"><a href="simulace4.html#cb707-2012" tabindex="-1"></a>  </span>
<span id="cb707-2013"><a href="simulace4.html#cb707-2013" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-2014"><a href="simulace4.html#cb707-2014" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb707-2015"><a href="simulace4.html#cb707-2015" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb707-2016"><a href="simulace4.html#cb707-2016" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb707-2017"><a href="simulace4.html#cb707-2017" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb707-2018"><a href="simulace4.html#cb707-2018" tabindex="-1"></a>  </span>
<span id="cb707-2019"><a href="simulace4.html#cb707-2019" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb707-2020"><a href="simulace4.html#cb707-2020" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb707-2021"><a href="simulace4.html#cb707-2021" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb707-2022"><a href="simulace4.html#cb707-2022" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb707-2023"><a href="simulace4.html#cb707-2023" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb707-2024"><a href="simulace4.html#cb707-2024" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb707-2025"><a href="simulace4.html#cb707-2025" tabindex="-1"></a>  </span>
<span id="cb707-2026"><a href="simulace4.html#cb707-2026" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb707-2027"><a href="simulace4.html#cb707-2027" tabindex="-1"></a>  </span>
<span id="cb707-2028"><a href="simulace4.html#cb707-2028" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb707-2029"><a href="simulace4.html#cb707-2029" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb707-2030"><a href="simulace4.html#cb707-2030" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb707-2031"><a href="simulace4.html#cb707-2031" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb707-2032"><a href="simulace4.html#cb707-2032" tabindex="-1"></a>  </span>
<span id="cb707-2033"><a href="simulace4.html#cb707-2033" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb707-2034"><a href="simulace4.html#cb707-2034" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb707-2035"><a href="simulace4.html#cb707-2035" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb707-2036"><a href="simulace4.html#cb707-2036" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb707-2037"><a href="simulace4.html#cb707-2037" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb707-2038"><a href="simulace4.html#cb707-2038" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb707-2039"><a href="simulace4.html#cb707-2039" tabindex="-1"></a>  </span>
<span id="cb707-2040"><a href="simulace4.html#cb707-2040" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb707-2041"><a href="simulace4.html#cb707-2041" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb707-2042"><a href="simulace4.html#cb707-2042" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb707-2043"><a href="simulace4.html#cb707-2043" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb707-2044"><a href="simulace4.html#cb707-2044" tabindex="-1"></a>    </span>
<span id="cb707-2045"><a href="simulace4.html#cb707-2045" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb707-2046"><a href="simulace4.html#cb707-2046" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb707-2047"><a href="simulace4.html#cb707-2047" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb707-2048"><a href="simulace4.html#cb707-2048" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb707-2049"><a href="simulace4.html#cb707-2049" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb707-2050"><a href="simulace4.html#cb707-2050" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb707-2051"><a href="simulace4.html#cb707-2051" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb707-2052"><a href="simulace4.html#cb707-2052" tabindex="-1"></a>    </span>
<span id="cb707-2053"><a href="simulace4.html#cb707-2053" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb707-2054"><a href="simulace4.html#cb707-2054" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-2055"><a href="simulace4.html#cb707-2055" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb707-2056"><a href="simulace4.html#cb707-2056" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb707-2057"><a href="simulace4.html#cb707-2057" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb707-2058"><a href="simulace4.html#cb707-2058" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb707-2059"><a href="simulace4.html#cb707-2059" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb707-2060"><a href="simulace4.html#cb707-2060" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb707-2061"><a href="simulace4.html#cb707-2061" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb707-2062"><a href="simulace4.html#cb707-2062" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb707-2063"><a href="simulace4.html#cb707-2063" tabindex="-1"></a>    }</span>
<span id="cb707-2064"><a href="simulace4.html#cb707-2064" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb707-2065"><a href="simulace4.html#cb707-2065" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb707-2066"><a href="simulace4.html#cb707-2066" tabindex="-1"></a>    </span>
<span id="cb707-2067"><a href="simulace4.html#cb707-2067" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb707-2068"><a href="simulace4.html#cb707-2068" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb707-2069"><a href="simulace4.html#cb707-2069" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb707-2070"><a href="simulace4.html#cb707-2070" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb707-2071"><a href="simulace4.html#cb707-2071" tabindex="-1"></a>    </span>
<span id="cb707-2072"><a href="simulace4.html#cb707-2072" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb707-2073"><a href="simulace4.html#cb707-2073" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb707-2074"><a href="simulace4.html#cb707-2074" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb707-2075"><a href="simulace4.html#cb707-2075" tabindex="-1"></a>    }</span>
<span id="cb707-2076"><a href="simulace4.html#cb707-2076" tabindex="-1"></a>    </span>
<span id="cb707-2077"><a href="simulace4.html#cb707-2077" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb707-2078"><a href="simulace4.html#cb707-2078" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb707-2079"><a href="simulace4.html#cb707-2079" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb707-2080"><a href="simulace4.html#cb707-2080" tabindex="-1"></a>  </span>
<span id="cb707-2081"><a href="simulace4.html#cb707-2081" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb707-2082"><a href="simulace4.html#cb707-2082" tabindex="-1"></a>  </span>
<span id="cb707-2083"><a href="simulace4.html#cb707-2083" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb707-2084"><a href="simulace4.html#cb707-2084" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb707-2085"><a href="simulace4.html#cb707-2085" tabindex="-1"></a>    </span>
<span id="cb707-2086"><a href="simulace4.html#cb707-2086" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb707-2087"><a href="simulace4.html#cb707-2087" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb707-2088"><a href="simulace4.html#cb707-2088" tabindex="-1"></a>    </span>
<span id="cb707-2089"><a href="simulace4.html#cb707-2089" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb707-2090"><a href="simulace4.html#cb707-2090" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb707-2091"><a href="simulace4.html#cb707-2091" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb707-2092"><a href="simulace4.html#cb707-2092" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb707-2093"><a href="simulace4.html#cb707-2093" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb707-2094"><a href="simulace4.html#cb707-2094" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb707-2095"><a href="simulace4.html#cb707-2095" tabindex="-1"></a>    </span>
<span id="cb707-2096"><a href="simulace4.html#cb707-2096" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb707-2097"><a href="simulace4.html#cb707-2097" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb707-2098"><a href="simulace4.html#cb707-2098" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb707-2099"><a href="simulace4.html#cb707-2099" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-2100"><a href="simulace4.html#cb707-2100" tabindex="-1"></a>      </span>
<span id="cb707-2101"><a href="simulace4.html#cb707-2101" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb707-2102"><a href="simulace4.html#cb707-2102" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb707-2103"><a href="simulace4.html#cb707-2103" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb707-2104"><a href="simulace4.html#cb707-2104" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb707-2105"><a href="simulace4.html#cb707-2105" tabindex="-1"></a>    </span>
<span id="cb707-2106"><a href="simulace4.html#cb707-2106" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb707-2107"><a href="simulace4.html#cb707-2107" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb707-2108"><a href="simulace4.html#cb707-2108" tabindex="-1"></a>  }</span>
<span id="cb707-2109"><a href="simulace4.html#cb707-2109" tabindex="-1"></a>  </span>
<span id="cb707-2110"><a href="simulace4.html#cb707-2110" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb707-2111"><a href="simulace4.html#cb707-2111" tabindex="-1"></a>  </span>
<span id="cb707-2112"><a href="simulace4.html#cb707-2112" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb707-2113"><a href="simulace4.html#cb707-2113" tabindex="-1"></a>  </span>
<span id="cb707-2114"><a href="simulace4.html#cb707-2114" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb707-2115"><a href="simulace4.html#cb707-2115" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb707-2116"><a href="simulace4.html#cb707-2116" tabindex="-1"></a>  </span>
<span id="cb707-2117"><a href="simulace4.html#cb707-2117" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb707-2118"><a href="simulace4.html#cb707-2118" tabindex="-1"></a>}</span>
<span id="cb707-2119"><a href="simulace4.html#cb707-2119" tabindex="-1"></a></span>
<span id="cb707-2120"><a href="simulace4.html#cb707-2120" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb707-2121"><a href="simulace4.html#cb707-2121" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/simulace_04_2der_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Now we will calculate the average test and training error rates for each classification method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb708"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb708-1"><a href="simulace4.html#cb708-1" tabindex="-1"></a><span class="co"># Prepare the final table</span></span>
<span id="cb708-2"><a href="simulace4.html#cb708-2" tabindex="-1"></a></span>
<span id="cb708-3"><a href="simulace4.html#cb708-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb708-4"><a href="simulace4.html#cb708-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb708-5"><a href="simulace4.html#cb708-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb708-6"><a href="simulace4.html#cb708-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb708-7"><a href="simulace4.html#cb708-7" tabindex="-1"></a></span>
<span id="cb708-8"><a href="simulace4.html#cb708-8" tabindex="-1"></a><span class="co"># Save the final values</span></span>
<span id="cb708-9"><a href="simulace4.html#cb708-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/simulace_04_res_2der_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="results-2" class="section level4 hasAnchor" number="5.2.4.1">
<h4><span class="header-section-number">5.2.4.1</span> Results<a href="simulace4.html#results-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<table>
<caption><span id="tab:unnamed-chunk-273">Table 5.16: </span>Summary results of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> represents the estimated training error, <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error, <span class="math inline">\(\widehat{SD}_{train}\)</span> the standard deviation estimate of training errors, and <span class="math inline">\(\widehat{SD}_{test}\)</span> the standard deviation estimate of test errors.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.1722</td>
<td align="right">0.1863</td>
<td align="right">0.0521</td>
<td align="right">0.0745</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.1544</td>
<td align="right">0.1687</td>
<td align="right">0.0639</td>
<td align="right">0.0839</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.1487</td>
<td align="right">0.1740</td>
<td align="right">0.0638</td>
<td align="right">0.0842</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0506</td>
<td align="right">0.0982</td>
<td align="right">0.0304</td>
<td align="right">0.0412</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.1532</td>
<td align="right">0.1697</td>
<td align="right">0.0643</td>
<td align="right">0.0825</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.1040</td>
<td align="right">0.1448</td>
<td align="right">0.0532</td>
<td align="right">0.0782</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.1603</td>
<td align="right">0.2182</td>
<td align="right">0.0497</td>
<td align="right">0.0768</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.1021</td>
<td align="right">0.1478</td>
<td align="right">0.0396</td>
<td align="right">0.0747</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0109</td>
<td align="right">0.1360</td>
<td align="right">0.0074</td>
<td align="right">0.0660</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0318</td>
<td align="right">0.1873</td>
<td align="right">0.0203</td>
<td align="right">0.0902</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0094</td>
<td align="right">0.1323</td>
<td align="right">0.0065</td>
<td align="right">0.0679</td>
</tr>
<tr class="even">
<td>SVM linear - func</td>
<td align="right">0.0652</td>
<td align="right">0.1097</td>
<td align="right">0.0282</td>
<td align="right">0.0447</td>
</tr>
<tr class="odd">
<td>SVM poly - func</td>
<td align="right">0.0546</td>
<td align="right">0.1548</td>
<td align="right">0.0445</td>
<td align="right">0.0679</td>
</tr>
<tr class="even">
<td>SVM rbf - func</td>
<td align="right">0.0607</td>
<td align="right">0.1092</td>
<td align="right">0.0297</td>
<td align="right">0.0391</td>
</tr>
<tr class="odd">
<td>SVM linear - diskr</td>
<td align="right">0.0622</td>
<td align="right">0.1108</td>
<td align="right">0.0289</td>
<td align="right">0.0407</td>
</tr>
<tr class="even">
<td>SVM poly - diskr</td>
<td align="right">0.0589</td>
<td align="right">0.1538</td>
<td align="right">0.0453</td>
<td align="right">0.0668</td>
</tr>
<tr class="odd">
<td>SVM rbf - diskr</td>
<td align="right">0.0584</td>
<td align="right">0.1155</td>
<td align="right">0.0344</td>
<td align="right">0.0437</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.1522</td>
<td align="right">0.1712</td>
<td align="right">0.0626</td>
<td align="right">0.0819</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.1398</td>
<td align="right">0.1783</td>
<td align="right">0.0647</td>
<td align="right">0.0830</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.1440</td>
<td align="right">0.1740</td>
<td align="right">0.0636</td>
<td align="right">0.0832</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0518</td>
<td align="right">0.0925</td>
<td align="right">0.0264</td>
<td align="right">0.0397</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.0513</td>
<td align="right">0.1373</td>
<td align="right">0.0388</td>
<td align="right">0.0667</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0647</td>
<td align="right">0.1080</td>
<td align="right">0.0367</td>
<td align="right">0.0539</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.0767</td>
<td align="right">0.1107</td>
<td align="right">0.0303</td>
<td align="right">0.0415</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0529</td>
<td align="right">0.1418</td>
<td align="right">0.0304</td>
<td align="right">0.0586</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.0754</td>
<td align="right">0.1420</td>
<td align="right">0.0433</td>
<td align="right">0.0596</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0684</td>
<td align="right">0.1180</td>
<td align="right">0.0288</td>
<td align="right">0.0463</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0474</td>
<td align="right">0.1483</td>
<td align="right">0.0328</td>
<td align="right">0.0538</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0610</td>
<td align="right">0.1420</td>
<td align="right">0.0294</td>
<td align="right">0.0572</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0746</td>
<td align="right">0.1620</td>
<td align="right">0.0389</td>
<td align="right">0.0600</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0457</td>
<td align="right">0.1640</td>
<td align="right">0.0297</td>
<td align="right">0.0599</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0864</td>
<td align="right">0.1573</td>
<td align="right">0.0336</td>
<td align="right">0.0633</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.1181</td>
<td align="right">0.2080</td>
<td align="right">0.0505</td>
<td align="right">0.0714</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.0742</td>
<td align="right">0.2150</td>
<td align="right">0.0442</td>
<td align="right">0.0744</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.1126</td>
<td align="right">0.2012</td>
<td align="right">0.0439</td>
<td align="right">0.0696</td>
</tr>
</tbody>
</table>
<p>The table above presents all the calculated metrics, including the standard deviations, to allow comparison of the stability or variability of each method.</p>
<p>Finally, we can visually display the calculated values from the simulation for each classification method using box plots, separately for training and testing errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb709"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb709-1"><a href="simulace4.html#cb709-1" tabindex="-1"></a><span class="co"># for training data</span></span>
<span id="cb709-2"><a href="simulace4.html#cb709-2" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb709-3"><a href="simulace4.html#cb709-3" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb709-4"><a href="simulace4.html#cb709-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb709-5"><a href="simulace4.html#cb709-5" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb709-6"><a href="simulace4.html#cb709-6" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb709-7"><a href="simulace4.html#cb709-7" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb709-8"><a href="simulace4.html#cb709-8" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb709-9"><a href="simulace4.html#cb709-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb709-10"><a href="simulace4.html#cb709-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb709-11"><a href="simulace4.html#cb709-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb709-12"><a href="simulace4.html#cb709-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb709-13"><a href="simulace4.html#cb709-13" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb709-14"><a href="simulace4.html#cb709-14" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb709-15"><a href="simulace4.html#cb709-15" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb709-16"><a href="simulace4.html#cb709-16" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb709-17"><a href="simulace4.html#cb709-17" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb709-18"><a href="simulace4.html#cb709-18" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb709-19"><a href="simulace4.html#cb709-19" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-274"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-274-1.png" alt="Box plots of training errors for 100 simulations for each classification method. Black symbols $+$ indicate means." width="672" />
<p class="caption">
Figure 5.41: Box plots of training errors for 100 simulations for each classification method. Black symbols <span class="math inline">\(+\)</span> indicate means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb710"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb710-1"><a href="simulace4.html#cb710-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb710-2"><a href="simulace4.html#cb710-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb710-3"><a href="simulace4.html#cb710-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb710-4"><a href="simulace4.html#cb710-4" tabindex="-1"></a>      <span class="st">&#39;Linear discriminant analysis&#39;</span>,</span>
<span id="cb710-5"><a href="simulace4.html#cb710-5" tabindex="-1"></a>      <span class="st">&#39;Quadratic discriminant analysis&#39;</span>,</span>
<span id="cb710-6"><a href="simulace4.html#cb710-6" tabindex="-1"></a>      <span class="st">&#39;Functional logistic regression&#39;</span>,</span>
<span id="cb710-7"><a href="simulace4.html#cb710-7" tabindex="-1"></a>      <span class="st">&#39;Logistic regression with fPCA&#39;</span>,</span>
<span id="cb710-8"><a href="simulace4.html#cb710-8" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- discretization&#39;</span>,</span>
<span id="cb710-9"><a href="simulace4.html#cb710-9" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- fPCA&#39;</span>,</span>
<span id="cb710-10"><a href="simulace4.html#cb710-10" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- basis coefficients&#39;</span>,</span>
<span id="cb710-11"><a href="simulace4.html#cb710-11" tabindex="-1"></a>      <span class="st">&#39;Random forest -- discretization&#39;</span>,</span>
<span id="cb710-12"><a href="simulace4.html#cb710-12" tabindex="-1"></a>      <span class="st">&#39;Random forest -- fPCA&#39;</span>,</span>
<span id="cb710-13"><a href="simulace4.html#cb710-13" tabindex="-1"></a>      <span class="st">&#39;Random forest -- basis coefficients&#39;</span>,</span>
<span id="cb710-14"><a href="simulace4.html#cb710-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- functional&#39;</span>,</span>
<span id="cb710-15"><a href="simulace4.html#cb710-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- functional&#39;</span>,</span>
<span id="cb710-16"><a href="simulace4.html#cb710-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- functional&#39;</span>,</span>
<span id="cb710-17"><a href="simulace4.html#cb710-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- discretization&#39;</span>,</span>
<span id="cb710-18"><a href="simulace4.html#cb710-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- discretization&#39;</span>,</span>
<span id="cb710-19"><a href="simulace4.html#cb710-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- discretization&#39;</span>,</span>
<span id="cb710-20"><a href="simulace4.html#cb710-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb710-21"><a href="simulace4.html#cb710-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb710-22"><a href="simulace4.html#cb710-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb710-23"><a href="simulace4.html#cb710-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- basis coefficients&#39;</span>,</span>
<span id="cb710-24"><a href="simulace4.html#cb710-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- basis coefficients&#39;</span>,</span>
<span id="cb710-25"><a href="simulace4.html#cb710-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- basis coefficients&#39;</span>,</span>
<span id="cb710-26"><a href="simulace4.html#cb710-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projection&#39;</span>,</span>
<span id="cb710-27"><a href="simulace4.html#cb710-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projection&#39;</span>,</span>
<span id="cb710-28"><a href="simulace4.html#cb710-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projection&#39;</span>,</span>
<span id="cb710-29"><a href="simulace4.html#cb710-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb710-30"><a href="simulace4.html#cb710-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb710-31"><a href="simulace4.html#cb710-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb710-32"><a href="simulace4.html#cb710-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb710-33"><a href="simulace4.html#cb710-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb710-34"><a href="simulace4.html#cb710-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb710-35"><a href="simulace4.html#cb710-35" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb710-36"><a href="simulace4.html#cb710-36" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb710-37"><a href="simulace4.html#cb710-37" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb710-38"><a href="simulace4.html#cb710-38" tabindex="-1"></a>)</span>
<span id="cb710-39"><a href="simulace4.html#cb710-39" tabindex="-1"></a></span>
<span id="cb710-40"><a href="simulace4.html#cb710-40" tabindex="-1"></a></span>
<span id="cb710-41"><a href="simulace4.html#cb710-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb710-42"><a href="simulace4.html#cb710-42" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb710-43"><a href="simulace4.html#cb710-43" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb710-44"><a href="simulace4.html#cb710-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb710-45"><a href="simulace4.html#cb710-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb710-46"><a href="simulace4.html#cb710-46" tabindex="-1"></a></span>
<span id="cb710-47"><a href="simulace4.html#cb710-47" tabindex="-1"></a><span class="co"># box_col &lt;- c(&#39;#CA0A0A&#39;, &#39;#fa2600&#39;, &#39;#fa2600&#39;, &#39;#D15804&#39;,</span></span>
<span id="cb710-48"><a href="simulace4.html#cb710-48" tabindex="-1"></a><span class="co">#              &#39;#D15804&#39;, rep(&#39;#D3006D&#39;, 3), rep(&#39;#BE090F&#39;, 3), c(&quot;#12DEE8&quot;, &quot;#4ECBF3&quot;, &quot;#127DE8&quot;, &quot;#4C3CD3&quot;, &quot;#4E65F3&quot;, &quot;#4E9EF3&quot;, &quot;#081D58&quot;) |&gt; rep(each = 3))</span></span>
<span id="cb710-49"><a href="simulace4.html#cb710-49" tabindex="-1"></a></span>
<span id="cb710-50"><a href="simulace4.html#cb710-50" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb710-51"><a href="simulace4.html#cb710-51" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb710-52"><a href="simulace4.html#cb710-52" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb710-53"><a href="simulace4.html#cb710-53" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb711"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb711-1"><a href="simulace4.html#cb711-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb711-2"><a href="simulace4.html#cb711-2" tabindex="-1"></a>methods_names1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb711-3"><a href="simulace4.html#cb711-3" tabindex="-1"></a>      <span class="st">&#39;$K$NN&#39;</span>,</span>
<span id="cb711-4"><a href="simulace4.html#cb711-4" tabindex="-1"></a>      <span class="co">#&#39;Linear Discriminant Analysis&#39;,</span></span>
<span id="cb711-5"><a href="simulace4.html#cb711-5" tabindex="-1"></a>      <span class="st">&#39;QDA&#39;</span>,</span>
<span id="cb711-6"><a href="simulace4.html#cb711-6" tabindex="-1"></a>      <span class="st">&#39;fLR&#39;</span>,</span>
<span id="cb711-7"><a href="simulace4.html#cb711-7" tabindex="-1"></a>      <span class="st">&#39;LR with fPCA&#39;</span>,</span>
<span id="cb711-8"><a href="simulace4.html#cb711-8" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Discretization&#39;,</span></span>
<span id="cb711-9"><a href="simulace4.html#cb711-9" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- fPCA&#39;,</span></span>
<span id="cb711-10"><a href="simulace4.html#cb711-10" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Basis Coefficients&#39;,</span></span>
<span id="cb711-11"><a href="simulace4.html#cb711-11" tabindex="-1"></a>      <span class="st">&#39;RF -- Discretization&#39;</span>,</span>
<span id="cb711-12"><a href="simulace4.html#cb711-12" tabindex="-1"></a>      <span class="st">&#39;RF -- fPCA&#39;</span>,</span>
<span id="cb711-13"><a href="simulace4.html#cb711-13" tabindex="-1"></a>      <span class="st">&#39;RF -- Basis Coefficients&#39;</span>,</span>
<span id="cb711-14"><a href="simulace4.html#cb711-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Functional&#39;</span>,</span>
<span id="cb711-15"><a href="simulace4.html#cb711-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Functional&#39;</span>,</span>
<span id="cb711-16"><a href="simulace4.html#cb711-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Functional&#39;</span>,</span>
<span id="cb711-17"><a href="simulace4.html#cb711-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Discretization&#39;</span>,</span>
<span id="cb711-18"><a href="simulace4.html#cb711-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Discretization&#39;</span>,</span>
<span id="cb711-19"><a href="simulace4.html#cb711-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Discretization&#39;</span>,</span>
<span id="cb711-20"><a href="simulace4.html#cb711-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb711-21"><a href="simulace4.html#cb711-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb711-22"><a href="simulace4.html#cb711-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb711-23"><a href="simulace4.html#cb711-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Basis Coefficients&#39;</span>,</span>
<span id="cb711-24"><a href="simulace4.html#cb711-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Basis Coefficients&#39;</span>,</span>
<span id="cb711-25"><a href="simulace4.html#cb711-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Basis Coefficients&#39;</span>,</span>
<span id="cb711-26"><a href="simulace4.html#cb711-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Projection&#39;</span>,</span>
<span id="cb711-27"><a href="simulace4.html#cb711-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Projection&#39;</span>,</span>
<span id="cb711-28"><a href="simulace4.html#cb711-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Projection&#39;</span>,</span>
<span id="cb711-29"><a href="simulace4.html#cb711-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb711-30"><a href="simulace4.html#cb711-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb711-31"><a href="simulace4.html#cb711-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (radial)&#39;</span><span class="co">#,</span></span>
<span id="cb711-32"><a href="simulace4.html#cb711-32" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (linear)&#39;,</span></span>
<span id="cb711-33"><a href="simulace4.html#cb711-33" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (poly)&#39;,</span></span>
<span id="cb711-34"><a href="simulace4.html#cb711-34" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (radial)&#39;#,</span></span>
<span id="cb711-35"><a href="simulace4.html#cb711-35" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (linear)&#39;,</span></span>
<span id="cb711-36"><a href="simulace4.html#cb711-36" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (poly)&#39;,</span></span>
<span id="cb711-37"><a href="simulace4.html#cb711-37" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb711-38"><a href="simulace4.html#cb711-38" tabindex="-1"></a>)</span>
<span id="cb711-39"><a href="simulace4.html#cb711-39" tabindex="-1"></a></span>
<span id="cb711-40"><a href="simulace4.html#cb711-40" tabindex="-1"></a></span>
<span id="cb711-41"><a href="simulace4.html#cb711-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb711-42"><a href="simulace4.html#cb711-42" tabindex="-1"></a>box_col1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,  <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb711-43"><a href="simulace4.html#cb711-43" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb711-44"><a href="simulace4.html#cb711-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb711-45"><a href="simulace4.html#cb711-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">3</span>))</span>
<span id="cb711-46"><a href="simulace4.html#cb711-46" tabindex="-1"></a></span>
<span id="cb711-47"><a href="simulace4.html#cb711-47" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb711-48"><a href="simulace4.html#cb711-48" tabindex="-1"></a>box_alpha1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb711-49"><a href="simulace4.html#cb711-49" tabindex="-1"></a>               <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>), <span class="dv">6</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb712"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb712-1"><a href="simulace4.html#cb712-1" tabindex="-1"></a><span class="co"># for testing data</span></span>
<span id="cb712-2"><a href="simulace4.html#cb712-2" tabindex="-1"></a>sub_methods <span class="ot">&lt;-</span> methods[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">29</span>)]</span>
<span id="cb712-3"><a href="simulace4.html#cb712-3" tabindex="-1"></a></span>
<span id="cb712-4"><a href="simulace4.html#cb712-4" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb712-5"><a href="simulace4.html#cb712-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb712-6"><a href="simulace4.html#cb712-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb712-7"><a href="simulace4.html#cb712-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb712-8"><a href="simulace4.html#cb712-8" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> sub_methods) <span class="sc">|&gt;</span> </span>
<span id="cb712-9"><a href="simulace4.html#cb712-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span> </span>
<span id="cb712-10"><a href="simulace4.html#cb712-10" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb712-11"><a href="simulace4.html#cb712-11" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb712-12"><a href="simulace4.html#cb712-12" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb712-13"><a href="simulace4.html#cb712-13" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb712-14"><a href="simulace4.html#cb712-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb712-15"><a href="simulace4.html#cb712-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb712-16"><a href="simulace4.html#cb712-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$</span><span class="sc">\\</span><span class="st">widehat{</span><span class="sc">\\</span><span class="st">textnormal{Err}}_{test}$&quot;</span></span>
<span id="cb712-17"><a href="simulace4.html#cb712-17" tabindex="-1"></a>       <span class="co"># y = expression(widehat(Err)[test])</span></span>
<span id="cb712-18"><a href="simulace4.html#cb712-18" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb712-19"><a href="simulace4.html#cb712-19" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb712-20"><a href="simulace4.html#cb712-20" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">35</span>, <span class="at">hjust =</span> <span class="dv">1</span>),</span>
<span id="cb712-21"><a href="simulace4.html#cb712-21" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb712-22"><a href="simulace4.html#cb712-22" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb712-23"><a href="simulace4.html#cb712-23" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb712-24"><a href="simulace4.html#cb712-24" tabindex="-1"></a>  <span class="fu">scale_x_discrete</span>(<span class="at">labels =</span> methods_names1) <span class="sc">+</span></span>
<span id="cb712-25"><a href="simulace4.html#cb712-25" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>)) <span class="sc">+</span></span>
<span id="cb712-26"><a href="simulace4.html#cb712-26" tabindex="-1"></a>  <span class="fu">scale_fill_manual</span>(<span class="at">values =</span> box_col1) <span class="sc">+</span></span>
<span id="cb712-27"><a href="simulace4.html#cb712-27" tabindex="-1"></a>  <span class="fu">scale_alpha_manual</span>(<span class="at">values =</span> box_alpha1) <span class="sc">+</span></span>
<span id="cb712-28"><a href="simulace4.html#cb712-28" tabindex="-1"></a>  <span class="fu">coord_cartesian</span>(<span class="at">ylim =</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.4</span>)) <span class="sc">+</span></span>
<span id="cb712-29"><a href="simulace4.html#cb712-29" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb712-30"><a href="simulace4.html#cb712-30" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;gray20&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-278"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-278-1.png" alt="Box plots of testing errors for 100 simulations for each classification method. Black symbols $+$ indicate means." width="672" />
<p class="caption">
Figure 5.42: Box plots of testing errors for 100 simulations for each classification method. Black symbols <span class="math inline">\(+\)</span> indicate means.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb713"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb713-1"><a href="simulace4.html#cb713-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_04_boxplot_test_2der_new.tex&quot;, device = tikz, width = 7, height = 5)</span></span>
<span id="cb713-2"><a href="simulace4.html#cb713-2" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_04_boxplot_test_2der_subset.tex&quot;, device = tikz, width = 6.5, height = 5)</span></span></code></pre></div>
</details>
<p>We would now like to formally test whether some classification methods are better than others based on the previous simulation on these data or if we can consider them equally successful. Since the assumption of normality is not met, we cannot use the classical paired t-test. Instead, we will use its non-parametric alternative—the paired Wilcoxon test. However, we must be cautious with interpretation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb714"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb714-1"><a href="simulace4.html#cb714-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - Bbasis&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;g&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.06283692</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb716"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb716-1"><a href="simulace4.html#cb716-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;l&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.003970501</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb718"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb718-1"><a href="simulace4.html#cb718-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - Bbasis&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;g&#39;</span>, <span class="at">paired =</span> T)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 1.367196e-05</code></pre>
<p>We test at an adjusted significance level <span class="math inline">\(\alpha_{adj} = 0.05 / 3 = 0.0167\)</span>.</p>
<p>Finally, let’s take a look at which hyperparameter values were the most common choices.</p>
<table>
<caption><span id="tab:unnamed-chunk-281">Table 5.17: </span>Medians of hyperparameter values for selected methods where a hyperparameter was determined using cross-validation.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Median Hyperparameter Value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">9.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">3.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">9.5</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">12.0</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">11.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">100.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">10.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">10.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">20.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">25.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">15.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">27.5</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">20.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">25.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb720"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb720-1"><a href="simulace4.html#cb720-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb720-2"><a href="simulace4.html#cb720-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb720-3"><a href="simulace4.html#cb720-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb720-4"><a href="simulace4.html#cb720-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb720-5"><a href="simulace4.html#cb720-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb720-6"><a href="simulace4.html#cb720-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb720-7"><a href="simulace4.html#cb720-7" tabindex="-1"></a></span>
<span id="cb720-8"><a href="simulace4.html#cb720-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb720-9"><a href="simulace4.html#cb720-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb720-10"><a href="simulace4.html#cb720-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb720-11"><a href="simulace4.html#cb720-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb720-12"><a href="simulace4.html#cb720-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb720-13"><a href="simulace4.html#cb720-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb720-14"><a href="simulace4.html#cb720-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb720-15"><a href="simulace4.html#cb720-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb720-16"><a href="simulace4.html#cb720-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb720-17"><a href="simulace4.html#cb720-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-282"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-282-1.png" alt="Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components." width="672" />
<p class="caption">
Figure 5.43: Histograms of hyperparameter values for KNN, functional logistic regression, and also a histogram for the number of principal components.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb721"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb721-1"><a href="simulace4.html#cb721-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb721-2"><a href="simulace4.html#cb721-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb721-3"><a href="simulace4.html#cb721-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb721-4"><a href="simulace4.html#cb721-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb721-5"><a href="simulace4.html#cb721-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb721-6"><a href="simulace4.html#cb721-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb721-7"><a href="simulace4.html#cb721-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb721-8"><a href="simulace4.html#cb721-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb721-9"><a href="simulace4.html#cb721-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb721-10"><a href="simulace4.html#cb721-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-284"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-284-1.png" alt="Histograms of hyperparameter values for the SVM method with projection onto B-spline basis." width="672" />
<p class="caption">
Figure 5.44: Histograms of hyperparameter values for the SVM method with projection onto B-spline basis.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb722"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb722-1"><a href="simulace4.html#cb722-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb722-2"><a href="simulace4.html#cb722-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb722-3"><a href="simulace4.html#cb722-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb722-4"><a href="simulace4.html#cb722-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb722-5"><a href="simulace4.html#cb722-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb722-6"><a href="simulace4.html#cb722-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb722-7"><a href="simulace4.html#cb722-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb722-8"><a href="simulace4.html#cb722-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb722-9"><a href="simulace4.html#cb722-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb722-10"><a href="simulace4.html#cb722-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb722-11"><a href="simulace4.html#cb722-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb722-12"><a href="simulace4.html#cb722-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-286"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-286-1.png" alt="Histograms of hyperparameter values for the RKHS + SVM with radial kernel method." width="672" />
<p class="caption">
Figure 5.45: Histograms of hyperparameter values for the RKHS + SVM with radial kernel method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb723"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb723-1"><a href="simulace4.html#cb723-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb723-2"><a href="simulace4.html#cb723-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb723-3"><a href="simulace4.html#cb723-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb723-4"><a href="simulace4.html#cb723-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb723-5"><a href="simulace4.html#cb723-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb723-6"><a href="simulace4.html#cb723-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb723-7"><a href="simulace4.html#cb723-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb723-8"><a href="simulace4.html#cb723-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb723-9"><a href="simulace4.html#cb723-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb723-10"><a href="simulace4.html#cb723-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb723-11"><a href="simulace4.html#cb723-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb723-12"><a href="simulace4.html#cb723-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-288"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-288-1.png" alt="Histograms of hyperparameter values for the RKHS + SVM with polynomial kernel method." width="672" />
<p class="caption">
Figure 5.46: Histograms of hyperparameter values for the RKHS + SVM with polynomial kernel method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb724"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb724-1"><a href="simulace4.html#cb724-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb724-2"><a href="simulace4.html#cb724-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb724-3"><a href="simulace4.html#cb724-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb724-4"><a href="simulace4.html#cb724-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb724-5"><a href="simulace4.html#cb724-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb724-6"><a href="simulace4.html#cb724-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb724-7"><a href="simulace4.html#cb724-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb724-8"><a href="simulace4.html#cb724-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb724-9"><a href="simulace4.html#cb724-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb724-10"><a href="simulace4.html#cb724-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb724-11"><a href="simulace4.html#cb724-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-290"></span>
<img src="05-Simulace_deriv2_files/figure-html/unnamed-chunk-290-1.png" alt="Histograms of hyperparameter values for the RKHS + SVM with linear kernel method." width="672" />
<p class="caption">
Figure 5.47: Histograms of hyperparameter values for the RKHS + SVM with linear kernel method.
</p>
</div>
<p>Let’s finally compare the best classifiers from each derivative, namely the linear SVM applied to the coefficients of orthogonal projection onto the B-spline function system for the non-derivative data (error rate of <span class="math inline">\(9.55\,\%\)</span>) and applied to the basis coefficients for the first (error rate of <span class="math inline">\(9.58\,\%\)</span>) and second (error rate of <span class="math inline">\(9.32\,\%\)</span>) derivatives.</p>
<p>Since in all three simulation studies we set the pseudorandom number generator to the same value, the generated discrete vectors <span class="math inline">\(\boldsymbol y_i\)</span> and their distribution into sets <span class="math inline">\(\mathcal T_1\)</span> and <span class="math inline">\(\mathcal T_2\)</span> are identical for the given repetition out of the total <span class="math inline">\(N=100\)</span>. Therefore, to compare the medians of the test error rates of the most successful methods, we will again use the Wilcoxon paired test.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb725"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb725-1"><a href="simulace4.html#cb725-1" tabindex="-1"></a><span class="co"># First, we load data from all simulations</span></span>
<span id="cb725-2"><a href="simulace4.html#cb725-2" tabindex="-1"></a></span>
<span id="cb725-3"><a href="simulace4.html#cb725-3" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;RData/simulace_03_cv.RData&#39;</span>, <span class="at">verbose =</span> F)</span>
<span id="cb725-4"><a href="simulace4.html#cb725-4" tabindex="-1"></a>data_0der <span class="ot">&lt;-</span> SIMULACE</span>
<span id="cb725-5"><a href="simulace4.html#cb725-5" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;RData/simulace_04_cv.RData&#39;</span>, <span class="at">verbose =</span> F)</span>
<span id="cb725-6"><a href="simulace4.html#cb725-6" tabindex="-1"></a>data_1der <span class="ot">&lt;-</span> SIMULACE</span>
<span id="cb725-7"><a href="simulace4.html#cb725-7" tabindex="-1"></a><span class="fu">load</span>(<span class="st">&#39;RData/simulace_04_2der_cv.RData&#39;</span>, <span class="at">verbose =</span> F)</span>
<span id="cb725-8"><a href="simulace4.html#cb725-8" tabindex="-1"></a>data_2der <span class="ot">&lt;-</span> SIMULACE</span></code></pre></div>
</details>
<p>Let’s check that we have loaded the correct data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb726"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb726-1"><a href="simulace4.html#cb726-1" tabindex="-1"></a><span class="fu">mean</span>(data_0der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - projection</span><span class="st">`</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.09316667</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb728"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb728-1"><a href="simulace4.html#cb728-1" tabindex="-1"></a><span class="fu">mean</span>(data_1der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.1</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb730"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb730-1"><a href="simulace4.html#cb730-1" tabindex="-1"></a><span class="fu">mean</span>(data_2der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>)</span></code></pre></div>
</details>
<pre><code>## [1] 0.0925</code></pre>
<p>Finally, we will conduct formal tests.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb732"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb732-1"><a href="simulace4.html#cb732-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(data_0der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - projection</span><span class="st">`</span>, data_1der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>, <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="co">#$p.value</span></span></code></pre></div>
</details>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  data_0der$test$`SVM linear - projection` and data_1der$test$`SVM linear - Bbasis`
## V = 1939, p-value = 0.2058
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb734"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb734-1"><a href="simulace4.html#cb734-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(data_0der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - projection</span><span class="st">`</span>, data_2der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>, <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="co">#$p.value</span></span></code></pre></div>
</details>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  data_0der$test$`SVM linear - projection` and data_2der$test$`SVM linear - Bbasis`
## V = 1866.5, p-value = 0.988
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb736"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb736-1"><a href="simulace4.html#cb736-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(data_1der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>, data_2der<span class="sc">$</span>test<span class="sc">$</span><span class="st">`</span><span class="at">SVM linear - Bbasis</span><span class="st">`</span>, <span class="at">alternative =</span> <span class="st">&#39;t&#39;</span>, <span class="at">paired =</span> T)<span class="co">#$p.value</span></span></code></pre></div>
</details>
<pre><code>## 
##  Wilcoxon signed rank test with continuity correction
## 
## data:  data_1der$test$`SVM linear - Bbasis` and data_2der$test$`SVM linear - Bbasis`
## V = 2424, p-value = 0.1902
## alternative hypothesis: true location shift is not equal to 0</code></pre>
<p>We see that all three <span class="math inline">\(p\)</span>-values are significantly above the significance level of 0.05 (and even after adjustment), so we can conclude that the classification power of these methods is comparable.</p>

</div>
</div>
</div>
</div>



            </section>

          </div>
        </div>
      </div>
<a href="simulace3diskr.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="aplikace3.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/05-Simulace_deriv2.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
