<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 1 Classification of simulated curves | Functional classification with vertical differences using SVM</title>
  <meta name="description" content="Chapter 1 Classification of simulated curves | Functional classification with vertical differences using SVM" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 1 Classification of simulated curves | Functional classification with vertical differences using SVM" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 1 Classification of simulated curves | Functional classification with vertical differences using SVM" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2024-11-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="index.html"/>
<link rel="next" href="simulace3sigma.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Functional classification with vertical differences using SVM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace3" class="section level1 hasAnchor" number="1">
<h1><span class="header-section-number">Chapter 1</span> Classification of simulated curves<a href="simulace3.html#simulace3" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<div id="simulation-of-functional-data" class="section level2 hasAnchor" number="1.1">
<h2><span class="header-section-number">1.1</span> Simulation of Functional Data<a href="simulace3.html#simulation-of-functional-data" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we simulate functions that we will subsequently classify.
For simplicity, we will consider two classification classes.
For the simulation, we will first:</p>
<ul>
<li><p>choose appropriate functions,</p></li>
<li><p>generate points from a selected interval, which contain, for example, Gaussian noise,</p></li>
<li><p>smooth these obtained discrete points into a functional object form using a suitable basis system.</p></li>
</ul>
<p>Through this process, we obtain functional objects along with the value of a categorical variable <span class="math inline">\(Y\)</span>, which distinguishes membership in the classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="simulace3.html#cb1-1" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb1-2"><a href="simulace3.html#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb1-3"><a href="simulace3.html#cb1-3" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb1-4"><a href="simulace3.html#cb1-4" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb1-5"><a href="simulace3.html#cb1-5" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb1-6"><a href="simulace3.html#cb1-6" tabindex="-1"></a><span class="fu">library</span>(polynom)</span>
<span id="cb1-7"><a href="simulace3.html#cb1-7" tabindex="-1"></a></span>
<span id="cb1-8"><a href="simulace3.html#cb1-8" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Let us consider two classification classes, <span class="math inline">\(Y \in \{0, 1\}\)</span>, with the same number <code>n</code> of generated functions for each class.
First, let’s define two functions, each corresponding to one class.
We will consider the functions on the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<p>Now, we will create the functions using interpolation polynomials. First, we define the points through which our curve should pass, and then we fit an interpolation polynomial through them, which we use to generate curves for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="simulace3.html#cb2-1" tabindex="-1"></a><span class="co"># defining points for class 0</span></span>
<span id="cb2-2"><a href="simulace3.html#cb2-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.65</span>, <span class="fl">0.94</span>, <span class="fl">1.42</span>, <span class="fl">2.26</span>, <span class="fl">2.84</span>, <span class="fl">3.73</span>, <span class="fl">4.50</span>, <span class="fl">5.43</span>, <span class="fl">6.00</span>)</span>
<span id="cb2-3"><a href="simulace3.html#cb2-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.86</span>, <span class="fl">1.49</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.36</span>, <span class="fl">0.23</span>, <span class="dv">0</span>)</span>
<span id="cb2-4"><a href="simulace3.html#cb2-4" tabindex="-1"></a></span>
<span id="cb2-5"><a href="simulace3.html#cb2-5" tabindex="-1"></a><span class="co"># defining points for class 1</span></span>
<span id="cb2-6"><a href="simulace3.html#cb2-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.51</span>, <span class="fl">0.91</span>, <span class="fl">1.25</span>, <span class="fl">1.51</span>, <span class="fl">2.14</span>, <span class="fl">2.43</span>, <span class="fl">2.96</span>, <span class="fl">3.70</span>, <span class="fl">4.60</span>,</span>
<span id="cb2-7"><a href="simulace3.html#cb2-7" tabindex="-1"></a>         <span class="fl">5.25</span>, <span class="fl">5.67</span>, <span class="fl">6.00</span>)</span>
<span id="cb2-8"><a href="simulace3.html#cb2-8" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.71</span>, <span class="fl">1.08</span>, <span class="fl">1.47</span>, <span class="fl">1.39</span>, <span class="fl">0.81</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb2-9"><a href="simulace3.html#cb2-9" tabindex="-1"></a>         <span class="fl">0.3</span>, <span class="fl">0.37</span>, <span class="dv">0</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="simulace3.html#cb3-1" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb3-2"><a href="simulace3.html#cb3-2" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb3-3"><a href="simulace3.html#cb3-3" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb3-4"><a href="simulace3.html#cb3-4" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb3-5"><a href="simulace3.html#cb3-5" tabindex="-1"></a></span>
<span id="cb3-6"><a href="simulace3.html#cb3-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb3-7"><a href="simulace3.html#cb3-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb3-8"><a href="simulace3.html#cb3-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb3-9"><a href="simulace3.html#cb3-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb3-10"><a href="simulace3.html#cb3-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb3-11"><a href="simulace3.html#cb3-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-3-1.png" alt="Points defining interpolation polynomials for both classification classes." width="672" />
<p class="caption">
Figure 1.1: Points defining interpolation polynomials for both classification classes.
</p>
</div>
<p>To compute the interpolation polynomials, we will use the <code>poly.calc()</code> function from the <code>polynom</code> library. Next, we define the functions <code>poly.0()</code> and <code>poly.1()</code>, which will calculate the polynomial values at a given point in the interval. We use the <code>predict()</code> function to create them, where we input the respective polynomial and the point at which we want to evaluate the polynomial.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="simulace3.html#cb4-1" tabindex="-1"></a>polynom<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>)</span>
<span id="cb4-2"><a href="simulace3.html#cb4-2" tabindex="-1"></a>polynom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="simulace3.html#cb5-1" tabindex="-1"></a>poly<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.0</span>, x))</span>
<span id="cb5-2"><a href="simulace3.html#cb5-2" tabindex="-1"></a>poly<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.1</span>, x))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="simulace3.html#cb6-1" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x<span class="fl">.0</span>), <span class="fu">max</span>(x<span class="fl">.0</span>), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb6-2"><a href="simulace3.html#cb6-2" tabindex="-1"></a>yy<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.0</span>(xx)</span>
<span id="cb6-3"><a href="simulace3.html#cb6-3" tabindex="-1"></a>yy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.1</span>(xx)</span>
<span id="cb6-4"><a href="simulace3.html#cb6-4" tabindex="-1"></a></span>
<span id="cb6-5"><a href="simulace3.html#cb6-5" tabindex="-1"></a>dat_poly_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(xx, xx),</span>
<span id="cb6-6"><a href="simulace3.html#cb6-6" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(yy<span class="fl">.0</span>, yy<span class="fl">.1</span>),</span>
<span id="cb6-7"><a href="simulace3.html#cb6-7" tabindex="-1"></a>                            <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb6-8"><a href="simulace3.html#cb6-8" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="fu">length</span>(xx), <span class="fu">length</span>(xx))))</span>
<span id="cb6-9"><a href="simulace3.html#cb6-9" tabindex="-1"></a></span>
<span id="cb6-10"><a href="simulace3.html#cb6-10" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb6-11"><a href="simulace3.html#cb6-11" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb6-12"><a href="simulace3.html#cb6-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb6-13"><a href="simulace3.html#cb6-13" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_plot,</span>
<span id="cb6-14"><a href="simulace3.html#cb6-14" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class),</span>
<span id="cb6-15"><a href="simulace3.html#cb6-15" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb6-16"><a href="simulace3.html#cb6-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb6-17"><a href="simulace3.html#cb6-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb6-18"><a href="simulace3.html#cb6-18" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-6-1.png" alt="Visualization of two functions on the interval $I = [0, 6]$, from which we generate observations for classes 0 and 1." width="672" />
<p class="caption">
Figure 1.2: Visualization of two functions on the interval <span class="math inline">\(I = [0, 6]\)</span>, from which we generate observations for classes 0 and 1.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="simulace3.html#cb7-1" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> poly<span class="fl">.0</span></span>
<span id="cb7-2"><a href="simulace3.html#cb7-2" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> poly<span class="fl">.1</span></span></code></pre></div>
</details>
<p>Now we will create a function to generate random functions with added noise (i.e., points on a predefined grid) from a chosen generating function.
The argument <code>t</code> represents the vector of values at which we want to evaluate the given functions, <code>fun</code> denotes the generating function, <code>n</code> is the number of functions, and <code>sigma</code> is the standard deviation <span class="math inline">\(\sigma\)</span> of the normal distribution <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>, from which we randomly generate Gaussian white noise with <span class="math inline">\(\mu = 0\)</span>.
To demonstrate the advantage of using methods that work with functional data, we will add a random term to each simulated observation during generation, representing a vertical shift of the entire function (parameter <code>sigma_shift</code>).
This shift will be generated from a normal distribution with the parameter <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="simulace3.html#cb8-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb8-2"><a href="simulace3.html#cb8-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb8-3"><a href="simulace3.html#cb8-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb8-4"><a href="simulace3.html#cb8-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb8-5"><a href="simulace3.html#cb8-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb8-6"><a href="simulace3.html#cb8-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb8-7"><a href="simulace3.html#cb8-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb8-8"><a href="simulace3.html#cb8-8" tabindex="-1"></a>  </span>
<span id="cb8-9"><a href="simulace3.html#cb8-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb8-10"><a href="simulace3.html#cb8-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb8-11"><a href="simulace3.html#cb8-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb8-12"><a href="simulace3.html#cb8-12" tabindex="-1"></a>  </span>
<span id="cb8-13"><a href="simulace3.html#cb8-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-14"><a href="simulace3.html#cb8-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb8-15"><a href="simulace3.html#cb8-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb8-16"><a href="simulace3.html#cb8-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb8-17"><a href="simulace3.html#cb8-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb8-18"><a href="simulace3.html#cb8-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fun</span>(X) <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb8-19"><a href="simulace3.html#cb8-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can generate the functions. In each of the two classes, we will consider 100 observations, so <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="simulace3.html#cb9-1" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb9-2"><a href="simulace3.html#cb9-2" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb9-3"><a href="simulace3.html#cb9-3" tabindex="-1"></a></span>
<span id="cb9-4"><a href="simulace3.html#cb9-4" tabindex="-1"></a><span class="co"># Y = 0</span></span>
<span id="cb9-5"><a href="simulace3.html#cb9-5" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb9-6"><a href="simulace3.html#cb9-6" tabindex="-1"></a><span class="co"># Y = 1</span></span>
<span id="cb9-7"><a href="simulace3.html#cb9-7" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (not yet smoothed) functions in color according to their class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="simulace3.html#cb10-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> </span>
<span id="cb10-2"><a href="simulace3.html#cb10-2" tabindex="-1"></a></span>
<span id="cb10-3"><a href="simulace3.html#cb10-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb10-4"><a href="simulace3.html#cb10-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-5"><a href="simulace3.html#cb10-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-6"><a href="simulace3.html#cb10-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb10-7"><a href="simulace3.html#cb10-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-8"><a href="simulace3.html#cb10-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb10-9"><a href="simulace3.html#cb10-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb10-10"><a href="simulace3.html#cb10-10" tabindex="-1"></a>  )</span>
<span id="cb10-11"><a href="simulace3.html#cb10-11" tabindex="-1"></a></span>
<span id="cb10-12"><a href="simulace3.html#cb10-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb10-13"><a href="simulace3.html#cb10-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb10-14"><a href="simulace3.html#cb10-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb10-15"><a href="simulace3.html#cb10-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb10-16"><a href="simulace3.html#cb10-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb10-17"><a href="simulace3.html#cb10-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb10-18"><a href="simulace3.html#cb10-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb10-19"><a href="simulace3.html#cb10-19" tabindex="-1"></a>  )</span>
<span id="cb10-20"><a href="simulace3.html#cb10-20" tabindex="-1"></a></span>
<span id="cb10-21"><a href="simulace3.html#cb10-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb10-22"><a href="simulace3.html#cb10-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb10-23"><a href="simulace3.html#cb10-23" tabindex="-1"></a></span>
<span id="cb10-24"><a href="simulace3.html#cb10-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb10-25"><a href="simulace3.html#cb10-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb10-26"><a href="simulace3.html#cb10-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb10-27"><a href="simulace3.html#cb10-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb10-28"><a href="simulace3.html#cb10-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb10-29"><a href="simulace3.html#cb10-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb10-30"><a href="simulace3.html#cb10-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb10-31"><a href="simulace3.html#cb10-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-10-1.png" alt="The first 10 generated observations from each of the two classification classes. The observed data are not smoothed." width="672" />
<p class="caption">
Figure 1.3: The first 10 generated observations from each of the two classification classes. The observed data are not smoothed.
</p>
</div>
</div>
<div id="smoothing-observed-curves" class="section level2 hasAnchor" number="1.2">
<h2><span class="header-section-number">1.2</span> Smoothing Observed Curves<a href="simulace3.html#smoothing-observed-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will convert the observed discrete values (vectors of values) into functional objects that we will work with subsequently.
We will again use a B-spline basis for smoothing.</p>
<p>We take the entire vector <code>t</code> as the knots, and since we are considering cubic splines, we choose (the implicit choice in <code>R</code>) <code>norder = 4</code>.
We will penalize the second derivative of the functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="simulace3.html#cb11-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb11-2"><a href="simulace3.html#cb11-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb11-3"><a href="simulace3.html#cb11-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb11-4"><a href="simulace3.html#cb11-4" tabindex="-1"></a></span>
<span id="cb11-5"><a href="simulace3.html#cb11-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb11-6"><a href="simulace3.html#cb11-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb11-7"><a href="simulace3.html#cb11-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb11-8"><a href="simulace3.html#cb11-8" tabindex="-1"></a></span>
<span id="cb11-9"><a href="simulace3.html#cb11-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span></code></pre></div>
</details>
<p>We will find a suitable value for the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, which stands for generalized cross-validation. We will consider the same value of <span class="math inline">\(\lambda\)</span> for both classification groups, as we would not know in advance which value of <span class="math inline">\(\lambda\)</span> to choose for test observations in the case of different selections for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="simulace3.html#cb12-1" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb12-2"><a href="simulace3.html#cb12-2" tabindex="-1"></a></span>
<span id="cb12-3"><a href="simulace3.html#cb12-3" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) </span>
<span id="cb12-4"><a href="simulace3.html#cb12-4" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) </span>
<span id="cb12-5"><a href="simulace3.html#cb12-5" tabindex="-1"></a></span>
<span id="cb12-6"><a href="simulace3.html#cb12-6" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb12-7"><a href="simulace3.html#cb12-7" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb12-8"><a href="simulace3.html#cb12-8" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) </span>
<span id="cb12-9"><a href="simulace3.html#cb12-9" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) </span>
<span id="cb12-10"><a href="simulace3.html#cb12-10" tabindex="-1"></a>}</span>
<span id="cb12-11"><a href="simulace3.html#cb12-11" tabindex="-1"></a></span>
<span id="cb12-12"><a href="simulace3.html#cb12-12" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb12-13"><a href="simulace3.html#cb12-13" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb12-14"><a href="simulace3.html#cb12-14" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb12-15"><a href="simulace3.html#cb12-15" tabindex="-1"></a>)</span>
<span id="cb12-16"><a href="simulace3.html#cb12-16" tabindex="-1"></a></span>
<span id="cb12-17"><a href="simulace3.html#cb12-17" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>To better illustrate, we will plot the course of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="simulace3.html#cb13-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb13-2"><a href="simulace3.html#cb13-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb13-3"><a href="simulace3.html#cb13-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb13-4"><a href="simulace3.html#cb13-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb13-5"><a href="simulace3.html#cb13-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb13-6"><a href="simulace3.html#cb13-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb13-7"><a href="simulace3.html#cb13-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb13-8"><a href="simulace3.html#cb13-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-13-1.png" alt="The course of $GCV(\lambda)$ for the chosen vector $\boldsymbol\lambda$. The values on the $x$-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is indicated in red." width="672" />
<p class="caption">
Figure 1.4: The course of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen vector <span class="math inline">\(\boldsymbol\lambda\)</span>. The values on the <span class="math inline">\(x\)</span>-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is indicated in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically represent the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="simulace3.html#cb15-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb15-2"><a href="simulace3.html#cb15-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb15-3"><a href="simulace3.html#cb15-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb15-4"><a href="simulace3.html#cb15-4" tabindex="-1"></a></span>
<span id="cb15-5"><a href="simulace3.html#cb15-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb15-6"><a href="simulace3.html#cb15-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb15-7"><a href="simulace3.html#cb15-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb15-8"><a href="simulace3.html#cb15-8" tabindex="-1"></a></span>
<span id="cb15-9"><a href="simulace3.html#cb15-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb15-10"><a href="simulace3.html#cb15-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb15-11"><a href="simulace3.html#cb15-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb15-12"><a href="simulace3.html#cb15-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb15-13"><a href="simulace3.html#cb15-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb15-14"><a href="simulace3.html#cb15-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb15-15"><a href="simulace3.html#cb15-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb15-16"><a href="simulace3.html#cb15-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-14-1.png" alt="The first 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.5: The first 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s also illustrate all curves, including the average, separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="simulace3.html#cb16-1" tabindex="-1"></a>abs.labs <span class="ot">&lt;-</span> <span class="fu">paste</span>(<span class="st">&quot;Classification class:&quot;</span>, <span class="fu">c</span>(<span class="st">&quot;$Y = 0$&quot;</span>, <span class="st">&quot;$Y = 1$&quot;</span>))</span>
<span id="cb16-2"><a href="simulace3.html#cb16-2" tabindex="-1"></a><span class="fu">names</span>(abs.labs) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>)</span>
<span id="cb16-3"><a href="simulace3.html#cb16-3" tabindex="-1"></a></span>
<span id="cb16-4"><a href="simulace3.html#cb16-4" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb16-5"><a href="simulace3.html#cb16-5" tabindex="-1"></a></span>
<span id="cb16-6"><a href="simulace3.html#cb16-6" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-7"><a href="simulace3.html#cb16-7" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb16-8"><a href="simulace3.html#cb16-8" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb16-9"><a href="simulace3.html#cb16-9" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb16-10"><a href="simulace3.html#cb16-10" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb16-11"><a href="simulace3.html#cb16-11" tabindex="-1"></a>)</span>
<span id="cb16-12"><a href="simulace3.html#cb16-12" tabindex="-1"></a></span>
<span id="cb16-13"><a href="simulace3.html#cb16-13" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb16-14"><a href="simulace3.html#cb16-14" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb16-15"><a href="simulace3.html#cb16-15" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[<span class="dv">1</span><span class="sc">:</span>n]), <span class="at">evalarg =</span> t),</span>
<span id="cb16-16"><a href="simulace3.html#cb16-16" tabindex="-1"></a>           <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> <span class="fu">mean.fd</span>(XXfd[(n <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> n)]), <span class="at">evalarg =</span> t)),</span>
<span id="cb16-17"><a href="simulace3.html#cb16-17" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb16-18"><a href="simulace3.html#cb16-18" tabindex="-1"></a>)</span>
<span id="cb16-19"><a href="simulace3.html#cb16-19" tabindex="-1"></a></span>
<span id="cb16-20"><a href="simulace3.html#cb16-20" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="co">#group = interaction(time, group), </span></span>
<span id="cb16-21"><a href="simulace3.html#cb16-21" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb16-22"><a href="simulace3.html#cb16-22" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">group =</span> time), <span class="at">linewidth =</span> <span class="fl">0.05</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb16-23"><a href="simulace3.html#cb16-23" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb16-24"><a href="simulace3.html#cb16-24" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&quot;$t$&quot;</span>,</span>
<span id="cb16-25"><a href="simulace3.html#cb16-25" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;$x_i(t)$&quot;</span>,</span>
<span id="cb16-26"><a href="simulace3.html#cb16-26" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-27"><a href="simulace3.html#cb16-27" tabindex="-1"></a>  <span class="co"># geom_line(data = DFsmooth |&gt; </span></span>
<span id="cb16-28"><a href="simulace3.html#cb16-28" tabindex="-1"></a>  <span class="co">#             mutate(group = factor(ifelse(group == &#39;0&#39;, &#39;1&#39;, &#39;0&#39;))) |&gt; </span></span>
<span id="cb16-29"><a href="simulace3.html#cb16-29" tabindex="-1"></a>  <span class="co">#             filter(group == &#39;1&#39;),</span></span>
<span id="cb16-30"><a href="simulace3.html#cb16-30" tabindex="-1"></a>  <span class="co">#           aes(x = t, y = Mean, colour = group), </span></span>
<span id="cb16-31"><a href="simulace3.html#cb16-31" tabindex="-1"></a>  <span class="co">#           colour = &#39;tomato&#39;, linewidth = 0.8, linetype = &#39;solid&#39;) + </span></span>
<span id="cb16-32"><a href="simulace3.html#cb16-32" tabindex="-1"></a>  <span class="co"># geom_line(data = DFsmooth |&gt; </span></span>
<span id="cb16-33"><a href="simulace3.html#cb16-33" tabindex="-1"></a>  <span class="co">#             mutate(group = factor(ifelse(group == &#39;0&#39;, &#39;1&#39;, &#39;0&#39;))) |&gt; </span></span>
<span id="cb16-34"><a href="simulace3.html#cb16-34" tabindex="-1"></a>  <span class="co">#             filter(group == &#39;0&#39;),</span></span>
<span id="cb16-35"><a href="simulace3.html#cb16-35" tabindex="-1"></a>  <span class="co">#           aes(x = t, y = Mean, colour = group), </span></span>
<span id="cb16-36"><a href="simulace3.html#cb16-36" tabindex="-1"></a>  <span class="co">#           colour = &#39;deepskyblue2&#39;, linewidth = 0.8, linetype = &#39;solid&#39;) + </span></span>
<span id="cb16-37"><a href="simulace3.html#cb16-37" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean <span class="sc">|&gt;</span> </span>
<span id="cb16-38"><a href="simulace3.html#cb16-38" tabindex="-1"></a>              <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">ifelse</span>(group <span class="sc">==</span> <span class="st">&#39;0&#39;</span>, <span class="st">&#39;1&#39;</span>, <span class="st">&#39;0&#39;</span>))),</span>
<span id="cb16-39"><a href="simulace3.html#cb16-39" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb16-40"><a href="simulace3.html#cb16-40" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.8</span>, <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-41"><a href="simulace3.html#cb16-41" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> DFmean, <span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb16-42"><a href="simulace3.html#cb16-42" tabindex="-1"></a>            <span class="at">colour =</span> <span class="st">&#39;grey2&#39;</span>, <span class="at">linewidth =</span> <span class="fl">1.25</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb16-43"><a href="simulace3.html#cb16-43" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span></span>
<span id="cb16-44"><a href="simulace3.html#cb16-44" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>group, <span class="at">labeller =</span> <span class="fu">labeller</span>(<span class="at">group =</span> abs.labs)) <span class="sc">+</span></span>
<span id="cb16-45"><a href="simulace3.html#cb16-45" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.02</span>, <span class="fl">0.02</span>)) <span class="sc">+</span></span>
<span id="cb16-46"><a href="simulace3.html#cb16-46" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>) <span class="sc">+</span></span>
<span id="cb16-47"><a href="simulace3.html#cb16-47" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-15-1.png" alt="Plot of all smoothed observed curves, distinguished by color according to their classification class. The average for each class is indicated by a black line, and for the second class, it is indicated by a dashed line." width="672" />
<p class="caption">
Figure 1.6: Plot of all smoothed observed curves, distinguished by color according to their classification class. The average for each class is indicated by a black line, and for the second class, it is indicated by a dashed line.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="simulace3.html#cb17-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03_curves.tex&quot;, device = tikz, width = 8, height = 4)</span></span></code></pre></div>
</details>
<p>Now let’s take a look at the comparison of average courses from a detailed perspective.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="simulace3.html#cb18-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-2"><a href="simulace3.html#cb18-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb18-3"><a href="simulace3.html#cb18-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb18-4"><a href="simulace3.html#cb18-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb18-5"><a href="simulace3.html#cb18-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb18-6"><a href="simulace3.html#cb18-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb18-7"><a href="simulace3.html#cb18-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb18-8"><a href="simulace3.html#cb18-8" tabindex="-1"></a>)</span>
<span id="cb18-9"><a href="simulace3.html#cb18-9" tabindex="-1"></a></span>
<span id="cb18-10"><a href="simulace3.html#cb18-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb18-11"><a href="simulace3.html#cb18-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb18-12"><a href="simulace3.html#cb18-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb18-13"><a href="simulace3.html#cb18-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb18-14"><a href="simulace3.html#cb18-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb18-15"><a href="simulace3.html#cb18-15" tabindex="-1"></a>)</span>
<span id="cb18-16"><a href="simulace3.html#cb18-16" tabindex="-1"></a></span>
<span id="cb18-17"><a href="simulace3.html#cb18-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb18-18"><a href="simulace3.html#cb18-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb18-19"><a href="simulace3.html#cb18-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb18-20"><a href="simulace3.html#cb18-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb18-21"><a href="simulace3.html#cb18-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb18-22"><a href="simulace3.html#cb18-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb18-23"><a href="simulace3.html#cb18-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb18-24"><a href="simulace3.html#cb18-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb18-25"><a href="simulace3.html#cb18-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb18-26"><a href="simulace3.html#cb18-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb18-27"><a href="simulace3.html#cb18-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb18-28"><a href="simulace3.html#cb18-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb18-29"><a href="simulace3.html#cb18-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-16-1.png" alt="Plot of all smoothed observed curves, distinguished by color according to their classification class. The average for each class is indicated by a black line. A closer view." width="672" />
<p class="caption">
Figure 1.7: Plot of all smoothed observed curves, distinguished by color according to their classification class. The average for each class is indicated by a black line. A closer view.
</p>
</div>
</div>
<div id="classification-of-curves" class="section level2 hasAnchor" number="1.3">
<h2><span class="header-section-number">1.3</span> Classification of Curves<a href="simulace3.html#classification-of-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="simulace3.html#cb19-1" tabindex="-1"></a><span class="fu">library</span>(caTools) </span>
<span id="cb19-2"><a href="simulace3.html#cb19-2" tabindex="-1"></a><span class="fu">library</span>(caret) </span>
<span id="cb19-3"><a href="simulace3.html#cb19-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) </span>
<span id="cb19-4"><a href="simulace3.html#cb19-4" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb19-5"><a href="simulace3.html#cb19-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb19-6"><a href="simulace3.html#cb19-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb19-7"><a href="simulace3.html#cb19-7" tabindex="-1"></a><span class="fu">library</span>(refund)</span>
<span id="cb19-8"><a href="simulace3.html#cb19-8" tabindex="-1"></a><span class="fu">library</span>(nnet) </span>
<span id="cb19-9"><a href="simulace3.html#cb19-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb19-10"><a href="simulace3.html#cb19-10" tabindex="-1"></a><span class="fu">library</span>(rpart) </span>
<span id="cb19-11"><a href="simulace3.html#cb19-11" tabindex="-1"></a><span class="fu">library</span>(rattle) </span>
<span id="cb19-12"><a href="simulace3.html#cb19-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb19-13"><a href="simulace3.html#cb19-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) </span></code></pre></div>
</details>
<p>To compare the individual classifiers, we will split the set of generated observations into two parts in a ratio of 70:30, designating them as the training and test (validation) sets. The training set will be used for constructing the classifier, while the test set will be used to calculate the classification error and potentially other characteristics of our model. We can then compare the resulting classifiers based on these calculated characteristics in terms of their classification success.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="simulace3.html#cb20-1" tabindex="-1"></a><span class="co"># Splitting into test and training sets</span></span>
<span id="cb20-2"><a href="simulace3.html#cb20-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb20-3"><a href="simulace3.html#cb20-3" tabindex="-1"></a></span>
<span id="cb20-4"><a href="simulace3.html#cb20-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb20-5"><a href="simulace3.html#cb20-5" tabindex="-1"></a></span>
<span id="cb20-6"><a href="simulace3.html#cb20-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-7"><a href="simulace3.html#cb20-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb20-8"><a href="simulace3.html#cb20-8" tabindex="-1"></a></span>
<span id="cb20-9"><a href="simulace3.html#cb20-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb20-10"><a href="simulace3.html#cb20-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, let’s look at the representation of individual groups in the test and training portions of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="simulace3.html#cb21-1" tabindex="-1"></a><span class="co"># Absolute representation</span></span>
<span id="cb21-2"><a href="simulace3.html#cb21-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="simulace3.html#cb23-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="simulace3.html#cb25-1" tabindex="-1"></a><span class="co"># Relative representation</span></span>
<span id="cb25-2"><a href="simulace3.html#cb25-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb27-1"><a href="simulace3.html#cb27-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nearest-neighbors" class="section level3 hasAnchor" number="1.3.1">
<h3><span class="header-section-number">1.3.1</span> <span class="math inline">\(K\)</span>-Nearest Neighbors<a href="simulace3.html#k-nearest-neighbors" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with the non-parametric classification method, specifically the <span class="math inline">\(K\)</span>-nearest neighbors method. First, we will create the necessary objects so that we can work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb29-1"><a href="simulace3.html#cb29-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb29-2"><a href="simulace3.html#cb29-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and examine its classification success. However, the last question remains: how do we choose the optimal number of neighbors <span class="math inline">\(K\)</span>? We could select <span class="math inline">\(K\)</span> as the value that results in the minimum error on the training data. However, this could lead to overfitting, so we will use cross-validation. Given the computational intensity and the size of the dataset, we will choose <span class="math inline">\(k\)</span>-fold cross-validation; for example, we will set <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb30-1"><a href="simulace3.html#cb30-1" tabindex="-1"></a><span class="co"># Model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb30-2"><a href="simulace3.html#cb30-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb30-3"><a href="simulace3.html#cb30-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb30-4"><a href="simulace3.html#cb30-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb30-5"><a href="simulace3.html#cb30-5" tabindex="-1"></a></span>
<span id="cb30-6"><a href="simulace3.html#cb30-6" tabindex="-1"></a><span class="co"># neighb.model$max.prob # Maximum accuracy</span></span>
<span id="cb30-7"><a href="simulace3.html#cb30-7" tabindex="-1"></a><span class="co"># (K.opt &lt;- neighb.model$h.opt) # Optimal value of K</span></span></code></pre></div>
</details>
<p>Let’s perform the previous procedure for the training data, which we will split into <span class="math inline">\(k\)</span> parts and repeat this part of the code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb31-1"><a href="simulace3.html#cb31-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb31-2"><a href="simulace3.html#cb31-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># Number of neighbors</span></span>
<span id="cb31-3"><a href="simulace3.html#cb31-3" tabindex="-1"></a></span>
<span id="cb31-4"><a href="simulace3.html#cb31-4" tabindex="-1"></a><span class="co"># Splitting training data into k parts</span></span>
<span id="cb31-5"><a href="simulace3.html#cb31-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb31-6"><a href="simulace3.html#cb31-6" tabindex="-1"></a></span>
<span id="cb31-7"><a href="simulace3.html#cb31-7" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb31-8"><a href="simulace3.html#cb31-8" tabindex="-1"></a><span class="co"># Columns will have accuracy values for the given part of the training set</span></span>
<span id="cb31-9"><a href="simulace3.html#cb31-9" tabindex="-1"></a><span class="co"># Rows will have values for the given neighbor count K</span></span>
<span id="cb31-10"><a href="simulace3.html#cb31-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb31-11"><a href="simulace3.html#cb31-11" tabindex="-1"></a></span>
<span id="cb31-12"><a href="simulace3.html#cb31-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb31-13"><a href="simulace3.html#cb31-13" tabindex="-1"></a>  <span class="co"># Define the current index set</span></span>
<span id="cb31-14"><a href="simulace3.html#cb31-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb31-15"><a href="simulace3.html#cb31-15" tabindex="-1"></a>    </span>
<span id="cb31-16"><a href="simulace3.html#cb31-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb31-17"><a href="simulace3.html#cb31-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb31-18"><a href="simulace3.html#cb31-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb31-19"><a href="simulace3.html#cb31-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb31-20"><a href="simulace3.html#cb31-20" tabindex="-1"></a>  </span>
<span id="cb31-21"><a href="simulace3.html#cb31-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb31-22"><a href="simulace3.html#cb31-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb31-23"><a href="simulace3.html#cb31-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb31-24"><a href="simulace3.html#cb31-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb31-25"><a href="simulace3.html#cb31-25" tabindex="-1"></a>  </span>
<span id="cb31-26"><a href="simulace3.html#cb31-26" tabindex="-1"></a>  <span class="co"># Iterate through each part... repeat k times</span></span>
<span id="cb31-27"><a href="simulace3.html#cb31-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb31-28"><a href="simulace3.html#cb31-28" tabindex="-1"></a>    <span class="co"># Model for the specific choice of K</span></span>
<span id="cb31-29"><a href="simulace3.html#cb31-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb31-30"><a href="simulace3.html#cb31-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb31-31"><a href="simulace3.html#cb31-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb31-32"><a href="simulace3.html#cb31-32" tabindex="-1"></a>    <span class="co"># Prediction on the validation part</span></span>
<span id="cb31-33"><a href="simulace3.html#cb31-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb31-34"><a href="simulace3.html#cb31-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb31-35"><a href="simulace3.html#cb31-35" tabindex="-1"></a>    <span class="co"># Accuracy on the validation part</span></span>
<span id="cb31-36"><a href="simulace3.html#cb31-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb31-37"><a href="simulace3.html#cb31-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb31-38"><a href="simulace3.html#cb31-38" tabindex="-1"></a>    </span>
<span id="cb31-39"><a href="simulace3.html#cb31-39" tabindex="-1"></a>    <span class="co"># Store the accuracy in the position for the given K and fold</span></span>
<span id="cb31-40"><a href="simulace3.html#cb31-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb31-41"><a href="simulace3.html#cb31-41" tabindex="-1"></a>  }</span>
<span id="cb31-42"><a href="simulace3.html#cb31-42" tabindex="-1"></a>}</span>
<span id="cb31-43"><a href="simulace3.html#cb31-43" tabindex="-1"></a></span>
<span id="cb31-44"><a href="simulace3.html#cb31-44" tabindex="-1"></a><span class="co"># Calculate average accuracies for each K across folds</span></span>
<span id="cb31-45"><a href="simulace3.html#cb31-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb31-46"><a href="simulace3.html#cb31-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb31-47"><a href="simulace3.html#cb31-47" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb31-48"><a href="simulace3.html#cb31-48" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>We can see that the optimal value of the parameter <span class="math inline">\(K\)</span> is 5 with an error rate calculated using 10-fold CV of 0.3429. For clarity, let’s plot the validation error as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb32-1"><a href="simulace3.html#cb32-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb32-2"><a href="simulace3.html#cb32-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb32-3"><a href="simulace3.html#cb32-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb32-4"><a href="simulace3.html#cb32-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb32-5"><a href="simulace3.html#cb32-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb32-6"><a href="simulace3.html#cb32-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb32-7"><a href="simulace3.html#cb32-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb32-8"><a href="simulace3.html#cb32-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb32-9"><a href="simulace3.html#cb32-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb32-10"><a href="simulace3.html#cb32-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - accuracy.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 24 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-23-1.png" alt="Dependence of validation error on the value of $K$, i.e., on the number of neighbors." width="672" />
<p class="caption">
Figure 1.8: Dependence of validation error on the value of <span class="math inline">\(K\)</span>, i.e., on the number of neighbors.
</p>
</div>
<p>Now that we know the optimal value of the parameter <span class="math inline">\(K\)</span>, we can construct the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb34-1"><a href="simulace3.html#cb34-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb34-2"><a href="simulace3.html#cb34-2" tabindex="-1"></a></span>
<span id="cb34-3"><a href="simulace3.html#cb34-3" tabindex="-1"></a><span class="co"># Prediction</span></span>
<span id="cb34-4"><a href="simulace3.html#cb34-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb34-5"><a href="simulace3.html#cb34-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb34-6"><a href="simulace3.html#cb34-6" tabindex="-1"></a></span>
<span id="cb34-7"><a href="simulace3.html#cb34-7" tabindex="-1"></a><span class="co"># Accuracy on the test data</span></span>
<span id="cb34-8"><a href="simulace3.html#cb34-8" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb34-9"><a href="simulace3.html#cb34-9" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-10"><a href="simulace3.html#cb34-10" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb34-11"><a href="simulace3.html#cb34-11" tabindex="-1"></a>  <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we can see that the error rate of the model constructed using the <span class="math inline">\(K\)</span>-nearest neighbors method with the optimal choice <span class="math inline">\(K_{optimal}\)</span> equal to 5, which we determined via cross-validation, is 0.3571 on the training data and 0.3833 on the test data.</p>
<p>To compare the different models, we can use both types of errors. For clarity, we will store them in a table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb35-1"><a href="simulace3.html#cb35-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb35-2"><a href="simulace3.html#cb35-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb35-3"><a href="simulace3.html#cb35-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis" class="section level3 hasAnchor" number="1.3.2">
<h3><span class="header-section-number">1.3.2</span> Linear Discriminant Analysis<a href="simulace3.html#linear-discriminant-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As the second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied to functional data, we must first discretize it, which we will do using Functional Principal Component Analysis. We will then perform the classification algorithm on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components explain at least 90% of the variability in the data.</p>
<p>Let’s first perform Functional Principal Component Analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb36-1"><a href="simulace3.html#cb36-1" tabindex="-1"></a><span class="co"># Principal component analysis</span></span>
<span id="cb36-2"><a href="simulace3.html#cb36-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of principal components</span></span>
<span id="cb36-3"><a href="simulace3.html#cb36-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determine p</span></span>
<span id="cb36-4"><a href="simulace3.html#cb36-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span> <span class="co"># to plot graphs, we need at least 2 principal components</span></span>
<span id="cb36-5"><a href="simulace3.html#cb36-5" tabindex="-1"></a></span>
<span id="cb36-6"><a href="simulace3.html#cb36-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb36-7"><a href="simulace3.html#cb36-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p principal components</span></span>
<span id="cb36-8"><a href="simulace3.html#cb36-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># class membership</span></span></code></pre></div>
</details>
<p>In this specific case, we took the number of principal components $p = $ 2, which together explain 98.72 % of the variability in the data. The first principal component explains 98.2 % and the second 0.52 % of the variability. We can graphically display the scores of the first two principal components, color-coded according to class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb37-1"><a href="simulace3.html#cb37-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb37-2"><a href="simulace3.html#cb37-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb37-3"><a href="simulace3.html#cb37-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb37-4"><a href="simulace3.html#cb37-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb37-5"><a href="simulace3.html#cb37-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb37-6"><a href="simulace3.html#cb37-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb37-7"><a href="simulace3.html#cb37-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb37-8"><a href="simulace3.html#cb37-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb37-9"><a href="simulace3.html#cb37-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-27"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-27-1.png" alt="Scores of the first two principal components for training data. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 1.9: Scores of the first two principal components for training data. Points are color-coded according to class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to compute the scores for the first 2 principal components for the test data. These scores are calculated using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text dt,
\]</span>
where <span class="math inline">\(\mu(t)\)</span> is the mean function and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb38"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb38-1"><a href="simulace3.html#cb38-1" tabindex="-1"></a><span class="co"># Calculate scores for test functions</span></span>
<span id="cb38-2"><a href="simulace3.html#cb38-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix</span></span>
<span id="cb38-3"><a href="simulace3.html#cb38-3" tabindex="-1"></a></span>
<span id="cb38-4"><a href="simulace3.html#cb38-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb38-5"><a href="simulace3.html#cb38-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb38-6"><a href="simulace3.html#cb38-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb38-7"><a href="simulace3.html#cb38-7" tabindex="-1"></a>  <span class="co"># scalar product of the residual and eigenfunctions rho (functional principal components)</span></span>
<span id="cb38-8"><a href="simulace3.html#cb38-8" tabindex="-1"></a>}</span>
<span id="cb38-9"><a href="simulace3.html#cb38-9" tabindex="-1"></a></span>
<span id="cb38-10"><a href="simulace3.html#cb38-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb38-11"><a href="simulace3.html#cb38-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb38-12"><a href="simulace3.html#cb38-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb39-1"><a href="simulace3.html#cb39-1" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb39-2"><a href="simulace3.html#cb39-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb39-3"><a href="simulace3.html#cb39-3" tabindex="-1"></a></span>
<span id="cb39-4"><a href="simulace3.html#cb39-4" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb39-5"><a href="simulace3.html#cb39-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb39-6"><a href="simulace3.html#cb39-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb39-7"><a href="simulace3.html#cb39-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb39-8"><a href="simulace3.html#cb39-8" tabindex="-1"></a>  </span>
<span id="cb39-9"><a href="simulace3.html#cb39-9" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb39-10"><a href="simulace3.html#cb39-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb39-11"><a href="simulace3.html#cb39-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb39-12"><a href="simulace3.html#cb39-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training data (41.43 %) and on the test data (40 %).</p>
<p>For graphical representation of the method, we can indicate the decision boundary in the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb40-1"><a href="simulace3.html#cb40-1" tabindex="-1"></a><span class="co"># Add decision boundary</span></span>
<span id="cb40-2"><a href="simulace3.html#cb40-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb40-3"><a href="simulace3.html#cb40-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb40-4"><a href="simulace3.html#cb40-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb40-5"><a href="simulace3.html#cb40-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb40-6"><a href="simulace3.html#cb40-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb40-7"><a href="simulace3.html#cb40-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb40-8"><a href="simulace3.html#cb40-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb40-9"><a href="simulace3.html#cb40-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb40-10"><a href="simulace3.html#cb40-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb40-11"><a href="simulace3.html#cb40-11" tabindex="-1"></a><span class="co"># if p = 3</span></span>
<span id="cb40-12"><a href="simulace3.html#cb40-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb40-13"><a href="simulace3.html#cb40-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb40-14"><a href="simulace3.html#cb40-14" tabindex="-1"></a><span class="co"># if p = 4</span></span>
<span id="cb40-15"><a href="simulace3.html#cb40-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb40-16"><a href="simulace3.html#cb40-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb40-17"><a href="simulace3.html#cb40-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb40-18"><a href="simulace3.html#cb40-18" tabindex="-1"></a><span class="co"># if p = 5</span></span>
<span id="cb40-19"><a href="simulace3.html#cb40-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb40-20"><a href="simulace3.html#cb40-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb40-21"><a href="simulace3.html#cb40-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb40-22"><a href="simulace3.html#cb40-22" tabindex="-1"></a></span>
<span id="cb40-23"><a href="simulace3.html#cb40-23" tabindex="-1"></a><span class="co"># Add Y = 0, 1</span></span>
<span id="cb40-24"><a href="simulace3.html#cb40-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb40-25"><a href="simulace3.html#cb40-25" tabindex="-1"></a></span>
<span id="cb40-26"><a href="simulace3.html#cb40-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb40-27"><a href="simulace3.html#cb40-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb40-28"><a href="simulace3.html#cb40-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb40-29"><a href="simulace3.html#cb40-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb40-30"><a href="simulace3.html#cb40-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb40-31"><a href="simulace3.html#cb40-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb40-32"><a href="simulace3.html#cb40-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb40-33"><a href="simulace3.html#cb40-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb40-34"><a href="simulace3.html#cb40-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb40-35"><a href="simulace3.html#cb40-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-30"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-30-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black." width="672" />
<p class="caption">
Figure 1.10: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line in the plane of the first two principal components) between the classes constructed using LDA is marked in black.
</p>
</div>
<p>We see that the decision boundary is a line, a linear function in 2D space, which we expected from LDA. Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb41-1"><a href="simulace3.html#cb41-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb41-2"><a href="simulace3.html#cb41-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb41-3"><a href="simulace3.html#cb41-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb41-4"><a href="simulace3.html#cb41-4" tabindex="-1"></a></span>
<span id="cb41-5"><a href="simulace3.html#cb41-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis" class="section level3 hasAnchor" number="1.3.3">
<h3><span class="header-section-number">1.3.3</span> Quadratic Discriminant Analysis<a href="simulace3.html#quadratic-discriminant-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, let’s construct a classifier using Quadratic Discriminant Analysis (QDA). This is an analogous case to LDA, with the difference that we now allow a different covariance matrix for the normal distribution from which the respective scores originate for each of the classes. This relaxed assumption of equal covariance matrices leads to a quadratic boundary between the classes.</p>
<p>In <code>R</code>, we perform QDA analogously to LDA in the previous section, meaning we would again calculate scores for the training and test functions using functional principal component analysis, construct the classifier based on the scores of the first <span class="math inline">\(p\)</span> principal components, and use it to predict the class membership of the test curves <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>We do not need to perform functional PCA; we will use the results from the LDA section.</p>
<p>We can now proceed directly to constructing the classifier, which we will do using the <code>qda()</code> function. We will then calculate the accuracy of the classifier on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb42-1"><a href="simulace3.html#cb42-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb42-2"><a href="simulace3.html#cb42-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb42-3"><a href="simulace3.html#cb42-3" tabindex="-1"></a></span>
<span id="cb42-4"><a href="simulace3.html#cb42-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb42-5"><a href="simulace3.html#cb42-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb42-6"><a href="simulace3.html#cb42-6" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb42-7"><a href="simulace3.html#cb42-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb42-8"><a href="simulace3.html#cb42-8" tabindex="-1"></a>  </span>
<span id="cb42-9"><a href="simulace3.html#cb42-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb42-10"><a href="simulace3.html#cb42-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb42-11"><a href="simulace3.html#cb42-11" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb42-12"><a href="simulace3.html#cb42-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we have calculated the error rate of the classifier on the training (35.71 %) and test data (40 %).</p>
<p>For a graphical representation of the method, we can mark the decision boundary in the graph of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as we did in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb43-1"><a href="simulace3.html#cb43-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb43-2"><a href="simulace3.html#cb43-2" tabindex="-1"></a></span>
<span id="cb43-3"><a href="simulace3.html#cb43-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb43-4"><a href="simulace3.html#cb43-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb43-5"><a href="simulace3.html#cb43-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variability&#39;</span>, </span>
<span id="cb43-6"><a href="simulace3.html#cb43-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb43-7"><a href="simulace3.html#cb43-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb43-8"><a href="simulace3.html#cb43-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb43-9"><a href="simulace3.html#cb43-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb43-10"><a href="simulace3.html#cb43-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb43-11"><a href="simulace3.html#cb43-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb43-12"><a href="simulace3.html#cb43-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-36"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-36-1.png" alt="Scores of the first two principal components, colored according to class membership. The decision boundary (a parabola in the plane of the first two principal components) between the classes constructed using QDA is indicated in black." width="672" />
<p class="caption">
Figure 1.11: Scores of the first two principal components, colored according to class membership. The decision boundary (a parabola in the plane of the first two principal components) between the classes constructed using QDA is indicated in black.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a parabola.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb44-1"><a href="simulace3.html#cb44-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb44-2"><a href="simulace3.html#cb44-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb44-3"><a href="simulace3.html#cb44-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb44-4"><a href="simulace3.html#cb44-4" tabindex="-1"></a></span>
<span id="cb44-5"><a href="simulace3.html#cb44-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression" class="section level3 hasAnchor" number="1.3.4">
<h3><span class="header-section-number">1.3.4</span> Logistic Regression<a href="simulace3.html#logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression can be conducted in two ways.
One way is to use the functional equivalent of classical logistic regression, and the other is the classical multivariate logistic regression applied to scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression" class="section level4 hasAnchor" number="1.3.4.1">
<h4><span class="header-section-number">1.3.4.1</span> Functional Logistic Regression<a href="simulace3.html#functional-logistic-regression" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Similarly to the case of finite-dimensional input data, we consider the logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span>
where <span class="math inline">\(\eta(x)\)</span> is a linear predictor taking values from the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em>, which in the case of logistic regression is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>, and <span class="math inline">\(\pi(x)\)</span> is the conditional probability</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is the parametric function.
Our goal is to estimate this parametric function.</p>
<p>For functional logistic regression, we use the function <code>fregre.glm()</code> from the <code>fda.usc</code> package.
First, we create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb45-1"><a href="simulace3.html#cb45-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb45-2"><a href="simulace3.html#cb45-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb45-3"><a href="simulace3.html#cb45-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb45-4"><a href="simulace3.html#cb45-4" tabindex="-1"></a></span>
<span id="cb45-5"><a href="simulace3.html#cb45-5" tabindex="-1"></a><span class="co"># points where the functions are evaluated</span></span>
<span id="cb45-6"><a href="simulace3.html#cb45-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb45-7"><a href="simulace3.html#cb45-7" tabindex="-1"></a></span>
<span id="cb45-8"><a href="simulace3.html#cb45-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb45-9"><a href="simulace3.html#cb45-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb45-10"><a href="simulace3.html#cb45-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb45-11"><a href="simulace3.html#cb45-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span></code></pre></div>
</details>
<p>To estimate the parametric function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in our case a B-spline basis.
However, we need to find a suitable number of basis functions for this.
This could be determined based on the error on the training data, but such data would favor selecting a large number of bases, leading to model overfitting.</p>
<p>Let’s illustrate this with the following example.
For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 50\}\)</span>, we train the model on the training data, determine the error on them, and also calculate the error on the test data.
Let us recall that we cannot use the same data for selecting the optimal number of bases as for estimating the test error, as this would lead to an underestimated error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb46-1"><a href="simulace3.html#cb46-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb46-2"><a href="simulace3.html#cb46-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb46-3"><a href="simulace3.html#cb46-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb46-4"><a href="simulace3.html#cb46-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb46-5"><a href="simulace3.html#cb46-5" tabindex="-1"></a></span>
<span id="cb46-6"><a href="simulace3.html#cb46-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb46-7"><a href="simulace3.html#cb46-7" tabindex="-1"></a>  <span class="co"># basis for betas</span></span>
<span id="cb46-8"><a href="simulace3.html#cb46-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb46-9"><a href="simulace3.html#cb46-9" tabindex="-1"></a>  <span class="co"># relationship</span></span>
<span id="cb46-10"><a href="simulace3.html#cb46-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb46-11"><a href="simulace3.html#cb46-11" tabindex="-1"></a>  <span class="co"># basis for x and betas</span></span>
<span id="cb46-12"><a href="simulace3.html#cb46-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb46-13"><a href="simulace3.html#cb46-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb46-14"><a href="simulace3.html#cb46-14" tabindex="-1"></a>  <span class="co"># input data for the model</span></span>
<span id="cb46-15"><a href="simulace3.html#cb46-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb46-16"><a href="simulace3.html#cb46-16" tabindex="-1"></a>  <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb46-17"><a href="simulace3.html#cb46-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb46-18"><a href="simulace3.html#cb46-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb46-19"><a href="simulace3.html#cb46-19" tabindex="-1"></a>  </span>
<span id="cb46-20"><a href="simulace3.html#cb46-20" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb46-21"><a href="simulace3.html#cb46-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb46-22"><a href="simulace3.html#cb46-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb46-23"><a href="simulace3.html#cb46-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb46-24"><a href="simulace3.html#cb46-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb46-25"><a href="simulace3.html#cb46-25" tabindex="-1"></a>    </span>
<span id="cb46-26"><a href="simulace3.html#cb46-26" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb46-27"><a href="simulace3.html#cb46-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb46-28"><a href="simulace3.html#cb46-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb46-29"><a href="simulace3.html#cb46-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb46-30"><a href="simulace3.html#cb46-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb46-31"><a href="simulace3.html#cb46-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb46-32"><a href="simulace3.html#cb46-32" tabindex="-1"></a>  </span>
<span id="cb46-33"><a href="simulace3.html#cb46-33" tabindex="-1"></a>  <span class="co"># insert into matrix</span></span>
<span id="cb46-34"><a href="simulace3.html#cb46-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb46-35"><a href="simulace3.html#cb46-35" tabindex="-1"></a>} </span>
<span id="cb46-36"><a href="simulace3.html#cb46-36" tabindex="-1"></a></span>
<span id="cb46-37"><a href="simulace3.html#cb46-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb46-38"><a href="simulace3.html#cb46-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s plot the trend of both types of errors in a graph depending on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb47-1"><a href="simulace3.html#cb47-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb47-2"><a href="simulace3.html#cb47-2" tabindex="-1"></a></span>
<span id="cb47-3"><a href="simulace3.html#cb47-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb47-4"><a href="simulace3.html#cb47-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb47-5"><a href="simulace3.html#cb47-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb47-6"><a href="simulace3.html#cb47-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb47-7"><a href="simulace3.html#cb47-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb47-8"><a href="simulace3.html#cb47-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb47-9"><a href="simulace3.html#cb47-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb47-10"><a href="simulace3.html#cb47-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb47-11"><a href="simulace3.html#cb47-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb47-12"><a href="simulace3.html#cb47-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb47-13"><a href="simulace3.html#cb47-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb47-14"><a href="simulace3.html#cb47-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb47-15"><a href="simulace3.html#cb47-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 47 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-40"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-40-1.png" alt="Dependency of test and training error on the number of basis functions for $\beta$. The optimal number $n_{optimal}$ selected as the minimum test error is marked with a red point, the test error is drawn in black, and the training error is shown with a blue dashed line." width="672" />
<p class="caption">
Figure 1.12: Dependency of test and training error on the number of basis functions for <span class="math inline">\(\beta\)</span>. The optimal number <span class="math inline">\(n_{optimal}\)</span> selected as the minimum test error is marked with a red point, the test error is drawn in black, and the training error is shown with a blue dashed line.
</p>
</div>
<p>We see that as the number of bases for <span class="math inline">\(\beta(t)\)</span> increases, the training error (blue line) tends to decrease, and thus we would select large values of <span class="math inline">\(n_{basis}\)</span> based on it.
However, the optimal choice based on the test error is <span class="math inline">\(n\)</span> equal to 29, which is significantly smaller than 50.
On the other hand, as <span class="math inline">\(n\)</span> increases, the test error rises, indicating model overfitting.</p>
<p>For these reasons, we use 10-fold cross-validation to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>.
We consider a maximum number of 35 basis functions, as we saw above that beyond this value, the model starts overfitting.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb50-1"><a href="simulace3.html#cb50-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb50-2"><a href="simulace3.html#cb50-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">35</span></span>
<span id="cb50-3"><a href="simulace3.html#cb50-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb50-4"><a href="simulace3.html#cb50-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb50-5"><a href="simulace3.html#cb50-5" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb50-6"><a href="simulace3.html#cb50-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb50-7"><a href="simulace3.html#cb50-7" tabindex="-1"></a><span class="do">## elements that do not change during the loop</span></span>
<span id="cb50-8"><a href="simulace3.html#cb50-8" tabindex="-1"></a><span class="co"># points where functions are evaluated</span></span>
<span id="cb50-9"><a href="simulace3.html#cb50-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb50-10"><a href="simulace3.html#cb50-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb50-11"><a href="simulace3.html#cb50-11" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb50-12"><a href="simulace3.html#cb50-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb50-13"><a href="simulace3.html#cb50-13" tabindex="-1"></a><span class="co"># relationship</span></span>
<span id="cb50-14"><a href="simulace3.html#cb50-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb50-15"><a href="simulace3.html#cb50-15" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb50-16"><a href="simulace3.html#cb50-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb50-17"><a href="simulace3.html#cb50-17" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb50-18"><a href="simulace3.html#cb50-18" tabindex="-1"></a><span class="co"># columns contain accuracy values for a given part of the training set</span></span>
<span id="cb50-19"><a href="simulace3.html#cb50-19" tabindex="-1"></a><span class="co"># rows contain values for a given number of bases</span></span>
<span id="cb50-20"><a href="simulace3.html#cb50-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb50-21"><a href="simulace3.html#cb50-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>We prepared everything necessary to calculate the error rate for each of the ten subsets of the training set. We then determine the mean error and select the optimal <span class="math inline">\(n\)</span> as the argument of the minimum validation error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb51-1"><a href="simulace3.html#cb51-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb51-2"><a href="simulace3.html#cb51-2" tabindex="-1"></a>  <span class="co"># Define the current index set</span></span>
<span id="cb51-3"><a href="simulace3.html#cb51-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb51-4"><a href="simulace3.html#cb51-4" tabindex="-1"></a>    </span>
<span id="cb51-5"><a href="simulace3.html#cb51-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb51-6"><a href="simulace3.html#cb51-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb51-7"><a href="simulace3.html#cb51-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb51-8"><a href="simulace3.html#cb51-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb51-9"><a href="simulace3.html#cb51-9" tabindex="-1"></a>  </span>
<span id="cb51-10"><a href="simulace3.html#cb51-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb51-11"><a href="simulace3.html#cb51-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb51-12"><a href="simulace3.html#cb51-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb51-13"><a href="simulace3.html#cb51-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb51-14"><a href="simulace3.html#cb51-14" tabindex="-1"></a>  </span>
<span id="cb51-15"><a href="simulace3.html#cb51-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb51-16"><a href="simulace3.html#cb51-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb51-17"><a href="simulace3.html#cb51-17" tabindex="-1"></a>  </span>
<span id="cb51-18"><a href="simulace3.html#cb51-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb51-19"><a href="simulace3.html#cb51-19" tabindex="-1"></a>    <span class="co"># Basis for betas</span></span>
<span id="cb51-20"><a href="simulace3.html#cb51-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb51-21"><a href="simulace3.html#cb51-21" tabindex="-1"></a>    </span>
<span id="cb51-22"><a href="simulace3.html#cb51-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb51-23"><a href="simulace3.html#cb51-23" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb51-24"><a href="simulace3.html#cb51-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb51-25"><a href="simulace3.html#cb51-25" tabindex="-1"></a>    <span class="co"># Binomial model... logistic regression model</span></span>
<span id="cb51-26"><a href="simulace3.html#cb51-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb51-27"><a href="simulace3.html#cb51-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb51-28"><a href="simulace3.html#cb51-28" tabindex="-1"></a>    </span>
<span id="cb51-29"><a href="simulace3.html#cb51-29" tabindex="-1"></a>    <span class="co"># Accuracy on the validation set</span></span>
<span id="cb51-30"><a href="simulace3.html#cb51-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb51-31"><a href="simulace3.html#cb51-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb51-32"><a href="simulace3.html#cb51-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb51-33"><a href="simulace3.html#cb51-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb51-34"><a href="simulace3.html#cb51-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb51-35"><a href="simulace3.html#cb51-35" tabindex="-1"></a>    </span>
<span id="cb51-36"><a href="simulace3.html#cb51-36" tabindex="-1"></a>    <span class="co"># Insert into the matrix</span></span>
<span id="cb51-37"><a href="simulace3.html#cb51-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb51-38"><a href="simulace3.html#cb51-38" tabindex="-1"></a>  } </span>
<span id="cb51-39"><a href="simulace3.html#cb51-39" tabindex="-1"></a>}</span>
<span id="cb51-40"><a href="simulace3.html#cb51-40" tabindex="-1"></a></span>
<span id="cb51-41"><a href="simulace3.html#cb51-41" tabindex="-1"></a><span class="co"># Calculate the average accuracy for each n across folds</span></span>
<span id="cb51-42"><a href="simulace3.html#cb51-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb51-43"><a href="simulace3.html#cb51-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb51-44"><a href="simulace3.html#cb51-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span></code></pre></div>
</details>
<p>Next, let’s plot the validation error rate, highlighting the optimal value <span class="math inline">\(n_{optimal}\)</span> equal to 11 with validation error 0.072.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb52-1"><a href="simulace3.html#cb52-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb52-2"><a href="simulace3.html#cb52-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb52-3"><a href="simulace3.html#cb52-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb52-4"><a href="simulace3.html#cb52-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb52-5"><a href="simulace3.html#cb52-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb52-6"><a href="simulace3.html#cb52-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb52-7"><a href="simulace3.html#cb52-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb52-8"><a href="simulace3.html#cb52-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb52-9"><a href="simulace3.html#cb52-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>) <span class="sc">+</span> </span>
<span id="cb52-10"><a href="simulace3.html#cb52-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis) <span class="sc">+</span> </span>
<span id="cb52-11"><a href="simulace3.html#cb52-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 32 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-43"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-43-1.png" alt="Relationship of validation error rate with $n_{basis}$, i.e., the number of bases." width="672" />
<p class="caption">
Figure 1.13: Relationship of validation error rate with <span class="math inline">\(n_{basis}\)</span>, i.e., the number of bases.
</p>
</div>
<p>Now we can define the final model using functional logistic regression, choosing a B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 11 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb54-1"><a href="simulace3.html#cb54-1" tabindex="-1"></a><span class="co"># Optimal model</span></span>
<span id="cb54-2"><a href="simulace3.html#cb54-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb54-3"><a href="simulace3.html#cb54-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb54-4"><a href="simulace3.html#cb54-4" tabindex="-1"></a><span class="co"># Bases for x and betas</span></span>
<span id="cb54-5"><a href="simulace3.html#cb54-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb54-6"><a href="simulace3.html#cb54-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb54-7"><a href="simulace3.html#cb54-7" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb54-8"><a href="simulace3.html#cb54-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb54-9"><a href="simulace3.html#cb54-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb54-10"><a href="simulace3.html#cb54-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb54-11"><a href="simulace3.html#cb54-11" tabindex="-1"></a><span class="co"># Binomial model... logistic regression model</span></span>
<span id="cb54-12"><a href="simulace3.html#cb54-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb54-13"><a href="simulace3.html#cb54-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb54-14"><a href="simulace3.html#cb54-14" tabindex="-1"></a></span>
<span id="cb54-15"><a href="simulace3.html#cb54-15" tabindex="-1"></a><span class="co"># Training accuracy</span></span>
<span id="cb54-16"><a href="simulace3.html#cb54-16" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb54-17"><a href="simulace3.html#cb54-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb54-18"><a href="simulace3.html#cb54-18" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb54-19"><a href="simulace3.html#cb54-19" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb54-20"><a href="simulace3.html#cb54-20" tabindex="-1"></a>  </span>
<span id="cb54-21"><a href="simulace3.html#cb54-21" tabindex="-1"></a><span class="co"># Test accuracy</span></span>
<span id="cb54-22"><a href="simulace3.html#cb54-22" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb54-23"><a href="simulace3.html#cb54-23" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb54-24"><a href="simulace3.html#cb54-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb54-25"><a href="simulace3.html#cb54-25" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb54-26"><a href="simulace3.html#cb54-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We calculated the training error (equal to 3.57 %) and test error (equal to 8.33 %).
For better illustration, we can plot the estimated probabilities of class <span class="math inline">\(Y = 1\)</span> for the training data in relation to the values of the linear predictor.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb55-1"><a href="simulace3.html#cb55-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb55-2"><a href="simulace3.html#cb55-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb55-3"><a href="simulace3.html#cb55-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb55-4"><a href="simulace3.html#cb55-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb55-5"><a href="simulace3.html#cb55-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb55-6"><a href="simulace3.html#cb55-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb55-7"><a href="simulace3.html#cb55-7" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb55-8"><a href="simulace3.html#cb55-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb55-9"><a href="simulace3.html#cb55-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb55-10"><a href="simulace3.html#cb55-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear Predictor&#39;</span>,</span>
<span id="cb55-11"><a href="simulace3.html#cb55-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated Probabilities Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb55-12"><a href="simulace3.html#cb55-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-45-1.png" alt="Relationship of estimated probabilities with values of the linear predictor. Colors differentiate points by class membership." width="672" />
<p class="caption">
Figure 1.14: Relationship of estimated probabilities with values of the linear predictor. Colors differentiate points by class membership.
</p>
</div>
<p>For further information, we can also visualize the estimated parametric function <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb56-1"><a href="simulace3.html#cb56-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb56-2"><a href="simulace3.html#cb56-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb56-3"><a href="simulace3.html#cb56-3" tabindex="-1"></a></span>
<span id="cb56-4"><a href="simulace3.html#cb56-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb56-5"><a href="simulace3.html#cb56-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb56-6"><a href="simulace3.html#cb56-6" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb56-7"><a href="simulace3.html#cb56-7" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span></span>
<span id="cb56-8"><a href="simulace3.html#cb56-8" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb56-9"><a href="simulace3.html#cb56-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb56-10"><a href="simulace3.html#cb56-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb56-11"><a href="simulace3.html#cb56-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb56-12"><a href="simulace3.html#cb56-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb56-13"><a href="simulace3.html#cb56-13" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>())</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-46-1.png" alt="Plot of the estimated parametric function $\beta(t), t \in [0, 6]$." width="672" />
<p class="caption">
Figure 1.15: Plot of the estimated parametric function <span class="math inline">\(\beta(t), t \in [0, 6]\)</span>.
</p>
</div>
<p>We observe that the values of <span class="math inline">\(\hat\beta(t)\)</span> hover around zero for times <span class="math inline">\(t\)</span> in the middle and beginning of the interval <span class="math inline">\([0, 6]\)</span>, while the values increase for later times. This suggests a distinction between functions of different classes at the beginning and end of the interval, with high similarity in the middle.</p>
<p>Finally, we add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb57-1"><a href="simulace3.html#cb57-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb57-2"><a href="simulace3.html#cb57-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb57-3"><a href="simulace3.html#cb57-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb57-4"><a href="simulace3.html#cb57-4" tabindex="-1"></a></span>
<span id="cb57-5"><a href="simulace3.html#cb57-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-with-principal-component-analysis" class="section level4 hasAnchor" number="1.3.4.2">
<h4><span class="header-section-number">1.3.4.2</span> Logistic Regression with Principal Component Analysis<a href="simulace3.html#logistic-regression-with-principal-component-analysis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>To construct this classifier, we need to perform functional principal component analysis, determine an appropriate number of components, and calculate the score values for the test data.
We already performed this in the linear discriminant analysis section, so we will use those results in the following section.</p>
<p>We can now construct the logistic regression model directly using the function <code>glm(, family = binomial)</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb58"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb58-1"><a href="simulace3.html#cb58-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb58-2"><a href="simulace3.html#cb58-2" tabindex="-1"></a>clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb58-3"><a href="simulace3.html#cb58-3" tabindex="-1"></a></span>
<span id="cb58-4"><a href="simulace3.html#cb58-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb58-5"><a href="simulace3.html#cb58-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb58-6"><a href="simulace3.html#cb58-6" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb58-7"><a href="simulace3.html#cb58-7" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb58-8"><a href="simulace3.html#cb58-8" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb58-9"><a href="simulace3.html#cb58-9" tabindex="-1"></a>  </span>
<span id="cb58-10"><a href="simulace3.html#cb58-10" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb58-11"><a href="simulace3.html#cb58-11" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb58-12"><a href="simulace3.html#cb58-12" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb58-13"><a href="simulace3.html#cb58-13" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb58-14"><a href="simulace3.html#cb58-14" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we calculated the classifier error rate on the training data (40.71 %) and on the test data (40 %).</p>
<p>To illustrate the method graphically, we can plot the decision boundary on a graph of the scores of the first two principal components.
This boundary will be calculated on a dense grid of points and displayed using the <code>geom_contour()</code> function, just as in the cases of LDA and QDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb59"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb59-1"><a href="simulace3.html#cb59-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> nd,</span>
<span id="cb59-2"><a href="simulace3.html#cb59-2" tabindex="-1"></a>                                            <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))</span>
<span id="cb59-3"><a href="simulace3.html#cb59-3" tabindex="-1"></a>nd<span class="sc">$</span>prd <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(nd<span class="sc">$</span>prd <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb59-4"><a href="simulace3.html#cb59-4" tabindex="-1"></a></span>
<span id="cb59-5"><a href="simulace3.html#cb59-5" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb59-6"><a href="simulace3.html#cb59-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb59-7"><a href="simulace3.html#cb59-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (explained variability&#39;</span>, </span>
<span id="cb59-8"><a href="simulace3.html#cb59-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb59-9"><a href="simulace3.html#cb59-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb59-10"><a href="simulace3.html#cb59-10" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb59-11"><a href="simulace3.html#cb59-11" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb59-12"><a href="simulace3.html#cb59-12" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb59-13"><a href="simulace3.html#cb59-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb59-14"><a href="simulace3.html#cb59-14" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-52"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-52-1.png" alt="Scores of the first two principal components, color-coded by classification class membership. The separating boundary (line in the plane of the first two principal components) between classes, constructed using logistic regression, is shown in black." width="672" />
<p class="caption">
Figure 1.16: Scores of the first two principal components, color-coded by classification class membership. The separating boundary (line in the plane of the first two principal components) between classes, constructed using logistic regression, is shown in black.
</p>
</div>
<p>Note that the separating boundary between the classification classes is now a line, as in the case of LDA.</p>
<p>Finally, we add the error rates to a summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb60"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb60-1"><a href="simulace3.html#cb60-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR score&#39;</span>, </span>
<span id="cb60-2"><a href="simulace3.html#cb60-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb60-3"><a href="simulace3.html#cb60-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb60-4"><a href="simulace3.html#cb60-4" tabindex="-1"></a></span>
<span id="cb60-5"><a href="simulace3.html#cb60-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="decision-trees" class="section level3 hasAnchor" number="1.3.5">
<h3><span class="header-section-number">1.3.5</span> Decision Trees<a href="simulace3.html#decision-trees" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>In this section, we will look at a very different approach to constructing a classifier compared to methods like LDA or logistic regression.
Decision trees are a popular tool for classification; however, as with some previous methods, they are not directly designed for functional data.
There are ways, though, to transform functional objects into multivariate form and then apply the decision tree algorithm.
We can consider the following approaches:</p>
<ul>
<li><p>using the algorithm on basis coefficients,</p></li>
<li><p>using principal component scores,</p></li>
<li><p>using interval discretization and evaluating the function only on a finite grid of points.</p></li>
</ul>
<p>We will first focus on interval discretization and then compare the results with the remaining two approaches for constructing the decision tree.</p>
<div id="interval-discretization" class="section level4 hasAnchor" number="1.3.5.1">
<h4><span class="header-section-number">1.3.5.1</span> Interval Discretization<a href="simulace3.html#interval-discretization" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>First, we need to define points from the interval <span class="math inline">\(I = [0, 6]\)</span> at which we will evaluate the functions.
Then, we create an object in which the rows represent individual (discretized) functions, and the columns represent time points.
Finally, we add a column <span class="math inline">\(Y\)</span> with the classification class information and repeat the same steps for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb61"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb61-1"><a href="simulace3.html#cb61-1" tabindex="-1"></a><span class="co"># sequence of points at which the function is evaluated</span></span>
<span id="cb61-2"><a href="simulace3.html#cb61-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb61-3"><a href="simulace3.html#cb61-3" tabindex="-1"></a>   </span>
<span id="cb61-4"><a href="simulace3.html#cb61-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb61-5"><a href="simulace3.html#cb61-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for functions in rows</span></span>
<span id="cb61-6"><a href="simulace3.html#cb61-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb61-7"><a href="simulace3.html#cb61-7" tabindex="-1"></a></span>
<span id="cb61-8"><a href="simulace3.html#cb61-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb61-9"><a href="simulace3.html#cb61-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb61-10"><a href="simulace3.html#cb61-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can construct a decision tree where all time points from the <code>t.seq</code> vector serve as predictors.
This classifier is not susceptible to multicollinearity, so we don’t need to consider it.
Accuracy will be used as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb62"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb62-1"><a href="simulace3.html#cb62-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb62-2"><a href="simulace3.html#cb62-2" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb62-3"><a href="simulace3.html#cb62-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb62-4"><a href="simulace3.html#cb62-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb62-5"><a href="simulace3.html#cb62-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb62-6"><a href="simulace3.html#cb62-6" tabindex="-1"></a></span>
<span id="cb62-7"><a href="simulace3.html#cb62-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb62-8"><a href="simulace3.html#cb62-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb62-9"><a href="simulace3.html#cb62-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb62-10"><a href="simulace3.html#cb62-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb62-11"><a href="simulace3.html#cb62-11" tabindex="-1"></a>  </span>
<span id="cb62-12"><a href="simulace3.html#cb62-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb62-13"><a href="simulace3.html#cb62-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb62-14"><a href="simulace3.html#cb62-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb62-15"><a href="simulace3.html#cb62-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The classifier error rate on the test data is 46.67 % and on the training data 33.57 %.</p>
<p>We can visualize the decision tree using the <code>fancyRpartPlot()</code> function.
We set the node colors to reflect the previous color coding.
This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb63"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb63-1"><a href="simulace3.html#cb63-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb63-2"><a href="simulace3.html#cb63-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb63-3"><a href="simulace3.html#cb63-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-56"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-56-1.png" alt="Graphic representation of the unpruned decision tree. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades." width="672" />
<p class="caption">
Figure 1.17: Graphic representation of the unpruned decision tree. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb64"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb64-1"><a href="simulace3.html#cb64-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb64-2"><a href="simulace3.html#cb64-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># displaying desired information</span></span>
<span id="cb64-3"><a href="simulace3.html#cb64-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb64-4"><a href="simulace3.html#cb64-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb64-5"><a href="simulace3.html#cb64-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb64-6"><a href="simulace3.html#cb64-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb64-7"><a href="simulace3.html#cb64-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb64-8"><a href="simulace3.html#cb64-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-57"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-57-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 1.18: Final pruned decision tree.
</p>
</div>
<p>Finally, we again add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb65"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb65-1"><a href="simulace3.html#cb65-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discret.&#39;</span>, </span>
<span id="cb65-2"><a href="simulace3.html#cb65-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb65-3"><a href="simulace3.html#cb65-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb65-4"><a href="simulace3.html#cb65-4" tabindex="-1"></a></span>
<span id="cb65-5"><a href="simulace3.html#cb65-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores" class="section level4 hasAnchor" number="1.3.5.2">
<h4><span class="header-section-number">1.3.5.2</span> Principal Component Scores<a href="simulace3.html#principal-component-scores" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another option for constructing a decision tree is to use principal component scores.
Since we have already calculated scores for previous classification methods, we will use these results and construct a decision tree based on the scores of the first 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb66"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb66-1"><a href="simulace3.html#cb66-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb66-2"><a href="simulace3.html#cb66-2" tabindex="-1"></a>clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb66-3"><a href="simulace3.html#cb66-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb66-4"><a href="simulace3.html#cb66-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb66-5"><a href="simulace3.html#cb66-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb66-6"><a href="simulace3.html#cb66-6" tabindex="-1"></a></span>
<span id="cb66-7"><a href="simulace3.html#cb66-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb66-8"><a href="simulace3.html#cb66-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb66-9"><a href="simulace3.html#cb66-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb66-10"><a href="simulace3.html#cb66-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb66-11"><a href="simulace3.html#cb66-11" tabindex="-1"></a>  </span>
<span id="cb66-12"><a href="simulace3.html#cb66-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb66-13"><a href="simulace3.html#cb66-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb66-14"><a href="simulace3.html#cb66-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb66-15"><a href="simulace3.html#cb66-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the test data is 40 % and on the training data 37.86 %.</p>
<p>We can visualize the decision tree based on principal component scores using the <code>fancyRpartPlot()</code> function.
We set the node colors to reflect the previous color coding.
This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb67"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb67-1"><a href="simulace3.html#cb67-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb67-2"><a href="simulace3.html#cb67-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-60"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-60-1.png" alt="Graphic representation of the unpruned decision tree based on principal component scores. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades." width="672" />
<p class="caption">
Figure 1.19: Graphic representation of the unpruned decision tree based on principal component scores. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb68"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb68-1"><a href="simulace3.html#cb68-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.PCA<span class="sc">$</span>finalModel, <span class="co"># final model</span></span>
<span id="cb68-2"><a href="simulace3.html#cb68-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># displaying desired information</span></span>
<span id="cb68-3"><a href="simulace3.html#cb68-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb68-4"><a href="simulace3.html#cb68-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb68-5"><a href="simulace3.html#cb68-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb68-6"><a href="simulace3.html#cb68-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-61"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-61-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 1.20: Final pruned decision tree.
</p>
</div>
<p>Finally, we add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb69"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb69-1"><a href="simulace3.html#cb69-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - score&#39;</span>, </span>
<span id="cb69-2"><a href="simulace3.html#cb69-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb69-3"><a href="simulace3.html#cb69-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb69-4"><a href="simulace3.html#cb69-4" tabindex="-1"></a></span>
<span id="cb69-5"><a href="simulace3.html#cb69-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients" class="section level4 hasAnchor" number="1.3.5.3">
<h4><span class="header-section-number">1.3.5.3</span> Basis Coefficients<a href="simulace3.html#basis-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>The final method we will use to construct a decision tree is by employing coefficients derived from the B-spline basis representation of functions.</p>
<p>First, let us define the required datasets with the basis coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb70"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb70-1"><a href="simulace3.html#cb70-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb70-2"><a href="simulace3.html#cb70-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb70-3"><a href="simulace3.html#cb70-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb70-4"><a href="simulace3.html#cb70-4" tabindex="-1"></a></span>
<span id="cb70-5"><a href="simulace3.html#cb70-5" tabindex="-1"></a><span class="co"># testing dataset</span></span>
<span id="cb70-6"><a href="simulace3.html#cb70-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb70-7"><a href="simulace3.html#cb70-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now we can proceed to build the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb71"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb71-1"><a href="simulace3.html#cb71-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb71-2"><a href="simulace3.html#cb71-2" tabindex="-1"></a>clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb71-3"><a href="simulace3.html#cb71-3" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb71-4"><a href="simulace3.html#cb71-4" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb71-5"><a href="simulace3.html#cb71-5" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb71-6"><a href="simulace3.html#cb71-6" tabindex="-1"></a></span>
<span id="cb71-7"><a href="simulace3.html#cb71-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb71-8"><a href="simulace3.html#cb71-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb71-9"><a href="simulace3.html#cb71-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb71-10"><a href="simulace3.html#cb71-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb71-11"><a href="simulace3.html#cb71-11" tabindex="-1"></a>  </span>
<span id="cb71-12"><a href="simulace3.html#cb71-12" tabindex="-1"></a><span class="co"># accuracy on testing data</span></span>
<span id="cb71-13"><a href="simulace3.html#cb71-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb71-14"><a href="simulace3.html#cb71-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb71-15"><a href="simulace3.html#cb71-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the decision tree on the training data is 33.57 % and on the testing data 45 %.</p>
<p>We can visualize the decision tree built on the B-spline coefficients using the <code>fancyRpartPlot()</code> function.
We set the node colors to reflect the previous color coding.
This is an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb72"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb72-1"><a href="simulace3.html#cb72-1" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb72-2"><a href="simulace3.html#cb72-2" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-65"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-65-1.png" alt="Graphic representation of the unpruned decision tree based on basis coefficients. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades." width="672" />
<p class="caption">
Figure 1.21: Graphic representation of the unpruned decision tree based on basis coefficients. Nodes belonging to classification class 1 are shown in blue shades, and those for class 0 are in red shades.
</p>
</div>
<p>We can also display the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb73"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb73-1"><a href="simulace3.html#cb73-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree.Bbasis<span class="sc">$</span>finalModel, <span class="co"># final model</span></span>
<span id="cb73-2"><a href="simulace3.html#cb73-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># displaying desired information</span></span>
<span id="cb73-3"><a href="simulace3.html#cb73-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb73-4"><a href="simulace3.html#cb73-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb73-5"><a href="simulace3.html#cb73-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb73-6"><a href="simulace3.html#cb73-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, <span class="at">under =</span> <span class="cn">FALSE</span>, <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-66"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-66-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 1.22: Final pruned decision tree.
</p>
</div>
<p>Finally, let us add the training and testing error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb74"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb74-1"><a href="simulace3.html#cb74-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - Bbasis&#39;</span>, </span>
<span id="cb74-2"><a href="simulace3.html#cb74-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb74-3"><a href="simulace3.html#cb74-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb74-4"><a href="simulace3.html#cb74-4" tabindex="-1"></a></span>
<span id="cb74-5"><a href="simulace3.html#cb74-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests" class="section level3 hasAnchor" number="1.3.6">
<h3><span class="header-section-number">1.3.6</span> Random Forests<a href="simulace3.html#random-forests" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>A classifier constructed with the random forest method consists of building multiple individual decision trees that are then combined to form a unified classifier (by “voting” among the trees).</p>
<p>Similar to decision trees, we have several options for which type of (finite-dimensional) data to use in constructing the model.
We will once again consider the three approaches discussed above.
The datasets with the respective variables for all three approaches have been prepared in the previous section, so we can directly proceed to construct the models, calculate classifier characteristics, and add the results to the summary table.</p>
<div id="interval-discretization-1" class="section level4 hasAnchor" number="1.3.6.1">
<h4><span class="header-section-number">1.3.6.1</span> Interval Discretization<a href="simulace3.html#interval-discretization-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the first case, we evaluate the functions on a specified grid of points in the interval $ I = [0, 6] $.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb75"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb75-1"><a href="simulace3.html#cb75-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb75-2"><a href="simulace3.html#cb75-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb75-3"><a href="simulace3.html#cb75-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb75-4"><a href="simulace3.html#cb75-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb75-5"><a href="simulace3.html#cb75-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb75-6"><a href="simulace3.html#cb75-6" tabindex="-1"></a></span>
<span id="cb75-7"><a href="simulace3.html#cb75-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb75-8"><a href="simulace3.html#cb75-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb75-9"><a href="simulace3.html#cb75-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb75-10"><a href="simulace3.html#cb75-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb75-11"><a href="simulace3.html#cb75-11" tabindex="-1"></a>  </span>
<span id="cb75-12"><a href="simulace3.html#cb75-12" tabindex="-1"></a><span class="co"># accuracy on testing data</span></span>
<span id="cb75-13"><a href="simulace3.html#cb75-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb75-14"><a href="simulace3.html#cb75-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb75-15"><a href="simulace3.html#cb75-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is 0.71 % and on the testing data 40 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb76"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb76-1"><a href="simulace3.html#cb76-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discr&#39;</span>, </span>
<span id="cb76-2"><a href="simulace3.html#cb76-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb76-3"><a href="simulace3.html#cb76-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb76-4"><a href="simulace3.html#cb76-4" tabindex="-1"></a></span>
<span id="cb76-5"><a href="simulace3.html#cb76-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-1" class="section level4 hasAnchor" number="1.3.6.2">
<h4><span class="header-section-number">1.3.6.2</span> Principal Component Scores<a href="simulace3.html#principal-component-scores-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we use the scores of the first $ p = $ 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb77"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb77-1"><a href="simulace3.html#cb77-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb77-2"><a href="simulace3.html#cb77-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb77-3"><a href="simulace3.html#cb77-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb77-4"><a href="simulace3.html#cb77-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb77-5"><a href="simulace3.html#cb77-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb77-6"><a href="simulace3.html#cb77-6" tabindex="-1"></a></span>
<span id="cb77-7"><a href="simulace3.html#cb77-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb77-8"><a href="simulace3.html#cb77-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb77-9"><a href="simulace3.html#cb77-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb77-10"><a href="simulace3.html#cb77-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb77-11"><a href="simulace3.html#cb77-11" tabindex="-1"></a>  </span>
<span id="cb77-12"><a href="simulace3.html#cb77-12" tabindex="-1"></a><span class="co"># accuracy on testing data</span></span>
<span id="cb77-13"><a href="simulace3.html#cb77-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb77-14"><a href="simulace3.html#cb77-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb77-15"><a href="simulace3.html#cb77-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate on the training data is therefore 4.29 % and on the testing data 40 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb78"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb78-1"><a href="simulace3.html#cb78-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb78-2"><a href="simulace3.html#cb78-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb78-3"><a href="simulace3.html#cb78-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb78-4"><a href="simulace3.html#cb78-4" tabindex="-1"></a></span>
<span id="cb78-5"><a href="simulace3.html#cb78-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-coefficients-1" class="section level4 hasAnchor" number="1.3.6.3">
<h4><span class="header-section-number">1.3.6.3</span> Basis Coefficients<a href="simulace3.html#basis-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we use the function representations through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb79"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb79-1"><a href="simulace3.html#cb79-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb79-2"><a href="simulace3.html#cb79-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb79-3"><a href="simulace3.html#cb79-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb79-4"><a href="simulace3.html#cb79-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb79-5"><a href="simulace3.html#cb79-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb79-6"><a href="simulace3.html#cb79-6" tabindex="-1"></a></span>
<span id="cb79-7"><a href="simulace3.html#cb79-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb79-8"><a href="simulace3.html#cb79-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb79-9"><a href="simulace3.html#cb79-9" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb79-10"><a href="simulace3.html#cb79-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb79-11"><a href="simulace3.html#cb79-11" tabindex="-1"></a>  </span>
<span id="cb79-12"><a href="simulace3.html#cb79-12" tabindex="-1"></a><span class="co"># accuracy on testing data</span></span>
<span id="cb79-13"><a href="simulace3.html#cb79-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb79-14"><a href="simulace3.html#cb79-14" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb79-15"><a href="simulace3.html#cb79-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 0.71 % and on the testing data 36.67 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb80"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb80-1"><a href="simulace3.html#cb80-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb80-2"><a href="simulace3.html#cb80-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb80-3"><a href="simulace3.html#cb80-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb80-4"><a href="simulace3.html#cb80-4" tabindex="-1"></a></span>
<span id="cb80-5"><a href="simulace3.html#cb80-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines" class="section level3 hasAnchor" number="1.3.7">
<h3><span class="header-section-number">1.3.7</span> Support Vector Machines<a href="simulace3.html#support-vector-machines" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s look at the classification of our simulated curves using the Support Vector Machines (SVM) method. The advantage of this classification method is its computational efficiency, as it uses only a few (often very few) observations to define the boundary curve between classes.</p>
<p>The main advantage of SVM is the use of the so-called <em>kernel trick</em>, which allows us to replace the ordinary scalar product with another scalar product of transformed data without having to directly define this transformation. This gives us a generally nonlinear decision boundary between classification classes. The <em>kernel</em> (kernel function) <span class="math inline">\(K\)</span> is a function that satisfies</p>
<p><span class="math display">\[
K(x_i, x_j) = \langle \phi(x_i), \phi(x_j) \rangle_{\mathcal H},
\]</span>
where <span class="math inline">\(\phi\)</span> is some (unknown) transformation (feature map), <span class="math inline">\(\mathcal H\)</span> is a Hilbert space, and <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span> is some scalar product in this Hilbert space.</p>
<p>In practice, three types of kernel functions are most commonly chosen:</p>
<ul>
<li>linear kernel – <span class="math inline">\(K(x_i, x_j) = \langle x_i, x_j \rangle\)</span>,</li>
<li>polynomial kernel – <span class="math inline">\(K(x_i, x_j) = \big(\alpha_0 + \gamma \langle x_i, x_j \rangle \big)^d\)</span>,</li>
<li>radial (Gaussian) kernel – <span class="math inline">\(\displaystyle{K(x_i, x_j) = \text e^{-\gamma \|x_i - x_j \|^2}}\)</span>.</li>
</ul>
<p>For all the above-mentioned kernels, we must choose a constant <span class="math inline">\(C &gt; 0\)</span>, which indicates the degree of penalty for exceeding the decision boundary between classes (inverse regularization parameter). As the value of <span class="math inline">\(C\)</span> increases, the method will penalize poorly classified data more and pay less attention to the shape of the boundary; conversely, for small values of <span class="math inline">\(C\)</span>, the method does not give much importance to poorly classified data but focuses more on penalizing the shape of the boundary. This constant <span class="math inline">\(C\)</span> is typically set to 1 by default, but we can also determine it directly, for example, using cross-validation.</p>
<p>By using cross-validation, we can also determine the optimal values of other hyperparameters, which now depend on our choice of kernel function. In the case of a linear kernel, we do not choose any other parameters aside from the constant <span class="math inline">\(C\)</span>; with polynomial and radial kernels, we must specify the hyperparameter values <span class="math inline">\(\alpha_0, \gamma, \text{ and } d\)</span>, whose default values in <code>R</code> are sequentially <span class="math inline">\(\alpha_0^{default} = 0, \gamma^{default} = \frac{1}{\text{dim}(\texttt{data})} \text{ and } d^{default} = 3\)</span>. Again, we could determine the optimal hyperparameter values for our data, but due to the relatively high computational cost, we will leave the values of the respective hyperparameters at the values estimated using CV on a generated dataset, choosing <span class="math inline">\(\alpha_0 = 1\)</span>.</p>
<p>In the case of functional data, we have several options for applying the SVM method. The simplest variant is to apply this classification method directly to the discretized function (section <a href="simulace3.html#diskr3">1.3.7.2</a>). Another option is to again use the principal component scores and classify the curves based on their representation <a href="simulace3.html#PCA-SVM3">1.3.7.3</a>. Another straightforward variant is to utilize the expression of curves using a B-spline basis and classify the curves based on the coefficients of their representation in this basis (section <a href="simulace3.html#basis-SVM3">1.3.7.4</a>).</p>
<p>Through more complex reasoning, we can arrive at several other options that utilize the functional nature of the data. On the one hand, instead of classifying the original curve, we can use its derivative (or second derivative, third, etc.); on the other hand, we can utilize the projection of functions onto the subspace generated by, for example, B-spline functions (section <a href="simulace3.html#projection-SVM3">1.3.7.5</a>). The last method we will use for classifying functional data involves a combination of projecting onto a certain subspace generated by functions (Reproducing Kernel Hilbert Space, RKHS) and classifying the corresponding representation. This method utilizes both classical SVM and SVM for regression; more details can be found in the section RKHS + SVM <a href="simulace3.html#RKHS-SVM3">1.3.7.6</a>.</p>
<div id="svm-for-functional-data-1" class="section level4 hasAnchor" number="1.3.7.1">
<h4><span class="header-section-number">1.3.7.1</span> SVM for Functional Data<a href="simulace3.html#svm-for-functional-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the <code>fda.usc</code> library, we will use the function <code>classif.svm()</code> to apply the SVM method directly to functional data. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb81"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb81-1"><a href="simulace3.html#cb81-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb81-2"><a href="simulace3.html#cb81-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb81-3"><a href="simulace3.html#cb81-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb81-4"><a href="simulace3.html#cb81-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb81-5"><a href="simulace3.html#cb81-5" tabindex="-1"></a>}</span>
<span id="cb81-6"><a href="simulace3.html#cb81-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb81-7"><a href="simulace3.html#cb81-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb81-8"><a href="simulace3.html#cb81-8" tabindex="-1"></a>    <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb81-9"><a href="simulace3.html#cb81-9" tabindex="-1"></a>    <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb81-10"><a href="simulace3.html#cb81-10" tabindex="-1"></a>    <span class="at">byrow =</span> T)</span>
<span id="cb81-11"><a href="simulace3.html#cb81-11" tabindex="-1"></a></span>
<span id="cb81-12"><a href="simulace3.html#cb81-12" tabindex="-1"></a><span class="co"># splitting into test and training parts</span></span>
<span id="cb81-13"><a href="simulace3.html#cb81-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-14"><a href="simulace3.html#cb81-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb81-15"><a href="simulace3.html#cb81-15" tabindex="-1"></a></span>
<span id="cb81-16"><a href="simulace3.html#cb81-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb81-17"><a href="simulace3.html#cb81-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb82"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb82-1"><a href="simulace3.html#cb82-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb82-2"><a href="simulace3.html#cb82-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb82-3"><a href="simulace3.html#cb82-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb82-4"><a href="simulace3.html#cb82-4" tabindex="-1"></a></span>
<span id="cb82-5"><a href="simulace3.html#cb82-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb82-6"><a href="simulace3.html#cb82-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb82-7"><a href="simulace3.html#cb82-7" tabindex="-1"></a></span>
<span id="cb82-8"><a href="simulace3.html#cb82-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb82-9"><a href="simulace3.html#cb82-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb82-10"><a href="simulace3.html#cb82-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb82-11"><a href="simulace3.html#cb82-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb83"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb83-1"><a href="simulace3.html#cb83-1" tabindex="-1"></a><span class="co"># formula</span></span>
<span id="cb83-2"><a href="simulace3.html#cb83-2" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb83-3"><a href="simulace3.html#cb83-3" tabindex="-1"></a><span class="co"># basis for x</span></span>
<span id="cb83-4"><a href="simulace3.html#cb83-4" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb83-5"><a href="simulace3.html#cb83-5" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb83-6"><a href="simulace3.html#cb83-6" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb83-7"><a href="simulace3.html#cb83-7" tabindex="-1"></a><span class="co"># SVM model</span></span>
<span id="cb83-8"><a href="simulace3.html#cb83-8" tabindex="-1"></a>model.svm.f <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb83-9"><a href="simulace3.html#cb83-9" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb83-10"><a href="simulace3.html#cb83-10" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb83-11"><a href="simulace3.html#cb83-11" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, <span class="at">degree =</span> <span class="dv">5</span>, <span class="at">coef0 =</span> <span class="dv">1</span>, <span class="at">cost =</span> <span class="fl">1e4</span>)</span>
<span id="cb83-12"><a href="simulace3.html#cb83-12" tabindex="-1"></a></span>
<span id="cb83-13"><a href="simulace3.html#cb83-13" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb83-14"><a href="simulace3.html#cb83-14" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb83-15"><a href="simulace3.html#cb83-15" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb83-16"><a href="simulace3.html#cb83-16" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train)</span>
<span id="cb83-17"><a href="simulace3.html#cb83-17" tabindex="-1"></a>  </span>
<span id="cb83-18"><a href="simulace3.html#cb83-18" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb83-19"><a href="simulace3.html#cb83-19" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb83-20"><a href="simulace3.html#cb83-20" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb83-21"><a href="simulace3.html#cb83-21" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test)</span></code></pre></div>
</details>
<p>We calculated the training error (which is 0 %) and the test error (which is 11.67 %).</p>
<p>Now let’s attempt, unlike the procedure in the previous chapters, to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, acknowledging that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will explore the values of the hyperparameter <span class="math inline">\(C\)</span> in the range <span class="math inline">\([10^{0}, 10^{7}]\)</span>, while for the polynomial kernel, we will consider the value of the hyperparameter <span class="math inline">\(p\)</span> to be 3, 4, or 5, as other integer values do not yield nearly as good results. Conversely, for the radial kernel, we will again use <span class="math inline">\(r k_cv\)</span>-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the range <span class="math inline">\([10^{-5}, 10^{0}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb84"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb84-1"><a href="simulace3.html#cb84-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb84-2"><a href="simulace3.html#cb84-2" tabindex="-1"></a></span>
<span id="cb84-3"><a href="simulace3.html#cb84-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb84-4"><a href="simulace3.html#cb84-4" tabindex="-1"></a></span>
<span id="cb84-5"><a href="simulace3.html#cb84-5" tabindex="-1"></a><span class="co"># We split the training data into k parts</span></span>
<span id="cb84-6"><a href="simulace3.html#cb84-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb84-7"><a href="simulace3.html#cb84-7" tabindex="-1"></a></span>
<span id="cb84-8"><a href="simulace3.html#cb84-8" tabindex="-1"></a><span class="co"># Which values of gamma do we want to consider</span></span>
<span id="cb84-9"><a href="simulace3.html#cb84-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">6</span>)</span>
<span id="cb84-10"><a href="simulace3.html#cb84-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="at">length =</span> <span class="dv">8</span>)</span>
<span id="cb84-11"><a href="simulace3.html#cb84-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">5</span>)</span>
<span id="cb84-12"><a href="simulace3.html#cb84-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb84-13"><a href="simulace3.html#cb84-13" tabindex="-1"></a></span>
<span id="cb84-14"><a href="simulace3.html#cb84-14" tabindex="-1"></a><span class="co"># A list with three components... an array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb84-15"><a href="simulace3.html#cb84-15" tabindex="-1"></a><span class="co"># An empty matrix where we will place individual results</span></span>
<span id="cb84-16"><a href="simulace3.html#cb84-16" tabindex="-1"></a><span class="co"># The columns will contain the accuracy values for each</span></span>
<span id="cb84-17"><a href="simulace3.html#cb84-17" tabindex="-1"></a><span class="co"># The rows will correspond to the values for a given gamma and the layers correspond to folds</span></span>
<span id="cb84-18"><a href="simulace3.html#cb84-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb84-19"><a href="simulace3.html#cb84-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb84-20"><a href="simulace3.html#cb84-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb84-21"><a href="simulace3.html#cb84-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb84-22"><a href="simulace3.html#cb84-22" tabindex="-1"></a>)</span>
<span id="cb84-23"><a href="simulace3.html#cb84-23" tabindex="-1"></a></span>
<span id="cb84-24"><a href="simulace3.html#cb84-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb84-25"><a href="simulace3.html#cb84-25" tabindex="-1"></a><span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb84-26"><a href="simulace3.html#cb84-26" tabindex="-1"></a>  <span class="co"># We go through the individual folds</span></span>
<span id="cb84-27"><a href="simulace3.html#cb84-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb84-28"><a href="simulace3.html#cb84-28" tabindex="-1"></a>    <span class="co"># Definition of the test and training parts for CV</span></span>
<span id="cb84-29"><a href="simulace3.html#cb84-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb84-30"><a href="simulace3.html#cb84-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb84-31"><a href="simulace3.html#cb84-31" tabindex="-1"></a>    </span>
<span id="cb84-32"><a href="simulace3.html#cb84-32" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb84-33"><a href="simulace3.html#cb84-33" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb84-34"><a href="simulace3.html#cb84-34" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb84-35"><a href="simulace3.html#cb84-35" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb84-36"><a href="simulace3.html#cb84-36" tabindex="-1"></a>    </span>
<span id="cb84-37"><a href="simulace3.html#cb84-37" tabindex="-1"></a>    <span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb84-38"><a href="simulace3.html#cb84-38" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb84-39"><a href="simulace3.html#cb84-39" tabindex="-1"></a>    </span>
<span id="cb84-40"><a href="simulace3.html#cb84-40" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb84-41"><a href="simulace3.html#cb84-41" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb84-42"><a href="simulace3.html#cb84-42" tabindex="-1"></a>    <span class="co"># B-spline basis</span></span>
<span id="cb84-43"><a href="simulace3.html#cb84-43" tabindex="-1"></a>    basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb84-44"><a href="simulace3.html#cb84-44" tabindex="-1"></a>    <span class="co"># Formula</span></span>
<span id="cb84-45"><a href="simulace3.html#cb84-45" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb84-46"><a href="simulace3.html#cb84-46" tabindex="-1"></a>    <span class="co"># Basis for x</span></span>
<span id="cb84-47"><a href="simulace3.html#cb84-47" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb84-48"><a href="simulace3.html#cb84-48" tabindex="-1"></a>    <span class="co"># Input data for the model</span></span>
<span id="cb84-49"><a href="simulace3.html#cb84-49" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb84-50"><a href="simulace3.html#cb84-50" tabindex="-1"></a>    </span>
<span id="cb84-51"><a href="simulace3.html#cb84-51" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb84-52"><a href="simulace3.html#cb84-52" tabindex="-1"></a>    <span class="co"># SVM model</span></span>
<span id="cb84-53"><a href="simulace3.html#cb84-53" tabindex="-1"></a>    clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb84-54"><a href="simulace3.html#cb84-54" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb84-55"><a href="simulace3.html#cb84-55" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb84-56"><a href="simulace3.html#cb84-56" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb84-57"><a href="simulace3.html#cb84-57" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb84-58"><a href="simulace3.html#cb84-58" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb84-59"><a href="simulace3.html#cb84-59" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-60"><a href="simulace3.html#cb84-60" tabindex="-1"></a>      </span>
<span id="cb84-61"><a href="simulace3.html#cb84-61" tabindex="-1"></a>    <span class="co"># Accuracy on the test data</span></span>
<span id="cb84-62"><a href="simulace3.html#cb84-62" tabindex="-1"></a>    newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb84-63"><a href="simulace3.html#cb84-63" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb84-64"><a href="simulace3.html#cb84-64" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb84-65"><a href="simulace3.html#cb84-65" tabindex="-1"></a>    </span>
<span id="cb84-66"><a href="simulace3.html#cb84-66" tabindex="-1"></a>    <span class="co"># We insert the accuracies into positions for the given C and fold</span></span>
<span id="cb84-67"><a href="simulace3.html#cb84-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb84-68"><a href="simulace3.html#cb84-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb84-69"><a href="simulace3.html#cb84-69" tabindex="-1"></a>    </span>
<span id="cb84-70"><a href="simulace3.html#cb84-70" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb84-71"><a href="simulace3.html#cb84-71" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb84-72"><a href="simulace3.html#cb84-72" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb84-73"><a href="simulace3.html#cb84-73" tabindex="-1"></a>      clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb84-74"><a href="simulace3.html#cb84-74" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb84-75"><a href="simulace3.html#cb84-75" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb84-76"><a href="simulace3.html#cb84-76" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb84-77"><a href="simulace3.html#cb84-77" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb84-78"><a href="simulace3.html#cb84-78" tabindex="-1"></a>                <span class="at">coef0 =</span> coef0,</span>
<span id="cb84-79"><a href="simulace3.html#cb84-79" tabindex="-1"></a>                <span class="at">degree =</span> p,</span>
<span id="cb84-80"><a href="simulace3.html#cb84-80" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb84-81"><a href="simulace3.html#cb84-81" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-82"><a href="simulace3.html#cb84-82" tabindex="-1"></a>        </span>
<span id="cb84-83"><a href="simulace3.html#cb84-83" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb84-84"><a href="simulace3.html#cb84-84" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb84-85"><a href="simulace3.html#cb84-85" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb84-86"><a href="simulace3.html#cb84-86" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb84-87"><a href="simulace3.html#cb84-87" tabindex="-1"></a>      </span>
<span id="cb84-88"><a href="simulace3.html#cb84-88" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, p, and fold</span></span>
<span id="cb84-89"><a href="simulace3.html#cb84-89" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb84-90"><a href="simulace3.html#cb84-90" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb84-91"><a href="simulace3.html#cb84-91" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb84-92"><a href="simulace3.html#cb84-92" tabindex="-1"></a>    }</span>
<span id="cb84-93"><a href="simulace3.html#cb84-93" tabindex="-1"></a>        </span>
<span id="cb84-94"><a href="simulace3.html#cb84-94" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb84-95"><a href="simulace3.html#cb84-95" tabindex="-1"></a>    <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb84-96"><a href="simulace3.html#cb84-96" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb84-97"><a href="simulace3.html#cb84-97" tabindex="-1"></a>      clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb84-98"><a href="simulace3.html#cb84-98" tabindex="-1"></a>                <span class="at">data =</span> ldata,</span>
<span id="cb84-99"><a href="simulace3.html#cb84-99" tabindex="-1"></a>                <span class="at">basis.x =</span> basis.x,</span>
<span id="cb84-100"><a href="simulace3.html#cb84-100" tabindex="-1"></a>                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb84-101"><a href="simulace3.html#cb84-101" tabindex="-1"></a>                <span class="at">cost =</span> cost,</span>
<span id="cb84-102"><a href="simulace3.html#cb84-102" tabindex="-1"></a>                <span class="at">gamma =</span> gam.cv,</span>
<span id="cb84-103"><a href="simulace3.html#cb84-103" tabindex="-1"></a>                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb84-104"><a href="simulace3.html#cb84-104" tabindex="-1"></a>                <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb84-105"><a href="simulace3.html#cb84-105" tabindex="-1"></a>        </span>
<span id="cb84-106"><a href="simulace3.html#cb84-106" tabindex="-1"></a>      <span class="co"># Accuracy on the test data</span></span>
<span id="cb84-107"><a href="simulace3.html#cb84-107" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb84-108"><a href="simulace3.html#cb84-108" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb84-109"><a href="simulace3.html#cb84-109" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb84-110"><a href="simulace3.html#cb84-110" tabindex="-1"></a>      </span>
<span id="cb84-111"><a href="simulace3.html#cb84-111" tabindex="-1"></a>      <span class="co"># We insert the accuracies into positions for the given C, gamma, and fold</span></span>
<span id="cb84-112"><a href="simulace3.html#cb84-112" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb84-113"><a href="simulace3.html#cb84-113" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb84-114"><a href="simulace3.html#cb84-114" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb84-115"><a href="simulace3.html#cb84-115" tabindex="-1"></a>    }</span>
<span id="cb84-116"><a href="simulace3.html#cb84-116" tabindex="-1"></a>  }</span>
<span id="cb84-117"><a href="simulace3.html#cb84-117" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we will average the results of 10-fold CV so that we have one estimate of validation error for one value of the hyperparameter (or one combination of values). At the same time, we will determine the optimal values of the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb85"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb85-1"><a href="simulace3.html#cb85-1" tabindex="-1"></a><span class="co"># We calculate the average accuracies for individual C across folds</span></span>
<span id="cb85-2"><a href="simulace3.html#cb85-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb85-3"><a href="simulace3.html#cb85-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb85-4"><a href="simulace3.html#cb85-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb85-5"><a href="simulace3.html#cb85-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb85-6"><a href="simulace3.html#cb85-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb85-7"><a href="simulace3.html#cb85-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb85-8"><a href="simulace3.html#cb85-8" tabindex="-1"></a></span>
<span id="cb85-9"><a href="simulace3.html#cb85-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb85-10"><a href="simulace3.html#cb85-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb85-11"><a href="simulace3.html#cb85-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb85-12"><a href="simulace3.html#cb85-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb85-13"><a href="simulace3.html#cb85-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb85-14"><a href="simulace3.html#cb85-14" tabindex="-1"></a></span>
<span id="cb85-15"><a href="simulace3.html#cb85-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb85-16"><a href="simulace3.html#cb85-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb85-17"><a href="simulace3.html#cb85-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb85-18"><a href="simulace3.html#cb85-18" tabindex="-1"></a></span>
<span id="cb85-19"><a href="simulace3.html#cb85-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb85-20"><a href="simulace3.html#cb85-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb85-21"><a href="simulace3.html#cb85-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb85-22"><a href="simulace3.html#cb85-22" tabindex="-1"></a></span>
<span id="cb85-23"><a href="simulace3.html#cb85-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb85-24"><a href="simulace3.html#cb85-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb85-25"><a href="simulace3.html#cb85-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s take a look at how the optimal values turned out. For <em>linear kernel</em>, we have the optimal value <span class="math inline">\(C\)</span> equal to 100, for <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is equal to 1, and for <em>radial kernel</em>, we have two optimal values, for <span class="math inline">\(C\)</span> the optimal value is 10^{6} and for <span class="math inline">\(\gamma\)</span> it is 10^{-4}. The validation error rates are 0.0935256 for linear, 0.1731822 for polynomial, and 0.0787637 for radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined using 10-fold CV. We will also determine the errors on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb86"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb86-1"><a href="simulace3.html#cb86-1" tabindex="-1"></a><span class="co"># Create suitable objects</span></span>
<span id="cb86-2"><a href="simulace3.html#cb86-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb86-3"><a href="simulace3.html#cb86-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb86-4"><a href="simulace3.html#cb86-4" tabindex="-1"></a></span>
<span id="cb86-5"><a href="simulace3.html#cb86-5" tabindex="-1"></a><span class="co"># Points at which the functions are evaluated</span></span>
<span id="cb86-6"><a href="simulace3.html#cb86-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb86-7"><a href="simulace3.html#cb86-7" tabindex="-1"></a></span>
<span id="cb86-8"><a href="simulace3.html#cb86-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb86-9"><a href="simulace3.html#cb86-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb86-10"><a href="simulace3.html#cb86-10" tabindex="-1"></a><span class="co"># B-spline basis</span></span>
<span id="cb86-11"><a href="simulace3.html#cb86-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb86-12"><a href="simulace3.html#cb86-12" tabindex="-1"></a></span>
<span id="cb86-13"><a href="simulace3.html#cb86-13" tabindex="-1"></a><span class="co"># Formula</span></span>
<span id="cb86-14"><a href="simulace3.html#cb86-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb86-15"><a href="simulace3.html#cb86-15" tabindex="-1"></a><span class="co"># Basis for x</span></span>
<span id="cb86-16"><a href="simulace3.html#cb86-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb86-17"><a href="simulace3.html#cb86-17" tabindex="-1"></a><span class="co"># Input data for the model</span></span>
<span id="cb86-18"><a href="simulace3.html#cb86-18" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb87"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb87-1"><a href="simulace3.html#cb87-1" tabindex="-1"></a>model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb87-2"><a href="simulace3.html#cb87-2" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb87-3"><a href="simulace3.html#cb87-3" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb87-4"><a href="simulace3.html#cb87-4" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb87-5"><a href="simulace3.html#cb87-5" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-6"><a href="simulace3.html#cb87-6" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-7"><a href="simulace3.html#cb87-7" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb87-8"><a href="simulace3.html#cb87-8" tabindex="-1"></a></span>
<span id="cb87-9"><a href="simulace3.html#cb87-9" tabindex="-1"></a>model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb87-10"><a href="simulace3.html#cb87-10" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb87-11"><a href="simulace3.html#cb87-11" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb87-12"><a href="simulace3.html#cb87-12" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb87-13"><a href="simulace3.html#cb87-13" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-14"><a href="simulace3.html#cb87-14" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-15"><a href="simulace3.html#cb87-15" tabindex="-1"></a>            <span class="at">degree =</span> p.opt,</span>
<span id="cb87-16"><a href="simulace3.html#cb87-16" tabindex="-1"></a>            <span class="at">coef0 =</span> coef0,</span>
<span id="cb87-17"><a href="simulace3.html#cb87-17" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb87-18"><a href="simulace3.html#cb87-18" tabindex="-1"></a></span>
<span id="cb87-19"><a href="simulace3.html#cb87-19" tabindex="-1"></a>model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb87-20"><a href="simulace3.html#cb87-20" tabindex="-1"></a>            <span class="at">data =</span> ldata,</span>
<span id="cb87-21"><a href="simulace3.html#cb87-21" tabindex="-1"></a>            <span class="at">basis.x =</span> basis.x,</span>
<span id="cb87-22"><a href="simulace3.html#cb87-22" tabindex="-1"></a>            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb87-23"><a href="simulace3.html#cb87-23" tabindex="-1"></a>            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb87-24"><a href="simulace3.html#cb87-24" tabindex="-1"></a>            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb87-25"><a href="simulace3.html#cb87-25" tabindex="-1"></a>            <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb87-26"><a href="simulace3.html#cb87-26" tabindex="-1"></a>            <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb87-27"><a href="simulace3.html#cb87-27" tabindex="-1"></a></span>
<span id="cb87-28"><a href="simulace3.html#cb87-28" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb87-29"><a href="simulace3.html#cb87-29" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb87-30"><a href="simulace3.html#cb87-30" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-31"><a href="simulace3.html#cb87-31" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb87-32"><a href="simulace3.html#cb87-32" tabindex="-1"></a></span>
<span id="cb87-33"><a href="simulace3.html#cb87-33" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-34"><a href="simulace3.html#cb87-34" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb87-35"><a href="simulace3.html#cb87-35" tabindex="-1"></a></span>
<span id="cb87-36"><a href="simulace3.html#cb87-36" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-37"><a href="simulace3.html#cb87-37" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb87-38"><a href="simulace3.html#cb87-38" tabindex="-1"></a>  </span>
<span id="cb87-39"><a href="simulace3.html#cb87-39" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb87-40"><a href="simulace3.html#cb87-40" tabindex="-1"></a>newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb87-41"><a href="simulace3.html#cb87-41" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-42"><a href="simulace3.html#cb87-42" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb87-43"><a href="simulace3.html#cb87-43" tabindex="-1"></a></span>
<span id="cb87-44"><a href="simulace3.html#cb87-44" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-45"><a href="simulace3.html#cb87-45" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb87-46"><a href="simulace3.html#cb87-46" tabindex="-1"></a></span>
<span id="cb87-47"><a href="simulace3.html#cb87-47" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb87-48"><a href="simulace3.html#cb87-48" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is thus 5 % for the linear kernel, 11.4286 % for the polynomial kernel, and 2.8571 % for the Gaussian kernel. On the test data, the error rate of the method is 23.3333 % for the linear kernel, 26.6667 % for the polynomial kernel, and 13.3333 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb88"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb88-1"><a href="simulace3.html#cb88-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb88-2"><a href="simulace3.html#cb88-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb88-3"><a href="simulace3.html#cb88-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb88-4"><a href="simulace3.html#cb88-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb88-5"><a href="simulace3.html#cb88-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb88-6"><a href="simulace3.html#cb88-6" tabindex="-1"></a></span>
<span id="cb88-7"><a href="simulace3.html#cb88-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="diskr3" class="section level4 hasAnchor" number="1.3.7.2">
<h4><span class="header-section-number">1.3.7.2</span> Discretization of the Interval<a href="simulace3.html#diskr3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start by applying the support vector method directly to the discretized data (evaluating the function on a given grid of points over the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three aforementioned kernel functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb89"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb89-1"><a href="simulace3.html#cb89-1" tabindex="-1"></a><span class="co"># Set norms equal to one</span></span>
<span id="cb89-2"><a href="simulace3.html#cb89-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb89-3"><a href="simulace3.html#cb89-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb89-4"><a href="simulace3.html#cb89-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb89-5"><a href="simulace3.html#cb89-5" tabindex="-1"></a>}</span>
<span id="cb89-6"><a href="simulace3.html#cb89-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb89-7"><a href="simulace3.html#cb89-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb89-8"><a href="simulace3.html#cb89-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb89-9"><a href="simulace3.html#cb89-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb89-10"><a href="simulace3.html#cb89-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-11"><a href="simulace3.html#cb89-11" tabindex="-1"></a></span>
<span id="cb89-12"><a href="simulace3.html#cb89-12" tabindex="-1"></a><span class="co"># Split into test and training parts</span></span>
<span id="cb89-13"><a href="simulace3.html#cb89-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-14"><a href="simulace3.html#cb89-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-15"><a href="simulace3.html#cb89-15" tabindex="-1"></a></span>
<span id="cb89-16"><a href="simulace3.html#cb89-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb89-17"><a href="simulace3.html#cb89-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb89-18"><a href="simulace3.html#cb89-18" tabindex="-1"></a></span>
<span id="cb89-19"><a href="simulace3.html#cb89-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb89-20"><a href="simulace3.html#cb89-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb89-21"><a href="simulace3.html#cb89-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb89-22"><a href="simulace3.html#cb89-22" tabindex="-1"></a></span>
<span id="cb89-23"><a href="simulace3.html#cb89-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb89-24"><a href="simulace3.html#cb89-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb89-25"><a href="simulace3.html#cb89-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now, let’s attempt to estimate the hyperparameters of the classifiers from the data using 10-fold cross-validation. Since each kernel has different hyperparameters in its definition, we will approach each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, and we allow its optimal value to differ among kernels.</p>
<p>For all three kernels, we will go through the values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{0}, 10^{6}]\)</span>, while for the polynomial kernel we will fix the hyperparameter <span class="math inline">\(p\)</span> at a value of 3, since other integer values do not yield nearly as good results. On the other hand, for the radial kernel, we will use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-5}, 10^{-2}]\)</span>. We will set <code>coef0</code> to 1.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb90"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb90-1"><a href="simulace3.html#cb90-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb90-2"><a href="simulace3.html#cb90-2" tabindex="-1"></a></span>
<span id="cb90-3"><a href="simulace3.html#cb90-3" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb90-4"><a href="simulace3.html#cb90-4" tabindex="-1"></a></span>
<span id="cb90-5"><a href="simulace3.html#cb90-5" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb90-6"><a href="simulace3.html#cb90-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb90-7"><a href="simulace3.html#cb90-7" tabindex="-1"></a></span>
<span id="cb90-8"><a href="simulace3.html#cb90-8" tabindex="-1"></a><span class="co"># Values of gamma to consider</span></span>
<span id="cb90-9"><a href="simulace3.html#cb90-9" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb90-10"><a href="simulace3.html#cb90-10" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb90-11"><a href="simulace3.html#cb90-11" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb90-12"><a href="simulace3.html#cb90-12" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb90-13"><a href="simulace3.html#cb90-13" tabindex="-1"></a></span>
<span id="cb90-14"><a href="simulace3.html#cb90-14" tabindex="-1"></a><span class="co"># List with three components ... arrays for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb90-15"><a href="simulace3.html#cb90-15" tabindex="-1"></a><span class="co"># Empty matrices to store the results</span></span>
<span id="cb90-16"><a href="simulace3.html#cb90-16" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given C</span></span>
<span id="cb90-17"><a href="simulace3.html#cb90-17" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma, and layers correspond to folds</span></span>
<span id="cb90-18"><a href="simulace3.html#cb90-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb90-19"><a href="simulace3.html#cb90-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb90-20"><a href="simulace3.html#cb90-20" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb90-21"><a href="simulace3.html#cb90-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb90-22"><a href="simulace3.html#cb90-22" tabindex="-1"></a>)</span>
<span id="cb90-23"><a href="simulace3.html#cb90-23" tabindex="-1"></a></span>
<span id="cb90-24"><a href="simulace3.html#cb90-24" tabindex="-1"></a><span class="co"># First, we go through the values of C</span></span>
<span id="cb90-25"><a href="simulace3.html#cb90-25" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb90-26"><a href="simulace3.html#cb90-26" tabindex="-1"></a>  <span class="co"># Go through individual folds</span></span>
<span id="cb90-27"><a href="simulace3.html#cb90-27" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb90-28"><a href="simulace3.html#cb90-28" tabindex="-1"></a>    <span class="co"># Definition of test and training parts for CV</span></span>
<span id="cb90-29"><a href="simulace3.html#cb90-29" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb90-30"><a href="simulace3.html#cb90-30" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb90-31"><a href="simulace3.html#cb90-31" tabindex="-1"></a>    </span>
<span id="cb90-32"><a href="simulace3.html#cb90-32" tabindex="-1"></a>    data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb90-33"><a href="simulace3.html#cb90-33" tabindex="-1"></a>    data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb90-34"><a href="simulace3.html#cb90-34" tabindex="-1"></a>    </span>
<span id="cb90-35"><a href="simulace3.html#cb90-35" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb90-36"><a href="simulace3.html#cb90-36" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb90-37"><a href="simulace3.html#cb90-37" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb90-38"><a href="simulace3.html#cb90-38" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb90-39"><a href="simulace3.html#cb90-39" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-40"><a href="simulace3.html#cb90-40" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb90-41"><a href="simulace3.html#cb90-41" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb90-42"><a href="simulace3.html#cb90-42" tabindex="-1"></a>    </span>
<span id="cb90-43"><a href="simulace3.html#cb90-43" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb90-44"><a href="simulace3.html#cb90-44" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb90-45"><a href="simulace3.html#cb90-45" tabindex="-1"></a>    accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb90-46"><a href="simulace3.html#cb90-46" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb90-47"><a href="simulace3.html#cb90-47" tabindex="-1"></a>    </span>
<span id="cb90-48"><a href="simulace3.html#cb90-48" tabindex="-1"></a>    <span class="co"># Store accuracy for given C and fold</span></span>
<span id="cb90-49"><a href="simulace3.html#cb90-49" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb90-50"><a href="simulace3.html#cb90-50" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> accuracy.test.l</span>
<span id="cb90-51"><a href="simulace3.html#cb90-51" tabindex="-1"></a>    </span>
<span id="cb90-52"><a href="simulace3.html#cb90-52" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb90-53"><a href="simulace3.html#cb90-53" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb90-54"><a href="simulace3.html#cb90-54" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb90-55"><a href="simulace3.html#cb90-55" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb90-56"><a href="simulace3.html#cb90-56" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb90-57"><a href="simulace3.html#cb90-57" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-58"><a href="simulace3.html#cb90-58" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb90-59"><a href="simulace3.html#cb90-59" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb90-60"><a href="simulace3.html#cb90-60" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb90-61"><a href="simulace3.html#cb90-61" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb90-62"><a href="simulace3.html#cb90-62" tabindex="-1"></a>      </span>
<span id="cb90-63"><a href="simulace3.html#cb90-63" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb90-64"><a href="simulace3.html#cb90-64" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb90-65"><a href="simulace3.html#cb90-65" tabindex="-1"></a>      accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb90-66"><a href="simulace3.html#cb90-66" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb90-67"><a href="simulace3.html#cb90-67" tabindex="-1"></a>      </span>
<span id="cb90-68"><a href="simulace3.html#cb90-68" tabindex="-1"></a>      <span class="co"># Store accuracy for given C, p, and fold</span></span>
<span id="cb90-69"><a href="simulace3.html#cb90-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb90-70"><a href="simulace3.html#cb90-70" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb90-71"><a href="simulace3.html#cb90-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.p</span>
<span id="cb90-72"><a href="simulace3.html#cb90-72" tabindex="-1"></a>    }</span>
<span id="cb90-73"><a href="simulace3.html#cb90-73" tabindex="-1"></a>        </span>
<span id="cb90-74"><a href="simulace3.html#cb90-74" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb90-75"><a href="simulace3.html#cb90-75" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb90-76"><a href="simulace3.html#cb90-76" tabindex="-1"></a>      <span class="co"># Model construction</span></span>
<span id="cb90-77"><a href="simulace3.html#cb90-77" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb90-78"><a href="simulace3.html#cb90-78" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb90-79"><a href="simulace3.html#cb90-79" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb90-80"><a href="simulace3.html#cb90-80" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb90-81"><a href="simulace3.html#cb90-81" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb90-82"><a href="simulace3.html#cb90-82" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb90-83"><a href="simulace3.html#cb90-83" tabindex="-1"></a>      </span>
<span id="cb90-84"><a href="simulace3.html#cb90-84" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb90-85"><a href="simulace3.html#cb90-85" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb90-86"><a href="simulace3.html#cb90-86" tabindex="-1"></a>      accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb90-87"><a href="simulace3.html#cb90-87" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb90-88"><a href="simulace3.html#cb90-88" tabindex="-1"></a>      </span>
<span id="cb90-89"><a href="simulace3.html#cb90-89" tabindex="-1"></a>      <span class="co"># Store accuracy for given C, gamma, and fold</span></span>
<span id="cb90-90"><a href="simulace3.html#cb90-90" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb90-91"><a href="simulace3.html#cb90-91" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb90-92"><a href="simulace3.html#cb90-92" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> accuracy.test.r</span>
<span id="cb90-93"><a href="simulace3.html#cb90-93" tabindex="-1"></a>    }</span>
<span id="cb90-94"><a href="simulace3.html#cb90-94" tabindex="-1"></a>  }</span>
<span id="cb90-95"><a href="simulace3.html#cb90-95" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now, let’s average the results of the 10-fold CV so that for each value of the hyperparameter (or one combination of values), we have one estimate of the validation error. In this process, we will also determine the optimal values for the individual hyperparameters.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb91"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb91-1"><a href="simulace3.html#cb91-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each C across folds</span></span>
<span id="cb91-2"><a href="simulace3.html#cb91-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb91-3"><a href="simulace3.html#cb91-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb91-4"><a href="simulace3.html#cb91-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb91-5"><a href="simulace3.html#cb91-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb91-6"><a href="simulace3.html#cb91-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb91-7"><a href="simulace3.html#cb91-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb91-8"><a href="simulace3.html#cb91-8" tabindex="-1"></a></span>
<span id="cb91-9"><a href="simulace3.html#cb91-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb91-10"><a href="simulace3.html#cb91-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb91-11"><a href="simulace3.html#cb91-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb91-12"><a href="simulace3.html#cb91-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb91-13"><a href="simulace3.html#cb91-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb91-14"><a href="simulace3.html#cb91-14" tabindex="-1"></a></span>
<span id="cb91-15"><a href="simulace3.html#cb91-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb91-16"><a href="simulace3.html#cb91-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb91-17"><a href="simulace3.html#cb91-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb91-18"><a href="simulace3.html#cb91-18" tabindex="-1"></a></span>
<span id="cb91-19"><a href="simulace3.html#cb91-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb91-20"><a href="simulace3.html#cb91-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb91-21"><a href="simulace3.html#cb91-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb91-22"><a href="simulace3.html#cb91-22" tabindex="-1"></a></span>
<span id="cb91-23"><a href="simulace3.html#cb91-23" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb91-24"><a href="simulace3.html#cb91-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb91-25"><a href="simulace3.html#cb91-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For the <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 100, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is 10, and for the <em>radial kernel</em>, we have two optimal values: for <span class="math inline">\(C\)</span>, the optimal value is 10^{6}, and for <span class="math inline">\(\gamma\)</span>, it is 0. The validation errors are 0.0875733 for linear, 0.160815 for polynomial, and 0.0859066 for radial kernels.</p>
<p>Finally, we can construct the final classifiers on the entire training data with the hyperparameter values determined by 10-fold CV. We will also determine the errors on both test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb92"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb92-1"><a href="simulace3.html#cb92-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb92-2"><a href="simulace3.html#cb92-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb92-3"><a href="simulace3.html#cb92-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb92-4"><a href="simulace3.html#cb92-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-5"><a href="simulace3.html#cb92-5" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb92-6"><a href="simulace3.html#cb92-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb92-7"><a href="simulace3.html#cb92-7" tabindex="-1"></a></span>
<span id="cb92-8"><a href="simulace3.html#cb92-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb92-9"><a href="simulace3.html#cb92-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb92-10"><a href="simulace3.html#cb92-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb92-11"><a href="simulace3.html#cb92-11" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb92-12"><a href="simulace3.html#cb92-12" tabindex="-1"></a>                 <span class="at">degree =</span> p.opt,</span>
<span id="cb92-13"><a href="simulace3.html#cb92-13" tabindex="-1"></a>                 <span class="at">coef0 =</span> coef0,</span>
<span id="cb92-14"><a href="simulace3.html#cb92-14" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb92-15"><a href="simulace3.html#cb92-15" tabindex="-1"></a></span>
<span id="cb92-16"><a href="simulace3.html#cb92-16" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb92-17"><a href="simulace3.html#cb92-17" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb92-18"><a href="simulace3.html#cb92-18" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb92-19"><a href="simulace3.html#cb92-19" tabindex="-1"></a>                 <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb92-20"><a href="simulace3.html#cb92-20" tabindex="-1"></a>                 <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb92-21"><a href="simulace3.html#cb92-21" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb92-22"><a href="simulace3.html#cb92-22" tabindex="-1"></a></span>
<span id="cb92-23"><a href="simulace3.html#cb92-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb92-24"><a href="simulace3.html#cb92-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb92-25"><a href="simulace3.html#cb92-25" tabindex="-1"></a>accuracy.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb92-26"><a href="simulace3.html#cb92-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb92-27"><a href="simulace3.html#cb92-27" tabindex="-1"></a></span>
<span id="cb92-28"><a href="simulace3.html#cb92-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb92-29"><a href="simulace3.html#cb92-29" tabindex="-1"></a>accuracy.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb92-30"><a href="simulace3.html#cb92-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb92-31"><a href="simulace3.html#cb92-31" tabindex="-1"></a></span>
<span id="cb92-32"><a href="simulace3.html#cb92-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb92-33"><a href="simulace3.html#cb92-33" tabindex="-1"></a>accuracy.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb92-34"><a href="simulace3.html#cb92-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb92-35"><a href="simulace3.html#cb92-35" tabindex="-1"></a></span>
<span id="cb92-36"><a href="simulace3.html#cb92-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb92-37"><a href="simulace3.html#cb92-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb92-38"><a href="simulace3.html#cb92-38" tabindex="-1"></a>accuracy.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb92-39"><a href="simulace3.html#cb92-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb92-40"><a href="simulace3.html#cb92-40" tabindex="-1"></a></span>
<span id="cb92-41"><a href="simulace3.html#cb92-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb92-42"><a href="simulace3.html#cb92-42" tabindex="-1"></a>accuracy.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb92-43"><a href="simulace3.html#cb92-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb92-44"><a href="simulace3.html#cb92-44" tabindex="-1"></a></span>
<span id="cb92-45"><a href="simulace3.html#cb92-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb92-46"><a href="simulace3.html#cb92-46" tabindex="-1"></a>accuracy.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb92-47"><a href="simulace3.html#cb92-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is 5.7143 % for the linear kernel, 9.2857 % for the polynomial kernel, and 2.1429 % for the Gaussian kernel. On the test data, the error rate is 16.6667 % for the linear kernel, 21.6667 % for the polynomial kernel, and 11.6667 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb93"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb93-1"><a href="simulace3.html#cb93-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb93-2"><a href="simulace3.html#cb93-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb93-3"><a href="simulace3.html#cb93-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb93-4"><a href="simulace3.html#cb93-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train.l, accuracy.train.p, accuracy.train.r),</span>
<span id="cb93-5"><a href="simulace3.html#cb93-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.test.l, accuracy.test.p, accuracy.test.r))</span>
<span id="cb93-6"><a href="simulace3.html#cb93-6" tabindex="-1"></a></span>
<span id="cb93-7"><a href="simulace3.html#cb93-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="PCA-SVM3" class="section level4 hasAnchor" number="1.3.7.3">
<h4><span class="header-section-number">1.3.7.3</span> Principal Component Scores<a href="simulace3.html#PCA-SVM3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we use the scores of the first <span class="math inline">\(p =\)</span> 2 principal components.</p>
<p>Now, let’s try, unlike the approach in previous chapters, to estimate the classifier hyperparameters from the data using 10-fold cross-validation. Given that each kernel has different hyperparameters in its definition, we will treat each kernel function separately. However, the hyperparameter <span class="math inline">\(C\)</span> appears in all kernel functions, although we allow that its optimal value may differ between kernels.</p>
<p>For all three kernels, we will test values of the hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{-3}, 10^{4}]\)</span>. For the polynomial kernel, we fix the hyperparameter <span class="math inline">\(p\)</span> at the value of 3, as for other integer values, the method does not give nearly as good results. In contrast, for the radial kernel, we will use 10-fold CV to choose the optimal value of the hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-4}, 10^{-1}]\)</span>. We set <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb94"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb94-1"><a href="simulace3.html#cb94-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb94-2"><a href="simulace3.html#cb94-2" tabindex="-1"></a></span>
<span id="cb94-3"><a href="simulace3.html#cb94-3" tabindex="-1"></a><span class="co"># gamma values to consider</span></span>
<span id="cb94-4"><a href="simulace3.html#cb94-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb94-5"><a href="simulace3.html#cb94-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">8</span>)</span>
<span id="cb94-6"><a href="simulace3.html#cb94-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb94-7"><a href="simulace3.html#cb94-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb94-8"><a href="simulace3.html#cb94-8" tabindex="-1"></a></span>
<span id="cb94-9"><a href="simulace3.html#cb94-9" tabindex="-1"></a><span class="co"># list with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb94-10"><a href="simulace3.html#cb94-10" tabindex="-1"></a><span class="co"># empty matrix to store results</span></span>
<span id="cb94-11"><a href="simulace3.html#cb94-11" tabindex="-1"></a><span class="co"># columns will have accuracy values for a given</span></span>
<span id="cb94-12"><a href="simulace3.html#cb94-12" tabindex="-1"></a><span class="co"># rows will have values for given gamma and layers correspond to folds</span></span>
<span id="cb94-13"><a href="simulace3.html#cb94-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb94-14"><a href="simulace3.html#cb94-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb94-15"><a href="simulace3.html#cb94-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb94-16"><a href="simulace3.html#cb94-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb94-17"><a href="simulace3.html#cb94-17" tabindex="-1"></a>)</span>
<span id="cb94-18"><a href="simulace3.html#cb94-18" tabindex="-1"></a></span>
<span id="cb94-19"><a href="simulace3.html#cb94-19" tabindex="-1"></a><span class="co"># first, go through C values</span></span>
<span id="cb94-20"><a href="simulace3.html#cb94-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb94-21"><a href="simulace3.html#cb94-21" tabindex="-1"></a>  <span class="co"># iterate over each fold</span></span>
<span id="cb94-22"><a href="simulace3.html#cb94-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb94-23"><a href="simulace3.html#cb94-23" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb94-24"><a href="simulace3.html#cb94-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb94-25"><a href="simulace3.html#cb94-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb94-26"><a href="simulace3.html#cb94-26" tabindex="-1"></a>    </span>
<span id="cb94-27"><a href="simulace3.html#cb94-27" tabindex="-1"></a>    data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb94-28"><a href="simulace3.html#cb94-28" tabindex="-1"></a>    data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb94-29"><a href="simulace3.html#cb94-29" tabindex="-1"></a>    </span>
<span id="cb94-30"><a href="simulace3.html#cb94-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb94-31"><a href="simulace3.html#cb94-31" tabindex="-1"></a>    <span class="co"># build model</span></span>
<span id="cb94-32"><a href="simulace3.html#cb94-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb94-33"><a href="simulace3.html#cb94-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb94-34"><a href="simulace3.html#cb94-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb94-35"><a href="simulace3.html#cb94-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb94-36"><a href="simulace3.html#cb94-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb94-37"><a href="simulace3.html#cb94-37" tabindex="-1"></a>    </span>
<span id="cb94-38"><a href="simulace3.html#cb94-38" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb94-39"><a href="simulace3.html#cb94-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb94-40"><a href="simulace3.html#cb94-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb94-41"><a href="simulace3.html#cb94-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb94-42"><a href="simulace3.html#cb94-42" tabindex="-1"></a>    </span>
<span id="cb94-43"><a href="simulace3.html#cb94-43" tabindex="-1"></a>    <span class="co"># store accuracies for given C and fold</span></span>
<span id="cb94-44"><a href="simulace3.html#cb94-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb94-45"><a href="simulace3.html#cb94-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb94-46"><a href="simulace3.html#cb94-46" tabindex="-1"></a>    </span>
<span id="cb94-47"><a href="simulace3.html#cb94-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb94-48"><a href="simulace3.html#cb94-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb94-49"><a href="simulace3.html#cb94-49" tabindex="-1"></a>      <span class="co"># build model</span></span>
<span id="cb94-50"><a href="simulace3.html#cb94-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb94-51"><a href="simulace3.html#cb94-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb94-52"><a href="simulace3.html#cb94-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb94-53"><a href="simulace3.html#cb94-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb94-54"><a href="simulace3.html#cb94-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb94-55"><a href="simulace3.html#cb94-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb94-56"><a href="simulace3.html#cb94-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb94-57"><a href="simulace3.html#cb94-57" tabindex="-1"></a>      </span>
<span id="cb94-58"><a href="simulace3.html#cb94-58" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb94-59"><a href="simulace3.html#cb94-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb94-60"><a href="simulace3.html#cb94-60" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb94-61"><a href="simulace3.html#cb94-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb94-62"><a href="simulace3.html#cb94-62" tabindex="-1"></a>      </span>
<span id="cb94-63"><a href="simulace3.html#cb94-63" tabindex="-1"></a>      <span class="co"># store accuracies for given C, p, and fold</span></span>
<span id="cb94-64"><a href="simulace3.html#cb94-64" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb94-65"><a href="simulace3.html#cb94-65" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb94-66"><a href="simulace3.html#cb94-66" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb94-67"><a href="simulace3.html#cb94-67" tabindex="-1"></a>    }</span>
<span id="cb94-68"><a href="simulace3.html#cb94-68" tabindex="-1"></a>        </span>
<span id="cb94-69"><a href="simulace3.html#cb94-69" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb94-70"><a href="simulace3.html#cb94-70" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb94-71"><a href="simulace3.html#cb94-71" tabindex="-1"></a>      <span class="co"># build model</span></span>
<span id="cb94-72"><a href="simulace3.html#cb94-72" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb94-73"><a href="simulace3.html#cb94-73" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb94-74"><a href="simulace3.html#cb94-74" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb94-75"><a href="simulace3.html#cb94-75" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb94-76"><a href="simulace3.html#cb94-76" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb94-77"><a href="simulace3.html#cb94-77" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb94-78"><a href="simulace3.html#cb94-78" tabindex="-1"></a>      </span>
<span id="cb94-79"><a href="simulace3.html#cb94-79" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb94-80"><a href="simulace3.html#cb94-80" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb94-81"><a href="simulace3.html#cb94-81" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb94-82"><a href="simulace3.html#cb94-82" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb94-83"><a href="simulace3.html#cb94-83" tabindex="-1"></a>      </span>
<span id="cb94-84"><a href="simulace3.html#cb94-84" tabindex="-1"></a>      <span class="co"># store accuracies for given C, gamma, and fold</span></span>
<span id="cb94-85"><a href="simulace3.html#cb94-85" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb94-86"><a href="simulace3.html#cb94-86" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb94-87"><a href="simulace3.html#cb94-87" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb94-88"><a href="simulace3.html#cb94-88" tabindex="-1"></a>    }</span>
<span id="cb94-89"><a href="simulace3.html#cb94-89" tabindex="-1"></a>  }</span>
<span id="cb94-90"><a href="simulace3.html#cb94-90" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results of the 10-fold CV to obtain a single estimate of validation error for each hyperparameter value (or combination of values). We also determine the optimal values of each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb95"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb95-1"><a href="simulace3.html#cb95-1" tabindex="-1"></a><span class="co"># calculate average accuracies for individual C over folds</span></span>
<span id="cb95-2"><a href="simulace3.html#cb95-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb95-3"><a href="simulace3.html#cb95-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb95-4"><a href="simulace3.html#cb95-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb95-5"><a href="simulace3.html#cb95-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb95-6"><a href="simulace3.html#cb95-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb95-7"><a href="simulace3.html#cb95-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb95-8"><a href="simulace3.html#cb95-8" tabindex="-1"></a></span>
<span id="cb95-9"><a href="simulace3.html#cb95-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb95-10"><a href="simulace3.html#cb95-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb95-11"><a href="simulace3.html#cb95-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb95-12"><a href="simulace3.html#cb95-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb95-13"><a href="simulace3.html#cb95-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb95-14"><a href="simulace3.html#cb95-14" tabindex="-1"></a></span>
<span id="cb95-15"><a href="simulace3.html#cb95-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb95-16"><a href="simulace3.html#cb95-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb95-17"><a href="simulace3.html#cb95-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb95-18"><a href="simulace3.html#cb95-18" tabindex="-1"></a></span>
<span id="cb95-19"><a href="simulace3.html#cb95-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb95-20"><a href="simulace3.html#cb95-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb95-21"><a href="simulace3.html#cb95-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb95-22"><a href="simulace3.html#cb95-22" tabindex="-1"></a></span>
<span id="cb95-23"><a href="simulace3.html#cb95-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb95-24"><a href="simulace3.html#cb95-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb95-25"><a href="simulace3.html#cb95-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s look at how the optimal values turned out. For the <em>linear kernel</em>, the optimal value of <span class="math inline">\(C\)</span> is 10, for the <em>polynomial kernel</em> <span class="math inline">\(C\)</span> is 0.01, and for the <em>radial kernel</em>, there are two optimal values: <span class="math inline">\(C\)</span> is 10^{4} and <span class="math inline">\(\gamma\)</span> is 0.001. The validation errors are 0.4097253 for linear, 0.4287454 for polynomial, and 0.3906502 for the radial kernel.</p>
<p>Finally, we can construct the final classifiers on the entire training dataset with hyperparameter values determined using 10-fold CV. We also calculate errors on the test and training datasets.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb96"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb96-1"><a href="simulace3.html#cb96-1" tabindex="-1"></a><span class="co"># build model</span></span>
<span id="cb96-2"><a href="simulace3.html#cb96-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb96-3"><a href="simulace3.html#cb96-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb96-4"><a href="simulace3.html#cb96-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb96-5"><a href="simulace3.html#cb96-5" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb96-6"><a href="simulace3.html#cb96-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb96-7"><a href="simulace3.html#cb96-7" tabindex="-1"></a></span>
<span id="cb96-8"><a href="simulace3.html#cb96-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb96-9"><a href="simulace3.html#cb96-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb96-10"><a href="simulace3.html#cb96-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb96-11"><a href="simulace3.html#cb96-11" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb96-12"><a href="simulace3.html#cb96-12" tabindex="-1"></a>                     <span class="at">degree =</span> p.opt,</span>
<span id="cb96-13"><a href="simulace3.html#cb96-13" tabindex="-1"></a>                     <span class="at">coef0 =</span> coef0,</span>
<span id="cb96-14"><a href="simulace3.html#cb96-14" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb96-15"><a href="simulace3.html#cb96-15" tabindex="-1"></a></span>
<span id="cb96-16"><a href="simulace3.html#cb96-16" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb96-17"><a href="simulace3.html#cb96-17" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb96-18"><a href="simulace3.html#cb96-18" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb96-19"><a href="simulace3.html#cb96-19" tabindex="-1"></a>                     <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb96-20"><a href="simulace3.html#cb96-20" tabindex="-1"></a>                     <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb96-21"><a href="simulace3.html#cb96-21" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb96-22"><a href="simulace3.html#cb96-22" tabindex="-1"></a></span>
<span id="cb96-23"><a href="simulace3.html#cb96-23" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb96-24"><a href="simulace3.html#cb96-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb96-25"><a href="simulace3.html#cb96-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb96-26"><a href="simulace3.html#cb96-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb96-27"><a href="simulace3.html#cb96-27" tabindex="-1"></a></span>
<span id="cb96-28"><a href="simulace3.html#cb96-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb96-29"><a href="simulace3.html#cb96-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb96-30"><a href="simulace3.html#cb96-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb96-31"><a href="simulace3.html#cb96-31" tabindex="-1"></a></span>
<span id="cb96-32"><a href="simulace3.html#cb96-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb96-33"><a href="simulace3.html#cb96-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb96-34"><a href="simulace3.html#cb96-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb96-35"><a href="simulace3.html#cb96-35" tabindex="-1"></a>  </span>
<span id="cb96-36"><a href="simulace3.html#cb96-36" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb96-37"><a href="simulace3.html#cb96-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb96-38"><a href="simulace3.html#cb96-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb96-39"><a href="simulace3.html#cb96-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb96-40"><a href="simulace3.html#cb96-40" tabindex="-1"></a></span>
<span id="cb96-41"><a href="simulace3.html#cb96-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb96-42"><a href="simulace3.html#cb96-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb96-43"><a href="simulace3.html#cb96-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb96-44"><a href="simulace3.html#cb96-44" tabindex="-1"></a></span>
<span id="cb96-45"><a href="simulace3.html#cb96-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb96-46"><a href="simulace3.html#cb96-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb96-47"><a href="simulace3.html#cb96-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The training accuracies are 0.6 for linear, 0.5928571 for polynomial, and 0.6357143 for radial kernels, and the test accuracies are 0.6 for linear, 0.6 for polynomial, and 0.5833333 for radial.</p>
<p>To visualize the method, we can plot the decision boundary on a graph of the scores for the first two principal components. We compute this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as in previous cases where we also plotted the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb97"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb97-1"><a href="simulace3.html#cb97-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb97-2"><a href="simulace3.html#cb97-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb97-3"><a href="simulace3.html#cb97-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb97-4"><a href="simulace3.html#cb97-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb97-5"><a href="simulace3.html#cb97-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb97-6"><a href="simulace3.html#cb97-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb97-7"><a href="simulace3.html#cb97-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb97-8"><a href="simulace3.html#cb97-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))) <span class="sc">|&gt;</span></span>
<span id="cb97-9"><a href="simulace3.html#cb97-9" tabindex="-1"></a>     <span class="fu">as.factor</span>())</span>
<span id="cb97-10"><a href="simulace3.html#cb97-10" tabindex="-1"></a></span>
<span id="cb97-11"><a href="simulace3.html#cb97-11" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb97-12"><a href="simulace3.html#cb97-12" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb97-13"><a href="simulace3.html#cb97-13" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variance&#39;</span>, </span>
<span id="cb97-14"><a href="simulace3.html#cb97-14" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb97-15"><a href="simulace3.html#cb97-15" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb97-16"><a href="simulace3.html#cb97-16" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb97-17"><a href="simulace3.html#cb97-17" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Fat Content&#39;</span>, </span>
<span id="cb97-18"><a href="simulace3.html#cb97-18" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span></span>
<span id="cb97-19"><a href="simulace3.html#cb97-19" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&quot;low&quot;</span>, <span class="st">&quot;high&quot;</span>)) <span class="sc">+</span></span>
<span id="cb97-20"><a href="simulace3.html#cb97-20" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb97-21"><a href="simulace3.html#cb97-21" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb97-22"><a href="simulace3.html#cb97-22" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-91"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-91-1.png" alt="Scores of the first two principal components, color-coded by classification group. The decision boundary (either a line or curves in the plane of the first two principal components) between classes is displayed in black, created using the SVM method." width="672" />
<p class="caption">
Figure 1.23: Scores of the first two principal components, color-coded by classification group. The decision boundary (either a line or curves in the plane of the first two principal components) between classes is displayed in black, created using the SVM method.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb98"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb98-1"><a href="simulace3.html#cb98-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb98-2"><a href="simulace3.html#cb98-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb98-3"><a href="simulace3.html#cb98-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb98-4"><a href="simulace3.html#cb98-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb98-5"><a href="simulace3.html#cb98-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb98-6"><a href="simulace3.html#cb98-6" tabindex="-1"></a></span>
<span id="cb98-7"><a href="simulace3.html#cb98-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="basis-SVM3" class="section level4 hasAnchor" number="1.3.7.4">
<h4><span class="header-section-number">1.3.7.4</span> Basis Coefficients<a href="simulace3.html#basis-SVM3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we use a B-spline basis to express the functions. For all three kernels, we examine the values of hyperparameter <span class="math inline">\(C\)</span> in the interval <span class="math inline">\([10^{1}, 10^{4}]\)</span>. For the polynomial kernel, we fix the hyperparameter <span class="math inline">\(p\)</span> at 3, as other integer values do not yield nearly as good results. On the other hand, for the radial kernel, we again use 10-fold CV to select the optimal value of hyperparameter <span class="math inline">\(\gamma\)</span>, considering values in the interval <span class="math inline">\([10^{-4}, 10^{-1}]\)</span>. We set <code>coef0</code> <span class="math inline">\(= 1\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb99"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb99-1"><a href="simulace3.html#cb99-1" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb99-2"><a href="simulace3.html#cb99-2" tabindex="-1"></a></span>
<span id="cb99-3"><a href="simulace3.html#cb99-3" tabindex="-1"></a><span class="co"># gamma values to consider</span></span>
<span id="cb99-4"><a href="simulace3.html#cb99-4" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">7</span>)</span>
<span id="cb99-5"><a href="simulace3.html#cb99-5" tabindex="-1"></a>C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">10</span>)</span>
<span id="cb99-6"><a href="simulace3.html#cb99-6" tabindex="-1"></a>p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb99-7"><a href="simulace3.html#cb99-7" tabindex="-1"></a>coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb99-8"><a href="simulace3.html#cb99-8" tabindex="-1"></a></span>
<span id="cb99-9"><a href="simulace3.html#cb99-9" tabindex="-1"></a><span class="co"># list with three components...array for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb99-10"><a href="simulace3.html#cb99-10" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb99-11"><a href="simulace3.html#cb99-11" tabindex="-1"></a><span class="co"># columns hold accuracy values for given</span></span>
<span id="cb99-12"><a href="simulace3.html#cb99-12" tabindex="-1"></a><span class="co"># rows represent values for given gamma, and layers correspond to folds</span></span>
<span id="cb99-13"><a href="simulace3.html#cb99-13" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb99-14"><a href="simulace3.html#cb99-14" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb99-15"><a href="simulace3.html#cb99-15" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb99-16"><a href="simulace3.html#cb99-16" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb99-17"><a href="simulace3.html#cb99-17" tabindex="-1"></a>)</span>
<span id="cb99-18"><a href="simulace3.html#cb99-18" tabindex="-1"></a></span>
<span id="cb99-19"><a href="simulace3.html#cb99-19" tabindex="-1"></a><span class="co"># first iterate through values of C</span></span>
<span id="cb99-20"><a href="simulace3.html#cb99-20" tabindex="-1"></a><span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb99-21"><a href="simulace3.html#cb99-21" tabindex="-1"></a>  <span class="co"># iterate over individual folds</span></span>
<span id="cb99-22"><a href="simulace3.html#cb99-22" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb99-23"><a href="simulace3.html#cb99-23" tabindex="-1"></a>    <span class="co"># define test and training parts for CV</span></span>
<span id="cb99-24"><a href="simulace3.html#cb99-24" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb99-25"><a href="simulace3.html#cb99-25" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb99-26"><a href="simulace3.html#cb99-26" tabindex="-1"></a>    </span>
<span id="cb99-27"><a href="simulace3.html#cb99-27" tabindex="-1"></a>    data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb99-28"><a href="simulace3.html#cb99-28" tabindex="-1"></a>    data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb99-29"><a href="simulace3.html#cb99-29" tabindex="-1"></a>    </span>
<span id="cb99-30"><a href="simulace3.html#cb99-30" tabindex="-1"></a>    <span class="do">## LINEAR KERNEL</span></span>
<span id="cb99-31"><a href="simulace3.html#cb99-31" tabindex="-1"></a>    <span class="co"># model creation</span></span>
<span id="cb99-32"><a href="simulace3.html#cb99-32" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb99-33"><a href="simulace3.html#cb99-33" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb99-34"><a href="simulace3.html#cb99-34" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-35"><a href="simulace3.html#cb99-35" tabindex="-1"></a>                     <span class="at">cost =</span> C,</span>
<span id="cb99-36"><a href="simulace3.html#cb99-36" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb99-37"><a href="simulace3.html#cb99-37" tabindex="-1"></a>    </span>
<span id="cb99-38"><a href="simulace3.html#cb99-38" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb99-39"><a href="simulace3.html#cb99-39" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb99-40"><a href="simulace3.html#cb99-40" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb99-41"><a href="simulace3.html#cb99-41" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb99-42"><a href="simulace3.html#cb99-42" tabindex="-1"></a>    </span>
<span id="cb99-43"><a href="simulace3.html#cb99-43" tabindex="-1"></a>    <span class="co"># insert accuracies in positions for given C and fold</span></span>
<span id="cb99-44"><a href="simulace3.html#cb99-44" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb99-45"><a href="simulace3.html#cb99-45" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb99-46"><a href="simulace3.html#cb99-46" tabindex="-1"></a>    </span>
<span id="cb99-47"><a href="simulace3.html#cb99-47" tabindex="-1"></a>    <span class="do">## POLYNOMIAL KERNEL</span></span>
<span id="cb99-48"><a href="simulace3.html#cb99-48" tabindex="-1"></a>    <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb99-49"><a href="simulace3.html#cb99-49" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb99-50"><a href="simulace3.html#cb99-50" tabindex="-1"></a>      clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb99-51"><a href="simulace3.html#cb99-51" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb99-52"><a href="simulace3.html#cb99-52" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-53"><a href="simulace3.html#cb99-53" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb99-54"><a href="simulace3.html#cb99-54" tabindex="-1"></a>                       <span class="at">coef0 =</span> coef0,</span>
<span id="cb99-55"><a href="simulace3.html#cb99-55" tabindex="-1"></a>                       <span class="at">degree =</span> p,</span>
<span id="cb99-56"><a href="simulace3.html#cb99-56" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb99-57"><a href="simulace3.html#cb99-57" tabindex="-1"></a>      </span>
<span id="cb99-58"><a href="simulace3.html#cb99-58" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb99-59"><a href="simulace3.html#cb99-59" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb99-60"><a href="simulace3.html#cb99-60" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb99-61"><a href="simulace3.html#cb99-61" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb99-62"><a href="simulace3.html#cb99-62" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb99-63"><a href="simulace3.html#cb99-63" tabindex="-1"></a>      </span>
<span id="cb99-64"><a href="simulace3.html#cb99-64" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, p, and fold</span></span>
<span id="cb99-65"><a href="simulace3.html#cb99-65" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb99-66"><a href="simulace3.html#cb99-66" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb99-67"><a href="simulace3.html#cb99-67" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb99-68"><a href="simulace3.html#cb99-68" tabindex="-1"></a>    }</span>
<span id="cb99-69"><a href="simulace3.html#cb99-69" tabindex="-1"></a>        </span>
<span id="cb99-70"><a href="simulace3.html#cb99-70" tabindex="-1"></a>    <span class="do">## RADIAL KERNEL</span></span>
<span id="cb99-71"><a href="simulace3.html#cb99-71" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb99-72"><a href="simulace3.html#cb99-72" tabindex="-1"></a>      <span class="co"># model creation</span></span>
<span id="cb99-73"><a href="simulace3.html#cb99-73" tabindex="-1"></a>      clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb99-74"><a href="simulace3.html#cb99-74" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb99-75"><a href="simulace3.html#cb99-75" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb99-76"><a href="simulace3.html#cb99-76" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb99-77"><a href="simulace3.html#cb99-77" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma,</span>
<span id="cb99-78"><a href="simulace3.html#cb99-78" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb99-79"><a href="simulace3.html#cb99-79" tabindex="-1"></a>      </span>
<span id="cb99-80"><a href="simulace3.html#cb99-80" tabindex="-1"></a>      <span class="co"># accuracy on validation data</span></span>
<span id="cb99-81"><a href="simulace3.html#cb99-81" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb99-82"><a href="simulace3.html#cb99-82" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb99-83"><a href="simulace3.html#cb99-83" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb99-84"><a href="simulace3.html#cb99-84" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb99-85"><a href="simulace3.html#cb99-85" tabindex="-1"></a>      </span>
<span id="cb99-86"><a href="simulace3.html#cb99-86" tabindex="-1"></a>      <span class="co"># insert accuracies in positions for given C, gamma, and fold</span></span>
<span id="cb99-87"><a href="simulace3.html#cb99-87" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb99-88"><a href="simulace3.html#cb99-88" tabindex="-1"></a>                       (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb99-89"><a href="simulace3.html#cb99-89" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb99-90"><a href="simulace3.html#cb99-90" tabindex="-1"></a>    }</span>
<span id="cb99-91"><a href="simulace3.html#cb99-91" tabindex="-1"></a>  }</span>
<span id="cb99-92"><a href="simulace3.html#cb99-92" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we average the results from 10-fold CV so that we have a single estimate of validation error for each hyperparameter value (or combination of values). We also determine the optimal values of each hyperparameter.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb100"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb100-1"><a href="simulace3.html#cb100-1" tabindex="-1"></a><span class="co"># calculate average accuracies for each C across folds</span></span>
<span id="cb100-2"><a href="simulace3.html#cb100-2" tabindex="-1"></a><span class="do">## Linear kernel</span></span>
<span id="cb100-3"><a href="simulace3.html#cb100-3" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb100-4"><a href="simulace3.html#cb100-4" tabindex="-1"></a><span class="do">## Polynomial kernel</span></span>
<span id="cb100-5"><a href="simulace3.html#cb100-5" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb100-6"><a href="simulace3.html#cb100-6" tabindex="-1"></a><span class="do">## Radial kernel</span></span>
<span id="cb100-7"><a href="simulace3.html#cb100-7" tabindex="-1"></a>CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb100-8"><a href="simulace3.html#cb100-8" tabindex="-1"></a></span>
<span id="cb100-9"><a href="simulace3.html#cb100-9" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb100-10"><a href="simulace3.html#cb100-10" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb100-11"><a href="simulace3.html#cb100-11" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb100-12"><a href="simulace3.html#cb100-12" tabindex="-1"></a>C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb100-13"><a href="simulace3.html#cb100-13" tabindex="-1"></a>C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb100-14"><a href="simulace3.html#cb100-14" tabindex="-1"></a></span>
<span id="cb100-15"><a href="simulace3.html#cb100-15" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb100-16"><a href="simulace3.html#cb100-16" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb100-17"><a href="simulace3.html#cb100-17" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb100-18"><a href="simulace3.html#cb100-18" tabindex="-1"></a></span>
<span id="cb100-19"><a href="simulace3.html#cb100-19" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb100-20"><a href="simulace3.html#cb100-20" tabindex="-1"></a>p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb100-21"><a href="simulace3.html#cb100-21" tabindex="-1"></a>p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb100-22"><a href="simulace3.html#cb100-22" tabindex="-1"></a></span>
<span id="cb100-23"><a href="simulace3.html#cb100-23" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb100-24"><a href="simulace3.html#cb100-24" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb100-25"><a href="simulace3.html#cb100-25" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span></code></pre></div>
</details>
<p>Let’s see how the optimal values turned out. For the <em>linear kernel</em>, the optimal <span class="math inline">\(C\)</span> value is 100, for the <em>polynomial kernel</em>, <span class="math inline">\(C\)</span> is 215.4435, and for the <em>radial kernel</em>, we have two optimal values: <span class="math inline">\(C\)</span> is 4641.5888, and <span class="math inline">\(\gamma\)</span> is 10^{-4}. The validation error rates are 0.0929762 for linear, 0.1542537 for polynomial, and 0.1319048 for radial kernels.</p>
<p>Finally, we can construct the final classifiers on the entire training dataset using the hyperparameter values determined by 10-fold CV. We will also calculate the error rates on both the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb101"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb101-1"><a href="simulace3.html#cb101-1" tabindex="-1"></a><span class="co"># Model construction</span></span>
<span id="cb101-2"><a href="simulace3.html#cb101-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb101-3"><a href="simulace3.html#cb101-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb101-4"><a href="simulace3.html#cb101-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-5"><a href="simulace3.html#cb101-5" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb101-6"><a href="simulace3.html#cb101-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb101-7"><a href="simulace3.html#cb101-7" tabindex="-1"></a></span>
<span id="cb101-8"><a href="simulace3.html#cb101-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb101-9"><a href="simulace3.html#cb101-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb101-10"><a href="simulace3.html#cb101-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-11"><a href="simulace3.html#cb101-11" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb101-12"><a href="simulace3.html#cb101-12" tabindex="-1"></a>                        <span class="at">degree =</span> p.opt,</span>
<span id="cb101-13"><a href="simulace3.html#cb101-13" tabindex="-1"></a>                        <span class="at">coef0 =</span> coef0,</span>
<span id="cb101-14"><a href="simulace3.html#cb101-14" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb101-15"><a href="simulace3.html#cb101-15" tabindex="-1"></a></span>
<span id="cb101-16"><a href="simulace3.html#cb101-16" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb101-17"><a href="simulace3.html#cb101-17" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb101-18"><a href="simulace3.html#cb101-18" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb101-19"><a href="simulace3.html#cb101-19" tabindex="-1"></a>                        <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb101-20"><a href="simulace3.html#cb101-20" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb101-21"><a href="simulace3.html#cb101-21" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb101-22"><a href="simulace3.html#cb101-22" tabindex="-1"></a></span>
<span id="cb101-23"><a href="simulace3.html#cb101-23" tabindex="-1"></a><span class="co"># Accuracy on training data</span></span>
<span id="cb101-24"><a href="simulace3.html#cb101-24" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb101-25"><a href="simulace3.html#cb101-25" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb101-26"><a href="simulace3.html#cb101-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb101-27"><a href="simulace3.html#cb101-27" tabindex="-1"></a></span>
<span id="cb101-28"><a href="simulace3.html#cb101-28" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb101-29"><a href="simulace3.html#cb101-29" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb101-30"><a href="simulace3.html#cb101-30" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb101-31"><a href="simulace3.html#cb101-31" tabindex="-1"></a></span>
<span id="cb101-32"><a href="simulace3.html#cb101-32" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb101-33"><a href="simulace3.html#cb101-33" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb101-34"><a href="simulace3.html#cb101-34" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb101-35"><a href="simulace3.html#cb101-35" tabindex="-1"></a>  </span>
<span id="cb101-36"><a href="simulace3.html#cb101-36" tabindex="-1"></a><span class="co"># Accuracy on test data</span></span>
<span id="cb101-37"><a href="simulace3.html#cb101-37" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb101-38"><a href="simulace3.html#cb101-38" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb101-39"><a href="simulace3.html#cb101-39" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb101-40"><a href="simulace3.html#cb101-40" tabindex="-1"></a></span>
<span id="cb101-41"><a href="simulace3.html#cb101-41" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb101-42"><a href="simulace3.html#cb101-42" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb101-43"><a href="simulace3.html#cb101-43" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb101-44"><a href="simulace3.html#cb101-44" tabindex="-1"></a></span>
<span id="cb101-45"><a href="simulace3.html#cb101-45" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb101-46"><a href="simulace3.html#cb101-46" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb101-47"><a href="simulace3.html#cb101-47" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is 6.43% for the linear kernel, 4.29% for the polynomial kernel, and 13.57% for the Gaussian kernel.<br />
On the test data, the error rate is 6.6667% for the linear kernel, 13.3333% for the polynomial kernel, and 20% for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb102"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb102-1"><a href="simulace3.html#cb102-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb102-2"><a href="simulace3.html#cb102-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb102-3"><a href="simulace3.html#cb102-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb102-4"><a href="simulace3.html#cb102-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb102-5"><a href="simulace3.html#cb102-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb102-6"><a href="simulace3.html#cb102-6" tabindex="-1"></a></span>
<span id="cb102-7"><a href="simulace3.html#cb102-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-SVM3" class="section level4 hasAnchor" number="1.3.7.5">
<h4><span class="header-section-number">1.3.7.5</span> Projection onto the B-spline Basis<a href="simulace3.html#projection-SVM3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another approach for using the classical SVM method for functional data is to project the original data onto a <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal H\)</span>, which we denote as <span class="math inline">\(V_d\)</span>.
Assume this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>.
We define the transformation <span class="math inline">\(P_{V_d}\)</span> as the orthogonal projection onto the subspace <span class="math inline">\(V_d\)</span>, which can be written as</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>For classification, we can then use the coefficients from the orthogonal projection, applying the standard SVM to the vectors <span class="math inline">\(\left( \langle x, \Psi_1 \rangle, \dots, \langle x, \Psi_d \rangle\right)^\top\)</span>.
By using this transformation, we define a new, so-called adapted kernel, composed of the orthogonal projection <span class="math inline">\(P_{V_d}\)</span> and the kernel function of the standard support vector method.
Thus, we have an (adapted) kernel <span class="math inline">\(Q(x_i, x_j) = K(P_{V_d}(x_i), P_{V_d}(x_j))\)</span>.
This method of dimensionality reduction is often referred to as <em>filtering</em>.</p>
<p>For the actual projection, we use the <code>project.basis()</code> function in <code>R</code> from the <code>fda</code> package.
Its input includes a matrix of original discrete (unsmoothed) data, the values at which we measure in the original data matrix, and the basis object onto which we want to project the data.
We choose to project onto the B-spline basis because the Fourier basis is not suitable for our non-periodic data.
Another option would be to use the <em>wavelet basis</em>.</p>
<p>The dimension <span class="math inline">\(d\)</span> can be chosen based on prior expert knowledge or by cross-validation.
In our case, we determine the optimal dimension of the subspace <span class="math inline">\(V_d\)</span> using <span class="math inline">\(k\)</span>-fold cross-validation (selecting <span class="math inline">\(k \ll n\)</span> due to the computational intensity of the method, often with <span class="math inline">\(k = 5\)</span> or <span class="math inline">\(k = 10\)</span>).
We require 4th-order B-splines, with the number of basis functions given by the relation</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where <span class="math inline">\(n_{breaks}\)</span> is the number of knots and <span class="math inline">\(n_{order} = 4\)</span>.
In <code>R</code>, however, the value of <span class="math inline">\(n_{basis}\)</span> must be at least <span class="math inline">\(n_{order} = 4\)</span>, and large values of <span class="math inline">\(n_{basis}\)</span> lead to overfitting, so we choose a smaller maximum for <span class="math inline">\(n_{basis}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb103"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb103-1"><a href="simulace3.html#cb103-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb103-2"><a href="simulace3.html#cb103-2" tabindex="-1"></a></span>
<span id="cb103-3"><a href="simulace3.html#cb103-3" tabindex="-1"></a><span class="co"># Values for B-spline basis</span></span>
<span id="cb103-4"><a href="simulace3.html#cb103-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb103-5"><a href="simulace3.html#cb103-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb103-6"><a href="simulace3.html#cb103-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb103-7"><a href="simulace3.html#cb103-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb103-8"><a href="simulace3.html#cb103-8" tabindex="-1"></a></span>
<span id="cb103-9"><a href="simulace3.html#cb103-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># All dimensions to test</span></span>
<span id="cb103-10"><a href="simulace3.html#cb103-10" tabindex="-1"></a></span>
<span id="cb103-11"><a href="simulace3.html#cb103-11" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb103-12"><a href="simulace3.html#cb103-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb103-13"><a href="simulace3.html#cb103-13" tabindex="-1"></a></span>
<span id="cb103-14"><a href="simulace3.html#cb103-14" tabindex="-1"></a><span class="co"># List with three components ... matrices for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb103-15"><a href="simulace3.html#cb103-15" tabindex="-1"></a><span class="co"># Empty matrix for storing individual results</span></span>
<span id="cb103-16"><a href="simulace3.html#cb103-16" tabindex="-1"></a><span class="co"># Columns contain accuracy values for each part of the training set</span></span>
<span id="cb103-17"><a href="simulace3.html#cb103-17" tabindex="-1"></a><span class="co"># Rows contain values for each dimension size</span></span>
<span id="cb103-18"><a href="simulace3.html#cb103-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb103-19"><a href="simulace3.html#cb103-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb103-20"><a href="simulace3.html#cb103-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb103-21"><a href="simulace3.html#cb103-21" tabindex="-1"></a></span>
<span id="cb103-22"><a href="simulace3.html#cb103-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb103-23"><a href="simulace3.html#cb103-23" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb103-24"><a href="simulace3.html#cb103-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb103-25"><a href="simulace3.html#cb103-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb103-26"><a href="simulace3.html#cb103-26" tabindex="-1"></a>  </span>
<span id="cb103-27"><a href="simulace3.html#cb103-27" tabindex="-1"></a>  <span class="co"># Project discrete data onto B-spline basis of dimension d</span></span>
<span id="cb103-28"><a href="simulace3.html#cb103-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># Matrix of discrete data</span></span>
<span id="cb103-29"><a href="simulace3.html#cb103-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># Vector of arguments</span></span>
<span id="cb103-30"><a href="simulace3.html#cb103-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># Basis object</span></span>
<span id="cb103-31"><a href="simulace3.html#cb103-31" tabindex="-1"></a>  </span>
<span id="cb103-32"><a href="simulace3.html#cb103-32" tabindex="-1"></a>  <span class="co"># Training and test split within CV</span></span>
<span id="cb103-33"><a href="simulace3.html#cb103-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb103-34"><a href="simulace3.html#cb103-34" tabindex="-1"></a>  </span>
<span id="cb103-35"><a href="simulace3.html#cb103-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb103-36"><a href="simulace3.html#cb103-36" tabindex="-1"></a>    <span class="co"># Define training and test parts for CV</span></span>
<span id="cb103-37"><a href="simulace3.html#cb103-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb103-38"><a href="simulace3.html#cb103-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb103-39"><a href="simulace3.html#cb103-39" tabindex="-1"></a>    </span>
<span id="cb103-40"><a href="simulace3.html#cb103-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb103-41"><a href="simulace3.html#cb103-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb103-42"><a href="simulace3.html#cb103-42" tabindex="-1"></a>    </span>
<span id="cb103-43"><a href="simulace3.html#cb103-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb103-44"><a href="simulace3.html#cb103-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb103-45"><a href="simulace3.html#cb103-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb103-46"><a href="simulace3.html#cb103-46" tabindex="-1"></a>  </span>
<span id="cb103-47"><a href="simulace3.html#cb103-47" tabindex="-1"></a>    <span class="co"># Model construction</span></span>
<span id="cb103-48"><a href="simulace3.html#cb103-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb103-49"><a href="simulace3.html#cb103-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb103-50"><a href="simulace3.html#cb103-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-51"><a href="simulace3.html#cb103-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb103-52"><a href="simulace3.html#cb103-52" tabindex="-1"></a>    </span>
<span id="cb103-53"><a href="simulace3.html#cb103-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb103-54"><a href="simulace3.html#cb103-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb103-55"><a href="simulace3.html#cb103-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-56"><a href="simulace3.html#cb103-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb103-57"><a href="simulace3.html#cb103-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb103-58"><a href="simulace3.html#cb103-58" tabindex="-1"></a>    </span>
<span id="cb103-59"><a href="simulace3.html#cb103-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb103-60"><a href="simulace3.html#cb103-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb103-61"><a href="simulace3.html#cb103-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb103-62"><a href="simulace3.html#cb103-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb103-63"><a href="simulace3.html#cb103-63" tabindex="-1"></a>      </span>
<span id="cb103-64"><a href="simulace3.html#cb103-64" tabindex="-1"></a>    <span class="co"># Accuracy on validation data</span></span>
<span id="cb103-65"><a href="simulace3.html#cb103-65" tabindex="-1"></a>    <span class="do">## Linear kernel</span></span>
<span id="cb103-66"><a href="simulace3.html#cb103-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb103-67"><a href="simulace3.html#cb103-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb103-68"><a href="simulace3.html#cb103-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb103-69"><a href="simulace3.html#cb103-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb103-70"><a href="simulace3.html#cb103-70" tabindex="-1"></a>    <span class="do">## Polynomial kernel</span></span>
<span id="cb103-71"><a href="simulace3.html#cb103-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb103-72"><a href="simulace3.html#cb103-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb103-73"><a href="simulace3.html#cb103-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb103-74"><a href="simulace3.html#cb103-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb103-75"><a href="simulace3.html#cb103-75" tabindex="-1"></a>    <span class="do">## Radial kernel</span></span>
<span id="cb103-76"><a href="simulace3.html#cb103-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb103-77"><a href="simulace3.html#cb103-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb103-78"><a href="simulace3.html#cb103-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb103-79"><a href="simulace3.html#cb103-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb103-80"><a href="simulace3.html#cb103-80" tabindex="-1"></a>    </span>
<span id="cb103-81"><a href="simulace3.html#cb103-81" tabindex="-1"></a>    <span class="co"># Store accuracies in positions for given d and fold</span></span>
<span id="cb103-82"><a href="simulace3.html#cb103-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb103-83"><a href="simulace3.html#cb103-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb103-84"><a href="simulace3.html#cb103-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb103-85"><a href="simulace3.html#cb103-85" tabindex="-1"></a>  }</span>
<span id="cb103-86"><a href="simulace3.html#cb103-86" tabindex="-1"></a>}</span>
<span id="cb103-87"><a href="simulace3.html#cb103-87" tabindex="-1"></a>  </span>
<span id="cb103-88"><a href="simulace3.html#cb103-88" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb103-89"><a href="simulace3.html#cb103-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb103-90"><a href="simulace3.html#cb103-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb103-91"><a href="simulace3.html#cb103-91" tabindex="-1"></a>}</span>
<span id="cb103-92"><a href="simulace3.html#cb103-92" tabindex="-1"></a></span>
<span id="cb103-93"><a href="simulace3.html#cb103-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb103-94"><a href="simulace3.html#cb103-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb103-95"><a href="simulace3.html#cb103-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb103-96"><a href="simulace3.html#cb103-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb103-97"><a href="simulace3.html#cb103-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb103-98"><a href="simulace3.html#cb103-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb103-99"><a href="simulace3.html#cb103-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb103-100"><a href="simulace3.html#cb103-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear    11 0.05863095
## poly      11 0.08244048
## radial    10 0.07440476</code></pre>
<p>We see that the optimal value of the parameter <span class="math inline">\(d\)</span> is 11 for the linear kernel with an error rate computed via 10-fold CV of 0.0586, 11 for the polynomial kernel with an error rate of 0.0824, and 10 for the radial kernel with an error rate of 0.0744. To provide a clearer overview, let’s plot the progression of validation error rates as a function of dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb105"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb105-1"><a href="simulace3.html#cb105-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb105-2"><a href="simulace3.html#cb105-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb105-3"><a href="simulace3.html#cb105-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb105-4"><a href="simulace3.html#cb105-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb105-5"><a href="simulace3.html#cb105-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb105-6"><a href="simulace3.html#cb105-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb105-7"><a href="simulace3.html#cb105-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb105-8"><a href="simulace3.html#cb105-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb105-9"><a href="simulace3.html#cb105-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb105-10"><a href="simulace3.html#cb105-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb105-11"><a href="simulace3.html#cb105-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb105-12"><a href="simulace3.html#cb105-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb105-13"><a href="simulace3.html#cb105-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb105-14"><a href="simulace3.html#cb105-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb105-15"><a href="simulace3.html#cb105-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation Error Rate&#39;</span>,</span>
<span id="cb105-16"><a href="simulace3.html#cb105-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Kernel&#39;</span>) <span class="sc">+</span> </span>
<span id="cb105-17"><a href="simulace3.html#cb105-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb105-18"><a href="simulace3.html#cb105-18" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-98"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-98-1.png" alt="Dependence of validation error rate on subspace dimension $V_d$, for each of the three kernels considered in the SVM method. Optimal values of dimension $V_d$ for each kernel function are marked by black points." width="672" />
<p class="caption">
Figure 1.24: Dependence of validation error rate on subspace dimension <span class="math inline">\(V_d\)</span>, for each of the three kernels considered in the SVM method. Optimal values of dimension <span class="math inline">\(V_d\)</span> for each kernel function are marked by black points.
</p>
</div>
<p>Now, we can train individual classifiers on all training data and evaluate their accuracy on test data. For each kernel function, we select the dimension of the subspace onto which we project based on the cross-validation results.</p>
<p>In the variable <code>Projection</code>, we store the matrix of orthogonal projection coefficients:</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb106"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb106-1"><a href="simulace3.html#cb106-1" tabindex="-1"></a><span class="co"># Prepare data table for storing results</span></span>
<span id="cb106-2"><a href="simulace3.html#cb106-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb106-3"><a href="simulace3.html#cb106-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb106-4"><a href="simulace3.html#cb106-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb106-5"><a href="simulace3.html#cb106-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb106-6"><a href="simulace3.html#cb106-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb106-7"><a href="simulace3.html#cb106-7" tabindex="-1"></a></span>
<span id="cb106-8"><a href="simulace3.html#cb106-8" tabindex="-1"></a><span class="co"># Iterate over kernels</span></span>
<span id="cb106-9"><a href="simulace3.html#cb106-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb106-10"><a href="simulace3.html#cb106-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb106-11"><a href="simulace3.html#cb106-11" tabindex="-1"></a>  <span class="co"># basis object</span></span>
<span id="cb106-12"><a href="simulace3.html#cb106-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb106-13"><a href="simulace3.html#cb106-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb106-14"><a href="simulace3.html#cb106-14" tabindex="-1"></a>  </span>
<span id="cb106-15"><a href="simulace3.html#cb106-15" tabindex="-1"></a>  <span class="co"># projection of discrete data onto B-spline basis</span></span>
<span id="cb106-16"><a href="simulace3.html#cb106-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb106-17"><a href="simulace3.html#cb106-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb106-18"><a href="simulace3.html#cb106-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb106-19"><a href="simulace3.html#cb106-19" tabindex="-1"></a>  </span>
<span id="cb106-20"><a href="simulace3.html#cb106-20" tabindex="-1"></a>  <span class="co"># split into training and testing data</span></span>
<span id="cb106-21"><a href="simulace3.html#cb106-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb106-22"><a href="simulace3.html#cb106-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb106-23"><a href="simulace3.html#cb106-23" tabindex="-1"></a>  </span>
<span id="cb106-24"><a href="simulace3.html#cb106-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb106-25"><a href="simulace3.html#cb106-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb106-26"><a href="simulace3.html#cb106-26" tabindex="-1"></a>  </span>
<span id="cb106-27"><a href="simulace3.html#cb106-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb106-28"><a href="simulace3.html#cb106-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb106-29"><a href="simulace3.html#cb106-29" tabindex="-1"></a>  </span>
<span id="cb106-30"><a href="simulace3.html#cb106-30" tabindex="-1"></a>  <span class="co"># construct model</span></span>
<span id="cb106-31"><a href="simulace3.html#cb106-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb106-32"><a href="simulace3.html#cb106-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb106-33"><a href="simulace3.html#cb106-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb106-34"><a href="simulace3.html#cb106-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb106-35"><a href="simulace3.html#cb106-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb106-36"><a href="simulace3.html#cb106-36" tabindex="-1"></a>  </span>
<span id="cb106-37"><a href="simulace3.html#cb106-37" tabindex="-1"></a>  <span class="co"># training data accuracy</span></span>
<span id="cb106-38"><a href="simulace3.html#cb106-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb106-39"><a href="simulace3.html#cb106-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb106-40"><a href="simulace3.html#cb106-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb106-41"><a href="simulace3.html#cb106-41" tabindex="-1"></a>    </span>
<span id="cb106-42"><a href="simulace3.html#cb106-42" tabindex="-1"></a>  <span class="co"># test data accuracy</span></span>
<span id="cb106-43"><a href="simulace3.html#cb106-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb106-44"><a href="simulace3.html#cb106-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb106-45"><a href="simulace3.html#cb106-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb106-46"><a href="simulace3.html#cb106-46" tabindex="-1"></a>  </span>
<span id="cb106-47"><a href="simulace3.html#cb106-47" tabindex="-1"></a>  <span class="co"># store results</span></span>
<span id="cb106-48"><a href="simulace3.html#cb106-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb106-49"><a href="simulace3.html#cb106-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to basis coefficients on the training data is 4.29% for the linear kernel, 3.57% for the polynomial kernel, and 5% for the Gaussian kernel. On the test data, the error rate is 10% for the linear kernel, 8.33% for the polynomial kernel, and 10% for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb107"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb107-1"><a href="simulace3.html#cb107-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVM3" class="section level4 hasAnchor" number="1.3.7.6">
<h4><span class="header-section-number">1.3.7.6</span> RKHS + SVM<a href="simulace3.html#RKHS-SVM3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this section, we will look at another way to utilize support vector methods for classifying functional data. This time, we will again apply the well-known principle of first expressing functional data as some finite-dimensional objects, and then applying the classic SVM method to these objects.</p>
<p>However, in this case, we will also use the SVM method for the representation of functional data using a certain finite-dimensional object. As the name suggests, this involves a combination of two concepts: the support vector method and a space known in English literature as <em>Reproducing Kernel Hilbert Space</em> (RKHS). The key concept for this space is the <em>kernel</em>.</p>
<div class="definition">
<p><span id="def:kernel" class="definition"><strong>Definition 1.1  (Kernel) </strong></span>A kernel is a function <span class="math inline">\(K : \mathcal{X} \times \mathcal{X} \rightarrow \mathbb{R}\)</span> such that for every pair <span class="math inline">\(\boldsymbol{x}, \tilde{\boldsymbol{x}} \in \mathcal{X}\)</span> it holds that
<span class="math display">\[
K(\boldsymbol{x}, \tilde{\boldsymbol{x}}) = \big\langle \boldsymbol{\phi}(\boldsymbol{x}), \boldsymbol{\phi}(\tilde{\boldsymbol{x}}) \big\rangle_{\mathcal{H}},
\]</span>
where <span class="math inline">\(\boldsymbol{\phi} : \mathcal{X} \rightarrow \mathcal{H}\)</span> is a mapping from the space <span class="math inline">\(\mathcal{X}\)</span> to the space <span class="math inline">\(\mathcal{H}\)</span>.</p>
</div>
<p>For a function to be a kernel, it must satisfy certain conditions.</p>
<div class="lemma">
<p><span id="lem:unlabeled-div-1" class="lemma"><strong>Lemma 1.1  </strong></span>Let <span class="math inline">\(\mathcal{X}\)</span> be a Hilbert space. Then a symmetric function <span class="math inline">\(K : \mathcal{X} \times \mathcal{X} \rightarrow \mathbb{R}\)</span> is a kernel if for all <span class="math inline">\(k \geq 1, \boldsymbol{x}_1, \dots, \boldsymbol{x}_k \in \mathcal{X}\)</span> and <span class="math inline">\(c_1, \dots, c_k \in \mathbb{R}\)</span>, it holds that
<span class="math display">\[
\sum_{i, j = 1}^k c_i c_j K(\boldsymbol{x}_i, \boldsymbol{x}_j) \geq 0.
\]</span></p>
</div>
<p>The property above is called positive semidefiniteness. The following statement also holds.</p>
<div class="theorem">
<p><span id="thm:unlabeled-div-2" class="theorem"><strong>Theorem 1.1  </strong></span>A function <span class="math inline">\(K: \mathcal{X} \times \mathcal{X} \rightarrow \mathbb{R}\)</span> is a kernel if and only if there exists a Hilbert space <span class="math inline">\(\mathcal{H}\)</span> and a mapping <span class="math inline">\(\boldsymbol{\phi} : \mathcal{X} \rightarrow \mathcal{H}\)</span> such that
<span class="math display">\[
K(\boldsymbol{x}, \tilde{\boldsymbol{x}}) = \big\langle \boldsymbol{\phi}(\boldsymbol{x}), \boldsymbol{\phi}(\tilde{\boldsymbol{x}}) \big\rangle_{\mathcal{H}} \quad \forall \boldsymbol{x}, \tilde{\boldsymbol{x}} \in \mathcal{X}.
\]</span></p>
</div>
<p>Now we are ready to introduce the concept of <em>Reproducing Kernel Hilbert Space</em>.</p>
<div id="reproducing-kernel-hilbert-space-rkhs" class="section level5 hasAnchor" number="1.3.7.6.1">
<h5><span class="header-section-number">1.3.7.6.1</span> Reproducing Kernel Hilbert Space (RKHS)<a href="simulace3.html#reproducing-kernel-hilbert-space-rkhs" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>Consider a Hilbert space <span class="math inline">\(\mathcal{H}\)</span> as a space of functions. Our goal is to define the space <span class="math inline">\(\mathcal{H}\)</span> and the mapping <span class="math inline">\(\phi\)</span> such that <span class="math inline">\(\phi(x) \in \mathcal{H}, \ \forall x \in \mathcal{X}\)</span>. Let <span class="math inline">\(\phi(x) = k_x\)</span>. We assign to each function <span class="math inline">\(x \in \mathcal{X}\)</span> the function <span class="math inline">\(x \mapsto k_x \in \mathcal{H}, k_x := K(x, \cdot)\)</span>. Then <span class="math inline">\(\phi: \mathcal{X} \rightarrow \mathbb{R}^{\mathcal{X}}\)</span>, so we can summarize it as</p>
<p><span class="math display">\[
x \in \mathcal{X} \mapsto \phi(x) = k_x = K(x, \cdot) \in \mathcal{H},
\]</span></p>
<p>The point (function) <span class="math inline">\(x \in \mathcal{X}\)</span> is mapped to the function <span class="math inline">\(k_x: \mathcal{X} \rightarrow \mathbb{R}, k_x(y) = K(x, y)\)</span>.</p>
<p>Consider the set of all images <span class="math inline">\(\{k_x | x \in \mathcal{X}\}\)</span> and define the linear span of this set of vectors as</p>
<p><span class="math display">\[
\mathcal{G} := \text{span}\{k_x | x \in \mathcal{X}\} = \left\{\sum_{i = 1}^r \alpha_i K(x_i, \cdot) \ \Big|\ \alpha_i \in \mathbb{R}, r \in \mathbb{N}, x_i \in \mathcal{X}\right\}.
\]</span></p>
<p>Then the inner product is given by</p>
<p><span class="math display">\[
\langle k_x, k_y \rangle = \langle K(x, \cdot), K(y, \cdot) \rangle = K(x, y),\quad x, y \in \mathcal{X}
\]</span></p>
<p>and generally</p>
<p><span class="math display">\[
f, g \in \mathcal{G}, f = \sum_i \alpha_i K(x_i, \cdot), g = \sum_j \beta_j K(y_j, \cdot), \\
\langle f, g \rangle_{\mathcal{G}} = \Big\langle \sum_i \alpha_i K(x_i, \cdot), \sum_j \beta_j K(y_j, \cdot) \Big\rangle = \sum_i\sum_j \alpha_i \beta_j \langle K(x_i, \cdot), K(y_j, \cdot) \rangle = \sum_i\sum_j \alpha_i \beta_j K(x_i, y_j).
\]</span></p>
<p>The space <span class="math inline">\(\mathcal{H} := \overline{\mathcal{G}}\)</span>, which is the closure of the space <span class="math inline">\(\mathcal{G}\)</span>, is called the <em>Reproducing Kernel Hilbert Space</em> (RKHS). A significant property of this space is</p>
<p><span class="math display">\[
K(x, y) = \Big\langle \phi(x), \phi(y) \Big\rangle_{\mathcal{H}}.
\]</span></p>
<p><em>Note:</em> The name Reproducing comes from the following fact. Let <span class="math inline">\(f = \sum_i \alpha_i K(x_i, \cdot)\)</span> be any function. Then</p>
<span class="math display">\[\begin{align*}
\langle K(x, \cdot), f \rangle &amp;= \langle K(x, \cdot), \sum_i \alpha_i K(x_i, \cdot) \rangle =\\
&amp;= \sum_i \alpha_i \langle K(x, \cdot), K(x_i, \cdot) \rangle = \sum_i \alpha_i K(x_i, x) = \\
&amp;= f(x)
\end{align*}\]</span>
<p><em>Properties:</em></p>
<ul>
<li><p>Let <span class="math inline">\(\mathcal{H}\)</span> be a Hilbert space of functions <span class="math inline">\(g: \mathcal{X} \rightarrow \mathbb{R}\)</span>. Then <span class="math inline">\(\mathcal{H}\)</span> is an RKHS if and only if all evaluation functionals <span class="math inline">\(\delta_x: \mathcal{H} \rightarrow \mathbb{R}, g \mapsto g(x)\)</span> are continuous.</p></li>
<li><p>For a given kernel <span class="math inline">\(K\)</span>, there exists exactly one RKHS (up to isometric isomorphism).</p></li>
<li><p>For a given RKHS, the kernel <span class="math inline">\(K\)</span> is uniquely determined.</p></li>
<li><p>Functions in RKHS are pointwise well-defined.</p></li>
<li><p>RKHS is generally an infinite-dimensional vector space, but in practice, we only work with its finite-dimensional subspace.</p></li>
</ul>
<p>At the end of this section, let us state an important theorem.</p>
<div class="theorem">
<p><span id="thm:representer" class="theorem"><strong>Theorem 1.2  (The representer theorem) </strong></span>Let <span class="math inline">\(K\)</span> be a kernel and <span class="math inline">\(\mathcal H\)</span> be the corresponding RKHS with norm and inner product <span class="math inline">\(\|\cdot\|_{\mathcal H}\)</span> and <span class="math inline">\(\langle \cdot, \cdot \rangle_{\mathcal H}\)</span>. Suppose we want to find a linear function <span class="math inline">\(f: \mathcal H \rightarrow \mathbb R\)</span> in the Hilbert space <span class="math inline">\(\mathcal H\)</span> defined by the kernel <span class="math inline">\(K\)</span>. The function <span class="math inline">\(f\)</span> has the form <span class="math inline">\(f(x) = \langle \omega, x \rangle_{\mathcal H}\)</span> for some <span class="math inline">\(\omega \in \mathcal H\)</span>. Consider the regularized minimization problem:</p>
<p><span class="math display" id="eq:repr-thm">\[\begin{equation}
\min_{\omega \in \mathcal H} R_n(\omega) + \lambda \Omega(\|\omega\|_{\mathcal H}),
\tag{1.1}
\end{equation}\]</span>
where <span class="math inline">\(\Omega: [0, \infty) \rightarrow \mathbb R\)</span> is a strictly monotonically increasing function (regularizer), and <span class="math inline">\(R_n(\cdot)\)</span> is the empirical loss (empirical risk) of the classifier with respect to the loss function <span class="math inline">\(\ell\)</span>. Then the optimization problem <a href="simulace3.html#eq:repr-thm">(1.1)</a> always has an optimal solution, which is of the form:</p>
<p><span class="math display" id="eq:optimal-thm">\[\begin{equation}
\omega^* = \sum_{i = 1}^n \alpha_i K(x_i, \cdot),
\tag{1.2}
\end{equation}\]</span>
where <span class="math inline">\((x_i, y_i)_{i = 1, 2, \dots, n} \in \mathcal X \times \mathcal Y\)</span> is a set of training values.</p>
</div>
<p><span class="math inline">\(\mathcal H\)</span> is generally an infinite-dimensional space, but for a finite dataset of size <span class="math inline">\(n\)</span>, <span class="math inline">\(\mathcal H\)</span> has dimension at most <span class="math inline">\(n\)</span>. Furthermore, every <span class="math inline">\(n\)</span>-dimensional subspace of a Hilbert space is isometric to <span class="math inline">\(\mathbb R^n\)</span>, so we can assume that the mapping (feature map) maps into <span class="math inline">\(\mathbb R^n\)</span>.</p>
<p>The kernel <span class="math inline">\(K\)</span> is <em>universal</em> if the RKHS <span class="math inline">\(\mathcal H\)</span> is a dense subset of <span class="math inline">\(\mathcal C(\mathcal X)\)</span> (the set of continuous functions). Moreover, the following facts hold:</p>
<ul>
<li>Universal kernels are good for approximation.</li>
<li>The Gaussian kernel with a fixed value <span class="math inline">\(\sigma\)</span> is universal.</li>
<li>Universality is a necessary condition for consistency.</li>
</ul>
</div>
<div id="classification-using-rkhs" class="section level5 hasAnchor" number="1.3.7.6.2">
<h5><span class="header-section-number">1.3.7.6.2</span> Classification Using RKHS<a href="simulace3.html#classification-using-rkhs" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>The basic idea is to project the original data onto a subspace of the RKHS, denoted as <span class="math inline">\(\mathcal H_K\)</span> (the index <span class="math inline">\({}_K\)</span> refers to the fact that this space is defined by the kernel <span class="math inline">\(K\)</span>). The goal is to transform a curve (the observed object, function) into a point in the RKHS. Let us denote the set of observed curves as <span class="math inline">\(\{\hat c_1, \dots, \hat c_n\}\)</span>, where each curve <span class="math inline">\(\hat c_l\)</span> is defined by the data <span class="math inline">\(\{(\boldsymbol x_i, \boldsymbol y_{il}) \in \mathcal X \times \mathcal Y\}_{i = 1}^m\)</span>, with <span class="math inline">\(\mathcal X\)</span> being the space of input variables and typically <span class="math inline">\(\mathcal Y = \mathbb R\)</span>. Assume that for each function <span class="math inline">\(\hat c_l\)</span>, there exists a continuous function <span class="math inline">\(c_l:\mathcal X \rightarrow \mathcal Y\)</span> such that <span class="math inline">\(\mathbb E[y_l|\boldsymbol x] = c_l(\boldsymbol x)\)</span>. We also assume that <span class="math inline">\(\boldsymbol x_i\)</span> are common to all curves.</p>
<p>Muñoz and González in their paper<a href="#fn1" class="footnote-ref" id="fnref1"><sup>1</sup></a> propose the following procedure. The curve <span class="math inline">\(c_l^*\)</span> can be expressed as</p>
<p><span class="math display">\[
c_l^*(\boldsymbol x) = \sum_{i = 1}^m \alpha_{il} K(\boldsymbol x_i, \boldsymbol x), \quad \forall \boldsymbol x \in \mathcal X,
\]</span></p>
<p>where <span class="math inline">\(\alpha_{il} \in \mathbb R\)</span>. These coefficients can be obtained in practice by solving the optimization problem</p>
<p><span class="math display">\[
\text{argmin}_{c \in \mathcal H_K} \frac{1}{m} \sum_{i = 1}^m \big[|c(\boldsymbol x_i) - y_i| - \varepsilon\big]_+ + \gamma \|c\|_{K}^2, \quad \gamma &gt; 0, \varepsilon \geq 0,
\]</span></p>
<p>specifically, for example, using the SVM method. Due to the well-known property of this method, many coefficients will be <span class="math inline">\(\alpha_{il} = 0\)</span>. By minimizing the above expression, we obtain functions <span class="math inline">\(c_1^*, \dots, c_n^*\)</span> corresponding to the original curves <span class="math inline">\(\hat c_1, \dots, \hat c_n\)</span>. Thus, the SVM method provides a meaningful representation of the original curves using the coefficient vector <span class="math inline">\(\boldsymbol \alpha_l = (\alpha_{1l}, \dots, \alpha_{ml})^\top\)</span> for <span class="math inline">\(\hat c_l\)</span>. However, this representation is very unstable, as even a small change in the original values can lead to a change in the set of support vectors for the given function, resulting in a significant change in the entire representation of this curve (the representation is not continuous in the input values). Therefore, we define a new representation of the original curves that will not suffer from this drawback.</p>
<div class="theorem">
<p><span id="thm:MaG" class="theorem"><strong>Theorem 1.3  (Muñoz-González) </strong></span>Let <span class="math inline">\(c\)</span> be a function whose observed version is <span class="math inline">\(\hat c = \{(\boldsymbol x_i, y_{i}) \in \mathcal X \times \mathcal Y\}_{i = 1}^m\)</span>, and let <span class="math inline">\(K\)</span> be a kernel with eigenfunctions <span class="math inline">\(\{\phi_1, \dots, \phi_d, \dots\}\)</span> (basis of <span class="math inline">\(\mathcal H_K\)</span>). Then the function <span class="math inline">\(c^*(\boldsymbol x)\)</span> can be expressed in the form
<span class="math display">\[\begin{equation*}
c^*(\boldsymbol x) = \sum_{j = 1}^d \lambda_j^* \phi_j(\boldsymbol x),
\end{equation*}\]</span>
where <span class="math inline">\(\lambda_j^*\)</span> are the weights of the projection of <span class="math inline">\(c^*(\boldsymbol x)\)</span> onto the space of functions generated by the eigenfunctions of the kernel <span class="math inline">\(K\)</span>, and <span class="math inline">\(d\)</span> is the dimension of the space <span class="math inline">\(\mathcal H\)</span>. In practice, when we only have a finite number of observations, <span class="math inline">\(\lambda_j^*\)</span> can be estimated using
<span class="math display">\[\begin{equation*}
\hat\lambda_j^* = \hat\lambda_j \sum_{i = 1}^m \alpha_i\hat\phi_{ji}, \quad j = 1, 2, \dots, \hat d,
\end{equation*}\]</span>
where <span class="math inline">\(\hat\lambda_j\)</span> is the <span class="math inline">\(j\)</span>-th eigenvalue corresponding to the <span class="math inline">\(j\)</span>-th eigenvector <span class="math inline">\(\hat\phi_j\)</span> of the matrix <span class="math inline">\(K_S = \big(K(\boldsymbol x_i, \boldsymbol x_j)\big)_{i, j = 1}^m\)</span>, <span class="math inline">\(\hat d = \text{rank}(K_S)\)</span>, and <span class="math inline">\(\alpha_i\)</span> are the solutions to the optimization problem.</p>
</div>
</div>
<div id="implementation-of-the-method-in-r" class="section level5 hasAnchor" number="1.3.7.6.3">
<h5><span class="header-section-number">1.3.7.6.3</span> Implementation of the Method in <code>R</code><a href="simulace3.html#implementation-of-the-method-in-r" class="anchor-section" aria-label="Anchor link to header"></a></h5>
<p>From the last part of Theorem <a href="simulace3.html#thm:MaG">1.3</a>, it follows how we should compute the representations of the curves in practice. We will work with discretized data after smoothing the curves. First, we define the kernel for the RKHS space. We will use the Gaussian kernel with parameter <span class="math inline">\(\gamma\)</span>. The value of this hyperparameter significantly affects the behavior and thus the success of the method, so we must pay special attention to its selection (we choose it using cross-validation).</p>
<div id="gaussian-kernel" class="section level6 hasAnchor" number="1.3.7.6.3.1">
<h6><span class="header-section-number">1.3.7.6.3.1</span> Gaussian Kernel<a href="simulace3.html#gaussian-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb108"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb108-1"><a href="simulace3.html#cb108-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb108-2"><a href="simulace3.html#cb108-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb108-3"><a href="simulace3.html#cb108-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb108-4"><a href="simulace3.html#cb108-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb108-5"><a href="simulace3.html#cb108-5" tabindex="-1"></a></span>
<span id="cb108-6"><a href="simulace3.html#cb108-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb108-7"><a href="simulace3.html#cb108-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb108-8"><a href="simulace3.html#cb108-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb108-9"><a href="simulace3.html#cb108-9" tabindex="-1"></a>}</span>
<span id="cb108-10"><a href="simulace3.html#cb108-10" tabindex="-1"></a></span>
<span id="cb108-11"><a href="simulace3.html#cb108-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb108-12"><a href="simulace3.html#cb108-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb108-13"><a href="simulace3.html#cb108-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb108-14"><a href="simulace3.html#cb108-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb108-15"><a href="simulace3.html#cb108-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb108-16"><a href="simulace3.html#cb108-16" tabindex="-1"></a>    }</span>
<span id="cb108-17"><a href="simulace3.html#cb108-17" tabindex="-1"></a>  }</span>
<span id="cb108-18"><a href="simulace3.html#cb108-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb108-19"><a href="simulace3.html#cb108-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s calculate the matrix <span class="math inline">\(K_S\)</span> and its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb109"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb109-1"><a href="simulace3.html#cb109-1" tabindex="-1"></a><span class="co"># Calculate the matrix K</span></span>
<span id="cb109-2"><a href="simulace3.html#cb109-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># Fixed value of gamma; we will determine the optimal value using CV</span></span>
<span id="cb109-3"><a href="simulace3.html#cb109-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb109-4"><a href="simulace3.html#cb109-4" tabindex="-1"></a></span>
<span id="cb109-5"><a href="simulace3.html#cb109-5" tabindex="-1"></a><span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb109-6"><a href="simulace3.html#cb109-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb109-7"><a href="simulace3.html#cb109-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb109-8"><a href="simulace3.html#cb109-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To calculate the coefficients in the representation of the curves, i.e., the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat d l}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we also need the coefficients from the SVM. Unlike the classification problem, we are now solving a regression problem, as we are trying to express our observed curves in some basis (chosen by us via the kernel <span class="math inline">\(K\)</span>). Therefore, we will use the <em>Support Vector Regression</em> method, from which we will subsequently obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb110"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb110-1"><a href="simulace3.html#cb110-1" tabindex="-1"></a><span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb110-2"><a href="simulace3.html#cb110-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb110-3"><a href="simulace3.html#cb110-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># Empty object</span></span>
<span id="cb110-4"><a href="simulace3.html#cb110-4" tabindex="-1"></a></span>
<span id="cb110-5"><a href="simulace3.html#cb110-5" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb110-6"><a href="simulace3.html#cb110-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb110-7"><a href="simulace3.html#cb110-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb110-8"><a href="simulace3.html#cb110-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb110-9"><a href="simulace3.html#cb110-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb110-10"><a href="simulace3.html#cb110-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb110-11"><a href="simulace3.html#cb110-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb110-12"><a href="simulace3.html#cb110-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb110-13"><a href="simulace3.html#cb110-13" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb110-14"><a href="simulace3.html#cb110-14" tabindex="-1"></a>  <span class="co"># Determine alpha</span></span>
<span id="cb110-15"><a href="simulace3.html#cb110-15" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># Replace zeros with coefficients</span></span>
<span id="cb110-16"><a href="simulace3.html#cb110-16" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can calculate the representations of the individual curves. First, let’s choose <span class="math inline">\(\hat d\)</span> as the entire dimension, i.e., <span class="math inline">\(\hat d = m ={}\)</span> 101, and then we will determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb111"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb111-1"><a href="simulace3.html#cb111-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb111-2"><a href="simulace3.html#cb111-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb111-3"><a href="simulace3.html#cb111-3" tabindex="-1"></a></span>
<span id="cb111-4"><a href="simulace3.html#cb111-4" tabindex="-1"></a><span class="co"># Determine the lambda vector</span></span>
<span id="cb111-5"><a href="simulace3.html#cb111-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb111-6"><a href="simulace3.html#cb111-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb111-7"><a href="simulace3.html#cb111-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># Create an empty object</span></span>
<span id="cb111-8"><a href="simulace3.html#cb111-8" tabindex="-1"></a></span>
<span id="cb111-9"><a href="simulace3.html#cb111-9" tabindex="-1"></a><span class="co"># Calculate the representation</span></span>
<span id="cb111-10"><a href="simulace3.html#cb111-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb111-11"><a href="simulace3.html#cb111-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb111-12"><a href="simulace3.html#cb111-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> stored in the columns of the matrix <code>Lambda.RKHS</code> for each curve. We will now use these vectors as the representation of the given curves and classify the data according to this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb112"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb112-1"><a href="simulace3.html#cb112-1" tabindex="-1"></a><span class="co"># Split into training and testing data</span></span>
<span id="cb112-2"><a href="simulace3.html#cb112-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb112-3"><a href="simulace3.html#cb112-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb112-4"><a href="simulace3.html#cb112-4" tabindex="-1"></a></span>
<span id="cb112-5"><a href="simulace3.html#cb112-5" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb112-6"><a href="simulace3.html#cb112-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb112-7"><a href="simulace3.html#cb112-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb112-8"><a href="simulace3.html#cb112-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb112-9"><a href="simulace3.html#cb112-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb112-10"><a href="simulace3.html#cb112-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb112-11"><a href="simulace3.html#cb112-11" tabindex="-1"></a></span>
<span id="cb112-12"><a href="simulace3.html#cb112-12" tabindex="-1"></a><span class="co"># Loop through each kernel</span></span>
<span id="cb112-13"><a href="simulace3.html#cb112-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb112-14"><a href="simulace3.html#cb112-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb112-15"><a href="simulace3.html#cb112-15" tabindex="-1"></a></span>
<span id="cb112-16"><a href="simulace3.html#cb112-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb112-17"><a href="simulace3.html#cb112-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb112-18"><a href="simulace3.html#cb112-18" tabindex="-1"></a>  </span>
<span id="cb112-19"><a href="simulace3.html#cb112-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb112-20"><a href="simulace3.html#cb112-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb112-21"><a href="simulace3.html#cb112-21" tabindex="-1"></a>  </span>
<span id="cb112-22"><a href="simulace3.html#cb112-22" tabindex="-1"></a>  <span class="co"># Build models</span></span>
<span id="cb112-23"><a href="simulace3.html#cb112-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb112-24"><a href="simulace3.html#cb112-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb112-25"><a href="simulace3.html#cb112-25" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb112-26"><a href="simulace3.html#cb112-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb112-27"><a href="simulace3.html#cb112-27" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb112-28"><a href="simulace3.html#cb112-28" tabindex="-1"></a>  </span>
<span id="cb112-29"><a href="simulace3.html#cb112-29" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb112-30"><a href="simulace3.html#cb112-30" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb112-31"><a href="simulace3.html#cb112-31" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb112-32"><a href="simulace3.html#cb112-32" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb112-33"><a href="simulace3.html#cb112-33" tabindex="-1"></a>    </span>
<span id="cb112-34"><a href="simulace3.html#cb112-34" tabindex="-1"></a>  <span class="co"># Accuracy on testing data</span></span>
<span id="cb112-35"><a href="simulace3.html#cb112-35" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb112-36"><a href="simulace3.html#cb112-36" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb112-37"><a href="simulace3.html#cb112-37" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb112-38"><a href="simulace3.html#cb112-38" tabindex="-1"></a>  </span>
<span id="cb112-39"><a href="simulace3.html#cb112-39" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb112-40"><a href="simulace3.html#cb112-40" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb112-41"><a href="simulace3.html#cb112-41" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-106">Table 1.1: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.1000</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0286</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0786</td>
<td align="center">0.2667</td>
</tr>
</tbody>
</table>
<p>We see that the model performs very well on the training data for all three kernels, while its performance on the testing data is not good at all. It is clear that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb113"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb113-1"><a href="simulace3.html#cb113-1" tabindex="-1"></a><span class="co"># Split the training data into k parts</span></span>
<span id="cb113-2"><a href="simulace3.html#cb113-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb113-3"><a href="simulace3.html#cb113-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb113-4"><a href="simulace3.html#cb113-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb113-5"><a href="simulace3.html#cb113-5" tabindex="-1"></a></span>
<span id="cb113-6"><a href="simulace3.html#cb113-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate over</span></span>
<span id="cb113-7"><a href="simulace3.html#cb113-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># Reasonable range of values for d</span></span>
<span id="cb113-8"><a href="simulace3.html#cb113-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb113-9"><a href="simulace3.html#cb113-9" tabindex="-1"></a></span>
<span id="cb113-10"><a href="simulace3.html#cb113-10" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb113-11"><a href="simulace3.html#cb113-11" tabindex="-1"></a><span class="co"># Empty matrix to insert individual results</span></span>
<span id="cb113-12"><a href="simulace3.html#cb113-12" tabindex="-1"></a><span class="co"># Columns will contain accuracy values for given</span></span>
<span id="cb113-13"><a href="simulace3.html#cb113-13" tabindex="-1"></a><span class="co"># Rows will contain values for given gamma and layers will correspond to folds</span></span>
<span id="cb113-14"><a href="simulace3.html#cb113-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb113-15"><a href="simulace3.html#cb113-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb113-16"><a href="simulace3.html#cb113-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb113-17"><a href="simulace3.html#cb113-17" tabindex="-1"></a></span>
<span id="cb113-18"><a href="simulace3.html#cb113-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb113-19"><a href="simulace3.html#cb113-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-20"><a href="simulace3.html#cb113-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb113-21"><a href="simulace3.html#cb113-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-22"><a href="simulace3.html#cb113-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb113-23"><a href="simulace3.html#cb113-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb113-24"><a href="simulace3.html#cb113-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb114"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb114-1"><a href="simulace3.html#cb114-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb114-2"><a href="simulace3.html#cb114-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb114-3"><a href="simulace3.html#cb114-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb114-4"><a href="simulace3.html#cb114-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb114-5"><a href="simulace3.html#cb114-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb114-6"><a href="simulace3.html#cb114-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb114-7"><a href="simulace3.html#cb114-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb114-8"><a href="simulace3.html#cb114-8" tabindex="-1"></a>  </span>
<span id="cb114-9"><a href="simulace3.html#cb114-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb114-10"><a href="simulace3.html#cb114-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb114-11"><a href="simulace3.html#cb114-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb114-12"><a href="simulace3.html#cb114-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb114-13"><a href="simulace3.html#cb114-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb114-14"><a href="simulace3.html#cb114-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb114-15"><a href="simulace3.html#cb114-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb114-16"><a href="simulace3.html#cb114-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb114-17"><a href="simulace3.html#cb114-17" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb114-18"><a href="simulace3.html#cb114-18" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb114-19"><a href="simulace3.html#cb114-19" tabindex="-1"></a>  }</span>
<span id="cb114-20"><a href="simulace3.html#cb114-20" tabindex="-1"></a>  </span>
<span id="cb114-21"><a href="simulace3.html#cb114-21" tabindex="-1"></a>  <span class="co"># Iterate over dimensions</span></span>
<span id="cb114-22"><a href="simulace3.html#cb114-22" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb114-23"><a href="simulace3.html#cb114-23" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb114-24"><a href="simulace3.html#cb114-24" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb114-25"><a href="simulace3.html#cb114-25" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb114-26"><a href="simulace3.html#cb114-26" tabindex="-1"></a>    <span class="co"># Calculate representation</span></span>
<span id="cb114-27"><a href="simulace3.html#cb114-27" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb114-28"><a href="simulace3.html#cb114-28" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb114-29"><a href="simulace3.html#cb114-29" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb114-30"><a href="simulace3.html#cb114-30" tabindex="-1"></a>    }</span>
<span id="cb114-31"><a href="simulace3.html#cb114-31" tabindex="-1"></a>    <span class="co"># Iterate over folds</span></span>
<span id="cb114-32"><a href="simulace3.html#cb114-32" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb114-33"><a href="simulace3.html#cb114-33" tabindex="-1"></a>      <span class="co"># Define testing and training parts for CV</span></span>
<span id="cb114-34"><a href="simulace3.html#cb114-34" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb114-35"><a href="simulace3.html#cb114-35" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb114-36"><a href="simulace3.html#cb114-36" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb114-37"><a href="simulace3.html#cb114-37" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb114-38"><a href="simulace3.html#cb114-38" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb114-39"><a href="simulace3.html#cb114-39" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb114-40"><a href="simulace3.html#cb114-40" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb114-41"><a href="simulace3.html#cb114-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb114-42"><a href="simulace3.html#cb114-42" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb114-43"><a href="simulace3.html#cb114-43" tabindex="-1"></a>      <span class="co"># Iterate over individual kernels</span></span>
<span id="cb114-44"><a href="simulace3.html#cb114-44" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb114-45"><a href="simulace3.html#cb114-45" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb114-46"><a href="simulace3.html#cb114-46" tabindex="-1"></a>      </span>
<span id="cb114-47"><a href="simulace3.html#cb114-47" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb114-48"><a href="simulace3.html#cb114-48" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb114-49"><a href="simulace3.html#cb114-49" tabindex="-1"></a>        </span>
<span id="cb114-50"><a href="simulace3.html#cb114-50" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb114-51"><a href="simulace3.html#cb114-51" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb114-52"><a href="simulace3.html#cb114-52" tabindex="-1"></a>        </span>
<span id="cb114-53"><a href="simulace3.html#cb114-53" tabindex="-1"></a>        <span class="co"># Build models</span></span>
<span id="cb114-54"><a href="simulace3.html#cb114-54" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb114-55"><a href="simulace3.html#cb114-55" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb114-56"><a href="simulace3.html#cb114-56" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb114-57"><a href="simulace3.html#cb114-57" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb114-58"><a href="simulace3.html#cb114-58" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb114-59"><a href="simulace3.html#cb114-59" tabindex="-1"></a>        </span>
<span id="cb114-60"><a href="simulace3.html#cb114-60" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb114-61"><a href="simulace3.html#cb114-61" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb114-62"><a href="simulace3.html#cb114-62" tabindex="-1"></a>        accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb114-63"><a href="simulace3.html#cb114-63" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb114-64"><a href="simulace3.html#cb114-64" tabindex="-1"></a>        </span>
<span id="cb114-65"><a href="simulace3.html#cb114-65" tabindex="-1"></a>        <span class="co"># Save results</span></span>
<span id="cb114-66"><a href="simulace3.html#cb114-66" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb114-67"><a href="simulace3.html#cb114-67" tabindex="-1"></a>      }</span>
<span id="cb114-68"><a href="simulace3.html#cb114-68" tabindex="-1"></a>      <span class="co"># Insert accuracies for the given d, gamma, and fold</span></span>
<span id="cb114-69"><a href="simulace3.html#cb114-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb114-70"><a href="simulace3.html#cb114-70" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-71"><a href="simulace3.html#cb114-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb114-72"><a href="simulace3.html#cb114-72" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb114-73"><a href="simulace3.html#cb114-73" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-74"><a href="simulace3.html#cb114-74" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb114-75"><a href="simulace3.html#cb114-75" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb114-76"><a href="simulace3.html#cb114-76" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb114-77"><a href="simulace3.html#cb114-77" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb114-78"><a href="simulace3.html#cb114-78" tabindex="-1"></a>    }</span>
<span id="cb114-79"><a href="simulace3.html#cb114-79" tabindex="-1"></a>  }</span>
<span id="cb114-80"><a href="simulace3.html#cb114-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb115"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb115-1"><a href="simulace3.html#cb115-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb115-2"><a href="simulace3.html#cb115-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb115-3"><a href="simulace3.html#cb115-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb115-4"><a href="simulace3.html#cb115-4" tabindex="-1"></a>}</span>
<span id="cb115-5"><a href="simulace3.html#cb115-5" tabindex="-1"></a></span>
<span id="cb115-6"><a href="simulace3.html#cb115-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb115-7"><a href="simulace3.html#cb115-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb115-8"><a href="simulace3.html#cb115-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb115-9"><a href="simulace3.html#cb115-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb115-10"><a href="simulace3.html#cb115-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb115-11"><a href="simulace3.html#cb115-11" tabindex="-1"></a></span>
<span id="cb115-12"><a href="simulace3.html#cb115-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb115-13"><a href="simulace3.html#cb115-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb115-14"><a href="simulace3.html#cb115-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb115-15"><a href="simulace3.html#cb115-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb115-16"><a href="simulace3.html#cb115-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb115-17"><a href="simulace3.html#cb115-17" tabindex="-1"></a></span>
<span id="cb115-18"><a href="simulace3.html#cb115-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb115-19"><a href="simulace3.html#cb115-19" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb115-20"><a href="simulace3.html#cb115-20" tabindex="-1"></a>                     <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb115-21"><a href="simulace3.html#cb115-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb115-22"><a href="simulace3.html#cb115-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb115-23"><a href="simulace3.html#cb115-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-109">Table 1.2: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validace}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">10</td>
<td align="right">8.4834</td>
<td align="right">0.0728</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">17</td>
<td align="right">8.4834</td>
<td align="right">0.0870</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">38</td>
<td align="right">0.4394</td>
<td align="right">0.1054</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best parameter values are <span class="math inline">\(d={}\)</span> 10 and <span class="math inline">\(\gamma={}\)</span> 8.4834 for the linear kernel, with the error calculated using 10-fold CV being 0.0728. Similarly, <span class="math inline">\(d={}\)</span> 17 and <span class="math inline">\(\gamma={}\)</span> 8.4834 for the polynomial kernel, with an error of 0.087, and <span class="math inline">\(d={}\)</span> 38 and <span class="math inline">\(\gamma={}\)</span> 0.4394 for the radial kernel, yielding an error of 0.1054.</p>
<p>For interest, let’s plot the validation error as a function of dimension <span class="math inline">\(d\)</span> and the hyperparameter <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb116"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb116-1"><a href="simulace3.html#cb116-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb116-2"><a href="simulace3.html#cb116-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb116-3"><a href="simulace3.html#cb116-3" tabindex="-1"></a>                               <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb116-4"><a href="simulace3.html#cb116-4" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb116-5"><a href="simulace3.html#cb116-5" tabindex="-1"></a>                                      <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb116-6"><a href="simulace3.html#cb116-6" tabindex="-1"></a>                               <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb116-7"><a href="simulace3.html#cb116-7" tabindex="-1"></a>                                            <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb116-8"><a href="simulace3.html#cb116-8" tabindex="-1"></a>                                              <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb116-9"><a href="simulace3.html#cb116-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb116-10"><a href="simulace3.html#cb116-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb116-11"><a href="simulace3.html#cb116-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb116-12"><a href="simulace3.html#cb116-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb116-13"><a href="simulace3.html#cb116-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb116-14"><a href="simulace3.html#cb116-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb116-15"><a href="simulace3.html#cb116-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb116-16"><a href="simulace3.html#cb116-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb116-17"><a href="simulace3.html#cb116-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb116-18"><a href="simulace3.html#cb116-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb116-19"><a href="simulace3.html#cb116-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-110"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-110-1.png" alt="Dependence of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 1.25: Dependence of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>In the above plots, we can see how the validation error changed with the values of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>. Notably, in all three plots for the individual kernels, significant horizontal patterns are visible. From this, we can draw a significant theoretical and practical conclusion: the considered classification method (projection onto RKHS using SVM + SVM classification) is robust to the choice of the hyperparameter <span class="math inline">\(d\)</span> (i.e., a small change in this parameter’s value does not lead to a significant deterioration in validation error), while we must be very cautious with the choice of the hyperparameter <span class="math inline">\(\gamma\)</span> (even a small change in its value can lead to a large change in validation error). This behavior is most apparent with the Gaussian kernel.</p>
<p>Since we have already found the optimal values of the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb117"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb117-1"><a href="simulace3.html#cb117-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb117-2"><a href="simulace3.html#cb117-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb117-3"><a href="simulace3.html#cb117-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb117-4"><a href="simulace3.html#cb117-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb118"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb118-1"><a href="simulace3.html#cb118-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb118-2"><a href="simulace3.html#cb118-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb118-3"><a href="simulace3.html#cb118-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb118-4"><a href="simulace3.html#cb118-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb118-5"><a href="simulace3.html#cb118-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb118-6"><a href="simulace3.html#cb118-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb118-7"><a href="simulace3.html#cb118-7" tabindex="-1"></a></span>
<span id="cb118-8"><a href="simulace3.html#cb118-8" tabindex="-1"></a><span class="co"># Loop through the individual kernels</span></span>
<span id="cb118-9"><a href="simulace3.html#cb118-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb118-10"><a href="simulace3.html#cb118-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb118-11"><a href="simulace3.html#cb118-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># gamma value from CV</span></span>
<span id="cb118-12"><a href="simulace3.html#cb118-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb118-13"><a href="simulace3.html#cb118-13" tabindex="-1"></a>  </span>
<span id="cb118-14"><a href="simulace3.html#cb118-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb118-15"><a href="simulace3.html#cb118-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb118-16"><a href="simulace3.html#cb118-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb118-17"><a href="simulace3.html#cb118-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb118-18"><a href="simulace3.html#cb118-18" tabindex="-1"></a>  <span class="co"># Determine the coefficients alpha from SVM</span></span>
<span id="cb118-19"><a href="simulace3.html#cb118-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb118-20"><a href="simulace3.html#cb118-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb118-21"><a href="simulace3.html#cb118-21" tabindex="-1"></a>  </span>
<span id="cb118-22"><a href="simulace3.html#cb118-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb118-23"><a href="simulace3.html#cb118-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb118-24"><a href="simulace3.html#cb118-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb118-25"><a href="simulace3.html#cb118-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb118-26"><a href="simulace3.html#cb118-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb118-27"><a href="simulace3.html#cb118-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb118-28"><a href="simulace3.html#cb118-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb118-29"><a href="simulace3.html#cb118-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb118-30"><a href="simulace3.html#cb118-30" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb118-31"><a href="simulace3.html#cb118-31" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb118-32"><a href="simulace3.html#cb118-32" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb118-33"><a href="simulace3.html#cb118-33" tabindex="-1"></a>  }</span>
<span id="cb118-34"><a href="simulace3.html#cb118-34" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb118-35"><a href="simulace3.html#cb118-35" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb118-36"><a href="simulace3.html#cb118-36" tabindex="-1"></a>  </span>
<span id="cb118-37"><a href="simulace3.html#cb118-37" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb118-38"><a href="simulace3.html#cb118-38" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb118-39"><a href="simulace3.html#cb118-39" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb118-40"><a href="simulace3.html#cb118-40" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb118-41"><a href="simulace3.html#cb118-41" tabindex="-1"></a>  </span>
<span id="cb118-42"><a href="simulace3.html#cb118-42" tabindex="-1"></a>  <span class="co"># Compute the representation</span></span>
<span id="cb118-43"><a href="simulace3.html#cb118-43" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb118-44"><a href="simulace3.html#cb118-44" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb118-45"><a href="simulace3.html#cb118-45" tabindex="-1"></a>  }</span>
<span id="cb118-46"><a href="simulace3.html#cb118-46" tabindex="-1"></a>  </span>
<span id="cb118-47"><a href="simulace3.html#cb118-47" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb118-48"><a href="simulace3.html#cb118-48" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb118-49"><a href="simulace3.html#cb118-49" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb118-50"><a href="simulace3.html#cb118-50" tabindex="-1"></a></span>
<span id="cb118-51"><a href="simulace3.html#cb118-51" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb118-52"><a href="simulace3.html#cb118-52" tabindex="-1"></a></span>
<span id="cb118-53"><a href="simulace3.html#cb118-53" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb118-54"><a href="simulace3.html#cb118-54" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb118-55"><a href="simulace3.html#cb118-55" tabindex="-1"></a>  </span>
<span id="cb118-56"><a href="simulace3.html#cb118-56" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb118-57"><a href="simulace3.html#cb118-57" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb118-58"><a href="simulace3.html#cb118-58" tabindex="-1"></a>  </span>
<span id="cb118-59"><a href="simulace3.html#cb118-59" tabindex="-1"></a>  <span class="co"># Model construction</span></span>
<span id="cb118-60"><a href="simulace3.html#cb118-60" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb118-61"><a href="simulace3.html#cb118-61" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb118-62"><a href="simulace3.html#cb118-62" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb118-63"><a href="simulace3.html#cb118-63" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb118-64"><a href="simulace3.html#cb118-64" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb118-65"><a href="simulace3.html#cb118-65" tabindex="-1"></a>  </span>
<span id="cb118-66"><a href="simulace3.html#cb118-66" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb118-67"><a href="simulace3.html#cb118-67" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb118-68"><a href="simulace3.html#cb118-68" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb118-69"><a href="simulace3.html#cb118-69" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb118-70"><a href="simulace3.html#cb118-70" tabindex="-1"></a>    </span>
<span id="cb118-71"><a href="simulace3.html#cb118-71" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb118-72"><a href="simulace3.html#cb118-72" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb118-73"><a href="simulace3.html#cb118-73" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb118-74"><a href="simulace3.html#cb118-74" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb118-75"><a href="simulace3.html#cb118-75" tabindex="-1"></a>  </span>
<span id="cb118-76"><a href="simulace3.html#cb118-76" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb118-77"><a href="simulace3.html#cb118-77" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb118-78"><a href="simulace3.html#cb118-78" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-113">Table 1.3: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimated training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0500</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.1333</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with the projection onto the Reproducing Kernel Hilbert Space is thus equal to 5 % for the linear kernel, 1.43 % for the polynomial kernel, and 1.43 % for the Gaussian kernel on the training data. For the test data, the error rate of the method is 13.33 % for the linear kernel, 20 % for the polynomial kernel, and 13.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb119"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb119-1"><a href="simulace3.html#cb119-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="polynomial-kernel" class="section level6 hasAnchor" number="1.3.7.6.3.2">
<h6><span class="header-section-number">1.3.7.6.3.2</span> Polynomial Kernel<a href="simulace3.html#polynomial-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb120"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb120-1"><a href="simulace3.html#cb120-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb120-2"><a href="simulace3.html#cb120-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb120-3"><a href="simulace3.html#cb120-3" tabindex="-1"></a><span class="co"># Add test data as well</span></span>
<span id="cb120-4"><a href="simulace3.html#cb120-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb120-5"><a href="simulace3.html#cb120-5" tabindex="-1"></a></span>
<span id="cb120-6"><a href="simulace3.html#cb120-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix... polynomial with parameter p</span></span>
<span id="cb120-7"><a href="simulace3.html#cb120-7" tabindex="-1"></a>Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb120-8"><a href="simulace3.html#cb120-8" tabindex="-1"></a>  <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb120-9"><a href="simulace3.html#cb120-9" tabindex="-1"></a>}</span>
<span id="cb120-10"><a href="simulace3.html#cb120-10" tabindex="-1"></a></span>
<span id="cb120-11"><a href="simulace3.html#cb120-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb120-12"><a href="simulace3.html#cb120-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb120-13"><a href="simulace3.html#cb120-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb120-14"><a href="simulace3.html#cb120-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb120-15"><a href="simulace3.html#cb120-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb120-16"><a href="simulace3.html#cb120-16" tabindex="-1"></a>    }</span>
<span id="cb120-17"><a href="simulace3.html#cb120-17" tabindex="-1"></a>  }</span>
<span id="cb120-18"><a href="simulace3.html#cb120-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb120-19"><a href="simulace3.html#cb120-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb121"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb121-1"><a href="simulace3.html#cb121-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb121-2"><a href="simulace3.html#cb121-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb121-3"><a href="simulace3.html#cb121-3" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb121-4"><a href="simulace3.html#cb121-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb121-5"><a href="simulace3.html#cb121-5" tabindex="-1"></a></span>
<span id="cb121-6"><a href="simulace3.html#cb121-6" tabindex="-1"></a><span class="co"># Values of hyperparameters to iterate over</span></span>
<span id="cb121-7"><a href="simulace3.html#cb121-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># reasonable range of values d</span></span>
<span id="cb121-8"><a href="simulace3.html#cb121-8" tabindex="-1"></a>poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb121-9"><a href="simulace3.html#cb121-9" tabindex="-1"></a></span>
<span id="cb121-10"><a href="simulace3.html#cb121-10" tabindex="-1"></a><span class="co"># List with three components... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb121-11"><a href="simulace3.html#cb121-11" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb121-12"><a href="simulace3.html#cb121-12" tabindex="-1"></a><span class="co"># Columns will have accuracy values for the given</span></span>
<span id="cb121-13"><a href="simulace3.html#cb121-13" tabindex="-1"></a><span class="co"># Rows will have values for the given p, and layers correspond to folds</span></span>
<span id="cb121-14"><a href="simulace3.html#cb121-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb121-15"><a href="simulace3.html#cb121-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb121-16"><a href="simulace3.html#cb121-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb121-17"><a href="simulace3.html#cb121-17" tabindex="-1"></a></span>
<span id="cb121-18"><a href="simulace3.html#cb121-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb121-19"><a href="simulace3.html#cb121-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-20"><a href="simulace3.html#cb121-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-21"><a href="simulace3.html#cb121-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-22"><a href="simulace3.html#cb121-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb121-23"><a href="simulace3.html#cb121-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb121-24"><a href="simulace3.html#cb121-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb122"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb122-1"><a href="simulace3.html#cb122-1" tabindex="-1"></a><span class="co"># Cross-validation</span></span>
<span id="cb122-2"><a href="simulace3.html#cb122-2" tabindex="-1"></a><span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb122-3"><a href="simulace3.html#cb122-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb122-4"><a href="simulace3.html#cb122-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb122-5"><a href="simulace3.html#cb122-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb122-6"><a href="simulace3.html#cb122-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb122-7"><a href="simulace3.html#cb122-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb122-8"><a href="simulace3.html#cb122-8" tabindex="-1"></a>  </span>
<span id="cb122-9"><a href="simulace3.html#cb122-9" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb122-10"><a href="simulace3.html#cb122-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb122-11"><a href="simulace3.html#cb122-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb122-12"><a href="simulace3.html#cb122-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb122-13"><a href="simulace3.html#cb122-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb122-14"><a href="simulace3.html#cb122-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb122-15"><a href="simulace3.html#cb122-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb122-16"><a href="simulace3.html#cb122-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb122-17"><a href="simulace3.html#cb122-17" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb122-18"><a href="simulace3.html#cb122-18" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb122-19"><a href="simulace3.html#cb122-19" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb122-20"><a href="simulace3.html#cb122-20" tabindex="-1"></a>  }</span>
<span id="cb122-21"><a href="simulace3.html#cb122-21" tabindex="-1"></a>  </span>
<span id="cb122-22"><a href="simulace3.html#cb122-22" tabindex="-1"></a>  <span class="co"># Iterate over dimensions</span></span>
<span id="cb122-23"><a href="simulace3.html#cb122-23" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb122-24"><a href="simulace3.html#cb122-24" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb122-25"><a href="simulace3.html#cb122-25" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb122-26"><a href="simulace3.html#cb122-26" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb122-27"><a href="simulace3.html#cb122-27" tabindex="-1"></a>    <span class="co"># Compute representation</span></span>
<span id="cb122-28"><a href="simulace3.html#cb122-28" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb122-29"><a href="simulace3.html#cb122-29" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb122-30"><a href="simulace3.html#cb122-30" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb122-31"><a href="simulace3.html#cb122-31" tabindex="-1"></a>    }</span>
<span id="cb122-32"><a href="simulace3.html#cb122-32" tabindex="-1"></a>    <span class="co"># Iterate over folds</span></span>
<span id="cb122-33"><a href="simulace3.html#cb122-33" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb122-34"><a href="simulace3.html#cb122-34" tabindex="-1"></a>      <span class="co"># Define test and training parts for CV</span></span>
<span id="cb122-35"><a href="simulace3.html#cb122-35" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb122-36"><a href="simulace3.html#cb122-36" tabindex="-1"></a>      <span class="co"># Split into training and validation data</span></span>
<span id="cb122-37"><a href="simulace3.html#cb122-37" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb122-38"><a href="simulace3.html#cb122-38" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb122-39"><a href="simulace3.html#cb122-39" tabindex="-1"></a>      <span class="co"># Prepare a data table to store results</span></span>
<span id="cb122-40"><a href="simulace3.html#cb122-40" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb122-41"><a href="simulace3.html#cb122-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb122-42"><a href="simulace3.html#cb122-42" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb122-43"><a href="simulace3.html#cb122-43" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb122-44"><a href="simulace3.html#cb122-44" tabindex="-1"></a>      <span class="co"># Iterate over individual kernels</span></span>
<span id="cb122-45"><a href="simulace3.html#cb122-45" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb122-46"><a href="simulace3.html#cb122-46" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb122-47"><a href="simulace3.html#cb122-47" tabindex="-1"></a>      </span>
<span id="cb122-48"><a href="simulace3.html#cb122-48" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb122-49"><a href="simulace3.html#cb122-49" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb122-50"><a href="simulace3.html#cb122-50" tabindex="-1"></a>        </span>
<span id="cb122-51"><a href="simulace3.html#cb122-51" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb122-52"><a href="simulace3.html#cb122-52" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb122-53"><a href="simulace3.html#cb122-53" tabindex="-1"></a>        </span>
<span id="cb122-54"><a href="simulace3.html#cb122-54" tabindex="-1"></a>        <span class="co"># Construct models</span></span>
<span id="cb122-55"><a href="simulace3.html#cb122-55" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb122-56"><a href="simulace3.html#cb122-56" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb122-57"><a href="simulace3.html#cb122-57" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb122-58"><a href="simulace3.html#cb122-58" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb122-59"><a href="simulace3.html#cb122-59" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb122-60"><a href="simulace3.html#cb122-60" tabindex="-1"></a>        </span>
<span id="cb122-61"><a href="simulace3.html#cb122-61" tabindex="-1"></a>        <span class="co"># Accuracy on validation data</span></span>
<span id="cb122-62"><a href="simulace3.html#cb122-62" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb122-63"><a href="simulace3.html#cb122-63" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb122-64"><a href="simulace3.html#cb122-64" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb122-65"><a href="simulace3.html#cb122-65" tabindex="-1"></a>        </span>
<span id="cb122-66"><a href="simulace3.html#cb122-66" tabindex="-1"></a>        <span class="co"># Save results</span></span>
<span id="cb122-67"><a href="simulace3.html#cb122-67" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb122-68"><a href="simulace3.html#cb122-68" tabindex="-1"></a>      }</span>
<span id="cb122-69"><a href="simulace3.html#cb122-69" tabindex="-1"></a>      <span class="co"># Store accuracies for the given d, gamma, and fold</span></span>
<span id="cb122-70"><a href="simulace3.html#cb122-70" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb122-71"><a href="simulace3.html#cb122-71" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb122-72"><a href="simulace3.html#cb122-72" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb122-73"><a href="simulace3.html#cb122-73" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb122-74"><a href="simulace3.html#cb122-74" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb122-75"><a href="simulace3.html#cb122-75" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb122-76"><a href="simulace3.html#cb122-76" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb122-77"><a href="simulace3.html#cb122-77" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb122-78"><a href="simulace3.html#cb122-78" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb122-79"><a href="simulace3.html#cb122-79" tabindex="-1"></a>    }</span>
<span id="cb122-80"><a href="simulace3.html#cb122-80" tabindex="-1"></a>  }</span>
<span id="cb122-81"><a href="simulace3.html#cb122-81" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb123"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb123-1"><a href="simulace3.html#cb123-1" tabindex="-1"></a><span class="co"># Calculate the average accuracy for each d across folds</span></span>
<span id="cb123-2"><a href="simulace3.html#cb123-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb123-3"><a href="simulace3.html#cb123-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb123-4"><a href="simulace3.html#cb123-4" tabindex="-1"></a>}</span>
<span id="cb123-5"><a href="simulace3.html#cb123-5" tabindex="-1"></a></span>
<span id="cb123-6"><a href="simulace3.html#cb123-6" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb123-7"><a href="simulace3.html#cb123-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb123-8"><a href="simulace3.html#cb123-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb123-9"><a href="simulace3.html#cb123-9" tabindex="-1"></a>poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb123-10"><a href="simulace3.html#cb123-10" tabindex="-1"></a>poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb123-11"><a href="simulace3.html#cb123-11" tabindex="-1"></a></span>
<span id="cb123-12"><a href="simulace3.html#cb123-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb123-13"><a href="simulace3.html#cb123-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb123-14"><a href="simulace3.html#cb123-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb123-15"><a href="simulace3.html#cb123-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb123-16"><a href="simulace3.html#cb123-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb123-17"><a href="simulace3.html#cb123-17" tabindex="-1"></a></span>
<span id="cb123-18"><a href="simulace3.html#cb123-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb123-19"><a href="simulace3.html#cb123-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb123-20"><a href="simulace3.html#cb123-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb123-21"><a href="simulace3.html#cb123-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb123-22"><a href="simulace3.html#cb123-22" tabindex="-1"></a>           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb123-23"><a href="simulace3.html#cb123-23" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-118">Table 1.4: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad p\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">17</td>
<td align="right">4</td>
<td align="right">0.1412</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">10</td>
<td align="right">4</td>
<td align="right">0.1429</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">38</td>
<td align="right">4</td>
<td align="right">0.1550</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the best values for the parameter <span class="math inline">\(d={}\)</span> 17 and <span class="math inline">\(p={}\)</span> 4 are for the linear kernel, with an error value computed using 10-fold CV of 0.1412. The values <span class="math inline">\(d={}\)</span> 10 and <span class="math inline">\(p={}\)</span> 4 are for the polynomial kernel, with an error value computed using 10-fold CV of 0.1429, and <span class="math inline">\(d={}\)</span> 38 and <span class="math inline">\(p={}\)</span> 4 are for the radial kernel, with an error value of 0.155.</p>
<p>Since we have found the optimal values of the hyperparameters, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb124"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb124-1"><a href="simulace3.html#cb124-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the values of Y</span></span>
<span id="cb124-2"><a href="simulace3.html#cb124-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb124-3"><a href="simulace3.html#cb124-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb124-4"><a href="simulace3.html#cb124-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb125"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb125-1"><a href="simulace3.html#cb125-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb125-2"><a href="simulace3.html#cb125-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb125-3"><a href="simulace3.html#cb125-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb125-4"><a href="simulace3.html#cb125-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb125-5"><a href="simulace3.html#cb125-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb125-6"><a href="simulace3.html#cb125-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb125-7"><a href="simulace3.html#cb125-7" tabindex="-1"></a></span>
<span id="cb125-8"><a href="simulace3.html#cb125-8" tabindex="-1"></a><span class="co"># Loop through individual kernels</span></span>
<span id="cb125-9"><a href="simulace3.html#cb125-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb125-10"><a href="simulace3.html#cb125-10" tabindex="-1"></a>  <span class="co"># Calculate matrix K</span></span>
<span id="cb125-11"><a href="simulace3.html#cb125-11" tabindex="-1"></a>  p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># value of gamma from CV</span></span>
<span id="cb125-12"><a href="simulace3.html#cb125-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb125-13"><a href="simulace3.html#cb125-13" tabindex="-1"></a>  </span>
<span id="cb125-14"><a href="simulace3.html#cb125-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb125-15"><a href="simulace3.html#cb125-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb125-16"><a href="simulace3.html#cb125-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb125-17"><a href="simulace3.html#cb125-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb125-18"><a href="simulace3.html#cb125-18" tabindex="-1"></a>  <span class="co"># Determine alpha coefficients from SVM</span></span>
<span id="cb125-19"><a href="simulace3.html#cb125-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb125-20"><a href="simulace3.html#cb125-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb125-21"><a href="simulace3.html#cb125-21" tabindex="-1"></a>  </span>
<span id="cb125-22"><a href="simulace3.html#cb125-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb125-23"><a href="simulace3.html#cb125-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb125-24"><a href="simulace3.html#cb125-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb125-25"><a href="simulace3.html#cb125-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb125-26"><a href="simulace3.html#cb125-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb125-27"><a href="simulace3.html#cb125-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb125-28"><a href="simulace3.html#cb125-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb125-29"><a href="simulace3.html#cb125-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb125-30"><a href="simulace3.html#cb125-30" tabindex="-1"></a>                    <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb125-31"><a href="simulace3.html#cb125-31" tabindex="-1"></a>                    <span class="at">degree =</span> p)</span>
<span id="cb125-32"><a href="simulace3.html#cb125-32" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb125-33"><a href="simulace3.html#cb125-33" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb125-34"><a href="simulace3.html#cb125-34" tabindex="-1"></a>  }</span>
<span id="cb125-35"><a href="simulace3.html#cb125-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb125-36"><a href="simulace3.html#cb125-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb125-37"><a href="simulace3.html#cb125-37" tabindex="-1"></a>  </span>
<span id="cb125-38"><a href="simulace3.html#cb125-38" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb125-39"><a href="simulace3.html#cb125-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb125-40"><a href="simulace3.html#cb125-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb125-41"><a href="simulace3.html#cb125-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb125-42"><a href="simulace3.html#cb125-42" tabindex="-1"></a>  </span>
<span id="cb125-43"><a href="simulace3.html#cb125-43" tabindex="-1"></a>  <span class="co"># Compute representation</span></span>
<span id="cb125-44"><a href="simulace3.html#cb125-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb125-45"><a href="simulace3.html#cb125-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb125-46"><a href="simulace3.html#cb125-46" tabindex="-1"></a>  }</span>
<span id="cb125-47"><a href="simulace3.html#cb125-47" tabindex="-1"></a>  </span>
<span id="cb125-48"><a href="simulace3.html#cb125-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb125-49"><a href="simulace3.html#cb125-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb125-50"><a href="simulace3.html#cb125-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb125-51"><a href="simulace3.html#cb125-51" tabindex="-1"></a></span>
<span id="cb125-52"><a href="simulace3.html#cb125-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb125-53"><a href="simulace3.html#cb125-53" tabindex="-1"></a></span>
<span id="cb125-54"><a href="simulace3.html#cb125-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb125-55"><a href="simulace3.html#cb125-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb125-56"><a href="simulace3.html#cb125-56" tabindex="-1"></a>  </span>
<span id="cb125-57"><a href="simulace3.html#cb125-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb125-58"><a href="simulace3.html#cb125-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb125-59"><a href="simulace3.html#cb125-59" tabindex="-1"></a>  </span>
<span id="cb125-60"><a href="simulace3.html#cb125-60" tabindex="-1"></a>  <span class="co"># Model construction</span></span>
<span id="cb125-61"><a href="simulace3.html#cb125-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb125-62"><a href="simulace3.html#cb125-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb125-63"><a href="simulace3.html#cb125-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb125-64"><a href="simulace3.html#cb125-64" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb125-65"><a href="simulace3.html#cb125-65" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb125-66"><a href="simulace3.html#cb125-66" tabindex="-1"></a>  </span>
<span id="cb125-67"><a href="simulace3.html#cb125-67" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb125-68"><a href="simulace3.html#cb125-68" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb125-69"><a href="simulace3.html#cb125-69" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb125-70"><a href="simulace3.html#cb125-70" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb125-71"><a href="simulace3.html#cb125-71" tabindex="-1"></a>    </span>
<span id="cb125-72"><a href="simulace3.html#cb125-72" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb125-73"><a href="simulace3.html#cb125-73" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb125-74"><a href="simulace3.html#cb125-74" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb125-75"><a href="simulace3.html#cb125-75" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb125-76"><a href="simulace3.html#cb125-76" tabindex="-1"></a>  </span>
<span id="cb125-77"><a href="simulace3.html#cb125-77" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb125-78"><a href="simulace3.html#cb125-78" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb125-79"><a href="simulace3.html#cb125-79" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-121">Table 1.5: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.1071</td>
<td align="center">0.2167</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.1000</td>
<td align="center">0.2333</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus 10.71 % for the linear kernel, 6.43 % for the polynomial kernel, and 10 % for the Gaussian kernel.
On the test data, the error rate of the method is 21.67 % for the linear kernel, 20 % for the polynomial kernel, and 23.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb126"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb126-1"><a href="simulace3.html#cb126-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="linear-kernel" class="section level6 hasAnchor" number="1.3.7.6.3.3">
<h6><span class="header-section-number">1.3.7.6.3.3</span> Linear Kernel<a href="simulace3.html#linear-kernel" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb127"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb127-1"><a href="simulace3.html#cb127-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb127-2"><a href="simulace3.html#cb127-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb127-3"><a href="simulace3.html#cb127-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb127-4"><a href="simulace3.html#cb127-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb127-5"><a href="simulace3.html#cb127-5" tabindex="-1"></a></span>
<span id="cb127-6"><a href="simulace3.html#cb127-6" tabindex="-1"></a><span class="co"># Kernel and kernel matrix ... polynomial with parameter p</span></span>
<span id="cb127-7"><a href="simulace3.html#cb127-7" tabindex="-1"></a>Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb127-8"><a href="simulace3.html#cb127-8" tabindex="-1"></a>  <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb127-9"><a href="simulace3.html#cb127-9" tabindex="-1"></a>}</span>
<span id="cb127-10"><a href="simulace3.html#cb127-10" tabindex="-1"></a></span>
<span id="cb127-11"><a href="simulace3.html#cb127-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb127-12"><a href="simulace3.html#cb127-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb127-13"><a href="simulace3.html#cb127-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb127-14"><a href="simulace3.html#cb127-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb127-15"><a href="simulace3.html#cb127-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb127-16"><a href="simulace3.html#cb127-16" tabindex="-1"></a>    }</span>
<span id="cb127-17"><a href="simulace3.html#cb127-17" tabindex="-1"></a>  }</span>
<span id="cb127-18"><a href="simulace3.html#cb127-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb127-19"><a href="simulace3.html#cb127-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb128"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb128-1"><a href="simulace3.html#cb128-1" tabindex="-1"></a><span class="co"># Split training data into k parts</span></span>
<span id="cb128-2"><a href="simulace3.html#cb128-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb128-3"><a href="simulace3.html#cb128-3" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb128-4"><a href="simulace3.html#cb128-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb128-5"><a href="simulace3.html#cb128-5" tabindex="-1"></a></span>
<span id="cb128-6"><a href="simulace3.html#cb128-6" tabindex="-1"></a><span class="co"># Hyperparameter values to iterate through</span></span>
<span id="cb128-7"><a href="simulace3.html#cb128-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb128-8"><a href="simulace3.html#cb128-8" tabindex="-1"></a></span>
<span id="cb128-9"><a href="simulace3.html#cb128-9" tabindex="-1"></a><span class="co"># List with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb128-10"><a href="simulace3.html#cb128-10" tabindex="-1"></a><span class="co"># Empty matrix to store individual results</span></span>
<span id="cb128-11"><a href="simulace3.html#cb128-11" tabindex="-1"></a><span class="co"># Columns will hold accuracy values for given d</span></span>
<span id="cb128-12"><a href="simulace3.html#cb128-12" tabindex="-1"></a><span class="co"># Rows will hold values for layers corresponding to folds</span></span>
<span id="cb128-13"><a href="simulace3.html#cb128-13" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb128-14"><a href="simulace3.html#cb128-14" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb128-15"><a href="simulace3.html#cb128-15" tabindex="-1"></a></span>
<span id="cb128-16"><a href="simulace3.html#cb128-16" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb128-17"><a href="simulace3.html#cb128-17" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb128-18"><a href="simulace3.html#cb128-18" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb128-19"><a href="simulace3.html#cb128-19" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb128-20"><a href="simulace3.html#cb128-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb128-21"><a href="simulace3.html#cb128-21" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb128-22"><a href="simulace3.html#cb128-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb129"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb129-1"><a href="simulace3.html#cb129-1" tabindex="-1"></a><span class="co"># Cross-validation itself</span></span>
<span id="cb129-2"><a href="simulace3.html#cb129-2" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb129-3"><a href="simulace3.html#cb129-3" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb129-4"><a href="simulace3.html#cb129-4" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb129-5"><a href="simulace3.html#cb129-5" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb129-6"><a href="simulace3.html#cb129-6" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb129-7"><a href="simulace3.html#cb129-7" tabindex="-1"></a></span>
<span id="cb129-8"><a href="simulace3.html#cb129-8" tabindex="-1"></a><span class="co"># Model</span></span>
<span id="cb129-9"><a href="simulace3.html#cb129-9" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb129-10"><a href="simulace3.html#cb129-10" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb129-11"><a href="simulace3.html#cb129-11" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb129-12"><a href="simulace3.html#cb129-12" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb129-13"><a href="simulace3.html#cb129-13" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb129-14"><a href="simulace3.html#cb129-14" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb129-15"><a href="simulace3.html#cb129-15" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb129-16"><a href="simulace3.html#cb129-16" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb129-17"><a href="simulace3.html#cb129-17" tabindex="-1"></a>}</span>
<span id="cb129-18"><a href="simulace3.html#cb129-18" tabindex="-1"></a></span>
<span id="cb129-19"><a href="simulace3.html#cb129-19" tabindex="-1"></a><span class="co"># Iterate through dimensions</span></span>
<span id="cb129-20"><a href="simulace3.html#cb129-20" tabindex="-1"></a><span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb129-21"><a href="simulace3.html#cb129-21" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb129-22"><a href="simulace3.html#cb129-22" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb129-23"><a href="simulace3.html#cb129-23" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb129-24"><a href="simulace3.html#cb129-24" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb129-25"><a href="simulace3.html#cb129-25" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb129-26"><a href="simulace3.html#cb129-26" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb129-27"><a href="simulace3.html#cb129-27" tabindex="-1"></a>                           alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb129-28"><a href="simulace3.html#cb129-28" tabindex="-1"></a>  }</span>
<span id="cb129-29"><a href="simulace3.html#cb129-29" tabindex="-1"></a>  <span class="co"># Iterate through folds</span></span>
<span id="cb129-30"><a href="simulace3.html#cb129-30" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb129-31"><a href="simulace3.html#cb129-31" tabindex="-1"></a>    <span class="co"># Define test and training parts for CV</span></span>
<span id="cb129-32"><a href="simulace3.html#cb129-32" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb129-33"><a href="simulace3.html#cb129-33" tabindex="-1"></a>    <span class="co"># Split into training and validation data</span></span>
<span id="cb129-34"><a href="simulace3.html#cb129-34" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb129-35"><a href="simulace3.html#cb129-35" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb129-36"><a href="simulace3.html#cb129-36" tabindex="-1"></a>    <span class="co"># Prepare a data table to store results</span></span>
<span id="cb129-37"><a href="simulace3.html#cb129-37" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb129-38"><a href="simulace3.html#cb129-38" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb129-39"><a href="simulace3.html#cb129-39" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb129-40"><a href="simulace3.html#cb129-40" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb129-41"><a href="simulace3.html#cb129-41" tabindex="-1"></a>    <span class="co"># Iterate through individual kernels</span></span>
<span id="cb129-42"><a href="simulace3.html#cb129-42" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb129-43"><a href="simulace3.html#cb129-43" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb129-44"><a href="simulace3.html#cb129-44" tabindex="-1"></a>    </span>
<span id="cb129-45"><a href="simulace3.html#cb129-45" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb129-46"><a href="simulace3.html#cb129-46" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb129-47"><a href="simulace3.html#cb129-47" tabindex="-1"></a>      </span>
<span id="cb129-48"><a href="simulace3.html#cb129-48" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb129-49"><a href="simulace3.html#cb129-49" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb129-50"><a href="simulace3.html#cb129-50" tabindex="-1"></a>      </span>
<span id="cb129-51"><a href="simulace3.html#cb129-51" tabindex="-1"></a>      <span class="co"># Constructing the model</span></span>
<span id="cb129-52"><a href="simulace3.html#cb129-52" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb129-53"><a href="simulace3.html#cb129-53" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb129-54"><a href="simulace3.html#cb129-54" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb129-55"><a href="simulace3.html#cb129-55" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb129-56"><a href="simulace3.html#cb129-56" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type)</span>
<span id="cb129-57"><a href="simulace3.html#cb129-57" tabindex="-1"></a>      </span>
<span id="cb129-58"><a href="simulace3.html#cb129-58" tabindex="-1"></a>      <span class="co"># Accuracy on validation data</span></span>
<span id="cb129-59"><a href="simulace3.html#cb129-59" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb129-60"><a href="simulace3.html#cb129-60" tabindex="-1"></a>      accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb129-61"><a href="simulace3.html#cb129-61" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb129-62"><a href="simulace3.html#cb129-62" tabindex="-1"></a>      </span>
<span id="cb129-63"><a href="simulace3.html#cb129-63" tabindex="-1"></a>      <span class="co"># Store the results</span></span>
<span id="cb129-64"><a href="simulace3.html#cb129-64" tabindex="-1"></a>      Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb129-65"><a href="simulace3.html#cb129-65" tabindex="-1"></a>    }</span>
<span id="cb129-66"><a href="simulace3.html#cb129-66" tabindex="-1"></a>    <span class="co"># Insert accuracies into positions for given d, gamma, and fold</span></span>
<span id="cb129-67"><a href="simulace3.html#cb129-67" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb129-68"><a href="simulace3.html#cb129-68" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb129-69"><a href="simulace3.html#cb129-69" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb129-70"><a href="simulace3.html#cb129-70" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb129-71"><a href="simulace3.html#cb129-71" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb129-72"><a href="simulace3.html#cb129-72" tabindex="-1"></a>                     index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb129-73"><a href="simulace3.html#cb129-73" tabindex="-1"></a>  }</span>
<span id="cb129-74"><a href="simulace3.html#cb129-74" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb130"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb130-1"><a href="simulace3.html#cb130-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each d across folds</span></span>
<span id="cb130-2"><a href="simulace3.html#cb130-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb130-3"><a href="simulace3.html#cb130-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb130-4"><a href="simulace3.html#cb130-4" tabindex="-1"></a>}</span>
<span id="cb130-5"><a href="simulace3.html#cb130-5" tabindex="-1"></a></span>
<span id="cb130-6"><a href="simulace3.html#cb130-6" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb130-7"><a href="simulace3.html#cb130-7" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb130-8"><a href="simulace3.html#cb130-8" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb130-9"><a href="simulace3.html#cb130-9" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb130-10"><a href="simulace3.html#cb130-10" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb130-11"><a href="simulace3.html#cb130-11" tabindex="-1"></a></span>
<span id="cb130-12"><a href="simulace3.html#cb130-12" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb130-13"><a href="simulace3.html#cb130-13" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb130-14"><a href="simulace3.html#cb130-14" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb130-15"><a href="simulace3.html#cb130-15" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb130-16"><a href="simulace3.html#cb130-16" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb130-17"><a href="simulace3.html#cb130-17" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-126">Table 1.6: </span>Summary of cross-validation results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates test error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">9</td>
<td align="right">0.4158</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">30</td>
<td align="right">0.3753</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">17</td>
<td align="right">0.3962</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter value <span class="math inline">\(d={}\)</span> 9 for the linear kernel corresponds to a classification error rate estimated using 10-fold CV of 0.4158, <span class="math inline">\(d={}\)</span> 30 for the polynomial kernel has a classification error rate estimated using 10-fold CV of 0.3753, and <span class="math inline">\(d={}\)</span> 17 for the radial kernel has a classification error rate of 0.3962.</p>
<p>Now that we have found the optimal hyperparameter values, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb131"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb131-1"><a href="simulace3.html#cb131-1" tabindex="-1"></a><span class="co"># Remove the last column containing Y values</span></span>
<span id="cb131-2"><a href="simulace3.html#cb131-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb131-3"><a href="simulace3.html#cb131-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb131-4"><a href="simulace3.html#cb131-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb132"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb132-1"><a href="simulace3.html#cb132-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb132-2"><a href="simulace3.html#cb132-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb132-3"><a href="simulace3.html#cb132-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb132-4"><a href="simulace3.html#cb132-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb132-5"><a href="simulace3.html#cb132-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb132-6"><a href="simulace3.html#cb132-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb132-7"><a href="simulace3.html#cb132-7" tabindex="-1"></a></span>
<span id="cb132-8"><a href="simulace3.html#cb132-8" tabindex="-1"></a><span class="co"># Iterate through individual kernels</span></span>
<span id="cb132-9"><a href="simulace3.html#cb132-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb132-10"><a href="simulace3.html#cb132-10" tabindex="-1"></a>  <span class="co"># Calculate the K matrix</span></span>
<span id="cb132-11"><a href="simulace3.html#cb132-11" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb132-12"><a href="simulace3.html#cb132-12" tabindex="-1"></a>  </span>
<span id="cb132-13"><a href="simulace3.html#cb132-13" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb132-14"><a href="simulace3.html#cb132-14" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb132-15"><a href="simulace3.html#cb132-15" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb132-16"><a href="simulace3.html#cb132-16" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb132-17"><a href="simulace3.html#cb132-17" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb132-18"><a href="simulace3.html#cb132-18" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb132-19"><a href="simulace3.html#cb132-19" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb132-20"><a href="simulace3.html#cb132-20" tabindex="-1"></a>  </span>
<span id="cb132-21"><a href="simulace3.html#cb132-21" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb132-22"><a href="simulace3.html#cb132-22" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb132-23"><a href="simulace3.html#cb132-23" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb132-24"><a href="simulace3.html#cb132-24" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb132-25"><a href="simulace3.html#cb132-25" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb132-26"><a href="simulace3.html#cb132-26" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb132-27"><a href="simulace3.html#cb132-27" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb132-28"><a href="simulace3.html#cb132-28" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb132-29"><a href="simulace3.html#cb132-29" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb132-30"><a href="simulace3.html#cb132-30" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb132-31"><a href="simulace3.html#cb132-31" tabindex="-1"></a>  }</span>
<span id="cb132-32"><a href="simulace3.html#cb132-32" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb132-33"><a href="simulace3.html#cb132-33" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb132-34"><a href="simulace3.html#cb132-34" tabindex="-1"></a>  </span>
<span id="cb132-35"><a href="simulace3.html#cb132-35" tabindex="-1"></a>  <span class="co"># Determine lambda vector</span></span>
<span id="cb132-36"><a href="simulace3.html#cb132-36" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb132-37"><a href="simulace3.html#cb132-37" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb132-38"><a href="simulace3.html#cb132-38" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb132-39"><a href="simulace3.html#cb132-39" tabindex="-1"></a>  </span>
<span id="cb132-40"><a href="simulace3.html#cb132-40" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb132-41"><a href="simulace3.html#cb132-41" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb132-42"><a href="simulace3.html#cb132-42" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb132-43"><a href="simulace3.html#cb132-43" tabindex="-1"></a>  }</span>
<span id="cb132-44"><a href="simulace3.html#cb132-44" tabindex="-1"></a>  </span>
<span id="cb132-45"><a href="simulace3.html#cb132-45" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb132-46"><a href="simulace3.html#cb132-46" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb132-47"><a href="simulace3.html#cb132-47" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb132-48"><a href="simulace3.html#cb132-48" tabindex="-1"></a></span>
<span id="cb132-49"><a href="simulace3.html#cb132-49" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb132-50"><a href="simulace3.html#cb132-50" tabindex="-1"></a></span>
<span id="cb132-51"><a href="simulace3.html#cb132-51" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb132-52"><a href="simulace3.html#cb132-52" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb132-53"><a href="simulace3.html#cb132-53" tabindex="-1"></a>  </span>
<span id="cb132-54"><a href="simulace3.html#cb132-54" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb132-55"><a href="simulace3.html#cb132-55" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb132-56"><a href="simulace3.html#cb132-56" tabindex="-1"></a>  </span>
<span id="cb132-57"><a href="simulace3.html#cb132-57" tabindex="-1"></a>  <span class="co"># Constructing the models</span></span>
<span id="cb132-58"><a href="simulace3.html#cb132-58" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb132-59"><a href="simulace3.html#cb132-59" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb132-60"><a href="simulace3.html#cb132-60" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb132-61"><a href="simulace3.html#cb132-61" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb132-62"><a href="simulace3.html#cb132-62" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb132-63"><a href="simulace3.html#cb132-63" tabindex="-1"></a>  </span>
<span id="cb132-64"><a href="simulace3.html#cb132-64" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb132-65"><a href="simulace3.html#cb132-65" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb132-66"><a href="simulace3.html#cb132-66" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb132-67"><a href="simulace3.html#cb132-67" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb132-68"><a href="simulace3.html#cb132-68" tabindex="-1"></a>    </span>
<span id="cb132-69"><a href="simulace3.html#cb132-69" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb132-70"><a href="simulace3.html#cb132-70" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb132-71"><a href="simulace3.html#cb132-71" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb132-72"><a href="simulace3.html#cb132-72" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb132-73"><a href="simulace3.html#cb132-73" tabindex="-1"></a>  </span>
<span id="cb132-74"><a href="simulace3.html#cb132-74" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb132-75"><a href="simulace3.html#cb132-75" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb132-76"><a href="simulace3.html#cb132-76" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-129">Table 1.7: </span>Summary of results for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.3643</td>
<td align="center">0.3000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.2071</td>
<td align="center">0.3500</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.3833</td>
</tr>
</tbody>
</table>
<p>The error rate for the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is thus equal to 36.43 % on the training data for the linear kernel, 20.71 % for the polynomial kernel, and 30.71 % for the Gaussian kernel.
On the test data, the error rate is then 30 % for the linear kernel, 35 % for the polynomial kernel, and 38.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb133"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb133-1"><a href="simulace3.html#cb133-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
</div>
<div id="table-of-results" class="section level3 hasAnchor" number="1.3.8">
<h3><span class="header-section-number">1.3.8</span> Table of results<a href="simulace3.html#table-of-results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-131">Table 1.8: </span>Summary of the results of methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes the test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.3571</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.4143</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3571</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">LR score</td>
<td align="center">0.4071</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">Tree - discret.</td>
<td align="center">0.3357</td>
<td align="center">0.4667</td>
</tr>
<tr class="odd">
<td align="left">Tree - score</td>
<td align="center">0.3786</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">Tree - Bbasis</td>
<td align="center">0.3357</td>
<td align="center">0.4500</td>
</tr>
<tr class="odd">
<td align="left">RForest - discr</td>
<td align="center">0.0071</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0429</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0071</td>
<td align="center">0.3667</td>
</tr>
<tr class="even">
<td align="left">SVM linear - func</td>
<td align="center">0.0500</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - func</td>
<td align="center">0.1143</td>
<td align="center">0.2667</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - func</td>
<td align="center">0.0286</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discr</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="even">
<td align="left">SVM poly - discr</td>
<td align="center">0.0929</td>
<td align="center">0.2167</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - discr</td>
<td align="center">0.0214</td>
<td align="center">0.1167</td>
</tr>
<tr class="even">
<td align="left">SVM linear - PCA</td>
<td align="center">0.4000</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - PCA</td>
<td align="center">0.4071</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.3643</td>
<td align="center">0.4167</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0643</td>
<td align="center">0.0667</td>
</tr>
<tr class="even">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0429</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.1357</td>
<td align="center">0.2000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - projection</td>
<td align="center">0.0429</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - projection</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0500</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0500</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.2000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - poly</td>
<td align="center">0.1071</td>
<td align="center">0.2167</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - poly</td>
<td align="center">0.0643</td>
<td align="center">0.2000</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - poly</td>
<td align="center">0.1000</td>
<td align="center">0.2333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - RKHS - linear</td>
<td align="center">0.3643</td>
<td align="center">0.3000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - linear</td>
<td align="center">0.2071</td>
<td align="center">0.3500</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - linear</td>
<td align="center">0.3071</td>
<td align="center">0.3833</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simulation-study" class="section level2 hasAnchor" number="1.4">
<h2><span class="header-section-number">1.4</span> Simulation Study<a href="simulace3.html#simulation-study" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the entire previous section, we dealt with only one randomly generated dataset of functions from two classification classes, which we then randomly split into testing and training parts. After that, we evaluated the individual classifiers obtained using the considered methods based on testing and training errors.</p>
<p>Since the generated data (and their division into two parts) can vary significantly with each repetition, the errors of individual classification algorithms will also vary significantly. Therefore, making any conclusions about the methods and comparing them with each other based on one generated dataset can be very misleading.</p>
<p>For this reason, in this section, we will focus on repeating the entire previous procedure for different generated datasets. We will store the results in a table and finally calculate the average characteristics of the models across the individual repetitions. To ensure that our conclusions are sufficiently general, we will choose the number of repetitions <span class="math inline">\(n_{sim} = 100\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb134"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb134-1"><a href="simulace3.html#cb134-1" tabindex="-1"></a><span class="co"># Setting the random number generator</span></span>
<span id="cb134-2"><a href="simulace3.html#cb134-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb134-3"><a href="simulace3.html#cb134-3" tabindex="-1"></a></span>
<span id="cb134-4"><a href="simulace3.html#cb134-4" tabindex="-1"></a><span class="co"># Number of simulations</span></span>
<span id="cb134-5"><a href="simulace3.html#cb134-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb134-6"><a href="simulace3.html#cb134-6" tabindex="-1"></a></span>
<span id="cb134-7"><a href="simulace3.html#cb134-7" tabindex="-1"></a><span class="do">## List to store error values</span></span>
<span id="cb134-8"><a href="simulace3.html#cb134-8" tabindex="-1"></a><span class="co"># The columns will be methods</span></span>
<span id="cb134-9"><a href="simulace3.html#cb134-9" tabindex="-1"></a><span class="co"># The rows will be individual repetitions</span></span>
<span id="cb134-10"><a href="simulace3.html#cb134-10" tabindex="-1"></a><span class="co"># The list has two items ... train and test</span></span>
<span id="cb134-11"><a href="simulace3.html#cb134-11" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;LR_score&#39;</span>, <span class="st">&#39;Tree_discr&#39;</span>,</span>
<span id="cb134-12"><a href="simulace3.html#cb134-12" tabindex="-1"></a>             <span class="st">&#39;Tree_score&#39;</span>, <span class="st">&#39;Tree_Bbasis&#39;</span>, <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb134-13"><a href="simulace3.html#cb134-13" tabindex="-1"></a>             <span class="st">&#39;SVM linear - func&#39;</span>, <span class="st">&#39;SVM poly - func&#39;</span>, <span class="st">&#39;SVM rbf - func&#39;</span>,</span>
<span id="cb134-14"><a href="simulace3.html#cb134-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb134-15"><a href="simulace3.html#cb134-15" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb134-16"><a href="simulace3.html#cb134-16" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, <span class="st">&#39;SVM rbf - Bbasis&#39;</span>,</span>
<span id="cb134-17"><a href="simulace3.html#cb134-17" tabindex="-1"></a>             <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb134-18"><a href="simulace3.html#cb134-18" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb134-19"><a href="simulace3.html#cb134-19" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>, </span>
<span id="cb134-20"><a href="simulace3.html#cb134-20" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb134-21"><a href="simulace3.html#cb134-21" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>, <span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb134-22"><a href="simulace3.html#cb134-22" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>)</span>
<span id="cb134-23"><a href="simulace3.html#cb134-23" tabindex="-1"></a></span>
<span id="cb134-24"><a href="simulace3.html#cb134-24" tabindex="-1"></a>SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb134-25"><a href="simulace3.html#cb134-25" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb134-26"><a href="simulace3.html#cb134-26" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb134-27"><a href="simulace3.html#cb134-27" tabindex="-1"></a>                 <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb134-28"><a href="simulace3.html#cb134-28" tabindex="-1"></a>                                             <span class="at">nrow =</span> n.sim,</span>
<span id="cb134-29"><a href="simulace3.html#cb134-29" tabindex="-1"></a>                                             <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb134-30"><a href="simulace3.html#cb134-30" tabindex="-1"></a></span>
<span id="cb134-31"><a href="simulace3.html#cb134-31" tabindex="-1"></a><span class="co"># Object to store optimal values of hyperparameters determined using CV</span></span>
<span id="cb134-32"><a href="simulace3.html#cb134-32" tabindex="-1"></a>CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb134-33"><a href="simulace3.html#cb134-33" tabindex="-1"></a>                         <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb134-34"><a href="simulace3.html#cb134-34" tabindex="-1"></a>                         <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb134-35"><a href="simulace3.html#cb134-35" tabindex="-1"></a>                         <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb134-36"><a href="simulace3.html#cb134-36" tabindex="-1"></a>                         <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb134-37"><a href="simulace3.html#cb134-37" tabindex="-1"></a>                         <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>, </span>
<span id="cb134-38"><a href="simulace3.html#cb134-38" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma1 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-39"><a href="simulace3.html#cb134-39" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma2 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-40"><a href="simulace3.html#cb134-40" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_gamma3 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-41"><a href="simulace3.html#cb134-41" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-42"><a href="simulace3.html#cb134-42" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-43"><a href="simulace3.html#cb134-43" tabindex="-1"></a>                         <span class="at">SVM_RKHS_radial_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-44"><a href="simulace3.html#cb134-44" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p1 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-45"><a href="simulace3.html#cb134-45" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p2 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-46"><a href="simulace3.html#cb134-46" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_p3 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-47"><a href="simulace3.html#cb134-47" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-48"><a href="simulace3.html#cb134-48" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-49"><a href="simulace3.html#cb134-49" tabindex="-1"></a>                         <span class="at">SVM_RKHS_poly_d3 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-50"><a href="simulace3.html#cb134-50" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d1 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-51"><a href="simulace3.html#cb134-51" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d2 =</span> <span class="cn">NA</span>,</span>
<span id="cb134-52"><a href="simulace3.html#cb134-52" tabindex="-1"></a>                         <span class="at">SVM_RKHS_linear_d3 =</span> <span class="cn">NA</span>)</span></code></pre></div>
</details>
<p>Now we will repeat the entire previous part 100 times and store the error values in the list <code>SIMULACE</code>. In the data table <code>CV_RESULTS</code>, we will then store the values of optimal hyperparameters—for the <span class="math inline">\(K\)</span> nearest neighbors method and for SVM, the dimension <span class="math inline">\(d\)</span> in the case of projection onto the B-spline basis. We will also store all hyperparameter values for the SVM + RKHS method.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb135"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb135-1"><a href="simulace3.html#cb135-1" tabindex="-1"></a><span class="co"># setting the seed for the random number generator</span></span>
<span id="cb135-2"><a href="simulace3.html#cb135-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb135-3"><a href="simulace3.html#cb135-3" tabindex="-1"></a></span>
<span id="cb135-4"><a href="simulace3.html#cb135-4" tabindex="-1"></a><span class="do">## SIMULATION</span></span>
<span id="cb135-5"><a href="simulace3.html#cb135-5" tabindex="-1"></a></span>
<span id="cb135-6"><a href="simulace3.html#cb135-6" tabindex="-1"></a><span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb135-7"><a href="simulace3.html#cb135-7" tabindex="-1"></a>  <span class="co"># number of generated observations for each class</span></span>
<span id="cb135-8"><a href="simulace3.html#cb135-8" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb135-9"><a href="simulace3.html#cb135-9" tabindex="-1"></a>  <span class="co"># time vector equally spaced over the interval [0, 6]</span></span>
<span id="cb135-10"><a href="simulace3.html#cb135-10" tabindex="-1"></a>  t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb135-11"><a href="simulace3.html#cb135-11" tabindex="-1"></a>  </span>
<span id="cb135-12"><a href="simulace3.html#cb135-12" tabindex="-1"></a>  <span class="co"># for Y = 0</span></span>
<span id="cb135-13"><a href="simulace3.html#cb135-13" tabindex="-1"></a>  X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb135-14"><a href="simulace3.html#cb135-14" tabindex="-1"></a>  <span class="co"># for Y = 1</span></span>
<span id="cb135-15"><a href="simulace3.html#cb135-15" tabindex="-1"></a>  X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb135-16"><a href="simulace3.html#cb135-16" tabindex="-1"></a>  </span>
<span id="cb135-17"><a href="simulace3.html#cb135-17" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb135-18"><a href="simulace3.html#cb135-18" tabindex="-1"></a>  breaks <span class="ot">&lt;-</span> t</span>
<span id="cb135-19"><a href="simulace3.html#cb135-19" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb135-20"><a href="simulace3.html#cb135-20" tabindex="-1"></a>  </span>
<span id="cb135-21"><a href="simulace3.html#cb135-21" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb135-22"><a href="simulace3.html#cb135-22" tabindex="-1"></a>                                 <span class="at">norder =</span> norder, </span>
<span id="cb135-23"><a href="simulace3.html#cb135-23" tabindex="-1"></a>                                 <span class="at">breaks =</span> breaks)</span>
<span id="cb135-24"><a href="simulace3.html#cb135-24" tabindex="-1"></a>  </span>
<span id="cb135-25"><a href="simulace3.html#cb135-25" tabindex="-1"></a>  curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb135-26"><a href="simulace3.html#cb135-26" tabindex="-1"></a>  <span class="co"># combining observations into one matrix</span></span>
<span id="cb135-27"><a href="simulace3.html#cb135-27" tabindex="-1"></a>  XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb135-28"><a href="simulace3.html#cb135-28" tabindex="-1"></a>  </span>
<span id="cb135-29"><a href="simulace3.html#cb135-29" tabindex="-1"></a>  lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># vector of lambdas</span></span>
<span id="cb135-30"><a href="simulace3.html#cb135-30" tabindex="-1"></a>  gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector to store GCV values</span></span>
<span id="cb135-31"><a href="simulace3.html#cb135-31" tabindex="-1"></a>  </span>
<span id="cb135-32"><a href="simulace3.html#cb135-32" tabindex="-1"></a>  <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb135-33"><a href="simulace3.html#cb135-33" tabindex="-1"></a>    curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb135-34"><a href="simulace3.html#cb135-34" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb135-35"><a href="simulace3.html#cb135-35" tabindex="-1"></a>    gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb135-36"><a href="simulace3.html#cb135-36" tabindex="-1"></a>  }</span>
<span id="cb135-37"><a href="simulace3.html#cb135-37" tabindex="-1"></a>  </span>
<span id="cb135-38"><a href="simulace3.html#cb135-38" tabindex="-1"></a>  GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb135-39"><a href="simulace3.html#cb135-39" tabindex="-1"></a>    <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb135-40"><a href="simulace3.html#cb135-40" tabindex="-1"></a>    <span class="at">GCV =</span> gcv</span>
<span id="cb135-41"><a href="simulace3.html#cb135-41" tabindex="-1"></a>  )</span>
<span id="cb135-42"><a href="simulace3.html#cb135-42" tabindex="-1"></a>  </span>
<span id="cb135-43"><a href="simulace3.html#cb135-43" tabindex="-1"></a>  <span class="co"># find the value of the minimum</span></span>
<span id="cb135-44"><a href="simulace3.html#cb135-44" tabindex="-1"></a>  lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb135-45"><a href="simulace3.html#cb135-45" tabindex="-1"></a>  </span>
<span id="cb135-46"><a href="simulace3.html#cb135-46" tabindex="-1"></a>  curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb135-47"><a href="simulace3.html#cb135-47" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb135-48"><a href="simulace3.html#cb135-48" tabindex="-1"></a>  XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb135-49"><a href="simulace3.html#cb135-49" tabindex="-1"></a>  </span>
<span id="cb135-50"><a href="simulace3.html#cb135-50" tabindex="-1"></a>  fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb135-51"><a href="simulace3.html#cb135-51" tabindex="-1"></a>  </span>
<span id="cb135-52"><a href="simulace3.html#cb135-52" tabindex="-1"></a>  <span class="co"># splitting into test and training sets</span></span>
<span id="cb135-53"><a href="simulace3.html#cb135-53" tabindex="-1"></a>  split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb135-54"><a href="simulace3.html#cb135-54" tabindex="-1"></a>  </span>
<span id="cb135-55"><a href="simulace3.html#cb135-55" tabindex="-1"></a>  Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb135-56"><a href="simulace3.html#cb135-56" tabindex="-1"></a>  </span>
<span id="cb135-57"><a href="simulace3.html#cb135-57" tabindex="-1"></a>  X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-58"><a href="simulace3.html#cb135-58" tabindex="-1"></a>  X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-59"><a href="simulace3.html#cb135-59" tabindex="-1"></a>  </span>
<span id="cb135-60"><a href="simulace3.html#cb135-60" tabindex="-1"></a>  Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-61"><a href="simulace3.html#cb135-61" tabindex="-1"></a>  Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-62"><a href="simulace3.html#cb135-62" tabindex="-1"></a>  </span>
<span id="cb135-63"><a href="simulace3.html#cb135-63" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb135-64"><a href="simulace3.html#cb135-64" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb135-65"><a href="simulace3.html#cb135-65" tabindex="-1"></a>  </span>
<span id="cb135-66"><a href="simulace3.html#cb135-66" tabindex="-1"></a>  <span class="do">## 1) K nejbližších sousedů</span></span>
<span id="cb135-67"><a href="simulace3.html#cb135-67" tabindex="-1"></a>  </span>
<span id="cb135-68"><a href="simulace3.html#cb135-68" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb135-69"><a href="simulace3.html#cb135-69" tabindex="-1"></a>  neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># pocet sousedu </span></span>
<span id="cb135-70"><a href="simulace3.html#cb135-70" tabindex="-1"></a>  </span>
<span id="cb135-71"><a href="simulace3.html#cb135-71" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-72"><a href="simulace3.html#cb135-72" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-73"><a href="simulace3.html#cb135-73" tabindex="-1"></a>  </span>
<span id="cb135-74"><a href="simulace3.html#cb135-74" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb135-75"><a href="simulace3.html#cb135-75" tabindex="-1"></a>  </span>
<span id="cb135-76"><a href="simulace3.html#cb135-76" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-77"><a href="simulace3.html#cb135-77" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb135-78"><a href="simulace3.html#cb135-78" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb135-79"><a href="simulace3.html#cb135-79" tabindex="-1"></a>      </span>
<span id="cb135-80"><a href="simulace3.html#cb135-80" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-81"><a href="simulace3.html#cb135-81" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb135-82"><a href="simulace3.html#cb135-82" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-83"><a href="simulace3.html#cb135-83" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb135-84"><a href="simulace3.html#cb135-84" tabindex="-1"></a>    </span>
<span id="cb135-85"><a href="simulace3.html#cb135-85" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-86"><a href="simulace3.html#cb135-86" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb135-87"><a href="simulace3.html#cb135-87" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-88"><a href="simulace3.html#cb135-88" tabindex="-1"></a>      <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb135-89"><a href="simulace3.html#cb135-89" tabindex="-1"></a>    </span>
<span id="cb135-90"><a href="simulace3.html#cb135-90" tabindex="-1"></a>    <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb135-91"><a href="simulace3.html#cb135-91" tabindex="-1"></a>    <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb135-92"><a href="simulace3.html#cb135-92" tabindex="-1"></a>      <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb135-93"><a href="simulace3.html#cb135-93" tabindex="-1"></a>      neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb135-94"><a href="simulace3.html#cb135-94" tabindex="-1"></a>                                <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb135-95"><a href="simulace3.html#cb135-95" tabindex="-1"></a>                                <span class="at">knn =</span> neighbour) </span>
<span id="cb135-96"><a href="simulace3.html#cb135-96" tabindex="-1"></a>      <span class="co"># predikce na validacni casti</span></span>
<span id="cb135-97"><a href="simulace3.html#cb135-97" tabindex="-1"></a>      model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb135-98"><a href="simulace3.html#cb135-98" tabindex="-1"></a>                                      <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb135-99"><a href="simulace3.html#cb135-99" tabindex="-1"></a>      <span class="co"># presnost na validacni casti</span></span>
<span id="cb135-100"><a href="simulace3.html#cb135-100" tabindex="-1"></a>      presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb135-101"><a href="simulace3.html#cb135-101" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-102"><a href="simulace3.html#cb135-102" tabindex="-1"></a>      </span>
<span id="cb135-103"><a href="simulace3.html#cb135-103" tabindex="-1"></a>      <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb135-104"><a href="simulace3.html#cb135-104" tabindex="-1"></a>      CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb135-105"><a href="simulace3.html#cb135-105" tabindex="-1"></a>    }</span>
<span id="cb135-106"><a href="simulace3.html#cb135-106" tabindex="-1"></a>  }</span>
<span id="cb135-107"><a href="simulace3.html#cb135-107" tabindex="-1"></a>  </span>
<span id="cb135-108"><a href="simulace3.html#cb135-108" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb135-109"><a href="simulace3.html#cb135-109" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb135-110"><a href="simulace3.html#cb135-110" tabindex="-1"></a>  K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb135-111"><a href="simulace3.html#cb135-111" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb135-112"><a href="simulace3.html#cb135-112" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb135-113"><a href="simulace3.html#cb135-113" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb135-114"><a href="simulace3.html#cb135-114" tabindex="-1"></a>  </span>
<span id="cb135-115"><a href="simulace3.html#cb135-115" tabindex="-1"></a>  neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb135-116"><a href="simulace3.html#cb135-116" tabindex="-1"></a>  </span>
<span id="cb135-117"><a href="simulace3.html#cb135-117" tabindex="-1"></a>  <span class="co"># predikce</span></span>
<span id="cb135-118"><a href="simulace3.html#cb135-118" tabindex="-1"></a>  model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb135-119"><a href="simulace3.html#cb135-119" tabindex="-1"></a>                                  <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb135-120"><a href="simulace3.html#cb135-120" tabindex="-1"></a>  </span>
<span id="cb135-121"><a href="simulace3.html#cb135-121" tabindex="-1"></a>  presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb135-122"><a href="simulace3.html#cb135-122" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb135-123"><a href="simulace3.html#cb135-123" tabindex="-1"></a>    <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb135-124"><a href="simulace3.html#cb135-124" tabindex="-1"></a>    <span class="fu">sum</span>()</span>
<span id="cb135-125"><a href="simulace3.html#cb135-125" tabindex="-1"></a>  </span>
<span id="cb135-126"><a href="simulace3.html#cb135-126" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb135-127"><a href="simulace3.html#cb135-127" tabindex="-1"></a>                        <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb135-128"><a href="simulace3.html#cb135-128" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb135-129"><a href="simulace3.html#cb135-129" tabindex="-1"></a>  </span>
<span id="cb135-130"><a href="simulace3.html#cb135-130" tabindex="-1"></a>  <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb135-131"><a href="simulace3.html#cb135-131" tabindex="-1"></a>  </span>
<span id="cb135-132"><a href="simulace3.html#cb135-132" tabindex="-1"></a>  <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb135-133"><a href="simulace3.html#cb135-133" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb135-134"><a href="simulace3.html#cb135-134" tabindex="-1"></a>  nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb135-135"><a href="simulace3.html#cb135-135" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb135-136"><a href="simulace3.html#cb135-136" tabindex="-1"></a>  <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb135-137"><a href="simulace3.html#cb135-137" tabindex="-1"></a>  </span>
<span id="cb135-138"><a href="simulace3.html#cb135-138" tabindex="-1"></a>  data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb135-139"><a href="simulace3.html#cb135-139" tabindex="-1"></a>  data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb135-140"><a href="simulace3.html#cb135-140" tabindex="-1"></a>  data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb135-141"><a href="simulace3.html#cb135-141" tabindex="-1"></a>  </span>
<span id="cb135-142"><a href="simulace3.html#cb135-142" tabindex="-1"></a>  <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb135-143"><a href="simulace3.html#cb135-143" tabindex="-1"></a>  scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb135-144"><a href="simulace3.html#cb135-144" tabindex="-1"></a>  </span>
<span id="cb135-145"><a href="simulace3.html#cb135-145" tabindex="-1"></a>  <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb135-146"><a href="simulace3.html#cb135-146" tabindex="-1"></a>    xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb135-147"><a href="simulace3.html#cb135-147" tabindex="-1"></a>    scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb135-148"><a href="simulace3.html#cb135-148" tabindex="-1"></a>    <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb135-149"><a href="simulace3.html#cb135-149" tabindex="-1"></a>  }</span>
<span id="cb135-150"><a href="simulace3.html#cb135-150" tabindex="-1"></a>  </span>
<span id="cb135-151"><a href="simulace3.html#cb135-151" tabindex="-1"></a>  data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb135-152"><a href="simulace3.html#cb135-152" tabindex="-1"></a>  data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-153"><a href="simulace3.html#cb135-153" tabindex="-1"></a>  <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb135-154"><a href="simulace3.html#cb135-154" tabindex="-1"></a>  </span>
<span id="cb135-155"><a href="simulace3.html#cb135-155" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb135-156"><a href="simulace3.html#cb135-156" tabindex="-1"></a>  clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb135-157"><a href="simulace3.html#cb135-157" tabindex="-1"></a>  </span>
<span id="cb135-158"><a href="simulace3.html#cb135-158" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-159"><a href="simulace3.html#cb135-159" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-160"><a href="simulace3.html#cb135-160" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb135-161"><a href="simulace3.html#cb135-161" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-162"><a href="simulace3.html#cb135-162" tabindex="-1"></a>    </span>
<span id="cb135-163"><a href="simulace3.html#cb135-163" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-164"><a href="simulace3.html#cb135-164" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-165"><a href="simulace3.html#cb135-165" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb135-166"><a href="simulace3.html#cb135-166" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-167"><a href="simulace3.html#cb135-167" tabindex="-1"></a>  </span>
<span id="cb135-168"><a href="simulace3.html#cb135-168" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb135-169"><a href="simulace3.html#cb135-169" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-170"><a href="simulace3.html#cb135-170" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-171"><a href="simulace3.html#cb135-171" tabindex="-1"></a>  </span>
<span id="cb135-172"><a href="simulace3.html#cb135-172" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-173"><a href="simulace3.html#cb135-173" tabindex="-1"></a>  </span>
<span id="cb135-174"><a href="simulace3.html#cb135-174" tabindex="-1"></a>  <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb135-175"><a href="simulace3.html#cb135-175" tabindex="-1"></a>  </span>
<span id="cb135-176"><a href="simulace3.html#cb135-176" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb135-177"><a href="simulace3.html#cb135-177" tabindex="-1"></a>  clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb135-178"><a href="simulace3.html#cb135-178" tabindex="-1"></a>  </span>
<span id="cb135-179"><a href="simulace3.html#cb135-179" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-180"><a href="simulace3.html#cb135-180" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-181"><a href="simulace3.html#cb135-181" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb135-182"><a href="simulace3.html#cb135-182" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-183"><a href="simulace3.html#cb135-183" tabindex="-1"></a>    </span>
<span id="cb135-184"><a href="simulace3.html#cb135-184" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-185"><a href="simulace3.html#cb135-185" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-186"><a href="simulace3.html#cb135-186" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb135-187"><a href="simulace3.html#cb135-187" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-188"><a href="simulace3.html#cb135-188" tabindex="-1"></a>  </span>
<span id="cb135-189"><a href="simulace3.html#cb135-189" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb135-190"><a href="simulace3.html#cb135-190" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-191"><a href="simulace3.html#cb135-191" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-192"><a href="simulace3.html#cb135-192" tabindex="-1"></a>  </span>
<span id="cb135-193"><a href="simulace3.html#cb135-193" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-194"><a href="simulace3.html#cb135-194" tabindex="-1"></a>  </span>
<span id="cb135-195"><a href="simulace3.html#cb135-195" tabindex="-1"></a>  <span class="do">## 4) Logistická regrese</span></span>
<span id="cb135-196"><a href="simulace3.html#cb135-196" tabindex="-1"></a>  <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb135-197"><a href="simulace3.html#cb135-197" tabindex="-1"></a>  </span>
<span id="cb135-198"><a href="simulace3.html#cb135-198" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb135-199"><a href="simulace3.html#cb135-199" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb135-200"><a href="simulace3.html#cb135-200" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb135-201"><a href="simulace3.html#cb135-201" tabindex="-1"></a>  </span>
<span id="cb135-202"><a href="simulace3.html#cb135-202" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb135-203"><a href="simulace3.html#cb135-203" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb135-204"><a href="simulace3.html#cb135-204" tabindex="-1"></a>  </span>
<span id="cb135-205"><a href="simulace3.html#cb135-205" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb135-206"><a href="simulace3.html#cb135-206" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb135-207"><a href="simulace3.html#cb135-207" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb135-208"><a href="simulace3.html#cb135-208" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb135-209"><a href="simulace3.html#cb135-209" tabindex="-1"></a>  </span>
<span id="cb135-210"><a href="simulace3.html#cb135-210" tabindex="-1"></a>  <span class="do">### 10-fold cross-validation</span></span>
<span id="cb135-211"><a href="simulace3.html#cb135-211" tabindex="-1"></a>  n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb135-212"><a href="simulace3.html#cb135-212" tabindex="-1"></a>  n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb135-213"><a href="simulace3.html#cb135-213" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb135-214"><a href="simulace3.html#cb135-214" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-215"><a href="simulace3.html#cb135-215" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-216"><a href="simulace3.html#cb135-216" tabindex="-1"></a>  <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb135-217"><a href="simulace3.html#cb135-217" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb135-218"><a href="simulace3.html#cb135-218" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb135-219"><a href="simulace3.html#cb135-219" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb135-220"><a href="simulace3.html#cb135-220" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb135-221"><a href="simulace3.html#cb135-221" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb135-222"><a href="simulace3.html#cb135-222" tabindex="-1"></a>  <span class="co"># vztah</span></span>
<span id="cb135-223"><a href="simulace3.html#cb135-223" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb135-224"><a href="simulace3.html#cb135-224" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb135-225"><a href="simulace3.html#cb135-225" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb135-226"><a href="simulace3.html#cb135-226" tabindex="-1"></a>  </span>
<span id="cb135-227"><a href="simulace3.html#cb135-227" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb135-228"><a href="simulace3.html#cb135-228" tabindex="-1"></a>                       <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb135-229"><a href="simulace3.html#cb135-229" tabindex="-1"></a>  </span>
<span id="cb135-230"><a href="simulace3.html#cb135-230" tabindex="-1"></a>  <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-231"><a href="simulace3.html#cb135-231" tabindex="-1"></a>    <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb135-232"><a href="simulace3.html#cb135-232" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb135-233"><a href="simulace3.html#cb135-233" tabindex="-1"></a>      </span>
<span id="cb135-234"><a href="simulace3.html#cb135-234" tabindex="-1"></a>    x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-235"><a href="simulace3.html#cb135-235" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb135-236"><a href="simulace3.html#cb135-236" tabindex="-1"></a>    y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-237"><a href="simulace3.html#cb135-237" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb135-238"><a href="simulace3.html#cb135-238" tabindex="-1"></a>    </span>
<span id="cb135-239"><a href="simulace3.html#cb135-239" tabindex="-1"></a>    x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-240"><a href="simulace3.html#cb135-240" tabindex="-1"></a>      <span class="fu">fdata</span>()</span>
<span id="cb135-241"><a href="simulace3.html#cb135-241" tabindex="-1"></a>    y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb135-242"><a href="simulace3.html#cb135-242" tabindex="-1"></a>      <span class="fu">as.numeric</span>()</span>
<span id="cb135-243"><a href="simulace3.html#cb135-243" tabindex="-1"></a>    </span>
<span id="cb135-244"><a href="simulace3.html#cb135-244" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb135-245"><a href="simulace3.html#cb135-245" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb135-246"><a href="simulace3.html#cb135-246" tabindex="-1"></a>    </span>
<span id="cb135-247"><a href="simulace3.html#cb135-247" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb135-248"><a href="simulace3.html#cb135-248" tabindex="-1"></a>      <span class="co"># baze pro bety</span></span>
<span id="cb135-249"><a href="simulace3.html#cb135-249" tabindex="-1"></a>      basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb135-250"><a href="simulace3.html#cb135-250" tabindex="-1"></a>      </span>
<span id="cb135-251"><a href="simulace3.html#cb135-251" tabindex="-1"></a>      basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb135-252"><a href="simulace3.html#cb135-252" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb135-253"><a href="simulace3.html#cb135-253" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb135-254"><a href="simulace3.html#cb135-254" tabindex="-1"></a>      <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb135-255"><a href="simulace3.html#cb135-255" tabindex="-1"></a>      model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb135-256"><a href="simulace3.html#cb135-256" tabindex="-1"></a>                              <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb135-257"><a href="simulace3.html#cb135-257" tabindex="-1"></a>      </span>
<span id="cb135-258"><a href="simulace3.html#cb135-258" tabindex="-1"></a>      <span class="co"># presnost na validacni casti </span></span>
<span id="cb135-259"><a href="simulace3.html#cb135-259" tabindex="-1"></a>      newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb135-260"><a href="simulace3.html#cb135-260" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb135-261"><a href="simulace3.html#cb135-261" tabindex="-1"></a>      predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb135-262"><a href="simulace3.html#cb135-262" tabindex="-1"></a>      presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb135-263"><a href="simulace3.html#cb135-263" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-264"><a href="simulace3.html#cb135-264" tabindex="-1"></a>      </span>
<span id="cb135-265"><a href="simulace3.html#cb135-265" tabindex="-1"></a>      <span class="co"># vlozime do matice</span></span>
<span id="cb135-266"><a href="simulace3.html#cb135-266" tabindex="-1"></a>      CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb135-267"><a href="simulace3.html#cb135-267" tabindex="-1"></a>    } </span>
<span id="cb135-268"><a href="simulace3.html#cb135-268" tabindex="-1"></a>  }</span>
<span id="cb135-269"><a href="simulace3.html#cb135-269" tabindex="-1"></a>  </span>
<span id="cb135-270"><a href="simulace3.html#cb135-270" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb135-271"><a href="simulace3.html#cb135-271" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb135-272"><a href="simulace3.html#cb135-272" tabindex="-1"></a>  n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb135-273"><a href="simulace3.html#cb135-273" tabindex="-1"></a>  CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb135-274"><a href="simulace3.html#cb135-274" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb135-275"><a href="simulace3.html#cb135-275" tabindex="-1"></a>  </span>
<span id="cb135-276"><a href="simulace3.html#cb135-276" tabindex="-1"></a>  <span class="co"># optimalni model</span></span>
<span id="cb135-277"><a href="simulace3.html#cb135-277" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb135-278"><a href="simulace3.html#cb135-278" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb135-279"><a href="simulace3.html#cb135-279" tabindex="-1"></a>  <span class="co"># baze pro x a bety</span></span>
<span id="cb135-280"><a href="simulace3.html#cb135-280" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb135-281"><a href="simulace3.html#cb135-281" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb135-282"><a href="simulace3.html#cb135-282" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb135-283"><a href="simulace3.html#cb135-283" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb135-284"><a href="simulace3.html#cb135-284" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb135-285"><a href="simulace3.html#cb135-285" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb135-286"><a href="simulace3.html#cb135-286" tabindex="-1"></a>  <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb135-287"><a href="simulace3.html#cb135-287" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb135-288"><a href="simulace3.html#cb135-288" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb135-289"><a href="simulace3.html#cb135-289" tabindex="-1"></a>  </span>
<span id="cb135-290"><a href="simulace3.html#cb135-290" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-291"><a href="simulace3.html#cb135-291" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb135-292"><a href="simulace3.html#cb135-292" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb135-293"><a href="simulace3.html#cb135-293" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb135-294"><a href="simulace3.html#cb135-294" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-295"><a href="simulace3.html#cb135-295" tabindex="-1"></a>    </span>
<span id="cb135-296"><a href="simulace3.html#cb135-296" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-297"><a href="simulace3.html#cb135-297" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb135-298"><a href="simulace3.html#cb135-298" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb135-299"><a href="simulace3.html#cb135-299" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb135-300"><a href="simulace3.html#cb135-300" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb135-301"><a href="simulace3.html#cb135-301" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-302"><a href="simulace3.html#cb135-302" tabindex="-1"></a>  </span>
<span id="cb135-303"><a href="simulace3.html#cb135-303" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb135-304"><a href="simulace3.html#cb135-304" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-305"><a href="simulace3.html#cb135-305" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-306"><a href="simulace3.html#cb135-306" tabindex="-1"></a>  </span>
<span id="cb135-307"><a href="simulace3.html#cb135-307" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-308"><a href="simulace3.html#cb135-308" tabindex="-1"></a>  </span>
<span id="cb135-309"><a href="simulace3.html#cb135-309" tabindex="-1"></a>  <span class="do">### 4.2) Logistická regrese s analýzou hlavních komponent</span></span>
<span id="cb135-310"><a href="simulace3.html#cb135-310" tabindex="-1"></a>  </span>
<span id="cb135-311"><a href="simulace3.html#cb135-311" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb135-312"><a href="simulace3.html#cb135-312" tabindex="-1"></a>  clf.LR <span class="ot">&lt;-</span> <span class="fu">glm</span>(Y <span class="sc">~</span>  ., <span class="at">data =</span> data.PCA.train, <span class="at">family =</span> binomial)</span>
<span id="cb135-313"><a href="simulace3.html#cb135-313" tabindex="-1"></a>  </span>
<span id="cb135-314"><a href="simulace3.html#cb135-314" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-315"><a href="simulace3.html#cb135-315" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.train, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb135-316"><a href="simulace3.html#cb135-316" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb135-317"><a href="simulace3.html#cb135-317" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-318"><a href="simulace3.html#cb135-318" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-319"><a href="simulace3.html#cb135-319" tabindex="-1"></a>    </span>
<span id="cb135-320"><a href="simulace3.html#cb135-320" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-321"><a href="simulace3.html#cb135-321" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LR, <span class="at">newdata =</span> data.PCA.test, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)</span>
<span id="cb135-322"><a href="simulace3.html#cb135-322" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&gt;</span> <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb135-323"><a href="simulace3.html#cb135-323" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-324"><a href="simulace3.html#cb135-324" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-325"><a href="simulace3.html#cb135-325" tabindex="-1"></a>  </span>
<span id="cb135-326"><a href="simulace3.html#cb135-326" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_score&#39;</span>, </span>
<span id="cb135-327"><a href="simulace3.html#cb135-327" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-328"><a href="simulace3.html#cb135-328" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-329"><a href="simulace3.html#cb135-329" tabindex="-1"></a>  </span>
<span id="cb135-330"><a href="simulace3.html#cb135-330" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-331"><a href="simulace3.html#cb135-331" tabindex="-1"></a>  </span>
<span id="cb135-332"><a href="simulace3.html#cb135-332" tabindex="-1"></a>  <span class="do">## 5) Rozhodovací stromy</span></span>
<span id="cb135-333"><a href="simulace3.html#cb135-333" tabindex="-1"></a>  <span class="do">### 5.1) Diskretizace intervalu</span></span>
<span id="cb135-334"><a href="simulace3.html#cb135-334" tabindex="-1"></a>  </span>
<span id="cb135-335"><a href="simulace3.html#cb135-335" tabindex="-1"></a>  <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb135-336"><a href="simulace3.html#cb135-336" tabindex="-1"></a>  t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb135-337"><a href="simulace3.html#cb135-337" tabindex="-1"></a>     </span>
<span id="cb135-338"><a href="simulace3.html#cb135-338" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb135-339"><a href="simulace3.html#cb135-339" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb135-340"><a href="simulace3.html#cb135-340" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb135-341"><a href="simulace3.html#cb135-341" tabindex="-1"></a>  </span>
<span id="cb135-342"><a href="simulace3.html#cb135-342" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb135-343"><a href="simulace3.html#cb135-343" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb135-344"><a href="simulace3.html#cb135-344" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb135-345"><a href="simulace3.html#cb135-345" tabindex="-1"></a>  </span>
<span id="cb135-346"><a href="simulace3.html#cb135-346" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-347"><a href="simulace3.html#cb135-347" tabindex="-1"></a>  clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb135-348"><a href="simulace3.html#cb135-348" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb135-349"><a href="simulace3.html#cb135-349" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb135-350"><a href="simulace3.html#cb135-350" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb135-351"><a href="simulace3.html#cb135-351" tabindex="-1"></a>  </span>
<span id="cb135-352"><a href="simulace3.html#cb135-352" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-353"><a href="simulace3.html#cb135-353" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb135-354"><a href="simulace3.html#cb135-354" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-355"><a href="simulace3.html#cb135-355" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-356"><a href="simulace3.html#cb135-356" tabindex="-1"></a>    </span>
<span id="cb135-357"><a href="simulace3.html#cb135-357" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-358"><a href="simulace3.html#cb135-358" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb135-359"><a href="simulace3.html#cb135-359" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-360"><a href="simulace3.html#cb135-360" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-361"><a href="simulace3.html#cb135-361" tabindex="-1"></a>  </span>
<span id="cb135-362"><a href="simulace3.html#cb135-362" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_discr&#39;</span>, </span>
<span id="cb135-363"><a href="simulace3.html#cb135-363" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-364"><a href="simulace3.html#cb135-364" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-365"><a href="simulace3.html#cb135-365" tabindex="-1"></a>  </span>
<span id="cb135-366"><a href="simulace3.html#cb135-366" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-367"><a href="simulace3.html#cb135-367" tabindex="-1"></a>  </span>
<span id="cb135-368"><a href="simulace3.html#cb135-368" tabindex="-1"></a>  <span class="do">### 5.2) Skóre hlavních komponent</span></span>
<span id="cb135-369"><a href="simulace3.html#cb135-369" tabindex="-1"></a>  </span>
<span id="cb135-370"><a href="simulace3.html#cb135-370" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-371"><a href="simulace3.html#cb135-371" tabindex="-1"></a>  clf.tree.PCA <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb135-372"><a href="simulace3.html#cb135-372" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb135-373"><a href="simulace3.html#cb135-373" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb135-374"><a href="simulace3.html#cb135-374" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb135-375"><a href="simulace3.html#cb135-375" tabindex="-1"></a>  </span>
<span id="cb135-376"><a href="simulace3.html#cb135-376" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-377"><a href="simulace3.html#cb135-377" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-378"><a href="simulace3.html#cb135-378" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-379"><a href="simulace3.html#cb135-379" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-380"><a href="simulace3.html#cb135-380" tabindex="-1"></a>    </span>
<span id="cb135-381"><a href="simulace3.html#cb135-381" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-382"><a href="simulace3.html#cb135-382" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-383"><a href="simulace3.html#cb135-383" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-384"><a href="simulace3.html#cb135-384" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-385"><a href="simulace3.html#cb135-385" tabindex="-1"></a>  </span>
<span id="cb135-386"><a href="simulace3.html#cb135-386" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_score&#39;</span>, </span>
<span id="cb135-387"><a href="simulace3.html#cb135-387" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-388"><a href="simulace3.html#cb135-388" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-389"><a href="simulace3.html#cb135-389" tabindex="-1"></a>  </span>
<span id="cb135-390"><a href="simulace3.html#cb135-390" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-391"><a href="simulace3.html#cb135-391" tabindex="-1"></a>  </span>
<span id="cb135-392"><a href="simulace3.html#cb135-392" tabindex="-1"></a>  <span class="do">### 5.3) Bázové koeficienty</span></span>
<span id="cb135-393"><a href="simulace3.html#cb135-393" tabindex="-1"></a>  </span>
<span id="cb135-394"><a href="simulace3.html#cb135-394" tabindex="-1"></a>  <span class="co"># trenovaci dataset</span></span>
<span id="cb135-395"><a href="simulace3.html#cb135-395" tabindex="-1"></a>  data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb135-396"><a href="simulace3.html#cb135-396" tabindex="-1"></a>  data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb135-397"><a href="simulace3.html#cb135-397" tabindex="-1"></a>  </span>
<span id="cb135-398"><a href="simulace3.html#cb135-398" tabindex="-1"></a>  <span class="co"># testovaci dataset</span></span>
<span id="cb135-399"><a href="simulace3.html#cb135-399" tabindex="-1"></a>  data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb135-400"><a href="simulace3.html#cb135-400" tabindex="-1"></a>  data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-401"><a href="simulace3.html#cb135-401" tabindex="-1"></a>  </span>
<span id="cb135-402"><a href="simulace3.html#cb135-402" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-403"><a href="simulace3.html#cb135-403" tabindex="-1"></a>  clf.tree.Bbasis <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb135-404"><a href="simulace3.html#cb135-404" tabindex="-1"></a>                   <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb135-405"><a href="simulace3.html#cb135-405" tabindex="-1"></a>                   <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb135-406"><a href="simulace3.html#cb135-406" tabindex="-1"></a>                   <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb135-407"><a href="simulace3.html#cb135-407" tabindex="-1"></a>  </span>
<span id="cb135-408"><a href="simulace3.html#cb135-408" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-409"><a href="simulace3.html#cb135-409" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb135-410"><a href="simulace3.html#cb135-410" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-411"><a href="simulace3.html#cb135-411" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-412"><a href="simulace3.html#cb135-412" tabindex="-1"></a>    </span>
<span id="cb135-413"><a href="simulace3.html#cb135-413" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-414"><a href="simulace3.html#cb135-414" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb135-415"><a href="simulace3.html#cb135-415" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-416"><a href="simulace3.html#cb135-416" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-417"><a href="simulace3.html#cb135-417" tabindex="-1"></a>  </span>
<span id="cb135-418"><a href="simulace3.html#cb135-418" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree_Bbasis&#39;</span>, </span>
<span id="cb135-419"><a href="simulace3.html#cb135-419" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-420"><a href="simulace3.html#cb135-420" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-421"><a href="simulace3.html#cb135-421" tabindex="-1"></a>  </span>
<span id="cb135-422"><a href="simulace3.html#cb135-422" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-423"><a href="simulace3.html#cb135-423" tabindex="-1"></a>  </span>
<span id="cb135-424"><a href="simulace3.html#cb135-424" tabindex="-1"></a>  <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb135-425"><a href="simulace3.html#cb135-425" tabindex="-1"></a>  </span>
<span id="cb135-426"><a href="simulace3.html#cb135-426" tabindex="-1"></a>  <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb135-427"><a href="simulace3.html#cb135-427" tabindex="-1"></a>  </span>
<span id="cb135-428"><a href="simulace3.html#cb135-428" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-429"><a href="simulace3.html#cb135-429" tabindex="-1"></a>  clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb135-430"><a href="simulace3.html#cb135-430" tabindex="-1"></a>                         <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb135-431"><a href="simulace3.html#cb135-431" tabindex="-1"></a>                         <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-432"><a href="simulace3.html#cb135-432" tabindex="-1"></a>                         <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb135-433"><a href="simulace3.html#cb135-433" tabindex="-1"></a>  </span>
<span id="cb135-434"><a href="simulace3.html#cb135-434" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-435"><a href="simulace3.html#cb135-435" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb135-436"><a href="simulace3.html#cb135-436" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-437"><a href="simulace3.html#cb135-437" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-438"><a href="simulace3.html#cb135-438" tabindex="-1"></a>    </span>
<span id="cb135-439"><a href="simulace3.html#cb135-439" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-440"><a href="simulace3.html#cb135-440" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb135-441"><a href="simulace3.html#cb135-441" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-442"><a href="simulace3.html#cb135-442" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-443"><a href="simulace3.html#cb135-443" tabindex="-1"></a>  </span>
<span id="cb135-444"><a href="simulace3.html#cb135-444" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb135-445"><a href="simulace3.html#cb135-445" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-446"><a href="simulace3.html#cb135-446" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-447"><a href="simulace3.html#cb135-447" tabindex="-1"></a>  </span>
<span id="cb135-448"><a href="simulace3.html#cb135-448" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-449"><a href="simulace3.html#cb135-449" tabindex="-1"></a>  </span>
<span id="cb135-450"><a href="simulace3.html#cb135-450" tabindex="-1"></a>  <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb135-451"><a href="simulace3.html#cb135-451" tabindex="-1"></a>  </span>
<span id="cb135-452"><a href="simulace3.html#cb135-452" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-453"><a href="simulace3.html#cb135-453" tabindex="-1"></a>  clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb135-454"><a href="simulace3.html#cb135-454" tabindex="-1"></a>                             <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb135-455"><a href="simulace3.html#cb135-455" tabindex="-1"></a>                             <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-456"><a href="simulace3.html#cb135-456" tabindex="-1"></a>                             <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb135-457"><a href="simulace3.html#cb135-457" tabindex="-1"></a>  </span>
<span id="cb135-458"><a href="simulace3.html#cb135-458" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-459"><a href="simulace3.html#cb135-459" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-460"><a href="simulace3.html#cb135-460" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-461"><a href="simulace3.html#cb135-461" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-462"><a href="simulace3.html#cb135-462" tabindex="-1"></a>    </span>
<span id="cb135-463"><a href="simulace3.html#cb135-463" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-464"><a href="simulace3.html#cb135-464" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-465"><a href="simulace3.html#cb135-465" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-466"><a href="simulace3.html#cb135-466" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-467"><a href="simulace3.html#cb135-467" tabindex="-1"></a>  </span>
<span id="cb135-468"><a href="simulace3.html#cb135-468" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb135-469"><a href="simulace3.html#cb135-469" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-470"><a href="simulace3.html#cb135-470" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-471"><a href="simulace3.html#cb135-471" tabindex="-1"></a>  </span>
<span id="cb135-472"><a href="simulace3.html#cb135-472" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-473"><a href="simulace3.html#cb135-473" tabindex="-1"></a>  </span>
<span id="cb135-474"><a href="simulace3.html#cb135-474" tabindex="-1"></a>  <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb135-475"><a href="simulace3.html#cb135-475" tabindex="-1"></a>  </span>
<span id="cb135-476"><a href="simulace3.html#cb135-476" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-477"><a href="simulace3.html#cb135-477" tabindex="-1"></a>  clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb135-478"><a href="simulace3.html#cb135-478" tabindex="-1"></a>                                <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb135-479"><a href="simulace3.html#cb135-479" tabindex="-1"></a>                                <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-480"><a href="simulace3.html#cb135-480" tabindex="-1"></a>                                <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb135-481"><a href="simulace3.html#cb135-481" tabindex="-1"></a>  </span>
<span id="cb135-482"><a href="simulace3.html#cb135-482" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-483"><a href="simulace3.html#cb135-483" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb135-484"><a href="simulace3.html#cb135-484" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-485"><a href="simulace3.html#cb135-485" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-486"><a href="simulace3.html#cb135-486" tabindex="-1"></a>    </span>
<span id="cb135-487"><a href="simulace3.html#cb135-487" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-488"><a href="simulace3.html#cb135-488" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb135-489"><a href="simulace3.html#cb135-489" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-490"><a href="simulace3.html#cb135-490" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-491"><a href="simulace3.html#cb135-491" tabindex="-1"></a>  </span>
<span id="cb135-492"><a href="simulace3.html#cb135-492" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb135-493"><a href="simulace3.html#cb135-493" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb135-494"><a href="simulace3.html#cb135-494" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb135-495"><a href="simulace3.html#cb135-495" tabindex="-1"></a>  </span>
<span id="cb135-496"><a href="simulace3.html#cb135-496" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-497"><a href="simulace3.html#cb135-497" tabindex="-1"></a>  </span>
<span id="cb135-498"><a href="simulace3.html#cb135-498" tabindex="-1"></a>  <span class="do">## 7) SVM</span></span>
<span id="cb135-499"><a href="simulace3.html#cb135-499" tabindex="-1"></a>  </span>
<span id="cb135-500"><a href="simulace3.html#cb135-500" tabindex="-1"></a>  <span class="co"># normovani dat</span></span>
<span id="cb135-501"><a href="simulace3.html#cb135-501" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb135-502"><a href="simulace3.html#cb135-502" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb135-503"><a href="simulace3.html#cb135-503" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb135-504"><a href="simulace3.html#cb135-504" tabindex="-1"></a>    }</span>
<span id="cb135-505"><a href="simulace3.html#cb135-505" tabindex="-1"></a>  XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb135-506"><a href="simulace3.html#cb135-506" tabindex="-1"></a>  XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb135-507"><a href="simulace3.html#cb135-507" tabindex="-1"></a>                                              <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb135-508"><a href="simulace3.html#cb135-508" tabindex="-1"></a>                                              <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb135-509"><a href="simulace3.html#cb135-509" tabindex="-1"></a>                                              <span class="at">byrow =</span> T)</span>
<span id="cb135-510"><a href="simulace3.html#cb135-510" tabindex="-1"></a>  </span>
<span id="cb135-511"><a href="simulace3.html#cb135-511" tabindex="-1"></a>  <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb135-512"><a href="simulace3.html#cb135-512" tabindex="-1"></a>  X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-513"><a href="simulace3.html#cb135-513" tabindex="-1"></a>  X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-514"><a href="simulace3.html#cb135-514" tabindex="-1"></a>  </span>
<span id="cb135-515"><a href="simulace3.html#cb135-515" tabindex="-1"></a>  Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-516"><a href="simulace3.html#cb135-516" tabindex="-1"></a>  Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-517"><a href="simulace3.html#cb135-517" tabindex="-1"></a>  </span>
<span id="cb135-518"><a href="simulace3.html#cb135-518" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb135-519"><a href="simulace3.html#cb135-519" tabindex="-1"></a>  grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb135-520"><a href="simulace3.html#cb135-520" tabindex="-1"></a>  grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb135-521"><a href="simulace3.html#cb135-521" tabindex="-1"></a>  </span>
<span id="cb135-522"><a href="simulace3.html#cb135-522" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb135-523"><a href="simulace3.html#cb135-523" tabindex="-1"></a>  grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb135-524"><a href="simulace3.html#cb135-524" tabindex="-1"></a>  grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb135-525"><a href="simulace3.html#cb135-525" tabindex="-1"></a>  </span>
<span id="cb135-526"><a href="simulace3.html#cb135-526" tabindex="-1"></a>  k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co">#  k-fold CV</span></span>
<span id="cb135-527"><a href="simulace3.html#cb135-527" tabindex="-1"></a>  </span>
<span id="cb135-528"><a href="simulace3.html#cb135-528" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-529"><a href="simulace3.html#cb135-529" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-530"><a href="simulace3.html#cb135-530" tabindex="-1"></a>  <span class="co"># kontrola, ze mame opravdu k = k_cv</span></span>
<span id="cb135-531"><a href="simulace3.html#cb135-531" tabindex="-1"></a>  <span class="cf">while</span> (<span class="fu">length</span>(folds) <span class="sc">!=</span> k_cv) {</span>
<span id="cb135-532"><a href="simulace3.html#cb135-532" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-533"><a href="simulace3.html#cb135-533" tabindex="-1"></a>  }</span>
<span id="cb135-534"><a href="simulace3.html#cb135-534" tabindex="-1"></a>  </span>
<span id="cb135-535"><a href="simulace3.html#cb135-535" tabindex="-1"></a>  <span class="do">### 7.0) SVM for functional data</span></span>
<span id="cb135-536"><a href="simulace3.html#cb135-536" tabindex="-1"></a>  </span>
<span id="cb135-537"><a href="simulace3.html#cb135-537" tabindex="-1"></a>  <span class="co"># ktere hodnoty gamma chceme uvazovat</span></span>
<span id="cb135-538"><a href="simulace3.html#cb135-538" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="dv">0</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-539"><a href="simulace3.html#cb135-539" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">7</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-540"><a href="simulace3.html#cb135-540" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb135-541"><a href="simulace3.html#cb135-541" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-542"><a href="simulace3.html#cb135-542" tabindex="-1"></a>  </span>
<span id="cb135-543"><a href="simulace3.html#cb135-543" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-544"><a href="simulace3.html#cb135-544" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-545"><a href="simulace3.html#cb135-545" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-546"><a href="simulace3.html#cb135-546" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb135-547"><a href="simulace3.html#cb135-547" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-548"><a href="simulace3.html#cb135-548" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb135-549"><a href="simulace3.html#cb135-549" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb135-550"><a href="simulace3.html#cb135-550" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb135-551"><a href="simulace3.html#cb135-551" tabindex="-1"></a>  )</span>
<span id="cb135-552"><a href="simulace3.html#cb135-552" tabindex="-1"></a>  </span>
<span id="cb135-553"><a href="simulace3.html#cb135-553" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb135-554"><a href="simulace3.html#cb135-554" tabindex="-1"></a>  <span class="cf">for</span> (cost <span class="cf">in</span> C.cv) {</span>
<span id="cb135-555"><a href="simulace3.html#cb135-555" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb135-556"><a href="simulace3.html#cb135-556" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-557"><a href="simulace3.html#cb135-557" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-558"><a href="simulace3.html#cb135-558" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-559"><a href="simulace3.html#cb135-559" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(X.train_norm<span class="sc">$</span>coefs)[<span class="dv">2</span>] <span class="sc">%in%</span> fold</span>
<span id="cb135-560"><a href="simulace3.html#cb135-560" tabindex="-1"></a>      </span>
<span id="cb135-561"><a href="simulace3.html#cb135-561" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, cv_sample))</span>
<span id="cb135-562"><a href="simulace3.html#cb135-562" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">fdata</span>(<span class="fu">subset</span>(X.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb135-563"><a href="simulace3.html#cb135-563" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, cv_sample))</span>
<span id="cb135-564"><a href="simulace3.html#cb135-564" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(<span class="fu">subset</span>(Y.train_norm, <span class="sc">!</span>cv_sample))</span>
<span id="cb135-565"><a href="simulace3.html#cb135-565" tabindex="-1"></a>      </span>
<span id="cb135-566"><a href="simulace3.html#cb135-566" tabindex="-1"></a>      <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb135-567"><a href="simulace3.html#cb135-567" tabindex="-1"></a>      tt <span class="ot">&lt;-</span> x.train.cv[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb135-568"><a href="simulace3.html#cb135-568" tabindex="-1"></a>      </span>
<span id="cb135-569"><a href="simulace3.html#cb135-569" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb135-570"><a href="simulace3.html#cb135-570" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb135-571"><a href="simulace3.html#cb135-571" tabindex="-1"></a>      <span class="co"># B-spline baze </span></span>
<span id="cb135-572"><a href="simulace3.html#cb135-572" tabindex="-1"></a>      basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb135-573"><a href="simulace3.html#cb135-573" tabindex="-1"></a>      <span class="co"># formula</span></span>
<span id="cb135-574"><a href="simulace3.html#cb135-574" tabindex="-1"></a>      f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb135-575"><a href="simulace3.html#cb135-575" tabindex="-1"></a>      <span class="co"># baze pro x</span></span>
<span id="cb135-576"><a href="simulace3.html#cb135-576" tabindex="-1"></a>      basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb135-577"><a href="simulace3.html#cb135-577" tabindex="-1"></a>      <span class="co"># vstupni data do modelu</span></span>
<span id="cb135-578"><a href="simulace3.html#cb135-578" tabindex="-1"></a>      ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb135-579"><a href="simulace3.html#cb135-579" tabindex="-1"></a>      </span>
<span id="cb135-580"><a href="simulace3.html#cb135-580" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb135-581"><a href="simulace3.html#cb135-581" tabindex="-1"></a>      <span class="co"># model SVM</span></span>
<span id="cb135-582"><a href="simulace3.html#cb135-582" tabindex="-1"></a>      clf.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-583"><a href="simulace3.html#cb135-583" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb135-584"><a href="simulace3.html#cb135-584" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-585"><a href="simulace3.html#cb135-585" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb135-586"><a href="simulace3.html#cb135-586" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb135-587"><a href="simulace3.html#cb135-587" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-588"><a href="simulace3.html#cb135-588" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-589"><a href="simulace3.html#cb135-589" tabindex="-1"></a>        </span>
<span id="cb135-590"><a href="simulace3.html#cb135-590" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-591"><a href="simulace3.html#cb135-591" tabindex="-1"></a>      newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb135-592"><a href="simulace3.html#cb135-592" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-593"><a href="simulace3.html#cb135-593" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb135-594"><a href="simulace3.html#cb135-594" tabindex="-1"></a>      </span>
<span id="cb135-595"><a href="simulace3.html#cb135-595" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb135-596"><a href="simulace3.html#cb135-596" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb135-597"><a href="simulace3.html#cb135-597" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb135-598"><a href="simulace3.html#cb135-598" tabindex="-1"></a>      </span>
<span id="cb135-599"><a href="simulace3.html#cb135-599" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb135-600"><a href="simulace3.html#cb135-600" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb135-601"><a href="simulace3.html#cb135-601" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-602"><a href="simulace3.html#cb135-602" tabindex="-1"></a>        clf.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-603"><a href="simulace3.html#cb135-603" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb135-604"><a href="simulace3.html#cb135-604" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-605"><a href="simulace3.html#cb135-605" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb135-606"><a href="simulace3.html#cb135-606" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb135-607"><a href="simulace3.html#cb135-607" tabindex="-1"></a>                  <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-608"><a href="simulace3.html#cb135-608" tabindex="-1"></a>                  <span class="at">degree =</span> p,</span>
<span id="cb135-609"><a href="simulace3.html#cb135-609" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-610"><a href="simulace3.html#cb135-610" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-611"><a href="simulace3.html#cb135-611" tabindex="-1"></a>          </span>
<span id="cb135-612"><a href="simulace3.html#cb135-612" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-613"><a href="simulace3.html#cb135-613" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb135-614"><a href="simulace3.html#cb135-614" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-615"><a href="simulace3.html#cb135-615" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb135-616"><a href="simulace3.html#cb135-616" tabindex="-1"></a>        </span>
<span id="cb135-617"><a href="simulace3.html#cb135-617" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb135-618"><a href="simulace3.html#cb135-618" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb135-619"><a href="simulace3.html#cb135-619" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb135-620"><a href="simulace3.html#cb135-620" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb135-621"><a href="simulace3.html#cb135-621" tabindex="-1"></a>      }</span>
<span id="cb135-622"><a href="simulace3.html#cb135-622" tabindex="-1"></a>          </span>
<span id="cb135-623"><a href="simulace3.html#cb135-623" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb135-624"><a href="simulace3.html#cb135-624" tabindex="-1"></a>      <span class="cf">for</span> (gam.cv <span class="cf">in</span> gamma.cv) {</span>
<span id="cb135-625"><a href="simulace3.html#cb135-625" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-626"><a href="simulace3.html#cb135-626" tabindex="-1"></a>        clf.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-627"><a href="simulace3.html#cb135-627" tabindex="-1"></a>                  <span class="at">data =</span> ldata,</span>
<span id="cb135-628"><a href="simulace3.html#cb135-628" tabindex="-1"></a>                  <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-629"><a href="simulace3.html#cb135-629" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb135-630"><a href="simulace3.html#cb135-630" tabindex="-1"></a>                  <span class="at">cost =</span> cost,</span>
<span id="cb135-631"><a href="simulace3.html#cb135-631" tabindex="-1"></a>                  <span class="at">gamma =</span> gam.cv,</span>
<span id="cb135-632"><a href="simulace3.html#cb135-632" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-633"><a href="simulace3.html#cb135-633" tabindex="-1"></a>                  <span class="at">scale =</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-634"><a href="simulace3.html#cb135-634" tabindex="-1"></a>          </span>
<span id="cb135-635"><a href="simulace3.html#cb135-635" tabindex="-1"></a>        <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-636"><a href="simulace3.html#cb135-636" tabindex="-1"></a>        newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb135-637"><a href="simulace3.html#cb135-637" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-638"><a href="simulace3.html#cb135-638" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(y.test.cv <span class="sc">==</span> predictions.test)</span>
<span id="cb135-639"><a href="simulace3.html#cb135-639" tabindex="-1"></a>        </span>
<span id="cb135-640"><a href="simulace3.html#cb135-640" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb135-641"><a href="simulace3.html#cb135-641" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> cost], </span>
<span id="cb135-642"><a href="simulace3.html#cb135-642" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gam.cv],</span>
<span id="cb135-643"><a href="simulace3.html#cb135-643" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb135-644"><a href="simulace3.html#cb135-644" tabindex="-1"></a>      }</span>
<span id="cb135-645"><a href="simulace3.html#cb135-645" tabindex="-1"></a>    }</span>
<span id="cb135-646"><a href="simulace3.html#cb135-646" tabindex="-1"></a>  }</span>
<span id="cb135-647"><a href="simulace3.html#cb135-647" tabindex="-1"></a>  </span>
<span id="cb135-648"><a href="simulace3.html#cb135-648" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb135-649"><a href="simulace3.html#cb135-649" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb135-650"><a href="simulace3.html#cb135-650" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb135-651"><a href="simulace3.html#cb135-651" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb135-652"><a href="simulace3.html#cb135-652" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-653"><a href="simulace3.html#cb135-653" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb135-654"><a href="simulace3.html#cb135-654" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-655"><a href="simulace3.html#cb135-655" tabindex="-1"></a>  </span>
<span id="cb135-656"><a href="simulace3.html#cb135-656" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-657"><a href="simulace3.html#cb135-657" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb135-658"><a href="simulace3.html#cb135-658" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb135-659"><a href="simulace3.html#cb135-659" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb135-660"><a href="simulace3.html#cb135-660" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb135-661"><a href="simulace3.html#cb135-661" tabindex="-1"></a>  </span>
<span id="cb135-662"><a href="simulace3.html#cb135-662" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-663"><a href="simulace3.html#cb135-663" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-664"><a href="simulace3.html#cb135-664" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb135-665"><a href="simulace3.html#cb135-665" tabindex="-1"></a>  </span>
<span id="cb135-666"><a href="simulace3.html#cb135-666" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-667"><a href="simulace3.html#cb135-667" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-668"><a href="simulace3.html#cb135-668" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb135-669"><a href="simulace3.html#cb135-669" tabindex="-1"></a>  </span>
<span id="cb135-670"><a href="simulace3.html#cb135-670" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-671"><a href="simulace3.html#cb135-671" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-672"><a href="simulace3.html#cb135-672" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-673"><a href="simulace3.html#cb135-673" tabindex="-1"></a>  </span>
<span id="cb135-674"><a href="simulace3.html#cb135-674" tabindex="-1"></a>  <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb135-675"><a href="simulace3.html#cb135-675" tabindex="-1"></a>  x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train_norm)</span>
<span id="cb135-676"><a href="simulace3.html#cb135-676" tabindex="-1"></a>  y.train <span class="ot">&lt;-</span> <span class="fu">as.factor</span>(Y.train_norm)</span>
<span id="cb135-677"><a href="simulace3.html#cb135-677" tabindex="-1"></a>  </span>
<span id="cb135-678"><a href="simulace3.html#cb135-678" tabindex="-1"></a>  <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb135-679"><a href="simulace3.html#cb135-679" tabindex="-1"></a>  tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb135-680"><a href="simulace3.html#cb135-680" tabindex="-1"></a>  </span>
<span id="cb135-681"><a href="simulace3.html#cb135-681" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb135-682"><a href="simulace3.html#cb135-682" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb135-683"><a href="simulace3.html#cb135-683" tabindex="-1"></a>  <span class="co"># B-spline baze </span></span>
<span id="cb135-684"><a href="simulace3.html#cb135-684" tabindex="-1"></a>  basis1 <span class="ot">&lt;-</span> X.train_norm<span class="sc">$</span>basis</span>
<span id="cb135-685"><a href="simulace3.html#cb135-685" tabindex="-1"></a>  </span>
<span id="cb135-686"><a href="simulace3.html#cb135-686" tabindex="-1"></a>  <span class="co"># formula</span></span>
<span id="cb135-687"><a href="simulace3.html#cb135-687" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x </span>
<span id="cb135-688"><a href="simulace3.html#cb135-688" tabindex="-1"></a>  <span class="co"># baze pro x</span></span>
<span id="cb135-689"><a href="simulace3.html#cb135-689" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb135-690"><a href="simulace3.html#cb135-690" tabindex="-1"></a>  <span class="co"># vstupni data do modelu</span></span>
<span id="cb135-691"><a href="simulace3.html#cb135-691" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb135-692"><a href="simulace3.html#cb135-692" tabindex="-1"></a>  </span>
<span id="cb135-693"><a href="simulace3.html#cb135-693" tabindex="-1"></a>  model.svm.f_l <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-694"><a href="simulace3.html#cb135-694" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb135-695"><a href="simulace3.html#cb135-695" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-696"><a href="simulace3.html#cb135-696" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>, </span>
<span id="cb135-697"><a href="simulace3.html#cb135-697" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-698"><a href="simulace3.html#cb135-698" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-699"><a href="simulace3.html#cb135-699" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">1</span>])</span>
<span id="cb135-700"><a href="simulace3.html#cb135-700" tabindex="-1"></a>  </span>
<span id="cb135-701"><a href="simulace3.html#cb135-701" tabindex="-1"></a>  model.svm.f_p <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-702"><a href="simulace3.html#cb135-702" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb135-703"><a href="simulace3.html#cb135-703" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-704"><a href="simulace3.html#cb135-704" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>, </span>
<span id="cb135-705"><a href="simulace3.html#cb135-705" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-706"><a href="simulace3.html#cb135-706" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-707"><a href="simulace3.html#cb135-707" tabindex="-1"></a>              <span class="at">degree =</span> p.opt,</span>
<span id="cb135-708"><a href="simulace3.html#cb135-708" tabindex="-1"></a>              <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-709"><a href="simulace3.html#cb135-709" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">2</span>])</span>
<span id="cb135-710"><a href="simulace3.html#cb135-710" tabindex="-1"></a>  </span>
<span id="cb135-711"><a href="simulace3.html#cb135-711" tabindex="-1"></a>  model.svm.f_r <span class="ot">&lt;-</span> <span class="fu">classif.svm</span>(<span class="at">formula =</span> f,</span>
<span id="cb135-712"><a href="simulace3.html#cb135-712" tabindex="-1"></a>              <span class="at">data =</span> ldata,</span>
<span id="cb135-713"><a href="simulace3.html#cb135-713" tabindex="-1"></a>              <span class="at">basis.x =</span> basis.x,</span>
<span id="cb135-714"><a href="simulace3.html#cb135-714" tabindex="-1"></a>              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>, </span>
<span id="cb135-715"><a href="simulace3.html#cb135-715" tabindex="-1"></a>              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-716"><a href="simulace3.html#cb135-716" tabindex="-1"></a>              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-717"><a href="simulace3.html#cb135-717" tabindex="-1"></a>              <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb135-718"><a href="simulace3.html#cb135-718" tabindex="-1"></a>              <span class="at">cost =</span> C.opt[<span class="dv">3</span>])</span>
<span id="cb135-719"><a href="simulace3.html#cb135-719" tabindex="-1"></a>  </span>
<span id="cb135-720"><a href="simulace3.html#cb135-720" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-721"><a href="simulace3.html#cb135-721" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb135-722"><a href="simulace3.html#cb135-722" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-723"><a href="simulace3.html#cb135-723" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.l)</span>
<span id="cb135-724"><a href="simulace3.html#cb135-724" tabindex="-1"></a>  </span>
<span id="cb135-725"><a href="simulace3.html#cb135-725" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-726"><a href="simulace3.html#cb135-726" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.p)</span>
<span id="cb135-727"><a href="simulace3.html#cb135-727" tabindex="-1"></a>  </span>
<span id="cb135-728"><a href="simulace3.html#cb135-728" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-729"><a href="simulace3.html#cb135-729" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.train_norm) <span class="sc">==</span> predictions.train.r)</span>
<span id="cb135-730"><a href="simulace3.html#cb135-730" tabindex="-1"></a>    </span>
<span id="cb135-731"><a href="simulace3.html#cb135-731" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-732"><a href="simulace3.html#cb135-732" tabindex="-1"></a>  newdat <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test_norm))</span>
<span id="cb135-733"><a href="simulace3.html#cb135-733" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_l, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-734"><a href="simulace3.html#cb135-734" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.l)</span>
<span id="cb135-735"><a href="simulace3.html#cb135-735" tabindex="-1"></a>  </span>
<span id="cb135-736"><a href="simulace3.html#cb135-736" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_p, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-737"><a href="simulace3.html#cb135-737" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.p)</span>
<span id="cb135-738"><a href="simulace3.html#cb135-738" tabindex="-1"></a>  </span>
<span id="cb135-739"><a href="simulace3.html#cb135-739" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.svm.f_r, newdat, <span class="at">type =</span> <span class="st">&#39;class&#39;</span>)</span>
<span id="cb135-740"><a href="simulace3.html#cb135-740" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">mean</span>(<span class="fu">factor</span>(Y.test_norm) <span class="sc">==</span> predictions.test.r)</span>
<span id="cb135-741"><a href="simulace3.html#cb135-741" tabindex="-1"></a>  </span>
<span id="cb135-742"><a href="simulace3.html#cb135-742" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - func&#39;</span>, </span>
<span id="cb135-743"><a href="simulace3.html#cb135-743" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - func&#39;</span>, </span>
<span id="cb135-744"><a href="simulace3.html#cb135-744" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - func&#39;</span>), </span>
<span id="cb135-745"><a href="simulace3.html#cb135-745" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb135-746"><a href="simulace3.html#cb135-746" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb135-747"><a href="simulace3.html#cb135-747" tabindex="-1"></a>  </span>
<span id="cb135-748"><a href="simulace3.html#cb135-748" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-749"><a href="simulace3.html#cb135-749" tabindex="-1"></a>  </span>
<span id="cb135-750"><a href="simulace3.html#cb135-750" tabindex="-1"></a>  <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb135-751"><a href="simulace3.html#cb135-751" tabindex="-1"></a>  </span>
<span id="cb135-752"><a href="simulace3.html#cb135-752" tabindex="-1"></a>  <span class="co"># ktere hodnoty chceme uvazovat</span></span>
<span id="cb135-753"><a href="simulace3.html#cb135-753" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">5</span>, <span class="sc">-</span><span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-754"><a href="simulace3.html#cb135-754" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-755"><a href="simulace3.html#cb135-755" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb135-756"><a href="simulace3.html#cb135-756" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-757"><a href="simulace3.html#cb135-757" tabindex="-1"></a>  </span>
<span id="cb135-758"><a href="simulace3.html#cb135-758" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-759"><a href="simulace3.html#cb135-759" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-760"><a href="simulace3.html#cb135-760" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-761"><a href="simulace3.html#cb135-761" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb135-762"><a href="simulace3.html#cb135-762" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-763"><a href="simulace3.html#cb135-763" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb135-764"><a href="simulace3.html#cb135-764" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb135-765"><a href="simulace3.html#cb135-765" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb135-766"><a href="simulace3.html#cb135-766" tabindex="-1"></a>  )</span>
<span id="cb135-767"><a href="simulace3.html#cb135-767" tabindex="-1"></a>  </span>
<span id="cb135-768"><a href="simulace3.html#cb135-768" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb135-769"><a href="simulace3.html#cb135-769" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb135-770"><a href="simulace3.html#cb135-770" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb135-771"><a href="simulace3.html#cb135-771" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-772"><a href="simulace3.html#cb135-772" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-773"><a href="simulace3.html#cb135-773" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-774"><a href="simulace3.html#cb135-774" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb135-775"><a href="simulace3.html#cb135-775" tabindex="-1"></a>      </span>
<span id="cb135-776"><a href="simulace3.html#cb135-776" tabindex="-1"></a>      data.grid.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[cv_sample, ])</span>
<span id="cb135-777"><a href="simulace3.html#cb135-777" tabindex="-1"></a>      data.grid.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(grid.data[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb135-778"><a href="simulace3.html#cb135-778" tabindex="-1"></a>      </span>
<span id="cb135-779"><a href="simulace3.html#cb135-779" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb135-780"><a href="simulace3.html#cb135-780" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-781"><a href="simulace3.html#cb135-781" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb135-782"><a href="simulace3.html#cb135-782" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-783"><a href="simulace3.html#cb135-783" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-784"><a href="simulace3.html#cb135-784" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb135-785"><a href="simulace3.html#cb135-785" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-786"><a href="simulace3.html#cb135-786" tabindex="-1"></a>      </span>
<span id="cb135-787"><a href="simulace3.html#cb135-787" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-788"><a href="simulace3.html#cb135-788" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb135-789"><a href="simulace3.html#cb135-789" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-790"><a href="simulace3.html#cb135-790" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-791"><a href="simulace3.html#cb135-791" tabindex="-1"></a>      </span>
<span id="cb135-792"><a href="simulace3.html#cb135-792" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb135-793"><a href="simulace3.html#cb135-793" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-794"><a href="simulace3.html#cb135-794" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb135-795"><a href="simulace3.html#cb135-795" tabindex="-1"></a>      </span>
<span id="cb135-796"><a href="simulace3.html#cb135-796" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb135-797"><a href="simulace3.html#cb135-797" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb135-798"><a href="simulace3.html#cb135-798" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-799"><a href="simulace3.html#cb135-799" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb135-800"><a href="simulace3.html#cb135-800" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-801"><a href="simulace3.html#cb135-801" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-802"><a href="simulace3.html#cb135-802" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-803"><a href="simulace3.html#cb135-803" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-804"><a href="simulace3.html#cb135-804" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb135-805"><a href="simulace3.html#cb135-805" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-806"><a href="simulace3.html#cb135-806" tabindex="-1"></a>        </span>
<span id="cb135-807"><a href="simulace3.html#cb135-807" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-808"><a href="simulace3.html#cb135-808" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb135-809"><a href="simulace3.html#cb135-809" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb135-810"><a href="simulace3.html#cb135-810" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-811"><a href="simulace3.html#cb135-811" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-812"><a href="simulace3.html#cb135-812" tabindex="-1"></a>        </span>
<span id="cb135-813"><a href="simulace3.html#cb135-813" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb135-814"><a href="simulace3.html#cb135-814" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-815"><a href="simulace3.html#cb135-815" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb135-816"><a href="simulace3.html#cb135-816" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb135-817"><a href="simulace3.html#cb135-817" tabindex="-1"></a>      }</span>
<span id="cb135-818"><a href="simulace3.html#cb135-818" tabindex="-1"></a>          </span>
<span id="cb135-819"><a href="simulace3.html#cb135-819" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb135-820"><a href="simulace3.html#cb135-820" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb135-821"><a href="simulace3.html#cb135-821" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-822"><a href="simulace3.html#cb135-822" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.grid.train.cv,</span>
<span id="cb135-823"><a href="simulace3.html#cb135-823" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-824"><a href="simulace3.html#cb135-824" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-825"><a href="simulace3.html#cb135-825" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-826"><a href="simulace3.html#cb135-826" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb135-827"><a href="simulace3.html#cb135-827" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-828"><a href="simulace3.html#cb135-828" tabindex="-1"></a>        </span>
<span id="cb135-829"><a href="simulace3.html#cb135-829" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-830"><a href="simulace3.html#cb135-830" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.grid.test.cv)</span>
<span id="cb135-831"><a href="simulace3.html#cb135-831" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.grid.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-832"><a href="simulace3.html#cb135-832" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-833"><a href="simulace3.html#cb135-833" tabindex="-1"></a>        </span>
<span id="cb135-834"><a href="simulace3.html#cb135-834" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb135-835"><a href="simulace3.html#cb135-835" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-836"><a href="simulace3.html#cb135-836" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb135-837"><a href="simulace3.html#cb135-837" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb135-838"><a href="simulace3.html#cb135-838" tabindex="-1"></a>      }</span>
<span id="cb135-839"><a href="simulace3.html#cb135-839" tabindex="-1"></a>    }</span>
<span id="cb135-840"><a href="simulace3.html#cb135-840" tabindex="-1"></a>  }</span>
<span id="cb135-841"><a href="simulace3.html#cb135-841" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb135-842"><a href="simulace3.html#cb135-842" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb135-843"><a href="simulace3.html#cb135-843" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb135-844"><a href="simulace3.html#cb135-844" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb135-845"><a href="simulace3.html#cb135-845" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-846"><a href="simulace3.html#cb135-846" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb135-847"><a href="simulace3.html#cb135-847" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-848"><a href="simulace3.html#cb135-848" tabindex="-1"></a>  </span>
<span id="cb135-849"><a href="simulace3.html#cb135-849" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-850"><a href="simulace3.html#cb135-850" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb135-851"><a href="simulace3.html#cb135-851" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb135-852"><a href="simulace3.html#cb135-852" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb135-853"><a href="simulace3.html#cb135-853" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb135-854"><a href="simulace3.html#cb135-854" tabindex="-1"></a>  </span>
<span id="cb135-855"><a href="simulace3.html#cb135-855" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-856"><a href="simulace3.html#cb135-856" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-857"><a href="simulace3.html#cb135-857" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb135-858"><a href="simulace3.html#cb135-858" tabindex="-1"></a>  </span>
<span id="cb135-859"><a href="simulace3.html#cb135-859" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-860"><a href="simulace3.html#cb135-860" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-861"><a href="simulace3.html#cb135-861" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb135-862"><a href="simulace3.html#cb135-862" tabindex="-1"></a>  </span>
<span id="cb135-863"><a href="simulace3.html#cb135-863" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-864"><a href="simulace3.html#cb135-864" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-865"><a href="simulace3.html#cb135-865" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-866"><a href="simulace3.html#cb135-866" tabindex="-1"></a>  </span>
<span id="cb135-867"><a href="simulace3.html#cb135-867" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-868"><a href="simulace3.html#cb135-868" tabindex="-1"></a>  clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb135-869"><a href="simulace3.html#cb135-869" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-870"><a href="simulace3.html#cb135-870" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-871"><a href="simulace3.html#cb135-871" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb135-872"><a href="simulace3.html#cb135-872" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-873"><a href="simulace3.html#cb135-873" tabindex="-1"></a>  </span>
<span id="cb135-874"><a href="simulace3.html#cb135-874" tabindex="-1"></a>  clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb135-875"><a href="simulace3.html#cb135-875" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-876"><a href="simulace3.html#cb135-876" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-877"><a href="simulace3.html#cb135-877" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb135-878"><a href="simulace3.html#cb135-878" tabindex="-1"></a>                   <span class="at">degree =</span> p.opt,</span>
<span id="cb135-879"><a href="simulace3.html#cb135-879" tabindex="-1"></a>                   <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-880"><a href="simulace3.html#cb135-880" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-881"><a href="simulace3.html#cb135-881" tabindex="-1"></a>  </span>
<span id="cb135-882"><a href="simulace3.html#cb135-882" tabindex="-1"></a>  clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb135-883"><a href="simulace3.html#cb135-883" tabindex="-1"></a>                   <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-884"><a href="simulace3.html#cb135-884" tabindex="-1"></a>                   <span class="at">scale =</span> <span class="cn">TRUE</span>, </span>
<span id="cb135-885"><a href="simulace3.html#cb135-885" tabindex="-1"></a>                   <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb135-886"><a href="simulace3.html#cb135-886" tabindex="-1"></a>                   <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb135-887"><a href="simulace3.html#cb135-887" tabindex="-1"></a>                   <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-888"><a href="simulace3.html#cb135-888" tabindex="-1"></a>  </span>
<span id="cb135-889"><a href="simulace3.html#cb135-889" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-890"><a href="simulace3.html#cb135-890" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb135-891"><a href="simulace3.html#cb135-891" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb135-892"><a href="simulace3.html#cb135-892" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-893"><a href="simulace3.html#cb135-893" tabindex="-1"></a>  </span>
<span id="cb135-894"><a href="simulace3.html#cb135-894" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb135-895"><a href="simulace3.html#cb135-895" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb135-896"><a href="simulace3.html#cb135-896" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-897"><a href="simulace3.html#cb135-897" tabindex="-1"></a>  </span>
<span id="cb135-898"><a href="simulace3.html#cb135-898" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb135-899"><a href="simulace3.html#cb135-899" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb135-900"><a href="simulace3.html#cb135-900" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-901"><a href="simulace3.html#cb135-901" tabindex="-1"></a>  </span>
<span id="cb135-902"><a href="simulace3.html#cb135-902" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-903"><a href="simulace3.html#cb135-903" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb135-904"><a href="simulace3.html#cb135-904" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-905"><a href="simulace3.html#cb135-905" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-906"><a href="simulace3.html#cb135-906" tabindex="-1"></a>  </span>
<span id="cb135-907"><a href="simulace3.html#cb135-907" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb135-908"><a href="simulace3.html#cb135-908" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-909"><a href="simulace3.html#cb135-909" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-910"><a href="simulace3.html#cb135-910" tabindex="-1"></a>  </span>
<span id="cb135-911"><a href="simulace3.html#cb135-911" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb135-912"><a href="simulace3.html#cb135-912" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-913"><a href="simulace3.html#cb135-913" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-914"><a href="simulace3.html#cb135-914" tabindex="-1"></a>  </span>
<span id="cb135-915"><a href="simulace3.html#cb135-915" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb135-916"><a href="simulace3.html#cb135-916" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb135-917"><a href="simulace3.html#cb135-917" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb135-918"><a href="simulace3.html#cb135-918" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb135-919"><a href="simulace3.html#cb135-919" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb135-920"><a href="simulace3.html#cb135-920" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb135-921"><a href="simulace3.html#cb135-921" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb135-922"><a href="simulace3.html#cb135-922" tabindex="-1"></a>  </span>
<span id="cb135-923"><a href="simulace3.html#cb135-923" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-924"><a href="simulace3.html#cb135-924" tabindex="-1"></a>  </span>
<span id="cb135-925"><a href="simulace3.html#cb135-925" tabindex="-1"></a>  <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb135-926"><a href="simulace3.html#cb135-926" tabindex="-1"></a>  </span>
<span id="cb135-927"><a href="simulace3.html#cb135-927" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-928"><a href="simulace3.html#cb135-928" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">3</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-929"><a href="simulace3.html#cb135-929" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb135-930"><a href="simulace3.html#cb135-930" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-931"><a href="simulace3.html#cb135-931" tabindex="-1"></a>  </span>
<span id="cb135-932"><a href="simulace3.html#cb135-932" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-933"><a href="simulace3.html#cb135-933" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-934"><a href="simulace3.html#cb135-934" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-935"><a href="simulace3.html#cb135-935" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb135-936"><a href="simulace3.html#cb135-936" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-937"><a href="simulace3.html#cb135-937" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb135-938"><a href="simulace3.html#cb135-938" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb135-939"><a href="simulace3.html#cb135-939" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb135-940"><a href="simulace3.html#cb135-940" tabindex="-1"></a>  )</span>
<span id="cb135-941"><a href="simulace3.html#cb135-941" tabindex="-1"></a>  </span>
<span id="cb135-942"><a href="simulace3.html#cb135-942" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb135-943"><a href="simulace3.html#cb135-943" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb135-944"><a href="simulace3.html#cb135-944" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb135-945"><a href="simulace3.html#cb135-945" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-946"><a href="simulace3.html#cb135-946" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-947"><a href="simulace3.html#cb135-947" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-948"><a href="simulace3.html#cb135-948" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.PCA.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb135-949"><a href="simulace3.html#cb135-949" tabindex="-1"></a>      </span>
<span id="cb135-950"><a href="simulace3.html#cb135-950" tabindex="-1"></a>      data.PCA.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[cv_sample, ])</span>
<span id="cb135-951"><a href="simulace3.html#cb135-951" tabindex="-1"></a>      data.PCA.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb135-952"><a href="simulace3.html#cb135-952" tabindex="-1"></a>      </span>
<span id="cb135-953"><a href="simulace3.html#cb135-953" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb135-954"><a href="simulace3.html#cb135-954" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-955"><a href="simulace3.html#cb135-955" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb135-956"><a href="simulace3.html#cb135-956" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-957"><a href="simulace3.html#cb135-957" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-958"><a href="simulace3.html#cb135-958" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb135-959"><a href="simulace3.html#cb135-959" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-960"><a href="simulace3.html#cb135-960" tabindex="-1"></a>      </span>
<span id="cb135-961"><a href="simulace3.html#cb135-961" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-962"><a href="simulace3.html#cb135-962" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb135-963"><a href="simulace3.html#cb135-963" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-964"><a href="simulace3.html#cb135-964" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-965"><a href="simulace3.html#cb135-965" tabindex="-1"></a>      </span>
<span id="cb135-966"><a href="simulace3.html#cb135-966" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb135-967"><a href="simulace3.html#cb135-967" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-968"><a href="simulace3.html#cb135-968" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb135-969"><a href="simulace3.html#cb135-969" tabindex="-1"></a>      </span>
<span id="cb135-970"><a href="simulace3.html#cb135-970" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb135-971"><a href="simulace3.html#cb135-971" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb135-972"><a href="simulace3.html#cb135-972" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-973"><a href="simulace3.html#cb135-973" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb135-974"><a href="simulace3.html#cb135-974" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-975"><a href="simulace3.html#cb135-975" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-976"><a href="simulace3.html#cb135-976" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-977"><a href="simulace3.html#cb135-977" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-978"><a href="simulace3.html#cb135-978" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb135-979"><a href="simulace3.html#cb135-979" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-980"><a href="simulace3.html#cb135-980" tabindex="-1"></a>        </span>
<span id="cb135-981"><a href="simulace3.html#cb135-981" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-982"><a href="simulace3.html#cb135-982" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb135-983"><a href="simulace3.html#cb135-983" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-984"><a href="simulace3.html#cb135-984" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-985"><a href="simulace3.html#cb135-985" tabindex="-1"></a>        </span>
<span id="cb135-986"><a href="simulace3.html#cb135-986" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb135-987"><a href="simulace3.html#cb135-987" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-988"><a href="simulace3.html#cb135-988" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb135-989"><a href="simulace3.html#cb135-989" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb135-990"><a href="simulace3.html#cb135-990" tabindex="-1"></a>      }</span>
<span id="cb135-991"><a href="simulace3.html#cb135-991" tabindex="-1"></a>          </span>
<span id="cb135-992"><a href="simulace3.html#cb135-992" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb135-993"><a href="simulace3.html#cb135-993" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb135-994"><a href="simulace3.html#cb135-994" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-995"><a href="simulace3.html#cb135-995" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train.cv,</span>
<span id="cb135-996"><a href="simulace3.html#cb135-996" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-997"><a href="simulace3.html#cb135-997" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-998"><a href="simulace3.html#cb135-998" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-999"><a href="simulace3.html#cb135-999" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb135-1000"><a href="simulace3.html#cb135-1000" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-1001"><a href="simulace3.html#cb135-1001" tabindex="-1"></a>        </span>
<span id="cb135-1002"><a href="simulace3.html#cb135-1002" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1003"><a href="simulace3.html#cb135-1003" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> data.PCA.test.cv)</span>
<span id="cb135-1004"><a href="simulace3.html#cb135-1004" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1005"><a href="simulace3.html#cb135-1005" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1006"><a href="simulace3.html#cb135-1006" tabindex="-1"></a>        </span>
<span id="cb135-1007"><a href="simulace3.html#cb135-1007" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb135-1008"><a href="simulace3.html#cb135-1008" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-1009"><a href="simulace3.html#cb135-1009" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb135-1010"><a href="simulace3.html#cb135-1010" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb135-1011"><a href="simulace3.html#cb135-1011" tabindex="-1"></a>      }</span>
<span id="cb135-1012"><a href="simulace3.html#cb135-1012" tabindex="-1"></a>    }</span>
<span id="cb135-1013"><a href="simulace3.html#cb135-1013" tabindex="-1"></a>  }</span>
<span id="cb135-1014"><a href="simulace3.html#cb135-1014" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb135-1015"><a href="simulace3.html#cb135-1015" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb135-1016"><a href="simulace3.html#cb135-1016" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb135-1017"><a href="simulace3.html#cb135-1017" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb135-1018"><a href="simulace3.html#cb135-1018" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1019"><a href="simulace3.html#cb135-1019" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb135-1020"><a href="simulace3.html#cb135-1020" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1021"><a href="simulace3.html#cb135-1021" tabindex="-1"></a>  </span>
<span id="cb135-1022"><a href="simulace3.html#cb135-1022" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1023"><a href="simulace3.html#cb135-1023" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb135-1024"><a href="simulace3.html#cb135-1024" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb135-1025"><a href="simulace3.html#cb135-1025" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb135-1026"><a href="simulace3.html#cb135-1026" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb135-1027"><a href="simulace3.html#cb135-1027" tabindex="-1"></a>  </span>
<span id="cb135-1028"><a href="simulace3.html#cb135-1028" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-1029"><a href="simulace3.html#cb135-1029" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-1030"><a href="simulace3.html#cb135-1030" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb135-1031"><a href="simulace3.html#cb135-1031" tabindex="-1"></a>  </span>
<span id="cb135-1032"><a href="simulace3.html#cb135-1032" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-1033"><a href="simulace3.html#cb135-1033" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-1034"><a href="simulace3.html#cb135-1034" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb135-1035"><a href="simulace3.html#cb135-1035" tabindex="-1"></a>  </span>
<span id="cb135-1036"><a href="simulace3.html#cb135-1036" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1037"><a href="simulace3.html#cb135-1037" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-1038"><a href="simulace3.html#cb135-1038" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-1039"><a href="simulace3.html#cb135-1039" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1040"><a href="simulace3.html#cb135-1040" tabindex="-1"></a>  clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb135-1041"><a href="simulace3.html#cb135-1041" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1042"><a href="simulace3.html#cb135-1042" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1043"><a href="simulace3.html#cb135-1043" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb135-1044"><a href="simulace3.html#cb135-1044" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-1045"><a href="simulace3.html#cb135-1045" tabindex="-1"></a>  </span>
<span id="cb135-1046"><a href="simulace3.html#cb135-1046" tabindex="-1"></a>  clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb135-1047"><a href="simulace3.html#cb135-1047" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1048"><a href="simulace3.html#cb135-1048" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1049"><a href="simulace3.html#cb135-1049" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb135-1050"><a href="simulace3.html#cb135-1050" tabindex="-1"></a>                       <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1051"><a href="simulace3.html#cb135-1051" tabindex="-1"></a>                       <span class="at">degree =</span> p.opt,</span>
<span id="cb135-1052"><a href="simulace3.html#cb135-1052" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-1053"><a href="simulace3.html#cb135-1053" tabindex="-1"></a>  </span>
<span id="cb135-1054"><a href="simulace3.html#cb135-1054" tabindex="-1"></a>  clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb135-1055"><a href="simulace3.html#cb135-1055" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1056"><a href="simulace3.html#cb135-1056" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1057"><a href="simulace3.html#cb135-1057" tabindex="-1"></a>                       <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb135-1058"><a href="simulace3.html#cb135-1058" tabindex="-1"></a>                       <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb135-1059"><a href="simulace3.html#cb135-1059" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-1060"><a href="simulace3.html#cb135-1060" tabindex="-1"></a>  </span>
<span id="cb135-1061"><a href="simulace3.html#cb135-1061" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1062"><a href="simulace3.html#cb135-1062" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-1063"><a href="simulace3.html#cb135-1063" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1064"><a href="simulace3.html#cb135-1064" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1065"><a href="simulace3.html#cb135-1065" tabindex="-1"></a>  </span>
<span id="cb135-1066"><a href="simulace3.html#cb135-1066" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-1067"><a href="simulace3.html#cb135-1067" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1068"><a href="simulace3.html#cb135-1068" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1069"><a href="simulace3.html#cb135-1069" tabindex="-1"></a>  </span>
<span id="cb135-1070"><a href="simulace3.html#cb135-1070" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb135-1071"><a href="simulace3.html#cb135-1071" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1072"><a href="simulace3.html#cb135-1072" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1073"><a href="simulace3.html#cb135-1073" tabindex="-1"></a>    </span>
<span id="cb135-1074"><a href="simulace3.html#cb135-1074" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-1075"><a href="simulace3.html#cb135-1075" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-1076"><a href="simulace3.html#cb135-1076" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1077"><a href="simulace3.html#cb135-1077" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1078"><a href="simulace3.html#cb135-1078" tabindex="-1"></a>  </span>
<span id="cb135-1079"><a href="simulace3.html#cb135-1079" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-1080"><a href="simulace3.html#cb135-1080" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1081"><a href="simulace3.html#cb135-1081" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1082"><a href="simulace3.html#cb135-1082" tabindex="-1"></a>  </span>
<span id="cb135-1083"><a href="simulace3.html#cb135-1083" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb135-1084"><a href="simulace3.html#cb135-1084" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1085"><a href="simulace3.html#cb135-1085" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1086"><a href="simulace3.html#cb135-1086" tabindex="-1"></a>  </span>
<span id="cb135-1087"><a href="simulace3.html#cb135-1087" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb135-1088"><a href="simulace3.html#cb135-1088" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb135-1089"><a href="simulace3.html#cb135-1089" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb135-1090"><a href="simulace3.html#cb135-1090" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb135-1091"><a href="simulace3.html#cb135-1091" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb135-1092"><a href="simulace3.html#cb135-1092" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb135-1093"><a href="simulace3.html#cb135-1093" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb135-1094"><a href="simulace3.html#cb135-1094" tabindex="-1"></a>  </span>
<span id="cb135-1095"><a href="simulace3.html#cb135-1095" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-1096"><a href="simulace3.html#cb135-1096" tabindex="-1"></a>  </span>
<span id="cb135-1097"><a href="simulace3.html#cb135-1097" tabindex="-1"></a>  <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb135-1098"><a href="simulace3.html#cb135-1098" tabindex="-1"></a>  </span>
<span id="cb135-1099"><a href="simulace3.html#cb135-1099" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">4</span>, <span class="sc">-</span><span class="dv">1</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-1100"><a href="simulace3.html#cb135-1100" tabindex="-1"></a>  C.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="dv">1</span>, <span class="dv">4</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb135-1101"><a href="simulace3.html#cb135-1101" tabindex="-1"></a>  p.cv <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb135-1102"><a href="simulace3.html#cb135-1102" tabindex="-1"></a>  coef0 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb135-1103"><a href="simulace3.html#cb135-1103" tabindex="-1"></a>  </span>
<span id="cb135-1104"><a href="simulace3.html#cb135-1104" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-1105"><a href="simulace3.html#cb135-1105" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-1106"><a href="simulace3.html#cb135-1106" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-1107"><a href="simulace3.html#cb135-1107" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb135-1108"><a href="simulace3.html#cb135-1108" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-1109"><a href="simulace3.html#cb135-1109" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), k_cv)),</span>
<span id="cb135-1110"><a href="simulace3.html#cb135-1110" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(p.cv), k_cv)),</span>
<span id="cb135-1111"><a href="simulace3.html#cb135-1111" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(C.cv), <span class="fu">length</span>(gamma.cv), k_cv))</span>
<span id="cb135-1112"><a href="simulace3.html#cb135-1112" tabindex="-1"></a>  )</span>
<span id="cb135-1113"><a href="simulace3.html#cb135-1113" tabindex="-1"></a>  </span>
<span id="cb135-1114"><a href="simulace3.html#cb135-1114" tabindex="-1"></a>  <span class="co"># nejprve projdeme hodnoty C</span></span>
<span id="cb135-1115"><a href="simulace3.html#cb135-1115" tabindex="-1"></a>  <span class="cf">for</span> (C <span class="cf">in</span> C.cv) {</span>
<span id="cb135-1116"><a href="simulace3.html#cb135-1116" tabindex="-1"></a>    <span class="co"># projdeme jednotlive folds</span></span>
<span id="cb135-1117"><a href="simulace3.html#cb135-1117" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-1118"><a href="simulace3.html#cb135-1118" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-1119"><a href="simulace3.html#cb135-1119" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-1120"><a href="simulace3.html#cb135-1120" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb135-1121"><a href="simulace3.html#cb135-1121" tabindex="-1"></a>      </span>
<span id="cb135-1122"><a href="simulace3.html#cb135-1122" tabindex="-1"></a>      data.Bbasis.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[cv_sample, ])</span>
<span id="cb135-1123"><a href="simulace3.html#cb135-1123" tabindex="-1"></a>      data.Bbasis.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.Bbasis.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb135-1124"><a href="simulace3.html#cb135-1124" tabindex="-1"></a>      </span>
<span id="cb135-1125"><a href="simulace3.html#cb135-1125" tabindex="-1"></a>      <span class="do">## LINEARNI JADRO</span></span>
<span id="cb135-1126"><a href="simulace3.html#cb135-1126" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1127"><a href="simulace3.html#cb135-1127" tabindex="-1"></a>      clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb135-1128"><a href="simulace3.html#cb135-1128" tabindex="-1"></a>                       <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1129"><a href="simulace3.html#cb135-1129" tabindex="-1"></a>                       <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1130"><a href="simulace3.html#cb135-1130" tabindex="-1"></a>                       <span class="at">cost =</span> C,</span>
<span id="cb135-1131"><a href="simulace3.html#cb135-1131" tabindex="-1"></a>                       <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-1132"><a href="simulace3.html#cb135-1132" tabindex="-1"></a>      </span>
<span id="cb135-1133"><a href="simulace3.html#cb135-1133" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1134"><a href="simulace3.html#cb135-1134" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb135-1135"><a href="simulace3.html#cb135-1135" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1136"><a href="simulace3.html#cb135-1136" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1137"><a href="simulace3.html#cb135-1137" tabindex="-1"></a>      </span>
<span id="cb135-1138"><a href="simulace3.html#cb135-1138" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane C a fold</span></span>
<span id="cb135-1139"><a href="simulace3.html#cb135-1139" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-1140"><a href="simulace3.html#cb135-1140" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb135-1141"><a href="simulace3.html#cb135-1141" tabindex="-1"></a>      </span>
<span id="cb135-1142"><a href="simulace3.html#cb135-1142" tabindex="-1"></a>      <span class="do">## POLYNOMIALNI JADRO</span></span>
<span id="cb135-1143"><a href="simulace3.html#cb135-1143" tabindex="-1"></a>      <span class="cf">for</span> (p <span class="cf">in</span> p.cv) {</span>
<span id="cb135-1144"><a href="simulace3.html#cb135-1144" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1145"><a href="simulace3.html#cb135-1145" tabindex="-1"></a>        clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb135-1146"><a href="simulace3.html#cb135-1146" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1147"><a href="simulace3.html#cb135-1147" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1148"><a href="simulace3.html#cb135-1148" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-1149"><a href="simulace3.html#cb135-1149" tabindex="-1"></a>                         <span class="at">coef0 =</span> coef0,</span>
<span id="cb135-1150"><a href="simulace3.html#cb135-1150" tabindex="-1"></a>                         <span class="at">degree =</span> p,</span>
<span id="cb135-1151"><a href="simulace3.html#cb135-1151" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-1152"><a href="simulace3.html#cb135-1152" tabindex="-1"></a>        </span>
<span id="cb135-1153"><a href="simulace3.html#cb135-1153" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1154"><a href="simulace3.html#cb135-1154" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, </span>
<span id="cb135-1155"><a href="simulace3.html#cb135-1155" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb135-1156"><a href="simulace3.html#cb135-1156" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1157"><a href="simulace3.html#cb135-1157" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1158"><a href="simulace3.html#cb135-1158" tabindex="-1"></a>        </span>
<span id="cb135-1159"><a href="simulace3.html#cb135-1159" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, p a fold</span></span>
<span id="cb135-1160"><a href="simulace3.html#cb135-1160" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-1161"><a href="simulace3.html#cb135-1161" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p.cv))[p.cv <span class="sc">==</span> p],</span>
<span id="cb135-1162"><a href="simulace3.html#cb135-1162" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb135-1163"><a href="simulace3.html#cb135-1163" tabindex="-1"></a>      }</span>
<span id="cb135-1164"><a href="simulace3.html#cb135-1164" tabindex="-1"></a>          </span>
<span id="cb135-1165"><a href="simulace3.html#cb135-1165" tabindex="-1"></a>      <span class="do">## RADIALNI JADRO</span></span>
<span id="cb135-1166"><a href="simulace3.html#cb135-1166" tabindex="-1"></a>      <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb135-1167"><a href="simulace3.html#cb135-1167" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1168"><a href="simulace3.html#cb135-1168" tabindex="-1"></a>        clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train.cv,</span>
<span id="cb135-1169"><a href="simulace3.html#cb135-1169" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1170"><a href="simulace3.html#cb135-1170" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1171"><a href="simulace3.html#cb135-1171" tabindex="-1"></a>                         <span class="at">cost =</span> C,</span>
<span id="cb135-1172"><a href="simulace3.html#cb135-1172" tabindex="-1"></a>                         <span class="at">gamma =</span> gamma,</span>
<span id="cb135-1173"><a href="simulace3.html#cb135-1173" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-1174"><a href="simulace3.html#cb135-1174" tabindex="-1"></a>        </span>
<span id="cb135-1175"><a href="simulace3.html#cb135-1175" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1176"><a href="simulace3.html#cb135-1176" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, </span>
<span id="cb135-1177"><a href="simulace3.html#cb135-1177" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.Bbasis.test.cv)</span>
<span id="cb135-1178"><a href="simulace3.html#cb135-1178" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.Bbasis.test.cv<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1179"><a href="simulace3.html#cb135-1179" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1180"><a href="simulace3.html#cb135-1180" tabindex="-1"></a>        </span>
<span id="cb135-1181"><a href="simulace3.html#cb135-1181" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane C, gamma a fold</span></span>
<span id="cb135-1182"><a href="simulace3.html#cb135-1182" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(C.cv))[C.cv <span class="sc">==</span> C], </span>
<span id="cb135-1183"><a href="simulace3.html#cb135-1183" tabindex="-1"></a>                         (<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(gamma.cv))[gamma.cv <span class="sc">==</span> gamma],</span>
<span id="cb135-1184"><a href="simulace3.html#cb135-1184" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb135-1185"><a href="simulace3.html#cb135-1185" tabindex="-1"></a>      }</span>
<span id="cb135-1186"><a href="simulace3.html#cb135-1186" tabindex="-1"></a>    }</span>
<span id="cb135-1187"><a href="simulace3.html#cb135-1187" tabindex="-1"></a>  }</span>
<span id="cb135-1188"><a href="simulace3.html#cb135-1188" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva C pres folds</span></span>
<span id="cb135-1189"><a href="simulace3.html#cb135-1189" tabindex="-1"></a>  <span class="do">## Linearni jadro</span></span>
<span id="cb135-1190"><a href="simulace3.html#cb135-1190" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.l <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.l, <span class="dv">1</span>, mean)</span>
<span id="cb135-1191"><a href="simulace3.html#cb135-1191" tabindex="-1"></a>  <span class="do">## Polynomialni jadro</span></span>
<span id="cb135-1192"><a href="simulace3.html#cb135-1192" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.p <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.p, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1193"><a href="simulace3.html#cb135-1193" tabindex="-1"></a>  <span class="do">## Radialni jadro</span></span>
<span id="cb135-1194"><a href="simulace3.html#cb135-1194" tabindex="-1"></a>  CV.results<span class="sc">$</span>SVM.r <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results<span class="sc">$</span>SVM.r, <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1195"><a href="simulace3.html#cb135-1195" tabindex="-1"></a>  </span>
<span id="cb135-1196"><a href="simulace3.html#cb135-1196" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1197"><a href="simulace3.html#cb135-1197" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(C.cv), </span>
<span id="cb135-1198"><a href="simulace3.html#cb135-1198" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(C.cv))</span>
<span id="cb135-1199"><a href="simulace3.html#cb135-1199" tabindex="-1"></a>  C.opt[C.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(C.cv)</span>
<span id="cb135-1200"><a href="simulace3.html#cb135-1200" tabindex="-1"></a>  C.opt <span class="ot">&lt;-</span> C.cv[C.opt]</span>
<span id="cb135-1201"><a href="simulace3.html#cb135-1201" tabindex="-1"></a>  </span>
<span id="cb135-1202"><a href="simulace3.html#cb135-1202" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-1203"><a href="simulace3.html#cb135-1203" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-1204"><a href="simulace3.html#cb135-1204" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb135-1205"><a href="simulace3.html#cb135-1205" tabindex="-1"></a>  </span>
<span id="cb135-1206"><a href="simulace3.html#cb135-1206" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-1207"><a href="simulace3.html#cb135-1207" tabindex="-1"></a>  p.opt[p.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(p.cv)</span>
<span id="cb135-1208"><a href="simulace3.html#cb135-1208" tabindex="-1"></a>  p.opt <span class="ot">&lt;-</span> p.cv[p.opt]</span>
<span id="cb135-1209"><a href="simulace3.html#cb135-1209" tabindex="-1"></a>  </span>
<span id="cb135-1210"><a href="simulace3.html#cb135-1210" tabindex="-1"></a>  presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1211"><a href="simulace3.html#cb135-1211" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-1212"><a href="simulace3.html#cb135-1212" tabindex="-1"></a>                       <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-1213"><a href="simulace3.html#cb135-1213" tabindex="-1"></a>  <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1214"><a href="simulace3.html#cb135-1214" tabindex="-1"></a>  clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb135-1215"><a href="simulace3.html#cb135-1215" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1216"><a href="simulace3.html#cb135-1216" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1217"><a href="simulace3.html#cb135-1217" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">1</span>],</span>
<span id="cb135-1218"><a href="simulace3.html#cb135-1218" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-1219"><a href="simulace3.html#cb135-1219" tabindex="-1"></a>  </span>
<span id="cb135-1220"><a href="simulace3.html#cb135-1220" tabindex="-1"></a>  clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb135-1221"><a href="simulace3.html#cb135-1221" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1222"><a href="simulace3.html#cb135-1222" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1223"><a href="simulace3.html#cb135-1223" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">2</span>],</span>
<span id="cb135-1224"><a href="simulace3.html#cb135-1224" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1225"><a href="simulace3.html#cb135-1225" tabindex="-1"></a>                          <span class="at">degree =</span> p.opt,</span>
<span id="cb135-1226"><a href="simulace3.html#cb135-1226" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-1227"><a href="simulace3.html#cb135-1227" tabindex="-1"></a>  </span>
<span id="cb135-1228"><a href="simulace3.html#cb135-1228" tabindex="-1"></a>  clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb135-1229"><a href="simulace3.html#cb135-1229" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1230"><a href="simulace3.html#cb135-1230" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1231"><a href="simulace3.html#cb135-1231" tabindex="-1"></a>                          <span class="at">cost =</span> C.opt[<span class="dv">3</span>],</span>
<span id="cb135-1232"><a href="simulace3.html#cb135-1232" tabindex="-1"></a>                          <span class="at">gamma =</span> gamma.opt,</span>
<span id="cb135-1233"><a href="simulace3.html#cb135-1233" tabindex="-1"></a>                          <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-1234"><a href="simulace3.html#cb135-1234" tabindex="-1"></a>  </span>
<span id="cb135-1235"><a href="simulace3.html#cb135-1235" tabindex="-1"></a>  <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1236"><a href="simulace3.html#cb135-1236" tabindex="-1"></a>  predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb135-1237"><a href="simulace3.html#cb135-1237" tabindex="-1"></a>  presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1238"><a href="simulace3.html#cb135-1238" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1239"><a href="simulace3.html#cb135-1239" tabindex="-1"></a>  </span>
<span id="cb135-1240"><a href="simulace3.html#cb135-1240" tabindex="-1"></a>  predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb135-1241"><a href="simulace3.html#cb135-1241" tabindex="-1"></a>  presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1242"><a href="simulace3.html#cb135-1242" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1243"><a href="simulace3.html#cb135-1243" tabindex="-1"></a>  </span>
<span id="cb135-1244"><a href="simulace3.html#cb135-1244" tabindex="-1"></a>  predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb135-1245"><a href="simulace3.html#cb135-1245" tabindex="-1"></a>  presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1246"><a href="simulace3.html#cb135-1246" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1247"><a href="simulace3.html#cb135-1247" tabindex="-1"></a>    </span>
<span id="cb135-1248"><a href="simulace3.html#cb135-1248" tabindex="-1"></a>  <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-1249"><a href="simulace3.html#cb135-1249" tabindex="-1"></a>  predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb135-1250"><a href="simulace3.html#cb135-1250" tabindex="-1"></a>  presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1251"><a href="simulace3.html#cb135-1251" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1252"><a href="simulace3.html#cb135-1252" tabindex="-1"></a>  </span>
<span id="cb135-1253"><a href="simulace3.html#cb135-1253" tabindex="-1"></a>  predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb135-1254"><a href="simulace3.html#cb135-1254" tabindex="-1"></a>  presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1255"><a href="simulace3.html#cb135-1255" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1256"><a href="simulace3.html#cb135-1256" tabindex="-1"></a>  </span>
<span id="cb135-1257"><a href="simulace3.html#cb135-1257" tabindex="-1"></a>  predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb135-1258"><a href="simulace3.html#cb135-1258" tabindex="-1"></a>  presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1259"><a href="simulace3.html#cb135-1259" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1260"><a href="simulace3.html#cb135-1260" tabindex="-1"></a></span>
<span id="cb135-1261"><a href="simulace3.html#cb135-1261" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb135-1262"><a href="simulace3.html#cb135-1262" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb135-1263"><a href="simulace3.html#cb135-1263" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb135-1264"><a href="simulace3.html#cb135-1264" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb135-1265"><a href="simulace3.html#cb135-1265" tabindex="-1"></a>                                      presnost.train.p, presnost.train.r),</span>
<span id="cb135-1266"><a href="simulace3.html#cb135-1266" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb135-1267"><a href="simulace3.html#cb135-1267" tabindex="-1"></a>                                     presnost.test.p, presnost.test.r))</span>
<span id="cb135-1268"><a href="simulace3.html#cb135-1268" tabindex="-1"></a></span>
<span id="cb135-1269"><a href="simulace3.html#cb135-1269" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-1270"><a href="simulace3.html#cb135-1270" tabindex="-1"></a>  </span>
<span id="cb135-1271"><a href="simulace3.html#cb135-1271" tabindex="-1"></a>  <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb135-1272"><a href="simulace3.html#cb135-1272" tabindex="-1"></a>  </span>
<span id="cb135-1273"><a href="simulace3.html#cb135-1273" tabindex="-1"></a>  <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb135-1274"><a href="simulace3.html#cb135-1274" tabindex="-1"></a>  rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb135-1275"><a href="simulace3.html#cb135-1275" tabindex="-1"></a>  norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb135-1276"><a href="simulace3.html#cb135-1276" tabindex="-1"></a>  n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb135-1277"><a href="simulace3.html#cb135-1277" tabindex="-1"></a>  n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb135-1278"><a href="simulace3.html#cb135-1278" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb135-1279"><a href="simulace3.html#cb135-1279" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-1280"><a href="simulace3.html#cb135-1280" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb135-1281"><a href="simulace3.html#cb135-1281" tabindex="-1"></a>                     <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb135-1282"><a href="simulace3.html#cb135-1282" tabindex="-1"></a>                     <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb135-1283"><a href="simulace3.html#cb135-1283" tabindex="-1"></a>  </span>
<span id="cb135-1284"><a href="simulace3.html#cb135-1284" tabindex="-1"></a>  <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb135-1285"><a href="simulace3.html#cb135-1285" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb135-1286"><a href="simulace3.html#cb135-1286" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d)</span>
<span id="cb135-1287"><a href="simulace3.html#cb135-1287" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb135-1288"><a href="simulace3.html#cb135-1288" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-1289"><a href="simulace3.html#cb135-1289" tabindex="-1"></a>    </span>
<span id="cb135-1290"><a href="simulace3.html#cb135-1290" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-1291"><a href="simulace3.html#cb135-1291" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-1292"><a href="simulace3.html#cb135-1292" tabindex="-1"></a>      cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb135-1293"><a href="simulace3.html#cb135-1293" tabindex="-1"></a>      </span>
<span id="cb135-1294"><a href="simulace3.html#cb135-1294" tabindex="-1"></a>      data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb135-1295"><a href="simulace3.html#cb135-1295" tabindex="-1"></a>      data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb135-1296"><a href="simulace3.html#cb135-1296" tabindex="-1"></a>      data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb135-1297"><a href="simulace3.html#cb135-1297" tabindex="-1"></a>      Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb135-1298"><a href="simulace3.html#cb135-1298" tabindex="-1"></a>      data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb135-1299"><a href="simulace3.html#cb135-1299" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1300"><a href="simulace3.html#cb135-1300" tabindex="-1"></a>      clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb135-1301"><a href="simulace3.html#cb135-1301" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1302"><a href="simulace3.html#cb135-1302" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1303"><a href="simulace3.html#cb135-1303" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb135-1304"><a href="simulace3.html#cb135-1304" tabindex="-1"></a>      </span>
<span id="cb135-1305"><a href="simulace3.html#cb135-1305" tabindex="-1"></a>      clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb135-1306"><a href="simulace3.html#cb135-1306" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1307"><a href="simulace3.html#cb135-1307" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1308"><a href="simulace3.html#cb135-1308" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1309"><a href="simulace3.html#cb135-1309" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb135-1310"><a href="simulace3.html#cb135-1310" tabindex="-1"></a>      </span>
<span id="cb135-1311"><a href="simulace3.html#cb135-1311" tabindex="-1"></a>      clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb135-1312"><a href="simulace3.html#cb135-1312" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1313"><a href="simulace3.html#cb135-1313" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1314"><a href="simulace3.html#cb135-1314" tabindex="-1"></a>                              <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb135-1315"><a href="simulace3.html#cb135-1315" tabindex="-1"></a>      <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1316"><a href="simulace3.html#cb135-1316" tabindex="-1"></a>      <span class="do">## linear kernel</span></span>
<span id="cb135-1317"><a href="simulace3.html#cb135-1317" tabindex="-1"></a>      predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb135-1318"><a href="simulace3.html#cb135-1318" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb135-1319"><a href="simulace3.html#cb135-1319" tabindex="-1"></a>      presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb135-1320"><a href="simulace3.html#cb135-1320" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1321"><a href="simulace3.html#cb135-1321" tabindex="-1"></a>      <span class="do">## polynomial kernel</span></span>
<span id="cb135-1322"><a href="simulace3.html#cb135-1322" tabindex="-1"></a>      predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb135-1323"><a href="simulace3.html#cb135-1323" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb135-1324"><a href="simulace3.html#cb135-1324" tabindex="-1"></a>      presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb135-1325"><a href="simulace3.html#cb135-1325" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1326"><a href="simulace3.html#cb135-1326" tabindex="-1"></a>      <span class="do">## radial kernel</span></span>
<span id="cb135-1327"><a href="simulace3.html#cb135-1327" tabindex="-1"></a>      predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb135-1328"><a href="simulace3.html#cb135-1328" tabindex="-1"></a>                                    <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb135-1329"><a href="simulace3.html#cb135-1329" tabindex="-1"></a>      presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb135-1330"><a href="simulace3.html#cb135-1330" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1331"><a href="simulace3.html#cb135-1331" tabindex="-1"></a>      </span>
<span id="cb135-1332"><a href="simulace3.html#cb135-1332" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb135-1333"><a href="simulace3.html#cb135-1333" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb135-1334"><a href="simulace3.html#cb135-1334" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb135-1335"><a href="simulace3.html#cb135-1335" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb135-1336"><a href="simulace3.html#cb135-1336" tabindex="-1"></a>    }</span>
<span id="cb135-1337"><a href="simulace3.html#cb135-1337" tabindex="-1"></a>  }</span>
<span id="cb135-1338"><a href="simulace3.html#cb135-1338" tabindex="-1"></a>  </span>
<span id="cb135-1339"><a href="simulace3.html#cb135-1339" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb135-1340"><a href="simulace3.html#cb135-1340" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb135-1341"><a href="simulace3.html#cb135-1341" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb135-1342"><a href="simulace3.html#cb135-1342" tabindex="-1"></a>  }</span>
<span id="cb135-1343"><a href="simulace3.html#cb135-1343" tabindex="-1"></a>  </span>
<span id="cb135-1344"><a href="simulace3.html#cb135-1344" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb135-1345"><a href="simulace3.html#cb135-1345" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb135-1346"><a href="simulace3.html#cb135-1346" tabindex="-1"></a>             <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb135-1347"><a href="simulace3.html#cb135-1347" tabindex="-1"></a>  </span>
<span id="cb135-1348"><a href="simulace3.html#cb135-1348" tabindex="-1"></a>  <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb135-1349"><a href="simulace3.html#cb135-1349" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb135-1350"><a href="simulace3.html#cb135-1350" tabindex="-1"></a>  </span>
<span id="cb135-1351"><a href="simulace3.html#cb135-1351" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1352"><a href="simulace3.html#cb135-1352" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb135-1353"><a href="simulace3.html#cb135-1353" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb135-1354"><a href="simulace3.html#cb135-1354" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb135-1355"><a href="simulace3.html#cb135-1355" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb135-1356"><a href="simulace3.html#cb135-1356" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1357"><a href="simulace3.html#cb135-1357" tabindex="-1"></a>  </span>
<span id="cb135-1358"><a href="simulace3.html#cb135-1358" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1359"><a href="simulace3.html#cb135-1359" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1360"><a href="simulace3.html#cb135-1360" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb135-1361"><a href="simulace3.html#cb135-1361" tabindex="-1"></a>                                   <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb135-1362"><a href="simulace3.html#cb135-1362" tabindex="-1"></a>    Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb135-1363"><a href="simulace3.html#cb135-1363" tabindex="-1"></a>    </span>
<span id="cb135-1364"><a href="simulace3.html#cb135-1364" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb135-1365"><a href="simulace3.html#cb135-1365" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb135-1366"><a href="simulace3.html#cb135-1366" tabindex="-1"></a>    </span>
<span id="cb135-1367"><a href="simulace3.html#cb135-1367" tabindex="-1"></a>    data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb135-1368"><a href="simulace3.html#cb135-1368" tabindex="-1"></a>    data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb135-1369"><a href="simulace3.html#cb135-1369" tabindex="-1"></a>    </span>
<span id="cb135-1370"><a href="simulace3.html#cb135-1370" tabindex="-1"></a>    data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb135-1371"><a href="simulace3.html#cb135-1371" tabindex="-1"></a>    data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-1372"><a href="simulace3.html#cb135-1372" tabindex="-1"></a>    </span>
<span id="cb135-1373"><a href="simulace3.html#cb135-1373" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1374"><a href="simulace3.html#cb135-1374" tabindex="-1"></a>    clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb135-1375"><a href="simulace3.html#cb135-1375" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1376"><a href="simulace3.html#cb135-1376" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1377"><a href="simulace3.html#cb135-1377" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1378"><a href="simulace3.html#cb135-1378" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1379"><a href="simulace3.html#cb135-1379" tabindex="-1"></a>    </span>
<span id="cb135-1380"><a href="simulace3.html#cb135-1380" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1381"><a href="simulace3.html#cb135-1381" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb135-1382"><a href="simulace3.html#cb135-1382" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-1383"><a href="simulace3.html#cb135-1383" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1384"><a href="simulace3.html#cb135-1384" tabindex="-1"></a>      </span>
<span id="cb135-1385"><a href="simulace3.html#cb135-1385" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1386"><a href="simulace3.html#cb135-1386" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb135-1387"><a href="simulace3.html#cb135-1387" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1388"><a href="simulace3.html#cb135-1388" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1389"><a href="simulace3.html#cb135-1389" tabindex="-1"></a>    </span>
<span id="cb135-1390"><a href="simulace3.html#cb135-1390" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1391"><a href="simulace3.html#cb135-1391" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb135-1392"><a href="simulace3.html#cb135-1392" tabindex="-1"></a>  }</span>
<span id="cb135-1393"><a href="simulace3.html#cb135-1393" tabindex="-1"></a>  </span>
<span id="cb135-1394"><a href="simulace3.html#cb135-1394" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-1395"><a href="simulace3.html#cb135-1395" tabindex="-1"></a>  </span>
<span id="cb135-1396"><a href="simulace3.html#cb135-1396" tabindex="-1"></a>  <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb135-1397"><a href="simulace3.html#cb135-1397" tabindex="-1"></a>  </span>
<span id="cb135-1398"><a href="simulace3.html#cb135-1398" tabindex="-1"></a>  <span class="do">### Gaussovo jadro</span></span>
<span id="cb135-1399"><a href="simulace3.html#cb135-1399" tabindex="-1"></a>  </span>
<span id="cb135-1400"><a href="simulace3.html#cb135-1400" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb135-1401"><a href="simulace3.html#cb135-1401" tabindex="-1"></a>  Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb135-1402"><a href="simulace3.html#cb135-1402" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb135-1403"><a href="simulace3.html#cb135-1403" tabindex="-1"></a>  }</span>
<span id="cb135-1404"><a href="simulace3.html#cb135-1404" tabindex="-1"></a>  </span>
<span id="cb135-1405"><a href="simulace3.html#cb135-1405" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb135-1406"><a href="simulace3.html#cb135-1406" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb135-1407"><a href="simulace3.html#cb135-1407" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb135-1408"><a href="simulace3.html#cb135-1408" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb135-1409"><a href="simulace3.html#cb135-1409" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb135-1410"><a href="simulace3.html#cb135-1410" tabindex="-1"></a>      }</span>
<span id="cb135-1411"><a href="simulace3.html#cb135-1411" tabindex="-1"></a>    }</span>
<span id="cb135-1412"><a href="simulace3.html#cb135-1412" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb135-1413"><a href="simulace3.html#cb135-1413" tabindex="-1"></a>  }</span>
<span id="cb135-1414"><a href="simulace3.html#cb135-1414" tabindex="-1"></a>  </span>
<span id="cb135-1415"><a href="simulace3.html#cb135-1415" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-1416"><a href="simulace3.html#cb135-1416" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-1417"><a href="simulace3.html#cb135-1417" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-1418"><a href="simulace3.html#cb135-1418" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-1419"><a href="simulace3.html#cb135-1419" tabindex="-1"></a>  </span>
<span id="cb135-1420"><a href="simulace3.html#cb135-1420" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb135-1421"><a href="simulace3.html#cb135-1421" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span><span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb135-1422"><a href="simulace3.html#cb135-1422" tabindex="-1"></a>  gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb135-1423"><a href="simulace3.html#cb135-1423" tabindex="-1"></a>  </span>
<span id="cb135-1424"><a href="simulace3.html#cb135-1424" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-1425"><a href="simulace3.html#cb135-1425" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-1426"><a href="simulace3.html#cb135-1426" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-1427"><a href="simulace3.html#cb135-1427" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb135-1428"><a href="simulace3.html#cb135-1428" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb135-1429"><a href="simulace3.html#cb135-1429" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb135-1430"><a href="simulace3.html#cb135-1430" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb135-1431"><a href="simulace3.html#cb135-1431" tabindex="-1"></a>  </span>
<span id="cb135-1432"><a href="simulace3.html#cb135-1432" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-1433"><a href="simulace3.html#cb135-1433" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1434"><a href="simulace3.html#cb135-1434" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1435"><a href="simulace3.html#cb135-1435" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1436"><a href="simulace3.html#cb135-1436" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1437"><a href="simulace3.html#cb135-1437" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1438"><a href="simulace3.html#cb135-1438" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb135-1439"><a href="simulace3.html#cb135-1439" tabindex="-1"></a>  </span>
<span id="cb135-1440"><a href="simulace3.html#cb135-1440" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb135-1441"><a href="simulace3.html#cb135-1441" tabindex="-1"></a>  <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb135-1442"><a href="simulace3.html#cb135-1442" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb135-1443"><a href="simulace3.html#cb135-1443" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-1444"><a href="simulace3.html#cb135-1444" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-1445"><a href="simulace3.html#cb135-1445" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-1446"><a href="simulace3.html#cb135-1446" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb135-1447"><a href="simulace3.html#cb135-1447" tabindex="-1"></a>    </span>
<span id="cb135-1448"><a href="simulace3.html#cb135-1448" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb135-1449"><a href="simulace3.html#cb135-1449" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1450"><a href="simulace3.html#cb135-1450" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-1451"><a href="simulace3.html#cb135-1451" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-1452"><a href="simulace3.html#cb135-1452" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-1453"><a href="simulace3.html#cb135-1453" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb135-1454"><a href="simulace3.html#cb135-1454" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-1455"><a href="simulace3.html#cb135-1455" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb135-1456"><a href="simulace3.html#cb135-1456" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb135-1457"><a href="simulace3.html#cb135-1457" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb135-1458"><a href="simulace3.html#cb135-1458" tabindex="-1"></a>    }</span>
<span id="cb135-1459"><a href="simulace3.html#cb135-1459" tabindex="-1"></a>    </span>
<span id="cb135-1460"><a href="simulace3.html#cb135-1460" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb135-1461"><a href="simulace3.html#cb135-1461" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb135-1462"><a href="simulace3.html#cb135-1462" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-1463"><a href="simulace3.html#cb135-1463" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-1464"><a href="simulace3.html#cb135-1464" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb135-1465"><a href="simulace3.html#cb135-1465" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-1466"><a href="simulace3.html#cb135-1466" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1467"><a href="simulace3.html#cb135-1467" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb135-1468"><a href="simulace3.html#cb135-1468" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-1469"><a href="simulace3.html#cb135-1469" tabindex="-1"></a>      }</span>
<span id="cb135-1470"><a href="simulace3.html#cb135-1470" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb135-1471"><a href="simulace3.html#cb135-1471" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-1472"><a href="simulace3.html#cb135-1472" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-1473"><a href="simulace3.html#cb135-1473" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-1474"><a href="simulace3.html#cb135-1474" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb135-1475"><a href="simulace3.html#cb135-1475" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb135-1476"><a href="simulace3.html#cb135-1476" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb135-1477"><a href="simulace3.html#cb135-1477" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1478"><a href="simulace3.html#cb135-1478" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb135-1479"><a href="simulace3.html#cb135-1479" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb135-1480"><a href="simulace3.html#cb135-1480" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb135-1481"><a href="simulace3.html#cb135-1481" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1482"><a href="simulace3.html#cb135-1482" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-1483"><a href="simulace3.html#cb135-1483" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1484"><a href="simulace3.html#cb135-1484" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1485"><a href="simulace3.html#cb135-1485" tabindex="-1"></a>        </span>
<span id="cb135-1486"><a href="simulace3.html#cb135-1486" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-1487"><a href="simulace3.html#cb135-1487" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb135-1488"><a href="simulace3.html#cb135-1488" tabindex="-1"></a>          </span>
<span id="cb135-1489"><a href="simulace3.html#cb135-1489" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-1490"><a href="simulace3.html#cb135-1490" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb135-1491"><a href="simulace3.html#cb135-1491" tabindex="-1"></a>          </span>
<span id="cb135-1492"><a href="simulace3.html#cb135-1492" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1493"><a href="simulace3.html#cb135-1493" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-1494"><a href="simulace3.html#cb135-1494" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1495"><a href="simulace3.html#cb135-1495" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1496"><a href="simulace3.html#cb135-1496" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1497"><a href="simulace3.html#cb135-1497" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1498"><a href="simulace3.html#cb135-1498" tabindex="-1"></a>          </span>
<span id="cb135-1499"><a href="simulace3.html#cb135-1499" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1500"><a href="simulace3.html#cb135-1500" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-1501"><a href="simulace3.html#cb135-1501" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1502"><a href="simulace3.html#cb135-1502" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1503"><a href="simulace3.html#cb135-1503" tabindex="-1"></a>          </span>
<span id="cb135-1504"><a href="simulace3.html#cb135-1504" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1505"><a href="simulace3.html#cb135-1505" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb135-1506"><a href="simulace3.html#cb135-1506" tabindex="-1"></a>        }</span>
<span id="cb135-1507"><a href="simulace3.html#cb135-1507" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb135-1508"><a href="simulace3.html#cb135-1508" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb135-1509"><a href="simulace3.html#cb135-1509" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1510"><a href="simulace3.html#cb135-1510" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb135-1511"><a href="simulace3.html#cb135-1511" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb135-1512"><a href="simulace3.html#cb135-1512" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1513"><a href="simulace3.html#cb135-1513" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb135-1514"><a href="simulace3.html#cb135-1514" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb135-1515"><a href="simulace3.html#cb135-1515" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1516"><a href="simulace3.html#cb135-1516" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb135-1517"><a href="simulace3.html#cb135-1517" tabindex="-1"></a>      }</span>
<span id="cb135-1518"><a href="simulace3.html#cb135-1518" tabindex="-1"></a>    }</span>
<span id="cb135-1519"><a href="simulace3.html#cb135-1519" tabindex="-1"></a>  }</span>
<span id="cb135-1520"><a href="simulace3.html#cb135-1520" tabindex="-1"></a>  </span>
<span id="cb135-1521"><a href="simulace3.html#cb135-1521" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb135-1522"><a href="simulace3.html#cb135-1522" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb135-1523"><a href="simulace3.html#cb135-1523" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1524"><a href="simulace3.html#cb135-1524" tabindex="-1"></a>  }</span>
<span id="cb135-1525"><a href="simulace3.html#cb135-1525" tabindex="-1"></a>  </span>
<span id="cb135-1526"><a href="simulace3.html#cb135-1526" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb135-1527"><a href="simulace3.html#cb135-1527" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb135-1528"><a href="simulace3.html#cb135-1528" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb135-1529"><a href="simulace3.html#cb135-1529" tabindex="-1"></a>  gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb135-1530"><a href="simulace3.html#cb135-1530" tabindex="-1"></a>  gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb135-1531"><a href="simulace3.html#cb135-1531" tabindex="-1"></a>  </span>
<span id="cb135-1532"><a href="simulace3.html#cb135-1532" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1533"><a href="simulace3.html#cb135-1533" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1534"><a href="simulace3.html#cb135-1534" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb135-1535"><a href="simulace3.html#cb135-1535" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb135-1536"><a href="simulace3.html#cb135-1536" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb135-1537"><a href="simulace3.html#cb135-1537" tabindex="-1"></a>  </span>
<span id="cb135-1538"><a href="simulace3.html#cb135-1538" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1539"><a href="simulace3.html#cb135-1539" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-1540"><a href="simulace3.html#cb135-1540" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-1541"><a href="simulace3.html#cb135-1541" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb135-1542"><a href="simulace3.html#cb135-1542" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb135-1543"><a href="simulace3.html#cb135-1543" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb135-1544"><a href="simulace3.html#cb135-1544" tabindex="-1"></a>  </span>
<span id="cb135-1545"><a href="simulace3.html#cb135-1545" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">7</span><span class="sc">:</span><span class="dv">9</span>] <span class="ot">&lt;-</span> gamma.opt</span>
<span id="cb135-1546"><a href="simulace3.html#cb135-1546" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">10</span><span class="sc">:</span><span class="dv">12</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb135-1547"><a href="simulace3.html#cb135-1547" tabindex="-1"></a>  </span>
<span id="cb135-1548"><a href="simulace3.html#cb135-1548" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-1549"><a href="simulace3.html#cb135-1549" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-1550"><a href="simulace3.html#cb135-1550" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb135-1551"><a href="simulace3.html#cb135-1551" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb135-1552"><a href="simulace3.html#cb135-1552" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1553"><a href="simulace3.html#cb135-1553" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb135-1554"><a href="simulace3.html#cb135-1554" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb135-1555"><a href="simulace3.html#cb135-1555" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb135-1556"><a href="simulace3.html#cb135-1556" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb135-1557"><a href="simulace3.html#cb135-1557" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1558"><a href="simulace3.html#cb135-1558" tabindex="-1"></a>  </span>
<span id="cb135-1559"><a href="simulace3.html#cb135-1559" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-1560"><a href="simulace3.html#cb135-1560" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1561"><a href="simulace3.html#cb135-1561" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb135-1562"><a href="simulace3.html#cb135-1562" tabindex="-1"></a>    gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb135-1563"><a href="simulace3.html#cb135-1563" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb135-1564"><a href="simulace3.html#cb135-1564" tabindex="-1"></a>    </span>
<span id="cb135-1565"><a href="simulace3.html#cb135-1565" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb135-1566"><a href="simulace3.html#cb135-1566" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-1567"><a href="simulace3.html#cb135-1567" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-1568"><a href="simulace3.html#cb135-1568" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-1569"><a href="simulace3.html#cb135-1569" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb135-1570"><a href="simulace3.html#cb135-1570" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb135-1571"><a href="simulace3.html#cb135-1571" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb135-1572"><a href="simulace3.html#cb135-1572" tabindex="-1"></a>    </span>
<span id="cb135-1573"><a href="simulace3.html#cb135-1573" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb135-1574"><a href="simulace3.html#cb135-1574" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1575"><a href="simulace3.html#cb135-1575" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-1576"><a href="simulace3.html#cb135-1576" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-1577"><a href="simulace3.html#cb135-1577" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-1578"><a href="simulace3.html#cb135-1578" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb135-1579"><a href="simulace3.html#cb135-1579" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-1580"><a href="simulace3.html#cb135-1580" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb135-1581"><a href="simulace3.html#cb135-1581" tabindex="-1"></a>                      <span class="at">gamma =</span> gamma)</span>
<span id="cb135-1582"><a href="simulace3.html#cb135-1582" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb135-1583"><a href="simulace3.html#cb135-1583" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb135-1584"><a href="simulace3.html#cb135-1584" tabindex="-1"></a>    }</span>
<span id="cb135-1585"><a href="simulace3.html#cb135-1585" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb135-1586"><a href="simulace3.html#cb135-1586" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb135-1587"><a href="simulace3.html#cb135-1587" tabindex="-1"></a>    </span>
<span id="cb135-1588"><a href="simulace3.html#cb135-1588" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb135-1589"><a href="simulace3.html#cb135-1589" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-1590"><a href="simulace3.html#cb135-1590" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-1591"><a href="simulace3.html#cb135-1591" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb135-1592"><a href="simulace3.html#cb135-1592" tabindex="-1"></a>    </span>
<span id="cb135-1593"><a href="simulace3.html#cb135-1593" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-1594"><a href="simulace3.html#cb135-1594" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1595"><a href="simulace3.html#cb135-1595" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-1596"><a href="simulace3.html#cb135-1596" tabindex="-1"></a>    }</span>
<span id="cb135-1597"><a href="simulace3.html#cb135-1597" tabindex="-1"></a>    </span>
<span id="cb135-1598"><a href="simulace3.html#cb135-1598" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb135-1599"><a href="simulace3.html#cb135-1599" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb135-1600"><a href="simulace3.html#cb135-1600" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb135-1601"><a href="simulace3.html#cb135-1601" tabindex="-1"></a>  </span>
<span id="cb135-1602"><a href="simulace3.html#cb135-1602" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1603"><a href="simulace3.html#cb135-1603" tabindex="-1"></a>  </span>
<span id="cb135-1604"><a href="simulace3.html#cb135-1604" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-1605"><a href="simulace3.html#cb135-1605" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb135-1606"><a href="simulace3.html#cb135-1606" tabindex="-1"></a>    </span>
<span id="cb135-1607"><a href="simulace3.html#cb135-1607" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-1608"><a href="simulace3.html#cb135-1608" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-1609"><a href="simulace3.html#cb135-1609" tabindex="-1"></a>    </span>
<span id="cb135-1610"><a href="simulace3.html#cb135-1610" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1611"><a href="simulace3.html#cb135-1611" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-1612"><a href="simulace3.html#cb135-1612" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1613"><a href="simulace3.html#cb135-1613" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1614"><a href="simulace3.html#cb135-1614" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1615"><a href="simulace3.html#cb135-1615" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1616"><a href="simulace3.html#cb135-1616" tabindex="-1"></a>    </span>
<span id="cb135-1617"><a href="simulace3.html#cb135-1617" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1618"><a href="simulace3.html#cb135-1618" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb135-1619"><a href="simulace3.html#cb135-1619" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-1620"><a href="simulace3.html#cb135-1620" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1621"><a href="simulace3.html#cb135-1621" tabindex="-1"></a>      </span>
<span id="cb135-1622"><a href="simulace3.html#cb135-1622" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-1623"><a href="simulace3.html#cb135-1623" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-1624"><a href="simulace3.html#cb135-1624" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1625"><a href="simulace3.html#cb135-1625" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1626"><a href="simulace3.html#cb135-1626" tabindex="-1"></a>    </span>
<span id="cb135-1627"><a href="simulace3.html#cb135-1627" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1628"><a href="simulace3.html#cb135-1628" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb135-1629"><a href="simulace3.html#cb135-1629" tabindex="-1"></a>  }</span>
<span id="cb135-1630"><a href="simulace3.html#cb135-1630" tabindex="-1"></a>  </span>
<span id="cb135-1631"><a href="simulace3.html#cb135-1631" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-1632"><a href="simulace3.html#cb135-1632" tabindex="-1"></a></span>
<span id="cb135-1633"><a href="simulace3.html#cb135-1633" tabindex="-1"></a>  <span class="do">### Polynomialni jadro</span></span>
<span id="cb135-1634"><a href="simulace3.html#cb135-1634" tabindex="-1"></a>  </span>
<span id="cb135-1635"><a href="simulace3.html#cb135-1635" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb135-1636"><a href="simulace3.html#cb135-1636" tabindex="-1"></a>  Poly.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, p) {</span>
<span id="cb135-1637"><a href="simulace3.html#cb135-1637" tabindex="-1"></a>    <span class="fu">return</span>((<span class="dv">1</span> <span class="sc">+</span> x <span class="sc">*</span> y)<span class="sc">^</span>p)</span>
<span id="cb135-1638"><a href="simulace3.html#cb135-1638" tabindex="-1"></a>  }</span>
<span id="cb135-1639"><a href="simulace3.html#cb135-1639" tabindex="-1"></a>  </span>
<span id="cb135-1640"><a href="simulace3.html#cb135-1640" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, p) {</span>
<span id="cb135-1641"><a href="simulace3.html#cb135-1641" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb135-1642"><a href="simulace3.html#cb135-1642" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb135-1643"><a href="simulace3.html#cb135-1643" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb135-1644"><a href="simulace3.html#cb135-1644" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Poly.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], p)</span>
<span id="cb135-1645"><a href="simulace3.html#cb135-1645" tabindex="-1"></a>      }</span>
<span id="cb135-1646"><a href="simulace3.html#cb135-1646" tabindex="-1"></a>    }</span>
<span id="cb135-1647"><a href="simulace3.html#cb135-1647" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb135-1648"><a href="simulace3.html#cb135-1648" tabindex="-1"></a>  }</span>
<span id="cb135-1649"><a href="simulace3.html#cb135-1649" tabindex="-1"></a>  </span>
<span id="cb135-1650"><a href="simulace3.html#cb135-1650" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-1651"><a href="simulace3.html#cb135-1651" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-1652"><a href="simulace3.html#cb135-1652" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-1653"><a href="simulace3.html#cb135-1653" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-1654"><a href="simulace3.html#cb135-1654" tabindex="-1"></a>  </span>
<span id="cb135-1655"><a href="simulace3.html#cb135-1655" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb135-1656"><a href="simulace3.html#cb135-1656" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb135-1657"><a href="simulace3.html#cb135-1657" tabindex="-1"></a>  poly.cv <span class="ot">&lt;-</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb135-1658"><a href="simulace3.html#cb135-1658" tabindex="-1"></a>  </span>
<span id="cb135-1659"><a href="simulace3.html#cb135-1659" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-1660"><a href="simulace3.html#cb135-1660" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-1661"><a href="simulace3.html#cb135-1661" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb135-1662"><a href="simulace3.html#cb135-1662" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro dane p a vrstvy odpovidaji folds</span></span>
<span id="cb135-1663"><a href="simulace3.html#cb135-1663" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">p =</span> <span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, poly.cv),</span>
<span id="cb135-1664"><a href="simulace3.html#cb135-1664" tabindex="-1"></a>                    <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb135-1665"><a href="simulace3.html#cb135-1665" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb135-1666"><a href="simulace3.html#cb135-1666" tabindex="-1"></a>  </span>
<span id="cb135-1667"><a href="simulace3.html#cb135-1667" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-1668"><a href="simulace3.html#cb135-1668" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1669"><a href="simulace3.html#cb135-1669" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1670"><a href="simulace3.html#cb135-1670" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1671"><a href="simulace3.html#cb135-1671" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1672"><a href="simulace3.html#cb135-1672" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(poly.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1673"><a href="simulace3.html#cb135-1673" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb135-1674"><a href="simulace3.html#cb135-1674" tabindex="-1"></a>  </span>
<span id="cb135-1675"><a href="simulace3.html#cb135-1675" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb135-1676"><a href="simulace3.html#cb135-1676" tabindex="-1"></a>  <span class="cf">for</span> (p <span class="cf">in</span> poly.cv) {</span>
<span id="cb135-1677"><a href="simulace3.html#cb135-1677" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb135-1678"><a href="simulace3.html#cb135-1678" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-1679"><a href="simulace3.html#cb135-1679" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-1680"><a href="simulace3.html#cb135-1680" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-1681"><a href="simulace3.html#cb135-1681" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb135-1682"><a href="simulace3.html#cb135-1682" tabindex="-1"></a>    </span>
<span id="cb135-1683"><a href="simulace3.html#cb135-1683" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb135-1684"><a href="simulace3.html#cb135-1684" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1685"><a href="simulace3.html#cb135-1685" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-1686"><a href="simulace3.html#cb135-1686" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-1687"><a href="simulace3.html#cb135-1687" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-1688"><a href="simulace3.html#cb135-1688" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb135-1689"><a href="simulace3.html#cb135-1689" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-1690"><a href="simulace3.html#cb135-1690" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb135-1691"><a href="simulace3.html#cb135-1691" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1692"><a href="simulace3.html#cb135-1692" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb135-1693"><a href="simulace3.html#cb135-1693" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb135-1694"><a href="simulace3.html#cb135-1694" tabindex="-1"></a>    }</span>
<span id="cb135-1695"><a href="simulace3.html#cb135-1695" tabindex="-1"></a>    </span>
<span id="cb135-1696"><a href="simulace3.html#cb135-1696" tabindex="-1"></a>    <span class="co"># projdeme dimenze</span></span>
<span id="cb135-1697"><a href="simulace3.html#cb135-1697" tabindex="-1"></a>    <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb135-1698"><a href="simulace3.html#cb135-1698" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-1699"><a href="simulace3.html#cb135-1699" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-1700"><a href="simulace3.html#cb135-1700" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb135-1701"><a href="simulace3.html#cb135-1701" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-1702"><a href="simulace3.html#cb135-1702" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1703"><a href="simulace3.html#cb135-1703" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb135-1704"><a href="simulace3.html#cb135-1704" tabindex="-1"></a>                               alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-1705"><a href="simulace3.html#cb135-1705" tabindex="-1"></a>      }</span>
<span id="cb135-1706"><a href="simulace3.html#cb135-1706" tabindex="-1"></a>      <span class="co"># projdeme folds</span></span>
<span id="cb135-1707"><a href="simulace3.html#cb135-1707" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-1708"><a href="simulace3.html#cb135-1708" tabindex="-1"></a>        <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-1709"><a href="simulace3.html#cb135-1709" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-1710"><a href="simulace3.html#cb135-1710" tabindex="-1"></a>        <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb135-1711"><a href="simulace3.html#cb135-1711" tabindex="-1"></a>        XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb135-1712"><a href="simulace3.html#cb135-1712" tabindex="-1"></a>        XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb135-1713"><a href="simulace3.html#cb135-1713" tabindex="-1"></a>        <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1714"><a href="simulace3.html#cb135-1714" tabindex="-1"></a>        Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb135-1715"><a href="simulace3.html#cb135-1715" tabindex="-1"></a>                                    <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb135-1716"><a href="simulace3.html#cb135-1716" tabindex="-1"></a>                                    <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb135-1717"><a href="simulace3.html#cb135-1717" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1718"><a href="simulace3.html#cb135-1718" tabindex="-1"></a>        <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-1719"><a href="simulace3.html#cb135-1719" tabindex="-1"></a>        <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1720"><a href="simulace3.html#cb135-1720" tabindex="-1"></a>          kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1721"><a href="simulace3.html#cb135-1721" tabindex="-1"></a>        </span>
<span id="cb135-1722"><a href="simulace3.html#cb135-1722" tabindex="-1"></a>          data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-1723"><a href="simulace3.html#cb135-1723" tabindex="-1"></a>          data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb135-1724"><a href="simulace3.html#cb135-1724" tabindex="-1"></a>          </span>
<span id="cb135-1725"><a href="simulace3.html#cb135-1725" tabindex="-1"></a>          data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-1726"><a href="simulace3.html#cb135-1726" tabindex="-1"></a>          data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb135-1727"><a href="simulace3.html#cb135-1727" tabindex="-1"></a>          </span>
<span id="cb135-1728"><a href="simulace3.html#cb135-1728" tabindex="-1"></a>          <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1729"><a href="simulace3.html#cb135-1729" tabindex="-1"></a>          clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-1730"><a href="simulace3.html#cb135-1730" tabindex="-1"></a>                              <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1731"><a href="simulace3.html#cb135-1731" tabindex="-1"></a>                              <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1732"><a href="simulace3.html#cb135-1732" tabindex="-1"></a>                              <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1733"><a href="simulace3.html#cb135-1733" tabindex="-1"></a>                              <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1734"><a href="simulace3.html#cb135-1734" tabindex="-1"></a>          </span>
<span id="cb135-1735"><a href="simulace3.html#cb135-1735" tabindex="-1"></a>          <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1736"><a href="simulace3.html#cb135-1736" tabindex="-1"></a>          predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-1737"><a href="simulace3.html#cb135-1737" tabindex="-1"></a>          presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1738"><a href="simulace3.html#cb135-1738" tabindex="-1"></a>            <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1739"><a href="simulace3.html#cb135-1739" tabindex="-1"></a>          </span>
<span id="cb135-1740"><a href="simulace3.html#cb135-1740" tabindex="-1"></a>          <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1741"><a href="simulace3.html#cb135-1741" tabindex="-1"></a>          Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb135-1742"><a href="simulace3.html#cb135-1742" tabindex="-1"></a>        }</span>
<span id="cb135-1743"><a href="simulace3.html#cb135-1743" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb135-1744"><a href="simulace3.html#cb135-1744" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb135-1745"><a href="simulace3.html#cb135-1745" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1746"><a href="simulace3.html#cb135-1746" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb135-1747"><a href="simulace3.html#cb135-1747" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb135-1748"><a href="simulace3.html#cb135-1748" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1749"><a href="simulace3.html#cb135-1749" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb135-1750"><a href="simulace3.html#cb135-1750" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;p:&#39;</span>, p), </span>
<span id="cb135-1751"><a href="simulace3.html#cb135-1751" tabindex="-1"></a>                         <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1752"><a href="simulace3.html#cb135-1752" tabindex="-1"></a>                         index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb135-1753"><a href="simulace3.html#cb135-1753" tabindex="-1"></a>      }</span>
<span id="cb135-1754"><a href="simulace3.html#cb135-1754" tabindex="-1"></a>    }</span>
<span id="cb135-1755"><a href="simulace3.html#cb135-1755" tabindex="-1"></a>  }</span>
<span id="cb135-1756"><a href="simulace3.html#cb135-1756" tabindex="-1"></a>  </span>
<span id="cb135-1757"><a href="simulace3.html#cb135-1757" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb135-1758"><a href="simulace3.html#cb135-1758" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb135-1759"><a href="simulace3.html#cb135-1759" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb135-1760"><a href="simulace3.html#cb135-1760" tabindex="-1"></a>  }</span>
<span id="cb135-1761"><a href="simulace3.html#cb135-1761" tabindex="-1"></a>  </span>
<span id="cb135-1762"><a href="simulace3.html#cb135-1762" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb135-1763"><a href="simulace3.html#cb135-1763" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv), </span>
<span id="cb135-1764"><a href="simulace3.html#cb135-1764" tabindex="-1"></a>                 <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(poly.cv))</span>
<span id="cb135-1765"><a href="simulace3.html#cb135-1765" tabindex="-1"></a>  poly.opt[poly.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(poly.cv)</span>
<span id="cb135-1766"><a href="simulace3.html#cb135-1766" tabindex="-1"></a>  poly.opt <span class="ot">&lt;-</span> poly.cv[poly.opt]</span>
<span id="cb135-1767"><a href="simulace3.html#cb135-1767" tabindex="-1"></a>  </span>
<span id="cb135-1768"><a href="simulace3.html#cb135-1768" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1769"><a href="simulace3.html#cb135-1769" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1770"><a href="simulace3.html#cb135-1770" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb135-1771"><a href="simulace3.html#cb135-1771" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb135-1772"><a href="simulace3.html#cb135-1772" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb135-1773"><a href="simulace3.html#cb135-1773" tabindex="-1"></a>  </span>
<span id="cb135-1774"><a href="simulace3.html#cb135-1774" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1775"><a href="simulace3.html#cb135-1775" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-1776"><a href="simulace3.html#cb135-1776" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-1777"><a href="simulace3.html#cb135-1777" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">p =</span> poly.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb135-1778"><a href="simulace3.html#cb135-1778" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb135-1779"><a href="simulace3.html#cb135-1779" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb135-1780"><a href="simulace3.html#cb135-1780" tabindex="-1"></a>  </span>
<span id="cb135-1781"><a href="simulace3.html#cb135-1781" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">13</span><span class="sc">:</span><span class="dv">15</span>] <span class="ot">&lt;-</span> poly.opt</span>
<span id="cb135-1782"><a href="simulace3.html#cb135-1782" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">16</span><span class="sc">:</span><span class="dv">18</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb135-1783"><a href="simulace3.html#cb135-1783" tabindex="-1"></a>  </span>
<span id="cb135-1784"><a href="simulace3.html#cb135-1784" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-1785"><a href="simulace3.html#cb135-1785" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-1786"><a href="simulace3.html#cb135-1786" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb135-1787"><a href="simulace3.html#cb135-1787" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb135-1788"><a href="simulace3.html#cb135-1788" tabindex="-1"></a>  </span>
<span id="cb135-1789"><a href="simulace3.html#cb135-1789" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1790"><a href="simulace3.html#cb135-1790" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - poly&#39;</span>, </span>
<span id="cb135-1791"><a href="simulace3.html#cb135-1791" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - poly&#39;</span>, </span>
<span id="cb135-1792"><a href="simulace3.html#cb135-1792" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - poly&#39;</span>), </span>
<span id="cb135-1793"><a href="simulace3.html#cb135-1793" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb135-1794"><a href="simulace3.html#cb135-1794" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1795"><a href="simulace3.html#cb135-1795" tabindex="-1"></a>  </span>
<span id="cb135-1796"><a href="simulace3.html#cb135-1796" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-1797"><a href="simulace3.html#cb135-1797" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1798"><a href="simulace3.html#cb135-1798" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb135-1799"><a href="simulace3.html#cb135-1799" tabindex="-1"></a>    p <span class="ot">&lt;-</span> poly.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb135-1800"><a href="simulace3.html#cb135-1800" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">p =</span> p)</span>
<span id="cb135-1801"><a href="simulace3.html#cb135-1801" tabindex="-1"></a>    </span>
<span id="cb135-1802"><a href="simulace3.html#cb135-1802" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb135-1803"><a href="simulace3.html#cb135-1803" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-1804"><a href="simulace3.html#cb135-1804" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-1805"><a href="simulace3.html#cb135-1805" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-1806"><a href="simulace3.html#cb135-1806" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb135-1807"><a href="simulace3.html#cb135-1807" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb135-1808"><a href="simulace3.html#cb135-1808" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb135-1809"><a href="simulace3.html#cb135-1809" tabindex="-1"></a>    </span>
<span id="cb135-1810"><a href="simulace3.html#cb135-1810" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb135-1811"><a href="simulace3.html#cb135-1811" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1812"><a href="simulace3.html#cb135-1812" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-1813"><a href="simulace3.html#cb135-1813" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-1814"><a href="simulace3.html#cb135-1814" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-1815"><a href="simulace3.html#cb135-1815" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>,</span>
<span id="cb135-1816"><a href="simulace3.html#cb135-1816" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-1817"><a href="simulace3.html#cb135-1817" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb135-1818"><a href="simulace3.html#cb135-1818" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1819"><a href="simulace3.html#cb135-1819" tabindex="-1"></a>                      <span class="at">degree =</span> p)</span>
<span id="cb135-1820"><a href="simulace3.html#cb135-1820" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb135-1821"><a href="simulace3.html#cb135-1821" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb135-1822"><a href="simulace3.html#cb135-1822" tabindex="-1"></a>    }</span>
<span id="cb135-1823"><a href="simulace3.html#cb135-1823" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb135-1824"><a href="simulace3.html#cb135-1824" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb135-1825"><a href="simulace3.html#cb135-1825" tabindex="-1"></a>    </span>
<span id="cb135-1826"><a href="simulace3.html#cb135-1826" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb135-1827"><a href="simulace3.html#cb135-1827" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-1828"><a href="simulace3.html#cb135-1828" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-1829"><a href="simulace3.html#cb135-1829" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb135-1830"><a href="simulace3.html#cb135-1830" tabindex="-1"></a>    </span>
<span id="cb135-1831"><a href="simulace3.html#cb135-1831" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-1832"><a href="simulace3.html#cb135-1832" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1833"><a href="simulace3.html#cb135-1833" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-1834"><a href="simulace3.html#cb135-1834" tabindex="-1"></a>    }</span>
<span id="cb135-1835"><a href="simulace3.html#cb135-1835" tabindex="-1"></a>    </span>
<span id="cb135-1836"><a href="simulace3.html#cb135-1836" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb135-1837"><a href="simulace3.html#cb135-1837" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb135-1838"><a href="simulace3.html#cb135-1838" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb135-1839"><a href="simulace3.html#cb135-1839" tabindex="-1"></a>  </span>
<span id="cb135-1840"><a href="simulace3.html#cb135-1840" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1841"><a href="simulace3.html#cb135-1841" tabindex="-1"></a>  </span>
<span id="cb135-1842"><a href="simulace3.html#cb135-1842" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-1843"><a href="simulace3.html#cb135-1843" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb135-1844"><a href="simulace3.html#cb135-1844" tabindex="-1"></a>    </span>
<span id="cb135-1845"><a href="simulace3.html#cb135-1845" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-1846"><a href="simulace3.html#cb135-1846" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-1847"><a href="simulace3.html#cb135-1847" tabindex="-1"></a>    </span>
<span id="cb135-1848"><a href="simulace3.html#cb135-1848" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1849"><a href="simulace3.html#cb135-1849" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-1850"><a href="simulace3.html#cb135-1850" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1851"><a href="simulace3.html#cb135-1851" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1852"><a href="simulace3.html#cb135-1852" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1853"><a href="simulace3.html#cb135-1853" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1854"><a href="simulace3.html#cb135-1854" tabindex="-1"></a>    </span>
<span id="cb135-1855"><a href="simulace3.html#cb135-1855" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-1856"><a href="simulace3.html#cb135-1856" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb135-1857"><a href="simulace3.html#cb135-1857" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-1858"><a href="simulace3.html#cb135-1858" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1859"><a href="simulace3.html#cb135-1859" tabindex="-1"></a>      </span>
<span id="cb135-1860"><a href="simulace3.html#cb135-1860" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-1861"><a href="simulace3.html#cb135-1861" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-1862"><a href="simulace3.html#cb135-1862" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1863"><a href="simulace3.html#cb135-1863" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1864"><a href="simulace3.html#cb135-1864" tabindex="-1"></a>    </span>
<span id="cb135-1865"><a href="simulace3.html#cb135-1865" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1866"><a href="simulace3.html#cb135-1866" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb135-1867"><a href="simulace3.html#cb135-1867" tabindex="-1"></a>  }</span>
<span id="cb135-1868"><a href="simulace3.html#cb135-1868" tabindex="-1"></a>  </span>
<span id="cb135-1869"><a href="simulace3.html#cb135-1869" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-1870"><a href="simulace3.html#cb135-1870" tabindex="-1"></a>  </span>
<span id="cb135-1871"><a href="simulace3.html#cb135-1871" tabindex="-1"></a>  <span class="do">### Linearni jadro</span></span>
<span id="cb135-1872"><a href="simulace3.html#cb135-1872" tabindex="-1"></a>  </span>
<span id="cb135-1873"><a href="simulace3.html#cb135-1873" tabindex="-1"></a>  <span class="co"># jadro a jadrova matice ... polynomialni s parametrem p</span></span>
<span id="cb135-1874"><a href="simulace3.html#cb135-1874" tabindex="-1"></a>  Linear.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) {</span>
<span id="cb135-1875"><a href="simulace3.html#cb135-1875" tabindex="-1"></a>    <span class="fu">return</span>(x <span class="sc">*</span> y)</span>
<span id="cb135-1876"><a href="simulace3.html#cb135-1876" tabindex="-1"></a>  }</span>
<span id="cb135-1877"><a href="simulace3.html#cb135-1877" tabindex="-1"></a>  </span>
<span id="cb135-1878"><a href="simulace3.html#cb135-1878" tabindex="-1"></a>  Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {</span>
<span id="cb135-1879"><a href="simulace3.html#cb135-1879" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb135-1880"><a href="simulace3.html#cb135-1880" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb135-1881"><a href="simulace3.html#cb135-1881" tabindex="-1"></a>      <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb135-1882"><a href="simulace3.html#cb135-1882" tabindex="-1"></a>        K[i, j] <span class="ot">&lt;-</span> <span class="fu">Linear.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j])</span>
<span id="cb135-1883"><a href="simulace3.html#cb135-1883" tabindex="-1"></a>      }</span>
<span id="cb135-1884"><a href="simulace3.html#cb135-1884" tabindex="-1"></a>    }</span>
<span id="cb135-1885"><a href="simulace3.html#cb135-1885" tabindex="-1"></a>    <span class="fu">return</span>(K)</span>
<span id="cb135-1886"><a href="simulace3.html#cb135-1886" tabindex="-1"></a>  }</span>
<span id="cb135-1887"><a href="simulace3.html#cb135-1887" tabindex="-1"></a>  </span>
<span id="cb135-1888"><a href="simulace3.html#cb135-1888" tabindex="-1"></a>  <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb135-1889"><a href="simulace3.html#cb135-1889" tabindex="-1"></a>  folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb135-1890"><a href="simulace3.html#cb135-1890" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-1891"><a href="simulace3.html#cb135-1891" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-1892"><a href="simulace3.html#cb135-1892" tabindex="-1"></a>  </span>
<span id="cb135-1893"><a href="simulace3.html#cb135-1893" tabindex="-1"></a>  <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb135-1894"><a href="simulace3.html#cb135-1894" tabindex="-1"></a>  dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">3</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">2</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb135-1895"><a href="simulace3.html#cb135-1895" tabindex="-1"></a>  </span>
<span id="cb135-1896"><a href="simulace3.html#cb135-1896" tabindex="-1"></a>  <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb135-1897"><a href="simulace3.html#cb135-1897" tabindex="-1"></a>  <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb135-1898"><a href="simulace3.html#cb135-1898" tabindex="-1"></a>  <span class="co"># ve sloupcich budou hodnoty presnosti pro dane d</span></span>
<span id="cb135-1899"><a href="simulace3.html#cb135-1899" tabindex="-1"></a>  <span class="co"># v radcich budou hodnoty pro vrstvy odpovidaji folds</span></span>
<span id="cb135-1900"><a href="simulace3.html#cb135-1900" tabindex="-1"></a>  dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb135-1901"><a href="simulace3.html#cb135-1901" tabindex="-1"></a>                    <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb135-1902"><a href="simulace3.html#cb135-1902" tabindex="-1"></a>  </span>
<span id="cb135-1903"><a href="simulace3.html#cb135-1903" tabindex="-1"></a>  CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb135-1904"><a href="simulace3.html#cb135-1904" tabindex="-1"></a>    <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1905"><a href="simulace3.html#cb135-1905" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1906"><a href="simulace3.html#cb135-1906" tabindex="-1"></a>    <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1907"><a href="simulace3.html#cb135-1907" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names),</span>
<span id="cb135-1908"><a href="simulace3.html#cb135-1908" tabindex="-1"></a>    <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb135-1909"><a href="simulace3.html#cb135-1909" tabindex="-1"></a>                  <span class="at">dimnames =</span> dim.names))</span>
<span id="cb135-1910"><a href="simulace3.html#cb135-1910" tabindex="-1"></a>  </span>
<span id="cb135-1911"><a href="simulace3.html#cb135-1911" tabindex="-1"></a>  <span class="co"># samotna CV</span></span>
<span id="cb135-1912"><a href="simulace3.html#cb135-1912" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb135-1913"><a href="simulace3.html#cb135-1913" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-1914"><a href="simulace3.html#cb135-1914" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-1915"><a href="simulace3.html#cb135-1915" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-1916"><a href="simulace3.html#cb135-1916" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb135-1917"><a href="simulace3.html#cb135-1917" tabindex="-1"></a>  </span>
<span id="cb135-1918"><a href="simulace3.html#cb135-1918" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb135-1919"><a href="simulace3.html#cb135-1919" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1920"><a href="simulace3.html#cb135-1920" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-1921"><a href="simulace3.html#cb135-1921" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-1922"><a href="simulace3.html#cb135-1922" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-1923"><a href="simulace3.html#cb135-1923" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb135-1924"><a href="simulace3.html#cb135-1924" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-1925"><a href="simulace3.html#cb135-1925" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb135-1926"><a href="simulace3.html#cb135-1926" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb135-1927"><a href="simulace3.html#cb135-1927" tabindex="-1"></a>  }</span>
<span id="cb135-1928"><a href="simulace3.html#cb135-1928" tabindex="-1"></a>  </span>
<span id="cb135-1929"><a href="simulace3.html#cb135-1929" tabindex="-1"></a>  <span class="co"># projdeme dimenze</span></span>
<span id="cb135-1930"><a href="simulace3.html#cb135-1930" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb135-1931"><a href="simulace3.html#cb135-1931" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-1932"><a href="simulace3.html#cb135-1932" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-1933"><a href="simulace3.html#cb135-1933" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb135-1934"><a href="simulace3.html#cb135-1934" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-1935"><a href="simulace3.html#cb135-1935" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-1936"><a href="simulace3.html#cb135-1936" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb135-1937"><a href="simulace3.html#cb135-1937" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-1938"><a href="simulace3.html#cb135-1938" tabindex="-1"></a>    }</span>
<span id="cb135-1939"><a href="simulace3.html#cb135-1939" tabindex="-1"></a>    <span class="co"># projdeme folds</span></span>
<span id="cb135-1940"><a href="simulace3.html#cb135-1940" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb135-1941"><a href="simulace3.html#cb135-1941" tabindex="-1"></a>      <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb135-1942"><a href="simulace3.html#cb135-1942" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb135-1943"><a href="simulace3.html#cb135-1943" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb135-1944"><a href="simulace3.html#cb135-1944" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb135-1945"><a href="simulace3.html#cb135-1945" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb135-1946"><a href="simulace3.html#cb135-1946" tabindex="-1"></a>      <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-1947"><a href="simulace3.html#cb135-1947" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb135-1948"><a href="simulace3.html#cb135-1948" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb135-1949"><a href="simulace3.html#cb135-1949" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb135-1950"><a href="simulace3.html#cb135-1950" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-1951"><a href="simulace3.html#cb135-1951" tabindex="-1"></a>      <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-1952"><a href="simulace3.html#cb135-1952" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-1953"><a href="simulace3.html#cb135-1953" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-1954"><a href="simulace3.html#cb135-1954" tabindex="-1"></a>      </span>
<span id="cb135-1955"><a href="simulace3.html#cb135-1955" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-1956"><a href="simulace3.html#cb135-1956" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb135-1957"><a href="simulace3.html#cb135-1957" tabindex="-1"></a>        </span>
<span id="cb135-1958"><a href="simulace3.html#cb135-1958" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-1959"><a href="simulace3.html#cb135-1959" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb135-1960"><a href="simulace3.html#cb135-1960" tabindex="-1"></a>        </span>
<span id="cb135-1961"><a href="simulace3.html#cb135-1961" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-1962"><a href="simulace3.html#cb135-1962" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-1963"><a href="simulace3.html#cb135-1963" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-1964"><a href="simulace3.html#cb135-1964" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-1965"><a href="simulace3.html#cb135-1965" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-1966"><a href="simulace3.html#cb135-1966" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-1967"><a href="simulace3.html#cb135-1967" tabindex="-1"></a>        </span>
<span id="cb135-1968"><a href="simulace3.html#cb135-1968" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb135-1969"><a href="simulace3.html#cb135-1969" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-1970"><a href="simulace3.html#cb135-1970" tabindex="-1"></a>        presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-1971"><a href="simulace3.html#cb135-1971" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-1972"><a href="simulace3.html#cb135-1972" tabindex="-1"></a>        </span>
<span id="cb135-1973"><a href="simulace3.html#cb135-1973" tabindex="-1"></a>        <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-1974"><a href="simulace3.html#cb135-1974" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb135-1975"><a href="simulace3.html#cb135-1975" tabindex="-1"></a>      }</span>
<span id="cb135-1976"><a href="simulace3.html#cb135-1976" tabindex="-1"></a>      <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb135-1977"><a href="simulace3.html#cb135-1977" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1978"><a href="simulace3.html#cb135-1978" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb135-1979"><a href="simulace3.html#cb135-1979" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1980"><a href="simulace3.html#cb135-1980" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb135-1981"><a href="simulace3.html#cb135-1981" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb135-1982"><a href="simulace3.html#cb135-1982" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb135-1983"><a href="simulace3.html#cb135-1983" tabindex="-1"></a>    }</span>
<span id="cb135-1984"><a href="simulace3.html#cb135-1984" tabindex="-1"></a>  }</span>
<span id="cb135-1985"><a href="simulace3.html#cb135-1985" tabindex="-1"></a>  </span>
<span id="cb135-1986"><a href="simulace3.html#cb135-1986" tabindex="-1"></a>  <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb135-1987"><a href="simulace3.html#cb135-1987" tabindex="-1"></a>  <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb135-1988"><a href="simulace3.html#cb135-1988" tabindex="-1"></a>    CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb135-1989"><a href="simulace3.html#cb135-1989" tabindex="-1"></a>  }</span>
<span id="cb135-1990"><a href="simulace3.html#cb135-1990" tabindex="-1"></a>  </span>
<span id="cb135-1991"><a href="simulace3.html#cb135-1991" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1992"><a href="simulace3.html#cb135-1992" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb135-1993"><a href="simulace3.html#cb135-1993" tabindex="-1"></a>             <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb135-1994"><a href="simulace3.html#cb135-1994" tabindex="-1"></a>  d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb135-1995"><a href="simulace3.html#cb135-1995" tabindex="-1"></a>  d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb135-1996"><a href="simulace3.html#cb135-1996" tabindex="-1"></a>  </span>
<span id="cb135-1997"><a href="simulace3.html#cb135-1997" tabindex="-1"></a>  err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb135-1998"><a href="simulace3.html#cb135-1998" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb135-1999"><a href="simulace3.html#cb135-1999" tabindex="-1"></a>                       <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb135-2000"><a href="simulace3.html#cb135-2000" tabindex="-1"></a>  df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb135-2001"><a href="simulace3.html#cb135-2001" tabindex="-1"></a>             <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb135-2002"><a href="simulace3.html#cb135-2002" tabindex="-1"></a>             <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb135-2003"><a href="simulace3.html#cb135-2003" tabindex="-1"></a>  </span>
<span id="cb135-2004"><a href="simulace3.html#cb135-2004" tabindex="-1"></a>  CV_RESULTS[sim, <span class="dv">19</span><span class="sc">:</span><span class="dv">21</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb135-2005"><a href="simulace3.html#cb135-2005" tabindex="-1"></a>  </span>
<span id="cb135-2006"><a href="simulace3.html#cb135-2006" tabindex="-1"></a>  <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb135-2007"><a href="simulace3.html#cb135-2007" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb135-2008"><a href="simulace3.html#cb135-2008" tabindex="-1"></a>  <span class="co"># pridame i testovaci data</span></span>
<span id="cb135-2009"><a href="simulace3.html#cb135-2009" tabindex="-1"></a>  data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb135-2010"><a href="simulace3.html#cb135-2010" tabindex="-1"></a>  </span>
<span id="cb135-2011"><a href="simulace3.html#cb135-2011" tabindex="-1"></a>  <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb135-2012"><a href="simulace3.html#cb135-2012" tabindex="-1"></a>  Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - linear&#39;</span>, </span>
<span id="cb135-2013"><a href="simulace3.html#cb135-2013" tabindex="-1"></a>                              <span class="st">&#39;SVM poly - RKHS - linear&#39;</span>, </span>
<span id="cb135-2014"><a href="simulace3.html#cb135-2014" tabindex="-1"></a>                              <span class="st">&#39;SVM rbf - RKHS - linear&#39;</span>), </span>
<span id="cb135-2015"><a href="simulace3.html#cb135-2015" tabindex="-1"></a>                    <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb135-2016"><a href="simulace3.html#cb135-2016" tabindex="-1"></a>                    <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb135-2017"><a href="simulace3.html#cb135-2017" tabindex="-1"></a>  </span>
<span id="cb135-2018"><a href="simulace3.html#cb135-2018" tabindex="-1"></a>  <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb135-2019"><a href="simulace3.html#cb135-2019" tabindex="-1"></a>  <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb135-2020"><a href="simulace3.html#cb135-2020" tabindex="-1"></a>    <span class="co"># spocitame matici K</span></span>
<span id="cb135-2021"><a href="simulace3.html#cb135-2021" tabindex="-1"></a>    K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq)</span>
<span id="cb135-2022"><a href="simulace3.html#cb135-2022" tabindex="-1"></a>    </span>
<span id="cb135-2023"><a href="simulace3.html#cb135-2023" tabindex="-1"></a>    <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb135-2024"><a href="simulace3.html#cb135-2024" tabindex="-1"></a>    Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb135-2025"><a href="simulace3.html#cb135-2025" tabindex="-1"></a>    eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb135-2026"><a href="simulace3.html#cb135-2026" tabindex="-1"></a>    eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb135-2027"><a href="simulace3.html#cb135-2027" tabindex="-1"></a>    <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb135-2028"><a href="simulace3.html#cb135-2028" tabindex="-1"></a>    alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb135-2029"><a href="simulace3.html#cb135-2029" tabindex="-1"></a>                         <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb135-2030"><a href="simulace3.html#cb135-2030" tabindex="-1"></a>    </span>
<span id="cb135-2031"><a href="simulace3.html#cb135-2031" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb135-2032"><a href="simulace3.html#cb135-2032" tabindex="-1"></a>    <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-2033"><a href="simulace3.html#cb135-2033" tabindex="-1"></a>      df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb135-2034"><a href="simulace3.html#cb135-2034" tabindex="-1"></a>                           <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb135-2035"><a href="simulace3.html#cb135-2035" tabindex="-1"></a>      svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb135-2036"><a href="simulace3.html#cb135-2036" tabindex="-1"></a>                      <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>,</span>
<span id="cb135-2037"><a href="simulace3.html#cb135-2037" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb135-2038"><a href="simulace3.html#cb135-2038" tabindex="-1"></a>                      <span class="at">epsilon =</span> <span class="fl">0.1</span>)</span>
<span id="cb135-2039"><a href="simulace3.html#cb135-2039" tabindex="-1"></a>      <span class="co"># urceni alpha</span></span>
<span id="cb135-2040"><a href="simulace3.html#cb135-2040" tabindex="-1"></a>      alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb135-2041"><a href="simulace3.html#cb135-2041" tabindex="-1"></a>    }</span>
<span id="cb135-2042"><a href="simulace3.html#cb135-2042" tabindex="-1"></a>    <span class="co"># d</span></span>
<span id="cb135-2043"><a href="simulace3.html#cb135-2043" tabindex="-1"></a>    d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb135-2044"><a href="simulace3.html#cb135-2044" tabindex="-1"></a>    </span>
<span id="cb135-2045"><a href="simulace3.html#cb135-2045" tabindex="-1"></a>    <span class="co"># urceni vektoru lambda</span></span>
<span id="cb135-2046"><a href="simulace3.html#cb135-2046" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb135-2047"><a href="simulace3.html#cb135-2047" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb135-2048"><a href="simulace3.html#cb135-2048" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb135-2049"><a href="simulace3.html#cb135-2049" tabindex="-1"></a>    </span>
<span id="cb135-2050"><a href="simulace3.html#cb135-2050" tabindex="-1"></a>    <span class="co"># vypocet reprezentace</span></span>
<span id="cb135-2051"><a href="simulace3.html#cb135-2051" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb135-2052"><a href="simulace3.html#cb135-2052" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb135-2053"><a href="simulace3.html#cb135-2053" tabindex="-1"></a>    }</span>
<span id="cb135-2054"><a href="simulace3.html#cb135-2054" tabindex="-1"></a>    </span>
<span id="cb135-2055"><a href="simulace3.html#cb135-2055" tabindex="-1"></a>    <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb135-2056"><a href="simulace3.html#cb135-2056" tabindex="-1"></a>    XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb135-2057"><a href="simulace3.html#cb135-2057" tabindex="-1"></a>    XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb135-2058"><a href="simulace3.html#cb135-2058" tabindex="-1"></a>  </span>
<span id="cb135-2059"><a href="simulace3.html#cb135-2059" tabindex="-1"></a>    kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb135-2060"><a href="simulace3.html#cb135-2060" tabindex="-1"></a>  </span>
<span id="cb135-2061"><a href="simulace3.html#cb135-2061" tabindex="-1"></a>    data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb135-2062"><a href="simulace3.html#cb135-2062" tabindex="-1"></a>    data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb135-2063"><a href="simulace3.html#cb135-2063" tabindex="-1"></a>    </span>
<span id="cb135-2064"><a href="simulace3.html#cb135-2064" tabindex="-1"></a>    data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb135-2065"><a href="simulace3.html#cb135-2065" tabindex="-1"></a>    data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb135-2066"><a href="simulace3.html#cb135-2066" tabindex="-1"></a>    </span>
<span id="cb135-2067"><a href="simulace3.html#cb135-2067" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb135-2068"><a href="simulace3.html#cb135-2068" tabindex="-1"></a>    clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb135-2069"><a href="simulace3.html#cb135-2069" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb135-2070"><a href="simulace3.html#cb135-2070" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb135-2071"><a href="simulace3.html#cb135-2071" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb135-2072"><a href="simulace3.html#cb135-2072" tabindex="-1"></a>                        <span class="at">kernel =</span> kernel_type)</span>
<span id="cb135-2073"><a href="simulace3.html#cb135-2073" tabindex="-1"></a>    </span>
<span id="cb135-2074"><a href="simulace3.html#cb135-2074" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb135-2075"><a href="simulace3.html#cb135-2075" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb135-2076"><a href="simulace3.html#cb135-2076" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb135-2077"><a href="simulace3.html#cb135-2077" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-2078"><a href="simulace3.html#cb135-2078" tabindex="-1"></a>      </span>
<span id="cb135-2079"><a href="simulace3.html#cb135-2079" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb135-2080"><a href="simulace3.html#cb135-2080" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb135-2081"><a href="simulace3.html#cb135-2081" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb135-2082"><a href="simulace3.html#cb135-2082" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb135-2083"><a href="simulace3.html#cb135-2083" tabindex="-1"></a>    </span>
<span id="cb135-2084"><a href="simulace3.html#cb135-2084" tabindex="-1"></a>    <span class="co"># ulozeni vysledku</span></span>
<span id="cb135-2085"><a href="simulace3.html#cb135-2085" tabindex="-1"></a>    Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb135-2086"><a href="simulace3.html#cb135-2086" tabindex="-1"></a>  }</span>
<span id="cb135-2087"><a href="simulace3.html#cb135-2087" tabindex="-1"></a>  </span>
<span id="cb135-2088"><a href="simulace3.html#cb135-2088" tabindex="-1"></a>  RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb135-2089"><a href="simulace3.html#cb135-2089" tabindex="-1"></a>  </span>
<span id="cb135-2090"><a href="simulace3.html#cb135-2090" tabindex="-1"></a>  <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb135-2091"><a href="simulace3.html#cb135-2091" tabindex="-1"></a>  </span>
<span id="cb135-2092"><a href="simulace3.html#cb135-2092" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb135-2093"><a href="simulace3.html#cb135-2093" tabindex="-1"></a>  SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb135-2094"><a href="simulace3.html#cb135-2094" tabindex="-1"></a>  </span>
<span id="cb135-2095"><a href="simulace3.html#cb135-2095" tabindex="-1"></a>  <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, sim)</span>
<span id="cb135-2096"><a href="simulace3.html#cb135-2096" tabindex="-1"></a>}</span>
<span id="cb135-2097"><a href="simulace3.html#cb135-2097" tabindex="-1"></a></span>
<span id="cb135-2098"><a href="simulace3.html#cb135-2098" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb135-2099"><a href="simulace3.html#cb135-2099" tabindex="-1"></a><span class="fu">save</span>(SIMULACE, CV_RESULTS, <span class="at">file =</span> <span class="st">&#39;RData/simulace_03_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<p>Now we will calculate the average training and testing error rates for individual classification methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb136"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb136-1"><a href="simulace3.html#cb136-1" tabindex="-1"></a><span class="co"># Add to the final table</span></span>
<span id="cb136-2"><a href="simulace3.html#cb136-2" tabindex="-1"></a></span>
<span id="cb136-3"><a href="simulace3.html#cb136-3" tabindex="-1"></a>SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb136-4"><a href="simulace3.html#cb136-4" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb136-5"><a href="simulace3.html#cb136-5" tabindex="-1"></a>                          <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb136-6"><a href="simulace3.html#cb136-6" tabindex="-1"></a>                          <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb136-7"><a href="simulace3.html#cb136-7" tabindex="-1"></a></span>
<span id="cb136-8"><a href="simulace3.html#cb136-8" tabindex="-1"></a><span class="co"># Save the resulting values </span></span>
<span id="cb136-9"><a href="simulace3.html#cb136-9" tabindex="-1"></a><span class="fu">save</span>(SIMULACE.df, <span class="at">file =</span> <span class="st">&#39;RData/simulace_03_res_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="results" class="section level3 hasAnchor" number="1.4.1">
<h3><span class="header-section-number">1.4.1</span> Results<a href="simulace3.html#results" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-136">Table 1.9: </span>Summary results of the methods used on the simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error, <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error, <span class="math inline">\(\widehat{SD}_{train}\)</span> the estimate of the standard deviation of training errors, and <span class="math inline">\(\widehat{SD}_{test}\)</span> the estimate of the standard deviation of testing errors.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{test}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{train}\)</span></th>
<th align="right"><span class="math inline">\(\widehat{SD}_{test}\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN</td>
<td align="right">0.3604</td>
<td align="right">0.3917</td>
<td align="right">0.0469</td>
<td align="right">0.0686</td>
</tr>
<tr class="even">
<td>LDA</td>
<td align="right">0.3599</td>
<td align="right">0.3950</td>
<td align="right">0.0664</td>
<td align="right">0.0935</td>
</tr>
<tr class="odd">
<td>QDA</td>
<td align="right">0.3534</td>
<td align="right">0.3953</td>
<td align="right">0.0651</td>
<td align="right">0.0897</td>
</tr>
<tr class="even">
<td>LR_functional</td>
<td align="right">0.0349</td>
<td align="right">0.1083</td>
<td align="right">0.0303</td>
<td align="right">0.0513</td>
</tr>
<tr class="odd">
<td>LR_score</td>
<td align="right">0.3595</td>
<td align="right">0.3950</td>
<td align="right">0.0664</td>
<td align="right">0.0935</td>
</tr>
<tr class="even">
<td>Tree_discr</td>
<td align="right">0.2736</td>
<td align="right">0.4250</td>
<td align="right">0.0713</td>
<td align="right">0.0743</td>
</tr>
<tr class="odd">
<td>Tree_score</td>
<td align="right">0.3307</td>
<td align="right">0.4217</td>
<td align="right">0.0797</td>
<td align="right">0.0978</td>
</tr>
<tr class="even">
<td>Tree_Bbasis</td>
<td align="right">0.2732</td>
<td align="right">0.4222</td>
<td align="right">0.0728</td>
<td align="right">0.0770</td>
</tr>
<tr class="odd">
<td>RF_discr</td>
<td align="right">0.0102</td>
<td align="right">0.3487</td>
<td align="right">0.0077</td>
<td align="right">0.0663</td>
</tr>
<tr class="even">
<td>RF_score</td>
<td align="right">0.0519</td>
<td align="right">0.4252</td>
<td align="right">0.0176</td>
<td align="right">0.0859</td>
</tr>
<tr class="odd">
<td>RF_Bbasis</td>
<td align="right">0.0105</td>
<td align="right">0.3395</td>
<td align="right">0.0082</td>
<td align="right">0.0624</td>
</tr>
<tr class="even">
<td>SVM linear - func</td>
<td align="right">0.0507</td>
<td align="right">0.1218</td>
<td align="right">0.0346</td>
<td align="right">0.0503</td>
</tr>
<tr class="odd">
<td>SVM poly - func</td>
<td align="right">0.0421</td>
<td align="right">0.1910</td>
<td align="right">0.0408</td>
<td align="right">0.0498</td>
</tr>
<tr class="even">
<td>SVM rbf - func</td>
<td align="right">0.0508</td>
<td align="right">0.1247</td>
<td align="right">0.0275</td>
<td align="right">0.0487</td>
</tr>
<tr class="odd">
<td>SVM linear - diskr</td>
<td align="right">0.0451</td>
<td align="right">0.1122</td>
<td align="right">0.0305</td>
<td align="right">0.0433</td>
</tr>
<tr class="even">
<td>SVM poly - diskr</td>
<td align="right">0.0483</td>
<td align="right">0.1872</td>
<td align="right">0.0442</td>
<td align="right">0.0492</td>
</tr>
<tr class="odd">
<td>SVM rbf - diskr</td>
<td align="right">0.0504</td>
<td align="right">0.1278</td>
<td align="right">0.0290</td>
<td align="right">0.0495</td>
</tr>
<tr class="even">
<td>SVM linear - PCA</td>
<td align="right">0.3601</td>
<td align="right">0.3970</td>
<td align="right">0.0666</td>
<td align="right">0.0982</td>
</tr>
<tr class="odd">
<td>SVM poly - PCA</td>
<td align="right">0.3465</td>
<td align="right">0.4177</td>
<td align="right">0.0682</td>
<td align="right">0.0960</td>
</tr>
<tr class="even">
<td>SVM rbf - PCA</td>
<td align="right">0.3419</td>
<td align="right">0.3973</td>
<td align="right">0.0637</td>
<td align="right">0.0900</td>
</tr>
<tr class="odd">
<td>SVM linear - Bbasis</td>
<td align="right">0.0442</td>
<td align="right">0.0963</td>
<td align="right">0.0255</td>
<td align="right">0.0437</td>
</tr>
<tr class="even">
<td>SVM poly - Bbasis</td>
<td align="right">0.0472</td>
<td align="right">0.1652</td>
<td align="right">0.0360</td>
<td align="right">0.0502</td>
</tr>
<tr class="odd">
<td>SVM rbf - Bbasis</td>
<td align="right">0.0734</td>
<td align="right">0.1443</td>
<td align="right">0.0366</td>
<td align="right">0.0492</td>
</tr>
<tr class="even">
<td>SVM linear - projection</td>
<td align="right">0.0395</td>
<td align="right">0.0932</td>
<td align="right">0.0208</td>
<td align="right">0.0466</td>
</tr>
<tr class="odd">
<td>SVM poly - projection</td>
<td align="right">0.0264</td>
<td align="right">0.1005</td>
<td align="right">0.0158</td>
<td align="right">0.0441</td>
</tr>
<tr class="even">
<td>SVM rbf - projection</td>
<td align="right">0.0530</td>
<td align="right">0.1035</td>
<td align="right">0.0203</td>
<td align="right">0.0413</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - radial</td>
<td align="right">0.0506</td>
<td align="right">0.1325</td>
<td align="right">0.0252</td>
<td align="right">0.0460</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - radial</td>
<td align="right">0.0165</td>
<td align="right">0.1598</td>
<td align="right">0.0169</td>
<td align="right">0.0442</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - radial</td>
<td align="right">0.0453</td>
<td align="right">0.1420</td>
<td align="right">0.0184</td>
<td align="right">0.0476</td>
</tr>
<tr class="even">
<td>SVM linear - RKHS - poly</td>
<td align="right">0.0759</td>
<td align="right">0.1712</td>
<td align="right">0.0349</td>
<td align="right">0.0551</td>
</tr>
<tr class="odd">
<td>SVM poly - RKHS - poly</td>
<td align="right">0.0331</td>
<td align="right">0.1877</td>
<td align="right">0.0204</td>
<td align="right">0.0535</td>
</tr>
<tr class="even">
<td>SVM rbf - RKHS - poly</td>
<td align="right">0.0755</td>
<td align="right">0.1777</td>
<td align="right">0.0253</td>
<td align="right">0.0581</td>
</tr>
<tr class="odd">
<td>SVM linear - RKHS - linear</td>
<td align="right">0.2539</td>
<td align="right">0.3873</td>
<td align="right">0.0573</td>
<td align="right">0.0721</td>
</tr>
<tr class="even">
<td>SVM poly - RKHS - linear</td>
<td align="right">0.1905</td>
<td align="right">0.3743</td>
<td align="right">0.0479</td>
<td align="right">0.0714</td>
</tr>
<tr class="odd">
<td>SVM rbf - RKHS - linear</td>
<td align="right">0.2516</td>
<td align="right">0.3705</td>
<td align="right">0.0357</td>
<td align="right">0.0656</td>
</tr>
</tbody>
</table>
<p>The table above lists all calculated characteristics. Standard deviations are also provided so that we can compare some stability or variability of individual methods.</p>
<p>Finally, we can graphically display the calculated values from the simulation for individual classification methods using box plots, separately for testing and training error rates.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb137"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb137-1"><a href="simulace3.html#cb137-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb137-2"><a href="simulace3.html#cb137-2" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb137-3"><a href="simulace3.html#cb137-3" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb137-4"><a href="simulace3.html#cb137-4" tabindex="-1"></a>      <span class="st">&#39;Linear discriminant analysis&#39;</span>,</span>
<span id="cb137-5"><a href="simulace3.html#cb137-5" tabindex="-1"></a>      <span class="st">&#39;Quadratic discriminant analysis&#39;</span>,</span>
<span id="cb137-6"><a href="simulace3.html#cb137-6" tabindex="-1"></a>      <span class="st">&#39;Functional logistic regression&#39;</span>,</span>
<span id="cb137-7"><a href="simulace3.html#cb137-7" tabindex="-1"></a>      <span class="st">&#39;Logistic regression with fPCA&#39;</span>,</span>
<span id="cb137-8"><a href="simulace3.html#cb137-8" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- discretization&#39;</span>,</span>
<span id="cb137-9"><a href="simulace3.html#cb137-9" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- fPCA&#39;</span>,</span>
<span id="cb137-10"><a href="simulace3.html#cb137-10" tabindex="-1"></a>      <span class="st">&#39;Decision tree -- basis coefficients&#39;</span>,</span>
<span id="cb137-11"><a href="simulace3.html#cb137-11" tabindex="-1"></a>      <span class="st">&#39;Random forest -- discretization&#39;</span>,</span>
<span id="cb137-12"><a href="simulace3.html#cb137-12" tabindex="-1"></a>      <span class="st">&#39;Random forest -- fPCA&#39;</span>,</span>
<span id="cb137-13"><a href="simulace3.html#cb137-13" tabindex="-1"></a>      <span class="st">&#39;Random forest -- basis coefficients&#39;</span>,</span>
<span id="cb137-14"><a href="simulace3.html#cb137-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- functional&#39;</span>,</span>
<span id="cb137-15"><a href="simulace3.html#cb137-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- functional&#39;</span>,</span>
<span id="cb137-16"><a href="simulace3.html#cb137-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- functional&#39;</span>,</span>
<span id="cb137-17"><a href="simulace3.html#cb137-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- discretization&#39;</span>,</span>
<span id="cb137-18"><a href="simulace3.html#cb137-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- discretization&#39;</span>,</span>
<span id="cb137-19"><a href="simulace3.html#cb137-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- discretization&#39;</span>,</span>
<span id="cb137-20"><a href="simulace3.html#cb137-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb137-21"><a href="simulace3.html#cb137-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb137-22"><a href="simulace3.html#cb137-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb137-23"><a href="simulace3.html#cb137-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- basis coefficients&#39;</span>,</span>
<span id="cb137-24"><a href="simulace3.html#cb137-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- basis coefficients&#39;</span>,</span>
<span id="cb137-25"><a href="simulace3.html#cb137-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- basis coefficients&#39;</span>,</span>
<span id="cb137-26"><a href="simulace3.html#cb137-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- projection&#39;</span>,</span>
<span id="cb137-27"><a href="simulace3.html#cb137-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- projection&#39;</span>,</span>
<span id="cb137-28"><a href="simulace3.html#cb137-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- projection&#39;</span>,</span>
<span id="cb137-29"><a href="simulace3.html#cb137-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb137-30"><a href="simulace3.html#cb137-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb137-31"><a href="simulace3.html#cb137-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb137-32"><a href="simulace3.html#cb137-32" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb137-33"><a href="simulace3.html#cb137-33" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb137-34"><a href="simulace3.html#cb137-34" tabindex="-1"></a>      <span class="st">&#39;RKHS (poly SVR) $+$ SVM (radial)&#39;</span>,</span>
<span id="cb137-35"><a href="simulace3.html#cb137-35" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb137-36"><a href="simulace3.html#cb137-36" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb137-37"><a href="simulace3.html#cb137-37" tabindex="-1"></a>      <span class="st">&#39;RKHS (linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb137-38"><a href="simulace3.html#cb137-38" tabindex="-1"></a>)</span>
<span id="cb137-39"><a href="simulace3.html#cb137-39" tabindex="-1"></a></span>
<span id="cb137-40"><a href="simulace3.html#cb137-40" tabindex="-1"></a></span>
<span id="cb137-41"><a href="simulace3.html#cb137-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb137-42"><a href="simulace3.html#cb137-42" tabindex="-1"></a>box_col <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#0099cc&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb137-43"><a href="simulace3.html#cb137-43" tabindex="-1"></a>             <span class="st">&#39;#1ac5ff&#39;</span>, <span class="fu">rep</span>(<span class="st">&#39;#33ccff&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb137-44"><a href="simulace3.html#cb137-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb137-45"><a href="simulace3.html#cb137-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">9</span>))</span>
<span id="cb137-46"><a href="simulace3.html#cb137-46" tabindex="-1"></a></span>
<span id="cb137-47"><a href="simulace3.html#cb137-47" tabindex="-1"></a><span class="co"># box_col &lt;- c(&#39;#CA0A0A&#39;, &#39;#fa2600&#39;, &#39;#fa2600&#39;, &#39;#D15804&#39;,</span></span>
<span id="cb137-48"><a href="simulace3.html#cb137-48" tabindex="-1"></a><span class="co">#              &#39;#D15804&#39;, rep(&#39;#D3006D&#39;, 3), rep(&#39;#BE090F&#39;, 3), c(&quot;#12DEE8&quot;, &quot;#4ECBF3&quot;, &quot;#127DE8&quot;, &quot;#4C3CD3&quot;, &quot;#4E65F3&quot;, &quot;#4E9EF3&quot;, &quot;#081D58&quot;) |&gt; rep(each = 3))</span></span>
<span id="cb137-49"><a href="simulace3.html#cb137-49" tabindex="-1"></a></span>
<span id="cb137-50"><a href="simulace3.html#cb137-50" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb137-51"><a href="simulace3.html#cb137-51" tabindex="-1"></a>box_alpha <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb137-52"><a href="simulace3.html#cb137-52" tabindex="-1"></a>               <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb137-53"><a href="simulace3.html#cb137-53" tabindex="-1"></a>               <span class="fu">seq</span>(<span class="fl">0.9</span>, <span class="fl">0.6</span>, <span class="at">length =</span> <span class="dv">9</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb138"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb138-1"><a href="simulace3.html#cb138-1" tabindex="-1"></a><span class="co"># Set different names for classification methods</span></span>
<span id="cb138-2"><a href="simulace3.html#cb138-2" tabindex="-1"></a>methods_names1 <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb138-3"><a href="simulace3.html#cb138-3" tabindex="-1"></a>      <span class="st">&#39;$K$NN&#39;</span>,</span>
<span id="cb138-4"><a href="simulace3.html#cb138-4" tabindex="-1"></a>      <span class="co">#&#39;Linear Discriminant Analysis&#39;,</span></span>
<span id="cb138-5"><a href="simulace3.html#cb138-5" tabindex="-1"></a>      <span class="st">&#39;QDA&#39;</span>,</span>
<span id="cb138-6"><a href="simulace3.html#cb138-6" tabindex="-1"></a>      <span class="st">&#39;fLR&#39;</span>,</span>
<span id="cb138-7"><a href="simulace3.html#cb138-7" tabindex="-1"></a>      <span class="st">&#39;LR with fPCA&#39;</span>,</span>
<span id="cb138-8"><a href="simulace3.html#cb138-8" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Discretization&#39;,</span></span>
<span id="cb138-9"><a href="simulace3.html#cb138-9" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- fPCA&#39;,</span></span>
<span id="cb138-10"><a href="simulace3.html#cb138-10" tabindex="-1"></a>      <span class="co">#&#39;Decision Tree -- Basis Coefficients&#39;,</span></span>
<span id="cb138-11"><a href="simulace3.html#cb138-11" tabindex="-1"></a>      <span class="st">&#39;RF -- Discretization&#39;</span>,</span>
<span id="cb138-12"><a href="simulace3.html#cb138-12" tabindex="-1"></a>      <span class="st">&#39;RF -- fPCA&#39;</span>,</span>
<span id="cb138-13"><a href="simulace3.html#cb138-13" tabindex="-1"></a>      <span class="st">&#39;RF -- Basis Coefficients&#39;</span>,</span>
<span id="cb138-14"><a href="simulace3.html#cb138-14" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Functional&#39;</span>,</span>
<span id="cb138-15"><a href="simulace3.html#cb138-15" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Functional&#39;</span>,</span>
<span id="cb138-16"><a href="simulace3.html#cb138-16" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Functional&#39;</span>,</span>
<span id="cb138-17"><a href="simulace3.html#cb138-17" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Discretization&#39;</span>,</span>
<span id="cb138-18"><a href="simulace3.html#cb138-18" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Discretization&#39;</span>,</span>
<span id="cb138-19"><a href="simulace3.html#cb138-19" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Discretization&#39;</span>,</span>
<span id="cb138-20"><a href="simulace3.html#cb138-20" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- fPCA&#39;</span>,</span>
<span id="cb138-21"><a href="simulace3.html#cb138-21" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- fPCA&#39;</span>,</span>
<span id="cb138-22"><a href="simulace3.html#cb138-22" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- fPCA&#39;</span>,</span>
<span id="cb138-23"><a href="simulace3.html#cb138-23" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Basis Coefficients&#39;</span>,</span>
<span id="cb138-24"><a href="simulace3.html#cb138-24" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Basis Coefficients&#39;</span>,</span>
<span id="cb138-25"><a href="simulace3.html#cb138-25" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Basis Coefficients&#39;</span>,</span>
<span id="cb138-26"><a href="simulace3.html#cb138-26" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) -- Projection&#39;</span>,</span>
<span id="cb138-27"><a href="simulace3.html#cb138-27" tabindex="-1"></a>      <span class="st">&#39;SVM (poly) -- Projection&#39;</span>,</span>
<span id="cb138-28"><a href="simulace3.html#cb138-28" tabindex="-1"></a>      <span class="st">&#39;SVM (radial) -- Projection&#39;</span>,</span>
<span id="cb138-29"><a href="simulace3.html#cb138-29" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (linear)&#39;</span>,</span>
<span id="cb138-30"><a href="simulace3.html#cb138-30" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (poly)&#39;</span>,</span>
<span id="cb138-31"><a href="simulace3.html#cb138-31" tabindex="-1"></a>      <span class="st">&#39;RKHS (Radial SVR) $+$ SVM (radial)&#39;</span><span class="co">#,</span></span>
<span id="cb138-32"><a href="simulace3.html#cb138-32" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (linear)&#39;,</span></span>
<span id="cb138-33"><a href="simulace3.html#cb138-33" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (poly)&#39;,</span></span>
<span id="cb138-34"><a href="simulace3.html#cb138-34" tabindex="-1"></a>      <span class="co"># &#39;RKHS (Poly SVR) $+$ SVM (radial)&#39;#,</span></span>
<span id="cb138-35"><a href="simulace3.html#cb138-35" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (linear)&#39;,</span></span>
<span id="cb138-36"><a href="simulace3.html#cb138-36" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (poly)&#39;,</span></span>
<span id="cb138-37"><a href="simulace3.html#cb138-37" tabindex="-1"></a>      <span class="co">#&#39;RKHS (Linear SVR) $+$ SVM (radial)&#39;</span></span>
<span id="cb138-38"><a href="simulace3.html#cb138-38" tabindex="-1"></a>)</span>
<span id="cb138-39"><a href="simulace3.html#cb138-39" tabindex="-1"></a></span>
<span id="cb138-40"><a href="simulace3.html#cb138-40" tabindex="-1"></a></span>
<span id="cb138-41"><a href="simulace3.html#cb138-41" tabindex="-1"></a><span class="co"># Colors for box plots </span></span>
<span id="cb138-42"><a href="simulace3.html#cb138-42" tabindex="-1"></a>box_col1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;#4dd2ff&#39;</span>, <span class="st">&#39;#00ace6&#39;</span>, <span class="st">&#39;#00bfff&#39;</span>,  <span class="st">&#39;#00bfff&#39;</span>,</span>
<span id="cb138-43"><a href="simulace3.html#cb138-43" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#0086b3&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb138-44"><a href="simulace3.html#cb138-44" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff3814&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff6347&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#ff7961&#39;</span>, <span class="dv">3</span>),</span>
<span id="cb138-45"><a href="simulace3.html#cb138-45" tabindex="-1"></a>             <span class="fu">rep</span>(<span class="st">&#39;#ff4d2e&#39;</span>, <span class="dv">3</span>), <span class="fu">rep</span>(<span class="st">&#39;#fa2600&#39;</span>, <span class="dv">3</span>))</span>
<span id="cb138-46"><a href="simulace3.html#cb138-46" tabindex="-1"></a></span>
<span id="cb138-47"><a href="simulace3.html#cb138-47" tabindex="-1"></a><span class="co"># Alpha for box plots</span></span>
<span id="cb138-48"><a href="simulace3.html#cb138-48" tabindex="-1"></a>box_alpha1 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>,</span>
<span id="cb138-49"><a href="simulace3.html#cb138-49" tabindex="-1"></a>               <span class="fu">rep</span>(<span class="fu">c</span>(<span class="fl">0.9</span>, <span class="fl">0.8</span>, <span class="fl">0.7</span>), <span class="dv">6</span>)) <span class="co">#- 0.3</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb139"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb139-1"><a href="simulace3.html#cb139-1" tabindex="-1"></a><span class="co"># For training data</span></span>
<span id="cb139-2"><a href="simulace3.html#cb139-2" tabindex="-1"></a><span class="co"># tikz(file = &quot;figures/DP_sim_03_boxplot_train.tex&quot;, width = 10, height = 6)</span></span>
<span id="cb139-3"><a href="simulace3.html#cb139-3" tabindex="-1"></a>SIMULACE<span class="sc">$</span>train <span class="sc">|&gt;</span> </span>
<span id="cb139-4"><a href="simulace3.html#cb139-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb139-5"><a href="simulace3.html#cb139-5" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods2, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb139-6"><a href="simulace3.html#cb139-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb139-7"><a href="simulace3.html#cb139-7" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> <span class="fl">0.3</span>)) <span class="sc">+</span> </span>
<span id="cb139-8"><a href="simulace3.html#cb139-8" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb139-9"><a href="simulace3.html#cb139-9" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb139-10"><a href="simulace3.html#cb139-10" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb139-11"><a href="simulace3.html#cb139-11" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb139-12"><a href="simulace3.html#cb139-12" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train])) <span class="sc">+</span> </span>
<span id="cb139-13"><a href="simulace3.html#cb139-13" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb139-14"><a href="simulace3.html#cb139-14" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">40</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb139-15"><a href="simulace3.html#cb139-15" tabindex="-1"></a>  <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="dv">1</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb139-16"><a href="simulace3.html#cb139-16" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span></span>
<span id="cb139-17"><a href="simulace3.html#cb139-17" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="st">&#39;+&#39;</span>,</span>
<span id="cb139-18"><a href="simulace3.html#cb139-18" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">4</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="fl">0.9</span>)<span class="sc">+</span> </span>
<span id="cb139-19"><a href="simulace3.html#cb139-19" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.train), </span>
<span id="cb139-20"><a href="simulace3.html#cb139-20" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-140"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-140-1.png" alt="Box plots of training errors for 100 simulations for individual classification methods. Mean values are marked with black $+$ symbols." width="672" />
<p class="caption">
Figure 1.26: Box plots of training errors for 100 simulations for individual classification methods. Mean values are marked with black <span class="math inline">\(+\)</span> symbols.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb140"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb140-1"><a href="simulace3.html#cb140-1" tabindex="-1"></a><span class="co"># dev.off()</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb141"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb141-1"><a href="simulace3.html#cb141-1" tabindex="-1"></a><span class="co"># For test data</span></span>
<span id="cb141-2"><a href="simulace3.html#cb141-2" tabindex="-1"></a>sub_methods <span class="ot">&lt;-</span> methods[<span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">3</span><span class="sc">:</span><span class="dv">5</span>, <span class="dv">9</span><span class="sc">:</span><span class="dv">29</span>)]</span>
<span id="cb141-3"><a href="simulace3.html#cb141-3" tabindex="-1"></a></span>
<span id="cb141-4"><a href="simulace3.html#cb141-4" tabindex="-1"></a>SIMULACE<span class="sc">$</span>test <span class="sc">|&gt;</span> </span>
<span id="cb141-5"><a href="simulace3.html#cb141-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> methods, <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb141-6"><a href="simulace3.html#cb141-6" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods)) <span class="sc">|&gt;</span> </span>
<span id="cb141-7"><a href="simulace3.html#cb141-7" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span></span>
<span id="cb141-8"><a href="simulace3.html#cb141-8" tabindex="-1"></a>    <span class="co"># filter(method %in% sub_methods) |&gt; </span></span>
<span id="cb141-9"><a href="simulace3.html#cb141-9" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> method, <span class="at">y =</span> Err, <span class="at">fill =</span> method, <span class="at">colour =</span> method, <span class="at">alpha =</span> method)) <span class="sc">+</span> </span>
<span id="cb141-10"><a href="simulace3.html#cb141-10" tabindex="-1"></a>    <span class="fu">geom_jitter</span>(<span class="at">position =</span> <span class="fu">position_jitter</span>(<span class="at">height =</span> <span class="dv">0</span>, <span class="at">width =</span> <span class="fl">0.15</span>), <span class="at">alpha =</span> <span class="fl">0.6</span>, <span class="at">size =</span> <span class="fl">0.9</span>, <span class="at">pch =</span> <span class="dv">21</span>,</span>
<span id="cb141-11"><a href="simulace3.html#cb141-11" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&quot;black&quot;</span>) <span class="sc">+</span></span>
<span id="cb141-12"><a href="simulace3.html#cb141-12" tabindex="-1"></a>  <span class="fu">geom_boxplot</span>(<span class="at">outlier.colour =</span> <span class="st">&quot;white&quot;</span>, <span class="at">outlier.shape =</span> <span class="dv">16</span>, <span class="at">outlier.size =</span> <span class="dv">0</span>, </span>
<span id="cb141-13"><a href="simulace3.html#cb141-13" tabindex="-1"></a>               <span class="at">notch =</span> <span class="cn">FALSE</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb141-14"><a href="simulace3.html#cb141-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb141-15"><a href="simulace3.html#cb141-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb141-16"><a href="simulace3.html#cb141-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test])</span>
<span id="cb141-17"><a href="simulace3.html#cb141-17" tabindex="-1"></a>       ) <span class="sc">+</span> </span>
<span id="cb141-18"><a href="simulace3.html#cb141-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb141-19"><a href="simulace3.html#cb141-19" tabindex="-1"></a>        <span class="at">axis.text.x =</span> <span class="fu">element_text</span>(<span class="at">angle =</span> <span class="dv">35</span>, <span class="at">hjust =</span> <span class="dv">1</span>)) <span class="sc">+</span></span>
<span id="cb141-20"><a href="simulace3.html#cb141-20" tabindex="-1"></a>  <span class="fu">stat_summary</span>(<span class="at">fun =</span> <span class="st">&quot;mean&quot;</span>, <span class="at">geom =</span> <span class="st">&quot;point&quot;</span>, <span class="at">shape =</span> <span class="dv">4</span>,</span>
<span id="cb141-21"><a href="simulace3.html#cb141-21" tabindex="-1"></a>               <span class="at">size =</span> <span class="dv">2</span>, <span class="at">color =</span> <span class="st">&quot;black&quot;</span>, <span class="at">alpha =</span> <span class="dv">1</span>) <span class="sc">+</span></span>
<span id="cb141-22"><a href="simulace3.html#cb141-22" tabindex="-1"></a>  <span class="co"># scale_x_discrete(labels = methods_names1) +</span></span>
<span id="cb141-23"><a href="simulace3.html#cb141-23" tabindex="-1"></a>  <span class="co"># theme(plot.margin = unit(c(0.1, 0.1, 0.1, 0.5), &quot;cm&quot;)) +</span></span>
<span id="cb141-24"><a href="simulace3.html#cb141-24" tabindex="-1"></a>  <span class="co"># scale_fill_manual(values = box_col1) +</span></span>
<span id="cb141-25"><a href="simulace3.html#cb141-25" tabindex="-1"></a>  <span class="co"># scale_alpha_manual(values = box_alpha1) +</span></span>
<span id="cb141-26"><a href="simulace3.html#cb141-26" tabindex="-1"></a>  <span class="fu">geom_hline</span>(<span class="at">yintercept =</span> <span class="fu">min</span>(SIMULACE.df<span class="sc">$</span>Err.test), </span>
<span id="cb141-27"><a href="simulace3.html#cb141-27" tabindex="-1"></a>             <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;gray20&#39;</span>, <span class="at">alpha =</span> <span class="fl">0.8</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-142"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-142-1.png" alt="Box plots of test errors for 100 simulations for individual classification methods. Mean values are marked with black $+$ symbols." width="672" />
<p class="caption">
Figure 1.27: Box plots of test errors for 100 simulations for individual classification methods. Mean values are marked with black <span class="math inline">\(+\)</span> symbols.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb142"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb142-1"><a href="simulace3.html#cb142-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/chapter6_sim_03_boxplot_test_new.tex&quot;, device = tikz, width = 7, height = 5)</span></span></code></pre></div>
</details>
<pre><code>## Warning: Using alpha for a discrete variable is not advised.</code></pre>
<p>We would now like to formally test whether some classification methods are better than others based on the previous simulation on these data, or to show that we can consider them equally successful. Given the violation of the normality assumption, we cannot use the classic paired t-test. Instead, we will utilize its nonparametric alternative—the paired Wilcoxon test. However, we must be careful with interpretation in this case.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb144"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb144-1"><a href="simulace3.html#cb144-1" tabindex="-1"></a><span class="co"># Check normality</span></span>
<span id="cb144-2"><a href="simulace3.html#cb144-2" tabindex="-1"></a><span class="fu">library</span>(nortest)</span>
<span id="cb144-3"><a href="simulace3.html#cb144-3" tabindex="-1"></a><span class="fu">lillie.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.008072969</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb146"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb146-1"><a href="simulace3.html#cb146-1" tabindex="-1"></a><span class="fu">lillie.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>])<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.0004162642</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb148"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb148-1"><a href="simulace3.html#cb148-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - Bbasis&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;two.sided&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.4297988</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb150"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb150-1"><a href="simulace3.html#cb150-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - diskr&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;two.sided&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.1274886</code></pre>
<p>Now let’s look at the comparison between functional logistic regression and projection onto the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb152"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb152-1"><a href="simulace3.html#cb152-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.001104007</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb154"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb154-1"><a href="simulace3.html#cb154-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.0471872</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb156"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb156-1"><a href="simulace3.html#cb156-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.1611741</code></pre>
<p>We see that the linear kernel has a statistically significantly lower error rate compared to functional logistic regression (<span class="math inline">\(p\)</span>-value 0.001104). On the other hand, for the remaining SVM kernels, we could not demonstrate that the median of their test errors is smaller than the median of fLR.</p>
<p>We might be interested in further comparisons.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb158"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb158-1"><a href="simulace3.html#cb158-1" tabindex="-1"></a><span class="co"># wilcox.test(SIMULACE$test[, &#39;SVM rbf - RKHS - radial&#39;], SIMULACE$test[, &#39;SVM linear - diskr&#39;], alternative = &#39;less&#39;, paired = TRUE)$p.value</span></span>
<span id="cb158-2"><a href="simulace3.html#cb158-2" tabindex="-1"></a></span>
<span id="cb158-3"><a href="simulace3.html#cb158-3" tabindex="-1"></a><span class="co"># wilcox.test(SIMULACE$test[, &#39;SVM linear - RKHS - radial&#39;], SIMULACE$test[, &#39;SVM linear - diskr&#39;], alternative = &#39;less&#39;, paired = TRUE)$p.value</span></span>
<span id="cb158-4"><a href="simulace3.html#cb158-4" tabindex="-1"></a></span>
<span id="cb158-5"><a href="simulace3.html#cb158-5" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 1.797302e-05</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb160"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb160-1"><a href="simulace3.html#cb160-1" tabindex="-1"></a><span class="co"># wilcox.test(SIMULACE$test[, &#39;LR_functional&#39;], SIMULACE$test[, &#39;SVM rbf - RKHS - poly&#39;], alternative = &#39;less&#39;, paired = TRUE)$p.value</span></span>
<span id="cb160-2"><a href="simulace3.html#cb160-2" tabindex="-1"></a></span>
<span id="cb160-3"><a href="simulace3.html#cb160-3" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;LR_functional&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 9.443463e-08</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb162"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb162-1"><a href="simulace3.html#cb162-1" tabindex="-1"></a><span class="co"># wilcox.test(SIMULACE$test[, &#39;SVM poly - diskr&#39;], SIMULACE$test[, &#39;SVM poly - Bbasis&#39;], alternative = &#39;greater&#39;, paired = TRUE)$p.value</span></span></code></pre></div>
</details>
<p>Now let’s compare the kernels for projection.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb163"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb163-1"><a href="simulace3.html#cb163-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.03742462</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb165"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb165-1"><a href="simulace3.html#cb165-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - projection&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM poly - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;greater&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.2798017</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb167"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb167-1"><a href="simulace3.html#cb167-1" tabindex="-1"></a><span class="fu">wilcox.test</span>(SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM linear - projection&#39;</span>], SIMULACE<span class="sc">$</span>test[, <span class="st">&#39;SVM rbf - projection&#39;</span>], <span class="at">alternative =</span> <span class="st">&#39;less&#39;</span>, <span class="at">paired =</span> <span class="cn">TRUE</span>)<span class="sc">$</span>p.value</span></code></pre></div>
</details>
<pre><code>## [1] 0.02379553</code></pre>
<p>Finally, let’s look at which hyperparameter values were the most frequently chosen.</p>
<table>
<caption><span id="tab:unnamed-chunk-149">Table 1.10: </span>Medians of hyperparameter values for selected methods, for which some hyperparameter was determined using cross-validation.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right">Median hyperparameter value</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>KNN_K</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>nharm</td>
<td align="right">1.0</td>
</tr>
<tr class="odd">
<td>LR_func_n_basis</td>
<td align="right">13.0</td>
</tr>
<tr class="even">
<td>SVM_d_Linear</td>
<td align="right">15.5</td>
</tr>
<tr class="odd">
<td>SVM_d_Poly</td>
<td align="right">13.0</td>
</tr>
<tr class="even">
<td>SVM_d_Radial</td>
<td align="right">11.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma1</td>
<td align="right">5.2</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_gamma2</td>
<td align="right">3.2</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_gamma3</td>
<td align="right">1.6</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d1</td>
<td align="right">19.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_radial_d2</td>
<td align="right">18.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_radial_d3</td>
<td align="right">15.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p1</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_p2</td>
<td align="right">4.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_p3</td>
<td align="right">4.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d1</td>
<td align="right">23.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_poly_d2</td>
<td align="right">31.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_poly_d3</td>
<td align="right">31.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d1</td>
<td align="right">21.0</td>
</tr>
<tr class="even">
<td>SVM_RKHS_linear_d2</td>
<td align="right">25.0</td>
</tr>
<tr class="odd">
<td>SVM_RKHS_linear_d3</td>
<td align="right">25.0</td>
</tr>
</tbody>
</table>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb169"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb169-1"><a href="simulace3.html#cb169-1" tabindex="-1"></a>CV_res <span class="ot">&lt;-</span> CV_RESULTS <span class="sc">|&gt;</span> </span>
<span id="cb169-2"><a href="simulace3.html#cb169-2" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">names_to =</span> <span class="st">&#39;method&#39;</span>, <span class="at">values_to =</span> <span class="st">&#39;hyperparameter&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb169-3"><a href="simulace3.html#cb169-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, </span>
<span id="cb169-4"><a href="simulace3.html#cb169-4" tabindex="-1"></a>                         <span class="at">levels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), </span>
<span id="cb169-5"><a href="simulace3.html#cb169-5" tabindex="-1"></a>                         <span class="at">labels =</span> CV_RESULTS <span class="sc">|&gt;</span> <span class="fu">colnames</span>(), <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb169-6"><a href="simulace3.html#cb169-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() </span>
<span id="cb169-7"><a href="simulace3.html#cb169-7" tabindex="-1"></a></span>
<span id="cb169-8"><a href="simulace3.html#cb169-8" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb169-9"><a href="simulace3.html#cb169-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;KNN_K&#39;</span>, <span class="st">&#39;nharm&#39;</span>, <span class="st">&#39;LR_func_n_basis&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb169-10"><a href="simulace3.html#cb169-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb169-11"><a href="simulace3.html#cb169-11" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb169-12"><a href="simulace3.html#cb169-12" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb169-13"><a href="simulace3.html#cb169-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb169-14"><a href="simulace3.html#cb169-14" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb169-15"><a href="simulace3.html#cb169-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb169-16"><a href="simulace3.html#cb169-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb169-17"><a href="simulace3.html#cb169-17" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-150"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-150-1.png" alt="Histograms of hyperparameter values for KNN, functional logistic regression, and a histogram for the number of principal components." width="672" />
<p class="caption">
Figure 1.28: Histograms of hyperparameter values for KNN, functional logistic regression, and a histogram for the number of principal components.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb170"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb170-1"><a href="simulace3.html#cb170-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb170-2"><a href="simulace3.html#cb170-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_d_Linear&#39;</span>, <span class="st">&#39;SVM_d_Poly&#39;</span>, <span class="st">&#39;SVM_d_Radial&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb170-3"><a href="simulace3.html#cb170-3" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb170-4"><a href="simulace3.html#cb170-4" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb170-5"><a href="simulace3.html#cb170-5" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb170-6"><a href="simulace3.html#cb170-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb170-7"><a href="simulace3.html#cb170-7" tabindex="-1"></a>  <span class="fu">facet_grid</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>) <span class="sc">+</span></span>
<span id="cb170-8"><a href="simulace3.html#cb170-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb170-9"><a href="simulace3.html#cb170-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb170-10"><a href="simulace3.html#cb170-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-152"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-152-1.png" alt="Histograms of hyperparameter values for the SVM method with projection onto the B-spline basis." width="672" />
<p class="caption">
Figure 1.29: Histograms of hyperparameter values for the SVM method with projection onto the B-spline basis.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb171"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb171-1"><a href="simulace3.html#cb171-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb171-2"><a href="simulace3.html#cb171-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_radial_gamma1&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_gamma2&#39;</span>,</span>
<span id="cb171-3"><a href="simulace3.html#cb171-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_gamma3&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d1&#39;</span>, </span>
<span id="cb171-4"><a href="simulace3.html#cb171-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_radial_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_radial_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb171-5"><a href="simulace3.html#cb171-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb171-6"><a href="simulace3.html#cb171-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb171-7"><a href="simulace3.html#cb171-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">bins =</span> <span class="dv">10</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb171-8"><a href="simulace3.html#cb171-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb171-9"><a href="simulace3.html#cb171-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb171-10"><a href="simulace3.html#cb171-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb171-11"><a href="simulace3.html#cb171-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb171-12"><a href="simulace3.html#cb171-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-154"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-154-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with radial kernel." width="672" />
<p class="caption">
Figure 1.30: Histograms of hyperparameter values for RKHS + SVM with radial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb172"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb172-1"><a href="simulace3.html#cb172-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb172-2"><a href="simulace3.html#cb172-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_poly_p1&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_p2&#39;</span>,</span>
<span id="cb172-3"><a href="simulace3.html#cb172-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_p3&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d1&#39;</span>,</span>
<span id="cb172-4"><a href="simulace3.html#cb172-4" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_poly_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_poly_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb172-5"><a href="simulace3.html#cb172-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb172-6"><a href="simulace3.html#cb172-6" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb172-7"><a href="simulace3.html#cb172-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">1</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb172-8"><a href="simulace3.html#cb172-8" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb172-9"><a href="simulace3.html#cb172-9" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb172-10"><a href="simulace3.html#cb172-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb172-11"><a href="simulace3.html#cb172-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb172-12"><a href="simulace3.html#cb172-12" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-156"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-156-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with polynomial kernel." width="672" />
<p class="caption">
Figure 1.31: Histograms of hyperparameter values for RKHS + SVM with polynomial kernel.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb173"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb173-1"><a href="simulace3.html#cb173-1" tabindex="-1"></a>CV_res <span class="sc">|&gt;</span> </span>
<span id="cb173-2"><a href="simulace3.html#cb173-2" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&#39;SVM_RKHS_linear_d1&#39;</span>,</span>
<span id="cb173-3"><a href="simulace3.html#cb173-3" tabindex="-1"></a>                       <span class="st">&#39;SVM_RKHS_linear_d2&#39;</span>, <span class="st">&#39;SVM_RKHS_linear_d3&#39;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb173-4"><a href="simulace3.html#cb173-4" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> hyperparameter, <span class="co">#y = after_stat(density),</span></span>
<span id="cb173-5"><a href="simulace3.html#cb173-5" tabindex="-1"></a>             <span class="at">fill =</span> method, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb173-6"><a href="simulace3.html#cb173-6" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">binwidth =</span> <span class="dv">5</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb173-7"><a href="simulace3.html#cb173-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb173-8"><a href="simulace3.html#cb173-8" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>method, <span class="at">scales =</span> <span class="st">&#39;free&#39;</span>, <span class="at">ncol =</span> <span class="dv">3</span>) <span class="sc">+</span></span>
<span id="cb173-9"><a href="simulace3.html#cb173-9" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Hyperparameter Values&#39;</span>,</span>
<span id="cb173-10"><a href="simulace3.html#cb173-10" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Absolute Count&#39;</span>) <span class="sc">+</span> </span>
<span id="cb173-11"><a href="simulace3.html#cb173-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-158"></span>
<img src="01-Simulace_files/figure-html/unnamed-chunk-158-1.png" alt="Histograms of hyperparameter values for RKHS + SVM with linear kernel." width="672" />
<p class="caption">
Figure 1.32: Histograms of hyperparameter values for RKHS + SVM with linear kernel.
</p>
</div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="1">
<li id="fn1"><p>Muñoz, A. and González, J. (2010) <em>Representing functional data using support vector machines</em>, Pattern Recognition Letters, 31(6), pp. 511–516. <a href="https://www.sciencedirect.com/science/article/pii/S0167865509001913">doi:10.1016/j.patrec.2009.07.014</a>.<a href="simulace3.html#fnref1" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="index.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace3sigma.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/01-Simulace.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
