<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 4 Dependency on Discretization | Support Vector Machine Classification of Functional Data with Random Vertical Shifts</title>
  <meta name="description" content="Chapter 4 Dependency on Discretization | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 4 Dependency on Discretization | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 4 Dependency on Discretization | Support Vector Machine Classification of Functional Data with Random Vertical Shifts" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2025-03-23" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace3shift.html"/>
<link rel="next" href="simulace4.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Support Vector Machine Classification of Functional Data with Random Vertical Shifts</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace3diskr" class="section level1 hasAnchor" number="4">
<h1><span class="header-section-number">Chapter 4</span> Dependency on Discretization<a href="simulace3diskr.html#simulace3diskr" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we will focus on the dependence of the results from the previous section <a href="simulace3.html#simulace3">1</a> on the value of <span class="math inline">\(p\)</span>, which defines the length of the equidistant sequence of points used for discretizing the observed functional objects. We are interested in how the error rates of individual classification methods change as we refine the interval division, that is, as the dimension of the discretized vectors increases.</p>
<p>Our assumption is that the support vector method applied to discretized data should yield lower error rates as <span class="math inline">\(p\)</span> increases, since we better approximate integrals and thus the values of kernel functions for functional analogs. Conversely, we would expect decision trees and random forests to stagnate beyond a certain number of <span class="math inline">\(p\)</span>.</p>
<p>Since we are discussing the discretization of the interval, this chapter will focus solely on methods that work with discretized data—namely:</p>
<ul>
<li>Decision Tree,</li>
<li>Random Forest,</li>
<li>SVM Method.</li>
</ul>
<p>In addition to average test error rates, we are also interested in the computational cost of each method as <span class="math inline">\(p\)</span> increases, since minimum error rate is not the only criterion for using a given classification method in practice. Computational complexity and the associated time demands play a relatively important role as well.</p>
<p>This chapter consists of two parts. In the first Section <a href="simulace3diskr.html#klasif3diskr">4.3</a>, we will choose a fixed number of <span class="math inline">\(p=101\)</span> discretized values and examine the individual methods, their error rates, and their time demands. Subsequently, in Section <a href="simulace3diskr.html#simul3diskr">4.4</a>, we will define a sequence of <span class="math inline">\(p\)</span> values and repeat the entire process several times for each value so that we can establish average results for that value. Finally, we will plot the dependence of error rates and computational demands on the value of <span class="math inline">\(p\)</span>.</p>
<div id="simulation-of-functional-data-3" class="section level2 hasAnchor" number="4.1">
<h2><span class="header-section-number">4.1</span> Simulation of Functional Data<a href="simulace3diskr.html#simulation-of-functional-data-3" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will simulate functions that we will later classify. For simplicity, we will consider two classification classes. To simulate, we will:</p>
<ul>
<li>choose appropriate functions,</li>
<li>generate points from the chosen interval that contain, for example, Gaussian noise,</li>
<li>smooth the resulting discrete points into the form of a functional object using a suitable basis system.</li>
</ul>
<p>This process will yield functional objects along with the value of the categorical variable <span class="math inline">\(Y\)</span>, which distinguishes class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb380"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb380-1"><a href="simulace3diskr.html#cb380-1" tabindex="-1"></a><span class="co"># Load necessary packages</span></span>
<span id="cb380-2"><a href="simulace3diskr.html#cb380-2" tabindex="-1"></a></span>
<span id="cb380-3"><a href="simulace3diskr.html#cb380-3" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb380-4"><a href="simulace3diskr.html#cb380-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb380-5"><a href="simulace3diskr.html#cb380-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb380-6"><a href="simulace3diskr.html#cb380-6" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb380-7"><a href="simulace3diskr.html#cb380-7" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb380-8"><a href="simulace3diskr.html#cb380-8" tabindex="-1"></a><span class="fu">library</span>(polynom)</span>
<span id="cb380-9"><a href="simulace3diskr.html#cb380-9" tabindex="-1"></a></span>
<span id="cb380-10"><a href="simulace3diskr.html#cb380-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Let’s consider two classification classes, <span class="math inline">\(Y \in \{0, 1\}\)</span>, with the same number of generated functions <code>n</code> for each class. First, we will define two functions, each for one class, over the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<p>Now we will create functions using interpolation polynomials. First, we define the points that our curve should pass through and then fit an interpolation polynomial through them, which we will use to generate curves for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb381"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb381-1"><a href="simulace3diskr.html#cb381-1" tabindex="-1"></a><span class="co"># Defining points for class 0</span></span>
<span id="cb381-2"><a href="simulace3diskr.html#cb381-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.65</span>, <span class="fl">0.94</span>, <span class="fl">1.42</span>, <span class="fl">2.26</span>, <span class="fl">2.84</span>, <span class="fl">3.73</span>, <span class="fl">4.50</span>, <span class="fl">5.43</span>, <span class="fl">6.00</span>)</span>
<span id="cb381-3"><a href="simulace3diskr.html#cb381-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.86</span>, <span class="fl">1.49</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.36</span>, <span class="fl">0.23</span>, <span class="dv">0</span>)</span>
<span id="cb381-4"><a href="simulace3diskr.html#cb381-4" tabindex="-1"></a></span>
<span id="cb381-5"><a href="simulace3diskr.html#cb381-5" tabindex="-1"></a><span class="co"># Defining points for class 1</span></span>
<span id="cb381-6"><a href="simulace3diskr.html#cb381-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.51</span>, <span class="fl">0.91</span>, <span class="fl">1.25</span>, <span class="fl">1.51</span>, <span class="fl">2.14</span>, <span class="fl">2.43</span>, <span class="fl">2.96</span>, <span class="fl">3.70</span>, <span class="fl">4.60</span>,</span>
<span id="cb381-7"><a href="simulace3diskr.html#cb381-7" tabindex="-1"></a>         <span class="fl">5.25</span>, <span class="fl">5.67</span>, <span class="fl">6.00</span>)</span>
<span id="cb381-8"><a href="simulace3diskr.html#cb381-8" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.71</span>, <span class="fl">1.08</span>, <span class="fl">1.47</span>, <span class="fl">1.39</span>, <span class="fl">0.81</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb381-9"><a href="simulace3diskr.html#cb381-9" tabindex="-1"></a>         <span class="fl">0.3</span>, <span class="fl">0.37</span>, <span class="dv">0</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb382"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb382-1"><a href="simulace3diskr.html#cb382-1" tabindex="-1"></a><span class="co"># Plot points</span></span>
<span id="cb382-2"><a href="simulace3diskr.html#cb382-2" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb382-3"><a href="simulace3diskr.html#cb382-3" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb382-4"><a href="simulace3diskr.html#cb382-4" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb382-5"><a href="simulace3diskr.html#cb382-5" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb382-6"><a href="simulace3diskr.html#cb382-6" tabindex="-1"></a></span>
<span id="cb382-7"><a href="simulace3diskr.html#cb382-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb382-8"><a href="simulace3diskr.html#cb382-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb382-9"><a href="simulace3diskr.html#cb382-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb382-10"><a href="simulace3diskr.html#cb382-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-3-1.png" alt="Points defining the interpolation polynomials." width="672" />
<p class="caption">
Figure 1.1: Points defining the interpolation polynomials.
</p>
</div>
<p>To calculate the interpolation polynomials, we will use the <code>poly.calc()</code> function from the <code>polynom</code> library. We will then define functions <code>poly.0()</code> and <code>poly.1()</code> that will compute the polynomial values at a given point in the interval. To create these, we will use the <code>predict()</code> function, where we input the corresponding polynomial and the point at which we want to evaluate the polynomial.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb383"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb383-1"><a href="simulace3diskr.html#cb383-1" tabindex="-1"></a><span class="co"># Calculate polynomials</span></span>
<span id="cb383-2"><a href="simulace3diskr.html#cb383-2" tabindex="-1"></a>polynom<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>)</span>
<span id="cb383-3"><a href="simulace3diskr.html#cb383-3" tabindex="-1"></a>polynom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb384"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb384-1"><a href="simulace3diskr.html#cb384-1" tabindex="-1"></a>poly<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.0</span>, x))</span>
<span id="cb384-2"><a href="simulace3diskr.html#cb384-2" tabindex="-1"></a>poly<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.1</span>, x))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb385"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb385-1"><a href="simulace3diskr.html#cb385-1" tabindex="-1"></a><span class="co"># Plot polynomials</span></span>
<span id="cb385-2"><a href="simulace3diskr.html#cb385-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x<span class="fl">.0</span>), <span class="fu">max</span>(x<span class="fl">.0</span>), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb385-3"><a href="simulace3diskr.html#cb385-3" tabindex="-1"></a>yy<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.0</span>(xx)</span>
<span id="cb385-4"><a href="simulace3diskr.html#cb385-4" tabindex="-1"></a>yy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.1</span>(xx)</span>
<span id="cb385-5"><a href="simulace3diskr.html#cb385-5" tabindex="-1"></a></span>
<span id="cb385-6"><a href="simulace3diskr.html#cb385-6" tabindex="-1"></a>dat_poly_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(xx, xx),</span>
<span id="cb385-7"><a href="simulace3diskr.html#cb385-7" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(yy<span class="fl">.0</span>, yy<span class="fl">.1</span>),</span>
<span id="cb385-8"><a href="simulace3diskr.html#cb385-8" tabindex="-1"></a>                            <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb385-9"><a href="simulace3diskr.html#cb385-9" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="fu">length</span>(xx), <span class="fu">length</span>(xx))))</span>
<span id="cb385-10"><a href="simulace3diskr.html#cb385-10" tabindex="-1"></a></span>
<span id="cb385-11"><a href="simulace3diskr.html#cb385-11" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb385-12"><a href="simulace3diskr.html#cb385-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb385-13"><a href="simulace3diskr.html#cb385-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb385-14"><a href="simulace3diskr.html#cb385-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_plot,</span>
<span id="cb385-15"><a href="simulace3diskr.html#cb385-15" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class),</span>
<span id="cb385-16"><a href="simulace3diskr.html#cb385-16" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb385-17"><a href="simulace3diskr.html#cb385-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-6-1.png" alt="Representation of two functions over the interval $I = [0, 6]$, from which we generate observations from classes 0 and 1." width="672" />
<p class="caption">
Figure 1.2: Representation of two functions over the interval <span class="math inline">\(I = [0, 6]\)</span>, from which we generate observations from classes 0 and 1.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb386"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb386-1"><a href="simulace3diskr.html#cb386-1" tabindex="-1"></a><span class="co"># Generating functions for Y = 0 and Y = 1</span></span>
<span id="cb386-2"><a href="simulace3diskr.html#cb386-2" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> poly<span class="fl">.0</span></span>
<span id="cb386-3"><a href="simulace3diskr.html#cb386-3" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> poly<span class="fl">.1</span></span></code></pre></div>
</details>
<p>Now we will create a function to generate random functions with added noise (or points on a predefined grid) from the chosen generating function. The argument <code>t</code> indicates the vector of values at which we want to evaluate the functions, <code>fun</code> denotes the generating function, <code>n</code> is the number of functions, and <code>sigma</code> is the standard deviation of the normal distribution <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>, from which we randomly generate Gaussian white noise with <span class="math inline">\(\mu = 0\)</span>. To demonstrate the advantage of using methods that work with functional data, we will also add a random term to each simulated observation, which will serve as a vertical shift for the entire function (parameter <code>sigma_shift</code>). This shift will be generated from a normal distribution with the parameter <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb387"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb387-1"><a href="simulace3diskr.html#cb387-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb387-2"><a href="simulace3diskr.html#cb387-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb387-3"><a href="simulace3diskr.html#cb387-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb387-4"><a href="simulace3diskr.html#cb387-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb387-5"><a href="simulace3diskr.html#cb387-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb387-6"><a href="simulace3diskr.html#cb387-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb387-7"><a href="simulace3diskr.html#cb387-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb387-8"><a href="simulace3diskr.html#cb387-8" tabindex="-1"></a>  </span>
<span id="cb387-9"><a href="simulace3diskr.html#cb387-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb387-10"><a href="simulace3diskr.html#cb387-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb387-11"><a href="simulace3diskr.html#cb387-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb387-12"><a href="simulace3diskr.html#cb387-12" tabindex="-1"></a>  </span>
<span id="cb387-13"><a href="simulace3diskr.html#cb387-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb387-14"><a href="simulace3diskr.html#cb387-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb387-15"><a href="simulace3diskr.html#cb387-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb387-16"><a href="simulace3diskr.html#cb387-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb387-17"><a href="simulace3diskr.html#cb387-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb387-18"><a href="simulace3diskr.html#cb387-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fun</span>(X) <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb387-19"><a href="simulace3diskr.html#cb387-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can generate the functions. In each of the two classes, we will consider 100 observations, thus <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb388"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb388-1"><a href="simulace3diskr.html#cb388-1" tabindex="-1"></a><span class="co"># Number of generated observations for each class</span></span>
<span id="cb388-2"><a href="simulace3diskr.html#cb388-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb388-3"><a href="simulace3diskr.html#cb388-3" tabindex="-1"></a><span class="co"># Vector of time points equidistant on the interval [0, 6]</span></span>
<span id="cb388-4"><a href="simulace3diskr.html#cb388-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb388-5"><a href="simulace3diskr.html#cb388-5" tabindex="-1"></a></span>
<span id="cb388-6"><a href="simulace3diskr.html#cb388-6" tabindex="-1"></a><span class="co"># For Y = 0</span></span>
<span id="cb388-7"><a href="simulace3diskr.html#cb388-7" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb388-8"><a href="simulace3diskr.html#cb388-8" tabindex="-1"></a><span class="co"># For Y = 1</span></span>
<span id="cb388-9"><a href="simulace3diskr.html#cb388-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (not yet smoothed) functions in color according to their class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb389"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb389-1"><a href="simulace3diskr.html#cb389-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># Number of curves to plot from each group</span></span>
<span id="cb389-2"><a href="simulace3diskr.html#cb389-2" tabindex="-1"></a></span>
<span id="cb389-3"><a href="simulace3diskr.html#cb389-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb389-4"><a href="simulace3diskr.html#cb389-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb389-5"><a href="simulace3diskr.html#cb389-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb389-6"><a href="simulace3diskr.html#cb389-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb389-7"><a href="simulace3diskr.html#cb389-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb389-8"><a href="simulace3diskr.html#cb389-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb389-9"><a href="simulace3diskr.html#cb389-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb389-10"><a href="simulace3diskr.html#cb389-10" tabindex="-1"></a>  )</span>
<span id="cb389-11"><a href="simulace3diskr.html#cb389-11" tabindex="-1"></a></span>
<span id="cb389-12"><a href="simulace3diskr.html#cb389-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb389-13"><a href="simulace3diskr.html#cb389-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb389-14"><a href="simulace3diskr.html#cb389-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb389-15"><a href="simulace3diskr.html#cb389-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb389-16"><a href="simulace3diskr.html#cb389-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb389-17"><a href="simulace3diskr.html#cb389-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb389-18"><a href="simulace3diskr.html#cb389-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb389-19"><a href="simulace3diskr.html#cb389-19" tabindex="-1"></a>  )</span>
<span id="cb389-20"><a href="simulace3diskr.html#cb389-20" tabindex="-1"></a></span>
<span id="cb389-21"><a href="simulace3diskr.html#cb389-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb389-22"><a href="simulace3diskr.html#cb389-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb389-23"><a href="simulace3diskr.html#cb389-23" tabindex="-1"></a></span>
<span id="cb389-24"><a href="simulace3diskr.html#cb389-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb389-25"><a href="simulace3diskr.html#cb389-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb389-26"><a href="simulace3diskr.html#cb389-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb389-27"><a href="simulace3diskr.html#cb389-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb389-28"><a href="simulace3diskr.html#cb389-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb389-29"><a href="simulace3diskr.html#cb389-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb389-30"><a href="simulace3diskr.html#cb389-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb389-31"><a href="simulace3diskr.html#cb389-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-10"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-10-1.png" alt="The first 10 generated observations from each of the two classification classes. The observed data are not smoothed." width="672" />
<p class="caption">
Figure 1.3: The first 10 generated observations from each of the two classification classes. The observed data are not smoothed.
</p>
</div>
</div>
<div id="smoothing-the-observed-curves-2" class="section level2 hasAnchor" number="4.2">
<h2><span class="header-section-number">4.2</span> Smoothing the Observed Curves<a href="simulace3diskr.html#smoothing-the-observed-curves-2" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will convert the observed discrete values (vectors of values) into functional objects, which we will subsequently work with. We will again use a B-spline basis for smoothing.</p>
<p>We will take the entire vector <code>t</code> as the knots, and since we will generally consider cubic splines, we will choose (the default choice in <code>R</code>) <code>norder = 4</code>. We will penalize the second derivative of the functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb390"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb390-1"><a href="simulace3diskr.html#cb390-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb390-2"><a href="simulace3diskr.html#cb390-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb390-3"><a href="simulace3diskr.html#cb390-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb390-4"><a href="simulace3diskr.html#cb390-4" tabindex="-1"></a></span>
<span id="cb390-5"><a href="simulace3diskr.html#cb390-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb390-6"><a href="simulace3diskr.html#cb390-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb390-7"><a href="simulace3diskr.html#cb390-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb390-8"><a href="simulace3diskr.html#cb390-8" tabindex="-1"></a></span>
<span id="cb390-9"><a href="simulace3diskr.html#cb390-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) <span class="co"># penalize the 2nd derivative</span></span></code></pre></div>
</details>
<p>We will find a suitable value for the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, i.e., using generalized cross-validation. We will consider the value of <span class="math inline">\(\lambda\)</span> to be the same for both classification groups because we would not know in advance which value of $to choose if a different choice were made for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb391"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb391-1"><a href="simulace3diskr.html#cb391-1" tabindex="-1"></a><span class="co"># Combine observations into a single matrix</span></span>
<span id="cb391-2"><a href="simulace3diskr.html#cb391-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb391-3"><a href="simulace3diskr.html#cb391-3" tabindex="-1"></a></span>
<span id="cb391-4"><a href="simulace3diskr.html#cb391-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vector of lambdas</span></span>
<span id="cb391-5"><a href="simulace3diskr.html#cb391-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for storing GCV</span></span>
<span id="cb391-6"><a href="simulace3diskr.html#cb391-6" tabindex="-1"></a></span>
<span id="cb391-7"><a href="simulace3diskr.html#cb391-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb391-8"><a href="simulace3diskr.html#cb391-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb391-9"><a href="simulace3diskr.html#cb391-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb391-10"><a href="simulace3diskr.html#cb391-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb391-11"><a href="simulace3diskr.html#cb391-11" tabindex="-1"></a>}</span>
<span id="cb391-12"><a href="simulace3diskr.html#cb391-12" tabindex="-1"></a></span>
<span id="cb391-13"><a href="simulace3diskr.html#cb391-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb391-14"><a href="simulace3diskr.html#cb391-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb391-15"><a href="simulace3diskr.html#cb391-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb391-16"><a href="simulace3diskr.html#cb391-16" tabindex="-1"></a>)</span>
<span id="cb391-17"><a href="simulace3diskr.html#cb391-17" tabindex="-1"></a></span>
<span id="cb391-18"><a href="simulace3diskr.html#cb391-18" tabindex="-1"></a><span class="co"># Find the minimum value</span></span>
<span id="cb391-19"><a href="simulace3diskr.html#cb391-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>For better visualization, we will plot the progression of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb392"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb392-1"><a href="simulace3diskr.html#cb392-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb392-2"><a href="simulace3diskr.html#cb392-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb392-3"><a href="simulace3diskr.html#cb392-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb392-4"><a href="simulace3diskr.html#cb392-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb392-5"><a href="simulace3diskr.html#cb392-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb392-6"><a href="simulace3diskr.html#cb392-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb392-7"><a href="simulace3diskr.html#cb392-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb392-8"><a href="simulace3diskr.html#cb392-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-13"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-13-1.png" alt="The progression of $GCV(\lambda)$ for the chosen vector $\boldsymbol\lambda$. The x-axis values are plotted on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is indicated in red." width="672" />
<p class="caption">
Figure 1.4: The progression of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen vector <span class="math inline">\(\boldsymbol\lambda\)</span>. The x-axis values are plotted on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is indicated in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically display the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb394"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb394-1"><a href="simulace3diskr.html#cb394-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb394-2"><a href="simulace3diskr.html#cb394-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb394-3"><a href="simulace3diskr.html#cb394-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb394-4"><a href="simulace3diskr.html#cb394-4" tabindex="-1"></a></span>
<span id="cb394-5"><a href="simulace3diskr.html#cb394-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb394-6"><a href="simulace3diskr.html#cb394-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb394-7"><a href="simulace3diskr.html#cb394-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb394-8"><a href="simulace3diskr.html#cb394-8" tabindex="-1"></a></span>
<span id="cb394-9"><a href="simulace3diskr.html#cb394-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb394-10"><a href="simulace3diskr.html#cb394-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb394-11"><a href="simulace3diskr.html#cb394-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb394-12"><a href="simulace3diskr.html#cb394-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb394-13"><a href="simulace3diskr.html#cb394-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb394-14"><a href="simulace3diskr.html#cb394-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb394-15"><a href="simulace3diskr.html#cb394-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb394-16"><a href="simulace3diskr.html#cb394-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-14-1.png" alt="The first 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.5: The first 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s visualize all the smoothed observed curves, highlighting them by their classification class, along with the average for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb395"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb395-1"><a href="simulace3diskr.html#cb395-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb395-2"><a href="simulace3diskr.html#cb395-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb395-3"><a href="simulace3diskr.html#cb395-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb395-4"><a href="simulace3diskr.html#cb395-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb395-5"><a href="simulace3diskr.html#cb395-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb395-6"><a href="simulace3diskr.html#cb395-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb395-7"><a href="simulace3diskr.html#cb395-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb395-8"><a href="simulace3diskr.html#cb395-8" tabindex="-1"></a>)</span>
<span id="cb395-9"><a href="simulace3diskr.html#cb395-9" tabindex="-1"></a></span>
<span id="cb395-10"><a href="simulace3diskr.html#cb395-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb395-11"><a href="simulace3diskr.html#cb395-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb395-12"><a href="simulace3diskr.html#cb395-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb395-13"><a href="simulace3diskr.html#cb395-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb395-14"><a href="simulace3diskr.html#cb395-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb395-15"><a href="simulace3diskr.html#cb395-15" tabindex="-1"></a>)</span>
<span id="cb395-16"><a href="simulace3diskr.html#cb395-16" tabindex="-1"></a></span>
<span id="cb395-17"><a href="simulace3diskr.html#cb395-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb395-18"><a href="simulace3diskr.html#cb395-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb395-19"><a href="simulace3diskr.html#cb395-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb395-20"><a href="simulace3diskr.html#cb395-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb395-21"><a href="simulace3diskr.html#cb395-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb395-22"><a href="simulace3diskr.html#cb395-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb395-23"><a href="simulace3diskr.html#cb395-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb395-24"><a href="simulace3diskr.html#cb395-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb395-25"><a href="simulace3diskr.html#cb395-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb395-26"><a href="simulace3diskr.html#cb395-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb395-27"><a href="simulace3diskr.html#cb395-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb395-28"><a href="simulace3diskr.html#cb395-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="co"># limits = c(-1, 2)</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-15-1.png" alt="Plot of all smoothed observed curves, colored by classification class. The thick line represents the average for each class." width="672" />
<p class="caption">
Figure 1.6: Plot of all smoothed observed curves, colored by classification class. The thick line represents the average for each class.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb396"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb396-1"><a href="simulace3diskr.html#cb396-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb396-2"><a href="simulace3diskr.html#cb396-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb396-3"><a href="simulace3diskr.html#cb396-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb396-4"><a href="simulace3diskr.html#cb396-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb396-5"><a href="simulace3diskr.html#cb396-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb396-6"><a href="simulace3diskr.html#cb396-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb396-7"><a href="simulace3diskr.html#cb396-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb396-8"><a href="simulace3diskr.html#cb396-8" tabindex="-1"></a>)</span>
<span id="cb396-9"><a href="simulace3diskr.html#cb396-9" tabindex="-1"></a></span>
<span id="cb396-10"><a href="simulace3diskr.html#cb396-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb396-11"><a href="simulace3diskr.html#cb396-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb396-12"><a href="simulace3diskr.html#cb396-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb396-13"><a href="simulace3diskr.html#cb396-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb396-14"><a href="simulace3diskr.html#cb396-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb396-15"><a href="simulace3diskr.html#cb396-15" tabindex="-1"></a>)</span>
<span id="cb396-16"><a href="simulace3diskr.html#cb396-16" tabindex="-1"></a></span>
<span id="cb396-17"><a href="simulace3diskr.html#cb396-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb396-18"><a href="simulace3diskr.html#cb396-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb396-19"><a href="simulace3diskr.html#cb396-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb396-20"><a href="simulace3diskr.html#cb396-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb396-21"><a href="simulace3diskr.html#cb396-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb396-22"><a href="simulace3diskr.html#cb396-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb396-23"><a href="simulace3diskr.html#cb396-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification</span><span class="sc">\n</span><span class="st">      Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb396-24"><a href="simulace3diskr.html#cb396-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb396-25"><a href="simulace3diskr.html#cb396-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb396-26"><a href="simulace3diskr.html#cb396-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb396-27"><a href="simulace3diskr.html#cb396-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb396-28"><a href="simulace3diskr.html#cb396-28" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-16-1.png" alt="Plot of all smoothed observed curves, colored by classification class. The thick line represents the average for each class. Close-up view." width="672" />
<p class="caption">
Figure 1.7: Plot of all smoothed observed curves, colored by classification class. The thick line represents the average for each class. Close-up view.
</p>
</div>
<p>Here’s the continuation of your text, including the code for classification with decision trees.</p>
<hr />
</div>
<div id="klasif3diskr" class="section level2 hasAnchor" number="4.3">
<h2><span class="header-section-number">4.3</span> Classification of Curves<a href="simulace3diskr.html#klasif3diskr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb397"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb397-1"><a href="simulace3diskr.html#cb397-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training sets</span></span>
<span id="cb397-2"><a href="simulace3diskr.html#cb397-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb397-3"><a href="simulace3diskr.html#cb397-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb397-4"><a href="simulace3diskr.html#cb397-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb397-5"><a href="simulace3diskr.html#cb397-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb397-6"><a href="simulace3diskr.html#cb397-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb397-7"><a href="simulace3diskr.html#cb397-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for LR on scores</span></span>
<span id="cb397-8"><a href="simulace3diskr.html#cb397-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for LR on scores</span></span>
<span id="cb397-9"><a href="simulace3diskr.html#cb397-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb397-10"><a href="simulace3diskr.html#cb397-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># decision trees</span></span>
<span id="cb397-11"><a href="simulace3diskr.html#cb397-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># graphics</span></span>
<span id="cb397-12"><a href="simulace3diskr.html#cb397-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb397-13"><a href="simulace3diskr.html#cb397-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># random forest</span></span></code></pre></div>
</details>
<p>To compare the individual classifiers, we will split the generated observations into two parts in a ratio of 70:30, designated as training and test (validation) sets. The training set will be used for constructing the classifier, while the test set will be used for calculating classification errors and potentially other model characteristics. We can then compare the resulting classifiers based on these computed characteristics regarding their classification success.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb398"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb398-1"><a href="simulace3diskr.html#cb398-1" tabindex="-1"></a><span class="co"># splitting into test and training sets</span></span>
<span id="cb398-2"><a href="simulace3diskr.html#cb398-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb398-3"><a href="simulace3diskr.html#cb398-3" tabindex="-1"></a></span>
<span id="cb398-4"><a href="simulace3diskr.html#cb398-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb398-5"><a href="simulace3diskr.html#cb398-5" tabindex="-1"></a></span>
<span id="cb398-6"><a href="simulace3diskr.html#cb398-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb398-7"><a href="simulace3diskr.html#cb398-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb398-8"><a href="simulace3diskr.html#cb398-8" tabindex="-1"></a></span>
<span id="cb398-9"><a href="simulace3diskr.html#cb398-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb398-10"><a href="simulace3diskr.html#cb398-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, we will examine the representation of individual groups in the test and training data.</p>
<div id="decision-trees-1" class="section level3 hasAnchor" number="4.3.1">
<h3><span class="header-section-number">4.3.1</span> Decision Trees<a href="simulace3diskr.html#decision-trees-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Decision trees are a popular tool for classification; however, similar to some previous methods, they are not directly designed for functional data. Nevertheless, there are ways to convert functional objects into multidimensional ones and then apply decision tree algorithms to them. We can consider the following approaches:</p>
<ul>
<li>An algorithm constructed on basis coefficients,</li>
<li>Using scores of principal components,</li>
<li>Discretizing the interval and evaluating the function only at some finite grid points.</li>
</ul>
<p>We will, of course, choose the last option. First, we need to define points from the interval <span class="math inline">\(I = [0, 6]\)</span> at which we will evaluate the functions. Next, we will create an object where the rows represent individual (discretized) functions and the columns represent time. Finally, we will append a column <span class="math inline">\(Y\)</span> with information about classification class membership and repeat the same for the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb399"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb399-1"><a href="simulace3diskr.html#cb399-1" tabindex="-1"></a><span class="co"># sequence of points where we evaluate the functions</span></span>
<span id="cb399-2"><a href="simulace3diskr.html#cb399-2" tabindex="-1"></a>p <span class="ot">&lt;-</span> <span class="dv">101</span></span>
<span id="cb399-3"><a href="simulace3diskr.html#cb399-3" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> p)</span>
<span id="cb399-4"><a href="simulace3diskr.html#cb399-4" tabindex="-1"></a></span>
<span id="cb399-5"><a href="simulace3diskr.html#cb399-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb399-6"><a href="simulace3diskr.html#cb399-6" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for functions in rows</span></span>
<span id="cb399-7"><a href="simulace3diskr.html#cb399-7" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb399-8"><a href="simulace3diskr.html#cb399-8" tabindex="-1"></a></span>
<span id="cb399-9"><a href="simulace3diskr.html#cb399-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb399-10"><a href="simulace3diskr.html#cb399-10" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb399-11"><a href="simulace3diskr.html#cb399-11" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>Now we can construct a decision tree, using all the times from the vector <code>t.seq</code> as predictors. This classification is not sensitive to multicollinearity, so we do not need to concern ourselves with it. We will choose accuracy as the metric.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb400"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb400-1"><a href="simulace3diskr.html#cb400-1" tabindex="-1"></a><span class="co"># constructing the model</span></span>
<span id="cb400-2"><a href="simulace3diskr.html#cb400-2" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb400-3"><a href="simulace3diskr.html#cb400-3" tabindex="-1"></a>clf.tree <span class="ot">&lt;-</span> <span class="fu">train</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb400-4"><a href="simulace3diskr.html#cb400-4" tabindex="-1"></a>                 <span class="at">method =</span> <span class="st">&quot;rpart&quot;</span>, </span>
<span id="cb400-5"><a href="simulace3diskr.html#cb400-5" tabindex="-1"></a>                 <span class="at">trControl =</span> <span class="fu">trainControl</span>(<span class="at">method =</span> <span class="st">&quot;CV&quot;</span>, <span class="at">number =</span> <span class="dv">10</span>),</span>
<span id="cb400-6"><a href="simulace3diskr.html#cb400-6" tabindex="-1"></a>                 <span class="at">metric =</span> <span class="st">&quot;Accuracy&quot;</span>)</span>
<span id="cb400-7"><a href="simulace3diskr.html#cb400-7" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb400-8"><a href="simulace3diskr.html#cb400-8" tabindex="-1"></a></span>
<span id="cb400-9"><a href="simulace3diskr.html#cb400-9" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb400-10"><a href="simulace3diskr.html#cb400-10" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data)</span>
<span id="cb400-11"><a href="simulace3diskr.html#cb400-11" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb400-12"><a href="simulace3diskr.html#cb400-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb400-13"><a href="simulace3diskr.html#cb400-13" tabindex="-1"></a></span>
<span id="cb400-14"><a href="simulace3diskr.html#cb400-14" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb400-15"><a href="simulace3diskr.html#cb400-15" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.tree, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb400-16"><a href="simulace3diskr.html#cb400-16" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb400-17"><a href="simulace3diskr.html#cb400-17" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the classifier on the test data is therefore 46.67 %, and on the training data, it is 33.57 %. We will calculate the time taken as follows.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb401"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb401-1"><a href="simulace3diskr.html#cb401-1" tabindex="-1"></a>duration <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb401-2"><a href="simulace3diskr.html#cb401-2" tabindex="-1"></a>duration <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
</details>
<pre><code>## Time difference of 0.718204 secs</code></pre>
<p>We can graphically visualize the decision tree using the <code>fancyRpartPlot()</code> function. We will set the colors of the nodes to reflect the previous color differentiation. This will be an unpruned tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb403"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb403-1"><a href="simulace3diskr.html#cb403-1" tabindex="-1"></a><span class="fu">colnames</span>(grid.data) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">paste0</span>(<span class="st">&#39;time:&#39;</span>, t.seq), <span class="st">&#39;Y&#39;</span>)</span>
<span id="cb403-2"><a href="simulace3diskr.html#cb403-2" tabindex="-1"></a><span class="fu">fancyRpartPlot</span>(<span class="fu">rpart</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, <span class="at">method =</span> <span class="st">&quot;class&quot;</span>),</span>
<span id="cb403-3"><a href="simulace3diskr.html#cb403-3" tabindex="-1"></a>               <span class="at">sub =</span> <span class="st">&#39;&#39;</span>, <span class="at">palettes =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>)) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-23"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-23-1.png" alt="Graphical representation of the unpruned decision tree. Nodes belonging to classification class 1 are shown in shades of blue, and those belonging to class 0 are in shades of red." width="672" />
<p class="caption">
Figure 1.8: Graphical representation of the unpruned decision tree. Nodes belonging to classification class 1 are shown in shades of blue, and those belonging to class 0 are in shades of red.
</p>
</div>
<p>We can also plot the final pruned decision tree.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb404"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb404-1"><a href="simulace3diskr.html#cb404-1" tabindex="-1"></a>rpart.plot<span class="sc">::</span><span class="fu">rpart.plot</span>(clf.tree<span class="sc">$</span>finalModel, <span class="co"># final model ... pruned tree</span></span>
<span id="cb404-2"><a href="simulace3diskr.html#cb404-2" tabindex="-1"></a>                       <span class="at">extra =</span> <span class="dv">104</span>, <span class="co"># display required information</span></span>
<span id="cb404-3"><a href="simulace3diskr.html#cb404-3" tabindex="-1"></a>                       <span class="at">box.palette =</span> <span class="fu">c</span>(<span class="st">&#39;Reds&#39;</span>, <span class="st">&#39;Blues&#39;</span>),</span>
<span id="cb404-4"><a href="simulace3diskr.html#cb404-4" tabindex="-1"></a>                       <span class="at">branch.lty =</span> <span class="dv">3</span>, <span class="co"># dotted branch lines</span></span>
<span id="cb404-5"><a href="simulace3diskr.html#cb404-5" tabindex="-1"></a>                       <span class="at">shadow.col =</span> <span class="dv">0</span>, <span class="co"># shadows under the node boxes</span></span>
<span id="cb404-6"><a href="simulace3diskr.html#cb404-6" tabindex="-1"></a>                       <span class="at">nn =</span> <span class="cn">FALSE</span>, </span>
<span id="cb404-7"><a href="simulace3diskr.html#cb404-7" tabindex="-1"></a>                       <span class="at">under =</span> <span class="cn">FALSE</span>, </span>
<span id="cb404-8"><a href="simulace3diskr.html#cb404-8" tabindex="-1"></a>                       <span class="at">digits =</span> <span class="dv">2</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-24-1.png" alt="Final pruned decision tree." width="672" />
<p class="caption">
Figure 2.3: Final pruned decision tree.
</p>
</div>
<p>Finally, let’s add the training and test error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb405"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb405-1"><a href="simulace3diskr.html#cb405-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;Tree - discr.&#39;</span>, </span>
<span id="cb405-2"><a href="simulace3diskr.html#cb405-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb405-3"><a href="simulace3diskr.html#cb405-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test,</span>
<span id="cb405-4"><a href="simulace3diskr.html#cb405-4" tabindex="-1"></a>                  <span class="at">Duration =</span> <span class="fu">as.numeric</span>(duration))</span></code></pre></div>
</details>
</div>
<div id="random-forests-2" class="section level3 hasAnchor" number="4.3.2">
<h3><span class="header-section-number">4.3.2</span> Random Forests<a href="simulace3diskr.html#random-forests-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The classifier constructed using the random forests method consists of building several individual decision trees, which are subsequently combined to create a common classifier (through a collective “vote”).</p>
<p>As with decision trees, we have several options regarding what data (finite-dimensional) to use for constructing the model. We will again consider discretization of the interval. In this case, we utilize the evaluation of functions on a given grid of points in the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb406"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb406-1"><a href="simulace3diskr.html#cb406-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb406-2"><a href="simulace3diskr.html#cb406-2" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb406-3"><a href="simulace3diskr.html#cb406-3" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb406-4"><a href="simulace3diskr.html#cb406-4" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb406-5"><a href="simulace3diskr.html#cb406-5" tabindex="-1"></a>                       <span class="at">importance =</span> F,</span>
<span id="cb406-6"><a href="simulace3diskr.html#cb406-6" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">1</span>)</span>
<span id="cb406-7"><a href="simulace3diskr.html#cb406-7" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb406-8"><a href="simulace3diskr.html#cb406-8" tabindex="-1"></a></span>
<span id="cb406-9"><a href="simulace3diskr.html#cb406-9" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb406-10"><a href="simulace3diskr.html#cb406-10" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb406-11"><a href="simulace3diskr.html#cb406-11" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb406-12"><a href="simulace3diskr.html#cb406-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb406-13"><a href="simulace3diskr.html#cb406-13" tabindex="-1"></a>  </span>
<span id="cb406-14"><a href="simulace3diskr.html#cb406-14" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb406-15"><a href="simulace3diskr.html#cb406-15" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb406-16"><a href="simulace3diskr.html#cb406-16" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb406-17"><a href="simulace3diskr.html#cb406-17" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is therefore 0 % and on the test data 40 %. We will calculate the time complexity as follows.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb407"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb407-1"><a href="simulace3diskr.html#cb407-1" tabindex="-1"></a>duration <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb407-2"><a href="simulace3diskr.html#cb407-2" tabindex="-1"></a>duration <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
</details>
<pre><code>## Time difference of 0.302609 secs</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb409"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb409-1"><a href="simulace3diskr.html#cb409-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discr&#39;</span>, </span>
<span id="cb409-2"><a href="simulace3diskr.html#cb409-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb409-3"><a href="simulace3diskr.html#cb409-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test,</span>
<span id="cb409-4"><a href="simulace3diskr.html#cb409-4" tabindex="-1"></a>                  <span class="at">Duration =</span> <span class="fu">as.numeric</span>(duration))</span>
<span id="cb409-5"><a href="simulace3diskr.html#cb409-5" tabindex="-1"></a></span>
<span id="cb409-6"><a href="simulace3diskr.html#cb409-6" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="support-vector-machines-3" class="section level3 hasAnchor" number="4.3.3">
<h3><span class="header-section-number">4.3.3</span> Support Vector Machines<a href="simulace3diskr.html#support-vector-machines-3" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Now let’s look at classifying our simulated curves using the Support Vector Machines (SVM) method. The advantage of this classification method is its computational efficiency, as it uses only a few (often very few) observations to define the boundary curve between classes.</p>
<p>In the case of functional data, we have several options for applying the SVM method. The simplest variant is to use this classification method directly on the discretized function. We will start by applying the support vector method directly to the discretized data (evaluation of the function on a given grid of points in the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three aforementioned kernel functions. First, however, we will normalize the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb410"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb410-1"><a href="simulace3diskr.html#cb410-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb410-2"><a href="simulace3diskr.html#cb410-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb410-3"><a href="simulace3diskr.html#cb410-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb410-4"><a href="simulace3diskr.html#cb410-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb410-5"><a href="simulace3diskr.html#cb410-5" tabindex="-1"></a>  }</span>
<span id="cb410-6"><a href="simulace3diskr.html#cb410-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb410-7"><a href="simulace3diskr.html#cb410-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb410-8"><a href="simulace3diskr.html#cb410-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb410-9"><a href="simulace3diskr.html#cb410-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb410-10"><a href="simulace3diskr.html#cb410-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> T)</span>
<span id="cb410-11"><a href="simulace3diskr.html#cb410-11" tabindex="-1"></a></span>
<span id="cb410-12"><a href="simulace3diskr.html#cb410-12" tabindex="-1"></a><span class="co"># split into test and training parts</span></span>
<span id="cb410-13"><a href="simulace3diskr.html#cb410-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb410-14"><a href="simulace3diskr.html#cb410-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb410-15"><a href="simulace3diskr.html#cb410-15" tabindex="-1"></a></span>
<span id="cb410-16"><a href="simulace3diskr.html#cb410-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb410-17"><a href="simulace3diskr.html#cb410-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb410-18"><a href="simulace3diskr.html#cb410-18" tabindex="-1"></a></span>
<span id="cb410-19"><a href="simulace3diskr.html#cb410-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb410-20"><a href="simulace3diskr.html#cb410-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb410-21"><a href="simulace3diskr.html#cb410-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb410-22"><a href="simulace3diskr.html#cb410-22" tabindex="-1"></a></span>
<span id="cb410-23"><a href="simulace3diskr.html#cb410-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb410-24"><a href="simulace3diskr.html#cb410-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb410-25"><a href="simulace3diskr.html#cb410-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb411"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb411-1"><a href="simulace3diskr.html#cb411-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb411-2"><a href="simulace3diskr.html#cb411-2" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-3"><a href="simulace3diskr.html#cb411-3" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb411-4"><a href="simulace3diskr.html#cb411-4" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb411-5"><a href="simulace3diskr.html#cb411-5" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb411-6"><a href="simulace3diskr.html#cb411-6" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb411-7"><a href="simulace3diskr.html#cb411-7" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb411-8"><a href="simulace3diskr.html#cb411-8" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-9"><a href="simulace3diskr.html#cb411-9" tabindex="-1"></a></span>
<span id="cb411-10"><a href="simulace3diskr.html#cb411-10" tabindex="-1"></a>duration.l <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb411-11"><a href="simulace3diskr.html#cb411-11" tabindex="-1"></a></span>
<span id="cb411-12"><a href="simulace3diskr.html#cb411-12" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-13"><a href="simulace3diskr.html#cb411-13" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb411-14"><a href="simulace3diskr.html#cb411-14" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb411-15"><a href="simulace3diskr.html#cb411-15" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb411-16"><a href="simulace3diskr.html#cb411-16" tabindex="-1"></a>                 <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb411-17"><a href="simulace3diskr.html#cb411-17" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb411-18"><a href="simulace3diskr.html#cb411-18" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb411-19"><a href="simulace3diskr.html#cb411-19" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-20"><a href="simulace3diskr.html#cb411-20" tabindex="-1"></a></span>
<span id="cb411-21"><a href="simulace3diskr.html#cb411-21" tabindex="-1"></a>duration.p <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb411-22"><a href="simulace3diskr.html#cb411-22" tabindex="-1"></a></span>
<span id="cb411-23"><a href="simulace3diskr.html#cb411-23" tabindex="-1"></a>start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-24"><a href="simulace3diskr.html#cb411-24" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb411-25"><a href="simulace3diskr.html#cb411-25" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb411-26"><a href="simulace3diskr.html#cb411-26" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb411-27"><a href="simulace3diskr.html#cb411-27" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb411-28"><a href="simulace3diskr.html#cb411-28" tabindex="-1"></a>                 <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb411-29"><a href="simulace3diskr.html#cb411-29" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb411-30"><a href="simulace3diskr.html#cb411-30" tabindex="-1"></a>end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb411-31"><a href="simulace3diskr.html#cb411-31" tabindex="-1"></a></span>
<span id="cb411-32"><a href="simulace3diskr.html#cb411-32" tabindex="-1"></a>duration.r <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb411-33"><a href="simulace3diskr.html#cb411-33" tabindex="-1"></a></span>
<span id="cb411-34"><a href="simulace3diskr.html#cb411-34" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb411-35"><a href="simulace3diskr.html#cb411-35" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb411-36"><a href="simulace3diskr.html#cb411-36" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb411-37"><a href="simulace3diskr.html#cb411-37" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb411-38"><a href="simulace3diskr.html#cb411-38" tabindex="-1"></a></span>
<span id="cb411-39"><a href="simulace3diskr.html#cb411-39" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb411-40"><a href="simulace3diskr.html#cb411-40" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb411-41"><a href="simulace3diskr.html#cb411-41" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb411-42"><a href="simulace3diskr.html#cb411-42" tabindex="-1"></a></span>
<span id="cb411-43"><a href="simulace3diskr.html#cb411-43" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb411-44"><a href="simulace3diskr.html#cb411-44" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb411-45"><a href="simulace3diskr.html#cb411-45" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb411-46"><a href="simulace3diskr.html#cb411-46" tabindex="-1"></a></span>
<span id="cb411-47"><a href="simulace3diskr.html#cb411-47" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb411-48"><a href="simulace3diskr.html#cb411-48" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb411-49"><a href="simulace3diskr.html#cb411-49" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb411-50"><a href="simulace3diskr.html#cb411-50" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb411-51"><a href="simulace3diskr.html#cb411-51" tabindex="-1"></a></span>
<span id="cb411-52"><a href="simulace3diskr.html#cb411-52" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb411-53"><a href="simulace3diskr.html#cb411-53" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb411-54"><a href="simulace3diskr.html#cb411-54" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb411-55"><a href="simulace3diskr.html#cb411-55" tabindex="-1"></a></span>
<span id="cb411-56"><a href="simulace3diskr.html#cb411-56" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb411-57"><a href="simulace3diskr.html#cb411-57" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb411-58"><a href="simulace3diskr.html#cb411-58" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is therefore 5.71 % for the linear kernel, 2.14 % for the polynomial kernel, and 3.57 % for the Gaussian kernel. On the test data, the error rate of the method is 16.67 % for the linear kernel, 16.67 % for the polynomial kernel, and 13.33 % for the radial kernel. We will calculate the time complexity as follows.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb412"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb412-1"><a href="simulace3diskr.html#cb412-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Linear kernel:&#39;</span>, <span class="at">quote =</span> F)</span></code></pre></div>
</details>
<pre><code>## [1] Linear kernel:</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb414"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb414-1"><a href="simulace3diskr.html#cb414-1" tabindex="-1"></a>duration.l <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
</details>
<pre><code>## Time difference of 0.04756021 secs</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb416"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb416-1"><a href="simulace3diskr.html#cb416-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Polynomial kernel:&#39;</span>, <span class="at">quote =</span> F)</span></code></pre></div>
</details>
<pre><code>## [1] Polynomial kernel:</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb418"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb418-1"><a href="simulace3diskr.html#cb418-1" tabindex="-1"></a>duration.p <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
</details>
<pre><code>## Time difference of 0.03182602 secs</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb420"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb420-1"><a href="simulace3diskr.html#cb420-1" tabindex="-1"></a><span class="fu">print</span>(<span class="st">&#39;Radial kernel:&#39;</span>, <span class="at">quote =</span> F)</span></code></pre></div>
</details>
<pre><code>## [1] Radial kernel:</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb422"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb422-1"><a href="simulace3diskr.html#cb422-1" tabindex="-1"></a>duration.r <span class="sc">|&gt;</span> <span class="fu">print</span>()</span></code></pre></div>
</details>
<pre><code>## Time difference of 0.06402302 secs</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb424"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb424-1"><a href="simulace3diskr.html#cb424-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb424-2"><a href="simulace3diskr.html#cb424-2" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb424-3"><a href="simulace3diskr.html#cb424-3" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb424-4"><a href="simulace3diskr.html#cb424-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb424-5"><a href="simulace3diskr.html#cb424-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r),</span>
<span id="cb424-6"><a href="simulace3diskr.html#cb424-6" tabindex="-1"></a>                  <span class="at">Duration =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(duration.l), </span>
<span id="cb424-7"><a href="simulace3diskr.html#cb424-7" tabindex="-1"></a>                               <span class="fu">as.numeric</span>(duration.p), <span class="fu">as.numeric</span>(duration.r)))</span>
<span id="cb424-8"><a href="simulace3diskr.html#cb424-8" tabindex="-1"></a></span>
<span id="cb424-9"><a href="simulace3diskr.html#cb424-9" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="results-table-2" class="section level3 hasAnchor" number="4.3.4">
<h3><span class="header-section-number">4.3.4</span> Results Table<a href="simulace3diskr.html#results-table-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-34">Table 4.1: </span>Summary of results of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
<th align="right">Duration</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Tree - discr.</td>
<td align="center">0.3357</td>
<td align="center">0.4667</td>
<td align="right">0.7182</td>
</tr>
<tr class="even">
<td align="left">RForest - discr</td>
<td align="center">0.0000</td>
<td align="center">0.4000</td>
<td align="right">0.3026</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - discr</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
<td align="right">0.0476</td>
</tr>
<tr class="even">
<td align="left">SVM poly - discr</td>
<td align="center">0.0214</td>
<td align="center">0.1667</td>
<td align="right">0.0318</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - discr</td>
<td align="center">0.0357</td>
<td align="center">0.1333</td>
<td align="right">0.0640</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simul3diskr" class="section level2 hasAnchor" number="4.4">
<h2><span class="header-section-number">4.4</span> Simulation Study<a href="simulace3diskr.html#simul3diskr" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the entire previous section, we dealt with only one randomly generated dataset from two classification classes, which we then randomly split into test and training parts. We then evaluated the individual classifiers obtained using the considered methods based on test and training error rates.</p>
<p>Since the generated data (and their division into two parts) can vary significantly with each repetition, the error rates of the individual classification algorithms will also differ significantly. Therefore, making any conclusions about the methods and comparing them based on a single generated dataset can be very misleading.</p>
<p>For this reason, in this section, we will focus on repeating the entire previous procedure for different generated datasets. We will store the results in a table and finally calculate the average characteristics of the models across the individual repetitions. To ensure our conclusions are sufficiently general, we will choose the number of repetitions <span class="math inline">\(n_{sim} = 50\)</span>.</p>
<p>Now we will repeat the entire previous section <span class="math inline">\(n.sim\)</span> times, and we will store the error rates in the object <code>SIMUL_params</code>. At the same time, we will change the value of the parameter <span class="math inline">\(p\)</span> and observe how the results of the selected classification methods change with this value.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb425"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb425-1"><a href="simulace3diskr.html#cb425-1" tabindex="-1"></a><span class="co"># nastaveni generatoru pseudonahodnych cisel</span></span>
<span id="cb425-2"><a href="simulace3diskr.html#cb425-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb425-3"><a href="simulace3diskr.html#cb425-3" tabindex="-1"></a></span>
<span id="cb425-4"><a href="simulace3diskr.html#cb425-4" tabindex="-1"></a><span class="co"># pocet simulaci pro kazdou hodnotu simulacniho parametru</span></span>
<span id="cb425-5"><a href="simulace3diskr.html#cb425-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb425-6"><a href="simulace3diskr.html#cb425-6" tabindex="-1"></a></span>
<span id="cb425-7"><a href="simulace3diskr.html#cb425-7" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;RF_discr&#39;</span>,</span>
<span id="cb425-8"><a href="simulace3diskr.html#cb425-8" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>)</span>
<span id="cb425-9"><a href="simulace3diskr.html#cb425-9" tabindex="-1"></a></span>
<span id="cb425-10"><a href="simulace3diskr.html#cb425-10" tabindex="-1"></a><span class="co"># vektor delek p ekvidistantni posloupnosti </span></span>
<span id="cb425-11"><a href="simulace3diskr.html#cb425-11" tabindex="-1"></a>p_vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">4</span>, <span class="dv">250</span>, <span class="at">by =</span> <span class="dv">2</span>)</span>
<span id="cb425-12"><a href="simulace3diskr.html#cb425-12" tabindex="-1"></a><span class="co"># p_vector &lt;- seq(10, 250, by = 10)</span></span>
<span id="cb425-13"><a href="simulace3diskr.html#cb425-13" tabindex="-1"></a></span>
<span id="cb425-14"><a href="simulace3diskr.html#cb425-14" tabindex="-1"></a><span class="co"># vysledny objekt, do nehoz ukladame vysledky simulaci</span></span>
<span id="cb425-15"><a href="simulace3diskr.html#cb425-15" tabindex="-1"></a>SIMUL_params <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(methods), <span class="dv">6</span>, <span class="fu">length</span>(p_vector)),</span>
<span id="cb425-16"><a href="simulace3diskr.html#cb425-16" tabindex="-1"></a>                      <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb425-17"><a href="simulace3diskr.html#cb425-17" tabindex="-1"></a>                        <span class="at">method =</span> methods,</span>
<span id="cb425-18"><a href="simulace3diskr.html#cb425-18" tabindex="-1"></a>                        <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">&#39;ERRtrain&#39;</span>, <span class="st">&#39;Errtest&#39;</span>, </span>
<span id="cb425-19"><a href="simulace3diskr.html#cb425-19" tabindex="-1"></a>                                   <span class="st">&#39;SDtrain&#39;</span>, <span class="st">&#39;SDtest&#39;</span>, <span class="st">&#39;Duration&#39;</span>, <span class="st">&#39;SDduration&#39;</span>),</span>
<span id="cb425-20"><a href="simulace3diskr.html#cb425-20" tabindex="-1"></a>                        <span class="at">sigma =</span> <span class="fu">paste0</span>(p_vector)))</span>
<span id="cb425-21"><a href="simulace3diskr.html#cb425-21" tabindex="-1"></a></span>
<span id="cb425-22"><a href="simulace3diskr.html#cb425-22" tabindex="-1"></a><span class="co"># CV_res &lt;- data.frame(matrix(NA, ncol = 4, </span></span>
<span id="cb425-23"><a href="simulace3diskr.html#cb425-23" tabindex="-1"></a><span class="co">#                             nrow = length(p_vector),</span></span>
<span id="cb425-24"><a href="simulace3diskr.html#cb425-24" tabindex="-1"></a><span class="co">#                             dimnames = list(paste0(p_vector),</span></span>
<span id="cb425-25"><a href="simulace3diskr.html#cb425-25" tabindex="-1"></a><span class="co">#                                             c(&#39;C.l&#39;, &#39;C.p&#39;, &#39;C.r&#39;, &#39;gamma&#39;))))</span></span>
<span id="cb425-26"><a href="simulace3diskr.html#cb425-26" tabindex="-1"></a></span>
<span id="cb425-27"><a href="simulace3diskr.html#cb425-27" tabindex="-1"></a><span class="cf">for</span> (n_p <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(p_vector)) {</span>
<span id="cb425-28"><a href="simulace3diskr.html#cb425-28" tabindex="-1"></a>  <span class="do">## list, do ktereho budeme ukladat hodnoty chybovosti</span></span>
<span id="cb425-29"><a href="simulace3diskr.html#cb425-29" tabindex="-1"></a>  <span class="co"># ve sloupcich budou metody</span></span>
<span id="cb425-30"><a href="simulace3diskr.html#cb425-30" tabindex="-1"></a>  <span class="co"># v radcich budou jednotliva opakovani</span></span>
<span id="cb425-31"><a href="simulace3diskr.html#cb425-31" tabindex="-1"></a>  <span class="co"># list ma dve polozky ... train a test</span></span>
<span id="cb425-32"><a href="simulace3diskr.html#cb425-32" tabindex="-1"></a>  SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb425-33"><a href="simulace3diskr.html#cb425-33" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb425-34"><a href="simulace3diskr.html#cb425-34" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb425-35"><a href="simulace3diskr.html#cb425-35" tabindex="-1"></a>                   <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb425-36"><a href="simulace3diskr.html#cb425-36" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb425-37"><a href="simulace3diskr.html#cb425-37" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))),</span>
<span id="cb425-38"><a href="simulace3diskr.html#cb425-38" tabindex="-1"></a>                   <span class="at">duration =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb425-39"><a href="simulace3diskr.html#cb425-39" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb425-40"><a href="simulace3diskr.html#cb425-40" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods)))<span class="co">#,</span></span>
<span id="cb425-41"><a href="simulace3diskr.html#cb425-41" tabindex="-1"></a>                   <span class="co"># CV = as.data.frame(matrix(NA, ncol = 4, </span></span>
<span id="cb425-42"><a href="simulace3diskr.html#cb425-42" tabindex="-1"></a>                   <span class="co">#                             nrow = n.sim,</span></span>
<span id="cb425-43"><a href="simulace3diskr.html#cb425-43" tabindex="-1"></a>                   <span class="co">#                             dimnames = list(1:n.sim, </span></span>
<span id="cb425-44"><a href="simulace3diskr.html#cb425-44" tabindex="-1"></a>                   <span class="co">#                                             c(&#39;C.l&#39;, &#39;C.p&#39;, &#39;C.r&#39;, &#39;gamma&#39;))))</span></span>
<span id="cb425-45"><a href="simulace3diskr.html#cb425-45" tabindex="-1"></a>                   )</span>
<span id="cb425-46"><a href="simulace3diskr.html#cb425-46" tabindex="-1"></a>  </span>
<span id="cb425-47"><a href="simulace3diskr.html#cb425-47" tabindex="-1"></a>  <span class="do">## SIMULACE</span></span>
<span id="cb425-48"><a href="simulace3diskr.html#cb425-48" tabindex="-1"></a>  </span>
<span id="cb425-49"><a href="simulace3diskr.html#cb425-49" tabindex="-1"></a>  <span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb425-50"><a href="simulace3diskr.html#cb425-50" tabindex="-1"></a>    <span class="co"># pocet vygenerovanych pozorovani pro kazdou tridu</span></span>
<span id="cb425-51"><a href="simulace3diskr.html#cb425-51" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb425-52"><a href="simulace3diskr.html#cb425-52" tabindex="-1"></a>    <span class="co"># vektor casu ekvidistantni na intervalu [0, 6]</span></span>
<span id="cb425-53"><a href="simulace3diskr.html#cb425-53" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb425-54"><a href="simulace3diskr.html#cb425-54" tabindex="-1"></a>    </span>
<span id="cb425-55"><a href="simulace3diskr.html#cb425-55" tabindex="-1"></a>    <span class="co"># pro Y = 0</span></span>
<span id="cb425-56"><a href="simulace3diskr.html#cb425-56" tabindex="-1"></a>    X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb425-57"><a href="simulace3diskr.html#cb425-57" tabindex="-1"></a>    <span class="co"># pro Y = 1</span></span>
<span id="cb425-58"><a href="simulace3diskr.html#cb425-58" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb425-59"><a href="simulace3diskr.html#cb425-59" tabindex="-1"></a>    </span>
<span id="cb425-60"><a href="simulace3diskr.html#cb425-60" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb425-61"><a href="simulace3diskr.html#cb425-61" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> t</span>
<span id="cb425-62"><a href="simulace3diskr.html#cb425-62" tabindex="-1"></a>    norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb425-63"><a href="simulace3diskr.html#cb425-63" tabindex="-1"></a>    </span>
<span id="cb425-64"><a href="simulace3diskr.html#cb425-64" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb425-65"><a href="simulace3diskr.html#cb425-65" tabindex="-1"></a>                                   <span class="at">norder =</span> norder, </span>
<span id="cb425-66"><a href="simulace3diskr.html#cb425-66" tabindex="-1"></a>                                   <span class="at">breaks =</span> breaks)</span>
<span id="cb425-67"><a href="simulace3diskr.html#cb425-67" tabindex="-1"></a>    </span>
<span id="cb425-68"><a href="simulace3diskr.html#cb425-68" tabindex="-1"></a>    curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb425-69"><a href="simulace3diskr.html#cb425-69" tabindex="-1"></a>    <span class="co"># spojeni pozorovani do jedne matice</span></span>
<span id="cb425-70"><a href="simulace3diskr.html#cb425-70" tabindex="-1"></a>    XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb425-71"><a href="simulace3diskr.html#cb425-71" tabindex="-1"></a>    </span>
<span id="cb425-72"><a href="simulace3diskr.html#cb425-72" tabindex="-1"></a>    lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">4</span>, <span class="at">to =</span> <span class="dv">2</span>, <span class="at">length.out =</span> <span class="dv">40</span>) <span class="co"># vektor lambd</span></span>
<span id="cb425-73"><a href="simulace3diskr.html#cb425-73" tabindex="-1"></a>    gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># prazdny vektor pro ulozebi GCV</span></span>
<span id="cb425-74"><a href="simulace3diskr.html#cb425-74" tabindex="-1"></a>    </span>
<span id="cb425-75"><a href="simulace3diskr.html#cb425-75" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb425-76"><a href="simulace3diskr.html#cb425-76" tabindex="-1"></a>      curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb425-77"><a href="simulace3diskr.html#cb425-77" tabindex="-1"></a>      BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># vyhlazeni</span></span>
<span id="cb425-78"><a href="simulace3diskr.html#cb425-78" tabindex="-1"></a>      gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># prumer pres vsechny pozorovane krivky</span></span>
<span id="cb425-79"><a href="simulace3diskr.html#cb425-79" tabindex="-1"></a>    }</span>
<span id="cb425-80"><a href="simulace3diskr.html#cb425-80" tabindex="-1"></a>    </span>
<span id="cb425-81"><a href="simulace3diskr.html#cb425-81" tabindex="-1"></a>    GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb425-82"><a href="simulace3diskr.html#cb425-82" tabindex="-1"></a>      <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb425-83"><a href="simulace3diskr.html#cb425-83" tabindex="-1"></a>      <span class="at">GCV =</span> gcv</span>
<span id="cb425-84"><a href="simulace3diskr.html#cb425-84" tabindex="-1"></a>    )</span>
<span id="cb425-85"><a href="simulace3diskr.html#cb425-85" tabindex="-1"></a>    </span>
<span id="cb425-86"><a href="simulace3diskr.html#cb425-86" tabindex="-1"></a>    <span class="co"># najdeme hodnotu minima</span></span>
<span id="cb425-87"><a href="simulace3diskr.html#cb425-87" tabindex="-1"></a>    lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb425-88"><a href="simulace3diskr.html#cb425-88" tabindex="-1"></a>    </span>
<span id="cb425-89"><a href="simulace3diskr.html#cb425-89" tabindex="-1"></a>    curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb425-90"><a href="simulace3diskr.html#cb425-90" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb425-91"><a href="simulace3diskr.html#cb425-91" tabindex="-1"></a>    XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb425-92"><a href="simulace3diskr.html#cb425-92" tabindex="-1"></a>    </span>
<span id="cb425-93"><a href="simulace3diskr.html#cb425-93" tabindex="-1"></a>    fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb425-94"><a href="simulace3diskr.html#cb425-94" tabindex="-1"></a>    </span>
<span id="cb425-95"><a href="simulace3diskr.html#cb425-95" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb425-96"><a href="simulace3diskr.html#cb425-96" tabindex="-1"></a>    split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb425-97"><a href="simulace3diskr.html#cb425-97" tabindex="-1"></a>    </span>
<span id="cb425-98"><a href="simulace3diskr.html#cb425-98" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb425-99"><a href="simulace3diskr.html#cb425-99" tabindex="-1"></a>    </span>
<span id="cb425-100"><a href="simulace3diskr.html#cb425-100" tabindex="-1"></a>    X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb425-101"><a href="simulace3diskr.html#cb425-101" tabindex="-1"></a>    X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb425-102"><a href="simulace3diskr.html#cb425-102" tabindex="-1"></a>    </span>
<span id="cb425-103"><a href="simulace3diskr.html#cb425-103" tabindex="-1"></a>    Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb425-104"><a href="simulace3diskr.html#cb425-104" tabindex="-1"></a>    Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb425-105"><a href="simulace3diskr.html#cb425-105" tabindex="-1"></a>    </span>
<span id="cb425-106"><a href="simulace3diskr.html#cb425-106" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb425-107"><a href="simulace3diskr.html#cb425-107" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb425-108"><a href="simulace3diskr.html#cb425-108" tabindex="-1"></a>    </span>
<span id="cb425-109"><a href="simulace3diskr.html#cb425-109" tabindex="-1"></a>    <span class="do">## 1) Rozhodovací stromy</span></span>
<span id="cb425-110"><a href="simulace3diskr.html#cb425-110" tabindex="-1"></a>    </span>
<span id="cb425-111"><a href="simulace3diskr.html#cb425-111" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb425-112"><a href="simulace3diskr.html#cb425-112" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> p_vector[n_p])</span>
<span id="cb425-113"><a href="simulace3diskr.html#cb425-113" tabindex="-1"></a>       </span>
<span id="cb425-114"><a href="simulace3diskr.html#cb425-114" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb425-115"><a href="simulace3diskr.html#cb425-115" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb425-116"><a href="simulace3diskr.html#cb425-116" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb425-117"><a href="simulace3diskr.html#cb425-117" tabindex="-1"></a>    </span>
<span id="cb425-118"><a href="simulace3diskr.html#cb425-118" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb425-119"><a href="simulace3diskr.html#cb425-119" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb425-120"><a href="simulace3diskr.html#cb425-120" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb425-121"><a href="simulace3diskr.html#cb425-121" tabindex="-1"></a>    </span>
<span id="cb425-122"><a href="simulace3diskr.html#cb425-122" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb425-123"><a href="simulace3diskr.html#cb425-123" tabindex="-1"></a>    <span class="co"># start_time &lt;- Sys.time()</span></span>
<span id="cb425-124"><a href="simulace3diskr.html#cb425-124" tabindex="-1"></a>    <span class="co"># clf.tree &lt;- train(Y ~ ., data = grid.data, </span></span>
<span id="cb425-125"><a href="simulace3diskr.html#cb425-125" tabindex="-1"></a>    <span class="co">#                  method = &quot;rpart&quot;, </span></span>
<span id="cb425-126"><a href="simulace3diskr.html#cb425-126" tabindex="-1"></a>    <span class="co">#                  trControl = trainControl(method = &quot;CV&quot;, number = 10),</span></span>
<span id="cb425-127"><a href="simulace3diskr.html#cb425-127" tabindex="-1"></a>    <span class="co">#                  metric = &quot;Accuracy&quot;)</span></span>
<span id="cb425-128"><a href="simulace3diskr.html#cb425-128" tabindex="-1"></a>    <span class="co"># end_time &lt;- Sys.time()</span></span>
<span id="cb425-129"><a href="simulace3diskr.html#cb425-129" tabindex="-1"></a>    <span class="co"># duration &lt;- end_time - start_time</span></span>
<span id="cb425-130"><a href="simulace3diskr.html#cb425-130" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb425-131"><a href="simulace3diskr.html#cb425-131" tabindex="-1"></a>    <span class="co"># # presnost na trenovacich datech</span></span>
<span id="cb425-132"><a href="simulace3diskr.html#cb425-132" tabindex="-1"></a>    <span class="co"># predictions.train &lt;- predict(clf.tree, newdata = grid.data)</span></span>
<span id="cb425-133"><a href="simulace3diskr.html#cb425-133" tabindex="-1"></a>    <span class="co"># presnost.train &lt;- table(Y.train, predictions.train) |&gt;</span></span>
<span id="cb425-134"><a href="simulace3diskr.html#cb425-134" tabindex="-1"></a>    <span class="co">#   prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb425-135"><a href="simulace3diskr.html#cb425-135" tabindex="-1"></a>    <span class="co">#   </span></span>
<span id="cb425-136"><a href="simulace3diskr.html#cb425-136" tabindex="-1"></a>    <span class="co"># # presnost na trenovacich datech</span></span>
<span id="cb425-137"><a href="simulace3diskr.html#cb425-137" tabindex="-1"></a>    <span class="co"># predictions.test &lt;- predict(clf.tree, newdata = grid.data.test)</span></span>
<span id="cb425-138"><a href="simulace3diskr.html#cb425-138" tabindex="-1"></a>    <span class="co"># presnost.test &lt;- table(Y.test, predictions.test) |&gt;</span></span>
<span id="cb425-139"><a href="simulace3diskr.html#cb425-139" tabindex="-1"></a>    <span class="co">#   prop.table() |&gt; diag() |&gt; sum()</span></span>
<span id="cb425-140"><a href="simulace3diskr.html#cb425-140" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb425-141"><a href="simulace3diskr.html#cb425-141" tabindex="-1"></a>    <span class="co"># RESULTS &lt;- data.frame(model = &#39;Tree_discr&#39;, </span></span>
<span id="cb425-142"><a href="simulace3diskr.html#cb425-142" tabindex="-1"></a>    <span class="co">#                   Err.train = 1 - presnost.train,</span></span>
<span id="cb425-143"><a href="simulace3diskr.html#cb425-143" tabindex="-1"></a>    <span class="co">#                   Err.test = 1 - presnost.test,</span></span>
<span id="cb425-144"><a href="simulace3diskr.html#cb425-144" tabindex="-1"></a>    <span class="co">#                   Duration = as.numeric(duration))</span></span>
<span id="cb425-145"><a href="simulace3diskr.html#cb425-145" tabindex="-1"></a>    </span>
<span id="cb425-146"><a href="simulace3diskr.html#cb425-146" tabindex="-1"></a>    <span class="do">## 2) Náhodné lesy</span></span>
<span id="cb425-147"><a href="simulace3diskr.html#cb425-147" tabindex="-1"></a>  </span>
<span id="cb425-148"><a href="simulace3diskr.html#cb425-148" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb425-149"><a href="simulace3diskr.html#cb425-149" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-150"><a href="simulace3diskr.html#cb425-150" tabindex="-1"></a>    clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb425-151"><a href="simulace3diskr.html#cb425-151" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb425-152"><a href="simulace3diskr.html#cb425-152" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb425-153"><a href="simulace3diskr.html#cb425-153" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb425-154"><a href="simulace3diskr.html#cb425-154" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-155"><a href="simulace3diskr.html#cb425-155" tabindex="-1"></a>    duration <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb425-156"><a href="simulace3diskr.html#cb425-156" tabindex="-1"></a>    </span>
<span id="cb425-157"><a href="simulace3diskr.html#cb425-157" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb425-158"><a href="simulace3diskr.html#cb425-158" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb425-159"><a href="simulace3diskr.html#cb425-159" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb425-160"><a href="simulace3diskr.html#cb425-160" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-161"><a href="simulace3diskr.html#cb425-161" tabindex="-1"></a>      </span>
<span id="cb425-162"><a href="simulace3diskr.html#cb425-162" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb425-163"><a href="simulace3diskr.html#cb425-163" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb425-164"><a href="simulace3diskr.html#cb425-164" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb425-165"><a href="simulace3diskr.html#cb425-165" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-166"><a href="simulace3diskr.html#cb425-166" tabindex="-1"></a>    </span>
<span id="cb425-167"><a href="simulace3diskr.html#cb425-167" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb425-168"><a href="simulace3diskr.html#cb425-168" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb425-169"><a href="simulace3diskr.html#cb425-169" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test,</span>
<span id="cb425-170"><a href="simulace3diskr.html#cb425-170" tabindex="-1"></a>                      <span class="at">Duration =</span> <span class="fu">as.numeric</span>(duration))</span>
<span id="cb425-171"><a href="simulace3diskr.html#cb425-171" tabindex="-1"></a>    </span>
<span id="cb425-172"><a href="simulace3diskr.html#cb425-172" tabindex="-1"></a>    <span class="co"># RESULTS &lt;- rbind(RESULTS, Res)</span></span>
<span id="cb425-173"><a href="simulace3diskr.html#cb425-173" tabindex="-1"></a>    </span>
<span id="cb425-174"><a href="simulace3diskr.html#cb425-174" tabindex="-1"></a>    <span class="do">## 3) SVM</span></span>
<span id="cb425-175"><a href="simulace3diskr.html#cb425-175" tabindex="-1"></a>    </span>
<span id="cb425-176"><a href="simulace3diskr.html#cb425-176" tabindex="-1"></a>    <span class="co"># normovani dat</span></span>
<span id="cb425-177"><a href="simulace3diskr.html#cb425-177" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb425-178"><a href="simulace3diskr.html#cb425-178" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb425-179"><a href="simulace3diskr.html#cb425-179" tabindex="-1"></a>      norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb425-180"><a href="simulace3diskr.html#cb425-180" tabindex="-1"></a>      }</span>
<span id="cb425-181"><a href="simulace3diskr.html#cb425-181" tabindex="-1"></a>    XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb425-182"><a href="simulace3diskr.html#cb425-182" tabindex="-1"></a>    XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb425-183"><a href="simulace3diskr.html#cb425-183" tabindex="-1"></a>                                                <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb425-184"><a href="simulace3diskr.html#cb425-184" tabindex="-1"></a>                                                <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb425-185"><a href="simulace3diskr.html#cb425-185" tabindex="-1"></a>                                                <span class="at">byrow =</span> T)</span>
<span id="cb425-186"><a href="simulace3diskr.html#cb425-186" tabindex="-1"></a>    </span>
<span id="cb425-187"><a href="simulace3diskr.html#cb425-187" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb425-188"><a href="simulace3diskr.html#cb425-188" tabindex="-1"></a>    X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb425-189"><a href="simulace3diskr.html#cb425-189" tabindex="-1"></a>    X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb425-190"><a href="simulace3diskr.html#cb425-190" tabindex="-1"></a>    </span>
<span id="cb425-191"><a href="simulace3diskr.html#cb425-191" tabindex="-1"></a>    Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb425-192"><a href="simulace3diskr.html#cb425-192" tabindex="-1"></a>    Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb425-193"><a href="simulace3diskr.html#cb425-193" tabindex="-1"></a>    </span>
<span id="cb425-194"><a href="simulace3diskr.html#cb425-194" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb425-195"><a href="simulace3diskr.html#cb425-195" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb425-196"><a href="simulace3diskr.html#cb425-196" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb425-197"><a href="simulace3diskr.html#cb425-197" tabindex="-1"></a>    </span>
<span id="cb425-198"><a href="simulace3diskr.html#cb425-198" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb425-199"><a href="simulace3diskr.html#cb425-199" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb425-200"><a href="simulace3diskr.html#cb425-200" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb425-201"><a href="simulace3diskr.html#cb425-201" tabindex="-1"></a>    </span>
<span id="cb425-202"><a href="simulace3diskr.html#cb425-202" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-203"><a href="simulace3diskr.html#cb425-203" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb425-204"><a href="simulace3diskr.html#cb425-204" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb425-205"><a href="simulace3diskr.html#cb425-205" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb425-206"><a href="simulace3diskr.html#cb425-206" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb425-207"><a href="simulace3diskr.html#cb425-207" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb425-208"><a href="simulace3diskr.html#cb425-208" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-209"><a href="simulace3diskr.html#cb425-209" tabindex="-1"></a></span>
<span id="cb425-210"><a href="simulace3diskr.html#cb425-210" tabindex="-1"></a>    duration.l <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb425-211"><a href="simulace3diskr.html#cb425-211" tabindex="-1"></a></span>
<span id="cb425-212"><a href="simulace3diskr.html#cb425-212" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-213"><a href="simulace3diskr.html#cb425-213" tabindex="-1"></a>    clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb425-214"><a href="simulace3diskr.html#cb425-214" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb425-215"><a href="simulace3diskr.html#cb425-215" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb425-216"><a href="simulace3diskr.html#cb425-216" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb425-217"><a href="simulace3diskr.html#cb425-217" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb425-218"><a href="simulace3diskr.html#cb425-218" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb425-219"><a href="simulace3diskr.html#cb425-219" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-220"><a href="simulace3diskr.html#cb425-220" tabindex="-1"></a></span>
<span id="cb425-221"><a href="simulace3diskr.html#cb425-221" tabindex="-1"></a>    duration.p <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb425-222"><a href="simulace3diskr.html#cb425-222" tabindex="-1"></a></span>
<span id="cb425-223"><a href="simulace3diskr.html#cb425-223" tabindex="-1"></a>    start_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-224"><a href="simulace3diskr.html#cb425-224" tabindex="-1"></a>    clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb425-225"><a href="simulace3diskr.html#cb425-225" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb425-226"><a href="simulace3diskr.html#cb425-226" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb425-227"><a href="simulace3diskr.html#cb425-227" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb425-228"><a href="simulace3diskr.html#cb425-228" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb425-229"><a href="simulace3diskr.html#cb425-229" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb425-230"><a href="simulace3diskr.html#cb425-230" tabindex="-1"></a>    end_time <span class="ot">&lt;-</span> <span class="fu">Sys.time</span>()</span>
<span id="cb425-231"><a href="simulace3diskr.html#cb425-231" tabindex="-1"></a></span>
<span id="cb425-232"><a href="simulace3diskr.html#cb425-232" tabindex="-1"></a>    duration.r <span class="ot">&lt;-</span> end_time <span class="sc">-</span> start_time</span>
<span id="cb425-233"><a href="simulace3diskr.html#cb425-233" tabindex="-1"></a></span>
<span id="cb425-234"><a href="simulace3diskr.html#cb425-234" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb425-235"><a href="simulace3diskr.html#cb425-235" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb425-236"><a href="simulace3diskr.html#cb425-236" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb425-237"><a href="simulace3diskr.html#cb425-237" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-238"><a href="simulace3diskr.html#cb425-238" tabindex="-1"></a></span>
<span id="cb425-239"><a href="simulace3diskr.html#cb425-239" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb425-240"><a href="simulace3diskr.html#cb425-240" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb425-241"><a href="simulace3diskr.html#cb425-241" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-242"><a href="simulace3diskr.html#cb425-242" tabindex="-1"></a></span>
<span id="cb425-243"><a href="simulace3diskr.html#cb425-243" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb425-244"><a href="simulace3diskr.html#cb425-244" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb425-245"><a href="simulace3diskr.html#cb425-245" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-246"><a href="simulace3diskr.html#cb425-246" tabindex="-1"></a></span>
<span id="cb425-247"><a href="simulace3diskr.html#cb425-247" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb425-248"><a href="simulace3diskr.html#cb425-248" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb425-249"><a href="simulace3diskr.html#cb425-249" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb425-250"><a href="simulace3diskr.html#cb425-250" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-251"><a href="simulace3diskr.html#cb425-251" tabindex="-1"></a></span>
<span id="cb425-252"><a href="simulace3diskr.html#cb425-252" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb425-253"><a href="simulace3diskr.html#cb425-253" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb425-254"><a href="simulace3diskr.html#cb425-254" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-255"><a href="simulace3diskr.html#cb425-255" tabindex="-1"></a></span>
<span id="cb425-256"><a href="simulace3diskr.html#cb425-256" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb425-257"><a href="simulace3diskr.html#cb425-257" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb425-258"><a href="simulace3diskr.html#cb425-258" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb425-259"><a href="simulace3diskr.html#cb425-259" tabindex="-1"></a>    </span>
<span id="cb425-260"><a href="simulace3diskr.html#cb425-260" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb425-261"><a href="simulace3diskr.html#cb425-261" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb425-262"><a href="simulace3diskr.html#cb425-262" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb425-263"><a href="simulace3diskr.html#cb425-263" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb425-264"><a href="simulace3diskr.html#cb425-264" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb425-265"><a href="simulace3diskr.html#cb425-265" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb425-266"><a href="simulace3diskr.html#cb425-266" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r),</span>
<span id="cb425-267"><a href="simulace3diskr.html#cb425-267" tabindex="-1"></a>                      <span class="at">Duration =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(duration.l), </span>
<span id="cb425-268"><a href="simulace3diskr.html#cb425-268" tabindex="-1"></a>                               <span class="fu">as.numeric</span>(duration.p), <span class="fu">as.numeric</span>(duration.r)))</span>
<span id="cb425-269"><a href="simulace3diskr.html#cb425-269" tabindex="-1"></a>    </span>
<span id="cb425-270"><a href="simulace3diskr.html#cb425-270" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb425-271"><a href="simulace3diskr.html#cb425-271" tabindex="-1"></a></span>
<span id="cb425-272"><a href="simulace3diskr.html#cb425-272" tabindex="-1"></a>    <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb425-273"><a href="simulace3diskr.html#cb425-273" tabindex="-1"></a>    </span>
<span id="cb425-274"><a href="simulace3diskr.html#cb425-274" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb425-275"><a href="simulace3diskr.html#cb425-275" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb425-276"><a href="simulace3diskr.html#cb425-276" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>duration[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Duration</span>
<span id="cb425-277"><a href="simulace3diskr.html#cb425-277" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, <span class="fu">paste0</span>(n_p, <span class="st">&#39;: &#39;</span>, sim))</span>
<span id="cb425-278"><a href="simulace3diskr.html#cb425-278" tabindex="-1"></a>  }</span>
<span id="cb425-279"><a href="simulace3diskr.html#cb425-279" tabindex="-1"></a>  </span>
<span id="cb425-280"><a href="simulace3diskr.html#cb425-280" tabindex="-1"></a>  <span class="co"># Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé </span></span>
<span id="cb425-281"><a href="simulace3diskr.html#cb425-281" tabindex="-1"></a>  <span class="co"># klasifikační metody.</span></span>
<span id="cb425-282"><a href="simulace3diskr.html#cb425-282" tabindex="-1"></a>  </span>
<span id="cb425-283"><a href="simulace3diskr.html#cb425-283" tabindex="-1"></a>  <span class="co"># dame do vysledne tabulky</span></span>
<span id="cb425-284"><a href="simulace3diskr.html#cb425-284" tabindex="-1"></a>  </span>
<span id="cb425-285"><a href="simulace3diskr.html#cb425-285" tabindex="-1"></a>  SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb425-286"><a href="simulace3diskr.html#cb425-286" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb425-287"><a href="simulace3diskr.html#cb425-287" tabindex="-1"></a>                            <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb425-288"><a href="simulace3diskr.html#cb425-288" tabindex="-1"></a>                            <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd),</span>
<span id="cb425-289"><a href="simulace3diskr.html#cb425-289" tabindex="-1"></a>                            <span class="at">Duration =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>duration, <span class="dv">2</span>, mean),</span>
<span id="cb425-290"><a href="simulace3diskr.html#cb425-290" tabindex="-1"></a>                            <span class="at">SD.dur =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>duration, <span class="dv">2</span>, sd))</span>
<span id="cb425-291"><a href="simulace3diskr.html#cb425-291" tabindex="-1"></a>  </span>
<span id="cb425-292"><a href="simulace3diskr.html#cb425-292" tabindex="-1"></a>  <span class="co"># CV_res[n_p, ] &lt;- apply(SIMULACE$CV, 2, median)</span></span>
<span id="cb425-293"><a href="simulace3diskr.html#cb425-293" tabindex="-1"></a>  </span>
<span id="cb425-294"><a href="simulace3diskr.html#cb425-294" tabindex="-1"></a>  SIMUL_params[, , n_p] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SIMULACE.df)</span>
<span id="cb425-295"><a href="simulace3diskr.html#cb425-295" tabindex="-1"></a>}</span>
<span id="cb425-296"><a href="simulace3diskr.html#cb425-296" tabindex="-1"></a></span>
<span id="cb425-297"><a href="simulace3diskr.html#cb425-297" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb425-298"><a href="simulace3diskr.html#cb425-298" tabindex="-1"></a><span class="fu">save</span>(SIMUL_params, <span class="at">file =</span> <span class="st">&#39;RData/simulace_params_diskretizace_03_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="graphical-output-2" class="section level3 hasAnchor" number="4.4.1">
<h3><span class="header-section-number">4.4.1</span> Graphical Output<a href="simulace3diskr.html#graphical-output-2" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s examine the dependence of the simulated results on the value of the parameter <span class="math inline">\(p\)</span>. We’ll start with the training error rates.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb426"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb426-1"><a href="simulace3diskr.html#cb426-1" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb426-2"><a href="simulace3diskr.html#cb426-2" tabindex="-1"></a>      <span class="co"># &#39;Decision tree&#39;,</span></span>
<span id="cb426-3"><a href="simulace3diskr.html#cb426-3" tabindex="-1"></a>      <span class="st">&#39;Random Forest&#39;</span>,</span>
<span id="cb426-4"><a href="simulace3diskr.html#cb426-4" tabindex="-1"></a>      <span class="st">&#39;SVM (linear)&#39;</span>,</span>
<span id="cb426-5"><a href="simulace3diskr.html#cb426-5" tabindex="-1"></a>      <span class="st">&#39;SVM (poly)&#39;</span>,</span>
<span id="cb426-6"><a href="simulace3diskr.html#cb426-6" tabindex="-1"></a>      <span class="st">&#39;SVM (radial)&#39;</span></span>
<span id="cb426-7"><a href="simulace3diskr.html#cb426-7" tabindex="-1"></a>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb427"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb427-1"><a href="simulace3diskr.html#cb427-1" tabindex="-1"></a><span class="co"># for training data</span></span>
<span id="cb427-2"><a href="simulace3diskr.html#cb427-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb427-3"><a href="simulace3diskr.html#cb427-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb427-4"><a href="simulace3diskr.html#cb427-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb427-5"><a href="simulace3diskr.html#cb427-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(p_vector), </span>
<span id="cb427-6"><a href="simulace3diskr.html#cb427-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;p&#39;</span>, </span>
<span id="cb427-7"><a href="simulace3diskr.html#cb427-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb427-8"><a href="simulace3diskr.html#cb427-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb427-9"><a href="simulace3diskr.html#cb427-9" tabindex="-1"></a>         <span class="at">p =</span> <span class="fu">as.numeric</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb427-10"><a href="simulace3diskr.html#cb427-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RF_discr&quot;</span>, <span class="st">&quot;SVM linear - diskr&quot;</span>,</span>
<span id="cb427-11"><a href="simulace3diskr.html#cb427-11" tabindex="-1"></a>                       <span class="st">&quot;SVM poly - diskr&quot;</span>, <span class="st">&quot;SVM rbf - diskr&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb427-12"><a href="simulace3diskr.html#cb427-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb427-13"><a href="simulace3diskr.html#cb427-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb427-14"><a href="simulace3diskr.html#cb427-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb427-15"><a href="simulace3diskr.html#cb427-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(p),</span>
<span id="cb427-16"><a href="simulace3diskr.html#cb427-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[train]),</span>
<span id="cb427-17"><a href="simulace3diskr.html#cb427-17" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb427-18"><a href="simulace3diskr.html#cb427-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-39"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-39-1.png" alt="Graph of the dependence of training error rates for individual classification methods on the value of the parameter $p$." width="672" />
<p class="caption">
Figure 4.1: Graph of the dependence of training error rates for individual classification methods on the value of the parameter <span class="math inline">\(p\)</span>.
</p>
</div>
<p>Next, we’ll look at the test error rates, which is the graph we are most interested in.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb428"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb428-1"><a href="simulace3diskr.html#cb428-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb428-2"><a href="simulace3diskr.html#cb428-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb428-3"><a href="simulace3diskr.html#cb428-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb428-4"><a href="simulace3diskr.html#cb428-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb428-5"><a href="simulace3diskr.html#cb428-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(p_vector), </span>
<span id="cb428-6"><a href="simulace3diskr.html#cb428-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;p&#39;</span>, </span>
<span id="cb428-7"><a href="simulace3diskr.html#cb428-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb428-8"><a href="simulace3diskr.html#cb428-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb428-9"><a href="simulace3diskr.html#cb428-9" tabindex="-1"></a>         <span class="at">p =</span> <span class="fu">as.numeric</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb428-10"><a href="simulace3diskr.html#cb428-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RF_discr&quot;</span>, <span class="st">&quot;SVM linear - diskr&quot;</span>,</span>
<span id="cb428-11"><a href="simulace3diskr.html#cb428-11" tabindex="-1"></a>                       <span class="st">&quot;SVM poly - diskr&quot;</span>, <span class="st">&quot;SVM rbf - diskr&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb428-12"><a href="simulace3diskr.html#cb428-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb428-13"><a href="simulace3diskr.html#cb428-13" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb428-14"><a href="simulace3diskr.html#cb428-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb428-15"><a href="simulace3diskr.html#cb428-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(p),</span>
<span id="cb428-16"><a href="simulace3diskr.html#cb428-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test]),</span>
<span id="cb428-17"><a href="simulace3diskr.html#cb428-17" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb428-18"><a href="simulace3diskr.html#cb428-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-40"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-40-1.png" alt="Graph of the dependence of test error rates for individual classification methods on the value of the parameter $p$." width="672" />
<p class="caption">
Figure 1.12: Graph of the dependence of test error rates for individual classification methods on the value of the parameter <span class="math inline">\(p\)</span>.
</p>
</div>
<p>Finally, let’s plot the graph for the time complexity of the methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb429"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb429-1"><a href="simulace3diskr.html#cb429-1" tabindex="-1"></a>SIMUL_params[, <span class="dv">5</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb429-2"><a href="simulace3diskr.html#cb429-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb429-3"><a href="simulace3diskr.html#cb429-3" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb429-4"><a href="simulace3diskr.html#cb429-4" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(p_vector), </span>
<span id="cb429-5"><a href="simulace3diskr.html#cb429-5" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;p&#39;</span>, </span>
<span id="cb429-6"><a href="simulace3diskr.html#cb429-6" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Duration&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb429-7"><a href="simulace3diskr.html#cb429-7" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb429-8"><a href="simulace3diskr.html#cb429-8" tabindex="-1"></a>         <span class="at">p =</span> <span class="fu">as.numeric</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb429-9"><a href="simulace3diskr.html#cb429-9" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RF_discr&quot;</span>, <span class="st">&quot;SVM linear - diskr&quot;</span>,</span>
<span id="cb429-10"><a href="simulace3diskr.html#cb429-10" tabindex="-1"></a>                       <span class="st">&quot;SVM poly - diskr&quot;</span>, <span class="st">&quot;SVM rbf - diskr&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb429-11"><a href="simulace3diskr.html#cb429-11" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> Duration, <span class="at">colour =</span> method, <span class="at">linetype =</span> method)) <span class="sc">+</span> </span>
<span id="cb429-12"><a href="simulace3diskr.html#cb429-12" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb429-13"><a href="simulace3diskr.html#cb429-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb429-14"><a href="simulace3diskr.html#cb429-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(p),</span>
<span id="cb429-15"><a href="simulace3diskr.html#cb429-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&quot;Duration [s]&quot;</span>,</span>
<span id="cb429-16"><a href="simulace3diskr.html#cb429-16" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb429-17"><a href="simulace3diskr.html#cb429-17" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb429-18"><a href="simulace3diskr.html#cb429-18" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>) <span class="sc">+</span> </span>
<span id="cb429-19"><a href="simulace3diskr.html#cb429-19" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb429-20"><a href="simulace3diskr.html#cb429-20" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;tomato&#39;</span>,</span>
<span id="cb429-21"><a href="simulace3diskr.html#cb429-21" tabindex="-1"></a>                                 <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;tomato&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb429-22"><a href="simulace3diskr.html#cb429-22" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb429-23"><a href="simulace3diskr.html#cb429-23" tabindex="-1"></a>                                   <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span>, <span class="st">&#39;dotted&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-41"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-41-1.png" alt="Graph of the dependence of the time complexity of methods for individual classification methods on the value of the parameter $p$." width="672" />
<p class="caption">
Figure 2.7: Graph of the dependence of the time complexity of methods for individual classification methods on the value of the parameter <span class="math inline">\(p\)</span>.
</p>
</div>
<p>Since the results are subject to random fluctuations and increasing the number of repetitions <code>n.sim</code> would be computationally intensive, let’s now smooth the curves of the average test error rates with respect to the parameter <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb430"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb430-1"><a href="simulace3diskr.html#cb430-1" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb430-2"><a href="simulace3diskr.html#cb430-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb430-3"><a href="simulace3diskr.html#cb430-3" tabindex="-1"></a></span>
<span id="cb430-4"><a href="simulace3diskr.html#cb430-4" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> p_vector</span>
<span id="cb430-5"><a href="simulace3diskr.html#cb430-5" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb430-6"><a href="simulace3diskr.html#cb430-6" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb430-7"><a href="simulace3diskr.html#cb430-7" tabindex="-1"></a>wtvec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">124</span>)</span>
<span id="cb430-8"><a href="simulace3diskr.html#cb430-8" tabindex="-1"></a><span class="co"># wtvec &lt;- c(seq(50, 10, length = 4), seq(0.1, 0.1, length = 10), rep(1, 110))</span></span>
<span id="cb430-9"><a href="simulace3diskr.html#cb430-9" tabindex="-1"></a></span>
<span id="cb430-10"><a href="simulace3diskr.html#cb430-10" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb430-11"><a href="simulace3diskr.html#cb430-11" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb430-12"><a href="simulace3diskr.html#cb430-12" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb430-13"><a href="simulace3diskr.html#cb430-13" tabindex="-1"></a></span>
<span id="cb430-14"><a href="simulace3diskr.html#cb430-14" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb430-15"><a href="simulace3diskr.html#cb430-15" tabindex="-1"></a></span>
<span id="cb430-16"><a href="simulace3diskr.html#cb430-16" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vector of lambda</span></span>
<span id="cb430-17"><a href="simulace3diskr.html#cb430-17" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for GCV storage</span></span>
<span id="cb430-18"><a href="simulace3diskr.html#cb430-18" tabindex="-1"></a></span>
<span id="cb430-19"><a href="simulace3diskr.html#cb430-19" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb430-20"><a href="simulace3diskr.html#cb430-20" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb430-21"><a href="simulace3diskr.html#cb430-21" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.Fdpar, </span>
<span id="cb430-22"><a href="simulace3diskr.html#cb430-22" tabindex="-1"></a>                          <span class="at">wtvec =</span> wtvec) <span class="co"># smoothing</span></span>
<span id="cb430-23"><a href="simulace3diskr.html#cb430-23" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb430-24"><a href="simulace3diskr.html#cb430-24" tabindex="-1"></a>}</span>
<span id="cb430-25"><a href="simulace3diskr.html#cb430-25" tabindex="-1"></a></span>
<span id="cb430-26"><a href="simulace3diskr.html#cb430-26" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb430-27"><a href="simulace3diskr.html#cb430-27" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb430-28"><a href="simulace3diskr.html#cb430-28" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb430-29"><a href="simulace3diskr.html#cb430-29" tabindex="-1"></a>)</span>
<span id="cb430-30"><a href="simulace3diskr.html#cb430-30" tabindex="-1"></a></span>
<span id="cb430-31"><a href="simulace3diskr.html#cb430-31" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb430-32"><a href="simulace3diskr.html#cb430-32" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb430-33"><a href="simulace3diskr.html#cb430-33" tabindex="-1"></a></span>
<span id="cb430-34"><a href="simulace3diskr.html#cb430-34" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb430-35"><a href="simulace3diskr.html#cb430-35" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.fdPar,</span>
<span id="cb430-36"><a href="simulace3diskr.html#cb430-36" tabindex="-1"></a>                        <span class="at">wtvec =</span> wtvec)</span>
<span id="cb430-37"><a href="simulace3diskr.html#cb430-37" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb430-38"><a href="simulace3diskr.html#cb430-38" tabindex="-1"></a></span>
<span id="cb430-39"><a href="simulace3diskr.html#cb430-39" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, </span>
<span id="cb430-40"><a href="simulace3diskr.html#cb430-40" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(p_vector), <span class="fu">max</span>(p_vector), <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb430-41"><a href="simulace3diskr.html#cb430-41" tabindex="-1"></a></span>
<span id="cb430-42"><a href="simulace3diskr.html#cb430-42" tabindex="-1"></a>df_plot_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb430-43"><a href="simulace3diskr.html#cb430-43" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(fdobjSmootheval), <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb430-44"><a href="simulace3diskr.html#cb430-44" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb430-45"><a href="simulace3diskr.html#cb430-45" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(p_vector), <span class="fu">max</span>(p_vector), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb430-46"><a href="simulace3diskr.html#cb430-46" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb430-47"><a href="simulace3diskr.html#cb430-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb431"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb431-1"><a href="simulace3diskr.html#cb431-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb431-2"><a href="simulace3diskr.html#cb431-2" tabindex="-1"></a>p1 <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb431-3"><a href="simulace3diskr.html#cb431-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb431-4"><a href="simulace3diskr.html#cb431-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb431-5"><a href="simulace3diskr.html#cb431-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(p_vector), </span>
<span id="cb431-6"><a href="simulace3diskr.html#cb431-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;p&#39;</span>, </span>
<span id="cb431-7"><a href="simulace3diskr.html#cb431-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb431-8"><a href="simulace3diskr.html#cb431-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb431-9"><a href="simulace3diskr.html#cb431-9" tabindex="-1"></a>         <span class="at">p =</span> <span class="fu">as.numeric</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb431-10"><a href="simulace3diskr.html#cb431-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RF_discr&quot;</span>, <span class="st">&quot;SVM linear - diskr&quot;</span>,</span>
<span id="cb431-11"><a href="simulace3diskr.html#cb431-11" tabindex="-1"></a>                       <span class="st">&quot;SVM poly - diskr&quot;</span>, <span class="st">&quot;SVM rbf - diskr&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb431-12"><a href="simulace3diskr.html#cb431-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb431-13"><a href="simulace3diskr.html#cb431-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb431-14"><a href="simulace3diskr.html#cb431-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb431-15"><a href="simulace3diskr.html#cb431-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;p&#39;</span>,</span>
<span id="cb431-16"><a href="simulace3diskr.html#cb431-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Test Error Rate&#39;</span>,</span>
<span id="cb431-17"><a href="simulace3diskr.html#cb431-17" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb431-18"><a href="simulace3diskr.html#cb431-18" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb431-19"><a href="simulace3diskr.html#cb431-19" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb431-20"><a href="simulace3diskr.html#cb431-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;none&#39;</span>,</span>
<span id="cb431-21"><a href="simulace3diskr.html#cb431-21" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb431-22"><a href="simulace3diskr.html#cb431-22" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb431-23"><a href="simulace3diskr.html#cb431-23" tabindex="-1"></a>    <span class="co"># scale_y_log10() +</span></span>
<span id="cb431-24"><a href="simulace3diskr.html#cb431-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth, <span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb431-25"><a href="simulace3diskr.html#cb431-25" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb431-26"><a href="simulace3diskr.html#cb431-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.95</span>) <span class="sc">+</span> </span>
<span id="cb431-27"><a href="simulace3diskr.html#cb431-27" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>, <span class="co">#&#39;tomato&#39;,</span></span>
<span id="cb431-28"><a href="simulace3diskr.html#cb431-28" tabindex="-1"></a>                                 <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;tomato&#39;</span>),</span>
<span id="cb431-29"><a href="simulace3diskr.html#cb431-29" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb431-30"><a href="simulace3diskr.html#cb431-30" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb431-31"><a href="simulace3diskr.html#cb431-31" tabindex="-1"></a>                                   <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span><span class="co">#, &#39;dotted&#39;</span></span>
<span id="cb431-32"><a href="simulace3diskr.html#cb431-32" tabindex="-1"></a>                                   ),</span>
<span id="cb431-33"><a href="simulace3diskr.html#cb431-33" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb431-34"><a href="simulace3diskr.html#cb431-34" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">1</span>),</span>
<span id="cb431-35"><a href="simulace3diskr.html#cb431-35" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb431-36"><a href="simulace3diskr.html#cb431-36" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)),</span>
<span id="cb431-37"><a href="simulace3diskr.html#cb431-37" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>)))</span>
<span id="cb431-38"><a href="simulace3diskr.html#cb431-38" tabindex="-1"></a>p1</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-43"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-43-1.png" alt="Graph of the dependence of test error rates for individual classification methods on the value of the parameter $p$." width="672" />
<p class="caption">
Figure 1.13: Graph of the dependence of test error rates for individual classification methods on the value of the parameter <span class="math inline">\(p\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb432"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb432-1"><a href="simulace3diskr.html#cb432-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03diskr_curvesErr.tex&quot;, device = tikz, width = 4.5, height = 4.5)</span></span></code></pre></div>
</details>
<p>Let’s add the computational time to the graph.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb433"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb433-1"><a href="simulace3diskr.html#cb433-1" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">5</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb433-2"><a href="simulace3diskr.html#cb433-2" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb433-3"><a href="simulace3diskr.html#cb433-3" tabindex="-1"></a></span>
<span id="cb433-4"><a href="simulace3diskr.html#cb433-4" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> p_vector</span>
<span id="cb433-5"><a href="simulace3diskr.html#cb433-5" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb433-6"><a href="simulace3diskr.html#cb433-6" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb433-7"><a href="simulace3diskr.html#cb433-7" tabindex="-1"></a>wtvec <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">124</span>)</span>
<span id="cb433-8"><a href="simulace3diskr.html#cb433-8" tabindex="-1"></a><span class="co"># wtvec &lt;- c(seq(50, 10, length = 4), seq(0.1, 0.1, length = 10), rep(1, 110))</span></span>
<span id="cb433-9"><a href="simulace3diskr.html#cb433-9" tabindex="-1"></a></span>
<span id="cb433-10"><a href="simulace3diskr.html#cb433-10" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb433-11"><a href="simulace3diskr.html#cb433-11" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb433-12"><a href="simulace3diskr.html#cb433-12" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb433-13"><a href="simulace3diskr.html#cb433-13" tabindex="-1"></a></span>
<span id="cb433-14"><a href="simulace3diskr.html#cb433-14" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb433-15"><a href="simulace3diskr.html#cb433-15" tabindex="-1"></a></span>
<span id="cb433-16"><a href="simulace3diskr.html#cb433-16" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">3</span>, <span class="at">to =</span> <span class="dv">5</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vector of lambda</span></span>
<span id="cb433-17"><a href="simulace3diskr.html#cb433-17" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for GCV storage</span></span>
<span id="cb433-18"><a href="simulace3diskr.html#cb433-18" tabindex="-1"></a></span>
<span id="cb433-19"><a href="simulace3diskr.html#cb433-19" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb433-20"><a href="simulace3diskr.html#cb433-20" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb433-21"><a href="simulace3diskr.html#cb433-21" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.Fdpar, </span>
<span id="cb433-22"><a href="simulace3diskr.html#cb433-22" tabindex="-1"></a>                          <span class="at">wtvec =</span> wtvec) <span class="co"># smoothing</span></span>
<span id="cb433-23"><a href="simulace3diskr.html#cb433-23" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb433-24"><a href="simulace3diskr.html#cb433-24" tabindex="-1"></a>}</span>
<span id="cb433-25"><a href="simulace3diskr.html#cb433-25" tabindex="-1"></a></span>
<span id="cb433-26"><a href="simulace3diskr.html#cb433-26" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb433-27"><a href="simulace3diskr.html#cb433-27" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb433-28"><a href="simulace3diskr.html#cb433-28" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb433-29"><a href="simulace3diskr.html#cb433-29" tabindex="-1"></a>)</span>
<span id="cb433-30"><a href="simulace3diskr.html#cb433-30" tabindex="-1"></a></span>
<span id="cb433-31"><a href="simulace3diskr.html#cb433-31" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb433-32"><a href="simulace3diskr.html#cb433-32" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb433-33"><a href="simulace3diskr.html#cb433-33" tabindex="-1"></a></span>
<span id="cb433-34"><a href="simulace3diskr.html#cb433-34" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb433-35"><a href="simulace3diskr.html#cb433-35" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(breaks, Dat, curv.fdPar,</span>
<span id="cb433-36"><a href="simulace3diskr.html#cb433-36" tabindex="-1"></a>                        <span class="at">wtvec =</span> wtvec)</span>
<span id="cb433-37"><a href="simulace3diskr.html#cb433-37" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb433-38"><a href="simulace3diskr.html#cb433-38" tabindex="-1"></a></span>
<span id="cb433-39"><a href="simulace3diskr.html#cb433-39" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, </span>
<span id="cb433-40"><a href="simulace3diskr.html#cb433-40" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(p_vector), <span class="fu">max</span>(p_vector), <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb433-41"><a href="simulace3diskr.html#cb433-41" tabindex="-1"></a></span>
<span id="cb433-42"><a href="simulace3diskr.html#cb433-42" tabindex="-1"></a>df_plot_smooth_2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb433-43"><a href="simulace3diskr.html#cb433-43" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(<span class="fu">colnames</span>(fdobjSmootheval), <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb433-44"><a href="simulace3diskr.html#cb433-44" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb433-45"><a href="simulace3diskr.html#cb433-45" tabindex="-1"></a>  <span class="at">p =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(p_vector), <span class="fu">max</span>(p_vector), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb433-46"><a href="simulace3diskr.html#cb433-46" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb433-47"><a href="simulace3diskr.html#cb433-47" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb434"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb434-1"><a href="simulace3diskr.html#cb434-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb434-2"><a href="simulace3diskr.html#cb434-2" tabindex="-1"></a>p2 <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">5</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb434-3"><a href="simulace3diskr.html#cb434-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb434-4"><a href="simulace3diskr.html#cb434-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb434-5"><a href="simulace3diskr.html#cb434-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(p_vector), </span>
<span id="cb434-6"><a href="simulace3diskr.html#cb434-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;p&#39;</span>, </span>
<span id="cb434-7"><a href="simulace3diskr.html#cb434-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb434-8"><a href="simulace3diskr.html#cb434-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb434-9"><a href="simulace3diskr.html#cb434-9" tabindex="-1"></a>         <span class="at">p =</span> <span class="fu">as.numeric</span>(p)) <span class="sc">|&gt;</span> </span>
<span id="cb434-10"><a href="simulace3diskr.html#cb434-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">&quot;RF_discr&quot;</span>, <span class="st">&quot;SVM linear - diskr&quot;</span>,</span>
<span id="cb434-11"><a href="simulace3diskr.html#cb434-11" tabindex="-1"></a>                       <span class="st">&quot;SVM poly - diskr&quot;</span>, <span class="st">&quot;SVM rbf - diskr&quot;</span>)) <span class="sc">|&gt;</span></span>
<span id="cb434-12"><a href="simulace3diskr.html#cb434-12" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb434-13"><a href="simulace3diskr.html#cb434-13" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb434-14"><a href="simulace3diskr.html#cb434-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb434-15"><a href="simulace3diskr.html#cb434-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;p&#39;</span>,</span>
<span id="cb434-16"><a href="simulace3diskr.html#cb434-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;computational time&#39;</span>,</span>
<span id="cb434-17"><a href="simulace3diskr.html#cb434-17" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb434-18"><a href="simulace3diskr.html#cb434-18" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb434-19"><a href="simulace3diskr.html#cb434-19" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb434-20"><a href="simulace3diskr.html#cb434-20" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="fu">c</span>(<span class="fl">0.7</span>, <span class="fl">0.16</span>),<span class="co">#&#39;right&#39;,</span></span>
<span id="cb434-21"><a href="simulace3diskr.html#cb434-21" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.1</span>, <span class="fl">0.3</span>, <span class="fl">0.5</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb434-22"><a href="simulace3diskr.html#cb434-22" tabindex="-1"></a>        <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>(),</span>
<span id="cb434-23"><a href="simulace3diskr.html#cb434-23" tabindex="-1"></a>        <span class="at">legend.background =</span> <span class="fu">element_rect</span>(<span class="at">fill=</span><span class="st">&#39;transparent&#39;</span>),</span>
<span id="cb434-24"><a href="simulace3diskr.html#cb434-24" tabindex="-1"></a>        <span class="at">legend.key =</span> <span class="fu">element_rect</span>(<span class="at">colour =</span> <span class="cn">NA</span>, <span class="at">fill =</span> <span class="cn">NA</span>)) <span class="sc">+</span></span>
<span id="cb434-25"><a href="simulace3diskr.html#cb434-25" tabindex="-1"></a>  <span class="fu">scale_y_log10</span>() <span class="sc">+</span></span>
<span id="cb434-26"><a href="simulace3diskr.html#cb434-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth_2, <span class="fu">aes</span>(<span class="at">x =</span> p, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb434-27"><a href="simulace3diskr.html#cb434-27" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb434-28"><a href="simulace3diskr.html#cb434-28" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.95</span>) <span class="sc">+</span> </span>
<span id="cb434-29"><a href="simulace3diskr.html#cb434-29" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;deepskyblue2&#39;</span>, <span class="co">#&#39;tomato&#39;,</span></span>
<span id="cb434-30"><a href="simulace3diskr.html#cb434-30" tabindex="-1"></a>                                 <span class="st">&#39;tomato&#39;</span>, <span class="st">&#39;tomato&#39;</span>),</span>
<span id="cb434-31"><a href="simulace3diskr.html#cb434-31" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb434-32"><a href="simulace3diskr.html#cb434-32" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span>,</span>
<span id="cb434-33"><a href="simulace3diskr.html#cb434-33" tabindex="-1"></a>                                   <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dashed&#39;</span><span class="co">#, &#39;dotted&#39;</span></span>
<span id="cb434-34"><a href="simulace3diskr.html#cb434-34" tabindex="-1"></a>                                   ),</span>
<span id="cb434-35"><a href="simulace3diskr.html#cb434-35" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb434-36"><a href="simulace3diskr.html#cb434-36" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">16</span>, <span class="dv">1</span>),</span>
<span id="cb434-37"><a href="simulace3diskr.html#cb434-37" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb434-38"><a href="simulace3diskr.html#cb434-38" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)),</span>
<span id="cb434-39"><a href="simulace3diskr.html#cb434-39" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>)))</span>
<span id="cb434-40"><a href="simulace3diskr.html#cb434-40" tabindex="-1"></a>p2</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-45"></span>
<img src="04-Simulace_discretisation_files/figure-html/unnamed-chunk-45-1.png" alt="Graph of the dependence of computational time for individual classification methods on the value of the parameter $p$." width="672" />
<p class="caption">
Figure 1.14: Graph of the dependence of computational time for individual classification methods on the value of the parameter <span class="math inline">\(p\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb435"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb435-1"><a href="simulace3diskr.html#cb435-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03diskr_curvesTime.tex&quot;, device = tikz, width = 4.5, height = 4.5)</span></span></code></pre></div>
</details>
<p>Detailed comments on the results of this simulation study can be found in the article.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulace3shift.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace4.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
  "sharing": null,
  "fontsettings": null,
  "edit": null,
  "history": {
    "link": null,
    "text": null
  },
  "view": {
    "link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/04-Simulace_discretisation.Rmd",
    "text": null
  },
  "download": null,
  "search": false,
  "toc": {
    "collapse": "section",
    "scroll_highlight": true
  },
  "toolbar": {
    "position": "fixed"
  },
  "info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
