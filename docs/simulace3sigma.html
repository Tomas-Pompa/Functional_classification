<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapter 2 Dependency on the parameter \(\sigma^2\) | Functional classification with vertical differences using SVM</title>
  <meta name="description" content="Chapter 2 Dependency on the parameter \(\sigma^2\) | Functional classification with vertical differences using SVM" />
  <meta name="generator" content="bookdown 0.41 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapter 2 Dependency on the parameter \(\sigma^2\) | Functional classification with vertical differences using SVM" />
  <meta property="og:type" content="book" />
  
  
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapter 2 Dependency on the parameter \(\sigma^2\) | Functional classification with vertical differences using SVM" />
  
  
  

<meta name="author" content="Tomáš Pompa" />


<meta name="date" content="2024-11-04" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="simulace3.html"/>
<link rel="next" href="simulace3shift.html"/>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/codefolding-lua-1.1/codefolding-lua.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections.css" rel="stylesheet" />
<link href="libs/anchor-sections-1.1.0/anchor-sections-hash.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.1.0/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  background-color: #f8f8f8; }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ef2929; } /* Alert */
code span.an { color: #8f5902; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #204a87; } /* Attribute */
code span.bn { color: #0000cf; } /* BaseN */
code span.cf { color: #204a87; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4e9a06; } /* Char */
code span.cn { color: #8f5902; } /* Constant */
code span.co { color: #8f5902; font-style: italic; } /* Comment */
code span.cv { color: #8f5902; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #8f5902; font-weight: bold; font-style: italic; } /* Documentation */
code span.dt { color: #204a87; } /* DataType */
code span.dv { color: #0000cf; } /* DecVal */
code span.er { color: #a40000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #0000cf; } /* Float */
code span.fu { color: #204a87; font-weight: bold; } /* Function */
code span.im { } /* Import */
code span.in { color: #8f5902; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #204a87; font-weight: bold; } /* Keyword */
code span.op { color: #ce5c00; font-weight: bold; } /* Operator */
code span.ot { color: #8f5902; } /* Other */
code span.pp { color: #8f5902; font-style: italic; } /* Preprocessor */
code span.sc { color: #ce5c00; font-weight: bold; } /* SpecialChar */
code span.ss { color: #4e9a06; } /* SpecialString */
code span.st { color: #4e9a06; } /* String */
code span.va { color: #000000; } /* Variable */
code span.vs { color: #4e9a06; } /* VerbatimString */
code span.wa { color: #8f5902; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
  
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
</style>

<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="toc-logo"><a href="./"><img src="sci-lg-eng-rgb.png"></a></li>

<li class="divider"></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>SVM for Functional Data</a></li>
<li class="part"><span><b>SIMULATION STUDY</b></span></li>
<li class="chapter" data-level="1" data-path="simulace3.html"><a href="simulace3.html"><i class="fa fa-check"></i><b>1</b> Classification of simulated curves</a>
<ul>
<li class="chapter" data-level="1.1" data-path="simulace3.html"><a href="simulace3.html#simulation-of-functional-data"><i class="fa fa-check"></i><b>1.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="1.2" data-path="simulace3.html"><a href="simulace3.html#smoothing-observed-curves"><i class="fa fa-check"></i><b>1.2</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="1.3" data-path="simulace3.html"><a href="simulace3.html#classification-of-curves"><i class="fa fa-check"></i><b>1.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="1.3.1" data-path="simulace3.html"><a href="simulace3.html#k-nearest-neighbors"><i class="fa fa-check"></i><b>1.3.1</b> <span class="math inline">\(K\)</span>-Nearest Neighbors</a></li>
<li class="chapter" data-level="1.3.2" data-path="simulace3.html"><a href="simulace3.html#linear-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.3" data-path="simulace3.html"><a href="simulace3.html#quadratic-discriminant-analysis"><i class="fa fa-check"></i><b>1.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="1.3.4" data-path="simulace3.html"><a href="simulace3.html#logistic-regression"><i class="fa fa-check"></i><b>1.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="1.3.5" data-path="simulace3.html"><a href="simulace3.html#decision-trees"><i class="fa fa-check"></i><b>1.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="1.3.6" data-path="simulace3.html"><a href="simulace3.html#random-forests"><i class="fa fa-check"></i><b>1.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="1.3.7" data-path="simulace3.html"><a href="simulace3.html#support-vector-machines"><i class="fa fa-check"></i><b>1.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="1.3.8" data-path="simulace3.html"><a href="simulace3.html#table-of-results"><i class="fa fa-check"></i><b>1.3.8</b> Table of results</a></li>
</ul></li>
<li class="chapter" data-level="1.4" data-path="simulace3.html"><a href="simulace3.html#simulation-study"><i class="fa fa-check"></i><b>1.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="1.4.1" data-path="simulace3.html"><a href="simulace3.html#results"><i class="fa fa-check"></i><b>1.4.1</b> Results</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="simulace3sigma.html"><a href="simulace3sigma.html"><i class="fa fa-check"></i><b>2</b> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span></a>
<ul>
<li class="chapter" data-level="2.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-of-functional-data-1"><i class="fa fa-check"></i><b>2.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="2.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#smoothing-the-observed-curves"><i class="fa fa-check"></i><b>2.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="2.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#classification-of-curves-1"><i class="fa fa-check"></i><b>2.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#k-nearest-neighbors-1"><i class="fa fa-check"></i><b>2.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="2.3.2" data-path="simulace3sigma.html"><a href="simulace3sigma.html#linear-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.3" data-path="simulace3sigma.html"><a href="simulace3sigma.html#quadratic-discriminant-analysis-1"><i class="fa fa-check"></i><b>2.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="2.3.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#logistic-regression-1"><i class="fa fa-check"></i><b>2.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="2.3.5" data-path="simulace3sigma.html"><a href="simulace3sigma.html#random-forests-1"><i class="fa fa-check"></i><b>2.3.5</b> Random Forests</a></li>
<li class="chapter" data-level="2.3.6" data-path="simulace3sigma.html"><a href="simulace3sigma.html#support-vector-machines-1"><i class="fa fa-check"></i><b>2.3.6</b> Support Vector Machines</a></li>
<li class="chapter" data-level="2.3.7" data-path="simulace3sigma.html"><a href="simulace3sigma.html#results-table"><i class="fa fa-check"></i><b>2.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="simulace3sigma.html"><a href="simulace3sigma.html#simulation-study-1"><i class="fa fa-check"></i><b>2.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="simulace3sigma.html"><a href="simulace3sigma.html#graphical-output"><i class="fa fa-check"></i><b>2.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="simulace3shift.html"><a href="simulace3shift.html"><i class="fa fa-check"></i><b>3</b> Dependence on parameter <span class="math inline">\(\sigma_{shift}\)</span></a>
<ul>
<li class="chapter" data-level="3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-of-functional-data-2"><i class="fa fa-check"></i><b>3.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#smoothing-the-observed-curves-1"><i class="fa fa-check"></i><b>3.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#classification-of-curves-2"><i class="fa fa-check"></i><b>3.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="simulace3shift.html"><a href="simulace3shift.html#k-nearest-neighbors-2"><i class="fa fa-check"></i><b>3.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="3.3.2" data-path="simulace3shift.html"><a href="simulace3shift.html#linear-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.3" data-path="simulace3shift.html"><a href="simulace3shift.html#quadratic-discriminant-analysis-2"><i class="fa fa-check"></i><b>3.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="3.3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#logistic-regression-2"><i class="fa fa-check"></i><b>3.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="3.3.5" data-path="simulace3shift.html"><a href="simulace3shift.html#support-vector-machines-2"><i class="fa fa-check"></i><b>3.3.5</b> Support Vector Machines</a></li>
<li class="chapter" data-level="3.3.6" data-path="simulace3shift.html"><a href="simulace3shift.html#principal-component-scores-4"><i class="fa fa-check"></i><b>3.3.6</b> Principal Component Scores</a></li>
<li class="chapter" data-level="3.3.7" data-path="simulace3shift.html"><a href="simulace3shift.html#results-table-1"><i class="fa fa-check"></i><b>3.3.7</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="simulace3shift.html"><a href="simulace3shift.html#simulation-study-2"><i class="fa fa-check"></i><b>3.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="simulace3shift.html"><a href="simulace3shift.html#graphical-output-1"><i class="fa fa-check"></i><b>3.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="simulace3diskr.html"><a href="simulace3diskr.html"><i class="fa fa-check"></i><b>4</b> Dependency on Discretization</a>
<ul>
<li class="chapter" data-level="4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simulation-of-functional-data-3"><i class="fa fa-check"></i><b>4.1</b> Simulation of Functional Data</a></li>
<li class="chapter" data-level="4.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#smoothing-the-observed-curves-2"><i class="fa fa-check"></i><b>4.2</b> Smoothing the Observed Curves</a></li>
<li class="chapter" data-level="4.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#klasif3diskr"><i class="fa fa-check"></i><b>4.3</b> Classification of Curves</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#decision-trees-1"><i class="fa fa-check"></i><b>4.3.1</b> Decision Trees</a></li>
<li class="chapter" data-level="4.3.2" data-path="simulace3diskr.html"><a href="simulace3diskr.html#random-forests-2"><i class="fa fa-check"></i><b>4.3.2</b> Random Forests</a></li>
<li class="chapter" data-level="4.3.3" data-path="simulace3diskr.html"><a href="simulace3diskr.html#support-vector-machines-3"><i class="fa fa-check"></i><b>4.3.3</b> Support Vector Machines</a></li>
<li class="chapter" data-level="4.3.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#results-table-2"><i class="fa fa-check"></i><b>4.3.4</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="simulace3diskr.html"><a href="simulace3diskr.html#simul3diskr"><i class="fa fa-check"></i><b>4.4</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="simulace3diskr.html"><a href="simulace3diskr.html#graphical-output-2"><i class="fa fa-check"></i><b>4.4.1</b> Graphical Output</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="simulace4.html"><a href="simulace4.html"><i class="fa fa-check"></i><b>5</b> Simulation - Using Derivatives</a>
<ul>
<li class="chapter" data-level="5.1" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-first-derivative"><i class="fa fa-check"></i><b>5.1</b> Classification Based on the First Derivative</a>
<ul>
<li class="chapter" data-level="5.1.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-observed-curves-1"><i class="fa fa-check"></i><b>5.1.1</b> Smoothing Observed Curves</a></li>
<li class="chapter" data-level="5.1.2" data-path="simulace4.html"><a href="simulace4.html#calculation-of-derivatives"><i class="fa fa-check"></i><b>5.1.2</b> Calculation of Derivatives</a></li>
<li class="chapter" data-level="5.1.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-3"><i class="fa fa-check"></i><b>5.1.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.1.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-3"><i class="fa fa-check"></i><b>5.1.4</b> Simulation Study</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="simulace4.html"><a href="simulace4.html#classification-based-on-the-second-derivative"><i class="fa fa-check"></i><b>5.2</b> Classification Based on the Second Derivative</a>
<ul>
<li class="chapter" data-level="5.2.1" data-path="simulace4.html"><a href="simulace4.html#smoothing-of-observed-curves"><i class="fa fa-check"></i><b>5.2.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="5.2.2" data-path="simulace4.html"><a href="simulace4.html#derivative-calculation"><i class="fa fa-check"></i><b>5.2.2</b> Derivative Calculation</a></li>
<li class="chapter" data-level="5.2.3" data-path="simulace4.html"><a href="simulace4.html#classification-of-curves-4"><i class="fa fa-check"></i><b>5.2.3</b> Classification of Curves</a></li>
<li class="chapter" data-level="5.2.4" data-path="simulace4.html"><a href="simulace4.html#simulation-study-4"><i class="fa fa-check"></i><b>5.2.4</b> Simulation Study</a></li>
</ul></li>
</ul></li>
<li class="part"><span><b>APPLICATION</b></span></li>
<li class="chapter" data-level="6" data-path="aplikace3.html"><a href="aplikace3.html"><i class="fa fa-check"></i><b>6</b> TECATOR dataset</a>
<ul>
<li class="chapter" data-level="6.1" data-path="aplikace3.html"><a href="aplikace3.html#smoothing-of-observed-curves-1"><i class="fa fa-check"></i><b>6.1</b> Smoothing of Observed Curves</a></li>
<li class="chapter" data-level="6.2" data-path="aplikace3.html"><a href="aplikace3.html#computation-of-derivatives"><i class="fa fa-check"></i><b>6.2</b> Computation of Derivatives</a></li>
<li class="chapter" data-level="6.3" data-path="aplikace3.html"><a href="aplikace3.html#classification-of-original-curves"><i class="fa fa-check"></i><b>6.3</b> Classification of Original Curves</a>
<ul>
<li class="chapter" data-level="6.3.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-5"><i class="fa fa-check"></i><b>6.3.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.3.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-5"><i class="fa fa-check"></i><b>6.3.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.3.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-5"><i class="fa fa-check"></i><b>6.3.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.3.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-4"><i class="fa fa-check"></i><b>6.3.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.3.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-5"><i class="fa fa-check"></i><b>6.3.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.3.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-6"><i class="fa fa-check"></i><b>6.3.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.3.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-5"><i class="fa fa-check"></i><b>6.3.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.4" data-path="aplikace3.html"><a href="aplikace3.html#klasA3deriv"><i class="fa fa-check"></i><b>6.4</b> Classification Using the Second Derivative</a>
<ul>
<li class="chapter" data-level="6.4.1" data-path="aplikace3.html"><a href="aplikace3.html#k-nearest-neighbors-6"><i class="fa fa-check"></i><b>6.4.1</b> <span class="math inline">\(K\)</span> Nearest Neighbors</a></li>
<li class="chapter" data-level="6.4.2" data-path="aplikace3.html"><a href="aplikace3.html#linear-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.2</b> Linear Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.3" data-path="aplikace3.html"><a href="aplikace3.html#quadratic-discriminant-analysis-6"><i class="fa fa-check"></i><b>6.4.3</b> Quadratic Discriminant Analysis</a></li>
<li class="chapter" data-level="6.4.4" data-path="aplikace3.html"><a href="aplikace3.html#logistic-regression-6"><i class="fa fa-check"></i><b>6.4.4</b> Logistic Regression</a></li>
<li class="chapter" data-level="6.4.5" data-path="aplikace3.html"><a href="aplikace3.html#decision-trees-5"><i class="fa fa-check"></i><b>6.4.5</b> Decision Trees</a></li>
<li class="chapter" data-level="6.4.6" data-path="aplikace3.html"><a href="aplikace3.html#random-forests-6"><i class="fa fa-check"></i><b>6.4.6</b> Random Forests</a></li>
<li class="chapter" data-level="6.4.7" data-path="aplikace3.html"><a href="aplikace3.html#support-vector-machines-7"><i class="fa fa-check"></i><b>6.4.7</b> Support Vector Machines</a></li>
<li class="chapter" data-level="6.4.8" data-path="aplikace3.html"><a href="aplikace3.html#results-table-6"><i class="fa fa-check"></i><b>6.4.8</b> Results Table</a></li>
</ul></li>
<li class="chapter" data-level="6.5" data-path="aplikace3.html"><a href="aplikace3.html#simstudyA3"><i class="fa fa-check"></i><b>6.5</b> Simulation Study</a>
<ul>
<li class="chapter" data-level="6.5.1" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-original-data"><i class="fa fa-check"></i><b>6.5.1</b> Simulation for original Data</a></li>
<li class="chapter" data-level="6.5.2" data-path="aplikace3.html"><a href="aplikace3.html#simulation-for-derivations"><i class="fa fa-check"></i><b>6.5.2</b> Simulation for derivations</a></li>
</ul></li>
</ul></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Functional classification with vertical differences using SVM</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="simulace3sigma" class="section level1 hasAnchor" number="2">
<h1><span class="header-section-number">Chapter 2</span> Dependency on the parameter <span class="math inline">\(\sigma^2\)</span><a href="simulace3sigma.html#simulace3sigma" class="anchor-section" aria-label="Anchor link to header"></a></h1>
<p>In this section, we will focus on the dependency of the results from the previous Chapter <a href="simulace3.html#simulace3">1</a> on the value of <span class="math inline">\(\sigma^2\)</span>, which defines the variance of the normal distribution from which we generate random errors around the generating curves (we can say that <span class="math inline">\(\sigma^2\)</span> carries information about the measurement error of a certain device, for example). We expect that with an increasing value of <span class="math inline">\(\sigma^2\)</span>, the results of the individual methods will deteriorate, and thus classification will not be as successful. In the following section <a href="simulace3shift.html#simulace3shift">3</a>, we will then examine the dependency of the results on the value of <span class="math inline">\(\sigma^2_{shift}\)</span>, that is, the variance of the normal distribution from which we generate the shift for the generated curves.</p>
<div id="simulation-of-functional-data-1" class="section level2 hasAnchor" number="2.1">
<h2><span class="header-section-number">2.1</span> Simulation of Functional Data<a href="simulace3sigma.html#simulation-of-functional-data-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will simulate the functions that we will later want to classify. For simplicity, we will consider two classification classes. For the simulation, we will first:</p>
<ul>
<li><p>choose appropriate functions,</p></li>
<li><p>generate points from the chosen interval, which contain, for example, Gaussian noise,</p></li>
<li><p>smooth the obtained discrete points into the form of a functional object using some suitable basis system.</p></li>
</ul>
<p>Through this procedure, we will obtain functional objects along with the value of the categorical variable <span class="math inline">\(Y\)</span>, which distinguishes the belonging to a classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb174"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb174-1"><a href="simulace3sigma.html#cb174-1" tabindex="-1"></a><span class="co"># Load necessary packages </span></span>
<span id="cb174-2"><a href="simulace3sigma.html#cb174-2" tabindex="-1"></a></span>
<span id="cb174-3"><a href="simulace3sigma.html#cb174-3" tabindex="-1"></a><span class="fu">library</span>(fda)</span>
<span id="cb174-4"><a href="simulace3sigma.html#cb174-4" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span>
<span id="cb174-5"><a href="simulace3sigma.html#cb174-5" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb174-6"><a href="simulace3sigma.html#cb174-6" tabindex="-1"></a><span class="fu">library</span>(tidyr)</span>
<span id="cb174-7"><a href="simulace3sigma.html#cb174-7" tabindex="-1"></a><span class="fu">library</span>(ddalpha)</span>
<span id="cb174-8"><a href="simulace3sigma.html#cb174-8" tabindex="-1"></a><span class="fu">library</span>(polynom)</span>
<span id="cb174-9"><a href="simulace3sigma.html#cb174-9" tabindex="-1"></a></span>
<span id="cb174-10"><a href="simulace3sigma.html#cb174-10" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span></code></pre></div>
</details>
<p>Let us consider two classification classes, <span class="math inline">\(Y \in \{0, 1\}\)</span>, with the same number of generated functions <code>n</code> for each class. First, we will define two functions, each for one class. We will consider the functions over the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<p>Now we will create functions using interpolation polynomials. First, we will define the points through which our curve should pass, and then we will interpolate them with a polynomial, which we will use to generate curves for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb175"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb175-1"><a href="simulace3sigma.html#cb175-1" tabindex="-1"></a><span class="co"># Defining points for class 0</span></span>
<span id="cb175-2"><a href="simulace3sigma.html#cb175-2" tabindex="-1"></a>x<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.65</span>, <span class="fl">0.94</span>, <span class="fl">1.42</span>, <span class="fl">2.26</span>, <span class="fl">2.84</span>, <span class="fl">3.73</span>, <span class="fl">4.50</span>, <span class="fl">5.43</span>, <span class="fl">6.00</span>)</span>
<span id="cb175-3"><a href="simulace3sigma.html#cb175-3" tabindex="-1"></a>y<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="fl">0.25</span>, <span class="fl">0.86</span>, <span class="fl">1.49</span>, <span class="fl">1.1</span>, <span class="fl">0.15</span>, <span class="sc">-</span><span class="fl">0.11</span>, <span class="sc">-</span><span class="fl">0.36</span>, <span class="fl">0.23</span>, <span class="dv">0</span>)</span>
<span id="cb175-4"><a href="simulace3sigma.html#cb175-4" tabindex="-1"></a></span>
<span id="cb175-5"><a href="simulace3sigma.html#cb175-5" tabindex="-1"></a><span class="co"># Defining points for class 1</span></span>
<span id="cb175-6"><a href="simulace3sigma.html#cb175-6" tabindex="-1"></a>x<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.00</span>, <span class="fl">0.51</span>, <span class="fl">0.91</span>, <span class="fl">1.25</span>, <span class="fl">1.51</span>, <span class="fl">2.14</span>, <span class="fl">2.43</span>, <span class="fl">2.96</span>, <span class="fl">3.70</span>, <span class="fl">4.60</span>,</span>
<span id="cb175-7"><a href="simulace3sigma.html#cb175-7" tabindex="-1"></a>         <span class="fl">5.25</span>, <span class="fl">5.67</span>, <span class="fl">6.00</span>)</span>
<span id="cb175-8"><a href="simulace3sigma.html#cb175-8" tabindex="-1"></a>y<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.4</span>, <span class="fl">0.71</span>, <span class="fl">1.08</span>, <span class="fl">1.47</span>, <span class="fl">1.39</span>, <span class="fl">0.81</span>, <span class="fl">0.05</span>, <span class="sc">-</span><span class="fl">0.1</span>, <span class="sc">-</span><span class="fl">0.4</span>,</span>
<span id="cb175-9"><a href="simulace3sigma.html#cb175-9" tabindex="-1"></a>         <span class="fl">0.3</span>, <span class="fl">0.37</span>, <span class="dv">0</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb176"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb176-1"><a href="simulace3sigma.html#cb176-1" tabindex="-1"></a><span class="co"># Graph of points</span></span>
<span id="cb176-2"><a href="simulace3sigma.html#cb176-2" tabindex="-1"></a>dat_points <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(x<span class="fl">.0</span>, x<span class="fl">.1</span>),</span>
<span id="cb176-3"><a href="simulace3sigma.html#cb176-3" tabindex="-1"></a>                         <span class="at">y =</span> <span class="fu">c</span>(y<span class="fl">.0</span>, y<span class="fl">.1</span>),</span>
<span id="cb176-4"><a href="simulace3sigma.html#cb176-4" tabindex="-1"></a>                         <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb176-5"><a href="simulace3sigma.html#cb176-5" tabindex="-1"></a>                                     <span class="fu">c</span>(<span class="fu">length</span>(x<span class="fl">.0</span>), <span class="fu">length</span>(x<span class="fl">.1</span>))))</span>
<span id="cb176-6"><a href="simulace3sigma.html#cb176-6" tabindex="-1"></a></span>
<span id="cb176-7"><a href="simulace3sigma.html#cb176-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb176-8"><a href="simulace3sigma.html#cb176-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb176-9"><a href="simulace3sigma.html#cb176-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb176-10"><a href="simulace3sigma.html#cb176-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-3"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-3-1.png" alt="Body defining interpolation polynomials." width="672" />
<p class="caption">
Figure 1.1: Body defining interpolation polynomials.
</p>
</div>
<p>To calculate the interpolation polynomials, we will use the function <code>poly.calc()</code> from the <code>polynom</code> package. We will also define the functions <code>poly.0()</code> and <code>poly.1()</code>, which will calculate the values of the polynomials at a given point in the interval. We will use the function <code>predict()</code>, to which we will input the corresponding polynomial and the point at which we want to evaluate the polynomial.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb177"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb177-1"><a href="simulace3sigma.html#cb177-1" tabindex="-1"></a><span class="co"># Calculation of polynomials</span></span>
<span id="cb177-2"><a href="simulace3sigma.html#cb177-2" tabindex="-1"></a>polynom<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.0</span>, y<span class="fl">.0</span>)</span>
<span id="cb177-3"><a href="simulace3sigma.html#cb177-3" tabindex="-1"></a>polynom<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.calc</span>(x<span class="fl">.1</span>, y<span class="fl">.1</span>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb178"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb178-1"><a href="simulace3sigma.html#cb178-1" tabindex="-1"></a>poly<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.0</span>, x))</span>
<span id="cb178-2"><a href="simulace3sigma.html#cb178-2" tabindex="-1"></a>poly<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="cf">function</span>(x) <span class="fu">return</span>(<span class="fu">predict</span>(polynom<span class="fl">.1</span>, x))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb179"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb179-1"><a href="simulace3sigma.html#cb179-1" tabindex="-1"></a><span class="co"># Plotting polynomials</span></span>
<span id="cb179-2"><a href="simulace3sigma.html#cb179-2" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(x<span class="fl">.0</span>), <span class="fu">max</span>(x<span class="fl">.0</span>), <span class="at">length =</span> <span class="dv">501</span>)</span>
<span id="cb179-3"><a href="simulace3sigma.html#cb179-3" tabindex="-1"></a>yy<span class="fl">.0</span> <span class="ot">&lt;-</span> <span class="fu">poly.0</span>(xx)</span>
<span id="cb179-4"><a href="simulace3sigma.html#cb179-4" tabindex="-1"></a>yy<span class="fl">.1</span> <span class="ot">&lt;-</span> <span class="fu">poly.1</span>(xx)</span>
<span id="cb179-5"><a href="simulace3sigma.html#cb179-5" tabindex="-1"></a></span>
<span id="cb179-6"><a href="simulace3sigma.html#cb179-6" tabindex="-1"></a>dat_poly_plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="fu">c</span>(xx, xx),</span>
<span id="cb179-7"><a href="simulace3sigma.html#cb179-7" tabindex="-1"></a>                            <span class="at">y =</span> <span class="fu">c</span>(yy<span class="fl">.0</span>, yy<span class="fl">.1</span>),</span>
<span id="cb179-8"><a href="simulace3sigma.html#cb179-8" tabindex="-1"></a>                            <span class="at">Class =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>), </span>
<span id="cb179-9"><a href="simulace3sigma.html#cb179-9" tabindex="-1"></a>                                        <span class="fu">c</span>(<span class="fu">length</span>(xx), <span class="fu">length</span>(xx))))</span>
<span id="cb179-10"><a href="simulace3sigma.html#cb179-10" tabindex="-1"></a></span>
<span id="cb179-11"><a href="simulace3sigma.html#cb179-11" tabindex="-1"></a><span class="fu">ggplot</span>(dat_points, <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class)) <span class="sc">+</span> </span>
<span id="cb179-12"><a href="simulace3sigma.html#cb179-12" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size=</span><span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb179-13"><a href="simulace3sigma.html#cb179-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb179-14"><a href="simulace3sigma.html#cb179-14" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> dat_poly_plot,</span>
<span id="cb179-15"><a href="simulace3sigma.html#cb179-15" tabindex="-1"></a>            <span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y, <span class="at">colour =</span> Class),</span>
<span id="cb179-16"><a href="simulace3sigma.html#cb179-16" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.8</span>) <span class="sc">+</span> </span>
<span id="cb179-17"><a href="simulace3sigma.html#cb179-17" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-6"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-6-1.png" alt="Illustration of two functions over the interval $I = [0, 6]$, from which we generate observations from classes 0 and 1." width="672" />
<p class="caption">
Figure 1.2: Illustration of two functions over the interval <span class="math inline">\(I = [0, 6]\)</span>, from which we generate observations from classes 0 and 1.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb180"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb180-1"><a href="simulace3sigma.html#cb180-1" tabindex="-1"></a><span class="co"># Generating functions for Y = 0 and Y = 1</span></span>
<span id="cb180-2"><a href="simulace3sigma.html#cb180-2" tabindex="-1"></a>funkce_0 <span class="ot">&lt;-</span> poly<span class="fl">.0</span></span>
<span id="cb180-3"><a href="simulace3sigma.html#cb180-3" tabindex="-1"></a>funkce_1 <span class="ot">&lt;-</span> poly<span class="fl">.1</span></span></code></pre></div>
</details>
<p>Now we will create a function for generating random functions with added noise (or points on a predetermined grid) from the chosen generating function. The argument <code>t</code> denotes the vector of values at which we want to evaluate the functions, <code>fun</code> indicates the generating function, <code>n</code> is the number of functions, and <code>sigma</code> is the standard deviation <span class="math inline">\(\sigma\)</span> of the normal distribution <span class="math inline">\(\text{N}(\mu, \sigma^2)\)</span>, from which we randomly generate Gaussian white noise with <span class="math inline">\(\mu = 0\)</span>. To demonstrate the advantage of using methods that work with functional data, we will also add a random component to each simulated observation, which will represent the vertical shift of the entire function (parameter <code>sigma_shift</code>). This shift will be generated from a normal distribution with the parameter <span class="math inline">\(\sigma^2 = 4\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb181"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb181-1"><a href="simulace3sigma.html#cb181-1" tabindex="-1"></a>generate_values <span class="ot">&lt;-</span> <span class="cf">function</span>(t, fun, n, sigma, <span class="at">sigma_shift =</span> <span class="dv">0</span>) {</span>
<span id="cb181-2"><a href="simulace3sigma.html#cb181-2" tabindex="-1"></a>  <span class="co"># Arguments:</span></span>
<span id="cb181-3"><a href="simulace3sigma.html#cb181-3" tabindex="-1"></a>  <span class="co"># t ... vector of values, where the function will be evaluated</span></span>
<span id="cb181-4"><a href="simulace3sigma.html#cb181-4" tabindex="-1"></a>  <span class="co"># fun ... generating function of t </span></span>
<span id="cb181-5"><a href="simulace3sigma.html#cb181-5" tabindex="-1"></a>  <span class="co"># n ... the number of generated functions / objects</span></span>
<span id="cb181-6"><a href="simulace3sigma.html#cb181-6" tabindex="-1"></a>  <span class="co"># sigma ... standard deviation of normal distribution to add noise to data</span></span>
<span id="cb181-7"><a href="simulace3sigma.html#cb181-7" tabindex="-1"></a>  <span class="co"># sigma_shift ... parameter of normal distribution for generating shift</span></span>
<span id="cb181-8"><a href="simulace3sigma.html#cb181-8" tabindex="-1"></a>  </span>
<span id="cb181-9"><a href="simulace3sigma.html#cb181-9" tabindex="-1"></a>  <span class="co"># Value:</span></span>
<span id="cb181-10"><a href="simulace3sigma.html#cb181-10" tabindex="-1"></a>  <span class="co"># X ... matrix of dimension length(t) times n with generated values of one </span></span>
<span id="cb181-11"><a href="simulace3sigma.html#cb181-11" tabindex="-1"></a>  <span class="co"># function in a column </span></span>
<span id="cb181-12"><a href="simulace3sigma.html#cb181-12" tabindex="-1"></a>  </span>
<span id="cb181-13"><a href="simulace3sigma.html#cb181-13" tabindex="-1"></a>  X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(t, <span class="at">times =</span> n), <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-14"><a href="simulace3sigma.html#cb181-14" tabindex="-1"></a>  noise <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rnorm</span>(n <span class="sc">*</span> <span class="fu">length</span>(t), <span class="at">mean =</span> <span class="dv">0</span>, <span class="at">sd =</span> sigma),</span>
<span id="cb181-15"><a href="simulace3sigma.html#cb181-15" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t), <span class="at">byrow =</span> <span class="cn">FALSE</span>)</span>
<span id="cb181-16"><a href="simulace3sigma.html#cb181-16" tabindex="-1"></a>  shift <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">rep</span>(<span class="fu">rnorm</span>(n, <span class="dv">0</span>, sigma_shift), <span class="at">each =</span> <span class="fu">length</span>(t)),</span>
<span id="cb181-17"><a href="simulace3sigma.html#cb181-17" tabindex="-1"></a>                  <span class="at">ncol =</span> n, <span class="at">nrow =</span> <span class="fu">length</span>(t))</span>
<span id="cb181-18"><a href="simulace3sigma.html#cb181-18" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">fun</span>(X) <span class="sc">+</span> noise <span class="sc">+</span> shift)</span>
<span id="cb181-19"><a href="simulace3sigma.html#cb181-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can generate functions. In each of the two classes, we will consider 100 observations, thus <code>n = 100</code>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb182"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb182-1"><a href="simulace3sigma.html#cb182-1" tabindex="-1"></a><span class="co"># number of generated observations for each class</span></span>
<span id="cb182-2"><a href="simulace3sigma.html#cb182-2" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb182-3"><a href="simulace3sigma.html#cb182-3" tabindex="-1"></a><span class="co"># vector of time equidistant on the interval [0, 6]</span></span>
<span id="cb182-4"><a href="simulace3sigma.html#cb182-4" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb182-5"><a href="simulace3sigma.html#cb182-5" tabindex="-1"></a></span>
<span id="cb182-6"><a href="simulace3sigma.html#cb182-6" tabindex="-1"></a><span class="co"># for Y = 0</span></span>
<span id="cb182-7"><a href="simulace3sigma.html#cb182-7" tabindex="-1"></a>X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, <span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb182-8"><a href="simulace3sigma.html#cb182-8" tabindex="-1"></a><span class="co"># for Y = 1</span></span>
<span id="cb182-9"><a href="simulace3sigma.html#cb182-9" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, <span class="dv">1</span>, <span class="dv">2</span>)</span></code></pre></div>
</details>
<p>We will plot the generated (not smoothed) functions colored by class (only the first 10 observations from each class for clarity).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb183"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb183-1"><a href="simulace3sigma.html#cb183-1" tabindex="-1"></a>n_curves_plot <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># number of curves to plot from each group</span></span>
<span id="cb183-2"><a href="simulace3sigma.html#cb183-2" tabindex="-1"></a></span>
<span id="cb183-3"><a href="simulace3sigma.html#cb183-3" tabindex="-1"></a>DF0 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X0[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb183-4"><a href="simulace3sigma.html#cb183-4" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb183-5"><a href="simulace3sigma.html#cb183-5" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb183-6"><a href="simulace3sigma.html#cb183-6" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb183-7"><a href="simulace3sigma.html#cb183-7" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb183-8"><a href="simulace3sigma.html#cb183-8" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb183-9"><a href="simulace3sigma.html#cb183-9" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">0</span></span>
<span id="cb183-10"><a href="simulace3sigma.html#cb183-10" tabindex="-1"></a>  )</span>
<span id="cb183-11"><a href="simulace3sigma.html#cb183-11" tabindex="-1"></a></span>
<span id="cb183-12"><a href="simulace3sigma.html#cb183-12" tabindex="-1"></a>DF1 <span class="ot">&lt;-</span> <span class="fu">cbind</span>(t, X1[, <span class="dv">1</span><span class="sc">:</span>n_curves_plot]) <span class="sc">|&gt;</span> </span>
<span id="cb183-13"><a href="simulace3sigma.html#cb183-13" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb183-14"><a href="simulace3sigma.html#cb183-14" tabindex="-1"></a>  <span class="fu">reshape</span>(<span class="at">varying =</span> <span class="dv">2</span><span class="sc">:</span>(n_curves_plot <span class="sc">+</span> <span class="dv">1</span>), <span class="at">direction =</span> <span class="st">&#39;long&#39;</span>, <span class="at">sep =</span> <span class="st">&#39;&#39;</span>) <span class="sc">|&gt;</span> </span>
<span id="cb183-15"><a href="simulace3sigma.html#cb183-15" tabindex="-1"></a>  <span class="fu">subset</span>(<span class="at">select =</span> <span class="sc">-</span>id) <span class="sc">|&gt;</span> </span>
<span id="cb183-16"><a href="simulace3sigma.html#cb183-16" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb183-17"><a href="simulace3sigma.html#cb183-17" tabindex="-1"></a>  <span class="at">time =</span> time <span class="sc">-</span> <span class="dv">1</span>,</span>
<span id="cb183-18"><a href="simulace3sigma.html#cb183-18" tabindex="-1"></a>  <span class="at">group =</span> <span class="dv">1</span></span>
<span id="cb183-19"><a href="simulace3sigma.html#cb183-19" tabindex="-1"></a>  )</span>
<span id="cb183-20"><a href="simulace3sigma.html#cb183-20" tabindex="-1"></a></span>
<span id="cb183-21"><a href="simulace3sigma.html#cb183-21" tabindex="-1"></a>DF <span class="ot">&lt;-</span> <span class="fu">rbind</span>(DF0, DF1) <span class="sc">|&gt;</span></span>
<span id="cb183-22"><a href="simulace3sigma.html#cb183-22" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">group =</span> <span class="fu">factor</span>(group))</span>
<span id="cb183-23"><a href="simulace3sigma.html#cb183-23" tabindex="-1"></a></span>
<span id="cb183-24"><a href="simulace3sigma.html#cb183-24" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> V, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb183-25"><a href="simulace3sigma.html#cb183-25" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb183-26"><a href="simulace3sigma.html#cb183-26" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb183-27"><a href="simulace3sigma.html#cb183-27" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb183-28"><a href="simulace3sigma.html#cb183-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb183-29"><a href="simulace3sigma.html#cb183-29" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb183-30"><a href="simulace3sigma.html#cb183-30" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb183-31"><a href="simulace3sigma.html#cb183-31" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-11"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-11-1.png" alt="First 10 generated observations from each of the two classification classes. The observed data are not smoothed." width="672" />
<p class="caption">
Figure 2.1: First 10 generated observations from each of the two classification classes. The observed data are not smoothed.
</p>
</div>
</div>
<div id="smoothing-the-observed-curves" class="section level2 hasAnchor" number="2.2">
<h2><span class="header-section-number">2.2</span> Smoothing the Observed Curves<a href="simulace3sigma.html#smoothing-the-observed-curves" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>Now we will convert the observed discrete values (vectors of values) into functional objects that we will subsequently work with. We will again use B-spline basis for smoothing.</p>
<p>We take the entire vector <code>t</code> as the knots, and we typically consider cubic splines, thus we choose (the implicit choice in <code>R</code>) <code>norder = 4</code>. We will penalize the second derivative of the functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb184"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb184-1"><a href="simulace3sigma.html#cb184-1" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb184-2"><a href="simulace3sigma.html#cb184-2" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> t</span>
<span id="cb184-3"><a href="simulace3sigma.html#cb184-3" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb184-4"><a href="simulace3sigma.html#cb184-4" tabindex="-1"></a></span>
<span id="cb184-5"><a href="simulace3sigma.html#cb184-5" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb184-6"><a href="simulace3sigma.html#cb184-6" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb184-7"><a href="simulace3sigma.html#cb184-7" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb184-8"><a href="simulace3sigma.html#cb184-8" tabindex="-1"></a></span>
<span id="cb184-9"><a href="simulace3sigma.html#cb184-9" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) <span class="co"># penalizing the 2nd derivative</span></span></code></pre></div>
</details>
<p>We will find an appropriate value of the smoothing parameter <span class="math inline">\(\lambda &gt; 0\)</span> using <span class="math inline">\(GCV(\lambda)\)</span>, that is, using generalized cross-validation. We will consider the value of <span class="math inline">\(\lambda\)</span> the same for both classification groups, since for test observations, we would not know in advance which value of <span class="math inline">\(\lambda\)</span>, in the case of different choices for each class, we should select.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb185"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb185-1"><a href="simulace3sigma.html#cb185-1" tabindex="-1"></a><span class="co"># combining observations into one matrix</span></span>
<span id="cb185-2"><a href="simulace3sigma.html#cb185-2" tabindex="-1"></a>XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb185-3"><a href="simulace3sigma.html#cb185-3" tabindex="-1"></a></span>
<span id="cb185-4"><a href="simulace3sigma.html#cb185-4" tabindex="-1"></a>lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">2</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">50</span>) <span class="co"># vector of lambdas</span></span>
<span id="cb185-5"><a href="simulace3sigma.html#cb185-5" tabindex="-1"></a>gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector for storing GCV</span></span>
<span id="cb185-6"><a href="simulace3sigma.html#cb185-6" tabindex="-1"></a></span>
<span id="cb185-7"><a href="simulace3sigma.html#cb185-7" tabindex="-1"></a><span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb185-8"><a href="simulace3sigma.html#cb185-8" tabindex="-1"></a>  curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb185-9"><a href="simulace3sigma.html#cb185-9" tabindex="-1"></a>  BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb185-10"><a href="simulace3sigma.html#cb185-10" tabindex="-1"></a>  gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb185-11"><a href="simulace3sigma.html#cb185-11" tabindex="-1"></a>}</span>
<span id="cb185-12"><a href="simulace3sigma.html#cb185-12" tabindex="-1"></a></span>
<span id="cb185-13"><a href="simulace3sigma.html#cb185-13" tabindex="-1"></a>GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb185-14"><a href="simulace3sigma.html#cb185-14" tabindex="-1"></a>  <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb185-15"><a href="simulace3sigma.html#cb185-15" tabindex="-1"></a>  <span class="at">GCV =</span> gcv</span>
<span id="cb185-16"><a href="simulace3sigma.html#cb185-16" tabindex="-1"></a>)</span>
<span id="cb185-17"><a href="simulace3sigma.html#cb185-17" tabindex="-1"></a></span>
<span id="cb185-18"><a href="simulace3sigma.html#cb185-18" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb185-19"><a href="simulace3sigma.html#cb185-19" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span></code></pre></div>
</details>
<p>For better visualization, we will plot the progression of <span class="math inline">\(GCV(\lambda)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb186"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb186-1"><a href="simulace3sigma.html#cb186-1" tabindex="-1"></a>GCV <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> lambda, <span class="at">y =</span> GCV)) <span class="sc">+</span> </span>
<span id="cb186-2"><a href="simulace3sigma.html#cb186-2" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb186-3"><a href="simulace3sigma.html#cb186-3" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb186-4"><a href="simulace3sigma.html#cb186-4" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb186-5"><a href="simulace3sigma.html#cb186-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(log[<span class="dv">10</span>](lambda), <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb186-6"><a href="simulace3sigma.html#cb186-6" tabindex="-1"></a>                        lambda[optimal] <span class="sc">==</span> .(<span class="fu">round</span>(lambda.opt, <span class="dv">4</span>)))),</span>
<span id="cb186-7"><a href="simulace3sigma.html#cb186-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">GCV</span>(lambda))) <span class="sc">+</span> </span>
<span id="cb186-8"><a href="simulace3sigma.html#cb186-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> <span class="fu">log10</span>(lambda.opt), <span class="at">y =</span> <span class="fu">min</span>(gcv)), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="fl">2.5</span>)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = log10(lambda.opt), y = min(gcv)), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 50 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-14"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-14-1.png" alt="The progression of $GCV(\lambda)$ for the chosen vector $\boldsymbol\lambda$. The values on the x-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter $\lambda_{optimal}$ is shown in red." width="672" />
<p class="caption">
Figure 1.5: The progression of <span class="math inline">\(GCV(\lambda)\)</span> for the chosen vector <span class="math inline">\(\boldsymbol\lambda\)</span>. The values on the x-axis are plotted on a logarithmic scale. The optimal value of the smoothing parameter <span class="math inline">\(\lambda_{optimal}\)</span> is shown in red.
</p>
</div>
<p>With this optimal choice of the smoothing parameter <span class="math inline">\(\lambda\)</span>, we will now smooth all functions and again graphically represent the first 10 observed curves from each classification class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb188"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb188-1"><a href="simulace3sigma.html#cb188-1" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb188-2"><a href="simulace3sigma.html#cb188-2" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb188-3"><a href="simulace3sigma.html#cb188-3" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb188-4"><a href="simulace3sigma.html#cb188-4" tabindex="-1"></a></span>
<span id="cb188-5"><a href="simulace3sigma.html#cb188-5" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb188-6"><a href="simulace3sigma.html#cb188-6" tabindex="-1"></a>DF<span class="sc">$</span>Vsmooth <span class="ot">&lt;-</span> <span class="fu">c</span>(fdobjSmootheval[, <span class="fu">c</span>(<span class="dv">1</span> <span class="sc">:</span> n_curves_plot, </span>
<span id="cb188-7"><a href="simulace3sigma.html#cb188-7" tabindex="-1"></a>                                    (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (n <span class="sc">+</span> n_curves_plot))])</span>
<span id="cb188-8"><a href="simulace3sigma.html#cb188-8" tabindex="-1"></a></span>
<span id="cb188-9"><a href="simulace3sigma.html#cb188-9" tabindex="-1"></a>DF <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Vsmooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb188-10"><a href="simulace3sigma.html#cb188-10" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb188-11"><a href="simulace3sigma.html#cb188-11" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.75</span>) <span class="sc">+</span></span>
<span id="cb188-12"><a href="simulace3sigma.html#cb188-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb188-13"><a href="simulace3sigma.html#cb188-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb188-14"><a href="simulace3sigma.html#cb188-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb188-15"><a href="simulace3sigma.html#cb188-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb188-16"><a href="simulace3sigma.html#cb188-16" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels=</span><span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-15"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-15-1.png" alt="First 10 smoothed curves from each classification class." width="672" />
<p class="caption">
Figure 1.6: First 10 smoothed curves from each classification class.
</p>
</div>
<p>Let’s also visualize all curves, including the average, separately for each class.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb189"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb189-1"><a href="simulace3sigma.html#cb189-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb189-2"><a href="simulace3sigma.html#cb189-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb189-3"><a href="simulace3sigma.html#cb189-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb189-4"><a href="simulace3sigma.html#cb189-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb189-5"><a href="simulace3sigma.html#cb189-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb189-6"><a href="simulace3sigma.html#cb189-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb189-7"><a href="simulace3sigma.html#cb189-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb189-8"><a href="simulace3sigma.html#cb189-8" tabindex="-1"></a>)</span>
<span id="cb189-9"><a href="simulace3sigma.html#cb189-9" tabindex="-1"></a></span>
<span id="cb189-10"><a href="simulace3sigma.html#cb189-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb189-11"><a href="simulace3sigma.html#cb189-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb189-12"><a href="simulace3sigma.html#cb189-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb189-13"><a href="simulace3sigma.html#cb189-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb189-14"><a href="simulace3sigma.html#cb189-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb189-15"><a href="simulace3sigma.html#cb189-15" tabindex="-1"></a>)</span>
<span id="cb189-16"><a href="simulace3sigma.html#cb189-16" tabindex="-1"></a></span>
<span id="cb189-17"><a href="simulace3sigma.html#cb189-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb189-18"><a href="simulace3sigma.html#cb189-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb189-19"><a href="simulace3sigma.html#cb189-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb189-20"><a href="simulace3sigma.html#cb189-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb189-21"><a href="simulace3sigma.html#cb189-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb189-22"><a href="simulace3sigma.html#cb189-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb189-23"><a href="simulace3sigma.html#cb189-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb189-24"><a href="simulace3sigma.html#cb189-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb189-25"><a href="simulace3sigma.html#cb189-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb189-26"><a href="simulace3sigma.html#cb189-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb189-27"><a href="simulace3sigma.html#cb189-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb189-28"><a href="simulace3sigma.html#cb189-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb189-29"><a href="simulace3sigma.html#cb189-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>))<span class="co">#, limits = c(-1, 2))</span></span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-16"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-16-1.png" alt="Plotting all smoothed observed curves, with colors distinguishing the curves by their classification class. The thick line represents the average for each class." width="672" />
<p class="caption">
Figure 1.7: Plotting all smoothed observed curves, with colors distinguishing the curves by their classification class. The thick line represents the average for each class.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb190"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb190-1"><a href="simulace3sigma.html#cb190-1" tabindex="-1"></a>DFsmooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb190-2"><a href="simulace3sigma.html#cb190-2" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span> <span class="sc">*</span> n),</span>
<span id="cb190-3"><a href="simulace3sigma.html#cb190-3" tabindex="-1"></a>  <span class="at">time =</span> <span class="fu">rep</span>(<span class="fu">rep</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">each =</span> <span class="fu">length</span>(t)), <span class="dv">2</span>),</span>
<span id="cb190-4"><a href="simulace3sigma.html#cb190-4" tabindex="-1"></a>  <span class="at">Smooth =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb190-5"><a href="simulace3sigma.html#cb190-5" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), n),</span>
<span id="cb190-6"><a href="simulace3sigma.html#cb190-6" tabindex="-1"></a>            <span class="fu">rep</span>(<span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean), n)),</span>
<span id="cb190-7"><a href="simulace3sigma.html#cb190-7" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n <span class="sc">*</span> <span class="fu">length</span>(t)))</span>
<span id="cb190-8"><a href="simulace3sigma.html#cb190-8" tabindex="-1"></a>)</span>
<span id="cb190-9"><a href="simulace3sigma.html#cb190-9" tabindex="-1"></a></span>
<span id="cb190-10"><a href="simulace3sigma.html#cb190-10" tabindex="-1"></a>DFmean <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb190-11"><a href="simulace3sigma.html#cb190-11" tabindex="-1"></a>  <span class="at">t =</span> <span class="fu">rep</span>(t, <span class="dv">2</span>),</span>
<span id="cb190-12"><a href="simulace3sigma.html#cb190-12" tabindex="-1"></a>  <span class="at">Mean =</span> <span class="fu">c</span>(<span class="fu">apply</span>(fdobjSmootheval[ , <span class="dv">1</span> <span class="sc">:</span> n], <span class="dv">1</span>, mean), </span>
<span id="cb190-13"><a href="simulace3sigma.html#cb190-13" tabindex="-1"></a>            <span class="fu">apply</span>(fdobjSmootheval[ , (n <span class="sc">+</span> <span class="dv">1</span>) <span class="sc">:</span> (<span class="dv">2</span> <span class="sc">*</span> n)], <span class="dv">1</span>, mean)),</span>
<span id="cb190-14"><a href="simulace3sigma.html#cb190-14" tabindex="-1"></a>  <span class="at">group =</span> <span class="fu">factor</span>(<span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> <span class="fu">length</span>(t)))</span>
<span id="cb190-15"><a href="simulace3sigma.html#cb190-15" tabindex="-1"></a>)</span>
<span id="cb190-16"><a href="simulace3sigma.html#cb190-16" tabindex="-1"></a></span>
<span id="cb190-17"><a href="simulace3sigma.html#cb190-17" tabindex="-1"></a>DFsmooth <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Smooth, <span class="at">group =</span> <span class="fu">interaction</span>(time, group), </span>
<span id="cb190-18"><a href="simulace3sigma.html#cb190-18" tabindex="-1"></a>                 <span class="at">colour =</span> group)) <span class="sc">+</span> </span>
<span id="cb190-19"><a href="simulace3sigma.html#cb190-19" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linewidth =</span> <span class="fl">0.25</span>, <span class="at">alpha =</span> <span class="fl">0.5</span>) <span class="sc">+</span></span>
<span id="cb190-20"><a href="simulace3sigma.html#cb190-20" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb190-21"><a href="simulace3sigma.html#cb190-21" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(x[<span class="dv">1</span>]),</span>
<span id="cb190-22"><a href="simulace3sigma.html#cb190-22" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(x[<span class="dv">2</span>]),</span>
<span id="cb190-23"><a href="simulace3sigma.html#cb190-23" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) <span class="sc">+</span></span>
<span id="cb190-24"><a href="simulace3sigma.html#cb190-24" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span> </span>
<span id="cb190-25"><a href="simulace3sigma.html#cb190-25" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> t, <span class="at">y =</span> Mean, <span class="at">colour =</span> group), </span>
<span id="cb190-26"><a href="simulace3sigma.html#cb190-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.2</span>, <span class="at">linetype =</span> <span class="st">&#39;solid&#39;</span>) <span class="sc">+</span> </span>
<span id="cb190-27"><a href="simulace3sigma.html#cb190-27" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>)) <span class="sc">+</span> </span>
<span id="cb190-28"><a href="simulace3sigma.html#cb190-28" tabindex="-1"></a>  <span class="co">#ylim(c(-1, 2)) + </span></span>
<span id="cb190-29"><a href="simulace3sigma.html#cb190-29" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">expand =</span> <span class="fu">c</span>(<span class="fl">0.01</span>, <span class="fl">0.01</span>), <span class="at">limits =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-17"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-17-1.png" alt="Plotting all smoothed observed curves, with colors distinguishing the curves by their classification class. The thick line represents the average for each class. A close-up view." width="672" />
<p class="caption">
Figure 2.2: Plotting all smoothed observed curves, with colors distinguishing the curves by their classification class. The thick line represents the average for each class. A close-up view.
</p>
</div>
</div>
<div id="classification-of-curves-1" class="section level2 hasAnchor" number="2.3">
<h2><span class="header-section-number">2.3</span> Classification of Curves<a href="simulace3sigma.html#classification-of-curves-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>First, we will load the necessary libraries for classification.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb191"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb191-1"><a href="simulace3sigma.html#cb191-1" tabindex="-1"></a><span class="fu">library</span>(caTools) <span class="co"># for splitting into test and training</span></span>
<span id="cb191-2"><a href="simulace3sigma.html#cb191-2" tabindex="-1"></a><span class="fu">library</span>(caret) <span class="co"># for k-fold CV</span></span>
<span id="cb191-3"><a href="simulace3sigma.html#cb191-3" tabindex="-1"></a><span class="fu">library</span>(fda.usc) <span class="co"># for KNN, fLR</span></span>
<span id="cb191-4"><a href="simulace3sigma.html#cb191-4" tabindex="-1"></a><span class="fu">library</span>(MASS) <span class="co"># for LDA</span></span>
<span id="cb191-5"><a href="simulace3sigma.html#cb191-5" tabindex="-1"></a><span class="fu">library</span>(fdapace)</span>
<span id="cb191-6"><a href="simulace3sigma.html#cb191-6" tabindex="-1"></a><span class="fu">library</span>(pracma)</span>
<span id="cb191-7"><a href="simulace3sigma.html#cb191-7" tabindex="-1"></a><span class="fu">library</span>(refund) <span class="co"># for LR on scores</span></span>
<span id="cb191-8"><a href="simulace3sigma.html#cb191-8" tabindex="-1"></a><span class="fu">library</span>(nnet) <span class="co"># for LR on scores</span></span>
<span id="cb191-9"><a href="simulace3sigma.html#cb191-9" tabindex="-1"></a><span class="fu">library</span>(caret)</span>
<span id="cb191-10"><a href="simulace3sigma.html#cb191-10" tabindex="-1"></a><span class="fu">library</span>(rpart) <span class="co"># trees</span></span>
<span id="cb191-11"><a href="simulace3sigma.html#cb191-11" tabindex="-1"></a><span class="fu">library</span>(rattle) <span class="co"># graphics</span></span>
<span id="cb191-12"><a href="simulace3sigma.html#cb191-12" tabindex="-1"></a><span class="fu">library</span>(e1071)</span>
<span id="cb191-13"><a href="simulace3sigma.html#cb191-13" tabindex="-1"></a><span class="fu">library</span>(randomForest) <span class="co"># random forest</span></span></code></pre></div>
</details>
<p>To compare individual classifiers, we will divide the generated observations into two parts in a ratio of 70:30, specifically for training and testing (validation) purposes. The training part will be used in constructing the classifier, while the testing part will be used for calculating the classification error and potentially other characteristics of our model. The resulting classifiers can then be compared against each other based on their classification success according to these calculated characteristics.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb192"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb192-1"><a href="simulace3sigma.html#cb192-1" tabindex="-1"></a><span class="co"># division into testing and training parts</span></span>
<span id="cb192-2"><a href="simulace3sigma.html#cb192-2" tabindex="-1"></a>split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb192-3"><a href="simulace3sigma.html#cb192-3" tabindex="-1"></a></span>
<span id="cb192-4"><a href="simulace3sigma.html#cb192-4" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb192-5"><a href="simulace3sigma.html#cb192-5" tabindex="-1"></a></span>
<span id="cb192-6"><a href="simulace3sigma.html#cb192-6" tabindex="-1"></a>X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-7"><a href="simulace3sigma.html#cb192-7" tabindex="-1"></a>X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb192-8"><a href="simulace3sigma.html#cb192-8" tabindex="-1"></a></span>
<span id="cb192-9"><a href="simulace3sigma.html#cb192-9" tabindex="-1"></a>Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb192-10"><a href="simulace3sigma.html#cb192-10" tabindex="-1"></a>Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span></code></pre></div>
</details>
<p>Next, we will look at the representation of individual groups in the testing and training parts of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb193"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb193-1"><a href="simulace3sigma.html#cb193-1" tabindex="-1"></a><span class="co"># absolute representation</span></span>
<span id="cb193-2"><a href="simulace3sigma.html#cb193-2" tabindex="-1"></a><span class="fu">table</span>(Y.train)</span></code></pre></div>
</details>
<pre><code>## Y.train
##  0  1 
## 71 69</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb195"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb195-1"><a href="simulace3sigma.html#cb195-1" tabindex="-1"></a><span class="fu">table</span>(Y.test)</span></code></pre></div>
</details>
<pre><code>## Y.test
##  0  1 
## 29 31</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb197"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb197-1"><a href="simulace3sigma.html#cb197-1" tabindex="-1"></a><span class="co"># relative representation</span></span>
<span id="cb197-2"><a href="simulace3sigma.html#cb197-2" tabindex="-1"></a><span class="fu">table</span>(Y.train) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.train))</span></code></pre></div>
</details>
<pre><code>## Y.train
##         0         1 
## 0.5071429 0.4928571</code></pre>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb199"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb199-1"><a href="simulace3sigma.html#cb199-1" tabindex="-1"></a><span class="fu">table</span>(Y.test) <span class="sc">/</span> <span class="fu">sum</span>(<span class="fu">table</span>(Y.test))</span></code></pre></div>
</details>
<pre><code>## Y.test
##         0         1 
## 0.4833333 0.5166667</code></pre>
<div id="k-nearest-neighbors-1" class="section level3 hasAnchor" number="2.3.1">
<h3><span class="header-section-number">2.3.1</span> <span class="math inline">\(K\)</span> Nearest Neighbors<a href="simulace3sigma.html#k-nearest-neighbors-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s start with a non-parametric classification method, the <span class="math inline">\(K\)</span> nearest neighbors method. First, we will create the necessary objects so that we can further work with them using the <code>classif.knn()</code> function from the <code>fda.usc</code> library.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb201"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb201-1"><a href="simulace3sigma.html#cb201-1" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb201-2"><a href="simulace3sigma.html#cb201-2" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span></code></pre></div>
</details>
<p>Now we can define the model and look at its classification success. However, the last question remains how to choose the optimal number of neighbors <span class="math inline">\(K\)</span>. We could choose this number as such <span class="math inline">\(K\)</span> at which the minimum error occurs on the training data. However, this could lead to model overfitting, so we will use cross-validation. Given the computational intensity and the size of the dataset, we will choose <span class="math inline">\(k\)</span>-fold CV, for example, selecting the value <span class="math inline">\(k = 10\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb202"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb202-1"><a href="simulace3sigma.html#cb202-1" tabindex="-1"></a><span class="co"># model for all training data for K = 1, 2, ..., sqrt(n_train)</span></span>
<span id="cb202-2"><a href="simulace3sigma.html#cb202-2" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, </span>
<span id="cb202-3"><a href="simulace3sigma.html#cb202-3" tabindex="-1"></a>                            <span class="at">fdataobj =</span> x.train, </span>
<span id="cb202-4"><a href="simulace3sigma.html#cb202-4" tabindex="-1"></a>                            <span class="at">knn =</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">round</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) </span>
<span id="cb202-5"><a href="simulace3sigma.html#cb202-5" tabindex="-1"></a></span>
<span id="cb202-6"><a href="simulace3sigma.html#cb202-6" tabindex="-1"></a><span class="co"># summary(neighb.model) # model summary</span></span>
<span id="cb202-7"><a href="simulace3sigma.html#cb202-7" tabindex="-1"></a><span class="co"># plot(neighb.model$gcv, pch = 16) # plot of GCV dependence on the number of neighbors K</span></span>
<span id="cb202-8"><a href="simulace3sigma.html#cb202-8" tabindex="-1"></a><span class="co"># neighb.model$max.prob # maximum accuracy</span></span>
<span id="cb202-9"><a href="simulace3sigma.html#cb202-9" tabindex="-1"></a>(K.opt <span class="ot">&lt;-</span> neighb.model<span class="sc">$</span>h.opt) <span class="co"># optimal value of K</span></span></code></pre></div>
</details>
<pre><code>## [1] 5</code></pre>
<p>Let’s repeat the previous procedure for the training data, which we will divide into <span class="math inline">\(k\)</span> parts, thus repeating this part of the code <span class="math inline">\(k\)</span> times.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb204"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb204-1"><a href="simulace3sigma.html#cb204-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb204-2"><a href="simulace3sigma.html#cb204-2" tabindex="-1"></a>neighbours <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span>(<span class="dv">2</span> <span class="sc">*</span> <span class="fu">ceiling</span>(<span class="fu">sqrt</span>(<span class="fu">length</span>(y.train))))) <span class="co"># number of neighbors </span></span>
<span id="cb204-3"><a href="simulace3sigma.html#cb204-3" tabindex="-1"></a></span>
<span id="cb204-4"><a href="simulace3sigma.html#cb204-4" tabindex="-1"></a><span class="co"># divide training data into k parts</span></span>
<span id="cb204-5"><a href="simulace3sigma.html#cb204-5" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb204-6"><a href="simulace3sigma.html#cb204-6" tabindex="-1"></a></span>
<span id="cb204-7"><a href="simulace3sigma.html#cb204-7" tabindex="-1"></a><span class="co"># empty matrix where we will insert individual results</span></span>
<span id="cb204-8"><a href="simulace3sigma.html#cb204-8" tabindex="-1"></a><span class="co"># the columns will contain accuracy values for the given part of the training set</span></span>
<span id="cb204-9"><a href="simulace3sigma.html#cb204-9" tabindex="-1"></a><span class="co"># the rows will contain values for the given value of K</span></span>
<span id="cb204-10"><a href="simulace3sigma.html#cb204-10" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb204-11"><a href="simulace3sigma.html#cb204-11" tabindex="-1"></a></span>
<span id="cb204-12"><a href="simulace3sigma.html#cb204-12" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb204-13"><a href="simulace3sigma.html#cb204-13" tabindex="-1"></a>  <span class="co"># define the specific index set</span></span>
<span id="cb204-14"><a href="simulace3sigma.html#cb204-14" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb204-15"><a href="simulace3sigma.html#cb204-15" tabindex="-1"></a>    </span>
<span id="cb204-16"><a href="simulace3sigma.html#cb204-16" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb204-17"><a href="simulace3sigma.html#cb204-17" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb204-18"><a href="simulace3sigma.html#cb204-18" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb204-19"><a href="simulace3sigma.html#cb204-19" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb204-20"><a href="simulace3sigma.html#cb204-20" tabindex="-1"></a>  </span>
<span id="cb204-21"><a href="simulace3sigma.html#cb204-21" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb204-22"><a href="simulace3sigma.html#cb204-22" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb204-23"><a href="simulace3sigma.html#cb204-23" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb204-24"><a href="simulace3sigma.html#cb204-24" tabindex="-1"></a>    <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb204-25"><a href="simulace3sigma.html#cb204-25" tabindex="-1"></a>  </span>
<span id="cb204-26"><a href="simulace3sigma.html#cb204-26" tabindex="-1"></a>  <span class="co"># go through each part ... repeat k times</span></span>
<span id="cb204-27"><a href="simulace3sigma.html#cb204-27" tabindex="-1"></a>  <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb204-28"><a href="simulace3sigma.html#cb204-28" tabindex="-1"></a>    <span class="co"># model for specific choice of K</span></span>
<span id="cb204-29"><a href="simulace3sigma.html#cb204-29" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb204-30"><a href="simulace3sigma.html#cb204-30" tabindex="-1"></a>                              <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb204-31"><a href="simulace3sigma.html#cb204-31" tabindex="-1"></a>                              <span class="at">knn =</span> neighbour) </span>
<span id="cb204-32"><a href="simulace3sigma.html#cb204-32" tabindex="-1"></a>    <span class="co"># predictions on the validation part</span></span>
<span id="cb204-33"><a href="simulace3sigma.html#cb204-33" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb204-34"><a href="simulace3sigma.html#cb204-34" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb204-35"><a href="simulace3sigma.html#cb204-35" tabindex="-1"></a>    <span class="co"># accuracy on the validation part</span></span>
<span id="cb204-36"><a href="simulace3sigma.html#cb204-36" tabindex="-1"></a>    accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb204-37"><a href="simulace3sigma.html#cb204-37" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb204-38"><a href="simulace3sigma.html#cb204-38" tabindex="-1"></a>    </span>
<span id="cb204-39"><a href="simulace3sigma.html#cb204-39" tabindex="-1"></a>    <span class="co"># insert accuracy at the position for the given K and fold</span></span>
<span id="cb204-40"><a href="simulace3sigma.html#cb204-40" tabindex="-1"></a>    CV.results[neighbour, index] <span class="ot">&lt;-</span> accuracy</span>
<span id="cb204-41"><a href="simulace3sigma.html#cb204-41" tabindex="-1"></a>  }</span>
<span id="cb204-42"><a href="simulace3sigma.html#cb204-42" tabindex="-1"></a>}</span>
<span id="cb204-43"><a href="simulace3sigma.html#cb204-43" tabindex="-1"></a></span>
<span id="cb204-44"><a href="simulace3sigma.html#cb204-44" tabindex="-1"></a><span class="co"># calculate average accuracies for individual K across folds</span></span>
<span id="cb204-45"><a href="simulace3sigma.html#cb204-45" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb204-46"><a href="simulace3sigma.html#cb204-46" tabindex="-1"></a>K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb204-47"><a href="simulace3sigma.html#cb204-47" tabindex="-1"></a>accuracy.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb204-48"><a href="simulace3sigma.html#cb204-48" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>We can see that the best value of the parameter <span class="math inline">\(K\)</span> is 5 with an error calculated using 10-fold CV of 0.3429. For clarity, let’s also plot the validation error as a function of the number of neighbors <span class="math inline">\(K\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb205"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb205-1"><a href="simulace3sigma.html#cb205-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb205-2"><a href="simulace3sigma.html#cb205-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> K, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb205-3"><a href="simulace3sigma.html#cb205-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb205-4"><a href="simulace3sigma.html#cb205-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb205-5"><a href="simulace3sigma.html#cb205-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> K.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb205-6"><a href="simulace3sigma.html#cb205-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb205-7"><a href="simulace3sigma.html#cb205-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(K, <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb205-8"><a href="simulace3sigma.html#cb205-8" tabindex="-1"></a>                        K[optimal] <span class="sc">==</span> .(K.opt))),</span>
<span id="cb205-9"><a href="simulace3sigma.html#cb205-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb205-10"><a href="simulace3sigma.html#cb205-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> neighbours)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = K.opt, y = 1 - accuracy.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 24 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-24"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-24-1.png" alt="Dependence of validation error on the value of $K$, i.e., the number of neighbors." width="672" />
<p class="caption">
Figure 2.3: Dependence of validation error on the value of <span class="math inline">\(K\)</span>, i.e., the number of neighbors.
</p>
</div>
<p>Now that we know the optimal value of the parameter <span class="math inline">\(K\)</span>, we can assemble the final model.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb207"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb207-1"><a href="simulace3sigma.html#cb207-1" tabindex="-1"></a>neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb207-2"><a href="simulace3sigma.html#cb207-2" tabindex="-1"></a></span>
<span id="cb207-3"><a href="simulace3sigma.html#cb207-3" tabindex="-1"></a><span class="co"># predictions</span></span>
<span id="cb207-4"><a href="simulace3sigma.html#cb207-4" tabindex="-1"></a>model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb207-5"><a href="simulace3sigma.html#cb207-5" tabindex="-1"></a>                                <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb207-6"><a href="simulace3sigma.html#cb207-6" tabindex="-1"></a></span>
<span id="cb207-7"><a href="simulace3sigma.html#cb207-7" tabindex="-1"></a><span class="co"># summary(neighb.model)</span></span>
<span id="cb207-8"><a href="simulace3sigma.html#cb207-8" tabindex="-1"></a></span>
<span id="cb207-9"><a href="simulace3sigma.html#cb207-9" tabindex="-1"></a><span class="co"># accuracy on the test data</span></span>
<span id="cb207-10"><a href="simulace3sigma.html#cb207-10" tabindex="-1"></a>accuracy <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb207-11"><a href="simulace3sigma.html#cb207-11" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb207-12"><a href="simulace3sigma.html#cb207-12" tabindex="-1"></a>  <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb207-13"><a href="simulace3sigma.html#cb207-13" tabindex="-1"></a>  <span class="fu">sum</span>()</span>
<span id="cb207-14"><a href="simulace3sigma.html#cb207-14" tabindex="-1"></a><span class="co"># error rate</span></span>
<span id="cb207-15"><a href="simulace3sigma.html#cb207-15" tabindex="-1"></a><span class="co"># 1 - accuracy</span></span></code></pre></div>
</details>
<p>Thus, we can see that the error rate of the model constructed using the <span class="math inline">\(K\)</span> nearest neighbors method with the optimal choice of <span class="math inline">\(K_{optimal}\)</span> equal to 5, which we determined through cross-validation, is 0.3571 on the training data and 0.3833 on the test data.</p>
<p>To compare individual models, we can use both types of error rates; for clarity, we will store them in a table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb208"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb208-1"><a href="simulace3sigma.html#cb208-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb208-2"><a href="simulace3sigma.html#cb208-2" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb208-3"><a href="simulace3sigma.html#cb208-3" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy)</span></code></pre></div>
</details>
</div>
<div id="linear-discriminant-analysis-1" class="section level3 hasAnchor" number="2.3.2">
<h3><span class="header-section-number">2.3.2</span> Linear Discriminant Analysis<a href="simulace3sigma.html#linear-discriminant-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>As a second method for constructing a classifier, we will consider Linear Discriminant Analysis (LDA). Since this method cannot be applied to functional data, we must first discretize it, which we will do using Functional Principal Component Analysis. We will then perform the classification algorithm on the scores of the first <span class="math inline">\(p\)</span> principal components. We will choose the number of components <span class="math inline">\(p\)</span> such that the first <span class="math inline">\(p\)</span> principal components together explain at least 90% of the variability in the data.</p>
<p>So let’s first perform Functional Principal Component Analysis and determine the number <span class="math inline">\(p\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb209"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb209-1"><a href="simulace3sigma.html#cb209-1" tabindex="-1"></a><span class="co"># principal component analysis</span></span>
<span id="cb209-2"><a href="simulace3sigma.html#cb209-2" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximum number of principal components</span></span>
<span id="cb209-3"><a href="simulace3sigma.html#cb209-3" tabindex="-1"></a>nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># determine p</span></span>
<span id="cb209-4"><a href="simulace3sigma.html#cb209-4" tabindex="-1"></a><span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb209-5"><a href="simulace3sigma.html#cb209-5" tabindex="-1"></a></span>
<span id="cb209-6"><a href="simulace3sigma.html#cb209-6" tabindex="-1"></a>data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb209-7"><a href="simulace3sigma.html#cb209-7" tabindex="-1"></a>data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># scores of the first p principal components</span></span>
<span id="cb209-8"><a href="simulace3sigma.html#cb209-8" tabindex="-1"></a>data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># class membership</span></span></code></pre></div>
</details>
<p>In this particular case, we have taken the number of principal components to be $p = 2, which together explain 98.72% of the variability in the data. The first principal component explains 98.2% and the second 0.52% of the variability. We can graphically display the scores of the first two principal components, color-coded according to class membership.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb210"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb210-1"><a href="simulace3sigma.html#cb210-1" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb210-2"><a href="simulace3sigma.html#cb210-2" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb210-3"><a href="simulace3sigma.html#cb210-3" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb210-4"><a href="simulace3sigma.html#cb210-4" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb210-5"><a href="simulace3sigma.html#cb210-5" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb210-6"><a href="simulace3sigma.html#cb210-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb210-7"><a href="simulace3sigma.html#cb210-7" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb210-8"><a href="simulace3sigma.html#cb210-8" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb210-9"><a href="simulace3sigma.html#cb210-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>()</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-28"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-28-1.png" alt="Scores of the first two principal components for the training data. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 2.4: Scores of the first two principal components for the training data. Points are color-coded according to class membership.
</p>
</div>
<p>To determine the classification accuracy on the test data, we need to calculate the scores for the first 2 principal components for the test data. These scores can be determined using the formula:</p>
<p><span class="math display">\[
\xi_{i, j} = \int \left( X_i(t) - \mu(t)\right) \cdot \rho_j(t)\text{ dt},
\]</span></p>
<p>where <span class="math inline">\(\mu(t)\)</span> is the mean function and <span class="math inline">\(\rho_j(t)\)</span> is the eigenfunction (functional principal component).</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb211"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb211-1"><a href="simulace3sigma.html#cb211-1" tabindex="-1"></a><span class="co"># calculate scores for test functions</span></span>
<span id="cb211-2"><a href="simulace3sigma.html#cb211-2" tabindex="-1"></a>scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># empty matrix </span></span>
<span id="cb211-3"><a href="simulace3sigma.html#cb211-3" tabindex="-1"></a></span>
<span id="cb211-4"><a href="simulace3sigma.html#cb211-4" tabindex="-1"></a><span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb211-5"><a href="simulace3sigma.html#cb211-5" tabindex="-1"></a>  xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-th observation - mean function</span></span>
<span id="cb211-6"><a href="simulace3sigma.html#cb211-6" tabindex="-1"></a>  scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb211-7"><a href="simulace3sigma.html#cb211-7" tabindex="-1"></a>  <span class="co"># scalar product of the residual and the eigenfunctions rho (functional principal components)</span></span>
<span id="cb211-8"><a href="simulace3sigma.html#cb211-8" tabindex="-1"></a>}</span>
<span id="cb211-9"><a href="simulace3sigma.html#cb211-9" tabindex="-1"></a></span>
<span id="cb211-10"><a href="simulace3sigma.html#cb211-10" tabindex="-1"></a>data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb211-11"><a href="simulace3sigma.html#cb211-11" tabindex="-1"></a>data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb211-12"><a href="simulace3sigma.html#cb211-12" tabindex="-1"></a><span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span></code></pre></div>
</details>
<p>Now we can construct the classifier on the training part of the data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb212"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb212-1"><a href="simulace3sigma.html#cb212-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb212-2"><a href="simulace3sigma.html#cb212-2" tabindex="-1"></a>clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb212-3"><a href="simulace3sigma.html#cb212-3" tabindex="-1"></a></span>
<span id="cb212-4"><a href="simulace3sigma.html#cb212-4" tabindex="-1"></a><span class="co"># accuracy on the training data</span></span>
<span id="cb212-5"><a href="simulace3sigma.html#cb212-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb212-6"><a href="simulace3sigma.html#cb212-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb212-7"><a href="simulace3sigma.html#cb212-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb212-8"><a href="simulace3sigma.html#cb212-8" tabindex="-1"></a>  </span>
<span id="cb212-9"><a href="simulace3sigma.html#cb212-9" tabindex="-1"></a><span class="co"># accuracy on the test data</span></span>
<span id="cb212-10"><a href="simulace3sigma.html#cb212-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb212-11"><a href="simulace3sigma.html#cb212-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb212-12"><a href="simulace3sigma.html#cb212-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We have calculated the error rate of the classifier on the training (41.43%) and test data (40%).</p>
<p>To graphically illustrate the method, we can mark the decision boundary in the score plot of the first two principal components. This boundary will be calculated on a dense grid of points and displayed using the <code>geom_contour()</code> function.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb213"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb213-1"><a href="simulace3sigma.html#cb213-1" tabindex="-1"></a><span class="co"># add decision boundary</span></span>
<span id="cb213-2"><a href="simulace3sigma.html#cb213-2" tabindex="-1"></a>np <span class="ot">&lt;-</span> <span class="dv">1001</span> <span class="co"># number of grid points</span></span>
<span id="cb213-3"><a href="simulace3sigma.html#cb213-3" tabindex="-1"></a><span class="co"># x-axis ... 1st PC</span></span>
<span id="cb213-4"><a href="simulace3sigma.html#cb213-4" tabindex="-1"></a>nd.x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V1), </span>
<span id="cb213-5"><a href="simulace3sigma.html#cb213-5" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V1), <span class="at">length.out =</span> np)</span>
<span id="cb213-6"><a href="simulace3sigma.html#cb213-6" tabindex="-1"></a><span class="co"># y-axis ... 2nd PC</span></span>
<span id="cb213-7"><a href="simulace3sigma.html#cb213-7" tabindex="-1"></a>nd.y <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="fu">min</span>(data.PCA.train<span class="sc">$</span>V2), </span>
<span id="cb213-8"><a href="simulace3sigma.html#cb213-8" tabindex="-1"></a>            <span class="at">to =</span> <span class="fu">max</span>(data.PCA.train<span class="sc">$</span>V2), <span class="at">length.out =</span> np)</span>
<span id="cb213-9"><a href="simulace3sigma.html#cb213-9" tabindex="-1"></a><span class="co"># case for 2 PCs ... p = 2</span></span>
<span id="cb213-10"><a href="simulace3sigma.html#cb213-10" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y)</span>
<span id="cb213-11"><a href="simulace3sigma.html#cb213-11" tabindex="-1"></a><span class="co"># case for p = 3</span></span>
<span id="cb213-12"><a href="simulace3sigma.html#cb213-12" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">4</span>) {</span>
<span id="cb213-13"><a href="simulace3sigma.html#cb213-13" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>])}</span>
<span id="cb213-14"><a href="simulace3sigma.html#cb213-14" tabindex="-1"></a><span class="co"># case for p = 4</span></span>
<span id="cb213-15"><a href="simulace3sigma.html#cb213-15" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb213-16"><a href="simulace3sigma.html#cb213-16" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb213-17"><a href="simulace3sigma.html#cb213-17" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>])}</span>
<span id="cb213-18"><a href="simulace3sigma.html#cb213-18" tabindex="-1"></a><span class="co"># case for p = 5</span></span>
<span id="cb213-19"><a href="simulace3sigma.html#cb213-19" tabindex="-1"></a><span class="cf">if</span>(<span class="fu">dim</span>(data.PCA.train)[<span class="dv">2</span>] <span class="sc">==</span> <span class="dv">6</span>) {</span>
<span id="cb213-20"><a href="simulace3sigma.html#cb213-20" tabindex="-1"></a>  nd <span class="ot">&lt;-</span> <span class="fu">expand.grid</span>(<span class="at">V1 =</span> nd.x, <span class="at">V2 =</span> nd.y, <span class="at">V3 =</span> data.PCA.train<span class="sc">$</span>V3[<span class="dv">1</span>],</span>
<span id="cb213-21"><a href="simulace3sigma.html#cb213-21" tabindex="-1"></a>                    <span class="at">V4 =</span> data.PCA.train<span class="sc">$</span>V4[<span class="dv">1</span>], <span class="at">V5 =</span> data.PCA.train<span class="sc">$</span>V5[<span class="dv">1</span>])}</span>
<span id="cb213-22"><a href="simulace3sigma.html#cb213-22" tabindex="-1"></a></span>
<span id="cb213-23"><a href="simulace3sigma.html#cb213-23" tabindex="-1"></a><span class="co"># add Y = 0, 1</span></span>
<span id="cb213-24"><a href="simulace3sigma.html#cb213-24" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb213-25"><a href="simulace3sigma.html#cb213-25" tabindex="-1"></a></span>
<span id="cb213-26"><a href="simulace3sigma.html#cb213-26" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb213-27"><a href="simulace3sigma.html#cb213-27" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb213-28"><a href="simulace3sigma.html#cb213-28" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb213-29"><a href="simulace3sigma.html#cb213-29" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb213-30"><a href="simulace3sigma.html#cb213-30" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb213-31"><a href="simulace3sigma.html#cb213-31" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb213-32"><a href="simulace3sigma.html#cb213-32" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb213-33"><a href="simulace3sigma.html#cb213-33" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb213-34"><a href="simulace3sigma.html#cb213-34" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb213-35"><a href="simulace3sigma.html#cb213-35" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-31"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-31-1.png" alt="Scores of the first two principal components, color-coded by class membership. The decision boundary (line in the plane of the first two principal components) between classes constructed using LDA is indicated in black." width="672" />
<p class="caption">
Figure 2.5: Scores of the first two principal components, color-coded by class membership. The decision boundary (line in the plane of the first two principal components) between classes constructed using LDA is indicated in black.
</p>
</div>
<p>We can see that the decision boundary is a line, a linear function in the 2D space, which we expected from LDA. Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb214"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb214-1"><a href="simulace3sigma.html#cb214-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb214-2"><a href="simulace3sigma.html#cb214-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb214-3"><a href="simulace3sigma.html#cb214-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb214-4"><a href="simulace3sigma.html#cb214-4" tabindex="-1"></a></span>
<span id="cb214-5"><a href="simulace3sigma.html#cb214-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="quadratic-discriminant-analysis-1" class="section level3 hasAnchor" number="2.3.3">
<h3><span class="header-section-number">2.3.3</span> Quadratic Discriminant Analysis<a href="simulace3sigma.html#quadratic-discriminant-analysis-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Next, we will construct a classifier using Quadratic Discriminant Analysis (QDA). This is an analogous case to LDA, with the difference that we now allow for different covariance matrices for each class of the normal distribution from which the corresponding scores are derived. This relaxed assumption of equal covariance matrices leads to a quadratic boundary between classes.</p>
<p>In <code>R</code>, QDA can be performed similarly to LDA in the previous section. Therefore, we will calculate the scores for both training and test functions using Functional Principal Component Analysis, construct the classifier on the scores of the first <span class="math inline">\(p\)</span> principal components, and use it to predict the class membership of the test curves to class <span class="math inline">\(Y^* \in \{0, 1\}\)</span>.</p>
<p>We do not need to perform functional PCA again, as we will utilize the results from the LDA section.</p>
<p>We can proceed directly to constructing the classifier using the <code>qda()</code> function. Next, we will calculate the accuracy of the classifier on the test and training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb215"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb215-1"><a href="simulace3sigma.html#cb215-1" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb215-2"><a href="simulace3sigma.html#cb215-2" tabindex="-1"></a>clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb215-3"><a href="simulace3sigma.html#cb215-3" tabindex="-1"></a></span>
<span id="cb215-4"><a href="simulace3sigma.html#cb215-4" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb215-5"><a href="simulace3sigma.html#cb215-5" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb215-6"><a href="simulace3sigma.html#cb215-6" tabindex="-1"></a>accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb215-7"><a href="simulace3sigma.html#cb215-7" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb215-8"><a href="simulace3sigma.html#cb215-8" tabindex="-1"></a>  </span>
<span id="cb215-9"><a href="simulace3sigma.html#cb215-9" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb215-10"><a href="simulace3sigma.html#cb215-10" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb215-11"><a href="simulace3sigma.html#cb215-11" tabindex="-1"></a>accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb215-12"><a href="simulace3sigma.html#cb215-12" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>Thus, we have calculated the error rate of the classifier on the training (35.71 %) and the test data (40 %).</p>
<p>For a graphical representation of the method, we can mark the decision boundary in the score plot of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, just as in the case of LDA.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb216"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb216-1"><a href="simulace3sigma.html#cb216-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> nd <span class="sc">|&gt;</span> <span class="fu">mutate</span>(<span class="at">prd =</span> <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> nd)<span class="sc">$</span>class))</span>
<span id="cb216-2"><a href="simulace3sigma.html#cb216-2" tabindex="-1"></a></span>
<span id="cb216-3"><a href="simulace3sigma.html#cb216-3" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb216-4"><a href="simulace3sigma.html#cb216-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb216-5"><a href="simulace3sigma.html#cb216-5" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st principal component (explained variance&#39;</span>, </span>
<span id="cb216-6"><a href="simulace3sigma.html#cb216-6" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb216-7"><a href="simulace3sigma.html#cb216-7" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd principal component (&#39;</span>, </span>
<span id="cb216-8"><a href="simulace3sigma.html#cb216-8" tabindex="-1"></a>                 <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb216-9"><a href="simulace3sigma.html#cb216-9" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>) <span class="sc">+</span></span>
<span id="cb216-10"><a href="simulace3sigma.html#cb216-10" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb216-11"><a href="simulace3sigma.html#cb216-11" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb216-12"><a href="simulace3sigma.html#cb216-12" tabindex="-1"></a>  <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-37"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-37-1.png" alt="Scores of the first two principal components, color-coded by classification group. The decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA is marked in black." width="672" />
<p class="caption">
Figure 2.6: Scores of the first two principal components, color-coded by classification group. The decision boundary (a parabola in the plane of the first two principal components) between classes constructed using QDA is marked in black.
</p>
</div>
<p>Note that the decision boundary between the classification classes is now a parabola.</p>
<p>Finally, we will add the error rates to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb217"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb217-1"><a href="simulace3sigma.html#cb217-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb217-2"><a href="simulace3sigma.html#cb217-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.train,</span>
<span id="cb217-3"><a href="simulace3sigma.html#cb217-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test)</span>
<span id="cb217-4"><a href="simulace3sigma.html#cb217-4" tabindex="-1"></a></span>
<span id="cb217-5"><a href="simulace3sigma.html#cb217-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="logistic-regression-1" class="section level3 hasAnchor" number="2.3.4">
<h3><span class="header-section-number">2.3.4</span> Logistic Regression<a href="simulace3sigma.html#logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Logistic regression can be performed in two ways. One can either use the functional analogue of classic logistic regression or the classic multivariate logistic regression, which we will perform on the scores of the first <span class="math inline">\(p\)</span> principal components.</p>
<div id="functional-logistic-regression-1" class="section level4 hasAnchor" number="2.3.4.1">
<h4><span class="header-section-number">2.3.4.1</span> Functional Logistic Regression<a href="simulace3sigma.html#functional-logistic-regression-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Analogous to the case of finite dimension input data, we consider the logistic model in the form:</p>
<p><span class="math display">\[
g\left(\mathbb E [Y|X = x]\right) = \eta (x) = g(\pi(x)) = \alpha + \int \beta(t)\cdot x(t) \text d t,
\]</span> where <span class="math inline">\(\eta(x)\)</span> is the linear predictor taking values from the interval <span class="math inline">\((-\infty, \infty)\)</span>, <span class="math inline">\(g(\cdot)\)</span> is the <em>link function</em>, and in the case of logistic regression, it is the logit function <span class="math inline">\(g: (0,1) \rightarrow \mathbb R,\ g(p) = \ln\frac{p}{1-p}\)</span>, and <span class="math inline">\(\pi(x)\)</span> is the conditional probability</p>
<p><span class="math display">\[
\pi(x) = \text{Pr}(Y = 1 | X = x) = g^{-1}(\eta(x)) = \frac{\text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}}{1 + \text e^{\alpha + \int \beta(t)\cdot x(t) \text d t}},
\]</span></p>
<p>where <span class="math inline">\(\alpha\)</span> is a constant and <span class="math inline">\(\beta(t) \in L^2[a, b]\)</span> is a parametric function. Our goal is to estimate this parametric function.</p>
<p>For functional logistic regression, we will use the <code>fregre.glm()</code> function from the <code>fda.usc</code> package. First, we will create suitable objects for constructing the classifier.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb218"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb218-1"><a href="simulace3sigma.html#cb218-1" tabindex="-1"></a><span class="co"># create suitable objects</span></span>
<span id="cb218-2"><a href="simulace3sigma.html#cb218-2" tabindex="-1"></a>x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb218-3"><a href="simulace3sigma.html#cb218-3" tabindex="-1"></a>y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb218-4"><a href="simulace3sigma.html#cb218-4" tabindex="-1"></a></span>
<span id="cb218-5"><a href="simulace3sigma.html#cb218-5" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb218-6"><a href="simulace3sigma.html#cb218-6" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb218-7"><a href="simulace3sigma.html#cb218-7" tabindex="-1"></a></span>
<span id="cb218-8"><a href="simulace3sigma.html#cb218-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb218-9"><a href="simulace3sigma.html#cb218-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb218-10"><a href="simulace3sigma.html#cb218-10" tabindex="-1"></a><span class="co"># B-spline basis </span></span>
<span id="cb218-11"><a href="simulace3sigma.html#cb218-11" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span></code></pre></div>
</details>
<p>To estimate the parametric function <span class="math inline">\(\beta(t)\)</span>, we need to express it in some basis representation, in our case, B-spline basis. However, we need to find a suitable number of basis functions. We could determine this based on the error rate on the training data; however, this data will favor selecting a large number of bases, leading to model overfitting.</p>
<p>Let’s illustrate this with the following case. For each number of bases <span class="math inline">\(n_{basis} \in \{4, 5, \dots, 50\}\)</span>, we will train a model on the training data, determine the error rate on this data, and also calculate the error rate on the test data. Remember that we cannot use the same data for estimating the test error rate, as it would underestimate this error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb219"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb219-1"><a href="simulace3sigma.html#cb219-1" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">50</span></span>
<span id="cb219-2"><a href="simulace3sigma.html#cb219-2" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb219-3"><a href="simulace3sigma.html#cb219-3" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> <span class="dv">2</span>, </span>
<span id="cb219-4"><a href="simulace3sigma.html#cb219-4" tabindex="-1"></a>                   <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="fu">c</span>(<span class="st">&#39;Err.train&#39;</span>, <span class="st">&#39;Err.test&#39;</span>)))</span>
<span id="cb219-5"><a href="simulace3sigma.html#cb219-5" tabindex="-1"></a></span>
<span id="cb219-6"><a href="simulace3sigma.html#cb219-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb219-7"><a href="simulace3sigma.html#cb219-7" tabindex="-1"></a>  <span class="co"># bases for betas</span></span>
<span id="cb219-8"><a href="simulace3sigma.html#cb219-8" tabindex="-1"></a>  basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> i)</span>
<span id="cb219-9"><a href="simulace3sigma.html#cb219-9" tabindex="-1"></a>  <span class="co"># relationship</span></span>
<span id="cb219-10"><a href="simulace3sigma.html#cb219-10" tabindex="-1"></a>  f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb219-11"><a href="simulace3sigma.html#cb219-11" tabindex="-1"></a>  <span class="co"># bases for x and betas</span></span>
<span id="cb219-12"><a href="simulace3sigma.html#cb219-12" tabindex="-1"></a>  basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) <span class="co"># smoothed data</span></span>
<span id="cb219-13"><a href="simulace3sigma.html#cb219-13" tabindex="-1"></a>  basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb219-14"><a href="simulace3sigma.html#cb219-14" tabindex="-1"></a>  <span class="co"># input data for the model</span></span>
<span id="cb219-15"><a href="simulace3sigma.html#cb219-15" tabindex="-1"></a>  ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb219-16"><a href="simulace3sigma.html#cb219-16" tabindex="-1"></a>  <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb219-17"><a href="simulace3sigma.html#cb219-17" tabindex="-1"></a>  model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb219-18"><a href="simulace3sigma.html#cb219-18" tabindex="-1"></a>                          <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb219-19"><a href="simulace3sigma.html#cb219-19" tabindex="-1"></a>  </span>
<span id="cb219-20"><a href="simulace3sigma.html#cb219-20" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb219-21"><a href="simulace3sigma.html#cb219-21" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb219-22"><a href="simulace3sigma.html#cb219-22" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb219-23"><a href="simulace3sigma.html#cb219-23" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb219-24"><a href="simulace3sigma.html#cb219-24" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb219-25"><a href="simulace3sigma.html#cb219-25" tabindex="-1"></a>    </span>
<span id="cb219-26"><a href="simulace3sigma.html#cb219-26" tabindex="-1"></a>  <span class="co"># accuracy on test data</span></span>
<span id="cb219-27"><a href="simulace3sigma.html#cb219-27" tabindex="-1"></a>  newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb219-28"><a href="simulace3sigma.html#cb219-28" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb219-29"><a href="simulace3sigma.html#cb219-29" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb219-30"><a href="simulace3sigma.html#cb219-30" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb219-31"><a href="simulace3sigma.html#cb219-31" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb219-32"><a href="simulace3sigma.html#cb219-32" tabindex="-1"></a>  </span>
<span id="cb219-33"><a href="simulace3sigma.html#cb219-33" tabindex="-1"></a>  <span class="co"># insert into matrix</span></span>
<span id="cb219-34"><a href="simulace3sigma.html#cb219-34" tabindex="-1"></a>  pred.baz[<span class="fu">as.character</span>(i), ] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb219-35"><a href="simulace3sigma.html#cb219-35" tabindex="-1"></a>} </span>
<span id="cb219-36"><a href="simulace3sigma.html#cb219-36" tabindex="-1"></a></span>
<span id="cb219-37"><a href="simulace3sigma.html#cb219-37" tabindex="-1"></a>pred.baz <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(pred.baz)</span>
<span id="cb219-38"><a href="simulace3sigma.html#cb219-38" tabindex="-1"></a>pred.baz<span class="sc">$</span>n.basis <span class="ot">&lt;-</span> n.basis</span></code></pre></div>
</details>
<p>Let’s visualize the progression of both types of error in a graph depending on the number of basis functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb220"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb220-1"><a href="simulace3sigma.html#cb220-1" tabindex="-1"></a>n.basis.beta.opt <span class="ot">&lt;-</span> pred.baz<span class="sc">$</span>n.basis[<span class="fu">which.min</span>(pred.baz<span class="sc">$</span>Err.test)]</span>
<span id="cb220-2"><a href="simulace3sigma.html#cb220-2" tabindex="-1"></a></span>
<span id="cb220-3"><a href="simulace3sigma.html#cb220-3" tabindex="-1"></a>pred.baz <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.test)) <span class="sc">+</span> </span>
<span id="cb220-4"><a href="simulace3sigma.html#cb220-4" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb220-5"><a href="simulace3sigma.html#cb220-5" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb220-6"><a href="simulace3sigma.html#cb220-6" tabindex="-1"></a>            <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">linewidth =</span> <span class="fl">0.5</span>) <span class="sc">+</span> </span>
<span id="cb220-7"><a href="simulace3sigma.html#cb220-7" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb220-8"><a href="simulace3sigma.html#cb220-8" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> Err.train), <span class="at">colour =</span> <span class="st">&#39;deepskyblue3&#39;</span>, </span>
<span id="cb220-9"><a href="simulace3sigma.html#cb220-9" tabindex="-1"></a>             <span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb220-10"><a href="simulace3sigma.html#cb220-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.beta.opt, <span class="at">y =</span> <span class="fu">min</span>(pred.baz<span class="sc">$</span>Err.test)),</span>
<span id="cb220-11"><a href="simulace3sigma.html#cb220-11" tabindex="-1"></a>             <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb220-12"><a href="simulace3sigma.html#cb220-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb220-13"><a href="simulace3sigma.html#cb220-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb220-14"><a href="simulace3sigma.html#cb220-14" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.beta.opt))),</span>
<span id="cb220-15"><a href="simulace3sigma.html#cb220-15" tabindex="-1"></a>        <span class="at">y =</span> <span class="st">&#39;Error Rate&#39;</span>)</span></code></pre></div>
</details>
<pre><code>## Warning: Use of `pred.baz$Err.test` is discouraged.
## ℹ Use `Err.test` instead.</code></pre>
<pre><code>## Warning in geom_point(aes(x = n.basis.beta.opt, y = min(pred.baz$Err.test)), : All aesthetics have length 1, but the data has 47 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-41"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-41-1.png" alt="Dependence of test and training error rates on the number of basis functions for $\beta$. The red point indicates the optimal number $n_{optimal}$ chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line shows the progression of training error rate." width="672" />
<p class="caption">
Figure 2.7: Dependence of test and training error rates on the number of basis functions for <span class="math inline">\(\beta\)</span>. The red point indicates the optimal number <span class="math inline">\(n_{optimal}\)</span> chosen as the minimum test error rate, the black line depicts the test error, and the blue dashed line shows the progression of training error rate.
</p>
</div>
<p>We see that as the number of bases for <span class="math inline">\(\beta(t)\)</span> increases, the training error rate (blue line) tends to decrease, leading us to select large values of <span class="math inline">\(n_{basis}\)</span> based on it. Conversely, the optimal choice based on the test error rate is <span class="math inline">\(n\)</span> equal to 29, which is significantly smaller than 50. Meanwhile, as <span class="math inline">\(n\)</span> increases, the test error increases, indicating model overfitting.</p>
<p>For the above reasons, to determine the optimal number of basis functions for <span class="math inline">\(\beta(t)\)</span>, we will utilize 10-fold cross-validation. We will consider a maximum number of basis functions of 25, as we observed that above this value, overfitting occurs.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb223"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb223-1"><a href="simulace3sigma.html#cb223-1" tabindex="-1"></a><span class="do">### 10-fold cross-validation</span></span>
<span id="cb223-2"><a href="simulace3sigma.html#cb223-2" tabindex="-1"></a>n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb223-3"><a href="simulace3sigma.html#cb223-3" tabindex="-1"></a>n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb223-4"><a href="simulace3sigma.html#cb223-4" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb223-5"><a href="simulace3sigma.html#cb223-5" tabindex="-1"></a><span class="co"># split the training data into k parts</span></span>
<span id="cb223-6"><a href="simulace3sigma.html#cb223-6" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb223-7"><a href="simulace3sigma.html#cb223-7" tabindex="-1"></a><span class="do">## elements that do not change during the loop</span></span>
<span id="cb223-8"><a href="simulace3sigma.html#cb223-8" tabindex="-1"></a><span class="co"># points at which the functions are evaluated</span></span>
<span id="cb223-9"><a href="simulace3sigma.html#cb223-9" tabindex="-1"></a>tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb223-10"><a href="simulace3sigma.html#cb223-10" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb223-11"><a href="simulace3sigma.html#cb223-11" tabindex="-1"></a><span class="co"># B-spline bases </span></span>
<span id="cb223-12"><a href="simulace3sigma.html#cb223-12" tabindex="-1"></a>basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb223-13"><a href="simulace3sigma.html#cb223-13" tabindex="-1"></a><span class="co"># relationship</span></span>
<span id="cb223-14"><a href="simulace3sigma.html#cb223-14" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb223-15"><a href="simulace3sigma.html#cb223-15" tabindex="-1"></a><span class="co"># bases for x</span></span>
<span id="cb223-16"><a href="simulace3sigma.html#cb223-16" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb223-17"><a href="simulace3sigma.html#cb223-17" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb223-18"><a href="simulace3sigma.html#cb223-18" tabindex="-1"></a><span class="co"># in columns, there will be accuracy values for each part of the training set</span></span>
<span id="cb223-19"><a href="simulace3sigma.html#cb223-19" tabindex="-1"></a><span class="co"># in rows, there will be values for the given number of bases</span></span>
<span id="cb223-20"><a href="simulace3sigma.html#cb223-20" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb223-21"><a href="simulace3sigma.html#cb223-21" tabindex="-1"></a>                     <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span></code></pre></div>
</details>
<p>Now we have everything prepared to calculate the error on each of the ten subsets of the training set.<br />
Next, we will determine the average and take the argument of the minimum validation error as the optimal <span class="math inline">\(n\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb224"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb224-1"><a href="simulace3sigma.html#cb224-1" tabindex="-1"></a><span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb224-2"><a href="simulace3sigma.html#cb224-2" tabindex="-1"></a>  <span class="co"># define the specific index set</span></span>
<span id="cb224-3"><a href="simulace3sigma.html#cb224-3" tabindex="-1"></a>  fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb224-4"><a href="simulace3sigma.html#cb224-4" tabindex="-1"></a>    </span>
<span id="cb224-5"><a href="simulace3sigma.html#cb224-5" tabindex="-1"></a>  x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb224-6"><a href="simulace3sigma.html#cb224-6" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb224-7"><a href="simulace3sigma.html#cb224-7" tabindex="-1"></a>  y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb224-8"><a href="simulace3sigma.html#cb224-8" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb224-9"><a href="simulace3sigma.html#cb224-9" tabindex="-1"></a>  </span>
<span id="cb224-10"><a href="simulace3sigma.html#cb224-10" tabindex="-1"></a>  x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb224-11"><a href="simulace3sigma.html#cb224-11" tabindex="-1"></a>    <span class="fu">fdata</span>()</span>
<span id="cb224-12"><a href="simulace3sigma.html#cb224-12" tabindex="-1"></a>  y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb224-13"><a href="simulace3sigma.html#cb224-13" tabindex="-1"></a>    <span class="fu">as.numeric</span>()</span>
<span id="cb224-14"><a href="simulace3sigma.html#cb224-14" tabindex="-1"></a>  </span>
<span id="cb224-15"><a href="simulace3sigma.html#cb224-15" tabindex="-1"></a>  dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb224-16"><a href="simulace3sigma.html#cb224-16" tabindex="-1"></a>  <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb224-17"><a href="simulace3sigma.html#cb224-17" tabindex="-1"></a>  </span>
<span id="cb224-18"><a href="simulace3sigma.html#cb224-18" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb224-19"><a href="simulace3sigma.html#cb224-19" tabindex="-1"></a>    <span class="co"># bases for betas</span></span>
<span id="cb224-20"><a href="simulace3sigma.html#cb224-20" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb224-21"><a href="simulace3sigma.html#cb224-21" tabindex="-1"></a>    </span>
<span id="cb224-22"><a href="simulace3sigma.html#cb224-22" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb224-23"><a href="simulace3sigma.html#cb224-23" tabindex="-1"></a>    <span class="co"># input data for the model</span></span>
<span id="cb224-24"><a href="simulace3sigma.html#cb224-24" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb224-25"><a href="simulace3sigma.html#cb224-25" tabindex="-1"></a>    <span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb224-26"><a href="simulace3sigma.html#cb224-26" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb224-27"><a href="simulace3sigma.html#cb224-27" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb224-28"><a href="simulace3sigma.html#cb224-28" tabindex="-1"></a>    </span>
<span id="cb224-29"><a href="simulace3sigma.html#cb224-29" tabindex="-1"></a>    <span class="co"># accuracy on validation part </span></span>
<span id="cb224-30"><a href="simulace3sigma.html#cb224-30" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb224-31"><a href="simulace3sigma.html#cb224-31" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb224-32"><a href="simulace3sigma.html#cb224-32" tabindex="-1"></a>    predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb224-33"><a href="simulace3sigma.html#cb224-33" tabindex="-1"></a>    presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb224-34"><a href="simulace3sigma.html#cb224-34" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb224-35"><a href="simulace3sigma.html#cb224-35" tabindex="-1"></a>    </span>
<span id="cb224-36"><a href="simulace3sigma.html#cb224-36" tabindex="-1"></a>    <span class="co"># insert into the matrix</span></span>
<span id="cb224-37"><a href="simulace3sigma.html#cb224-37" tabindex="-1"></a>    CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb224-38"><a href="simulace3sigma.html#cb224-38" tabindex="-1"></a>  } </span>
<span id="cb224-39"><a href="simulace3sigma.html#cb224-39" tabindex="-1"></a>}</span>
<span id="cb224-40"><a href="simulace3sigma.html#cb224-40" tabindex="-1"></a></span>
<span id="cb224-41"><a href="simulace3sigma.html#cb224-41" tabindex="-1"></a><span class="co"># calculate average accuracy for each n over folds</span></span>
<span id="cb224-42"><a href="simulace3sigma.html#cb224-42" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb224-43"><a href="simulace3sigma.html#cb224-43" tabindex="-1"></a>n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb224-44"><a href="simulace3sigma.html#cb224-44" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb224-45"><a href="simulace3sigma.html#cb224-45" tabindex="-1"></a><span class="co"># CV.results</span></span></code></pre></div>
</details>
<p>Let’s also plot the validation error course with the optimal value of <span class="math inline">\(n_{optimal}\)</span> equal to 11 and validation error 0.072 highlighted.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb225"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb225-1"><a href="simulace3sigma.html#cb225-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">n.basis =</span> n.basis, <span class="at">CV =</span> CV.results)</span>
<span id="cb225-2"><a href="simulace3sigma.html#cb225-2" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV)) <span class="sc">+</span> </span>
<span id="cb225-3"><a href="simulace3sigma.html#cb225-3" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>) <span class="sc">+</span> </span>
<span id="cb225-4"><a href="simulace3sigma.html#cb225-4" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb225-5"><a href="simulace3sigma.html#cb225-5" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="fu">aes</span>(<span class="at">x =</span> n.basis.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;red&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb225-6"><a href="simulace3sigma.html#cb225-6" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb225-7"><a href="simulace3sigma.html#cb225-7" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(n[basis], <span class="st">&#39; ;   &#39;</span>, </span>
<span id="cb225-8"><a href="simulace3sigma.html#cb225-8" tabindex="-1"></a>                        n[optimal] <span class="sc">==</span> .(n.basis.opt))),</span>
<span id="cb225-9"><a href="simulace3sigma.html#cb225-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb225-10"><a href="simulace3sigma.html#cb225-10" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> n.basis)</span></code></pre></div>
</details>
<pre><code>## Warning in geom_point(aes(x = n.basis.opt, y = 1 - presnost.opt.cv), colour = &quot;red&quot;, : All aesthetics have length 1, but the data has 22 rows.
## ℹ Please consider using `annotate()` or provide this layer with data containing
##   a single row.</code></pre>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-44"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-44-1.png" alt="Dependency of validation error on the value of $n_{basis}$, i.e., on the number of bases." width="672" />
<p class="caption">
Figure 2.8: Dependency of validation error on the value of <span class="math inline">\(n_{basis}\)</span>, i.e., on the number of bases.
</p>
</div>
<p>We can now define the final model using functional logistic regression, choosing the B-spline basis for <span class="math inline">\(\beta(t)\)</span> with 11 bases.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb227"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb227-1"><a href="simulace3sigma.html#cb227-1" tabindex="-1"></a><span class="co"># optimal model</span></span>
<span id="cb227-2"><a href="simulace3sigma.html#cb227-2" tabindex="-1"></a>basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb227-3"><a href="simulace3sigma.html#cb227-3" tabindex="-1"></a>f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb227-4"><a href="simulace3sigma.html#cb227-4" tabindex="-1"></a><span class="co"># bases for x and betas</span></span>
<span id="cb227-5"><a href="simulace3sigma.html#cb227-5" tabindex="-1"></a>basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb227-6"><a href="simulace3sigma.html#cb227-6" tabindex="-1"></a>basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb227-7"><a href="simulace3sigma.html#cb227-7" tabindex="-1"></a><span class="co"># input data for the model</span></span>
<span id="cb227-8"><a href="simulace3sigma.html#cb227-8" tabindex="-1"></a>dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb227-9"><a href="simulace3sigma.html#cb227-9" tabindex="-1"></a><span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb227-10"><a href="simulace3sigma.html#cb227-10" tabindex="-1"></a>ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb227-11"><a href="simulace3sigma.html#cb227-11" tabindex="-1"></a><span class="co"># binomial model ... logistic regression model</span></span>
<span id="cb227-12"><a href="simulace3sigma.html#cb227-12" tabindex="-1"></a>model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb227-13"><a href="simulace3sigma.html#cb227-13" tabindex="-1"></a>                        <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb227-14"><a href="simulace3sigma.html#cb227-14" tabindex="-1"></a></span>
<span id="cb227-15"><a href="simulace3sigma.html#cb227-15" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb227-16"><a href="simulace3sigma.html#cb227-16" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb227-17"><a href="simulace3sigma.html#cb227-17" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb227-18"><a href="simulace3sigma.html#cb227-18" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb227-19"><a href="simulace3sigma.html#cb227-19" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb227-20"><a href="simulace3sigma.html#cb227-20" tabindex="-1"></a>  </span>
<span id="cb227-21"><a href="simulace3sigma.html#cb227-21" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb227-22"><a href="simulace3sigma.html#cb227-22" tabindex="-1"></a>newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb227-23"><a href="simulace3sigma.html#cb227-23" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb227-24"><a href="simulace3sigma.html#cb227-24" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb227-25"><a href="simulace3sigma.html#cb227-25" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb227-26"><a href="simulace3sigma.html#cb227-26" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>We calculated the training error rate (which is 3.57 %) and the test error rate (which is 8.33 %). To get a better understanding, we can also plot the estimated probabilities of belonging to the classification class <span class="math inline">\(Y = 1\)</span> based on the values of the linear predictor in the training data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb228"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb228-1"><a href="simulace3sigma.html#cb228-1" tabindex="-1"></a><span class="fu">data.frame</span>(</span>
<span id="cb228-2"><a href="simulace3sigma.html#cb228-2" tabindex="-1"></a>  <span class="at">linear.predictor =</span> model.glm<span class="sc">$</span>linear.predictors,</span>
<span id="cb228-3"><a href="simulace3sigma.html#cb228-3" tabindex="-1"></a>  <span class="at">response =</span> model.glm<span class="sc">$</span>fitted.values,</span>
<span id="cb228-4"><a href="simulace3sigma.html#cb228-4" tabindex="-1"></a>  <span class="at">Y =</span> <span class="fu">factor</span>(y.train)</span>
<span id="cb228-5"><a href="simulace3sigma.html#cb228-5" tabindex="-1"></a>) <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> linear.predictor, <span class="at">y =</span> response, <span class="at">colour =</span> Y)) <span class="sc">+</span> </span>
<span id="cb228-6"><a href="simulace3sigma.html#cb228-6" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb228-7"><a href="simulace3sigma.html#cb228-7" tabindex="-1"></a>  <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb228-8"><a href="simulace3sigma.html#cb228-8" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="fl">0.5</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb228-9"><a href="simulace3sigma.html#cb228-9" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb228-10"><a href="simulace3sigma.html#cb228-10" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Linear predictor&#39;</span>,</span>
<span id="cb228-11"><a href="simulace3sigma.html#cb228-11" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Estimated probabilities Pr(Y = 1|X = x)&#39;</span>,</span>
<span id="cb228-12"><a href="simulace3sigma.html#cb228-12" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Class&#39;</span>) </span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-46"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-46-1.png" alt="Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to class membership." width="672" />
<p class="caption">
Figure 1.15: Dependence of estimated probabilities on the values of the linear predictor. Points are color-coded according to class membership.
</p>
</div>
<p>We can also visualize the estimated parametric function <span class="math inline">\(\beta(t)\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb229"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb229-1"><a href="simulace3sigma.html#cb229-1" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">1001</span>)</span>
<span id="cb229-2"><a href="simulace3sigma.html#cb229-2" tabindex="-1"></a>beta.seq <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">evalarg =</span> t.seq, <span class="at">fdobj =</span> model.glm<span class="sc">$</span>beta.l<span class="sc">$</span>x)</span>
<span id="cb229-3"><a href="simulace3sigma.html#cb229-3" tabindex="-1"></a></span>
<span id="cb229-4"><a href="simulace3sigma.html#cb229-4" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">t =</span> t.seq, <span class="at">beta =</span> beta.seq) <span class="sc">|&gt;</span> </span>
<span id="cb229-5"><a href="simulace3sigma.html#cb229-5" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(t, beta)) <span class="sc">+</span> </span>
<span id="cb229-6"><a href="simulace3sigma.html#cb229-6" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb229-7"><a href="simulace3sigma.html#cb229-7" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb229-8"><a href="simulace3sigma.html#cb229-8" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;Time&#39;</span>,</span>
<span id="cb229-9"><a href="simulace3sigma.html#cb229-9" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(beta)(t))) <span class="sc">+</span> </span>
<span id="cb229-10"><a href="simulace3sigma.html#cb229-10" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">panel.grid.major =</span> <span class="fu">element_blank</span>(), <span class="at">panel.grid.minor =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span> </span>
<span id="cb229-11"><a href="simulace3sigma.html#cb229-11" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="fu">aes</span>(<span class="at">slope =</span> <span class="dv">0</span>, <span class="at">intercept =</span> <span class="dv">0</span>), <span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>, </span>
<span id="cb229-12"><a href="simulace3sigma.html#cb229-12" tabindex="-1"></a>              <span class="at">linewidth =</span> <span class="fl">0.5</span>, <span class="at">colour =</span> <span class="st">&#39;grey&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-47"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-47-1.png" alt="Plot of the estimate of the parametric function $\beta(t), t \in [0, 6]$." width="672" />
<p class="caption">
Figure 2.9: Plot of the estimate of the parametric function <span class="math inline">\(\beta(t), t \in [0, 6]\)</span>.
</p>
</div>
<p>We will again add the results to the summary table.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb230"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb230-1"><a href="simulace3sigma.html#cb230-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR functional&#39;</span>, </span>
<span id="cb230-2"><a href="simulace3sigma.html#cb230-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb230-3"><a href="simulace3sigma.html#cb230-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb230-4"><a href="simulace3sigma.html#cb230-4" tabindex="-1"></a></span>
<span id="cb230-5"><a href="simulace3sigma.html#cb230-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="random-forests-1" class="section level3 hasAnchor" number="2.3.5">
<h3><span class="header-section-number">2.3.5</span> Random Forests<a href="simulace3sigma.html#random-forests-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>The classifier built using the random forest method consists of constructing several individual decision trees, which are then combined to create a common classifier (by a common “vote”).</p>
<p>Just like with decision trees, we have several options for what data (finite-dimensional) we will use to construct the model. We will again consider the three approaches discussed above. The data files with the respective quantities for all three approaches are already prepared from the previous section, so we can directly build the models, calculate the characteristics of the classifier, and add the results to the summary table.</p>
<div id="discretization-of-the-interval" class="section level4 hasAnchor" number="2.3.5.1">
<h4><span class="header-section-number">2.3.5.1</span> Discretization of the Interval<a href="simulace3sigma.html#discretization-of-the-interval" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In the first case, we evaluate the functions at a given grid of points in the interval <span class="math inline">\(I = [0, 6]\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb231"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb231-1"><a href="simulace3sigma.html#cb231-1" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb231-2"><a href="simulace3sigma.html#cb231-2" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for row-wise functions</span></span>
<span id="cb231-3"><a href="simulace3sigma.html#cb231-3" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb231-4"><a href="simulace3sigma.html#cb231-4" tabindex="-1"></a></span>
<span id="cb231-5"><a href="simulace3sigma.html#cb231-5" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb231-6"><a href="simulace3sigma.html#cb231-6" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb231-7"><a href="simulace3sigma.html#cb231-7" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb232"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb232-1"><a href="simulace3sigma.html#cb232-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb232-2"><a href="simulace3sigma.html#cb232-2" tabindex="-1"></a>clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb232-3"><a href="simulace3sigma.html#cb232-3" tabindex="-1"></a>                       <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb232-4"><a href="simulace3sigma.html#cb232-4" tabindex="-1"></a>                       <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb232-5"><a href="simulace3sigma.html#cb232-5" tabindex="-1"></a>                       <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb232-6"><a href="simulace3sigma.html#cb232-6" tabindex="-1"></a></span>
<span id="cb232-7"><a href="simulace3sigma.html#cb232-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb232-8"><a href="simulace3sigma.html#cb232-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb232-9"><a href="simulace3sigma.html#cb232-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb232-10"><a href="simulace3sigma.html#cb232-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb232-11"><a href="simulace3sigma.html#cb232-11" tabindex="-1"></a>  </span>
<span id="cb232-12"><a href="simulace3sigma.html#cb232-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb232-13"><a href="simulace3sigma.html#cb232-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb232-14"><a href="simulace3sigma.html#cb232-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb232-15"><a href="simulace3sigma.html#cb232-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the random forest on the training data is 0 % and on the test data is 38.33 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb233"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb233-1"><a href="simulace3sigma.html#cb233-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - discretization&#39;</span>, </span>
<span id="cb233-2"><a href="simulace3sigma.html#cb233-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb233-3"><a href="simulace3sigma.html#cb233-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb233-4"><a href="simulace3sigma.html#cb233-4" tabindex="-1"></a></span>
<span id="cb233-5"><a href="simulace3sigma.html#cb233-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-2" class="section level4 hasAnchor" number="2.3.5.2">
<h4><span class="header-section-number">2.3.5.2</span> Principal Component Scores<a href="simulace3sigma.html#principal-component-scores-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb234"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb234-1"><a href="simulace3sigma.html#cb234-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb234-2"><a href="simulace3sigma.html#cb234-2" tabindex="-1"></a>clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb234-3"><a href="simulace3sigma.html#cb234-3" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb234-4"><a href="simulace3sigma.html#cb234-4" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb234-5"><a href="simulace3sigma.html#cb234-5" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb234-6"><a href="simulace3sigma.html#cb234-6" tabindex="-1"></a></span>
<span id="cb234-7"><a href="simulace3sigma.html#cb234-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb234-8"><a href="simulace3sigma.html#cb234-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb234-9"><a href="simulace3sigma.html#cb234-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb234-10"><a href="simulace3sigma.html#cb234-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb234-11"><a href="simulace3sigma.html#cb234-11" tabindex="-1"></a>  </span>
<span id="cb234-12"><a href="simulace3sigma.html#cb234-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb234-13"><a href="simulace3sigma.html#cb234-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb234-14"><a href="simulace3sigma.html#cb234-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb234-15"><a href="simulace3sigma.html#cb234-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate on the training data is thus 3.57 %, and on the test data, it is 41.67 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb235"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb235-1"><a href="simulace3sigma.html#cb235-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - score&#39;</span>, </span>
<span id="cb235-2"><a href="simulace3sigma.html#cb235-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb235-3"><a href="simulace3sigma.html#cb235-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb235-4"><a href="simulace3sigma.html#cb235-4" tabindex="-1"></a></span>
<span id="cb235-5"><a href="simulace3sigma.html#cb235-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="b-spline-coefficients" class="section level4 hasAnchor" number="2.3.5.3">
<h4><span class="header-section-number">2.3.5.3</span> B-Spline Coefficients<a href="simulace3sigma.html#b-spline-coefficients" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use the representation of functions through B-spline basis. First, let’s define the necessary data files with coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb236"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb236-1"><a href="simulace3sigma.html#cb236-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb236-2"><a href="simulace3sigma.html#cb236-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb236-3"><a href="simulace3sigma.html#cb236-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb236-4"><a href="simulace3sigma.html#cb236-4" tabindex="-1"></a></span>
<span id="cb236-5"><a href="simulace3sigma.html#cb236-5" tabindex="-1"></a><span class="co"># test dataset</span></span>
<span id="cb236-6"><a href="simulace3sigma.html#cb236-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb236-7"><a href="simulace3sigma.html#cb236-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb237"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb237-1"><a href="simulace3sigma.html#cb237-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb237-2"><a href="simulace3sigma.html#cb237-2" tabindex="-1"></a>clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb237-3"><a href="simulace3sigma.html#cb237-3" tabindex="-1"></a>                              <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># number of trees</span></span>
<span id="cb237-4"><a href="simulace3sigma.html#cb237-4" tabindex="-1"></a>                              <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb237-5"><a href="simulace3sigma.html#cb237-5" tabindex="-1"></a>                              <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb237-6"><a href="simulace3sigma.html#cb237-6" tabindex="-1"></a></span>
<span id="cb237-7"><a href="simulace3sigma.html#cb237-7" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb237-8"><a href="simulace3sigma.html#cb237-8" tabindex="-1"></a>predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb237-9"><a href="simulace3sigma.html#cb237-9" tabindex="-1"></a>presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb237-10"><a href="simulace3sigma.html#cb237-10" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb237-11"><a href="simulace3sigma.html#cb237-11" tabindex="-1"></a>  </span>
<span id="cb237-12"><a href="simulace3sigma.html#cb237-12" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb237-13"><a href="simulace3sigma.html#cb237-13" tabindex="-1"></a>predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb237-14"><a href="simulace3sigma.html#cb237-14" tabindex="-1"></a>presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb237-15"><a href="simulace3sigma.html#cb237-15" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of this classifier on the training data is 0 %, and on the test data, it is 41.67 %.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb238"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb238-1"><a href="simulace3sigma.html#cb238-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RForest - Bbasis&#39;</span>, </span>
<span id="cb238-2"><a href="simulace3sigma.html#cb238-2" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb238-3"><a href="simulace3sigma.html#cb238-3" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb238-4"><a href="simulace3sigma.html#cb238-4" tabindex="-1"></a></span>
<span id="cb238-5"><a href="simulace3sigma.html#cb238-5" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
<div id="support-vector-machines-1" class="section level3 hasAnchor" number="2.3.6">
<h3><span class="header-section-number">2.3.6</span> Support Vector Machines<a href="simulace3sigma.html#support-vector-machines-1" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s define the data for the next methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb239"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb239-1"><a href="simulace3sigma.html#cb239-1" tabindex="-1"></a><span class="co"># sequence of points where we evaluate the function</span></span>
<span id="cb239-2"><a href="simulace3sigma.html#cb239-2" tabindex="-1"></a>t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb239-3"><a href="simulace3sigma.html#cb239-3" tabindex="-1"></a>   </span>
<span id="cb239-4"><a href="simulace3sigma.html#cb239-4" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb239-5"><a href="simulace3sigma.html#cb239-5" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpose for row functions</span></span>
<span id="cb239-6"><a href="simulace3sigma.html#cb239-6" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb239-7"><a href="simulace3sigma.html#cb239-7" tabindex="-1"></a></span>
<span id="cb239-8"><a href="simulace3sigma.html#cb239-8" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb239-9"><a href="simulace3sigma.html#cb239-9" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb239-10"><a href="simulace3sigma.html#cb239-10" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>First, let’s define the necessary data files with coefficients.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb240"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb240-1"><a href="simulace3sigma.html#cb240-1" tabindex="-1"></a><span class="co"># training dataset</span></span>
<span id="cb240-2"><a href="simulace3sigma.html#cb240-2" tabindex="-1"></a>data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb240-3"><a href="simulace3sigma.html#cb240-3" tabindex="-1"></a>data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb240-4"><a href="simulace3sigma.html#cb240-4" tabindex="-1"></a></span>
<span id="cb240-5"><a href="simulace3sigma.html#cb240-5" tabindex="-1"></a><span class="co"># test dataset</span></span>
<span id="cb240-6"><a href="simulace3sigma.html#cb240-6" tabindex="-1"></a>data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb240-7"><a href="simulace3sigma.html#cb240-7" tabindex="-1"></a>data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span></code></pre></div>
</details>
<p>Now, let’s look at the classification of our simulated curves using Support Vector Machines (SVM). The advantage of this classification method is its computational efficiency, as it uses only a few (often very few) observations to define the boundary curve between classes.</p>
<div id="interval-discretization-2" class="section level4 hasAnchor" number="2.3.6.1">
<h4><span class="header-section-number">2.3.6.1</span> Interval Discretization<a href="simulace3sigma.html#interval-discretization-2" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Let’s start by applying the Support Vector Machines method directly to the discretized data (evaluating the function on a grid of points on the interval <span class="math inline">\(I = [0, 6]\)</span>), considering all three previously mentioned kernel functions.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb241"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb241-1"><a href="simulace3sigma.html#cb241-1" tabindex="-1"></a><span class="co"># set norm equal to one</span></span>
<span id="cb241-2"><a href="simulace3sigma.html#cb241-2" tabindex="-1"></a>norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb241-3"><a href="simulace3sigma.html#cb241-3" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb241-4"><a href="simulace3sigma.html#cb241-4" tabindex="-1"></a>  norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb241-5"><a href="simulace3sigma.html#cb241-5" tabindex="-1"></a>}</span>
<span id="cb241-6"><a href="simulace3sigma.html#cb241-6" tabindex="-1"></a>XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb241-7"><a href="simulace3sigma.html#cb241-7" tabindex="-1"></a>XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb241-8"><a href="simulace3sigma.html#cb241-8" tabindex="-1"></a>                                            <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb241-9"><a href="simulace3sigma.html#cb241-9" tabindex="-1"></a>                                            <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb241-10"><a href="simulace3sigma.html#cb241-10" tabindex="-1"></a>                                            <span class="at">byrow =</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-11"><a href="simulace3sigma.html#cb241-11" tabindex="-1"></a></span>
<span id="cb241-12"><a href="simulace3sigma.html#cb241-12" tabindex="-1"></a><span class="co"># split into test and training parts</span></span>
<span id="cb241-13"><a href="simulace3sigma.html#cb241-13" tabindex="-1"></a>X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-14"><a href="simulace3sigma.html#cb241-14" tabindex="-1"></a>X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb241-15"><a href="simulace3sigma.html#cb241-15" tabindex="-1"></a></span>
<span id="cb241-16"><a href="simulace3sigma.html#cb241-16" tabindex="-1"></a>Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb241-17"><a href="simulace3sigma.html#cb241-17" tabindex="-1"></a>Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb241-18"><a href="simulace3sigma.html#cb241-18" tabindex="-1"></a></span>
<span id="cb241-19"><a href="simulace3sigma.html#cb241-19" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb241-20"><a href="simulace3sigma.html#cb241-20" tabindex="-1"></a>grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb241-21"><a href="simulace3sigma.html#cb241-21" tabindex="-1"></a>grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb241-22"><a href="simulace3sigma.html#cb241-22" tabindex="-1"></a></span>
<span id="cb241-23"><a href="simulace3sigma.html#cb241-23" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb241-24"><a href="simulace3sigma.html#cb241-24" tabindex="-1"></a>grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb241-25"><a href="simulace3sigma.html#cb241-25" tabindex="-1"></a>grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span></code></pre></div>
</details>
<p>We estimated the parameters for each kernel using cross-validation on one generated dataset. We will use these values of <span class="math inline">\(C\)</span>, <span class="math inline">\(d\)</span>, and <span class="math inline">\(\gamma\)</span> for all datasets in this simulation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb242"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb242-1"><a href="simulace3sigma.html#cb242-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb242-2"><a href="simulace3sigma.html#cb242-2" tabindex="-1"></a>clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb242-3"><a href="simulace3sigma.html#cb242-3" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb242-4"><a href="simulace3sigma.html#cb242-4" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb242-5"><a href="simulace3sigma.html#cb242-5" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb242-6"><a href="simulace3sigma.html#cb242-6" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb242-7"><a href="simulace3sigma.html#cb242-7" tabindex="-1"></a></span>
<span id="cb242-8"><a href="simulace3sigma.html#cb242-8" tabindex="-1"></a>clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb242-9"><a href="simulace3sigma.html#cb242-9" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb242-10"><a href="simulace3sigma.html#cb242-10" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb242-11"><a href="simulace3sigma.html#cb242-11" tabindex="-1"></a>                 <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb242-12"><a href="simulace3sigma.html#cb242-12" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb242-13"><a href="simulace3sigma.html#cb242-13" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb242-14"><a href="simulace3sigma.html#cb242-14" tabindex="-1"></a></span>
<span id="cb242-15"><a href="simulace3sigma.html#cb242-15" tabindex="-1"></a>clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb242-16"><a href="simulace3sigma.html#cb242-16" tabindex="-1"></a>                 <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb242-17"><a href="simulace3sigma.html#cb242-17" tabindex="-1"></a>                 <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb242-18"><a href="simulace3sigma.html#cb242-18" tabindex="-1"></a>                 <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb242-19"><a href="simulace3sigma.html#cb242-19" tabindex="-1"></a>                 <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb242-20"><a href="simulace3sigma.html#cb242-20" tabindex="-1"></a>                 <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb242-21"><a href="simulace3sigma.html#cb242-21" tabindex="-1"></a></span>
<span id="cb242-22"><a href="simulace3sigma.html#cb242-22" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb242-23"><a href="simulace3sigma.html#cb242-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb242-24"><a href="simulace3sigma.html#cb242-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb242-25"><a href="simulace3sigma.html#cb242-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb242-26"><a href="simulace3sigma.html#cb242-26" tabindex="-1"></a></span>
<span id="cb242-27"><a href="simulace3sigma.html#cb242-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb242-28"><a href="simulace3sigma.html#cb242-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb242-29"><a href="simulace3sigma.html#cb242-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb242-30"><a href="simulace3sigma.html#cb242-30" tabindex="-1"></a></span>
<span id="cb242-31"><a href="simulace3sigma.html#cb242-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb242-32"><a href="simulace3sigma.html#cb242-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb242-33"><a href="simulace3sigma.html#cb242-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb242-34"><a href="simulace3sigma.html#cb242-34" tabindex="-1"></a></span>
<span id="cb242-35"><a href="simulace3sigma.html#cb242-35" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb242-36"><a href="simulace3sigma.html#cb242-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb242-37"><a href="simulace3sigma.html#cb242-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb242-38"><a href="simulace3sigma.html#cb242-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb242-39"><a href="simulace3sigma.html#cb242-39" tabindex="-1"></a></span>
<span id="cb242-40"><a href="simulace3sigma.html#cb242-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb242-41"><a href="simulace3sigma.html#cb242-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb242-42"><a href="simulace3sigma.html#cb242-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb242-43"><a href="simulace3sigma.html#cb242-43" tabindex="-1"></a></span>
<span id="cb242-44"><a href="simulace3sigma.html#cb242-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb242-45"><a href="simulace3sigma.html#cb242-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb242-46"><a href="simulace3sigma.html#cb242-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method on the training data is 5.71 % for the linear kernel, 2.14 % for the polynomial kernel, and 3.57 % for the radial kernel. On the test data, the error rate of the method is 16.67 % for the linear kernel, 16.67 % for the polynomial kernel, and 13.33 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb243"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb243-1"><a href="simulace3sigma.html#cb243-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - discr&#39;</span>, </span>
<span id="cb243-2"><a href="simulace3sigma.html#cb243-2" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - discr&#39;</span>, </span>
<span id="cb243-3"><a href="simulace3sigma.html#cb243-3" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - discr&#39;</span>), </span>
<span id="cb243-4"><a href="simulace3sigma.html#cb243-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb243-5"><a href="simulace3sigma.html#cb243-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb243-6"><a href="simulace3sigma.html#cb243-6" tabindex="-1"></a></span>
<span id="cb243-7"><a href="simulace3sigma.html#cb243-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="principal-component-scores-3" class="section level4 hasAnchor" number="2.3.6.2">
<h4><span class="header-section-number">2.3.6.2</span> Principal Component Scores<a href="simulace3sigma.html#principal-component-scores-3" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>In this case, we will use the scores of the first <span class="math inline">\(p =\)</span> 2 principal components.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb244"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb244-1"><a href="simulace3sigma.html#cb244-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb244-2"><a href="simulace3sigma.html#cb244-2" tabindex="-1"></a>clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb244-3"><a href="simulace3sigma.html#cb244-3" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb244-4"><a href="simulace3sigma.html#cb244-4" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb244-5"><a href="simulace3sigma.html#cb244-5" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb244-6"><a href="simulace3sigma.html#cb244-6" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb244-7"><a href="simulace3sigma.html#cb244-7" tabindex="-1"></a></span>
<span id="cb244-8"><a href="simulace3sigma.html#cb244-8" tabindex="-1"></a>clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb244-9"><a href="simulace3sigma.html#cb244-9" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb244-10"><a href="simulace3sigma.html#cb244-10" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb244-11"><a href="simulace3sigma.html#cb244-11" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb244-12"><a href="simulace3sigma.html#cb244-12" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="fl">0.6</span>,</span>
<span id="cb244-13"><a href="simulace3sigma.html#cb244-13" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb244-14"><a href="simulace3sigma.html#cb244-14" tabindex="-1"></a></span>
<span id="cb244-15"><a href="simulace3sigma.html#cb244-15" tabindex="-1"></a>clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb244-16"><a href="simulace3sigma.html#cb244-16" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb244-17"><a href="simulace3sigma.html#cb244-17" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb244-18"><a href="simulace3sigma.html#cb244-18" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb244-19"><a href="simulace3sigma.html#cb244-19" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb244-20"><a href="simulace3sigma.html#cb244-20" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb244-21"><a href="simulace3sigma.html#cb244-21" tabindex="-1"></a></span>
<span id="cb244-22"><a href="simulace3sigma.html#cb244-22" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb244-23"><a href="simulace3sigma.html#cb244-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb244-24"><a href="simulace3sigma.html#cb244-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb244-25"><a href="simulace3sigma.html#cb244-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb244-26"><a href="simulace3sigma.html#cb244-26" tabindex="-1"></a></span>
<span id="cb244-27"><a href="simulace3sigma.html#cb244-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb244-28"><a href="simulace3sigma.html#cb244-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb244-29"><a href="simulace3sigma.html#cb244-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb244-30"><a href="simulace3sigma.html#cb244-30" tabindex="-1"></a></span>
<span id="cb244-31"><a href="simulace3sigma.html#cb244-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb244-32"><a href="simulace3sigma.html#cb244-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb244-33"><a href="simulace3sigma.html#cb244-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb244-34"><a href="simulace3sigma.html#cb244-34" tabindex="-1"></a>  </span>
<span id="cb244-35"><a href="simulace3sigma.html#cb244-35" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb244-36"><a href="simulace3sigma.html#cb244-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb244-37"><a href="simulace3sigma.html#cb244-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb244-38"><a href="simulace3sigma.html#cb244-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb244-39"><a href="simulace3sigma.html#cb244-39" tabindex="-1"></a></span>
<span id="cb244-40"><a href="simulace3sigma.html#cb244-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb244-41"><a href="simulace3sigma.html#cb244-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb244-42"><a href="simulace3sigma.html#cb244-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb244-43"><a href="simulace3sigma.html#cb244-43" tabindex="-1"></a></span>
<span id="cb244-44"><a href="simulace3sigma.html#cb244-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb244-45"><a href="simulace3sigma.html#cb244-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb244-46"><a href="simulace3sigma.html#cb244-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the principal component scores on the training data is 44.29 % for the linear kernel, 37.86 % for the polynomial kernel, and 37.14 % for the radial kernel. On the test data, the error rate of the method is 48.33 % for the linear kernel, 43.33 % for the polynomial kernel, and 40 % for the radial kernel.</p>
<p>For the graphical representation of the method, we can mark the decision boundary on the plot of the scores of the first two principal components. We will calculate this boundary on a dense grid of points and display it using the <code>geom_contour()</code> function, as we did in previous cases when plotting the classification boundary.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb245"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb245-1"><a href="simulace3sigma.html#cb245-1" tabindex="-1"></a>nd <span class="ot">&lt;-</span> <span class="fu">rbind</span>(nd, nd, nd) <span class="sc">|&gt;</span> <span class="fu">mutate</span>(</span>
<span id="cb245-2"><a href="simulace3sigma.html#cb245-2" tabindex="-1"></a>   <span class="at">prd =</span> <span class="fu">c</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb245-3"><a href="simulace3sigma.html#cb245-3" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)),</span>
<span id="cb245-4"><a href="simulace3sigma.html#cb245-4" tabindex="-1"></a>           <span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> nd, <span class="at">type =</span> <span class="st">&#39;response&#39;</span>))),</span>
<span id="cb245-5"><a href="simulace3sigma.html#cb245-5" tabindex="-1"></a>   <span class="at">kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>),</span>
<span id="cb245-6"><a href="simulace3sigma.html#cb245-6" tabindex="-1"></a>                <span class="at">each =</span> <span class="fu">length</span>(<span class="fu">as.numeric</span>(<span class="fu">predict</span>(clf.SVM.l.PCA, </span>
<span id="cb245-7"><a href="simulace3sigma.html#cb245-7" tabindex="-1"></a>                                                 <span class="at">newdata =</span> nd,</span>
<span id="cb245-8"><a href="simulace3sigma.html#cb245-8" tabindex="-1"></a>                                                 <span class="at">type =</span> <span class="st">&#39;response&#39;</span>)))))</span>
<span id="cb245-9"><a href="simulace3sigma.html#cb245-9" tabindex="-1"></a></span>
<span id="cb245-10"><a href="simulace3sigma.html#cb245-10" tabindex="-1"></a>data.PCA.train <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">colour =</span> Y)) <span class="sc">+</span></span>
<span id="cb245-11"><a href="simulace3sigma.html#cb245-11" tabindex="-1"></a> <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb245-12"><a href="simulace3sigma.html#cb245-12" tabindex="-1"></a> <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">paste</span>(<span class="st">&#39;1st Principal Component (Explained Variability&#39;</span>, </span>
<span id="cb245-13"><a href="simulace3sigma.html#cb245-13" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">1</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb245-14"><a href="simulace3sigma.html#cb245-14" tabindex="-1"></a>      <span class="at">y =</span> <span class="fu">paste</span>(<span class="st">&#39;2nd Principal Component (&#39;</span>, </span>
<span id="cb245-15"><a href="simulace3sigma.html#cb245-15" tabindex="-1"></a>                <span class="fu">round</span>(<span class="dv">100</span> <span class="sc">*</span> data.PCA<span class="sc">$</span>varprop[<span class="dv">2</span>], <span class="dv">2</span>), <span class="st">&#39;%)&#39;</span>),</span>
<span id="cb245-16"><a href="simulace3sigma.html#cb245-16" tabindex="-1"></a>      <span class="at">colour =</span> <span class="st">&#39;Group&#39;</span>, </span>
<span id="cb245-17"><a href="simulace3sigma.html#cb245-17" tabindex="-1"></a>      <span class="at">linetype =</span> <span class="st">&#39;Kernel type&#39;</span>) <span class="sc">+</span></span>
<span id="cb245-18"><a href="simulace3sigma.html#cb245-18" tabindex="-1"></a> <span class="fu">scale_colour_discrete</span>(<span class="at">labels =</span> <span class="fu">c</span>(<span class="st">&#39;Y = 0&#39;</span>, <span class="st">&#39;Y = 1&#39;</span>)) <span class="sc">+</span></span>
<span id="cb245-19"><a href="simulace3sigma.html#cb245-19" tabindex="-1"></a> <span class="fu">theme_bw</span>() <span class="sc">+</span></span>
<span id="cb245-20"><a href="simulace3sigma.html#cb245-20" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel), </span>
<span id="cb245-21"><a href="simulace3sigma.html#cb245-21" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb245-22"><a href="simulace3sigma.html#cb245-22" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb245-23"><a href="simulace3sigma.html#cb245-23" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>) <span class="sc">+</span> </span>
<span id="cb245-24"><a href="simulace3sigma.html#cb245-24" tabindex="-1"></a> <span class="fu">geom_contour</span>(<span class="at">data =</span> nd, <span class="fu">aes</span>(<span class="at">x =</span> V1, <span class="at">y =</span> V2, <span class="at">z =</span> prd, <span class="at">linetype =</span> kernel),</span>
<span id="cb245-25"><a href="simulace3sigma.html#cb245-25" tabindex="-1"></a>              <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-63"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-63-1.png" alt="Scores of the first two principal components, color-coded according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is marked in black." width="672" />
<p class="caption">
Figure 2.10: Scores of the first two principal components, color-coded according to class membership. The decision boundary (line or curves in the plane of the first two principal components) between classes constructed using the SVM method is marked in black.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb246"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb246-1"><a href="simulace3sigma.html#cb246-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb246-2"><a href="simulace3sigma.html#cb246-2" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb246-3"><a href="simulace3sigma.html#cb246-3" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb246-4"><a href="simulace3sigma.html#cb246-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb246-5"><a href="simulace3sigma.html#cb246-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb246-6"><a href="simulace3sigma.html#cb246-6" tabindex="-1"></a></span>
<span id="cb246-7"><a href="simulace3sigma.html#cb246-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="b-spline-coefficients-1" class="section level4 hasAnchor" number="2.3.6.3">
<h4><span class="header-section-number">2.3.6.3</span> B-spline Coefficients<a href="simulace3sigma.html#b-spline-coefficients-1" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Finally, we will use the representation of functions through the B-spline basis.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb247"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb247-1"><a href="simulace3sigma.html#cb247-1" tabindex="-1"></a><span class="co"># model construction</span></span>
<span id="cb247-2"><a href="simulace3sigma.html#cb247-2" tabindex="-1"></a>clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-3"><a href="simulace3sigma.html#cb247-3" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-4"><a href="simulace3sigma.html#cb247-4" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-5"><a href="simulace3sigma.html#cb247-5" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb247-6"><a href="simulace3sigma.html#cb247-6" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb247-7"><a href="simulace3sigma.html#cb247-7" tabindex="-1"></a></span>
<span id="cb247-8"><a href="simulace3sigma.html#cb247-8" tabindex="-1"></a>clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-9"><a href="simulace3sigma.html#cb247-9" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-10"><a href="simulace3sigma.html#cb247-10" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-11"><a href="simulace3sigma.html#cb247-11" tabindex="-1"></a>                        <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb247-12"><a href="simulace3sigma.html#cb247-12" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb247-13"><a href="simulace3sigma.html#cb247-13" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb247-14"><a href="simulace3sigma.html#cb247-14" tabindex="-1"></a></span>
<span id="cb247-15"><a href="simulace3sigma.html#cb247-15" tabindex="-1"></a>clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb247-16"><a href="simulace3sigma.html#cb247-16" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb247-17"><a href="simulace3sigma.html#cb247-17" tabindex="-1"></a>                        <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb247-18"><a href="simulace3sigma.html#cb247-18" tabindex="-1"></a>                        <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb247-19"><a href="simulace3sigma.html#cb247-19" tabindex="-1"></a>                        <span class="at">gamma =</span> <span class="fl">0.005</span>,</span>
<span id="cb247-20"><a href="simulace3sigma.html#cb247-20" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb247-21"><a href="simulace3sigma.html#cb247-21" tabindex="-1"></a></span>
<span id="cb247-22"><a href="simulace3sigma.html#cb247-22" tabindex="-1"></a><span class="co"># accuracy on training data</span></span>
<span id="cb247-23"><a href="simulace3sigma.html#cb247-23" tabindex="-1"></a>predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-24"><a href="simulace3sigma.html#cb247-24" tabindex="-1"></a>presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb247-25"><a href="simulace3sigma.html#cb247-25" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-26"><a href="simulace3sigma.html#cb247-26" tabindex="-1"></a></span>
<span id="cb247-27"><a href="simulace3sigma.html#cb247-27" tabindex="-1"></a>predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-28"><a href="simulace3sigma.html#cb247-28" tabindex="-1"></a>presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb247-29"><a href="simulace3sigma.html#cb247-29" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-30"><a href="simulace3sigma.html#cb247-30" tabindex="-1"></a></span>
<span id="cb247-31"><a href="simulace3sigma.html#cb247-31" tabindex="-1"></a>predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb247-32"><a href="simulace3sigma.html#cb247-32" tabindex="-1"></a>presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb247-33"><a href="simulace3sigma.html#cb247-33" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-34"><a href="simulace3sigma.html#cb247-34" tabindex="-1"></a>  </span>
<span id="cb247-35"><a href="simulace3sigma.html#cb247-35" tabindex="-1"></a><span class="co"># accuracy on test data</span></span>
<span id="cb247-36"><a href="simulace3sigma.html#cb247-36" tabindex="-1"></a>predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-37"><a href="simulace3sigma.html#cb247-37" tabindex="-1"></a>presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb247-38"><a href="simulace3sigma.html#cb247-38" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-39"><a href="simulace3sigma.html#cb247-39" tabindex="-1"></a></span>
<span id="cb247-40"><a href="simulace3sigma.html#cb247-40" tabindex="-1"></a>predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-41"><a href="simulace3sigma.html#cb247-41" tabindex="-1"></a>presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb247-42"><a href="simulace3sigma.html#cb247-42" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb247-43"><a href="simulace3sigma.html#cb247-43" tabindex="-1"></a></span>
<span id="cb247-44"><a href="simulace3sigma.html#cb247-44" tabindex="-1"></a>predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb247-45"><a href="simulace3sigma.html#cb247-45" tabindex="-1"></a>presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb247-46"><a href="simulace3sigma.html#cb247-46" tabindex="-1"></a>  <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is therefore 4.29 % for the linear kernel, 4.29 % for the polynomial kernel, and 7.14 % for the Gaussian kernel. For the test data, the error rate of the method is 10 % for the linear kernel, 11.67 % for the polynomial kernel, and 15 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb248"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb248-1"><a href="simulace3sigma.html#cb248-1" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb248-2"><a href="simulace3sigma.html#cb248-2" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb248-3"><a href="simulace3sigma.html#cb248-3" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb248-4"><a href="simulace3sigma.html#cb248-4" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, presnost.train.p, presnost.train.r),</span>
<span id="cb248-5"><a href="simulace3sigma.html#cb248-5" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, presnost.test.p, presnost.test.r))</span>
<span id="cb248-6"><a href="simulace3sigma.html#cb248-6" tabindex="-1"></a></span>
<span id="cb248-7"><a href="simulace3sigma.html#cb248-7" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="projection-onto-b-spline-basis" class="section level4 hasAnchor" number="2.3.6.4">
<h4><span class="header-section-number">2.3.6.4</span> Projection onto B-spline Basis<a href="simulace3sigma.html#projection-onto-b-spline-basis" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<p>Another way to apply the classical SVM method to functional data is to project the original data onto a <span class="math inline">\(d\)</span>-dimensional subspace of our Hilbert space <span class="math inline">\(\mathcal{H}\)</span>, which we denote as <span class="math inline">\(V_d\)</span>. Let’s assume that this subspace <span class="math inline">\(V_d\)</span> has an orthonormal basis <span class="math inline">\(\{\Psi_j\}_{j = 1, \dots, d}\)</span>. We define the transformation $ P_{V_d} $ as the orthogonal projection onto the subspace $ V_d $, which can be expressed as</p>
<p><span class="math display">\[
P_{V_d} (x) = \sum_{j = 1}^d \langle x, \Psi_j \rangle \Psi_j.
\]</span></p>
<p>We can then use the coefficients from the orthogonal projection for classification, applying standard SVM to the vectors $ ( x, <em>1 , , x, <em>d )^$. By utilizing this transformation, we define a new, so-called adapted kernel, composed of the orthogonal projection $ P</em>{V_d} $ and the kernel function of the standard support vector machine. Thus, we have the (adapted) kernel $ Q(x_i, x_j) = K(P</em>{V_d}(x_i), P_{V_d}(x_j)) $. This represents a dimensionality reduction method, which we can refer to as <em>filtering</em>.</p>
<p>For the projection itself, we will use the <code>project.basis()</code> function from the <code>fda</code> library in <code>R</code>. The input will be a matrix of original discrete (non-smoothed) data, the values over which we measure the values in the original data matrix, and the basis object onto which we want to project the data. We will choose to project onto a B-spline basis because using a Fourier basis is not suitable for our non-periodic data. Another option is to use a <em>wavelet basis</em>.</p>
<p>The dimension $ d $ can be chosen based on some prior expert knowledge or through cross-validation. In our case, we will determine the optimal dimension of the subspace $ V_d $ using $ k $-fold cross-validation (we choose $ k n $ due to the computational intensity of the method, often selecting $ k = 5 $ or $ k = 10 $). We require B-splines of order 4, and the number of basis functions is determined by the relation</p>
<p><span class="math display">\[
n_{basis} = n_{breaks} + n_{order} - 2,
\]</span></p>
<p>where $ n_{breaks} $ is the number of knots and $ n_{order} = 4 $. The minimum dimension is therefore (for $ n_{breaks} = 1 $) $ n_{basis} = 3 $, and the maximum (for $ n_{breaks} = 51 $, corresponding to the number of original discrete data) $ n_{basis} = 53 $. However, in <code>R</code>, the value of $ n_{basis} $ must be at least $ n_{order} = 4 $, and for large values of $ n_{basis} $, overfitting of the model occurs, so we choose a maximum $ n_{basis} $ of a smaller number, say 43.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb249"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb249-1"><a href="simulace3sigma.html#cb249-1" tabindex="-1"></a>k_cv <span class="ot">&lt;-</span> <span class="dv">10</span> <span class="co"># k-fold CV</span></span>
<span id="cb249-2"><a href="simulace3sigma.html#cb249-2" tabindex="-1"></a></span>
<span id="cb249-3"><a href="simulace3sigma.html#cb249-3" tabindex="-1"></a><span class="co"># values for the B-spline basis</span></span>
<span id="cb249-4"><a href="simulace3sigma.html#cb249-4" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb249-5"><a href="simulace3sigma.html#cb249-5" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb249-6"><a href="simulace3sigma.html#cb249-6" tabindex="-1"></a>n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb249-7"><a href="simulace3sigma.html#cb249-7" tabindex="-1"></a>n_basis_max <span class="ot">&lt;-</span> <span class="fu">length</span>(t) <span class="sc">+</span> norder <span class="sc">-</span> <span class="dv">2</span> <span class="sc">-</span> <span class="dv">10</span></span>
<span id="cb249-8"><a href="simulace3sigma.html#cb249-8" tabindex="-1"></a></span>
<span id="cb249-9"><a href="simulace3sigma.html#cb249-9" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max <span class="co"># all dimensions we want to test</span></span>
<span id="cb249-10"><a href="simulace3sigma.html#cb249-10" tabindex="-1"></a></span>
<span id="cb249-11"><a href="simulace3sigma.html#cb249-11" tabindex="-1"></a><span class="co"># split training data into k parts</span></span>
<span id="cb249-12"><a href="simulace3sigma.html#cb249-12" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb249-13"><a href="simulace3sigma.html#cb249-13" tabindex="-1"></a></span>
<span id="cb249-14"><a href="simulace3sigma.html#cb249-14" tabindex="-1"></a><span class="co"># list with three components ... matrices for each kernel -&gt; linear, poly, radial</span></span>
<span id="cb249-15"><a href="simulace3sigma.html#cb249-15" tabindex="-1"></a><span class="co"># empty matrix to hold results</span></span>
<span id="cb249-16"><a href="simulace3sigma.html#cb249-16" tabindex="-1"></a><span class="co"># columns will have accuracy values for each part of the training set</span></span>
<span id="cb249-17"><a href="simulace3sigma.html#cb249-17" tabindex="-1"></a><span class="co"># rows will have values for each dimension value</span></span>
<span id="cb249-18"><a href="simulace3sigma.html#cb249-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb249-19"><a href="simulace3sigma.html#cb249-19" tabindex="-1"></a>                   <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb249-20"><a href="simulace3sigma.html#cb249-20" tabindex="-1"></a>                   <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb249-21"><a href="simulace3sigma.html#cb249-21" tabindex="-1"></a></span>
<span id="cb249-22"><a href="simulace3sigma.html#cb249-22" tabindex="-1"></a><span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb249-23"><a href="simulace3sigma.html#cb249-23" tabindex="-1"></a>  <span class="co"># basis object</span></span>
<span id="cb249-24"><a href="simulace3sigma.html#cb249-24" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb249-25"><a href="simulace3sigma.html#cb249-25" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d)</span>
<span id="cb249-26"><a href="simulace3sigma.html#cb249-26" tabindex="-1"></a>  </span>
<span id="cb249-27"><a href="simulace3sigma.html#cb249-27" tabindex="-1"></a>  <span class="co"># projection of discrete data onto the B-spline basis of dimension d</span></span>
<span id="cb249-28"><a href="simulace3sigma.html#cb249-28" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb249-29"><a href="simulace3sigma.html#cb249-29" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb249-30"><a href="simulace3sigma.html#cb249-30" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb249-31"><a href="simulace3sigma.html#cb249-31" tabindex="-1"></a>  </span>
<span id="cb249-32"><a href="simulace3sigma.html#cb249-32" tabindex="-1"></a>  <span class="co"># split into training and test data for CV</span></span>
<span id="cb249-33"><a href="simulace3sigma.html#cb249-33" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb249-34"><a href="simulace3sigma.html#cb249-34" tabindex="-1"></a>  </span>
<span id="cb249-35"><a href="simulace3sigma.html#cb249-35" tabindex="-1"></a>  <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb249-36"><a href="simulace3sigma.html#cb249-36" tabindex="-1"></a>    <span class="co"># definition of test and training parts for CV</span></span>
<span id="cb249-37"><a href="simulace3sigma.html#cb249-37" tabindex="-1"></a>    fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb249-38"><a href="simulace3sigma.html#cb249-38" tabindex="-1"></a>    cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb249-39"><a href="simulace3sigma.html#cb249-39" tabindex="-1"></a>    </span>
<span id="cb249-40"><a href="simulace3sigma.html#cb249-40" tabindex="-1"></a>    data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb249-41"><a href="simulace3sigma.html#cb249-41" tabindex="-1"></a>    data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb249-42"><a href="simulace3sigma.html#cb249-42" tabindex="-1"></a>    </span>
<span id="cb249-43"><a href="simulace3sigma.html#cb249-43" tabindex="-1"></a>    data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb249-44"><a href="simulace3sigma.html#cb249-44" tabindex="-1"></a>    Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb249-45"><a href="simulace3sigma.html#cb249-45" tabindex="-1"></a>    data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb249-46"><a href="simulace3sigma.html#cb249-46" tabindex="-1"></a>  </span>
<span id="cb249-47"><a href="simulace3sigma.html#cb249-47" tabindex="-1"></a>    <span class="co"># model construction</span></span>
<span id="cb249-48"><a href="simulace3sigma.html#cb249-48" tabindex="-1"></a>    clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb249-49"><a href="simulace3sigma.html#cb249-49" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb249-50"><a href="simulace3sigma.html#cb249-50" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb249-51"><a href="simulace3sigma.html#cb249-51" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb249-52"><a href="simulace3sigma.html#cb249-52" tabindex="-1"></a>    </span>
<span id="cb249-53"><a href="simulace3sigma.html#cb249-53" tabindex="-1"></a>    clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb249-54"><a href="simulace3sigma.html#cb249-54" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb249-55"><a href="simulace3sigma.html#cb249-55" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb249-56"><a href="simulace3sigma.html#cb249-56" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb249-57"><a href="simulace3sigma.html#cb249-57" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb249-58"><a href="simulace3sigma.html#cb249-58" tabindex="-1"></a>    </span>
<span id="cb249-59"><a href="simulace3sigma.html#cb249-59" tabindex="-1"></a>    clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb249-60"><a href="simulace3sigma.html#cb249-60" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb249-61"><a href="simulace3sigma.html#cb249-61" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb249-62"><a href="simulace3sigma.html#cb249-62" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb249-63"><a href="simulace3sigma.html#cb249-63" tabindex="-1"></a>      </span>
<span id="cb249-64"><a href="simulace3sigma.html#cb249-64" tabindex="-1"></a>    <span class="co"># accuracy on validation data</span></span>
<span id="cb249-65"><a href="simulace3sigma.html#cb249-65" tabindex="-1"></a>    <span class="do">## linear kernel</span></span>
<span id="cb249-66"><a href="simulace3sigma.html#cb249-66" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb249-67"><a href="simulace3sigma.html#cb249-67" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb249-68"><a href="simulace3sigma.html#cb249-68" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb249-69"><a href="simulace3sigma.html#cb249-69" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb249-70"><a href="simulace3sigma.html#cb249-70" tabindex="-1"></a>    <span class="do">## polynomial kernel</span></span>
<span id="cb249-71"><a href="simulace3sigma.html#cb249-71" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb249-72"><a href="simulace3sigma.html#cb249-72" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb249-73"><a href="simulace3sigma.html#cb249-73" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb249-74"><a href="simulace3sigma.html#cb249-74" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb249-75"><a href="simulace3sigma.html#cb249-75" tabindex="-1"></a>    <span class="do">## radial kernel</span></span>
<span id="cb249-76"><a href="simulace3sigma.html#cb249-76" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb249-77"><a href="simulace3sigma.html#cb249-77" tabindex="-1"></a>                                  <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb249-78"><a href="simulace3sigma.html#cb249-78" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb249-79"><a href="simulace3sigma.html#cb249-79" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb249-80"><a href="simulace3sigma.html#cb249-80" tabindex="-1"></a>    </span>
<span id="cb249-81"><a href="simulace3sigma.html#cb249-81" tabindex="-1"></a>    <span class="co"># store accuracies for the given d and fold</span></span>
<span id="cb249-82"><a href="simulace3sigma.html#cb249-82" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb249-83"><a href="simulace3sigma.html#cb249-83" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb249-84"><a href="simulace3sigma.html#cb249-84" tabindex="-1"></a>    CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb249-85"><a href="simulace3sigma.html#cb249-85" tabindex="-1"></a>  }</span>
<span id="cb249-86"><a href="simulace3sigma.html#cb249-86" tabindex="-1"></a>}</span>
<span id="cb249-87"><a href="simulace3sigma.html#cb249-87" tabindex="-1"></a>  </span>
<span id="cb249-88"><a href="simulace3sigma.html#cb249-88" tabindex="-1"></a><span class="co"># calculate average accuracies for each d across folds</span></span>
<span id="cb249-89"><a href="simulace3sigma.html#cb249-89" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb249-90"><a href="simulace3sigma.html#cb249-90" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb249-91"><a href="simulace3sigma.html#cb249-91" tabindex="-1"></a>}</span>
<span id="cb249-92"><a href="simulace3sigma.html#cb249-92" tabindex="-1"></a></span>
<span id="cb249-93"><a href="simulace3sigma.html#cb249-93" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb249-94"><a href="simulace3sigma.html#cb249-94" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb249-95"><a href="simulace3sigma.html#cb249-95" tabindex="-1"></a>           <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb249-96"><a href="simulace3sigma.html#cb249-96" tabindex="-1"></a>presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb249-97"><a href="simulace3sigma.html#cb249-97" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb249-98"><a href="simulace3sigma.html#cb249-98" tabindex="-1"></a>                     <span class="fu">max</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb249-99"><a href="simulace3sigma.html#cb249-99" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">d_opt =</span> d.opt, <span class="at">ERR =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv,</span>
<span id="cb249-100"><a href="simulace3sigma.html#cb249-100" tabindex="-1"></a>           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<pre><code>##        d_opt        ERR
## linear    11 0.04306319
## poly      11 0.07699176
## radial    10 0.06449176</code></pre>
<p>We see that the best value for the parameter <span class="math inline">\(d\)</span> is 11 for the linear kernel, with an error rate calculated using 10-fold CV of 0.0431, 11 for the polynomial kernel with an error rate of 0.077, and 10 for the radial kernel with an error rate of 0.0645.</p>
<p>For clarity, let’s plot the validation error rates as a function of the dimension <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb251"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb251-1"><a href="simulace3sigma.html#cb251-1" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), </span>
<span id="cb251-2"><a href="simulace3sigma.html#cb251-2" tabindex="-1"></a>                         <span class="at">CV =</span> <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l, </span>
<span id="cb251-3"><a href="simulace3sigma.html#cb251-3" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.p, </span>
<span id="cb251-4"><a href="simulace3sigma.html#cb251-4" tabindex="-1"></a>                                CV.results<span class="sc">$</span>SVM.r),</span>
<span id="cb251-5"><a href="simulace3sigma.html#cb251-5" tabindex="-1"></a>                         <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb251-6"><a href="simulace3sigma.html#cb251-6" tabindex="-1"></a>                                      <span class="at">each =</span> <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb251-7"><a href="simulace3sigma.html#cb251-7" tabindex="-1"></a>CV.results <span class="sc">|&gt;</span> <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> CV, <span class="at">colour =</span> Kernel)) <span class="sc">+</span> </span>
<span id="cb251-8"><a href="simulace3sigma.html#cb251-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">linetype =</span> <span class="st">&#39;dashed&#39;</span>) <span class="sc">+</span> </span>
<span id="cb251-9"><a href="simulace3sigma.html#cb251-9" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">size =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb251-10"><a href="simulace3sigma.html#cb251-10" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> <span class="fu">data.frame</span>(d.opt,</span>
<span id="cb251-11"><a href="simulace3sigma.html#cb251-11" tabindex="-1"></a>                               presnost.opt.cv),</span>
<span id="cb251-12"><a href="simulace3sigma.html#cb251-12" tabindex="-1"></a>             <span class="fu">aes</span>(<span class="at">x =</span> d.opt, <span class="at">y =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.opt.cv), <span class="at">colour =</span> <span class="st">&#39;black&#39;</span>, <span class="at">size =</span> <span class="dv">2</span>) <span class="sc">+</span></span>
<span id="cb251-13"><a href="simulace3sigma.html#cb251-13" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb251-14"><a href="simulace3sigma.html#cb251-14" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">bquote</span>(<span class="fu">paste</span>(d)),</span>
<span id="cb251-15"><a href="simulace3sigma.html#cb251-15" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Validation error&#39;</span>) <span class="sc">+</span> </span>
<span id="cb251-16"><a href="simulace3sigma.html#cb251-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&quot;bottom&quot;</span>) <span class="sc">+</span> </span>
<span id="cb251-17"><a href="simulace3sigma.html#cb251-17" tabindex="-1"></a>  <span class="fu">scale_x_continuous</span>(<span class="at">breaks =</span> dimensions)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-68"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-68-1.png" alt="Dependency of validation error on the dimension of the subspace $V_d$, separately for all three considered kernels in the SVM method. The optimal values of dimension $V_d$ for individual kernel functions are marked with black points." width="672" />
<p class="caption">
Figure 2.11: Dependency of validation error on the dimension of the subspace <span class="math inline">\(V_d\)</span>, separately for all three considered kernels in the SVM method. The optimal values of dimension <span class="math inline">\(V_d\)</span> for individual kernel functions are marked with black points.
</p>
</div>
<p>Now we can train individual classifiers on all training data and look at their performance on the test data. For each kernel function, we choose the dimension of the subspace onto which we project based on the results of cross-validation.</p>
<p>In the variable <code>Projection</code>, we have stored the matrix of coefficients from the orthogonal projection, that is,</p>
<p><span class="math display">\[
\texttt{Projection} = \begin{pmatrix}
\langle x_1, \Psi_1 \rangle &amp; \langle x_2, \Psi_1 \rangle &amp; \cdots &amp; \langle x_n, \Psi_1 \rangle\\
\langle x_1, \Psi_2 \rangle &amp; \langle x_2, \Psi_2 \rangle &amp; \cdots &amp; \langle x_n, \Psi_2 \rangle\\
\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
\langle x_1, \Psi_d \rangle &amp; \langle x_2, \Psi_d \rangle &amp; \dots &amp; \langle x_n, \Psi_d \rangle
\end{pmatrix}_{d \times n}.
\]</span></p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb252"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb252-1"><a href="simulace3sigma.html#cb252-1" tabindex="-1"></a><span class="co"># Prepare a data table to store the results</span></span>
<span id="cb252-2"><a href="simulace3sigma.html#cb252-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb252-3"><a href="simulace3sigma.html#cb252-3" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb252-4"><a href="simulace3sigma.html#cb252-4" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb252-5"><a href="simulace3sigma.html#cb252-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb252-6"><a href="simulace3sigma.html#cb252-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb252-7"><a href="simulace3sigma.html#cb252-7" tabindex="-1"></a></span>
<span id="cb252-8"><a href="simulace3sigma.html#cb252-8" tabindex="-1"></a><span class="co"># Iterate over individual kernels</span></span>
<span id="cb252-9"><a href="simulace3sigma.html#cb252-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb252-10"><a href="simulace3sigma.html#cb252-10" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb252-11"><a href="simulace3sigma.html#cb252-11" tabindex="-1"></a>  <span class="co"># Basis object</span></span>
<span id="cb252-12"><a href="simulace3sigma.html#cb252-12" tabindex="-1"></a>  bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb252-13"><a href="simulace3sigma.html#cb252-13" tabindex="-1"></a>                                 <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb252-14"><a href="simulace3sigma.html#cb252-14" tabindex="-1"></a>  </span>
<span id="cb252-15"><a href="simulace3sigma.html#cb252-15" tabindex="-1"></a>  <span class="co"># Project discrete data onto the B-spline basis</span></span>
<span id="cb252-16"><a href="simulace3sigma.html#cb252-16" tabindex="-1"></a>  Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="co"># matrix of discrete data</span></span>
<span id="cb252-17"><a href="simulace3sigma.html#cb252-17" tabindex="-1"></a>                              <span class="at">argvals =</span> t, <span class="co"># vector of arguments</span></span>
<span id="cb252-18"><a href="simulace3sigma.html#cb252-18" tabindex="-1"></a>                              <span class="at">basisobj =</span> bbasis) <span class="co"># basis object</span></span>
<span id="cb252-19"><a href="simulace3sigma.html#cb252-19" tabindex="-1"></a>  </span>
<span id="cb252-20"><a href="simulace3sigma.html#cb252-20" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb252-21"><a href="simulace3sigma.html#cb252-21" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb252-22"><a href="simulace3sigma.html#cb252-22" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb252-23"><a href="simulace3sigma.html#cb252-23" tabindex="-1"></a>  </span>
<span id="cb252-24"><a href="simulace3sigma.html#cb252-24" tabindex="-1"></a>  data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb252-25"><a href="simulace3sigma.html#cb252-25" tabindex="-1"></a>  data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb252-26"><a href="simulace3sigma.html#cb252-26" tabindex="-1"></a>  </span>
<span id="cb252-27"><a href="simulace3sigma.html#cb252-27" tabindex="-1"></a>  data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb252-28"><a href="simulace3sigma.html#cb252-28" tabindex="-1"></a>  data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb252-29"><a href="simulace3sigma.html#cb252-29" tabindex="-1"></a>  </span>
<span id="cb252-30"><a href="simulace3sigma.html#cb252-30" tabindex="-1"></a>  <span class="co"># Build the model</span></span>
<span id="cb252-31"><a href="simulace3sigma.html#cb252-31" tabindex="-1"></a>  clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb252-32"><a href="simulace3sigma.html#cb252-32" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb252-33"><a href="simulace3sigma.html#cb252-33" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb252-34"><a href="simulace3sigma.html#cb252-34" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb252-35"><a href="simulace3sigma.html#cb252-35" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb252-36"><a href="simulace3sigma.html#cb252-36" tabindex="-1"></a>  </span>
<span id="cb252-37"><a href="simulace3sigma.html#cb252-37" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb252-38"><a href="simulace3sigma.html#cb252-38" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb252-39"><a href="simulace3sigma.html#cb252-39" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb252-40"><a href="simulace3sigma.html#cb252-40" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-41"><a href="simulace3sigma.html#cb252-41" tabindex="-1"></a>    </span>
<span id="cb252-42"><a href="simulace3sigma.html#cb252-42" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb252-43"><a href="simulace3sigma.html#cb252-43" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb252-44"><a href="simulace3sigma.html#cb252-44" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb252-45"><a href="simulace3sigma.html#cb252-45" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb252-46"><a href="simulace3sigma.html#cb252-46" tabindex="-1"></a>  </span>
<span id="cb252-47"><a href="simulace3sigma.html#cb252-47" tabindex="-1"></a>  <span class="co"># Store results</span></span>
<span id="cb252-48"><a href="simulace3sigma.html#cb252-48" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb252-49"><a href="simulace3sigma.html#cb252-49" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>The error rate of the SVM method applied to the basis coefficients on the training data is therefore 4.29 % for the linear kernel, 3.57 % for the polynomial kernel, and 5 % for the Gaussian kernel. On the test data, the error rates are 10 % for the linear kernel, 8.33 % for the polynomial kernel, and 10 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb253"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb253-1"><a href="simulace3sigma.html#cb253-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
<div id="RKHS-SVM" class="section level4 hasAnchor" number="2.3.6.5">
<h4><span class="header-section-number">2.3.6.5</span> RKHS + SVM<a href="simulace3sigma.html#RKHS-SVM" class="anchor-section" aria-label="Anchor link to header"></a></h4>
<div id="gaussian-kernel-1" class="section level6 hasAnchor" number="2.3.6.5.0.1">
<h6><span class="header-section-number">2.3.6.5.0.1</span> Gaussian Kernel<a href="simulace3sigma.html#gaussian-kernel-1" class="anchor-section" aria-label="Anchor link to header"></a></h6>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb254"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb254-1"><a href="simulace3sigma.html#cb254-1" tabindex="-1"></a><span class="co"># remove the last column, which contains the values of Y</span></span>
<span id="cb254-2"><a href="simulace3sigma.html#cb254-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb254-3"><a href="simulace3sigma.html#cb254-3" tabindex="-1"></a><span class="co"># also add test data</span></span>
<span id="cb254-4"><a href="simulace3sigma.html#cb254-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb254-5"><a href="simulace3sigma.html#cb254-5" tabindex="-1"></a></span>
<span id="cb254-6"><a href="simulace3sigma.html#cb254-6" tabindex="-1"></a><span class="co"># kernel and kernel matrix ... Gaussian with parameter gamma</span></span>
<span id="cb254-7"><a href="simulace3sigma.html#cb254-7" tabindex="-1"></a>Gauss.kernel <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, gamma) {</span>
<span id="cb254-8"><a href="simulace3sigma.html#cb254-8" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">exp</span>(<span class="sc">-</span>gamma <span class="sc">*</span> <span class="fu">norm</span>(<span class="fu">c</span>(x <span class="sc">-</span> y) <span class="sc">|&gt;</span> <span class="fu">t</span>(), <span class="at">type =</span> <span class="st">&#39;F&#39;</span>)))</span>
<span id="cb254-9"><a href="simulace3sigma.html#cb254-9" tabindex="-1"></a>}</span>
<span id="cb254-10"><a href="simulace3sigma.html#cb254-10" tabindex="-1"></a></span>
<span id="cb254-11"><a href="simulace3sigma.html#cb254-11" tabindex="-1"></a>Kernel.RKHS <span class="ot">&lt;-</span> <span class="cf">function</span>(x, gamma) {</span>
<span id="cb254-12"><a href="simulace3sigma.html#cb254-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(x), <span class="at">nrow =</span> <span class="fu">length</span>(x))</span>
<span id="cb254-13"><a href="simulace3sigma.html#cb254-13" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(K)) {</span>
<span id="cb254-14"><a href="simulace3sigma.html#cb254-14" tabindex="-1"></a>    <span class="cf">for</span>(j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(K)) {</span>
<span id="cb254-15"><a href="simulace3sigma.html#cb254-15" tabindex="-1"></a>      K[i, j] <span class="ot">&lt;-</span> <span class="fu">Gauss.kernel</span>(<span class="at">x =</span> x[i], <span class="at">y =</span> x[j], <span class="at">gamma =</span> gamma)</span>
<span id="cb254-16"><a href="simulace3sigma.html#cb254-16" tabindex="-1"></a>    }</span>
<span id="cb254-17"><a href="simulace3sigma.html#cb254-17" tabindex="-1"></a>  }</span>
<span id="cb254-18"><a href="simulace3sigma.html#cb254-18" tabindex="-1"></a>  <span class="fu">return</span>(K)</span>
<span id="cb254-19"><a href="simulace3sigma.html#cb254-19" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now let’s compute the matrix <span class="math inline">\(K_S\)</span> and its eigenvalues and corresponding eigenvectors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb255"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb255-1"><a href="simulace3sigma.html#cb255-1" tabindex="-1"></a><span class="co"># compute matrix K</span></span>
<span id="cb255-2"><a href="simulace3sigma.html#cb255-2" tabindex="-1"></a>gamma <span class="ot">&lt;-</span> <span class="fl">0.1</span> <span class="co"># fixed value of gamma, optimal determined using CV</span></span>
<span id="cb255-3"><a href="simulace3sigma.html#cb255-3" tabindex="-1"></a>K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb255-4"><a href="simulace3sigma.html#cb255-4" tabindex="-1"></a></span>
<span id="cb255-5"><a href="simulace3sigma.html#cb255-5" tabindex="-1"></a><span class="co"># determine eigenvalues and vectors</span></span>
<span id="cb255-6"><a href="simulace3sigma.html#cb255-6" tabindex="-1"></a>Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb255-7"><a href="simulace3sigma.html#cb255-7" tabindex="-1"></a>eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb255-8"><a href="simulace3sigma.html#cb255-8" tabindex="-1"></a>eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span></code></pre></div>
</details>
<p>To compute the coefficients in the representation of curves, that is, to compute the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^* = \left( \hat\lambda_{1l}^*, \dots, \hat\lambda_{\hat dl}^*\right)^\top, l = 1, 2, \dots, n\)</span>, we still need the coefficients from SVM. Unlike the classification problem, we are now solving a regression problem, as we are trying to express our observed curves in some (chosen by us using the kernel <span class="math inline">\(K\)</span>) basis. Therefore, we will use the <em>Support Vector Regression</em> method, from which we will subsequently obtain the coefficients <span class="math inline">\(\alpha_{il}\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb256"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb256-1"><a href="simulace3sigma.html#cb256-1" tabindex="-1"></a><span class="co"># determining coefficients alpha from SVM</span></span>
<span id="cb256-2"><a href="simulace3sigma.html#cb256-2" tabindex="-1"></a>alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb256-3"><a href="simulace3sigma.html#cb256-3" tabindex="-1"></a>                     <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb256-4"><a href="simulace3sigma.html#cb256-4" tabindex="-1"></a></span>
<span id="cb256-5"><a href="simulace3sigma.html#cb256-5" tabindex="-1"></a><span class="co"># model</span></span>
<span id="cb256-6"><a href="simulace3sigma.html#cb256-6" tabindex="-1"></a><span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb256-7"><a href="simulace3sigma.html#cb256-7" tabindex="-1"></a>  df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb256-8"><a href="simulace3sigma.html#cb256-8" tabindex="-1"></a>                       <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb256-9"><a href="simulace3sigma.html#cb256-9" tabindex="-1"></a>  svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb256-10"><a href="simulace3sigma.html#cb256-10" tabindex="-1"></a>                  <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb256-11"><a href="simulace3sigma.html#cb256-11" tabindex="-1"></a>                  <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb256-12"><a href="simulace3sigma.html#cb256-12" tabindex="-1"></a>                  <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb256-13"><a href="simulace3sigma.html#cb256-13" tabindex="-1"></a>                  <span class="at">gamma =</span> gamma)</span>
<span id="cb256-14"><a href="simulace3sigma.html#cb256-14" tabindex="-1"></a>  <span class="co"># determining alpha</span></span>
<span id="cb256-15"><a href="simulace3sigma.html#cb256-15" tabindex="-1"></a>  alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb256-16"><a href="simulace3sigma.html#cb256-16" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we can compute the representations of the individual curves. First, let’s take <span class="math inline">\(\hat d\)</span> as the full dimension, i.e., <span class="math inline">\(\hat d = m ={}\)</span> 101, and then determine the optimal <span class="math inline">\(\hat d\)</span> using cross-validation.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb257"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb257-1"><a href="simulace3sigma.html#cb257-1" tabindex="-1"></a><span class="co"># d</span></span>
<span id="cb257-2"><a href="simulace3sigma.html#cb257-2" tabindex="-1"></a>d.RKHS <span class="ot">&lt;-</span> <span class="fu">dim</span>(alpha.RKHS)[<span class="dv">1</span>]</span>
<span id="cb257-3"><a href="simulace3sigma.html#cb257-3" tabindex="-1"></a></span>
<span id="cb257-4"><a href="simulace3sigma.html#cb257-4" tabindex="-1"></a><span class="co"># determining the lambda vector</span></span>
<span id="cb257-5"><a href="simulace3sigma.html#cb257-5" tabindex="-1"></a>Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb257-6"><a href="simulace3sigma.html#cb257-6" tabindex="-1"></a>                      <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb257-7"><a href="simulace3sigma.html#cb257-7" tabindex="-1"></a>                      <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb257-8"><a href="simulace3sigma.html#cb257-8" tabindex="-1"></a></span>
<span id="cb257-9"><a href="simulace3sigma.html#cb257-9" tabindex="-1"></a><span class="co"># computation of the representation</span></span>
<span id="cb257-10"><a href="simulace3sigma.html#cb257-10" tabindex="-1"></a><span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb257-11"><a href="simulace3sigma.html#cb257-11" tabindex="-1"></a>  Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb257-12"><a href="simulace3sigma.html#cb257-12" tabindex="-1"></a>}</span></code></pre></div>
</details>
<p>Now we have stored the vectors <span class="math inline">\(\hat{\boldsymbol \lambda}_l^*, l = 1, 2, \dots, n\)</span> for each curve in the columns of the matrix <code>Lambda.RKHS</code>. We will now use these vectors as the representation of the given curves and classify the data according to this discretization.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb258"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb258-1"><a href="simulace3sigma.html#cb258-1" tabindex="-1"></a><span class="co"># splitting into training and testing data</span></span>
<span id="cb258-2"><a href="simulace3sigma.html#cb258-2" tabindex="-1"></a>XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb258-3"><a href="simulace3sigma.html#cb258-3" tabindex="-1"></a>XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb258-4"><a href="simulace3sigma.html#cb258-4" tabindex="-1"></a></span>
<span id="cb258-5"><a href="simulace3sigma.html#cb258-5" tabindex="-1"></a><span class="co"># preparing a data table to store results</span></span>
<span id="cb258-6"><a href="simulace3sigma.html#cb258-6" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb258-7"><a href="simulace3sigma.html#cb258-7" tabindex="-1"></a>                            <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb258-8"><a href="simulace3sigma.html#cb258-8" tabindex="-1"></a>                            <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb258-9"><a href="simulace3sigma.html#cb258-9" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb258-10"><a href="simulace3sigma.html#cb258-10" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb258-11"><a href="simulace3sigma.html#cb258-11" tabindex="-1"></a></span>
<span id="cb258-12"><a href="simulace3sigma.html#cb258-12" tabindex="-1"></a><span class="co"># iterating over individual kernels</span></span>
<span id="cb258-13"><a href="simulace3sigma.html#cb258-13" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb258-14"><a href="simulace3sigma.html#cb258-14" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb258-15"><a href="simulace3sigma.html#cb258-15" tabindex="-1"></a></span>
<span id="cb258-16"><a href="simulace3sigma.html#cb258-16" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb258-17"><a href="simulace3sigma.html#cb258-17" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb258-18"><a href="simulace3sigma.html#cb258-18" tabindex="-1"></a>  </span>
<span id="cb258-19"><a href="simulace3sigma.html#cb258-19" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb258-20"><a href="simulace3sigma.html#cb258-20" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb258-21"><a href="simulace3sigma.html#cb258-21" tabindex="-1"></a>  </span>
<span id="cb258-22"><a href="simulace3sigma.html#cb258-22" tabindex="-1"></a>  <span class="co"># building models</span></span>
<span id="cb258-23"><a href="simulace3sigma.html#cb258-23" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb258-24"><a href="simulace3sigma.html#cb258-24" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb258-25"><a href="simulace3sigma.html#cb258-25" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb258-26"><a href="simulace3sigma.html#cb258-26" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb258-27"><a href="simulace3sigma.html#cb258-27" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb258-28"><a href="simulace3sigma.html#cb258-28" tabindex="-1"></a>  </span>
<span id="cb258-29"><a href="simulace3sigma.html#cb258-29" tabindex="-1"></a>  <span class="co"># accuracy on training data</span></span>
<span id="cb258-30"><a href="simulace3sigma.html#cb258-30" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb258-31"><a href="simulace3sigma.html#cb258-31" tabindex="-1"></a>  accuracy.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb258-32"><a href="simulace3sigma.html#cb258-32" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb258-33"><a href="simulace3sigma.html#cb258-33" tabindex="-1"></a>    </span>
<span id="cb258-34"><a href="simulace3sigma.html#cb258-34" tabindex="-1"></a>  <span class="co"># accuracy on testing data</span></span>
<span id="cb258-35"><a href="simulace3sigma.html#cb258-35" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb258-36"><a href="simulace3sigma.html#cb258-36" tabindex="-1"></a>  accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb258-37"><a href="simulace3sigma.html#cb258-37" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb258-38"><a href="simulace3sigma.html#cb258-38" tabindex="-1"></a>  </span>
<span id="cb258-39"><a href="simulace3sigma.html#cb258-39" tabindex="-1"></a>  <span class="co"># storing results</span></span>
<span id="cb258-40"><a href="simulace3sigma.html#cb258-40" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(accuracy.train, accuracy.test)</span>
<span id="cb258-41"><a href="simulace3sigma.html#cb258-41" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-76">Table 2.1: </span>Summary results of the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> the testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS</td>
<td align="center">0.1000</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS</td>
<td align="center">0.0286</td>
<td align="center">0.3000</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS</td>
<td align="center">0.0786</td>
<td align="center">0.2667</td>
</tr>
</tbody>
</table>
<p>We can see that the model classifies the training data very well for all three kernels, while its performance on the test data is not good at all. It is evident that overfitting has occurred; therefore, we will use cross-validation to determine the optimal values of <span class="math inline">\(\gamma\)</span> and <span class="math inline">\(d\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb259"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb259-1"><a href="simulace3sigma.html#cb259-1" tabindex="-1"></a><span class="co"># splitting training data into k parts</span></span>
<span id="cb259-2"><a href="simulace3sigma.html#cb259-2" tabindex="-1"></a>folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb259-3"><a href="simulace3sigma.html#cb259-3" tabindex="-1"></a><span class="co"># remove the last column, which contains the values of Y</span></span>
<span id="cb259-4"><a href="simulace3sigma.html#cb259-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb259-5"><a href="simulace3sigma.html#cb259-5" tabindex="-1"></a></span>
<span id="cb259-6"><a href="simulace3sigma.html#cb259-6" tabindex="-1"></a><span class="co"># hyperparameter values that we will iterate over</span></span>
<span id="cb259-7"><a href="simulace3sigma.html#cb259-7" tabindex="-1"></a>dimensions <span class="ot">&lt;-</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">40</span> <span class="co"># reasonable range of values for d</span></span>
<span id="cb259-8"><a href="simulace3sigma.html#cb259-8" tabindex="-1"></a>gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">15</span>)</span>
<span id="cb259-9"><a href="simulace3sigma.html#cb259-9" tabindex="-1"></a></span>
<span id="cb259-10"><a href="simulace3sigma.html#cb259-10" tabindex="-1"></a><span class="co"># list with three components ... array for individual kernels -&gt; linear, poly, radial</span></span>
<span id="cb259-11"><a href="simulace3sigma.html#cb259-11" tabindex="-1"></a><span class="co"># empty matrix to store individual results</span></span>
<span id="cb259-12"><a href="simulace3sigma.html#cb259-12" tabindex="-1"></a><span class="co"># columns will hold accuracy values for the respective gamma</span></span>
<span id="cb259-13"><a href="simulace3sigma.html#cb259-13" tabindex="-1"></a><span class="co"># rows will hold values for the respective folds</span></span>
<span id="cb259-14"><a href="simulace3sigma.html#cb259-14" tabindex="-1"></a>dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb259-15"><a href="simulace3sigma.html#cb259-15" tabindex="-1"></a>                  <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb259-16"><a href="simulace3sigma.html#cb259-16" tabindex="-1"></a>                  <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb259-17"><a href="simulace3sigma.html#cb259-17" tabindex="-1"></a></span>
<span id="cb259-18"><a href="simulace3sigma.html#cb259-18" tabindex="-1"></a>CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb259-19"><a href="simulace3sigma.html#cb259-19" tabindex="-1"></a>  <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb259-20"><a href="simulace3sigma.html#cb259-20" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb259-21"><a href="simulace3sigma.html#cb259-21" tabindex="-1"></a>  <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb259-22"><a href="simulace3sigma.html#cb259-22" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names),</span>
<span id="cb259-23"><a href="simulace3sigma.html#cb259-23" tabindex="-1"></a>  <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb259-24"><a href="simulace3sigma.html#cb259-24" tabindex="-1"></a>                <span class="at">dimnames =</span> dim.names))</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb260"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb260-1"><a href="simulace3sigma.html#cb260-1" tabindex="-1"></a><span class="co"># actual CV</span></span>
<span id="cb260-2"><a href="simulace3sigma.html#cb260-2" tabindex="-1"></a><span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb260-3"><a href="simulace3sigma.html#cb260-3" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb260-4"><a href="simulace3sigma.html#cb260-4" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb260-5"><a href="simulace3sigma.html#cb260-5" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb260-6"><a href="simulace3sigma.html#cb260-6" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb260-7"><a href="simulace3sigma.html#cb260-7" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb260-8"><a href="simulace3sigma.html#cb260-8" tabindex="-1"></a>  </span>
<span id="cb260-9"><a href="simulace3sigma.html#cb260-9" tabindex="-1"></a>  <span class="co"># model</span></span>
<span id="cb260-10"><a href="simulace3sigma.html#cb260-10" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb260-11"><a href="simulace3sigma.html#cb260-11" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb260-12"><a href="simulace3sigma.html#cb260-12" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb260-13"><a href="simulace3sigma.html#cb260-13" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb260-14"><a href="simulace3sigma.html#cb260-14" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb260-15"><a href="simulace3sigma.html#cb260-15" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb260-16"><a href="simulace3sigma.html#cb260-16" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb260-17"><a href="simulace3sigma.html#cb260-17" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb260-18"><a href="simulace3sigma.html#cb260-18" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb260-19"><a href="simulace3sigma.html#cb260-19" tabindex="-1"></a>  }</span>
<span id="cb260-20"><a href="simulace3sigma.html#cb260-20" tabindex="-1"></a>  </span>
<span id="cb260-21"><a href="simulace3sigma.html#cb260-21" tabindex="-1"></a>  <span class="co"># iterating over dimensions</span></span>
<span id="cb260-22"><a href="simulace3sigma.html#cb260-22" tabindex="-1"></a>  <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb260-23"><a href="simulace3sigma.html#cb260-23" tabindex="-1"></a>    Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb260-24"><a href="simulace3sigma.html#cb260-24" tabindex="-1"></a>                          <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb260-25"><a href="simulace3sigma.html#cb260-25" tabindex="-1"></a>                          <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb260-26"><a href="simulace3sigma.html#cb260-26" tabindex="-1"></a>    <span class="co"># compute representation</span></span>
<span id="cb260-27"><a href="simulace3sigma.html#cb260-27" tabindex="-1"></a>    <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb260-28"><a href="simulace3sigma.html#cb260-28" tabindex="-1"></a>      Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb260-29"><a href="simulace3sigma.html#cb260-29" tabindex="-1"></a>                             alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb260-30"><a href="simulace3sigma.html#cb260-30" tabindex="-1"></a>    }</span>
<span id="cb260-31"><a href="simulace3sigma.html#cb260-31" tabindex="-1"></a>    <span class="co"># iterate over folds</span></span>
<span id="cb260-32"><a href="simulace3sigma.html#cb260-32" tabindex="-1"></a>    <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb260-33"><a href="simulace3sigma.html#cb260-33" tabindex="-1"></a>      <span class="co"># define test and training parts for CV</span></span>
<span id="cb260-34"><a href="simulace3sigma.html#cb260-34" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb260-35"><a href="simulace3sigma.html#cb260-35" tabindex="-1"></a>      <span class="co"># split into training and validation data</span></span>
<span id="cb260-36"><a href="simulace3sigma.html#cb260-36" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb260-37"><a href="simulace3sigma.html#cb260-37" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb260-38"><a href="simulace3sigma.html#cb260-38" tabindex="-1"></a>      <span class="co"># prepare a data table to store results</span></span>
<span id="cb260-39"><a href="simulace3sigma.html#cb260-39" tabindex="-1"></a>      Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb260-40"><a href="simulace3sigma.html#cb260-40" tabindex="-1"></a>                                  <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb260-41"><a href="simulace3sigma.html#cb260-41" tabindex="-1"></a>                                  <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb260-42"><a href="simulace3sigma.html#cb260-42" tabindex="-1"></a>                        <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb260-43"><a href="simulace3sigma.html#cb260-43" tabindex="-1"></a>      <span class="co"># iterate over individual kernels</span></span>
<span id="cb260-44"><a href="simulace3sigma.html#cb260-44" tabindex="-1"></a>      <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb260-45"><a href="simulace3sigma.html#cb260-45" tabindex="-1"></a>        kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb260-46"><a href="simulace3sigma.html#cb260-46" tabindex="-1"></a>      </span>
<span id="cb260-47"><a href="simulace3sigma.html#cb260-47" tabindex="-1"></a>        data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb260-48"><a href="simulace3sigma.html#cb260-48" tabindex="-1"></a>        data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb260-49"><a href="simulace3sigma.html#cb260-49" tabindex="-1"></a>        </span>
<span id="cb260-50"><a href="simulace3sigma.html#cb260-50" tabindex="-1"></a>        data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb260-51"><a href="simulace3sigma.html#cb260-51" tabindex="-1"></a>        data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb260-52"><a href="simulace3sigma.html#cb260-52" tabindex="-1"></a>        </span>
<span id="cb260-53"><a href="simulace3sigma.html#cb260-53" tabindex="-1"></a>        <span class="co"># building models</span></span>
<span id="cb260-54"><a href="simulace3sigma.html#cb260-54" tabindex="-1"></a>        clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb260-55"><a href="simulace3sigma.html#cb260-55" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb260-56"><a href="simulace3sigma.html#cb260-56" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb260-57"><a href="simulace3sigma.html#cb260-57" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb260-58"><a href="simulace3sigma.html#cb260-58" tabindex="-1"></a>                            <span class="at">kernel =</span> kernel_type)</span>
<span id="cb260-59"><a href="simulace3sigma.html#cb260-59" tabindex="-1"></a>        </span>
<span id="cb260-60"><a href="simulace3sigma.html#cb260-60" tabindex="-1"></a>        <span class="co"># accuracy on validation data</span></span>
<span id="cb260-61"><a href="simulace3sigma.html#cb260-61" tabindex="-1"></a>        predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb260-62"><a href="simulace3sigma.html#cb260-62" tabindex="-1"></a>        accuracy.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb260-63"><a href="simulace3sigma.html#cb260-63" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb260-64"><a href="simulace3sigma.html#cb260-64" tabindex="-1"></a>        </span>
<span id="cb260-65"><a href="simulace3sigma.html#cb260-65" tabindex="-1"></a>        <span class="co"># storing results</span></span>
<span id="cb260-66"><a href="simulace3sigma.html#cb260-66" tabindex="-1"></a>        Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> accuracy.test</span>
<span id="cb260-67"><a href="simulace3sigma.html#cb260-67" tabindex="-1"></a>      }</span>
<span id="cb260-68"><a href="simulace3sigma.html#cb260-68" tabindex="-1"></a>      <span class="co"># store accuracies at positions for the respective d, gamma, and fold</span></span>
<span id="cb260-69"><a href="simulace3sigma.html#cb260-69" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb260-70"><a href="simulace3sigma.html#cb260-70" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb260-71"><a href="simulace3sigma.html#cb260-71" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb260-72"><a href="simulace3sigma.html#cb260-72" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb260-73"><a href="simulace3sigma.html#cb260-73" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb260-74"><a href="simulace3sigma.html#cb260-74" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb260-75"><a href="simulace3sigma.html#cb260-75" tabindex="-1"></a>      CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb260-76"><a href="simulace3sigma.html#cb260-76" tabindex="-1"></a>                       d.RKHS <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, </span>
<span id="cb260-77"><a href="simulace3sigma.html#cb260-77" tabindex="-1"></a>                       index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb260-78"><a href="simulace3sigma.html#cb260-78" tabindex="-1"></a>    }</span>
<span id="cb260-79"><a href="simulace3sigma.html#cb260-79" tabindex="-1"></a>  }</span>
<span id="cb260-80"><a href="simulace3sigma.html#cb260-80" tabindex="-1"></a>}</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb261"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb261-1"><a href="simulace3sigma.html#cb261-1" tabindex="-1"></a><span class="co"># Calculate average accuracies for each method across folds</span></span>
<span id="cb261-2"><a href="simulace3sigma.html#cb261-2" tabindex="-1"></a><span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb261-3"><a href="simulace3sigma.html#cb261-3" tabindex="-1"></a>  CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb261-4"><a href="simulace3sigma.html#cb261-4" tabindex="-1"></a>}</span>
<span id="cb261-5"><a href="simulace3sigma.html#cb261-5" tabindex="-1"></a></span>
<span id="cb261-6"><a href="simulace3sigma.html#cb261-6" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb261-7"><a href="simulace3sigma.html#cb261-7" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb261-8"><a href="simulace3sigma.html#cb261-8" tabindex="-1"></a>               <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb261-9"><a href="simulace3sigma.html#cb261-9" tabindex="-1"></a>gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb261-10"><a href="simulace3sigma.html#cb261-10" tabindex="-1"></a>gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb261-11"><a href="simulace3sigma.html#cb261-11" tabindex="-1"></a></span>
<span id="cb261-12"><a href="simulace3sigma.html#cb261-12" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb261-13"><a href="simulace3sigma.html#cb261-13" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb261-14"><a href="simulace3sigma.html#cb261-14" tabindex="-1"></a>           <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb261-15"><a href="simulace3sigma.html#cb261-15" tabindex="-1"></a>d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb261-16"><a href="simulace3sigma.html#cb261-16" tabindex="-1"></a>d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb261-17"><a href="simulace3sigma.html#cb261-17" tabindex="-1"></a></span>
<span id="cb261-18"><a href="simulace3sigma.html#cb261-18" tabindex="-1"></a>err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb261-19"><a href="simulace3sigma.html#cb261-19" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb261-20"><a href="simulace3sigma.html#cb261-20" tabindex="-1"></a>                 <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb261-21"><a href="simulace3sigma.html#cb261-21" tabindex="-1"></a>df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb261-22"><a href="simulace3sigma.html#cb261-22" tabindex="-1"></a>                           <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb261-23"><a href="simulace3sigma.html#cb261-23" tabindex="-1"></a>                           <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-79">Table 2.2: </span>Summary results of cross-validation for the SVM method combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates testing error.</caption>
<thead>
<tr class="header">
<th></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad d\)</span></th>
<th align="right"><span class="math inline">\(\quad\quad\quad\quad\quad\gamma\)</span></th>
<th align="right"><span class="math inline">\(\widehat{Err}_{cross\_validation}\)</span></th>
<th align="left">Model</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>linear</td>
<td align="right">10</td>
<td align="right">13.8950</td>
<td align="right">0.0630</td>
<td align="left">linear</td>
</tr>
<tr class="even">
<td>poly</td>
<td align="right">19</td>
<td align="right">22.7585</td>
<td align="right">0.0912</td>
<td align="left">polynomial</td>
</tr>
<tr class="odd">
<td>radial</td>
<td align="right">40</td>
<td align="right">0.4394</td>
<td align="right">0.1016</td>
<td align="left">radial</td>
</tr>
</tbody>
</table>
<p>We see that the optimal parameter value is <span class="math inline">\(d={}\)</span> 10 and <span class="math inline">\(\gamma={}\)</span> 13.895 for the linear kernel, with an error rate computed using 10-fold CV of 0.063. For the polynomial kernel, <span class="math inline">\(d={}\)</span> 19 and <span class="math inline">\(\gamma={}\)</span> 22.7585 yield an error rate of 0.0912, and for the radial kernel, <span class="math inline">\(d={}\)</span> 40 and <span class="math inline">\(\gamma={}\)</span> 0.4394 yield an error rate of 0.1016.<br />
For interest, let’s plot the validation error as a function of dimension <span class="math inline">\(d\)</span> and the hyperparameter <span class="math inline">\(\gamma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb262"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb262-1"><a href="simulace3sigma.html#cb262-1" tabindex="-1"></a>CV.results.plot <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> <span class="fu">rep</span>(dimensions <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>), <span class="at">each =</span> <span class="fu">length</span>(gamma.cv)), </span>
<span id="cb262-2"><a href="simulace3sigma.html#cb262-2" tabindex="-1"></a>                              <span class="at">gamma =</span> <span class="fu">rep</span>(gamma.cv, <span class="fu">length</span>(dimensions)) <span class="sc">|&gt;</span> <span class="fu">rep</span>(<span class="dv">3</span>),</span>
<span id="cb262-3"><a href="simulace3sigma.html#cb262-3" tabindex="-1"></a>                              <span class="at">CV =</span> <span class="fu">c</span>(<span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb262-4"><a href="simulace3sigma.html#cb262-4" tabindex="-1"></a>                                     <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.p), </span>
<span id="cb262-5"><a href="simulace3sigma.html#cb262-5" tabindex="-1"></a>                                     <span class="fu">c</span>(CV.results<span class="sc">$</span>SVM.r)),</span>
<span id="cb262-6"><a href="simulace3sigma.html#cb262-6" tabindex="-1"></a>                              <span class="at">Kernel =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>), </span>
<span id="cb262-7"><a href="simulace3sigma.html#cb262-7" tabindex="-1"></a>                                           <span class="at">each =</span> <span class="fu">length</span>(dimensions) <span class="sc">*</span> </span>
<span id="cb262-8"><a href="simulace3sigma.html#cb262-8" tabindex="-1"></a>                                             <span class="fu">length</span>(gamma.cv)) <span class="sc">|&gt;</span> <span class="fu">factor</span>())</span>
<span id="cb262-9"><a href="simulace3sigma.html#cb262-9" tabindex="-1"></a>CV.results.plot <span class="sc">|&gt;</span> </span>
<span id="cb262-10"><a href="simulace3sigma.html#cb262-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma, <span class="at">z =</span> CV)) <span class="sc">+</span> </span>
<span id="cb262-11"><a href="simulace3sigma.html#cb262-11" tabindex="-1"></a>  <span class="fu">geom_contour_filled</span>() <span class="sc">+</span></span>
<span id="cb262-12"><a href="simulace3sigma.html#cb262-12" tabindex="-1"></a>  <span class="fu">scale_y_continuous</span>(<span class="at">trans=</span><span class="st">&#39;log10&#39;</span>) <span class="sc">+</span></span>
<span id="cb262-13"><a href="simulace3sigma.html#cb262-13" tabindex="-1"></a>  <span class="fu">facet_wrap</span>(<span class="sc">~</span>Kernel) <span class="sc">+</span></span>
<span id="cb262-14"><a href="simulace3sigma.html#cb262-14" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb262-15"><a href="simulace3sigma.html#cb262-15" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(d),</span>
<span id="cb262-16"><a href="simulace3sigma.html#cb262-16" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(gamma)) <span class="sc">+</span> </span>
<span id="cb262-17"><a href="simulace3sigma.html#cb262-17" tabindex="-1"></a>  <span class="fu">scale_fill_brewer</span>(<span class="at">palette =</span> <span class="st">&quot;Spectral&quot;</span>) <span class="sc">+</span> </span>
<span id="cb262-18"><a href="simulace3sigma.html#cb262-18" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">data =</span> df.RKHS.res, <span class="fu">aes</span>(<span class="at">x =</span> d, <span class="at">y =</span> gamma),</span>
<span id="cb262-19"><a href="simulace3sigma.html#cb262-19" tabindex="-1"></a>             <span class="at">size =</span> <span class="dv">5</span>, <span class="at">pch =</span> <span class="st">&#39;+&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-80"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-80-1.png" alt="Dependence of validation error on the choice of hyperparameters $d$ and $\gamma$, separately for all three considered kernels in the SVM method." width="672" />
<p class="caption">
Figure 2.12: Dependence of validation error on the choice of hyperparameters <span class="math inline">\(d\)</span> and <span class="math inline">\(\gamma\)</span>, separately for all three considered kernels in the SVM method.
</p>
</div>
<p>Since we have already found the optimal hyperparameter values, we can construct the final models and determine their classification success on the test data.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb263"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb263-1"><a href="simulace3sigma.html#cb263-1" tabindex="-1"></a><span class="co"># Remove the last column, which contains the Y values</span></span>
<span id="cb263-2"><a href="simulace3sigma.html#cb263-2" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb263-3"><a href="simulace3sigma.html#cb263-3" tabindex="-1"></a><span class="co"># Add the test data as well</span></span>
<span id="cb263-4"><a href="simulace3sigma.html#cb263-4" tabindex="-1"></a>data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb264"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb264-1"><a href="simulace3sigma.html#cb264-1" tabindex="-1"></a><span class="co"># Prepare a data table to store results</span></span>
<span id="cb264-2"><a href="simulace3sigma.html#cb264-2" tabindex="-1"></a>Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb264-3"><a href="simulace3sigma.html#cb264-3" tabindex="-1"></a>                             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb264-4"><a href="simulace3sigma.html#cb264-4" tabindex="-1"></a>                             <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb264-5"><a href="simulace3sigma.html#cb264-5" tabindex="-1"></a>                  <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb264-6"><a href="simulace3sigma.html#cb264-6" tabindex="-1"></a>                  <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb264-7"><a href="simulace3sigma.html#cb264-7" tabindex="-1"></a></span>
<span id="cb264-8"><a href="simulace3sigma.html#cb264-8" tabindex="-1"></a><span class="co"># Iterate over the different kernels</span></span>
<span id="cb264-9"><a href="simulace3sigma.html#cb264-9" tabindex="-1"></a><span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb264-10"><a href="simulace3sigma.html#cb264-10" tabindex="-1"></a>  <span class="co"># Calculate the matrix K</span></span>
<span id="cb264-11"><a href="simulace3sigma.html#cb264-11" tabindex="-1"></a>  gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># gamma value from CV</span></span>
<span id="cb264-12"><a href="simulace3sigma.html#cb264-12" tabindex="-1"></a>  K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb264-13"><a href="simulace3sigma.html#cb264-13" tabindex="-1"></a>  </span>
<span id="cb264-14"><a href="simulace3sigma.html#cb264-14" tabindex="-1"></a>  <span class="co"># Determine eigenvalues and eigenvectors</span></span>
<span id="cb264-15"><a href="simulace3sigma.html#cb264-15" tabindex="-1"></a>  Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb264-16"><a href="simulace3sigma.html#cb264-16" tabindex="-1"></a>  eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb264-17"><a href="simulace3sigma.html#cb264-17" tabindex="-1"></a>  eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb264-18"><a href="simulace3sigma.html#cb264-18" tabindex="-1"></a>  <span class="co"># Determine coefficients alpha from SVM</span></span>
<span id="cb264-19"><a href="simulace3sigma.html#cb264-19" tabindex="-1"></a>  alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb264-20"><a href="simulace3sigma.html#cb264-20" tabindex="-1"></a>                       <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># empty object</span></span>
<span id="cb264-21"><a href="simulace3sigma.html#cb264-21" tabindex="-1"></a>  </span>
<span id="cb264-22"><a href="simulace3sigma.html#cb264-22" tabindex="-1"></a>  <span class="co"># Model</span></span>
<span id="cb264-23"><a href="simulace3sigma.html#cb264-23" tabindex="-1"></a>  <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb264-24"><a href="simulace3sigma.html#cb264-24" tabindex="-1"></a>    df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb264-25"><a href="simulace3sigma.html#cb264-25" tabindex="-1"></a>                         <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb264-26"><a href="simulace3sigma.html#cb264-26" tabindex="-1"></a>    svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb264-27"><a href="simulace3sigma.html#cb264-27" tabindex="-1"></a>                    <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb264-28"><a href="simulace3sigma.html#cb264-28" tabindex="-1"></a>                    <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb264-29"><a href="simulace3sigma.html#cb264-29" tabindex="-1"></a>                    <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb264-30"><a href="simulace3sigma.html#cb264-30" tabindex="-1"></a>                    <span class="at">gamma =</span> gamma)</span>
<span id="cb264-31"><a href="simulace3sigma.html#cb264-31" tabindex="-1"></a>    <span class="co"># Determine alpha</span></span>
<span id="cb264-32"><a href="simulace3sigma.html#cb264-32" tabindex="-1"></a>    alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># replace zeros with coefficients</span></span>
<span id="cb264-33"><a href="simulace3sigma.html#cb264-33" tabindex="-1"></a>  }</span>
<span id="cb264-34"><a href="simulace3sigma.html#cb264-34" tabindex="-1"></a>  </span>
<span id="cb264-35"><a href="simulace3sigma.html#cb264-35" tabindex="-1"></a>  <span class="co"># d</span></span>
<span id="cb264-36"><a href="simulace3sigma.html#cb264-36" tabindex="-1"></a>  d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb264-37"><a href="simulace3sigma.html#cb264-37" tabindex="-1"></a>  </span>
<span id="cb264-38"><a href="simulace3sigma.html#cb264-38" tabindex="-1"></a>  <span class="co"># Determine the lambda vector</span></span>
<span id="cb264-39"><a href="simulace3sigma.html#cb264-39" tabindex="-1"></a>  Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb264-40"><a href="simulace3sigma.html#cb264-40" tabindex="-1"></a>                        <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb264-41"><a href="simulace3sigma.html#cb264-41" tabindex="-1"></a>                        <span class="at">nrow =</span> d.RKHS) <span class="co"># create an empty object</span></span>
<span id="cb264-42"><a href="simulace3sigma.html#cb264-42" tabindex="-1"></a>  </span>
<span id="cb264-43"><a href="simulace3sigma.html#cb264-43" tabindex="-1"></a>  <span class="co"># Calculate representation</span></span>
<span id="cb264-44"><a href="simulace3sigma.html#cb264-44" tabindex="-1"></a>  <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb264-45"><a href="simulace3sigma.html#cb264-45" tabindex="-1"></a>    Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb264-46"><a href="simulace3sigma.html#cb264-46" tabindex="-1"></a>  }</span>
<span id="cb264-47"><a href="simulace3sigma.html#cb264-47" tabindex="-1"></a>  </span>
<span id="cb264-48"><a href="simulace3sigma.html#cb264-48" tabindex="-1"></a>  <span class="co"># Split into training and test data</span></span>
<span id="cb264-49"><a href="simulace3sigma.html#cb264-49" tabindex="-1"></a>  XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb264-50"><a href="simulace3sigma.html#cb264-50" tabindex="-1"></a>  XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb264-51"><a href="simulace3sigma.html#cb264-51" tabindex="-1"></a></span>
<span id="cb264-52"><a href="simulace3sigma.html#cb264-52" tabindex="-1"></a>  kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb264-53"><a href="simulace3sigma.html#cb264-53" tabindex="-1"></a></span>
<span id="cb264-54"><a href="simulace3sigma.html#cb264-54" tabindex="-1"></a>  data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb264-55"><a href="simulace3sigma.html#cb264-55" tabindex="-1"></a>  data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb264-56"><a href="simulace3sigma.html#cb264-56" tabindex="-1"></a>  </span>
<span id="cb264-57"><a href="simulace3sigma.html#cb264-57" tabindex="-1"></a>  data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb264-58"><a href="simulace3sigma.html#cb264-58" tabindex="-1"></a>  data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb264-59"><a href="simulace3sigma.html#cb264-59" tabindex="-1"></a>  </span>
<span id="cb264-60"><a href="simulace3sigma.html#cb264-60" tabindex="-1"></a>  <span class="co"># Model construction</span></span>
<span id="cb264-61"><a href="simulace3sigma.html#cb264-61" tabindex="-1"></a>  clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb264-62"><a href="simulace3sigma.html#cb264-62" tabindex="-1"></a>                      <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb264-63"><a href="simulace3sigma.html#cb264-63" tabindex="-1"></a>                      <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb264-64"><a href="simulace3sigma.html#cb264-64" tabindex="-1"></a>                      <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb264-65"><a href="simulace3sigma.html#cb264-65" tabindex="-1"></a>                      <span class="at">kernel =</span> kernel_type)</span>
<span id="cb264-66"><a href="simulace3sigma.html#cb264-66" tabindex="-1"></a>  </span>
<span id="cb264-67"><a href="simulace3sigma.html#cb264-67" tabindex="-1"></a>  <span class="co"># Accuracy on training data</span></span>
<span id="cb264-68"><a href="simulace3sigma.html#cb264-68" tabindex="-1"></a>  predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb264-69"><a href="simulace3sigma.html#cb264-69" tabindex="-1"></a>  presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb264-70"><a href="simulace3sigma.html#cb264-70" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb264-71"><a href="simulace3sigma.html#cb264-71" tabindex="-1"></a>    </span>
<span id="cb264-72"><a href="simulace3sigma.html#cb264-72" tabindex="-1"></a>  <span class="co"># Accuracy on test data</span></span>
<span id="cb264-73"><a href="simulace3sigma.html#cb264-73" tabindex="-1"></a>  predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb264-74"><a href="simulace3sigma.html#cb264-74" tabindex="-1"></a>  presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb264-75"><a href="simulace3sigma.html#cb264-75" tabindex="-1"></a>    <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb264-76"><a href="simulace3sigma.html#cb264-76" tabindex="-1"></a>  </span>
<span id="cb264-77"><a href="simulace3sigma.html#cb264-77" tabindex="-1"></a>  <span class="co"># Save results</span></span>
<span id="cb264-78"><a href="simulace3sigma.html#cb264-78" tabindex="-1"></a>  Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb264-79"><a href="simulace3sigma.html#cb264-79" tabindex="-1"></a>}</span></code></pre></div>
</details>
<table>
<caption><span id="tab:unnamed-chunk-83">Table 2.3: </span>Summary of SVM method results combined with RKHS on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> indicates the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> indicates testing error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0571</td>
<td align="center">0.1333</td>
</tr>
<tr class="even">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.1500</td>
</tr>
</tbody>
</table>
<p>The error rate of the SVM method combined with projection onto the Reproducing Kernel Hilbert Space is therefore 5.71 % on the training data for the linear kernel, 5.71 % for the polynomial kernel, and 1.43 % for the Gaussian kernel. On the test data, the error rate of the method is 13.33 % for the linear kernel, 16.67 % for the polynomial kernel, and 15 % for the radial kernel.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb265"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb265-1"><a href="simulace3sigma.html#cb265-1" tabindex="-1"></a>RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span></code></pre></div>
</details>
</div>
</div>
</div>
<div id="results-table" class="section level3 hasAnchor" number="2.3.7">
<h3><span class="header-section-number">2.3.7</span> Results Table<a href="simulace3sigma.html#results-table" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<table>
<caption><span id="tab:unnamed-chunk-85">Table 2.4: </span>Summary of the methods used on simulated data. <span class="math inline">\(\widehat{Err}_{train}\)</span> denotes the estimate of training error and <span class="math inline">\(\widehat{Err}_{test}\)</span> denotes test error.</caption>
<thead>
<tr class="header">
<th align="left">Model</th>
<th align="center"><span class="math inline">\(\widehat{Err}_{train}\quad\quad\quad\quad\quad\)</span></th>
<th align="center"><span class="math inline">\(\widehat{Err}_{test}\quad\quad\quad\quad\quad\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">KNN</td>
<td align="center">0.3571</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">LDA</td>
<td align="center">0.4143</td>
<td align="center">0.4000</td>
</tr>
<tr class="odd">
<td align="left">QDA</td>
<td align="center">0.3571</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">LR functional</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">RForest - discretization</td>
<td align="center">0.0000</td>
<td align="center">0.3833</td>
</tr>
<tr class="even">
<td align="left">RForest - score</td>
<td align="center">0.0357</td>
<td align="center">0.4167</td>
</tr>
<tr class="odd">
<td align="left">RForest - Bbasis</td>
<td align="center">0.0000</td>
<td align="center">0.4167</td>
</tr>
<tr class="even">
<td align="left">SVM linear - discr</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - discr</td>
<td align="center">0.0214</td>
<td align="center">0.1667</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - discr</td>
<td align="center">0.0357</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - PCA</td>
<td align="center">0.4429</td>
<td align="center">0.4833</td>
</tr>
<tr class="even">
<td align="left">SVM poly - PCA</td>
<td align="center">0.3786</td>
<td align="center">0.4333</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - PCA</td>
<td align="center">0.3714</td>
<td align="center">0.4000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - Bbasis</td>
<td align="center">0.0429</td>
<td align="center">0.1000</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - Bbasis</td>
<td align="center">0.0429</td>
<td align="center">0.1167</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - Bbasis</td>
<td align="center">0.0714</td>
<td align="center">0.1500</td>
</tr>
<tr class="odd">
<td align="left">SVM linear - projection</td>
<td align="center">0.0429</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM poly - projection</td>
<td align="center">0.0357</td>
<td align="center">0.0833</td>
</tr>
<tr class="odd">
<td align="left">SVM rbf - projection</td>
<td align="center">0.0500</td>
<td align="center">0.1000</td>
</tr>
<tr class="even">
<td align="left">SVM linear - RKHS - radial</td>
<td align="center">0.0571</td>
<td align="center">0.1333</td>
</tr>
<tr class="odd">
<td align="left">SVM poly - RKHS - radial</td>
<td align="center">0.0571</td>
<td align="center">0.1667</td>
</tr>
<tr class="even">
<td align="left">SVM rbf - RKHS - radial</td>
<td align="center">0.0143</td>
<td align="center">0.1500</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="simulation-study-1" class="section level2 hasAnchor" number="2.4">
<h2><span class="header-section-number">2.4</span> Simulation Study<a href="simulace3sigma.html#simulation-study-1" class="anchor-section" aria-label="Anchor link to header"></a></h2>
<p>In the entire preceding section, we dealt with only one randomly generated dataset of functions from two classification classes, which we then randomly split into test and training parts. We evaluated the individual classifiers obtained using the considered methods based on test and training errors.</p>
<p>Since the generated data (and their division into two parts) can vary significantly with each repetition, the errors of individual classification algorithms will also vary significantly. Therefore, drawing any conclusions about the methods and comparing them with each other based on a single generated dataset can be very misleading.</p>
<p>For this reason, in this section, we will focus on repeating the entire previous procedure for various generated datasets. We will store the results in a table and ultimately calculate the average characteristics of the models across the individual repetitions. To make our conclusions sufficiently general, we will choose the number of repetitions to be <span class="math inline">\(n_{sim} = 25\)</span>.</p>
<p>Now, we will repeat the entire previous section <span class="math inline">\(n.sim\)</span> times and store the error values in the object <code>SIMUL_params</code>, while varying the value of the parameter <span class="math inline">\(\sigma\)</span> and observing how the results of the selected classification methods change with this value.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb266"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb266-1"><a href="simulace3sigma.html#cb266-1" tabindex="-1"></a><span class="co"># set seed for random number generation</span></span>
<span id="cb266-2"><a href="simulace3sigma.html#cb266-2" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">42</span>)</span>
<span id="cb266-3"><a href="simulace3sigma.html#cb266-3" tabindex="-1"></a></span>
<span id="cb266-4"><a href="simulace3sigma.html#cb266-4" tabindex="-1"></a><span class="co"># number of simulations for each value of the simulation parameter</span></span>
<span id="cb266-5"><a href="simulace3sigma.html#cb266-5" tabindex="-1"></a>n.sim <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb266-6"><a href="simulace3sigma.html#cb266-6" tabindex="-1"></a></span>
<span id="cb266-7"><a href="simulace3sigma.html#cb266-7" tabindex="-1"></a>methods <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LDA&#39;</span>, <span class="st">&#39;QDA&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb266-8"><a href="simulace3sigma.html#cb266-8" tabindex="-1"></a>             <span class="st">&#39;RF_discr&#39;</span>, <span class="st">&#39;RF_score&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb266-9"><a href="simulace3sigma.html#cb266-9" tabindex="-1"></a>             <span class="st">&#39;SVM linear - diskr&#39;</span>, <span class="st">&#39;SVM poly - diskr&#39;</span>, <span class="st">&#39;SVM rbf - diskr&#39;</span>, </span>
<span id="cb266-10"><a href="simulace3sigma.html#cb266-10" tabindex="-1"></a>             <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM poly - PCA&#39;</span>, <span class="st">&#39;SVM rbf - PCA&#39;</span>, </span>
<span id="cb266-11"><a href="simulace3sigma.html#cb266-11" tabindex="-1"></a>             <span class="st">&#39;SVM linear - Bbasis&#39;</span>, <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb266-12"><a href="simulace3sigma.html#cb266-12" tabindex="-1"></a>             <span class="st">&#39;SVM rbf - Bbasis&#39;</span>, <span class="st">&#39;SVM linear - projection&#39;</span>,</span>
<span id="cb266-13"><a href="simulace3sigma.html#cb266-13" tabindex="-1"></a>             <span class="st">&#39;SVM poly - projection&#39;</span>, <span class="st">&#39;SVM rbf - projection&#39;</span>, </span>
<span id="cb266-14"><a href="simulace3sigma.html#cb266-14" tabindex="-1"></a>             <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb266-15"><a href="simulace3sigma.html#cb266-15" tabindex="-1"></a>             <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span></span>
<span id="cb266-16"><a href="simulace3sigma.html#cb266-16" tabindex="-1"></a>             )</span>
<span id="cb266-17"><a href="simulace3sigma.html#cb266-17" tabindex="-1"></a></span>
<span id="cb266-18"><a href="simulace3sigma.html#cb266-18" tabindex="-1"></a><span class="co"># vector of standard deviations defining the variance around the generating curves</span></span>
<span id="cb266-19"><a href="simulace3sigma.html#cb266-19" tabindex="-1"></a>sigma_vector <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fl">0.1</span>, <span class="dv">5</span>, <span class="at">length =</span> <span class="dv">30</span>)</span>
<span id="cb266-20"><a href="simulace3sigma.html#cb266-20" tabindex="-1"></a></span>
<span id="cb266-21"><a href="simulace3sigma.html#cb266-21" tabindex="-1"></a><span class="co"># resulting object to store simulation results</span></span>
<span id="cb266-22"><a href="simulace3sigma.html#cb266-22" tabindex="-1"></a>SIMUL_params <span class="ot">&lt;-</span> <span class="fu">array</span>(<span class="at">data =</span> <span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(methods), <span class="dv">4</span>, <span class="fu">length</span>(sigma_vector)),</span>
<span id="cb266-23"><a href="simulace3sigma.html#cb266-23" tabindex="-1"></a>                      <span class="at">dimnames =</span> <span class="fu">list</span>(</span>
<span id="cb266-24"><a href="simulace3sigma.html#cb266-24" tabindex="-1"></a>                        <span class="at">method =</span> methods,</span>
<span id="cb266-25"><a href="simulace3sigma.html#cb266-25" tabindex="-1"></a>                        <span class="at">metric =</span> <span class="fu">c</span>(<span class="st">&#39;ERRtrain&#39;</span>, <span class="st">&#39;Errtest&#39;</span>, <span class="st">&#39;SDtrain&#39;</span>, <span class="st">&#39;SDtest&#39;</span>),</span>
<span id="cb266-26"><a href="simulace3sigma.html#cb266-26" tabindex="-1"></a>                        <span class="at">sigma =</span> <span class="fu">paste0</span>(sigma_vector)))</span>
<span id="cb266-27"><a href="simulace3sigma.html#cb266-27" tabindex="-1"></a></span>
<span id="cb266-28"><a href="simulace3sigma.html#cb266-28" tabindex="-1"></a><span class="cf">for</span> (n_sigma <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(sigma_vector)) {</span>
<span id="cb266-29"><a href="simulace3sigma.html#cb266-29" tabindex="-1"></a>  <span class="do">## list to store error values</span></span>
<span id="cb266-30"><a href="simulace3sigma.html#cb266-30" tabindex="-1"></a>  <span class="co"># columns will represent methods</span></span>
<span id="cb266-31"><a href="simulace3sigma.html#cb266-31" tabindex="-1"></a>  <span class="co"># rows will represent individual repetitions</span></span>
<span id="cb266-32"><a href="simulace3sigma.html#cb266-32" tabindex="-1"></a>  <span class="co"># the list has two entries ... train and test</span></span>
<span id="cb266-33"><a href="simulace3sigma.html#cb266-33" tabindex="-1"></a>  SIMULACE <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">train =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb266-34"><a href="simulace3sigma.html#cb266-34" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb266-35"><a href="simulace3sigma.html#cb266-35" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))), </span>
<span id="cb266-36"><a href="simulace3sigma.html#cb266-36" tabindex="-1"></a>                   <span class="at">test =</span> <span class="fu">as.data.frame</span>(<span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> <span class="fu">length</span>(methods), </span>
<span id="cb266-37"><a href="simulace3sigma.html#cb266-37" tabindex="-1"></a>                                               <span class="at">nrow =</span> n.sim,</span>
<span id="cb266-38"><a href="simulace3sigma.html#cb266-38" tabindex="-1"></a>                                               <span class="at">dimnames =</span> <span class="fu">list</span>(<span class="dv">1</span><span class="sc">:</span>n.sim, methods))))</span>
<span id="cb266-39"><a href="simulace3sigma.html#cb266-39" tabindex="-1"></a>  </span>
<span id="cb266-40"><a href="simulace3sigma.html#cb266-40" tabindex="-1"></a>  <span class="co"># object to store optimal hyperparameter values determined using CV</span></span>
<span id="cb266-41"><a href="simulace3sigma.html#cb266-41" tabindex="-1"></a>  CV_RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">KNN_K =</span> <span class="fu">rep</span>(<span class="cn">NA</span>, n.sim), </span>
<span id="cb266-42"><a href="simulace3sigma.html#cb266-42" tabindex="-1"></a>                           <span class="at">nharm =</span> <span class="cn">NA</span>, </span>
<span id="cb266-43"><a href="simulace3sigma.html#cb266-43" tabindex="-1"></a>                           <span class="at">LR_func_n_basis =</span> <span class="cn">NA</span>,</span>
<span id="cb266-44"><a href="simulace3sigma.html#cb266-44" tabindex="-1"></a>                           <span class="at">SVM_d_Linear =</span> <span class="cn">NA</span>,</span>
<span id="cb266-45"><a href="simulace3sigma.html#cb266-45" tabindex="-1"></a>                           <span class="at">SVM_d_Poly =</span> <span class="cn">NA</span>,</span>
<span id="cb266-46"><a href="simulace3sigma.html#cb266-46" tabindex="-1"></a>                           <span class="at">SVM_d_Radial =</span> <span class="cn">NA</span>)</span>
<span id="cb266-47"><a href="simulace3sigma.html#cb266-47" tabindex="-1"></a>  </span>
<span id="cb266-48"><a href="simulace3sigma.html#cb266-48" tabindex="-1"></a>  <span class="do">## SIMULATIONS</span></span>
<span id="cb266-49"><a href="simulace3sigma.html#cb266-49" tabindex="-1"></a>  </span>
<span id="cb266-50"><a href="simulace3sigma.html#cb266-50" tabindex="-1"></a>  <span class="cf">for</span>(sim <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>n.sim) {</span>
<span id="cb266-51"><a href="simulace3sigma.html#cb266-51" tabindex="-1"></a>    <span class="co"># number of generated observations for each class</span></span>
<span id="cb266-52"><a href="simulace3sigma.html#cb266-52" tabindex="-1"></a>    n <span class="ot">&lt;-</span> <span class="dv">100</span></span>
<span id="cb266-53"><a href="simulace3sigma.html#cb266-53" tabindex="-1"></a>    <span class="co"># time vector evenly spaced on the interval [0, 6]</span></span>
<span id="cb266-54"><a href="simulace3sigma.html#cb266-54" tabindex="-1"></a>    t <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">51</span>)</span>
<span id="cb266-55"><a href="simulace3sigma.html#cb266-55" tabindex="-1"></a>    </span>
<span id="cb266-56"><a href="simulace3sigma.html#cb266-56" tabindex="-1"></a>    <span class="co"># for Y = 0</span></span>
<span id="cb266-57"><a href="simulace3sigma.html#cb266-57" tabindex="-1"></a>    X0 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_0, n, sigma_vector[n_sigma], <span class="dv">2</span>)</span>
<span id="cb266-58"><a href="simulace3sigma.html#cb266-58" tabindex="-1"></a>    <span class="co"># for Y = 1</span></span>
<span id="cb266-59"><a href="simulace3sigma.html#cb266-59" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">generate_values</span>(t, funkce_1, n, sigma_vector[n_sigma], <span class="dv">2</span>)</span>
<span id="cb266-60"><a href="simulace3sigma.html#cb266-60" tabindex="-1"></a>    </span>
<span id="cb266-61"><a href="simulace3sigma.html#cb266-61" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb266-62"><a href="simulace3sigma.html#cb266-62" tabindex="-1"></a>    breaks <span class="ot">&lt;-</span> t</span>
<span id="cb266-63"><a href="simulace3sigma.html#cb266-63" tabindex="-1"></a>    norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb266-64"><a href="simulace3sigma.html#cb266-64" tabindex="-1"></a>    </span>
<span id="cb266-65"><a href="simulace3sigma.html#cb266-65" tabindex="-1"></a>    bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb266-66"><a href="simulace3sigma.html#cb266-66" tabindex="-1"></a>                                   <span class="at">norder =</span> norder, </span>
<span id="cb266-67"><a href="simulace3sigma.html#cb266-67" tabindex="-1"></a>                                   <span class="at">breaks =</span> breaks)</span>
<span id="cb266-68"><a href="simulace3sigma.html#cb266-68" tabindex="-1"></a>    </span>
<span id="cb266-69"><a href="simulace3sigma.html#cb266-69" tabindex="-1"></a>    curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>) </span>
<span id="cb266-70"><a href="simulace3sigma.html#cb266-70" tabindex="-1"></a>    <span class="co"># combine observations into one matrix</span></span>
<span id="cb266-71"><a href="simulace3sigma.html#cb266-71" tabindex="-1"></a>    XX <span class="ot">&lt;-</span> <span class="fu">cbind</span>(X0, X1)</span>
<span id="cb266-72"><a href="simulace3sigma.html#cb266-72" tabindex="-1"></a>    </span>
<span id="cb266-73"><a href="simulace3sigma.html#cb266-73" tabindex="-1"></a>    lambda.vect <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">5</span>, <span class="at">to =</span> <span class="dv">3</span>, <span class="at">length.out =</span> <span class="dv">25</span>) <span class="co"># lambda vector</span></span>
<span id="cb266-74"><a href="simulace3sigma.html#cb266-74" tabindex="-1"></a>    gcv <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="cn">NA</span>, <span class="at">length =</span> <span class="fu">length</span>(lambda.vect)) <span class="co"># empty vector to store GCV</span></span>
<span id="cb266-75"><a href="simulace3sigma.html#cb266-75" tabindex="-1"></a>    </span>
<span id="cb266-76"><a href="simulace3sigma.html#cb266-76" tabindex="-1"></a>    <span class="cf">for</span>(index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(lambda.vect)) {</span>
<span id="cb266-77"><a href="simulace3sigma.html#cb266-77" tabindex="-1"></a>      curv.Fdpar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.vect[index])</span>
<span id="cb266-78"><a href="simulace3sigma.html#cb266-78" tabindex="-1"></a>      BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.Fdpar) <span class="co"># smoothing</span></span>
<span id="cb266-79"><a href="simulace3sigma.html#cb266-79" tabindex="-1"></a>      gcv[index] <span class="ot">&lt;-</span> <span class="fu">mean</span>(BSmooth<span class="sc">$</span>gcv) <span class="co"># average over all observed curves</span></span>
<span id="cb266-80"><a href="simulace3sigma.html#cb266-80" tabindex="-1"></a>    }</span>
<span id="cb266-81"><a href="simulace3sigma.html#cb266-81" tabindex="-1"></a>    </span>
<span id="cb266-82"><a href="simulace3sigma.html#cb266-82" tabindex="-1"></a>    GCV <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb266-83"><a href="simulace3sigma.html#cb266-83" tabindex="-1"></a>      <span class="at">lambda =</span> <span class="fu">round</span>(<span class="fu">log10</span>(lambda.vect), <span class="dv">3</span>),</span>
<span id="cb266-84"><a href="simulace3sigma.html#cb266-84" tabindex="-1"></a>      <span class="at">GCV =</span> gcv</span>
<span id="cb266-85"><a href="simulace3sigma.html#cb266-85" tabindex="-1"></a>    )</span>
<span id="cb266-86"><a href="simulace3sigma.html#cb266-86" tabindex="-1"></a>    </span>
<span id="cb266-87"><a href="simulace3sigma.html#cb266-87" tabindex="-1"></a>    <span class="co"># find the minimum value</span></span>
<span id="cb266-88"><a href="simulace3sigma.html#cb266-88" tabindex="-1"></a>    lambda.opt <span class="ot">&lt;-</span> lambda.vect[<span class="fu">which.min</span>(gcv)]</span>
<span id="cb266-89"><a href="simulace3sigma.html#cb266-89" tabindex="-1"></a>    </span>
<span id="cb266-90"><a href="simulace3sigma.html#cb266-90" tabindex="-1"></a>    curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb266-91"><a href="simulace3sigma.html#cb266-91" tabindex="-1"></a>    BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.basis</span>(t, XX, curv.fdPar)</span>
<span id="cb266-92"><a href="simulace3sigma.html#cb266-92" tabindex="-1"></a>    XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>fd</span>
<span id="cb266-93"><a href="simulace3sigma.html#cb266-93" tabindex="-1"></a>    </span>
<span id="cb266-94"><a href="simulace3sigma.html#cb266-94" tabindex="-1"></a>    fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> XXfd, <span class="at">evalarg =</span> t)</span>
<span id="cb266-95"><a href="simulace3sigma.html#cb266-95" tabindex="-1"></a>    </span>
<span id="cb266-96"><a href="simulace3sigma.html#cb266-96" tabindex="-1"></a>    <span class="co"># split into test and training parts</span></span>
<span id="cb266-97"><a href="simulace3sigma.html#cb266-97" tabindex="-1"></a>    split <span class="ot">&lt;-</span> <span class="fu">sample.split</span>(XXfd<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">SplitRatio =</span> <span class="fl">0.7</span>)</span>
<span id="cb266-98"><a href="simulace3sigma.html#cb266-98" tabindex="-1"></a>    </span>
<span id="cb266-99"><a href="simulace3sigma.html#cb266-99" tabindex="-1"></a>    Y <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">each =</span> n)</span>
<span id="cb266-100"><a href="simulace3sigma.html#cb266-100" tabindex="-1"></a>    </span>
<span id="cb266-101"><a href="simulace3sigma.html#cb266-101" tabindex="-1"></a>    X.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-102"><a href="simulace3sigma.html#cb266-102" tabindex="-1"></a>    X.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-103"><a href="simulace3sigma.html#cb266-103" tabindex="-1"></a>    </span>
<span id="cb266-104"><a href="simulace3sigma.html#cb266-104" tabindex="-1"></a>    Y.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-105"><a href="simulace3sigma.html#cb266-105" tabindex="-1"></a>    Y.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-106"><a href="simulace3sigma.html#cb266-106" tabindex="-1"></a>    </span>
<span id="cb266-107"><a href="simulace3sigma.html#cb266-107" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb266-108"><a href="simulace3sigma.html#cb266-108" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.train))</span>
<span id="cb266-109"><a href="simulace3sigma.html#cb266-109" tabindex="-1"></a>    </span>
<span id="cb266-110"><a href="simulace3sigma.html#cb266-110" tabindex="-1"></a>    <span class="do">## 1) K-Nearest Neighbors</span></span>
<span id="cb266-111"><a href="simulace3sigma.html#cb266-111" tabindex="-1"></a>    </span>
<span id="cb266-112"><a href="simulace3sigma.html#cb266-112" tabindex="-1"></a>    k_cv <span class="ot">&lt;-</span> <span class="dv">5</span> <span class="co"># k-fold CV</span></span>
<span id="cb266-113"><a href="simulace3sigma.html#cb266-113" tabindex="-1"></a>    neighbours <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">15</span> <span class="co"># number of neighbors </span></span>
<span id="cb266-114"><a href="simulace3sigma.html#cb266-114" tabindex="-1"></a>    </span>
<span id="cb266-115"><a href="simulace3sigma.html#cb266-115" tabindex="-1"></a>    <span class="co"># split the training data into k parts</span></span>
<span id="cb266-116"><a href="simulace3sigma.html#cb266-116" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb266-117"><a href="simulace3sigma.html#cb266-117" tabindex="-1"></a>    </span>
<span id="cb266-118"><a href="simulace3sigma.html#cb266-118" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(neighbours), <span class="at">ncol =</span> k_cv)</span>
<span id="cb266-119"><a href="simulace3sigma.html#cb266-119" tabindex="-1"></a>    </span>
<span id="cb266-120"><a href="simulace3sigma.html#cb266-120" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb266-121"><a href="simulace3sigma.html#cb266-121" tabindex="-1"></a>      <span class="co"># define the index set</span></span>
<span id="cb266-122"><a href="simulace3sigma.html#cb266-122" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb266-123"><a href="simulace3sigma.html#cb266-123" tabindex="-1"></a>        </span>
<span id="cb266-124"><a href="simulace3sigma.html#cb266-124" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-125"><a href="simulace3sigma.html#cb266-125" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb266-126"><a href="simulace3sigma.html#cb266-126" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-127"><a href="simulace3sigma.html#cb266-127" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb266-128"><a href="simulace3sigma.html#cb266-128" tabindex="-1"></a>      </span>
<span id="cb266-129"><a href="simulace3sigma.html#cb266-129" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-130"><a href="simulace3sigma.html#cb266-130" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb266-131"><a href="simulace3sigma.html#cb266-131" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-132"><a href="simulace3sigma.html#cb266-132" tabindex="-1"></a>        <span class="fu">factor</span>() <span class="sc">|&gt;</span> <span class="fu">as.numeric</span>()</span>
<span id="cb266-133"><a href="simulace3sigma.html#cb266-133" tabindex="-1"></a>      </span>
<span id="cb266-134"><a href="simulace3sigma.html#cb266-134" tabindex="-1"></a>      <span class="co"># projdeme kazdou cast ... k-krat zopakujeme</span></span>
<span id="cb266-135"><a href="simulace3sigma.html#cb266-135" tabindex="-1"></a>      <span class="cf">for</span>(neighbour <span class="cf">in</span> neighbours) {</span>
<span id="cb266-136"><a href="simulace3sigma.html#cb266-136" tabindex="-1"></a>        <span class="co"># model pro konkretni volbu K</span></span>
<span id="cb266-137"><a href="simulace3sigma.html#cb266-137" tabindex="-1"></a>        neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train.cv, </span>
<span id="cb266-138"><a href="simulace3sigma.html#cb266-138" tabindex="-1"></a>                                  <span class="at">fdataobj =</span> x.train.cv, </span>
<span id="cb266-139"><a href="simulace3sigma.html#cb266-139" tabindex="-1"></a>                                  <span class="at">knn =</span> neighbour) </span>
<span id="cb266-140"><a href="simulace3sigma.html#cb266-140" tabindex="-1"></a>        <span class="co"># predikce na validacni casti</span></span>
<span id="cb266-141"><a href="simulace3sigma.html#cb266-141" tabindex="-1"></a>        model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb266-142"><a href="simulace3sigma.html#cb266-142" tabindex="-1"></a>                                        <span class="at">new.fdataobj =</span> x.test.cv)</span>
<span id="cb266-143"><a href="simulace3sigma.html#cb266-143" tabindex="-1"></a>        <span class="co"># presnost na validacni casti</span></span>
<span id="cb266-144"><a href="simulace3sigma.html#cb266-144" tabindex="-1"></a>        presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, model.neighb.predict) <span class="sc">|&gt;</span> </span>
<span id="cb266-145"><a href="simulace3sigma.html#cb266-145" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-146"><a href="simulace3sigma.html#cb266-146" tabindex="-1"></a>        </span>
<span id="cb266-147"><a href="simulace3sigma.html#cb266-147" tabindex="-1"></a>        <span class="co"># presnost vlozime na pozici pro dane K a fold</span></span>
<span id="cb266-148"><a href="simulace3sigma.html#cb266-148" tabindex="-1"></a>        CV.results[neighbour, index] <span class="ot">&lt;-</span> presnost</span>
<span id="cb266-149"><a href="simulace3sigma.html#cb266-149" tabindex="-1"></a>      }</span>
<span id="cb266-150"><a href="simulace3sigma.html#cb266-150" tabindex="-1"></a>    }</span>
<span id="cb266-151"><a href="simulace3sigma.html#cb266-151" tabindex="-1"></a>    </span>
<span id="cb266-152"><a href="simulace3sigma.html#cb266-152" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva K pres folds</span></span>
<span id="cb266-153"><a href="simulace3sigma.html#cb266-153" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb266-154"><a href="simulace3sigma.html#cb266-154" tabindex="-1"></a>    K.opt <span class="ot">&lt;-</span> <span class="fu">which.max</span>(CV.results)</span>
<span id="cb266-155"><a href="simulace3sigma.html#cb266-155" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>KNN_K[sim] <span class="ot">&lt;-</span> K.opt</span>
<span id="cb266-156"><a href="simulace3sigma.html#cb266-156" tabindex="-1"></a>    presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb266-157"><a href="simulace3sigma.html#cb266-157" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">K =</span> neighbours, <span class="at">CV =</span> CV.results)</span>
<span id="cb266-158"><a href="simulace3sigma.html#cb266-158" tabindex="-1"></a>    </span>
<span id="cb266-159"><a href="simulace3sigma.html#cb266-159" tabindex="-1"></a>    neighb.model <span class="ot">&lt;-</span> <span class="fu">classif.knn</span>(<span class="at">group =</span> y.train, <span class="at">fdataobj =</span> x.train, <span class="at">knn =</span> K.opt)</span>
<span id="cb266-160"><a href="simulace3sigma.html#cb266-160" tabindex="-1"></a>    </span>
<span id="cb266-161"><a href="simulace3sigma.html#cb266-161" tabindex="-1"></a>    <span class="co"># predikce</span></span>
<span id="cb266-162"><a href="simulace3sigma.html#cb266-162" tabindex="-1"></a>    model.neighb.predict <span class="ot">&lt;-</span> <span class="fu">predict</span>(neighb.model, </span>
<span id="cb266-163"><a href="simulace3sigma.html#cb266-163" tabindex="-1"></a>                                    <span class="at">new.fdataobj =</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb266-164"><a href="simulace3sigma.html#cb266-164" tabindex="-1"></a>    </span>
<span id="cb266-165"><a href="simulace3sigma.html#cb266-165" tabindex="-1"></a>    presnost <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">as.numeric</span>(<span class="fu">factor</span>(Y.test)), model.neighb.predict) <span class="sc">|&gt;</span></span>
<span id="cb266-166"><a href="simulace3sigma.html#cb266-166" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span></span>
<span id="cb266-167"><a href="simulace3sigma.html#cb266-167" tabindex="-1"></a>      <span class="fu">diag</span>() <span class="sc">|&gt;</span></span>
<span id="cb266-168"><a href="simulace3sigma.html#cb266-168" tabindex="-1"></a>      <span class="fu">sum</span>()</span>
<span id="cb266-169"><a href="simulace3sigma.html#cb266-169" tabindex="-1"></a>    </span>
<span id="cb266-170"><a href="simulace3sigma.html#cb266-170" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;KNN&#39;</span>, </span>
<span id="cb266-171"><a href="simulace3sigma.html#cb266-171" tabindex="-1"></a>                          <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> neighb.model<span class="sc">$</span>max.prob,</span>
<span id="cb266-172"><a href="simulace3sigma.html#cb266-172" tabindex="-1"></a>                          <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost)</span>
<span id="cb266-173"><a href="simulace3sigma.html#cb266-173" tabindex="-1"></a>    </span>
<span id="cb266-174"><a href="simulace3sigma.html#cb266-174" tabindex="-1"></a>    <span class="do">## 2) Lineární diskriminační analýza</span></span>
<span id="cb266-175"><a href="simulace3sigma.html#cb266-175" tabindex="-1"></a>    </span>
<span id="cb266-176"><a href="simulace3sigma.html#cb266-176" tabindex="-1"></a>    <span class="co"># analyza hlavnich komponent</span></span>
<span id="cb266-177"><a href="simulace3sigma.html#cb266-177" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> <span class="dv">10</span>) <span class="co"># nharm - maximalni pocet HK</span></span>
<span id="cb266-178"><a href="simulace3sigma.html#cb266-178" tabindex="-1"></a>    nharm <span class="ot">&lt;-</span> <span class="fu">which</span>(<span class="fu">cumsum</span>(data.PCA<span class="sc">$</span>varprop) <span class="sc">&gt;=</span> <span class="fl">0.9</span>)[<span class="dv">1</span>] <span class="co"># urceni p</span></span>
<span id="cb266-179"><a href="simulace3sigma.html#cb266-179" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>nharm[sim] <span class="ot">&lt;-</span> nharm</span>
<span id="cb266-180"><a href="simulace3sigma.html#cb266-180" tabindex="-1"></a>    <span class="cf">if</span>(nharm <span class="sc">==</span> <span class="dv">1</span>) nharm <span class="ot">&lt;-</span> <span class="dv">2</span></span>
<span id="cb266-181"><a href="simulace3sigma.html#cb266-181" tabindex="-1"></a>    </span>
<span id="cb266-182"><a href="simulace3sigma.html#cb266-182" tabindex="-1"></a>    data.PCA <span class="ot">&lt;-</span> <span class="fu">pca.fd</span>(X.train, <span class="at">nharm =</span> nharm) </span>
<span id="cb266-183"><a href="simulace3sigma.html#cb266-183" tabindex="-1"></a>    data.PCA.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(data.PCA<span class="sc">$</span>scores) <span class="co"># skore prvnich p HK</span></span>
<span id="cb266-184"><a href="simulace3sigma.html#cb266-184" tabindex="-1"></a>    data.PCA.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train) <span class="co"># prislusnost do trid</span></span>
<span id="cb266-185"><a href="simulace3sigma.html#cb266-185" tabindex="-1"></a>    </span>
<span id="cb266-186"><a href="simulace3sigma.html#cb266-186" tabindex="-1"></a>    <span class="co"># vypocet skoru testovacich funkci</span></span>
<span id="cb266-187"><a href="simulace3sigma.html#cb266-187" tabindex="-1"></a>    scores <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">ncol =</span> nharm, <span class="at">nrow =</span> <span class="fu">length</span>(Y.test)) <span class="co"># prazdna matice </span></span>
<span id="cb266-188"><a href="simulace3sigma.html#cb266-188" tabindex="-1"></a>    </span>
<span id="cb266-189"><a href="simulace3sigma.html#cb266-189" tabindex="-1"></a>    <span class="cf">for</span>(k <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(scores)[<span class="dv">1</span>]) {</span>
<span id="cb266-190"><a href="simulace3sigma.html#cb266-190" tabindex="-1"></a>      xfd <span class="ot">=</span> X.test[k] <span class="sc">-</span> data.PCA<span class="sc">$</span>meanfd[<span class="dv">1</span>] <span class="co"># k-te pozorovani - prumerna funkce</span></span>
<span id="cb266-191"><a href="simulace3sigma.html#cb266-191" tabindex="-1"></a>      scores[k, ] <span class="ot">=</span> <span class="fu">inprod</span>(xfd, data.PCA<span class="sc">$</span>harmonics) </span>
<span id="cb266-192"><a href="simulace3sigma.html#cb266-192" tabindex="-1"></a>      <span class="co"># skalarni soucin rezidua a vlastnich funkci rho (funkcionalni hlavni komponenty)</span></span>
<span id="cb266-193"><a href="simulace3sigma.html#cb266-193" tabindex="-1"></a>    }</span>
<span id="cb266-194"><a href="simulace3sigma.html#cb266-194" tabindex="-1"></a>    </span>
<span id="cb266-195"><a href="simulace3sigma.html#cb266-195" tabindex="-1"></a>    data.PCA.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(scores)</span>
<span id="cb266-196"><a href="simulace3sigma.html#cb266-196" tabindex="-1"></a>    data.PCA.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb266-197"><a href="simulace3sigma.html#cb266-197" tabindex="-1"></a>    <span class="fu">colnames</span>(data.PCA.test) <span class="ot">&lt;-</span> <span class="fu">colnames</span>(data.PCA.train) </span>
<span id="cb266-198"><a href="simulace3sigma.html#cb266-198" tabindex="-1"></a>    </span>
<span id="cb266-199"><a href="simulace3sigma.html#cb266-199" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb266-200"><a href="simulace3sigma.html#cb266-200" tabindex="-1"></a>    clf.LDA <span class="ot">&lt;-</span> <span class="fu">lda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb266-201"><a href="simulace3sigma.html#cb266-201" tabindex="-1"></a>    </span>
<span id="cb266-202"><a href="simulace3sigma.html#cb266-202" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-203"><a href="simulace3sigma.html#cb266-203" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-204"><a href="simulace3sigma.html#cb266-204" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb266-205"><a href="simulace3sigma.html#cb266-205" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-206"><a href="simulace3sigma.html#cb266-206" tabindex="-1"></a>      </span>
<span id="cb266-207"><a href="simulace3sigma.html#cb266-207" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-208"><a href="simulace3sigma.html#cb266-208" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.LDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-209"><a href="simulace3sigma.html#cb266-209" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb266-210"><a href="simulace3sigma.html#cb266-210" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-211"><a href="simulace3sigma.html#cb266-211" tabindex="-1"></a>    </span>
<span id="cb266-212"><a href="simulace3sigma.html#cb266-212" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LDA&#39;</span>, </span>
<span id="cb266-213"><a href="simulace3sigma.html#cb266-213" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-214"><a href="simulace3sigma.html#cb266-214" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-215"><a href="simulace3sigma.html#cb266-215" tabindex="-1"></a>    </span>
<span id="cb266-216"><a href="simulace3sigma.html#cb266-216" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-217"><a href="simulace3sigma.html#cb266-217" tabindex="-1"></a>    </span>
<span id="cb266-218"><a href="simulace3sigma.html#cb266-218" tabindex="-1"></a>    <span class="do">## 3) Kvadratická diskriminační analýza</span></span>
<span id="cb266-219"><a href="simulace3sigma.html#cb266-219" tabindex="-1"></a>    </span>
<span id="cb266-220"><a href="simulace3sigma.html#cb266-220" tabindex="-1"></a>    <span class="co"># model</span></span>
<span id="cb266-221"><a href="simulace3sigma.html#cb266-221" tabindex="-1"></a>    clf.QDA <span class="ot">&lt;-</span> <span class="fu">qda</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train)</span>
<span id="cb266-222"><a href="simulace3sigma.html#cb266-222" tabindex="-1"></a>    </span>
<span id="cb266-223"><a href="simulace3sigma.html#cb266-223" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-224"><a href="simulace3sigma.html#cb266-224" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-225"><a href="simulace3sigma.html#cb266-225" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb266-226"><a href="simulace3sigma.html#cb266-226" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-227"><a href="simulace3sigma.html#cb266-227" tabindex="-1"></a>      </span>
<span id="cb266-228"><a href="simulace3sigma.html#cb266-228" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-229"><a href="simulace3sigma.html#cb266-229" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.QDA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-230"><a href="simulace3sigma.html#cb266-230" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test<span class="sc">$</span>class) <span class="sc">|&gt;</span></span>
<span id="cb266-231"><a href="simulace3sigma.html#cb266-231" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-232"><a href="simulace3sigma.html#cb266-232" tabindex="-1"></a>    </span>
<span id="cb266-233"><a href="simulace3sigma.html#cb266-233" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;QDA&#39;</span>, </span>
<span id="cb266-234"><a href="simulace3sigma.html#cb266-234" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-235"><a href="simulace3sigma.html#cb266-235" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-236"><a href="simulace3sigma.html#cb266-236" tabindex="-1"></a>    </span>
<span id="cb266-237"><a href="simulace3sigma.html#cb266-237" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-238"><a href="simulace3sigma.html#cb266-238" tabindex="-1"></a>    </span>
<span id="cb266-239"><a href="simulace3sigma.html#cb266-239" tabindex="-1"></a>    <span class="do">## 4) Logistická regrese</span></span>
<span id="cb266-240"><a href="simulace3sigma.html#cb266-240" tabindex="-1"></a>    <span class="do">### 4.1) Funkcionální logistická regrese</span></span>
<span id="cb266-241"><a href="simulace3sigma.html#cb266-241" tabindex="-1"></a>    </span>
<span id="cb266-242"><a href="simulace3sigma.html#cb266-242" tabindex="-1"></a>    <span class="co"># vytvorime vhodne objekty</span></span>
<span id="cb266-243"><a href="simulace3sigma.html#cb266-243" tabindex="-1"></a>    x.train <span class="ot">&lt;-</span> <span class="fu">fdata</span>(X.train)</span>
<span id="cb266-244"><a href="simulace3sigma.html#cb266-244" tabindex="-1"></a>    y.train <span class="ot">&lt;-</span> <span class="fu">as.numeric</span>(Y.train)</span>
<span id="cb266-245"><a href="simulace3sigma.html#cb266-245" tabindex="-1"></a>    </span>
<span id="cb266-246"><a href="simulace3sigma.html#cb266-246" tabindex="-1"></a>    <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb266-247"><a href="simulace3sigma.html#cb266-247" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb266-248"><a href="simulace3sigma.html#cb266-248" tabindex="-1"></a>    </span>
<span id="cb266-249"><a href="simulace3sigma.html#cb266-249" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb266-250"><a href="simulace3sigma.html#cb266-250" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb266-251"><a href="simulace3sigma.html#cb266-251" tabindex="-1"></a>    <span class="co"># B-spline baze </span></span>
<span id="cb266-252"><a href="simulace3sigma.html#cb266-252" tabindex="-1"></a>    basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb266-253"><a href="simulace3sigma.html#cb266-253" tabindex="-1"></a>    </span>
<span id="cb266-254"><a href="simulace3sigma.html#cb266-254" tabindex="-1"></a>    <span class="do">### 10-fold cross-validation</span></span>
<span id="cb266-255"><a href="simulace3sigma.html#cb266-255" tabindex="-1"></a>    n.basis.max <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb266-256"><a href="simulace3sigma.html#cb266-256" tabindex="-1"></a>    n.basis <span class="ot">&lt;-</span> <span class="dv">4</span><span class="sc">:</span>n.basis.max</span>
<span id="cb266-257"><a href="simulace3sigma.html#cb266-257" tabindex="-1"></a>    <span class="co"># k_cv &lt;- 10 # k-fold CV</span></span>
<span id="cb266-258"><a href="simulace3sigma.html#cb266-258" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb266-259"><a href="simulace3sigma.html#cb266-259" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps, <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb266-260"><a href="simulace3sigma.html#cb266-260" tabindex="-1"></a>    <span class="do">## prvky, ktere se behem cyklu nemeni</span></span>
<span id="cb266-261"><a href="simulace3sigma.html#cb266-261" tabindex="-1"></a>    <span class="co"># body, ve kterych jsou funkce vyhodnoceny</span></span>
<span id="cb266-262"><a href="simulace3sigma.html#cb266-262" tabindex="-1"></a>    tt <span class="ot">&lt;-</span> x.train[[<span class="st">&quot;argvals&quot;</span>]]</span>
<span id="cb266-263"><a href="simulace3sigma.html#cb266-263" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(tt)</span>
<span id="cb266-264"><a href="simulace3sigma.html#cb266-264" tabindex="-1"></a>    <span class="co"># B-spline baze </span></span>
<span id="cb266-265"><a href="simulace3sigma.html#cb266-265" tabindex="-1"></a>    basis1 <span class="ot">&lt;-</span> X.train<span class="sc">$</span>basis</span>
<span id="cb266-266"><a href="simulace3sigma.html#cb266-266" tabindex="-1"></a>    <span class="co"># vztah</span></span>
<span id="cb266-267"><a href="simulace3sigma.html#cb266-267" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb266-268"><a href="simulace3sigma.html#cb266-268" tabindex="-1"></a>    <span class="co"># baze pro x</span></span>
<span id="cb266-269"><a href="simulace3sigma.html#cb266-269" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1)</span>
<span id="cb266-270"><a href="simulace3sigma.html#cb266-270" tabindex="-1"></a>    </span>
<span id="cb266-271"><a href="simulace3sigma.html#cb266-271" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(n.basis), <span class="at">ncol =</span> k_cv, </span>
<span id="cb266-272"><a href="simulace3sigma.html#cb266-272" tabindex="-1"></a>                         <span class="at">dimnames =</span> <span class="fu">list</span>(n.basis, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb266-273"><a href="simulace3sigma.html#cb266-273" tabindex="-1"></a>    </span>
<span id="cb266-274"><a href="simulace3sigma.html#cb266-274" tabindex="-1"></a>    <span class="cf">for</span> (index <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb266-275"><a href="simulace3sigma.html#cb266-275" tabindex="-1"></a>      <span class="co"># definujeme danou indexovou mnozinu</span></span>
<span id="cb266-276"><a href="simulace3sigma.html#cb266-276" tabindex="-1"></a>      fold <span class="ot">&lt;-</span> folds[[index]]</span>
<span id="cb266-277"><a href="simulace3sigma.html#cb266-277" tabindex="-1"></a>        </span>
<span id="cb266-278"><a href="simulace3sigma.html#cb266-278" tabindex="-1"></a>      x.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-279"><a href="simulace3sigma.html#cb266-279" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb266-280"><a href="simulace3sigma.html#cb266-280" tabindex="-1"></a>      y.train.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-281"><a href="simulace3sigma.html#cb266-281" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb266-282"><a href="simulace3sigma.html#cb266-282" tabindex="-1"></a>      </span>
<span id="cb266-283"><a href="simulace3sigma.html#cb266-283" tabindex="-1"></a>      x.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(X.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-284"><a href="simulace3sigma.html#cb266-284" tabindex="-1"></a>        <span class="fu">fdata</span>()</span>
<span id="cb266-285"><a href="simulace3sigma.html#cb266-285" tabindex="-1"></a>      y.test.cv <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y.train, <span class="sc">!</span><span class="fu">c</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(X.train<span class="sc">$</span>fdnames<span class="sc">$</span>reps)) <span class="sc">%in%</span> fold) <span class="sc">|&gt;</span></span>
<span id="cb266-286"><a href="simulace3sigma.html#cb266-286" tabindex="-1"></a>        <span class="fu">as.numeric</span>()</span>
<span id="cb266-287"><a href="simulace3sigma.html#cb266-287" tabindex="-1"></a>      </span>
<span id="cb266-288"><a href="simulace3sigma.html#cb266-288" tabindex="-1"></a>      dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train.cv) </span>
<span id="cb266-289"><a href="simulace3sigma.html#cb266-289" tabindex="-1"></a>      <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb266-290"><a href="simulace3sigma.html#cb266-290" tabindex="-1"></a>      </span>
<span id="cb266-291"><a href="simulace3sigma.html#cb266-291" tabindex="-1"></a>      <span class="cf">for</span> (i <span class="cf">in</span> n.basis) {</span>
<span id="cb266-292"><a href="simulace3sigma.html#cb266-292" tabindex="-1"></a>        <span class="co"># baze pro bety</span></span>
<span id="cb266-293"><a href="simulace3sigma.html#cb266-293" tabindex="-1"></a>        basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, <span class="at">nbasis =</span> i)</span>
<span id="cb266-294"><a href="simulace3sigma.html#cb266-294" tabindex="-1"></a>        </span>
<span id="cb266-295"><a href="simulace3sigma.html#cb266-295" tabindex="-1"></a>        basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb266-296"><a href="simulace3sigma.html#cb266-296" tabindex="-1"></a>        <span class="co"># vstupni data do modelu</span></span>
<span id="cb266-297"><a href="simulace3sigma.html#cb266-297" tabindex="-1"></a>        ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train.cv)</span>
<span id="cb266-298"><a href="simulace3sigma.html#cb266-298" tabindex="-1"></a>        <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb266-299"><a href="simulace3sigma.html#cb266-299" tabindex="-1"></a>        model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb266-300"><a href="simulace3sigma.html#cb266-300" tabindex="-1"></a>                                <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb266-301"><a href="simulace3sigma.html#cb266-301" tabindex="-1"></a>        </span>
<span id="cb266-302"><a href="simulace3sigma.html#cb266-302" tabindex="-1"></a>        <span class="co"># presnost na validacni casti </span></span>
<span id="cb266-303"><a href="simulace3sigma.html#cb266-303" tabindex="-1"></a>        newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(y.test.cv), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.test.cv)</span>
<span id="cb266-304"><a href="simulace3sigma.html#cb266-304" tabindex="-1"></a>        predictions.valid <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb266-305"><a href="simulace3sigma.html#cb266-305" tabindex="-1"></a>        predictions.valid <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.valid <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb266-306"><a href="simulace3sigma.html#cb266-306" tabindex="-1"></a>        presnost.valid <span class="ot">&lt;-</span> <span class="fu">table</span>(y.test.cv, predictions.valid<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb266-307"><a href="simulace3sigma.html#cb266-307" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-308"><a href="simulace3sigma.html#cb266-308" tabindex="-1"></a>        </span>
<span id="cb266-309"><a href="simulace3sigma.html#cb266-309" tabindex="-1"></a>        <span class="co"># vlozime do matice</span></span>
<span id="cb266-310"><a href="simulace3sigma.html#cb266-310" tabindex="-1"></a>        CV.results[<span class="fu">as.character</span>(i), <span class="fu">as.character</span>(index)] <span class="ot">&lt;-</span> presnost.valid</span>
<span id="cb266-311"><a href="simulace3sigma.html#cb266-311" tabindex="-1"></a>      } </span>
<span id="cb266-312"><a href="simulace3sigma.html#cb266-312" tabindex="-1"></a>    }</span>
<span id="cb266-313"><a href="simulace3sigma.html#cb266-313" tabindex="-1"></a>    </span>
<span id="cb266-314"><a href="simulace3sigma.html#cb266-314" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva n pres folds</span></span>
<span id="cb266-315"><a href="simulace3sigma.html#cb266-315" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results, <span class="dv">1</span>, mean)</span>
<span id="cb266-316"><a href="simulace3sigma.html#cb266-316" tabindex="-1"></a>    n.basis.opt <span class="ot">&lt;-</span> n.basis[<span class="fu">which.max</span>(CV.results)]</span>
<span id="cb266-317"><a href="simulace3sigma.html#cb266-317" tabindex="-1"></a>    CV_RESULTS<span class="sc">$</span>LR_func_n_basis[sim] <span class="ot">&lt;-</span> n.basis.opt</span>
<span id="cb266-318"><a href="simulace3sigma.html#cb266-318" tabindex="-1"></a>    presnost.opt.cv <span class="ot">&lt;-</span> <span class="fu">max</span>(CV.results)</span>
<span id="cb266-319"><a href="simulace3sigma.html#cb266-319" tabindex="-1"></a>    </span>
<span id="cb266-320"><a href="simulace3sigma.html#cb266-320" tabindex="-1"></a>    <span class="co"># optimalni model</span></span>
<span id="cb266-321"><a href="simulace3sigma.html#cb266-321" tabindex="-1"></a>    basis2 <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> <span class="fu">range</span>(tt), <span class="at">nbasis =</span> n.basis.opt)</span>
<span id="cb266-322"><a href="simulace3sigma.html#cb266-322" tabindex="-1"></a>    f <span class="ot">&lt;-</span> Y <span class="sc">~</span> x</span>
<span id="cb266-323"><a href="simulace3sigma.html#cb266-323" tabindex="-1"></a>    <span class="co"># baze pro x a bety</span></span>
<span id="cb266-324"><a href="simulace3sigma.html#cb266-324" tabindex="-1"></a>    basis.x <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis1) </span>
<span id="cb266-325"><a href="simulace3sigma.html#cb266-325" tabindex="-1"></a>    basis.b <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;x&quot;</span> <span class="ot">=</span> basis2)</span>
<span id="cb266-326"><a href="simulace3sigma.html#cb266-326" tabindex="-1"></a>    <span class="co"># vstupni data do modelu</span></span>
<span id="cb266-327"><a href="simulace3sigma.html#cb266-327" tabindex="-1"></a>    dataf <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(y.train) </span>
<span id="cb266-328"><a href="simulace3sigma.html#cb266-328" tabindex="-1"></a>    <span class="fu">colnames</span>(dataf) <span class="ot">&lt;-</span> <span class="st">&quot;Y&quot;</span></span>
<span id="cb266-329"><a href="simulace3sigma.html#cb266-329" tabindex="-1"></a>    ldata <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> dataf, <span class="st">&quot;x&quot;</span> <span class="ot">=</span> x.train)</span>
<span id="cb266-330"><a href="simulace3sigma.html#cb266-330" tabindex="-1"></a>    <span class="co"># binomicky model ... model logisticke regrese</span></span>
<span id="cb266-331"><a href="simulace3sigma.html#cb266-331" tabindex="-1"></a>    model.glm <span class="ot">&lt;-</span> <span class="fu">fregre.glm</span>(f, <span class="at">family =</span> <span class="fu">binomial</span>(), <span class="at">data =</span> ldata,</span>
<span id="cb266-332"><a href="simulace3sigma.html#cb266-332" tabindex="-1"></a>                            <span class="at">basis.x =</span> basis.x, <span class="at">basis.b =</span> basis.b)</span>
<span id="cb266-333"><a href="simulace3sigma.html#cb266-333" tabindex="-1"></a>    </span>
<span id="cb266-334"><a href="simulace3sigma.html#cb266-334" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-335"><a href="simulace3sigma.html#cb266-335" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> ldata)</span>
<span id="cb266-336"><a href="simulace3sigma.html#cb266-336" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.train <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb266-337"><a href="simulace3sigma.html#cb266-337" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb266-338"><a href="simulace3sigma.html#cb266-338" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-339"><a href="simulace3sigma.html#cb266-339" tabindex="-1"></a>      </span>
<span id="cb266-340"><a href="simulace3sigma.html#cb266-340" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-341"><a href="simulace3sigma.html#cb266-341" tabindex="-1"></a>    newldata <span class="ot">=</span> <span class="fu">list</span>(<span class="st">&quot;df&quot;</span> <span class="ot">=</span> <span class="fu">as.data.frame</span>(Y.test), <span class="st">&quot;x&quot;</span> <span class="ot">=</span> <span class="fu">fdata</span>(X.test))</span>
<span id="cb266-342"><a href="simulace3sigma.html#cb266-342" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(model.glm, <span class="at">newx =</span> newldata)</span>
<span id="cb266-343"><a href="simulace3sigma.html#cb266-343" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Y.pred =</span> <span class="fu">ifelse</span>(predictions.test <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb266-344"><a href="simulace3sigma.html#cb266-344" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test<span class="sc">$</span>Y.pred) <span class="sc">|&gt;</span></span>
<span id="cb266-345"><a href="simulace3sigma.html#cb266-345" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-346"><a href="simulace3sigma.html#cb266-346" tabindex="-1"></a>    </span>
<span id="cb266-347"><a href="simulace3sigma.html#cb266-347" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;LR_functional&#39;</span>, </span>
<span id="cb266-348"><a href="simulace3sigma.html#cb266-348" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-349"><a href="simulace3sigma.html#cb266-349" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-350"><a href="simulace3sigma.html#cb266-350" tabindex="-1"></a>    </span>
<span id="cb266-351"><a href="simulace3sigma.html#cb266-351" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-352"><a href="simulace3sigma.html#cb266-352" tabindex="-1"></a>    </span>
<span id="cb266-353"><a href="simulace3sigma.html#cb266-353" tabindex="-1"></a>    <span class="do">## 6) Náhodné lesy</span></span>
<span id="cb266-354"><a href="simulace3sigma.html#cb266-354" tabindex="-1"></a>  </span>
<span id="cb266-355"><a href="simulace3sigma.html#cb266-355" tabindex="-1"></a>    <span class="do">### 6.1) Diskretizace intervalu</span></span>
<span id="cb266-356"><a href="simulace3sigma.html#cb266-356" tabindex="-1"></a>    </span>
<span id="cb266-357"><a href="simulace3sigma.html#cb266-357" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb266-358"><a href="simulace3sigma.html#cb266-358" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb266-359"><a href="simulace3sigma.html#cb266-359" tabindex="-1"></a>       </span>
<span id="cb266-360"><a href="simulace3sigma.html#cb266-360" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb266-361"><a href="simulace3sigma.html#cb266-361" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) <span class="co"># transpozice kvuli funkcim v radku</span></span>
<span id="cb266-362"><a href="simulace3sigma.html#cb266-362" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb266-363"><a href="simulace3sigma.html#cb266-363" tabindex="-1"></a>    </span>
<span id="cb266-364"><a href="simulace3sigma.html#cb266-364" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb266-365"><a href="simulace3sigma.html#cb266-365" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb266-366"><a href="simulace3sigma.html#cb266-366" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb266-367"><a href="simulace3sigma.html#cb266-367" tabindex="-1"></a>    </span>
<span id="cb266-368"><a href="simulace3sigma.html#cb266-368" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-369"><a href="simulace3sigma.html#cb266-369" tabindex="-1"></a>    clf.RF <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data, </span>
<span id="cb266-370"><a href="simulace3sigma.html#cb266-370" tabindex="-1"></a>                           <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb266-371"><a href="simulace3sigma.html#cb266-371" tabindex="-1"></a>                           <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-372"><a href="simulace3sigma.html#cb266-372" tabindex="-1"></a>                           <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb266-373"><a href="simulace3sigma.html#cb266-373" tabindex="-1"></a>    </span>
<span id="cb266-374"><a href="simulace3sigma.html#cb266-374" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-375"><a href="simulace3sigma.html#cb266-375" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data)</span>
<span id="cb266-376"><a href="simulace3sigma.html#cb266-376" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb266-377"><a href="simulace3sigma.html#cb266-377" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-378"><a href="simulace3sigma.html#cb266-378" tabindex="-1"></a>      </span>
<span id="cb266-379"><a href="simulace3sigma.html#cb266-379" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-380"><a href="simulace3sigma.html#cb266-380" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb266-381"><a href="simulace3sigma.html#cb266-381" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-382"><a href="simulace3sigma.html#cb266-382" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-383"><a href="simulace3sigma.html#cb266-383" tabindex="-1"></a>    </span>
<span id="cb266-384"><a href="simulace3sigma.html#cb266-384" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_discr&#39;</span>, </span>
<span id="cb266-385"><a href="simulace3sigma.html#cb266-385" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-386"><a href="simulace3sigma.html#cb266-386" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-387"><a href="simulace3sigma.html#cb266-387" tabindex="-1"></a>    </span>
<span id="cb266-388"><a href="simulace3sigma.html#cb266-388" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-389"><a href="simulace3sigma.html#cb266-389" tabindex="-1"></a>    </span>
<span id="cb266-390"><a href="simulace3sigma.html#cb266-390" tabindex="-1"></a>    <span class="do">### 6.2) Skóre hlavních komponent</span></span>
<span id="cb266-391"><a href="simulace3sigma.html#cb266-391" tabindex="-1"></a>    </span>
<span id="cb266-392"><a href="simulace3sigma.html#cb266-392" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-393"><a href="simulace3sigma.html#cb266-393" tabindex="-1"></a>    clf.RF.PCA <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train, </span>
<span id="cb266-394"><a href="simulace3sigma.html#cb266-394" tabindex="-1"></a>                               <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb266-395"><a href="simulace3sigma.html#cb266-395" tabindex="-1"></a>                               <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-396"><a href="simulace3sigma.html#cb266-396" tabindex="-1"></a>                               <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb266-397"><a href="simulace3sigma.html#cb266-397" tabindex="-1"></a>    </span>
<span id="cb266-398"><a href="simulace3sigma.html#cb266-398" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-399"><a href="simulace3sigma.html#cb266-399" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-400"><a href="simulace3sigma.html#cb266-400" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb266-401"><a href="simulace3sigma.html#cb266-401" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-402"><a href="simulace3sigma.html#cb266-402" tabindex="-1"></a>      </span>
<span id="cb266-403"><a href="simulace3sigma.html#cb266-403" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-404"><a href="simulace3sigma.html#cb266-404" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-405"><a href="simulace3sigma.html#cb266-405" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-406"><a href="simulace3sigma.html#cb266-406" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-407"><a href="simulace3sigma.html#cb266-407" tabindex="-1"></a>    </span>
<span id="cb266-408"><a href="simulace3sigma.html#cb266-408" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_score&#39;</span>, </span>
<span id="cb266-409"><a href="simulace3sigma.html#cb266-409" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-410"><a href="simulace3sigma.html#cb266-410" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-411"><a href="simulace3sigma.html#cb266-411" tabindex="-1"></a>    </span>
<span id="cb266-412"><a href="simulace3sigma.html#cb266-412" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-413"><a href="simulace3sigma.html#cb266-413" tabindex="-1"></a>    </span>
<span id="cb266-414"><a href="simulace3sigma.html#cb266-414" tabindex="-1"></a>    <span class="do">### 6.3) Bázové koeficienty</span></span>
<span id="cb266-415"><a href="simulace3sigma.html#cb266-415" tabindex="-1"></a></span>
<span id="cb266-416"><a href="simulace3sigma.html#cb266-416" tabindex="-1"></a>    <span class="co"># trenovaci dataset</span></span>
<span id="cb266-417"><a href="simulace3sigma.html#cb266-417" tabindex="-1"></a>    data.Bbasis.train <span class="ot">&lt;-</span> <span class="fu">t</span>(X.train<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb266-418"><a href="simulace3sigma.html#cb266-418" tabindex="-1"></a>    data.Bbasis.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb266-419"><a href="simulace3sigma.html#cb266-419" tabindex="-1"></a>    </span>
<span id="cb266-420"><a href="simulace3sigma.html#cb266-420" tabindex="-1"></a>    <span class="co"># testovaci dataset</span></span>
<span id="cb266-421"><a href="simulace3sigma.html#cb266-421" tabindex="-1"></a>    data.Bbasis.test <span class="ot">&lt;-</span> <span class="fu">t</span>(X.test<span class="sc">$</span>coefs) <span class="sc">|&gt;</span> <span class="fu">as.data.frame</span>()</span>
<span id="cb266-422"><a href="simulace3sigma.html#cb266-422" tabindex="-1"></a>    data.Bbasis.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb266-423"><a href="simulace3sigma.html#cb266-423" tabindex="-1"></a>    </span>
<span id="cb266-424"><a href="simulace3sigma.html#cb266-424" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-425"><a href="simulace3sigma.html#cb266-425" tabindex="-1"></a>    clf.RF.Bbasis <span class="ot">&lt;-</span> <span class="fu">randomForest</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train, </span>
<span id="cb266-426"><a href="simulace3sigma.html#cb266-426" tabindex="-1"></a>                                  <span class="at">ntree =</span> <span class="dv">500</span>, <span class="co"># pocet stromu</span></span>
<span id="cb266-427"><a href="simulace3sigma.html#cb266-427" tabindex="-1"></a>                                  <span class="at">importance =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-428"><a href="simulace3sigma.html#cb266-428" tabindex="-1"></a>                                  <span class="at">nodesize =</span> <span class="dv">5</span>)</span>
<span id="cb266-429"><a href="simulace3sigma.html#cb266-429" tabindex="-1"></a>    </span>
<span id="cb266-430"><a href="simulace3sigma.html#cb266-430" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-431"><a href="simulace3sigma.html#cb266-431" tabindex="-1"></a>    predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb266-432"><a href="simulace3sigma.html#cb266-432" tabindex="-1"></a>    presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb266-433"><a href="simulace3sigma.html#cb266-433" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-434"><a href="simulace3sigma.html#cb266-434" tabindex="-1"></a>      </span>
<span id="cb266-435"><a href="simulace3sigma.html#cb266-435" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-436"><a href="simulace3sigma.html#cb266-436" tabindex="-1"></a>    predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.RF.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb266-437"><a href="simulace3sigma.html#cb266-437" tabindex="-1"></a>    presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-438"><a href="simulace3sigma.html#cb266-438" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-439"><a href="simulace3sigma.html#cb266-439" tabindex="-1"></a>    </span>
<span id="cb266-440"><a href="simulace3sigma.html#cb266-440" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="st">&#39;RF_Bbasis&#39;</span>, </span>
<span id="cb266-441"><a href="simulace3sigma.html#cb266-441" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.train,</span>
<span id="cb266-442"><a href="simulace3sigma.html#cb266-442" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test)</span>
<span id="cb266-443"><a href="simulace3sigma.html#cb266-443" tabindex="-1"></a>    </span>
<span id="cb266-444"><a href="simulace3sigma.html#cb266-444" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-445"><a href="simulace3sigma.html#cb266-445" tabindex="-1"></a>      </span>
<span id="cb266-446"><a href="simulace3sigma.html#cb266-446" tabindex="-1"></a>    <span class="do">## 7) SVM</span></span>
<span id="cb266-447"><a href="simulace3sigma.html#cb266-447" tabindex="-1"></a>    </span>
<span id="cb266-448"><a href="simulace3sigma.html#cb266-448" tabindex="-1"></a>    <span class="do">### 7.1) Diskretizace intervalu</span></span>
<span id="cb266-449"><a href="simulace3sigma.html#cb266-449" tabindex="-1"></a>    </span>
<span id="cb266-450"><a href="simulace3sigma.html#cb266-450" tabindex="-1"></a>    <span class="co"># posloupnost bodu, ve kterych funkce vyhodnotime</span></span>
<span id="cb266-451"><a href="simulace3sigma.html#cb266-451" tabindex="-1"></a>    t.seq <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">6</span>, <span class="at">length =</span> <span class="dv">101</span>)</span>
<span id="cb266-452"><a href="simulace3sigma.html#cb266-452" tabindex="-1"></a>    </span>
<span id="cb266-453"><a href="simulace3sigma.html#cb266-453" tabindex="-1"></a>    <span class="co"># normovani dat</span></span>
<span id="cb266-454"><a href="simulace3sigma.html#cb266-454" tabindex="-1"></a>    norms <span class="ot">&lt;-</span> <span class="fu">c</span>()</span>
<span id="cb266-455"><a href="simulace3sigma.html#cb266-455" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>]) {</span>
<span id="cb266-456"><a href="simulace3sigma.html#cb266-456" tabindex="-1"></a>      norms <span class="ot">&lt;-</span> <span class="fu">c</span>(norms, <span class="fu">as.numeric</span>(<span class="dv">1</span> <span class="sc">/</span> <span class="fu">norm.fd</span>(XXfd[i])))</span>
<span id="cb266-457"><a href="simulace3sigma.html#cb266-457" tabindex="-1"></a>      }</span>
<span id="cb266-458"><a href="simulace3sigma.html#cb266-458" tabindex="-1"></a>    XXfd_norm <span class="ot">&lt;-</span> XXfd </span>
<span id="cb266-459"><a href="simulace3sigma.html#cb266-459" tabindex="-1"></a>    XXfd_norm<span class="sc">$</span>coefs <span class="ot">&lt;-</span> XXfd_norm<span class="sc">$</span>coefs <span class="sc">*</span> <span class="fu">matrix</span>(norms, </span>
<span id="cb266-460"><a href="simulace3sigma.html#cb266-460" tabindex="-1"></a>                                                <span class="at">ncol =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">2</span>],</span>
<span id="cb266-461"><a href="simulace3sigma.html#cb266-461" tabindex="-1"></a>                                                <span class="at">nrow =</span> <span class="fu">dim</span>(XXfd<span class="sc">$</span>coefs)[<span class="dv">1</span>],</span>
<span id="cb266-462"><a href="simulace3sigma.html#cb266-462" tabindex="-1"></a>                                                <span class="at">byrow =</span> T)</span>
<span id="cb266-463"><a href="simulace3sigma.html#cb266-463" tabindex="-1"></a>    </span>
<span id="cb266-464"><a href="simulace3sigma.html#cb266-464" tabindex="-1"></a>    <span class="co"># rozdeleni na testovaci a trenovaci cast</span></span>
<span id="cb266-465"><a href="simulace3sigma.html#cb266-465" tabindex="-1"></a>    X.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-466"><a href="simulace3sigma.html#cb266-466" tabindex="-1"></a>    X.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(XXfd_norm, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-467"><a href="simulace3sigma.html#cb266-467" tabindex="-1"></a>    </span>
<span id="cb266-468"><a href="simulace3sigma.html#cb266-468" tabindex="-1"></a>    Y.train_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-469"><a href="simulace3sigma.html#cb266-469" tabindex="-1"></a>    Y.test_norm <span class="ot">&lt;-</span> <span class="fu">subset</span>(Y, split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-470"><a href="simulace3sigma.html#cb266-470" tabindex="-1"></a>    </span>
<span id="cb266-471"><a href="simulace3sigma.html#cb266-471" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.train_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb266-472"><a href="simulace3sigma.html#cb266-472" tabindex="-1"></a>    grid.data <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data)) </span>
<span id="cb266-473"><a href="simulace3sigma.html#cb266-473" tabindex="-1"></a>    grid.data<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.train_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb266-474"><a href="simulace3sigma.html#cb266-474" tabindex="-1"></a>    </span>
<span id="cb266-475"><a href="simulace3sigma.html#cb266-475" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">eval.fd</span>(<span class="at">fdobj =</span> X.test_norm, <span class="at">evalarg =</span> t.seq)</span>
<span id="cb266-476"><a href="simulace3sigma.html#cb266-476" tabindex="-1"></a>    grid.data.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(grid.data.test))</span>
<span id="cb266-477"><a href="simulace3sigma.html#cb266-477" tabindex="-1"></a>    grid.data.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> Y.test_norm <span class="sc">|&gt;</span> <span class="fu">factor</span>()</span>
<span id="cb266-478"><a href="simulace3sigma.html#cb266-478" tabindex="-1"></a></span>
<span id="cb266-479"><a href="simulace3sigma.html#cb266-479" tabindex="-1"></a>    clf.SVM.l <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb266-480"><a href="simulace3sigma.html#cb266-480" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-481"><a href="simulace3sigma.html#cb266-481" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-482"><a href="simulace3sigma.html#cb266-482" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb266-483"><a href="simulace3sigma.html#cb266-483" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb266-484"><a href="simulace3sigma.html#cb266-484" tabindex="-1"></a>    </span>
<span id="cb266-485"><a href="simulace3sigma.html#cb266-485" tabindex="-1"></a>    clf.SVM.p <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb266-486"><a href="simulace3sigma.html#cb266-486" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-487"><a href="simulace3sigma.html#cb266-487" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-488"><a href="simulace3sigma.html#cb266-488" tabindex="-1"></a>                     <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-489"><a href="simulace3sigma.html#cb266-489" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100</span>,</span>
<span id="cb266-490"><a href="simulace3sigma.html#cb266-490" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb266-491"><a href="simulace3sigma.html#cb266-491" tabindex="-1"></a>    </span>
<span id="cb266-492"><a href="simulace3sigma.html#cb266-492" tabindex="-1"></a>    clf.SVM.r <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> grid.data,</span>
<span id="cb266-493"><a href="simulace3sigma.html#cb266-493" tabindex="-1"></a>                     <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-494"><a href="simulace3sigma.html#cb266-494" tabindex="-1"></a>                     <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-495"><a href="simulace3sigma.html#cb266-495" tabindex="-1"></a>                     <span class="at">cost =</span> <span class="dv">100000</span>,</span>
<span id="cb266-496"><a href="simulace3sigma.html#cb266-496" tabindex="-1"></a>                     <span class="at">gamma =</span> <span class="fl">0.0001</span>,</span>
<span id="cb266-497"><a href="simulace3sigma.html#cb266-497" tabindex="-1"></a>                     <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb266-498"><a href="simulace3sigma.html#cb266-498" tabindex="-1"></a>    </span>
<span id="cb266-499"><a href="simulace3sigma.html#cb266-499" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-500"><a href="simulace3sigma.html#cb266-500" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data)</span>
<span id="cb266-501"><a href="simulace3sigma.html#cb266-501" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb266-502"><a href="simulace3sigma.html#cb266-502" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-503"><a href="simulace3sigma.html#cb266-503" tabindex="-1"></a>    </span>
<span id="cb266-504"><a href="simulace3sigma.html#cb266-504" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data)</span>
<span id="cb266-505"><a href="simulace3sigma.html#cb266-505" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb266-506"><a href="simulace3sigma.html#cb266-506" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-507"><a href="simulace3sigma.html#cb266-507" tabindex="-1"></a>    </span>
<span id="cb266-508"><a href="simulace3sigma.html#cb266-508" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data)</span>
<span id="cb266-509"><a href="simulace3sigma.html#cb266-509" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb266-510"><a href="simulace3sigma.html#cb266-510" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-511"><a href="simulace3sigma.html#cb266-511" tabindex="-1"></a>    </span>
<span id="cb266-512"><a href="simulace3sigma.html#cb266-512" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb266-513"><a href="simulace3sigma.html#cb266-513" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb266-514"><a href="simulace3sigma.html#cb266-514" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb266-515"><a href="simulace3sigma.html#cb266-515" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-516"><a href="simulace3sigma.html#cb266-516" tabindex="-1"></a>    </span>
<span id="cb266-517"><a href="simulace3sigma.html#cb266-517" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb266-518"><a href="simulace3sigma.html#cb266-518" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb266-519"><a href="simulace3sigma.html#cb266-519" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-520"><a href="simulace3sigma.html#cb266-520" tabindex="-1"></a>    </span>
<span id="cb266-521"><a href="simulace3sigma.html#cb266-521" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r, <span class="at">newdata =</span> grid.data.test)</span>
<span id="cb266-522"><a href="simulace3sigma.html#cb266-522" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb266-523"><a href="simulace3sigma.html#cb266-523" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-524"><a href="simulace3sigma.html#cb266-524" tabindex="-1"></a>    </span>
<span id="cb266-525"><a href="simulace3sigma.html#cb266-525" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - diskr&#39;</span>, </span>
<span id="cb266-526"><a href="simulace3sigma.html#cb266-526" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - diskr&#39;</span>, </span>
<span id="cb266-527"><a href="simulace3sigma.html#cb266-527" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - diskr&#39;</span>), </span>
<span id="cb266-528"><a href="simulace3sigma.html#cb266-528" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l,</span>
<span id="cb266-529"><a href="simulace3sigma.html#cb266-529" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb266-530"><a href="simulace3sigma.html#cb266-530" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb266-531"><a href="simulace3sigma.html#cb266-531" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb266-532"><a href="simulace3sigma.html#cb266-532" tabindex="-1"></a>    </span>
<span id="cb266-533"><a href="simulace3sigma.html#cb266-533" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-534"><a href="simulace3sigma.html#cb266-534" tabindex="-1"></a>    </span>
<span id="cb266-535"><a href="simulace3sigma.html#cb266-535" tabindex="-1"></a>    <span class="do">### 7.2) Skóre hlavních komponent</span></span>
<span id="cb266-536"><a href="simulace3sigma.html#cb266-536" tabindex="-1"></a>    </span>
<span id="cb266-537"><a href="simulace3sigma.html#cb266-537" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-538"><a href="simulace3sigma.html#cb266-538" tabindex="-1"></a>    clf.SVM.l.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb266-539"><a href="simulace3sigma.html#cb266-539" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-540"><a href="simulace3sigma.html#cb266-540" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-541"><a href="simulace3sigma.html#cb266-541" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="fl">0.01</span>,</span>
<span id="cb266-542"><a href="simulace3sigma.html#cb266-542" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb266-543"><a href="simulace3sigma.html#cb266-543" tabindex="-1"></a>    </span>
<span id="cb266-544"><a href="simulace3sigma.html#cb266-544" tabindex="-1"></a>    clf.SVM.p.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb266-545"><a href="simulace3sigma.html#cb266-545" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-546"><a href="simulace3sigma.html#cb266-546" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-547"><a href="simulace3sigma.html#cb266-547" tabindex="-1"></a>                         <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-548"><a href="simulace3sigma.html#cb266-548" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="fl">0.6</span>,</span>
<span id="cb266-549"><a href="simulace3sigma.html#cb266-549" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb266-550"><a href="simulace3sigma.html#cb266-550" tabindex="-1"></a>    </span>
<span id="cb266-551"><a href="simulace3sigma.html#cb266-551" tabindex="-1"></a>    clf.SVM.r.PCA <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.PCA.train,</span>
<span id="cb266-552"><a href="simulace3sigma.html#cb266-552" tabindex="-1"></a>                         <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-553"><a href="simulace3sigma.html#cb266-553" tabindex="-1"></a>                         <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-554"><a href="simulace3sigma.html#cb266-554" tabindex="-1"></a>                         <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb266-555"><a href="simulace3sigma.html#cb266-555" tabindex="-1"></a>                         <span class="at">gamma =</span> <span class="fl">0.01</span>,</span>
<span id="cb266-556"><a href="simulace3sigma.html#cb266-556" tabindex="-1"></a>                         <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb266-557"><a href="simulace3sigma.html#cb266-557" tabindex="-1"></a>    </span>
<span id="cb266-558"><a href="simulace3sigma.html#cb266-558" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-559"><a href="simulace3sigma.html#cb266-559" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-560"><a href="simulace3sigma.html#cb266-560" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb266-561"><a href="simulace3sigma.html#cb266-561" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-562"><a href="simulace3sigma.html#cb266-562" tabindex="-1"></a>    </span>
<span id="cb266-563"><a href="simulace3sigma.html#cb266-563" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-564"><a href="simulace3sigma.html#cb266-564" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb266-565"><a href="simulace3sigma.html#cb266-565" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-566"><a href="simulace3sigma.html#cb266-566" tabindex="-1"></a>    </span>
<span id="cb266-567"><a href="simulace3sigma.html#cb266-567" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.train)</span>
<span id="cb266-568"><a href="simulace3sigma.html#cb266-568" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.train<span class="sc">$</span>Y, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb266-569"><a href="simulace3sigma.html#cb266-569" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-570"><a href="simulace3sigma.html#cb266-570" tabindex="-1"></a>      </span>
<span id="cb266-571"><a href="simulace3sigma.html#cb266-571" tabindex="-1"></a>    <span class="co"># presnost na testovacich datech</span></span>
<span id="cb266-572"><a href="simulace3sigma.html#cb266-572" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-573"><a href="simulace3sigma.html#cb266-573" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb266-574"><a href="simulace3sigma.html#cb266-574" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-575"><a href="simulace3sigma.html#cb266-575" tabindex="-1"></a>    </span>
<span id="cb266-576"><a href="simulace3sigma.html#cb266-576" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-577"><a href="simulace3sigma.html#cb266-577" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb266-578"><a href="simulace3sigma.html#cb266-578" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-579"><a href="simulace3sigma.html#cb266-579" tabindex="-1"></a>    </span>
<span id="cb266-580"><a href="simulace3sigma.html#cb266-580" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.PCA, <span class="at">newdata =</span> data.PCA.test)</span>
<span id="cb266-581"><a href="simulace3sigma.html#cb266-581" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(data.PCA.test<span class="sc">$</span>Y, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb266-582"><a href="simulace3sigma.html#cb266-582" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-583"><a href="simulace3sigma.html#cb266-583" tabindex="-1"></a>    </span>
<span id="cb266-584"><a href="simulace3sigma.html#cb266-584" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - PCA&#39;</span>, </span>
<span id="cb266-585"><a href="simulace3sigma.html#cb266-585" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - PCA&#39;</span>, </span>
<span id="cb266-586"><a href="simulace3sigma.html#cb266-586" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - PCA&#39;</span>), </span>
<span id="cb266-587"><a href="simulace3sigma.html#cb266-587" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb266-588"><a href="simulace3sigma.html#cb266-588" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb266-589"><a href="simulace3sigma.html#cb266-589" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb266-590"><a href="simulace3sigma.html#cb266-590" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb266-591"><a href="simulace3sigma.html#cb266-591" tabindex="-1"></a>    </span>
<span id="cb266-592"><a href="simulace3sigma.html#cb266-592" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-593"><a href="simulace3sigma.html#cb266-593" tabindex="-1"></a>    </span>
<span id="cb266-594"><a href="simulace3sigma.html#cb266-594" tabindex="-1"></a>    <span class="do">### 7.3) Bázové koeficienty</span></span>
<span id="cb266-595"><a href="simulace3sigma.html#cb266-595" tabindex="-1"></a>    </span>
<span id="cb266-596"><a href="simulace3sigma.html#cb266-596" tabindex="-1"></a>    <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-597"><a href="simulace3sigma.html#cb266-597" tabindex="-1"></a>    clf.SVM.l.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb266-598"><a href="simulace3sigma.html#cb266-598" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-599"><a href="simulace3sigma.html#cb266-599" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-600"><a href="simulace3sigma.html#cb266-600" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb266-601"><a href="simulace3sigma.html#cb266-601" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb266-602"><a href="simulace3sigma.html#cb266-602" tabindex="-1"></a>    </span>
<span id="cb266-603"><a href="simulace3sigma.html#cb266-603" tabindex="-1"></a>    clf.SVM.p.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb266-604"><a href="simulace3sigma.html#cb266-604" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-605"><a href="simulace3sigma.html#cb266-605" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-606"><a href="simulace3sigma.html#cb266-606" tabindex="-1"></a>                            <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-607"><a href="simulace3sigma.html#cb266-607" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">500</span>,</span>
<span id="cb266-608"><a href="simulace3sigma.html#cb266-608" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb266-609"><a href="simulace3sigma.html#cb266-609" tabindex="-1"></a>    </span>
<span id="cb266-610"><a href="simulace3sigma.html#cb266-610" tabindex="-1"></a>    clf.SVM.r.Bbasis <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.Bbasis.train,</span>
<span id="cb266-611"><a href="simulace3sigma.html#cb266-611" tabindex="-1"></a>                            <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-612"><a href="simulace3sigma.html#cb266-612" tabindex="-1"></a>                            <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-613"><a href="simulace3sigma.html#cb266-613" tabindex="-1"></a>                            <span class="at">cost =</span> <span class="dv">1000</span>,</span>
<span id="cb266-614"><a href="simulace3sigma.html#cb266-614" tabindex="-1"></a>                            <span class="at">gamma =</span> <span class="fl">0.005</span>,</span>
<span id="cb266-615"><a href="simulace3sigma.html#cb266-615" tabindex="-1"></a>                            <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb266-616"><a href="simulace3sigma.html#cb266-616" tabindex="-1"></a>    </span>
<span id="cb266-617"><a href="simulace3sigma.html#cb266-617" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-618"><a href="simulace3sigma.html#cb266-618" tabindex="-1"></a>    predictions.train.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb266-619"><a href="simulace3sigma.html#cb266-619" tabindex="-1"></a>    presnost.train.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.l) <span class="sc">|&gt;</span></span>
<span id="cb266-620"><a href="simulace3sigma.html#cb266-620" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-621"><a href="simulace3sigma.html#cb266-621" tabindex="-1"></a>    </span>
<span id="cb266-622"><a href="simulace3sigma.html#cb266-622" tabindex="-1"></a>    predictions.train.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb266-623"><a href="simulace3sigma.html#cb266-623" tabindex="-1"></a>    presnost.train.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.p) <span class="sc">|&gt;</span></span>
<span id="cb266-624"><a href="simulace3sigma.html#cb266-624" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-625"><a href="simulace3sigma.html#cb266-625" tabindex="-1"></a>    </span>
<span id="cb266-626"><a href="simulace3sigma.html#cb266-626" tabindex="-1"></a>    predictions.train.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.train)</span>
<span id="cb266-627"><a href="simulace3sigma.html#cb266-627" tabindex="-1"></a>    presnost.train.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train.r) <span class="sc">|&gt;</span></span>
<span id="cb266-628"><a href="simulace3sigma.html#cb266-628" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-629"><a href="simulace3sigma.html#cb266-629" tabindex="-1"></a>      </span>
<span id="cb266-630"><a href="simulace3sigma.html#cb266-630" tabindex="-1"></a>    <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-631"><a href="simulace3sigma.html#cb266-631" tabindex="-1"></a>    predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb266-632"><a href="simulace3sigma.html#cb266-632" tabindex="-1"></a>    presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb266-633"><a href="simulace3sigma.html#cb266-633" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-634"><a href="simulace3sigma.html#cb266-634" tabindex="-1"></a>    </span>
<span id="cb266-635"><a href="simulace3sigma.html#cb266-635" tabindex="-1"></a>    predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb266-636"><a href="simulace3sigma.html#cb266-636" tabindex="-1"></a>    presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb266-637"><a href="simulace3sigma.html#cb266-637" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-638"><a href="simulace3sigma.html#cb266-638" tabindex="-1"></a>    </span>
<span id="cb266-639"><a href="simulace3sigma.html#cb266-639" tabindex="-1"></a>    predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.Bbasis, <span class="at">newdata =</span> data.Bbasis.test)</span>
<span id="cb266-640"><a href="simulace3sigma.html#cb266-640" tabindex="-1"></a>    presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb266-641"><a href="simulace3sigma.html#cb266-641" tabindex="-1"></a>      <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-642"><a href="simulace3sigma.html#cb266-642" tabindex="-1"></a>    </span>
<span id="cb266-643"><a href="simulace3sigma.html#cb266-643" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - Bbasis&#39;</span>, </span>
<span id="cb266-644"><a href="simulace3sigma.html#cb266-644" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - Bbasis&#39;</span>, </span>
<span id="cb266-645"><a href="simulace3sigma.html#cb266-645" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - Bbasis&#39;</span>), </span>
<span id="cb266-646"><a href="simulace3sigma.html#cb266-646" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train.l, </span>
<span id="cb266-647"><a href="simulace3sigma.html#cb266-647" tabindex="-1"></a>                                        presnost.train.p, presnost.train.r),</span>
<span id="cb266-648"><a href="simulace3sigma.html#cb266-648" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.test.l, </span>
<span id="cb266-649"><a href="simulace3sigma.html#cb266-649" tabindex="-1"></a>                                       presnost.test.p, presnost.test.r))</span>
<span id="cb266-650"><a href="simulace3sigma.html#cb266-650" tabindex="-1"></a>  </span>
<span id="cb266-651"><a href="simulace3sigma.html#cb266-651" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-652"><a href="simulace3sigma.html#cb266-652" tabindex="-1"></a>    </span>
<span id="cb266-653"><a href="simulace3sigma.html#cb266-653" tabindex="-1"></a>    <span class="do">### 7.4) Projekce na B-splinovou bázi</span></span>
<span id="cb266-654"><a href="simulace3sigma.html#cb266-654" tabindex="-1"></a>    </span>
<span id="cb266-655"><a href="simulace3sigma.html#cb266-655" tabindex="-1"></a>    <span class="co"># hodnoty pro B-splinovou bazi</span></span>
<span id="cb266-656"><a href="simulace3sigma.html#cb266-656" tabindex="-1"></a>    rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(t)</span>
<span id="cb266-657"><a href="simulace3sigma.html#cb266-657" tabindex="-1"></a>    norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb266-658"><a href="simulace3sigma.html#cb266-658" tabindex="-1"></a>    n_basis_min <span class="ot">&lt;-</span> norder</span>
<span id="cb266-659"><a href="simulace3sigma.html#cb266-659" tabindex="-1"></a>    n_basis_max <span class="ot">&lt;-</span> <span class="dv">20</span> <span class="co"># length(t) + norder - 2 - 10</span></span>
<span id="cb266-660"><a href="simulace3sigma.html#cb266-660" tabindex="-1"></a>    dimensions <span class="ot">&lt;-</span> n_basis_min<span class="sc">:</span>n_basis_max </span>
<span id="cb266-661"><a href="simulace3sigma.html#cb266-661" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb266-662"><a href="simulace3sigma.html#cb266-662" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">SVM.l =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb266-663"><a href="simulace3sigma.html#cb266-663" tabindex="-1"></a>                       <span class="at">SVM.p =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv),</span>
<span id="cb266-664"><a href="simulace3sigma.html#cb266-664" tabindex="-1"></a>                       <span class="at">SVM.r =</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, <span class="at">nrow =</span> <span class="fu">length</span>(dimensions), <span class="at">ncol =</span> k_cv))</span>
<span id="cb266-665"><a href="simulace3sigma.html#cb266-665" tabindex="-1"></a>    </span>
<span id="cb266-666"><a href="simulace3sigma.html#cb266-666" tabindex="-1"></a>    <span class="cf">for</span> (d <span class="cf">in</span> dimensions) {</span>
<span id="cb266-667"><a href="simulace3sigma.html#cb266-667" tabindex="-1"></a>      bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb266-668"><a href="simulace3sigma.html#cb266-668" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d)</span>
<span id="cb266-669"><a href="simulace3sigma.html#cb266-669" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb266-670"><a href="simulace3sigma.html#cb266-670" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-671"><a href="simulace3sigma.html#cb266-671" tabindex="-1"></a>      </span>
<span id="cb266-672"><a href="simulace3sigma.html#cb266-672" tabindex="-1"></a>      <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb266-673"><a href="simulace3sigma.html#cb266-673" tabindex="-1"></a>        fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb266-674"><a href="simulace3sigma.html#cb266-674" tabindex="-1"></a>        cv_sample <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(XX.train)[<span class="dv">1</span>] <span class="sc">%in%</span> fold</span>
<span id="cb266-675"><a href="simulace3sigma.html#cb266-675" tabindex="-1"></a>        </span>
<span id="cb266-676"><a href="simulace3sigma.html#cb266-676" tabindex="-1"></a>        data.projection.train.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[cv_sample, ])</span>
<span id="cb266-677"><a href="simulace3sigma.html#cb266-677" tabindex="-1"></a>        data.projection.train.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[cv_sample])</span>
<span id="cb266-678"><a href="simulace3sigma.html#cb266-678" tabindex="-1"></a>        data.projection.test.cv <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train[<span class="sc">!</span>cv_sample, ])</span>
<span id="cb266-679"><a href="simulace3sigma.html#cb266-679" tabindex="-1"></a>        Y.test.cv <span class="ot">&lt;-</span> Y.train[<span class="sc">!</span>cv_sample]</span>
<span id="cb266-680"><a href="simulace3sigma.html#cb266-680" tabindex="-1"></a>        data.projection.test.cv<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test.cv)</span>
<span id="cb266-681"><a href="simulace3sigma.html#cb266-681" tabindex="-1"></a>        <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-682"><a href="simulace3sigma.html#cb266-682" tabindex="-1"></a>        clf.SVM.l.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb266-683"><a href="simulace3sigma.html#cb266-683" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-684"><a href="simulace3sigma.html#cb266-684" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-685"><a href="simulace3sigma.html#cb266-685" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;linear&#39;</span>)</span>
<span id="cb266-686"><a href="simulace3sigma.html#cb266-686" tabindex="-1"></a>        </span>
<span id="cb266-687"><a href="simulace3sigma.html#cb266-687" tabindex="-1"></a>        clf.SVM.p.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb266-688"><a href="simulace3sigma.html#cb266-688" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-689"><a href="simulace3sigma.html#cb266-689" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-690"><a href="simulace3sigma.html#cb266-690" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-691"><a href="simulace3sigma.html#cb266-691" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;polynomial&#39;</span>)</span>
<span id="cb266-692"><a href="simulace3sigma.html#cb266-692" tabindex="-1"></a>        </span>
<span id="cb266-693"><a href="simulace3sigma.html#cb266-693" tabindex="-1"></a>        clf.SVM.r.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train.cv,</span>
<span id="cb266-694"><a href="simulace3sigma.html#cb266-694" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-695"><a href="simulace3sigma.html#cb266-695" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-696"><a href="simulace3sigma.html#cb266-696" tabindex="-1"></a>                                <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>)</span>
<span id="cb266-697"><a href="simulace3sigma.html#cb266-697" tabindex="-1"></a>        <span class="co"># presnost na validacnich datech</span></span>
<span id="cb266-698"><a href="simulace3sigma.html#cb266-698" tabindex="-1"></a>        <span class="do">## linear kernel</span></span>
<span id="cb266-699"><a href="simulace3sigma.html#cb266-699" tabindex="-1"></a>        predictions.test.l <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.l.projection,</span>
<span id="cb266-700"><a href="simulace3sigma.html#cb266-700" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb266-701"><a href="simulace3sigma.html#cb266-701" tabindex="-1"></a>        presnost.test.l <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.l) <span class="sc">|&gt;</span></span>
<span id="cb266-702"><a href="simulace3sigma.html#cb266-702" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-703"><a href="simulace3sigma.html#cb266-703" tabindex="-1"></a>        <span class="do">## polynomial kernel</span></span>
<span id="cb266-704"><a href="simulace3sigma.html#cb266-704" tabindex="-1"></a>        predictions.test.p <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.p.projection, </span>
<span id="cb266-705"><a href="simulace3sigma.html#cb266-705" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb266-706"><a href="simulace3sigma.html#cb266-706" tabindex="-1"></a>        presnost.test.p <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.p) <span class="sc">|&gt;</span></span>
<span id="cb266-707"><a href="simulace3sigma.html#cb266-707" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-708"><a href="simulace3sigma.html#cb266-708" tabindex="-1"></a>        <span class="do">## radial kernel</span></span>
<span id="cb266-709"><a href="simulace3sigma.html#cb266-709" tabindex="-1"></a>        predictions.test.r <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.r.projection,</span>
<span id="cb266-710"><a href="simulace3sigma.html#cb266-710" tabindex="-1"></a>                                      <span class="at">newdata =</span> data.projection.test.cv)</span>
<span id="cb266-711"><a href="simulace3sigma.html#cb266-711" tabindex="-1"></a>        presnost.test.r <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test.cv, predictions.test.r) <span class="sc">|&gt;</span></span>
<span id="cb266-712"><a href="simulace3sigma.html#cb266-712" tabindex="-1"></a>          <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-713"><a href="simulace3sigma.html#cb266-713" tabindex="-1"></a>        </span>
<span id="cb266-714"><a href="simulace3sigma.html#cb266-714" tabindex="-1"></a>        <span class="co"># presnosti vlozime na pozice pro dane d a fold</span></span>
<span id="cb266-715"><a href="simulace3sigma.html#cb266-715" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.l[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.l</span>
<span id="cb266-716"><a href="simulace3sigma.html#cb266-716" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.p[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.p</span>
<span id="cb266-717"><a href="simulace3sigma.html#cb266-717" tabindex="-1"></a>        CV.results<span class="sc">$</span>SVM.r[d <span class="sc">-</span> <span class="fu">min</span>(dimensions) <span class="sc">+</span> <span class="dv">1</span>, index_cv] <span class="ot">&lt;-</span> presnost.test.r</span>
<span id="cb266-718"><a href="simulace3sigma.html#cb266-718" tabindex="-1"></a>      }</span>
<span id="cb266-719"><a href="simulace3sigma.html#cb266-719" tabindex="-1"></a>    }</span>
<span id="cb266-720"><a href="simulace3sigma.html#cb266-720" tabindex="-1"></a>    </span>
<span id="cb266-721"><a href="simulace3sigma.html#cb266-721" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb266-722"><a href="simulace3sigma.html#cb266-722" tabindex="-1"></a>    <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb266-723"><a href="simulace3sigma.html#cb266-723" tabindex="-1"></a>      CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="dv">1</span>, mean)</span>
<span id="cb266-724"><a href="simulace3sigma.html#cb266-724" tabindex="-1"></a>    }</span>
<span id="cb266-725"><a href="simulace3sigma.html#cb266-725" tabindex="-1"></a>    </span>
<span id="cb266-726"><a href="simulace3sigma.html#cb266-726" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb266-727"><a href="simulace3sigma.html#cb266-727" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>, </span>
<span id="cb266-728"><a href="simulace3sigma.html#cb266-728" tabindex="-1"></a>               <span class="fu">which.max</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">+</span> n_basis_min <span class="sc">-</span> <span class="dv">1</span>)</span>
<span id="cb266-729"><a href="simulace3sigma.html#cb266-729" tabindex="-1"></a>    </span>
<span id="cb266-730"><a href="simulace3sigma.html#cb266-730" tabindex="-1"></a>    <span class="co"># ulozime optimalni d do datove tabulky</span></span>
<span id="cb266-731"><a href="simulace3sigma.html#cb266-731" tabindex="-1"></a>    CV_RESULTS[sim, <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>] <span class="ot">&lt;-</span> d.opt</span>
<span id="cb266-732"><a href="simulace3sigma.html#cb266-732" tabindex="-1"></a>    </span>
<span id="cb266-733"><a href="simulace3sigma.html#cb266-733" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb266-734"><a href="simulace3sigma.html#cb266-734" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - projection&#39;</span>, </span>
<span id="cb266-735"><a href="simulace3sigma.html#cb266-735" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - projection&#39;</span>, </span>
<span id="cb266-736"><a href="simulace3sigma.html#cb266-736" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - projection&#39;</span>), </span>
<span id="cb266-737"><a href="simulace3sigma.html#cb266-737" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb266-738"><a href="simulace3sigma.html#cb266-738" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb266-739"><a href="simulace3sigma.html#cb266-739" tabindex="-1"></a>    </span>
<span id="cb266-740"><a href="simulace3sigma.html#cb266-740" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb266-741"><a href="simulace3sigma.html#cb266-741" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb266-742"><a href="simulace3sigma.html#cb266-742" tabindex="-1"></a>      bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb266-743"><a href="simulace3sigma.html#cb266-743" tabindex="-1"></a>                                     <span class="at">nbasis =</span> d.opt[kernel_number])</span>
<span id="cb266-744"><a href="simulace3sigma.html#cb266-744" tabindex="-1"></a>      Projection <span class="ot">&lt;-</span> <span class="fu">project.basis</span>(<span class="at">y =</span> XX, <span class="at">argvals =</span> t, <span class="at">basisobj =</span> bbasis) </span>
<span id="cb266-745"><a href="simulace3sigma.html#cb266-745" tabindex="-1"></a>      </span>
<span id="cb266-746"><a href="simulace3sigma.html#cb266-746" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">TRUE</span>)</span>
<span id="cb266-747"><a href="simulace3sigma.html#cb266-747" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> <span class="fu">subset</span>(<span class="fu">t</span>(Projection), split <span class="sc">==</span> <span class="cn">FALSE</span>)</span>
<span id="cb266-748"><a href="simulace3sigma.html#cb266-748" tabindex="-1"></a>      </span>
<span id="cb266-749"><a href="simulace3sigma.html#cb266-749" tabindex="-1"></a>      data.projection.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.train)</span>
<span id="cb266-750"><a href="simulace3sigma.html#cb266-750" tabindex="-1"></a>      data.projection.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb266-751"><a href="simulace3sigma.html#cb266-751" tabindex="-1"></a>      </span>
<span id="cb266-752"><a href="simulace3sigma.html#cb266-752" tabindex="-1"></a>      data.projection.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(XX.test)</span>
<span id="cb266-753"><a href="simulace3sigma.html#cb266-753" tabindex="-1"></a>      data.projection.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb266-754"><a href="simulace3sigma.html#cb266-754" tabindex="-1"></a>      </span>
<span id="cb266-755"><a href="simulace3sigma.html#cb266-755" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-756"><a href="simulace3sigma.html#cb266-756" tabindex="-1"></a>      clf.SVM.projection <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.projection.train,</span>
<span id="cb266-757"><a href="simulace3sigma.html#cb266-757" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-758"><a href="simulace3sigma.html#cb266-758" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-759"><a href="simulace3sigma.html#cb266-759" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-760"><a href="simulace3sigma.html#cb266-760" tabindex="-1"></a>                                <span class="at">kernel =</span> kernel_type)</span>
<span id="cb266-761"><a href="simulace3sigma.html#cb266-761" tabindex="-1"></a>      </span>
<span id="cb266-762"><a href="simulace3sigma.html#cb266-762" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-763"><a href="simulace3sigma.html#cb266-763" tabindex="-1"></a>      predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.train)</span>
<span id="cb266-764"><a href="simulace3sigma.html#cb266-764" tabindex="-1"></a>      presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb266-765"><a href="simulace3sigma.html#cb266-765" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-766"><a href="simulace3sigma.html#cb266-766" tabindex="-1"></a>        </span>
<span id="cb266-767"><a href="simulace3sigma.html#cb266-767" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-768"><a href="simulace3sigma.html#cb266-768" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.projection, <span class="at">newdata =</span> data.projection.test)</span>
<span id="cb266-769"><a href="simulace3sigma.html#cb266-769" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-770"><a href="simulace3sigma.html#cb266-770" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-771"><a href="simulace3sigma.html#cb266-771" tabindex="-1"></a>      </span>
<span id="cb266-772"><a href="simulace3sigma.html#cb266-772" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb266-773"><a href="simulace3sigma.html#cb266-773" tabindex="-1"></a>      Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb266-774"><a href="simulace3sigma.html#cb266-774" tabindex="-1"></a>    }</span>
<span id="cb266-775"><a href="simulace3sigma.html#cb266-775" tabindex="-1"></a>    </span>
<span id="cb266-776"><a href="simulace3sigma.html#cb266-776" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-777"><a href="simulace3sigma.html#cb266-777" tabindex="-1"></a>    </span>
<span id="cb266-778"><a href="simulace3sigma.html#cb266-778" tabindex="-1"></a>    <span class="do">## 7.5) SVM + RKHS</span></span>
<span id="cb266-779"><a href="simulace3sigma.html#cb266-779" tabindex="-1"></a>  </span>
<span id="cb266-780"><a href="simulace3sigma.html#cb266-780" tabindex="-1"></a>    <span class="do">### Gaussovo jadro</span></span>
<span id="cb266-781"><a href="simulace3sigma.html#cb266-781" tabindex="-1"></a>    </span>
<span id="cb266-782"><a href="simulace3sigma.html#cb266-782" tabindex="-1"></a>    <span class="co"># # jadro a jadrova matice ... Gaussovske s parametrem gamma</span></span>
<span id="cb266-783"><a href="simulace3sigma.html#cb266-783" tabindex="-1"></a>    <span class="co"># Gauss.kernel &lt;- function(x, y, gamma) {</span></span>
<span id="cb266-784"><a href="simulace3sigma.html#cb266-784" tabindex="-1"></a>    <span class="co">#   return(exp(-gamma * norm(c(x - y) |&gt; t(), type = &#39;F&#39;)))</span></span>
<span id="cb266-785"><a href="simulace3sigma.html#cb266-785" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb266-786"><a href="simulace3sigma.html#cb266-786" tabindex="-1"></a>    <span class="co"># </span></span>
<span id="cb266-787"><a href="simulace3sigma.html#cb266-787" tabindex="-1"></a>    <span class="co"># Kernel.RKHS &lt;- function(x, gamma) {</span></span>
<span id="cb266-788"><a href="simulace3sigma.html#cb266-788" tabindex="-1"></a>    <span class="co">#   K &lt;- matrix(NA, ncol = length(x), nrow = length(x))</span></span>
<span id="cb266-789"><a href="simulace3sigma.html#cb266-789" tabindex="-1"></a>    <span class="co">#   for(i in 1:nrow(K)) {</span></span>
<span id="cb266-790"><a href="simulace3sigma.html#cb266-790" tabindex="-1"></a>    <span class="co">#     for(j in 1:ncol(K)) {</span></span>
<span id="cb266-791"><a href="simulace3sigma.html#cb266-791" tabindex="-1"></a>    <span class="co">#       K[i, j] &lt;- Gauss.kernel(x = x[i], y = x[j], gamma = gamma)</span></span>
<span id="cb266-792"><a href="simulace3sigma.html#cb266-792" tabindex="-1"></a>    <span class="co">#     }</span></span>
<span id="cb266-793"><a href="simulace3sigma.html#cb266-793" tabindex="-1"></a>    <span class="co">#   }</span></span>
<span id="cb266-794"><a href="simulace3sigma.html#cb266-794" tabindex="-1"></a>    <span class="co">#   return(K)</span></span>
<span id="cb266-795"><a href="simulace3sigma.html#cb266-795" tabindex="-1"></a>    <span class="co"># }</span></span>
<span id="cb266-796"><a href="simulace3sigma.html#cb266-796" tabindex="-1"></a>    </span>
<span id="cb266-797"><a href="simulace3sigma.html#cb266-797" tabindex="-1"></a>    <span class="co"># rozdelime trenovaci data na k casti</span></span>
<span id="cb266-798"><a href="simulace3sigma.html#cb266-798" tabindex="-1"></a>    folds <span class="ot">&lt;-</span> <span class="fu">createMultiFolds</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">sum</span>(split), <span class="at">k =</span> k_cv, <span class="at">time =</span> <span class="dv">1</span>)</span>
<span id="cb266-799"><a href="simulace3sigma.html#cb266-799" tabindex="-1"></a>    <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb266-800"><a href="simulace3sigma.html#cb266-800" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb266-801"><a href="simulace3sigma.html#cb266-801" tabindex="-1"></a>    </span>
<span id="cb266-802"><a href="simulace3sigma.html#cb266-802" tabindex="-1"></a>    <span class="co"># hodnoty hyperparametru, ktere budeme prochazet</span></span>
<span id="cb266-803"><a href="simulace3sigma.html#cb266-803" tabindex="-1"></a>    dimensions <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">10</span>, <span class="dv">40</span>, <span class="at">by =</span> <span class="dv">5</span>) <span class="co"># rozumny rozsah hodnot d</span></span>
<span id="cb266-804"><a href="simulace3sigma.html#cb266-804" tabindex="-1"></a>    gamma.cv <span class="ot">&lt;-</span> <span class="dv">10</span><span class="sc">^</span><span class="fu">seq</span>(<span class="sc">-</span><span class="dv">2</span>, <span class="dv">2</span>, <span class="at">length =</span> <span class="dv">5</span>)</span>
<span id="cb266-805"><a href="simulace3sigma.html#cb266-805" tabindex="-1"></a>    </span>
<span id="cb266-806"><a href="simulace3sigma.html#cb266-806" tabindex="-1"></a>    <span class="co"># list se tremi slozkami ... array pro jednotlive jadra -&gt; linear, poly, radial</span></span>
<span id="cb266-807"><a href="simulace3sigma.html#cb266-807" tabindex="-1"></a>    <span class="co"># prazdna matice, do ktere vlozime jednotlive vysledky</span></span>
<span id="cb266-808"><a href="simulace3sigma.html#cb266-808" tabindex="-1"></a>    <span class="co"># ve sloupcich budou hodnoty presnosti pro dane</span></span>
<span id="cb266-809"><a href="simulace3sigma.html#cb266-809" tabindex="-1"></a>    <span class="co"># v radcich budou hodnoty pro danou gamma a vrstvy odpovidaji folds</span></span>
<span id="cb266-810"><a href="simulace3sigma.html#cb266-810" tabindex="-1"></a>    dim.names <span class="ot">&lt;-</span> <span class="fu">list</span>(<span class="at">gamma =</span> <span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma.cv, <span class="dv">3</span>)),</span>
<span id="cb266-811"><a href="simulace3sigma.html#cb266-811" tabindex="-1"></a>                      <span class="at">d =</span> <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, dimensions),</span>
<span id="cb266-812"><a href="simulace3sigma.html#cb266-812" tabindex="-1"></a>                      <span class="at">CV =</span> <span class="fu">paste0</span>(<span class="st">&#39;cv:&#39;</span>, <span class="dv">1</span><span class="sc">:</span>k_cv))</span>
<span id="cb266-813"><a href="simulace3sigma.html#cb266-813" tabindex="-1"></a>    </span>
<span id="cb266-814"><a href="simulace3sigma.html#cb266-814" tabindex="-1"></a>    CV.results <span class="ot">&lt;-</span> <span class="fu">list</span>(</span>
<span id="cb266-815"><a href="simulace3sigma.html#cb266-815" tabindex="-1"></a>      <span class="at">SVM.l =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb266-816"><a href="simulace3sigma.html#cb266-816" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names),</span>
<span id="cb266-817"><a href="simulace3sigma.html#cb266-817" tabindex="-1"></a>      <span class="at">SVM.p =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb266-818"><a href="simulace3sigma.html#cb266-818" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names),</span>
<span id="cb266-819"><a href="simulace3sigma.html#cb266-819" tabindex="-1"></a>      <span class="at">SVM.r =</span> <span class="fu">array</span>(<span class="cn">NA</span>, <span class="at">dim =</span> <span class="fu">c</span>(<span class="fu">length</span>(gamma.cv), <span class="fu">length</span>(dimensions), k_cv),</span>
<span id="cb266-820"><a href="simulace3sigma.html#cb266-820" tabindex="-1"></a>                    <span class="at">dimnames =</span> dim.names))</span>
<span id="cb266-821"><a href="simulace3sigma.html#cb266-821" tabindex="-1"></a>    </span>
<span id="cb266-822"><a href="simulace3sigma.html#cb266-822" tabindex="-1"></a>    <span class="co"># samotna CV</span></span>
<span id="cb266-823"><a href="simulace3sigma.html#cb266-823" tabindex="-1"></a>    <span class="cf">for</span> (gamma <span class="cf">in</span> gamma.cv) {</span>
<span id="cb266-824"><a href="simulace3sigma.html#cb266-824" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb266-825"><a href="simulace3sigma.html#cb266-825" tabindex="-1"></a>      Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb266-826"><a href="simulace3sigma.html#cb266-826" tabindex="-1"></a>      eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb266-827"><a href="simulace3sigma.html#cb266-827" tabindex="-1"></a>      eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb266-828"><a href="simulace3sigma.html#cb266-828" tabindex="-1"></a>      alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>], <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) </span>
<span id="cb266-829"><a href="simulace3sigma.html#cb266-829" tabindex="-1"></a>      </span>
<span id="cb266-830"><a href="simulace3sigma.html#cb266-830" tabindex="-1"></a>      <span class="co"># model</span></span>
<span id="cb266-831"><a href="simulace3sigma.html#cb266-831" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb266-832"><a href="simulace3sigma.html#cb266-832" tabindex="-1"></a>        df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb266-833"><a href="simulace3sigma.html#cb266-833" tabindex="-1"></a>                             <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb266-834"><a href="simulace3sigma.html#cb266-834" tabindex="-1"></a>        svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb266-835"><a href="simulace3sigma.html#cb266-835" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb266-836"><a href="simulace3sigma.html#cb266-836" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb266-837"><a href="simulace3sigma.html#cb266-837" tabindex="-1"></a>                        <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb266-838"><a href="simulace3sigma.html#cb266-838" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma)</span>
<span id="cb266-839"><a href="simulace3sigma.html#cb266-839" tabindex="-1"></a>        alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs </span>
<span id="cb266-840"><a href="simulace3sigma.html#cb266-840" tabindex="-1"></a>      }</span>
<span id="cb266-841"><a href="simulace3sigma.html#cb266-841" tabindex="-1"></a>      </span>
<span id="cb266-842"><a href="simulace3sigma.html#cb266-842" tabindex="-1"></a>      <span class="co"># projdeme dimenze</span></span>
<span id="cb266-843"><a href="simulace3sigma.html#cb266-843" tabindex="-1"></a>      <span class="cf">for</span>(d.RKHS <span class="cf">in</span> dimensions) {</span>
<span id="cb266-844"><a href="simulace3sigma.html#cb266-844" tabindex="-1"></a>        Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb266-845"><a href="simulace3sigma.html#cb266-845" tabindex="-1"></a>                              <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb266-846"><a href="simulace3sigma.html#cb266-846" tabindex="-1"></a>                              <span class="at">nrow =</span> d.RKHS) </span>
<span id="cb266-847"><a href="simulace3sigma.html#cb266-847" tabindex="-1"></a>        <span class="co"># vypocet reprezentace</span></span>
<span id="cb266-848"><a href="simulace3sigma.html#cb266-848" tabindex="-1"></a>        <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb266-849"><a href="simulace3sigma.html#cb266-849" tabindex="-1"></a>          Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> </span>
<span id="cb266-850"><a href="simulace3sigma.html#cb266-850" tabindex="-1"></a>                                 alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb266-851"><a href="simulace3sigma.html#cb266-851" tabindex="-1"></a>        }</span>
<span id="cb266-852"><a href="simulace3sigma.html#cb266-852" tabindex="-1"></a>        <span class="co"># projdeme folds</span></span>
<span id="cb266-853"><a href="simulace3sigma.html#cb266-853" tabindex="-1"></a>        <span class="cf">for</span> (index_cv <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>k_cv) {</span>
<span id="cb266-854"><a href="simulace3sigma.html#cb266-854" tabindex="-1"></a>          <span class="co"># definice testovaci a trenovaci casti pro CV</span></span>
<span id="cb266-855"><a href="simulace3sigma.html#cb266-855" tabindex="-1"></a>          fold <span class="ot">&lt;-</span> folds[[index_cv]]</span>
<span id="cb266-856"><a href="simulace3sigma.html#cb266-856" tabindex="-1"></a>          <span class="co"># rozdeleni na trenovaci a validacni data</span></span>
<span id="cb266-857"><a href="simulace3sigma.html#cb266-857" tabindex="-1"></a>          XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, fold]</span>
<span id="cb266-858"><a href="simulace3sigma.html#cb266-858" tabindex="-1"></a>          XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)]</span>
<span id="cb266-859"><a href="simulace3sigma.html#cb266-859" tabindex="-1"></a>          <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb266-860"><a href="simulace3sigma.html#cb266-860" tabindex="-1"></a>          Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS&#39;</span>, </span>
<span id="cb266-861"><a href="simulace3sigma.html#cb266-861" tabindex="-1"></a>                                      <span class="st">&#39;SVM poly - RKHS&#39;</span>, </span>
<span id="cb266-862"><a href="simulace3sigma.html#cb266-862" tabindex="-1"></a>                                      <span class="st">&#39;SVM rbf - RKHS&#39;</span>), </span>
<span id="cb266-863"><a href="simulace3sigma.html#cb266-863" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb266-864"><a href="simulace3sigma.html#cb266-864" tabindex="-1"></a>          <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb266-865"><a href="simulace3sigma.html#cb266-865" tabindex="-1"></a>          <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb266-866"><a href="simulace3sigma.html#cb266-866" tabindex="-1"></a>            kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb266-867"><a href="simulace3sigma.html#cb266-867" tabindex="-1"></a>          </span>
<span id="cb266-868"><a href="simulace3sigma.html#cb266-868" tabindex="-1"></a>            data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb266-869"><a href="simulace3sigma.html#cb266-869" tabindex="-1"></a>            data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[fold])</span>
<span id="cb266-870"><a href="simulace3sigma.html#cb266-870" tabindex="-1"></a>            </span>
<span id="cb266-871"><a href="simulace3sigma.html#cb266-871" tabindex="-1"></a>            data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb266-872"><a href="simulace3sigma.html#cb266-872" tabindex="-1"></a>            data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train[<span class="sc">!</span>(<span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>] <span class="sc">%in%</span> fold)])</span>
<span id="cb266-873"><a href="simulace3sigma.html#cb266-873" tabindex="-1"></a>            </span>
<span id="cb266-874"><a href="simulace3sigma.html#cb266-874" tabindex="-1"></a>            <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-875"><a href="simulace3sigma.html#cb266-875" tabindex="-1"></a>            clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb266-876"><a href="simulace3sigma.html#cb266-876" tabindex="-1"></a>                                <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-877"><a href="simulace3sigma.html#cb266-877" tabindex="-1"></a>                                <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-878"><a href="simulace3sigma.html#cb266-878" tabindex="-1"></a>                                <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-879"><a href="simulace3sigma.html#cb266-879" tabindex="-1"></a>                                <span class="at">kernel =</span> kernel_type)</span>
<span id="cb266-880"><a href="simulace3sigma.html#cb266-880" tabindex="-1"></a>            </span>
<span id="cb266-881"><a href="simulace3sigma.html#cb266-881" tabindex="-1"></a>            <span class="co"># presnost na validacnich datech</span></span>
<span id="cb266-882"><a href="simulace3sigma.html#cb266-882" tabindex="-1"></a>            predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb266-883"><a href="simulace3sigma.html#cb266-883" tabindex="-1"></a>            presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(data.RKHS.test<span class="sc">$</span>Y, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-884"><a href="simulace3sigma.html#cb266-884" tabindex="-1"></a>              <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-885"><a href="simulace3sigma.html#cb266-885" tabindex="-1"></a>            </span>
<span id="cb266-886"><a href="simulace3sigma.html#cb266-886" tabindex="-1"></a>            <span class="co"># ulozeni vysledku</span></span>
<span id="cb266-887"><a href="simulace3sigma.html#cb266-887" tabindex="-1"></a>            Res[kernel_number, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> presnost.test</span>
<span id="cb266-888"><a href="simulace3sigma.html#cb266-888" tabindex="-1"></a>          }</span>
<span id="cb266-889"><a href="simulace3sigma.html#cb266-889" tabindex="-1"></a>          <span class="co"># presnosti vlozime na pozice pro dane d, gamma a fold</span></span>
<span id="cb266-890"><a href="simulace3sigma.html#cb266-890" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.l[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb266-891"><a href="simulace3sigma.html#cb266-891" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb266-892"><a href="simulace3sigma.html#cb266-892" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">1</span>, <span class="dv">2</span>]</span>
<span id="cb266-893"><a href="simulace3sigma.html#cb266-893" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.p[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb266-894"><a href="simulace3sigma.html#cb266-894" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb266-895"><a href="simulace3sigma.html#cb266-895" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">2</span>, <span class="dv">2</span>]</span>
<span id="cb266-896"><a href="simulace3sigma.html#cb266-896" tabindex="-1"></a>          CV.results<span class="sc">$</span>SVM.r[<span class="fu">paste0</span>(<span class="st">&#39;gamma:&#39;</span>, <span class="fu">round</span>(gamma, <span class="dv">3</span>)), </span>
<span id="cb266-897"><a href="simulace3sigma.html#cb266-897" tabindex="-1"></a>                           <span class="fu">paste0</span>(<span class="st">&#39;d:&#39;</span>, d.RKHS), </span>
<span id="cb266-898"><a href="simulace3sigma.html#cb266-898" tabindex="-1"></a>                           index_cv] <span class="ot">&lt;-</span> Res[<span class="dv">3</span>, <span class="dv">2</span>]</span>
<span id="cb266-899"><a href="simulace3sigma.html#cb266-899" tabindex="-1"></a>        }</span>
<span id="cb266-900"><a href="simulace3sigma.html#cb266-900" tabindex="-1"></a>      }</span>
<span id="cb266-901"><a href="simulace3sigma.html#cb266-901" tabindex="-1"></a>    }</span>
<span id="cb266-902"><a href="simulace3sigma.html#cb266-902" tabindex="-1"></a>    </span>
<span id="cb266-903"><a href="simulace3sigma.html#cb266-903" tabindex="-1"></a>    <span class="co"># spocitame prumerne presnosti pro jednotliva d pres folds</span></span>
<span id="cb266-904"><a href="simulace3sigma.html#cb266-904" tabindex="-1"></a>    <span class="cf">for</span> (n_method <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">length</span>(CV.results)) {</span>
<span id="cb266-905"><a href="simulace3sigma.html#cb266-905" tabindex="-1"></a>      CV.results[[n_method]] <span class="ot">&lt;-</span> <span class="fu">apply</span>(CV.results[[n_method]], <span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">2</span>), mean)</span>
<span id="cb266-906"><a href="simulace3sigma.html#cb266-906" tabindex="-1"></a>    }</span>
<span id="cb266-907"><a href="simulace3sigma.html#cb266-907" tabindex="-1"></a>    </span>
<span id="cb266-908"><a href="simulace3sigma.html#cb266-908" tabindex="-1"></a>    gamma.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.l) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb266-909"><a href="simulace3sigma.html#cb266-909" tabindex="-1"></a>                   <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.p) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv), </span>
<span id="cb266-910"><a href="simulace3sigma.html#cb266-910" tabindex="-1"></a>                   <span class="fu">which.min</span>(CV.results<span class="sc">$</span>SVM.r) <span class="sc">%%</span> <span class="fu">length</span>(gamma.cv))</span>
<span id="cb266-911"><a href="simulace3sigma.html#cb266-911" tabindex="-1"></a>    gamma.opt[gamma.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(gamma.cv)</span>
<span id="cb266-912"><a href="simulace3sigma.html#cb266-912" tabindex="-1"></a>    gamma.opt <span class="ot">&lt;-</span> gamma.cv[gamma.opt]</span>
<span id="cb266-913"><a href="simulace3sigma.html#cb266-913" tabindex="-1"></a>    </span>
<span id="cb266-914"><a href="simulace3sigma.html#cb266-914" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.l)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb266-915"><a href="simulace3sigma.html#cb266-915" tabindex="-1"></a>               <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.p)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions), </span>
<span id="cb266-916"><a href="simulace3sigma.html#cb266-916" tabindex="-1"></a>               <span class="fu">which.min</span>(<span class="fu">t</span>(CV.results<span class="sc">$</span>SVM.r)) <span class="sc">%%</span> <span class="fu">length</span>(dimensions))</span>
<span id="cb266-917"><a href="simulace3sigma.html#cb266-917" tabindex="-1"></a>    d.opt[d.opt <span class="sc">==</span> <span class="dv">0</span>] <span class="ot">&lt;-</span> <span class="fu">length</span>(dimensions)</span>
<span id="cb266-918"><a href="simulace3sigma.html#cb266-918" tabindex="-1"></a>    d.opt <span class="ot">&lt;-</span> dimensions[d.opt]</span>
<span id="cb266-919"><a href="simulace3sigma.html#cb266-919" tabindex="-1"></a>    </span>
<span id="cb266-920"><a href="simulace3sigma.html#cb266-920" tabindex="-1"></a>    err.opt.cv <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.l), </span>
<span id="cb266-921"><a href="simulace3sigma.html#cb266-921" tabindex="-1"></a>                         <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.p),</span>
<span id="cb266-922"><a href="simulace3sigma.html#cb266-922" tabindex="-1"></a>                         <span class="fu">min</span>(CV.results<span class="sc">$</span>SVM.r))</span>
<span id="cb266-923"><a href="simulace3sigma.html#cb266-923" tabindex="-1"></a>    df.RKHS.res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">d =</span> d.opt, <span class="at">gamma =</span> gamma.opt, <span class="at">CV =</span> err.opt.cv,</span>
<span id="cb266-924"><a href="simulace3sigma.html#cb266-924" tabindex="-1"></a>               <span class="at">Kernel =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>) <span class="sc">|&gt;</span> <span class="fu">factor</span>(),</span>
<span id="cb266-925"><a href="simulace3sigma.html#cb266-925" tabindex="-1"></a>               <span class="at">row.names =</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;poly&#39;</span>, <span class="st">&#39;radial&#39;</span>))</span>
<span id="cb266-926"><a href="simulace3sigma.html#cb266-926" tabindex="-1"></a>    </span>
<span id="cb266-927"><a href="simulace3sigma.html#cb266-927" tabindex="-1"></a>    <span class="co"># CV_RESULTS$SVM_RKHS_radial_gamma[sim] &lt;- gamma.opt</span></span>
<span id="cb266-928"><a href="simulace3sigma.html#cb266-928" tabindex="-1"></a>    <span class="co"># CV_RESULTS$SVM_RKHS_radial_d[sim] &lt;- d.opt</span></span>
<span id="cb266-929"><a href="simulace3sigma.html#cb266-929" tabindex="-1"></a>    </span>
<span id="cb266-930"><a href="simulace3sigma.html#cb266-930" tabindex="-1"></a>    <span class="co"># odstranime posledni sloupec, ve kterem jsou hodnoty Y</span></span>
<span id="cb266-931"><a href="simulace3sigma.html#cb266-931" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> grid.data[, <span class="sc">-</span><span class="fu">dim</span>(grid.data)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb266-932"><a href="simulace3sigma.html#cb266-932" tabindex="-1"></a>    <span class="co"># pridame i testovaci data</span></span>
<span id="cb266-933"><a href="simulace3sigma.html#cb266-933" tabindex="-1"></a>    data.RKHS <span class="ot">&lt;-</span> <span class="fu">cbind</span>(data.RKHS, grid.data.test[, <span class="sc">-</span><span class="fu">dim</span>(grid.data.test)[<span class="dv">2</span>]] <span class="sc">|&gt;</span> <span class="fu">t</span>())</span>
<span id="cb266-934"><a href="simulace3sigma.html#cb266-934" tabindex="-1"></a>    <span class="co"># pripravime si datovou tabulku pro ulozeni vysledku</span></span>
<span id="cb266-935"><a href="simulace3sigma.html#cb266-935" tabindex="-1"></a>    Res <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">model =</span> <span class="fu">c</span>(<span class="st">&#39;SVM linear - RKHS - radial&#39;</span>, </span>
<span id="cb266-936"><a href="simulace3sigma.html#cb266-936" tabindex="-1"></a>                                <span class="st">&#39;SVM poly - RKHS - radial&#39;</span>, </span>
<span id="cb266-937"><a href="simulace3sigma.html#cb266-937" tabindex="-1"></a>                                <span class="st">&#39;SVM rbf - RKHS - radial&#39;</span>), </span>
<span id="cb266-938"><a href="simulace3sigma.html#cb266-938" tabindex="-1"></a>                      <span class="at">Err.train =</span> <span class="cn">NA</span>,</span>
<span id="cb266-939"><a href="simulace3sigma.html#cb266-939" tabindex="-1"></a>                      <span class="at">Err.test =</span> <span class="cn">NA</span>)</span>
<span id="cb266-940"><a href="simulace3sigma.html#cb266-940" tabindex="-1"></a>    </span>
<span id="cb266-941"><a href="simulace3sigma.html#cb266-941" tabindex="-1"></a>    <span class="co"># projdeme jednotliva jadra</span></span>
<span id="cb266-942"><a href="simulace3sigma.html#cb266-942" tabindex="-1"></a>    <span class="cf">for</span> (kernel_number <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">3</span>) {</span>
<span id="cb266-943"><a href="simulace3sigma.html#cb266-943" tabindex="-1"></a>      <span class="co"># spocitame matici K</span></span>
<span id="cb266-944"><a href="simulace3sigma.html#cb266-944" tabindex="-1"></a>      gamma <span class="ot">&lt;-</span> gamma.opt[kernel_number] <span class="co"># hodnota gamma pomoci CV</span></span>
<span id="cb266-945"><a href="simulace3sigma.html#cb266-945" tabindex="-1"></a>      K <span class="ot">&lt;-</span> <span class="fu">Kernel.RKHS</span>(t.seq, <span class="at">gamma =</span> gamma)</span>
<span id="cb266-946"><a href="simulace3sigma.html#cb266-946" tabindex="-1"></a>      </span>
<span id="cb266-947"><a href="simulace3sigma.html#cb266-947" tabindex="-1"></a>      <span class="co"># urcime vlastni cisla a vektory</span></span>
<span id="cb266-948"><a href="simulace3sigma.html#cb266-948" tabindex="-1"></a>      Eig <span class="ot">&lt;-</span> <span class="fu">eigen</span>(K)</span>
<span id="cb266-949"><a href="simulace3sigma.html#cb266-949" tabindex="-1"></a>      eig.vals <span class="ot">&lt;-</span> Eig<span class="sc">$</span>values</span>
<span id="cb266-950"><a href="simulace3sigma.html#cb266-950" tabindex="-1"></a>      eig.vectors <span class="ot">&lt;-</span> Eig<span class="sc">$</span>vectors</span>
<span id="cb266-951"><a href="simulace3sigma.html#cb266-951" tabindex="-1"></a>      <span class="co"># urceni koeficientu alpha z SVM</span></span>
<span id="cb266-952"><a href="simulace3sigma.html#cb266-952" tabindex="-1"></a>      alpha.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">1</span>],</span>
<span id="cb266-953"><a href="simulace3sigma.html#cb266-953" tabindex="-1"></a>                           <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) <span class="co"># prazdny objekt</span></span>
<span id="cb266-954"><a href="simulace3sigma.html#cb266-954" tabindex="-1"></a>      </span>
<span id="cb266-955"><a href="simulace3sigma.html#cb266-955" tabindex="-1"></a>      <span class="co"># model</span></span>
<span id="cb266-956"><a href="simulace3sigma.html#cb266-956" tabindex="-1"></a>      <span class="cf">for</span>(i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb266-957"><a href="simulace3sigma.html#cb266-957" tabindex="-1"></a>        df.svm <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">x =</span> t.seq,</span>
<span id="cb266-958"><a href="simulace3sigma.html#cb266-958" tabindex="-1"></a>                             <span class="at">y =</span> data.RKHS[, i])</span>
<span id="cb266-959"><a href="simulace3sigma.html#cb266-959" tabindex="-1"></a>        svm.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(y <span class="sc">~</span> x, <span class="at">data =</span> df.svm, </span>
<span id="cb266-960"><a href="simulace3sigma.html#cb266-960" tabindex="-1"></a>                        <span class="at">kernel =</span> <span class="st">&#39;radial&#39;</span>,</span>
<span id="cb266-961"><a href="simulace3sigma.html#cb266-961" tabindex="-1"></a>                        <span class="at">type =</span> <span class="st">&#39;eps-regression&#39;</span>,</span>
<span id="cb266-962"><a href="simulace3sigma.html#cb266-962" tabindex="-1"></a>                        <span class="at">epsilon =</span> <span class="fl">0.1</span>,</span>
<span id="cb266-963"><a href="simulace3sigma.html#cb266-963" tabindex="-1"></a>                        <span class="at">gamma =</span> gamma)</span>
<span id="cb266-964"><a href="simulace3sigma.html#cb266-964" tabindex="-1"></a>        <span class="co"># urceni alpha</span></span>
<span id="cb266-965"><a href="simulace3sigma.html#cb266-965" tabindex="-1"></a>        alpha.RKHS[svm.RKHS<span class="sc">$</span>index, i] <span class="ot">&lt;-</span> svm.RKHS<span class="sc">$</span>coefs <span class="co"># nahrazeni nul koeficienty</span></span>
<span id="cb266-966"><a href="simulace3sigma.html#cb266-966" tabindex="-1"></a>      }</span>
<span id="cb266-967"><a href="simulace3sigma.html#cb266-967" tabindex="-1"></a>      <span class="co"># d</span></span>
<span id="cb266-968"><a href="simulace3sigma.html#cb266-968" tabindex="-1"></a>      d.RKHS <span class="ot">&lt;-</span> d.opt[kernel_number]</span>
<span id="cb266-969"><a href="simulace3sigma.html#cb266-969" tabindex="-1"></a>      </span>
<span id="cb266-970"><a href="simulace3sigma.html#cb266-970" tabindex="-1"></a>      <span class="co"># urceni vektoru lambda</span></span>
<span id="cb266-971"><a href="simulace3sigma.html#cb266-971" tabindex="-1"></a>      Lambda.RKHS <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="cn">NA</span>, </span>
<span id="cb266-972"><a href="simulace3sigma.html#cb266-972" tabindex="-1"></a>                            <span class="at">ncol =</span> <span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>], </span>
<span id="cb266-973"><a href="simulace3sigma.html#cb266-973" tabindex="-1"></a>                            <span class="at">nrow =</span> d.RKHS) <span class="co"># vytvoreni prazdneho objektu</span></span>
<span id="cb266-974"><a href="simulace3sigma.html#cb266-974" tabindex="-1"></a>      </span>
<span id="cb266-975"><a href="simulace3sigma.html#cb266-975" tabindex="-1"></a>      <span class="co"># vypocet reprezentace</span></span>
<span id="cb266-976"><a href="simulace3sigma.html#cb266-976" tabindex="-1"></a>      <span class="cf">for</span>(l <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(data.RKHS)[<span class="dv">2</span>]) {</span>
<span id="cb266-977"><a href="simulace3sigma.html#cb266-977" tabindex="-1"></a>        Lambda.RKHS[, l] <span class="ot">&lt;-</span> (<span class="fu">t</span>(eig.vectors[, <span class="dv">1</span><span class="sc">:</span>d.RKHS]) <span class="sc">%*%</span> alpha.RKHS[, l]) <span class="sc">*</span> eig.vals[<span class="dv">1</span><span class="sc">:</span>d.RKHS]</span>
<span id="cb266-978"><a href="simulace3sigma.html#cb266-978" tabindex="-1"></a>      }</span>
<span id="cb266-979"><a href="simulace3sigma.html#cb266-979" tabindex="-1"></a>      </span>
<span id="cb266-980"><a href="simulace3sigma.html#cb266-980" tabindex="-1"></a>      <span class="co"># rozdeleni na trenovaci a testovaci data</span></span>
<span id="cb266-981"><a href="simulace3sigma.html#cb266-981" tabindex="-1"></a>      XX.train <span class="ot">&lt;-</span> Lambda.RKHS[, <span class="dv">1</span><span class="sc">:</span><span class="fu">dim</span>(grid.data)[<span class="dv">1</span>]]</span>
<span id="cb266-982"><a href="simulace3sigma.html#cb266-982" tabindex="-1"></a>      XX.test <span class="ot">&lt;-</span> Lambda.RKHS[, (<span class="fu">dim</span>(grid.data)[<span class="dv">1</span>] <span class="sc">+</span> <span class="dv">1</span>)<span class="sc">:</span><span class="fu">dim</span>(Lambda.RKHS)[<span class="dv">2</span>]]</span>
<span id="cb266-983"><a href="simulace3sigma.html#cb266-983" tabindex="-1"></a>    </span>
<span id="cb266-984"><a href="simulace3sigma.html#cb266-984" tabindex="-1"></a>      kernel_type <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;linear&#39;</span>, <span class="st">&#39;polynomial&#39;</span>, <span class="st">&#39;radial&#39;</span>)[kernel_number]</span>
<span id="cb266-985"><a href="simulace3sigma.html#cb266-985" tabindex="-1"></a>    </span>
<span id="cb266-986"><a href="simulace3sigma.html#cb266-986" tabindex="-1"></a>      data.RKHS.train <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.train))</span>
<span id="cb266-987"><a href="simulace3sigma.html#cb266-987" tabindex="-1"></a>      data.RKHS.train<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.train)</span>
<span id="cb266-988"><a href="simulace3sigma.html#cb266-988" tabindex="-1"></a>      </span>
<span id="cb266-989"><a href="simulace3sigma.html#cb266-989" tabindex="-1"></a>      data.RKHS.test <span class="ot">&lt;-</span> <span class="fu">as.data.frame</span>(<span class="fu">t</span>(XX.test))</span>
<span id="cb266-990"><a href="simulace3sigma.html#cb266-990" tabindex="-1"></a>      data.RKHS.test<span class="sc">$</span>Y <span class="ot">&lt;-</span> <span class="fu">factor</span>(Y.test)</span>
<span id="cb266-991"><a href="simulace3sigma.html#cb266-991" tabindex="-1"></a>      </span>
<span id="cb266-992"><a href="simulace3sigma.html#cb266-992" tabindex="-1"></a>      <span class="co"># sestrojeni modelu</span></span>
<span id="cb266-993"><a href="simulace3sigma.html#cb266-993" tabindex="-1"></a>      clf.SVM.RKHS <span class="ot">&lt;-</span> <span class="fu">svm</span>(Y <span class="sc">~</span> ., <span class="at">data =</span> data.RKHS.train,</span>
<span id="cb266-994"><a href="simulace3sigma.html#cb266-994" tabindex="-1"></a>                          <span class="at">type =</span> <span class="st">&#39;C-classification&#39;</span>,</span>
<span id="cb266-995"><a href="simulace3sigma.html#cb266-995" tabindex="-1"></a>                          <span class="at">scale =</span> <span class="cn">TRUE</span>,</span>
<span id="cb266-996"><a href="simulace3sigma.html#cb266-996" tabindex="-1"></a>                          <span class="at">coef0 =</span> <span class="dv">1</span>,</span>
<span id="cb266-997"><a href="simulace3sigma.html#cb266-997" tabindex="-1"></a>                          <span class="at">kernel =</span> kernel_type)</span>
<span id="cb266-998"><a href="simulace3sigma.html#cb266-998" tabindex="-1"></a>      </span>
<span id="cb266-999"><a href="simulace3sigma.html#cb266-999" tabindex="-1"></a>      <span class="co"># presnost na trenovacich datech</span></span>
<span id="cb266-1000"><a href="simulace3sigma.html#cb266-1000" tabindex="-1"></a>      predictions.train <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.train)</span>
<span id="cb266-1001"><a href="simulace3sigma.html#cb266-1001" tabindex="-1"></a>      presnost.train <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.train, predictions.train) <span class="sc">|&gt;</span></span>
<span id="cb266-1002"><a href="simulace3sigma.html#cb266-1002" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-1003"><a href="simulace3sigma.html#cb266-1003" tabindex="-1"></a>        </span>
<span id="cb266-1004"><a href="simulace3sigma.html#cb266-1004" tabindex="-1"></a>      <span class="co"># presnost na testovacich datech</span></span>
<span id="cb266-1005"><a href="simulace3sigma.html#cb266-1005" tabindex="-1"></a>      predictions.test <span class="ot">&lt;-</span> <span class="fu">predict</span>(clf.SVM.RKHS, <span class="at">newdata =</span> data.RKHS.test)</span>
<span id="cb266-1006"><a href="simulace3sigma.html#cb266-1006" tabindex="-1"></a>      presnost.test <span class="ot">&lt;-</span> <span class="fu">table</span>(Y.test, predictions.test) <span class="sc">|&gt;</span></span>
<span id="cb266-1007"><a href="simulace3sigma.html#cb266-1007" tabindex="-1"></a>        <span class="fu">prop.table</span>() <span class="sc">|&gt;</span> <span class="fu">diag</span>() <span class="sc">|&gt;</span> <span class="fu">sum</span>()</span>
<span id="cb266-1008"><a href="simulace3sigma.html#cb266-1008" tabindex="-1"></a>      </span>
<span id="cb266-1009"><a href="simulace3sigma.html#cb266-1009" tabindex="-1"></a>      <span class="co"># ulozeni vysledku</span></span>
<span id="cb266-1010"><a href="simulace3sigma.html#cb266-1010" tabindex="-1"></a>      Res[kernel_number, <span class="fu">c</span>(<span class="dv">2</span>, <span class="dv">3</span>)] <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> <span class="fu">c</span>(presnost.train, presnost.test)</span>
<span id="cb266-1011"><a href="simulace3sigma.html#cb266-1011" tabindex="-1"></a>    }</span>
<span id="cb266-1012"><a href="simulace3sigma.html#cb266-1012" tabindex="-1"></a>    </span>
<span id="cb266-1013"><a href="simulace3sigma.html#cb266-1013" tabindex="-1"></a>    RESULTS <span class="ot">&lt;-</span> <span class="fu">rbind</span>(RESULTS, Res)</span>
<span id="cb266-1014"><a href="simulace3sigma.html#cb266-1014" tabindex="-1"></a></span>
<span id="cb266-1015"><a href="simulace3sigma.html#cb266-1015" tabindex="-1"></a>    <span class="do">## pridame vysledky do objektu SIMULACE</span></span>
<span id="cb266-1016"><a href="simulace3sigma.html#cb266-1016" tabindex="-1"></a>    </span>
<span id="cb266-1017"><a href="simulace3sigma.html#cb266-1017" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>train[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.train</span>
<span id="cb266-1018"><a href="simulace3sigma.html#cb266-1018" tabindex="-1"></a>    SIMULACE<span class="sc">$</span>test[sim, ] <span class="ot">&lt;-</span> RESULTS<span class="sc">$</span>Err.test</span>
<span id="cb266-1019"><a href="simulace3sigma.html#cb266-1019" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">&#39;</span><span class="sc">\r</span><span class="st">&#39;</span>, <span class="fu">paste0</span>(n_sigma, <span class="st">&#39;: &#39;</span>, sim))</span>
<span id="cb266-1020"><a href="simulace3sigma.html#cb266-1020" tabindex="-1"></a>  }</span>
<span id="cb266-1021"><a href="simulace3sigma.html#cb266-1021" tabindex="-1"></a>  </span>
<span id="cb266-1022"><a href="simulace3sigma.html#cb266-1022" tabindex="-1"></a>  <span class="co"># Nyní spočítáme průměrné testovací a trénovací chybovosti pro jednotlivé klasifikační metody.</span></span>
<span id="cb266-1023"><a href="simulace3sigma.html#cb266-1023" tabindex="-1"></a>  </span>
<span id="cb266-1024"><a href="simulace3sigma.html#cb266-1024" tabindex="-1"></a>  <span class="co"># dame do vysledne tabulky</span></span>
<span id="cb266-1025"><a href="simulace3sigma.html#cb266-1025" tabindex="-1"></a>  </span>
<span id="cb266-1026"><a href="simulace3sigma.html#cb266-1026" tabindex="-1"></a>  SIMULACE.df <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Err.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, mean),</span>
<span id="cb266-1027"><a href="simulace3sigma.html#cb266-1027" tabindex="-1"></a>                            <span class="at">Err.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, mean),</span>
<span id="cb266-1028"><a href="simulace3sigma.html#cb266-1028" tabindex="-1"></a>                            <span class="at">SD.train =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>train, <span class="dv">2</span>, sd),</span>
<span id="cb266-1029"><a href="simulace3sigma.html#cb266-1029" tabindex="-1"></a>                            <span class="at">SD.test =</span> <span class="fu">apply</span>(SIMULACE<span class="sc">$</span>test, <span class="dv">2</span>, sd))</span>
<span id="cb266-1030"><a href="simulace3sigma.html#cb266-1030" tabindex="-1"></a>  </span>
<span id="cb266-1031"><a href="simulace3sigma.html#cb266-1031" tabindex="-1"></a>  SIMUL_params[, , n_sigma] <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(SIMULACE.df)</span>
<span id="cb266-1032"><a href="simulace3sigma.html#cb266-1032" tabindex="-1"></a>}</span>
<span id="cb266-1033"><a href="simulace3sigma.html#cb266-1033" tabindex="-1"></a></span>
<span id="cb266-1034"><a href="simulace3sigma.html#cb266-1034" tabindex="-1"></a><span class="co"># ulozime vysledne hodnoty </span></span>
<span id="cb266-1035"><a href="simulace3sigma.html#cb266-1035" tabindex="-1"></a><span class="fu">save</span>(SIMUL_params, <span class="at">file =</span> <span class="st">&#39;RData/simulace_parametry_sigma_03_rf_cv.RData&#39;</span>)</span></code></pre></div>
</details>
<div id="graphical-output" class="section level3 hasAnchor" number="2.4.1">
<h3><span class="header-section-number">2.4.1</span> Graphical Output<a href="simulace3sigma.html#graphical-output" class="anchor-section" aria-label="Anchor link to header"></a></h3>
<p>Let’s look at the dependence of simulated results on the value of the standard deviation parameter of the normal distribution for measurement errors. First, let’s plot the data for training errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb267"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb267-1"><a href="simulace3sigma.html#cb267-1" tabindex="-1"></a><span class="co"># for training data</span></span>
<span id="cb267-2"><a href="simulace3sigma.html#cb267-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb267-3"><a href="simulace3sigma.html#cb267-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span>   </span>
<span id="cb267-4"><a href="simulace3sigma.html#cb267-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb267-5"><a href="simulace3sigma.html#cb267-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(sigma_vector), </span>
<span id="cb267-6"><a href="simulace3sigma.html#cb267-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;sigma&#39;</span>, </span>
<span id="cb267-7"><a href="simulace3sigma.html#cb267-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb267-8"><a href="simulace3sigma.html#cb267-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb267-9"><a href="simulace3sigma.html#cb267-9" tabindex="-1"></a>         <span class="at">sigma =</span> <span class="fu">as.numeric</span>(sigma)) <span class="sc">|&gt;</span> </span>
<span id="cb267-10"><a href="simulace3sigma.html#cb267-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb267-11"><a href="simulace3sigma.html#cb267-11" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb267-12"><a href="simulace3sigma.html#cb267-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb267-13"><a href="simulace3sigma.html#cb267-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[x]),</span>
<span id="cb267-14"><a href="simulace3sigma.html#cb267-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test]),</span>
<span id="cb267-15"><a href="simulace3sigma.html#cb267-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb267-16"><a href="simulace3sigma.html#cb267-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-89"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-89-1.png" alt="Graph of the dependence of training error for individual classification methods on the value of the parameter $\sigma_{x}$, which defines the standard deviation for generating random deviations around the generating curves." width="672" />
<p class="caption">
Figure 2.13: Graph of the dependence of training error for individual classification methods on the value of the parameter <span class="math inline">\(\sigma_{x}\)</span>, which defines the standard deviation for generating random deviations around the generating curves.
</p>
</div>
<p>Next, for test errors.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb268"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb268-1"><a href="simulace3sigma.html#cb268-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb268-2"><a href="simulace3sigma.html#cb268-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb268-3"><a href="simulace3sigma.html#cb268-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span>   </span>
<span id="cb268-4"><a href="simulace3sigma.html#cb268-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb268-5"><a href="simulace3sigma.html#cb268-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(sigma_vector), </span>
<span id="cb268-6"><a href="simulace3sigma.html#cb268-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;sigma&#39;</span>, </span>
<span id="cb268-7"><a href="simulace3sigma.html#cb268-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb268-8"><a href="simulace3sigma.html#cb268-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb268-9"><a href="simulace3sigma.html#cb268-9" tabindex="-1"></a>         <span class="at">sigma =</span> <span class="fu">as.numeric</span>(sigma)) <span class="sc">|&gt;</span> </span>
<span id="cb268-10"><a href="simulace3sigma.html#cb268-10" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> Err, <span class="at">colour =</span> method)) <span class="sc">+</span> </span>
<span id="cb268-11"><a href="simulace3sigma.html#cb268-11" tabindex="-1"></a>  <span class="fu">geom_line</span>() <span class="sc">+</span> </span>
<span id="cb268-12"><a href="simulace3sigma.html#cb268-12" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb268-13"><a href="simulace3sigma.html#cb268-13" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="fu">expression</span>(sigma[x]),</span>
<span id="cb268-14"><a href="simulace3sigma.html#cb268-14" tabindex="-1"></a>       <span class="at">y =</span> <span class="fu">expression</span>(<span class="fu">widehat</span>(Err)[test]),</span>
<span id="cb268-15"><a href="simulace3sigma.html#cb268-15" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb268-16"><a href="simulace3sigma.html#cb268-16" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;bottom&#39;</span>)</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-90"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-90-1.png" alt="Graph of the dependence of test error for individual classification methods on the value of the parameter $\sigma_{x}$, which defines the standard deviation for generating random deviations around the generating curves." width="672" />
<p class="caption">
Figure 2.14: Graph of the dependence of test error for individual classification methods on the value of the parameter <span class="math inline">\(\sigma_{x}\)</span>, which defines the standard deviation for generating random deviations around the generating curves.
</p>
</div>
<p>Since the results are affected by random deviations, and increasing the number of repetitions <code>n.sim</code> would be computationally intensive, let’s now smooth the curves of the average test and training errors. Since the error is a non-negative quantity, we will smooth the curves with this in mind. Additionally, to ensure that the smoothed curves closely follow the observed discrete values, we consider a different weight for small and large values of <span class="math inline">\(\sigma\)</span>.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb269"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb269-1"><a href="simulace3sigma.html#cb269-1" tabindex="-1"></a>methods_subset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;RF_Bbasis&#39;</span>, <span class="st">&#39;SVM linear - diskr&#39;</span>,</span>
<span id="cb269-2"><a href="simulace3sigma.html#cb269-2" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - PCA&#39;</span>, <span class="st">&#39;SVM linear - Bbasis&#39;</span>,</span>
<span id="cb269-3"><a href="simulace3sigma.html#cb269-3" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>)</span>
<span id="cb269-4"><a href="simulace3sigma.html#cb269-4" tabindex="-1"></a></span>
<span id="cb269-5"><a href="simulace3sigma.html#cb269-5" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb269-6"><a href="simulace3sigma.html#cb269-6" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb269-7"><a href="simulace3sigma.html#cb269-7" tabindex="-1"></a></span>
<span id="cb269-8"><a href="simulace3sigma.html#cb269-8" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> sigma_vector</span>
<span id="cb269-9"><a href="simulace3sigma.html#cb269-9" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb269-10"><a href="simulace3sigma.html#cb269-10" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb269-11"><a href="simulace3sigma.html#cb269-11" tabindex="-1"></a></span>
<span id="cb269-12"><a href="simulace3sigma.html#cb269-12" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb269-13"><a href="simulace3sigma.html#cb269-13" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb269-14"><a href="simulace3sigma.html#cb269-14" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb269-15"><a href="simulace3sigma.html#cb269-15" tabindex="-1"></a></span>
<span id="cb269-16"><a href="simulace3sigma.html#cb269-16" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb269-17"><a href="simulace3sigma.html#cb269-17" tabindex="-1"></a></span>
<span id="cb269-18"><a href="simulace3sigma.html#cb269-18" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> <span class="fl">1e-4</span></span>
<span id="cb269-19"><a href="simulace3sigma.html#cb269-19" tabindex="-1"></a></span>
<span id="cb269-20"><a href="simulace3sigma.html#cb269-20" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb269-21"><a href="simulace3sigma.html#cb269-21" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.pos</span>(breaks, Dat, curv.fdPar, <span class="at">dbglev =</span> <span class="dv">0</span>,</span>
<span id="cb269-22"><a href="simulace3sigma.html#cb269-22" tabindex="-1"></a>                      <span class="at">wtvec =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">8</span>, <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">20</span>))) <span class="co"># smooth.pos</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb270"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb270-1"><a href="simulace3sigma.html#cb270-1" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>Wfdobj <span class="co"># Wfdobj</span></span>
<span id="cb270-2"><a href="simulace3sigma.html#cb270-2" tabindex="-1"></a></span>
<span id="cb270-3"><a href="simulace3sigma.html#cb270-3" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.posfd</span>(<span class="at">Wfdobj =</span> XXfd,  <span class="co"># eval.posfd</span></span>
<span id="cb270-4"><a href="simulace3sigma.html#cb270-4" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(sigma_vector), <span class="fu">max</span>(sigma_vector), </span>
<span id="cb270-5"><a href="simulace3sigma.html#cb270-5" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb270-6"><a href="simulace3sigma.html#cb270-6" tabindex="-1"></a></span>
<span id="cb270-7"><a href="simulace3sigma.html#cb270-7" tabindex="-1"></a>df_plot_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb270-8"><a href="simulace3sigma.html#cb270-8" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb270-9"><a href="simulace3sigma.html#cb270-9" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb270-10"><a href="simulace3sigma.html#cb270-10" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(sigma_vector), <span class="fu">max</span>(sigma_vector), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb270-11"><a href="simulace3sigma.html#cb270-11" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb270-12"><a href="simulace3sigma.html#cb270-12" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb270-13"><a href="simulace3sigma.html#cb270-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb270-14"><a href="simulace3sigma.html#cb270-14" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
</details>
<p>To enhance clarity, we will plot the graphs only for a subset of methods.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb271"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb271-1"><a href="simulace3sigma.html#cb271-1" tabindex="-1"></a>methods_names <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb271-2"><a href="simulace3sigma.html#cb271-2" tabindex="-1"></a>      <span class="st">&#39;$K$ nearest neighbors&#39;</span>,</span>
<span id="cb271-3"><a href="simulace3sigma.html#cb271-3" tabindex="-1"></a>      <span class="st">&#39;Functional LR&#39;</span>,</span>
<span id="cb271-4"><a href="simulace3sigma.html#cb271-4" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) - discretization&#39;</span>,</span>
<span id="cb271-5"><a href="simulace3sigma.html#cb271-5" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) - fPCA&#39;</span>,</span>
<span id="cb271-6"><a href="simulace3sigma.html#cb271-6" tabindex="-1"></a>      <span class="st">&#39;SVM (linear) - projection&#39;</span>,</span>
<span id="cb271-7"><a href="simulace3sigma.html#cb271-7" tabindex="-1"></a>      <span class="st">&#39;RKHS (radial) + SVM (linear)&#39;</span></span>
<span id="cb271-8"><a href="simulace3sigma.html#cb271-8" tabindex="-1"></a>)</span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb272"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb272-1"><a href="simulace3sigma.html#cb272-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb272-2"><a href="simulace3sigma.html#cb272-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">1</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb272-3"><a href="simulace3sigma.html#cb272-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb272-4"><a href="simulace3sigma.html#cb272-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb272-5"><a href="simulace3sigma.html#cb272-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(sigma_vector), </span>
<span id="cb272-6"><a href="simulace3sigma.html#cb272-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;sigma&#39;</span>, </span>
<span id="cb272-7"><a href="simulace3sigma.html#cb272-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb272-8"><a href="simulace3sigma.html#cb272-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb272-9"><a href="simulace3sigma.html#cb272-9" tabindex="-1"></a>         <span class="at">sigma =</span> <span class="fu">as.numeric</span>(sigma)) <span class="sc">|&gt;</span> </span>
<span id="cb272-10"><a href="simulace3sigma.html#cb272-10" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb272-11"><a href="simulace3sigma.html#cb272-11" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb272-12"><a href="simulace3sigma.html#cb272-12" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb272-13"><a href="simulace3sigma.html#cb272-13" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb272-14"><a href="simulace3sigma.html#cb272-14" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb272-15"><a href="simulace3sigma.html#cb272-15" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb272-16"><a href="simulace3sigma.html#cb272-16" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;sigma&#39;</span>,</span>
<span id="cb272-17"><a href="simulace3sigma.html#cb272-17" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Test Error&#39;</span>,</span>
<span id="cb272-18"><a href="simulace3sigma.html#cb272-18" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb272-19"><a href="simulace3sigma.html#cb272-19" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb272-20"><a href="simulace3sigma.html#cb272-20" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb272-21"><a href="simulace3sigma.html#cb272-21" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>,</span>
<span id="cb272-22"><a href="simulace3sigma.html#cb272-22" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.7</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb272-23"><a href="simulace3sigma.html#cb272-23" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb272-24"><a href="simulace3sigma.html#cb272-24" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth, <span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb272-25"><a href="simulace3sigma.html#cb272-25" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb272-26"><a href="simulace3sigma.html#cb272-26" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">0.95</span>) <span class="sc">+</span> </span>
<span id="cb272-27"><a href="simulace3sigma.html#cb272-27" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;tomato&#39;</span>), <span class="fu">c</span>(<span class="dv">4</span>, <span class="dv">4</span>)),</span>
<span id="cb272-28"><a href="simulace3sigma.html#cb272-28" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb272-29"><a href="simulace3sigma.html#cb272-29" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;dotdash&#39;</span>, <span class="st">&#39;dashed&#39;</span>, <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dotted&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb272-30"><a href="simulace3sigma.html#cb272-30" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb272-31"><a href="simulace3sigma.html#cb272-31" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>, <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">4</span>)),</span>
<span id="cb272-32"><a href="simulace3sigma.html#cb272-32" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb272-33"><a href="simulace3sigma.html#cb272-33" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.2</span>, <span class="at">alpha =</span> <span class="fl">0.7</span>)),</span>
<span id="cb272-34"><a href="simulace3sigma.html#cb272-34" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.8</span>)))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-93"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-93-1.png" alt="Graph of the dependence of test error for individual classification methods on the value of the parameter $\sigma_{x}$." width="672" />
<p class="caption">
Figure 2.15: Graph of the dependence of test error for individual classification methods on the value of the parameter <span class="math inline">\(\sigma_{x}\)</span>.
</p>
</div>
<p>Now we will do the same for test error.</p>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb273"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb273-1"><a href="simulace3sigma.html#cb273-1" tabindex="-1"></a><span class="co"># methods_subset &lt;- c(&#39;KNN&#39;, &#39;LR_functional&#39;, &#39;RF_Bbasis&#39;, &#39;SVM linear - diskr&#39;,</span></span>
<span id="cb273-2"><a href="simulace3sigma.html#cb273-2" tabindex="-1"></a><span class="co">#                     &#39;SVM linear - PCA&#39;, &#39;SVM linear - Bbasis&#39;,</span></span>
<span id="cb273-3"><a href="simulace3sigma.html#cb273-3" tabindex="-1"></a><span class="co">#                     &#39;SVM linear - projection&#39;, &#39;SVM linear - RKHS - radial&#39;)</span></span>
<span id="cb273-4"><a href="simulace3sigma.html#cb273-4" tabindex="-1"></a>methods_subset <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">&#39;KNN&#39;</span>, <span class="st">&#39;LR_functional&#39;</span>, <span class="st">&#39;SVM linear - diskr&#39;</span>,</span>
<span id="cb273-5"><a href="simulace3sigma.html#cb273-5" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - PCA&#39;</span>,</span>
<span id="cb273-6"><a href="simulace3sigma.html#cb273-6" tabindex="-1"></a>                    <span class="st">&#39;SVM linear - projection&#39;</span>, <span class="st">&#39;SVM linear - RKHS - radial&#39;</span>)</span>
<span id="cb273-7"><a href="simulace3sigma.html#cb273-7" tabindex="-1"></a></span>
<span id="cb273-8"><a href="simulace3sigma.html#cb273-8" tabindex="-1"></a>Dat <span class="ot">&lt;-</span> SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb273-9"><a href="simulace3sigma.html#cb273-9" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> <span class="fu">t</span>()</span>
<span id="cb273-10"><a href="simulace3sigma.html#cb273-10" tabindex="-1"></a></span>
<span id="cb273-11"><a href="simulace3sigma.html#cb273-11" tabindex="-1"></a>breaks <span class="ot">&lt;-</span> sigma_vector</span>
<span id="cb273-12"><a href="simulace3sigma.html#cb273-12" tabindex="-1"></a>rangeval <span class="ot">&lt;-</span> <span class="fu">range</span>(breaks)</span>
<span id="cb273-13"><a href="simulace3sigma.html#cb273-13" tabindex="-1"></a>norder <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb273-14"><a href="simulace3sigma.html#cb273-14" tabindex="-1"></a></span>
<span id="cb273-15"><a href="simulace3sigma.html#cb273-15" tabindex="-1"></a>bbasis <span class="ot">&lt;-</span> <span class="fu">create.bspline.basis</span>(<span class="at">rangeval =</span> rangeval, </span>
<span id="cb273-16"><a href="simulace3sigma.html#cb273-16" tabindex="-1"></a>                               <span class="at">norder =</span> norder, </span>
<span id="cb273-17"><a href="simulace3sigma.html#cb273-17" tabindex="-1"></a>                               <span class="at">breaks =</span> breaks)</span>
<span id="cb273-18"><a href="simulace3sigma.html#cb273-18" tabindex="-1"></a></span>
<span id="cb273-19"><a href="simulace3sigma.html#cb273-19" tabindex="-1"></a>curv.Lfd <span class="ot">&lt;-</span> <span class="fu">int2Lfd</span>(<span class="dv">2</span>)</span>
<span id="cb273-20"><a href="simulace3sigma.html#cb273-20" tabindex="-1"></a></span>
<span id="cb273-21"><a href="simulace3sigma.html#cb273-21" tabindex="-1"></a><span class="co"># lambda.vect &lt;- 10^seq(from = -2, to = 1, length.out = 50) # vector of lambdas</span></span>
<span id="cb273-22"><a href="simulace3sigma.html#cb273-22" tabindex="-1"></a><span class="co"># gcv &lt;- rep(NA, length = length(lambda.vect)) # empty vector for storing GCV</span></span>
<span id="cb273-23"><a href="simulace3sigma.html#cb273-23" tabindex="-1"></a></span>
<span id="cb273-24"><a href="simulace3sigma.html#cb273-24" tabindex="-1"></a><span class="co"># for(index in 1:length(lambda.vect)) {</span></span>
<span id="cb273-25"><a href="simulace3sigma.html#cb273-25" tabindex="-1"></a><span class="co">#   curv.Fdpar &lt;- fdPar(bbasis, curv.Lfd, lambda.vect[index])</span></span>
<span id="cb273-26"><a href="simulace3sigma.html#cb273-26" tabindex="-1"></a><span class="co">#   BSmooth &lt;- smooth.basis(breaks, Dat, curv.Fdpar) # smoothing</span></span>
<span id="cb273-27"><a href="simulace3sigma.html#cb273-27" tabindex="-1"></a><span class="co">#   gcv[index] &lt;- mean(BSmooth$gcv) # average over all observed curves</span></span>
<span id="cb273-28"><a href="simulace3sigma.html#cb273-28" tabindex="-1"></a><span class="co"># }</span></span>
<span id="cb273-29"><a href="simulace3sigma.html#cb273-29" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb273-30"><a href="simulace3sigma.html#cb273-30" tabindex="-1"></a><span class="co"># GCV &lt;- data.frame(</span></span>
<span id="cb273-31"><a href="simulace3sigma.html#cb273-31" tabindex="-1"></a><span class="co">#   lambda = round(log10(lambda.vect), 3),</span></span>
<span id="cb273-32"><a href="simulace3sigma.html#cb273-32" tabindex="-1"></a><span class="co">#   GCV = gcv</span></span>
<span id="cb273-33"><a href="simulace3sigma.html#cb273-33" tabindex="-1"></a><span class="co"># )</span></span>
<span id="cb273-34"><a href="simulace3sigma.html#cb273-34" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb273-35"><a href="simulace3sigma.html#cb273-35" tabindex="-1"></a><span class="co"># # find the minimum value</span></span>
<span id="cb273-36"><a href="simulace3sigma.html#cb273-36" tabindex="-1"></a><span class="co"># lambda.opt &lt;- lambda.vect[which.min(gcv)]</span></span>
<span id="cb273-37"><a href="simulace3sigma.html#cb273-37" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb273-38"><a href="simulace3sigma.html#cb273-38" tabindex="-1"></a><span class="co"># curv.fdPar &lt;- fdPar(bbasis, curv.Lfd, lambda.opt)</span></span>
<span id="cb273-39"><a href="simulace3sigma.html#cb273-39" tabindex="-1"></a><span class="co"># BSmooth &lt;- smooth.basis(breaks, Dat, curv.fdPar) # smooth.pos</span></span>
<span id="cb273-40"><a href="simulace3sigma.html#cb273-40" tabindex="-1"></a><span class="co"># XXfd &lt;- BSmooth$fd # Wfdobj</span></span>
<span id="cb273-41"><a href="simulace3sigma.html#cb273-41" tabindex="-1"></a><span class="co">#</span></span>
<span id="cb273-42"><a href="simulace3sigma.html#cb273-42" tabindex="-1"></a><span class="co"># fdobjSmootheval &lt;- eval.fd(fdobj = XXfd,  # eval.posfd</span></span>
<span id="cb273-43"><a href="simulace3sigma.html#cb273-43" tabindex="-1"></a><span class="co">#                            evalarg = seq(min(sigma_vector), max(sigma_vector),</span></span>
<span id="cb273-44"><a href="simulace3sigma.html#cb273-44" tabindex="-1"></a><span class="co">#                                          length = 101))</span></span>
<span id="cb273-45"><a href="simulace3sigma.html#cb273-45" tabindex="-1"></a></span>
<span id="cb273-46"><a href="simulace3sigma.html#cb273-46" tabindex="-1"></a><span class="co"># df_plot_smooth &lt;- data.frame(</span></span>
<span id="cb273-47"><a href="simulace3sigma.html#cb273-47" tabindex="-1"></a><span class="co">#   method = rep(colnames(fdobjSmootheval), each = dim(fdobjSmootheval)[1]),</span></span>
<span id="cb273-48"><a href="simulace3sigma.html#cb273-48" tabindex="-1"></a><span class="co">#   value = c(fdobjSmootheval),</span></span>
<span id="cb273-49"><a href="simulace3sigma.html#cb273-49" tabindex="-1"></a><span class="co">#   sigma = rep(seq(min(sigma_vector), max(sigma_vector), length = 101), length(methods))</span></span>
<span id="cb273-50"><a href="simulace3sigma.html#cb273-50" tabindex="-1"></a><span class="co"># ) |&gt; </span></span>
<span id="cb273-51"><a href="simulace3sigma.html#cb273-51" tabindex="-1"></a><span class="co">#   mutate(method = factor(method, levels = methods, labels = methods, ordered = TRUE))</span></span>
<span id="cb273-52"><a href="simulace3sigma.html#cb273-52" tabindex="-1"></a></span>
<span id="cb273-53"><a href="simulace3sigma.html#cb273-53" tabindex="-1"></a><span class="do">## for positive smoothing</span></span>
<span id="cb273-54"><a href="simulace3sigma.html#cb273-54" tabindex="-1"></a></span>
<span id="cb273-55"><a href="simulace3sigma.html#cb273-55" tabindex="-1"></a><span class="co"># find the minimum value</span></span>
<span id="cb273-56"><a href="simulace3sigma.html#cb273-56" tabindex="-1"></a>lambda.opt <span class="ot">&lt;-</span> <span class="fl">3e-4</span></span>
<span id="cb273-57"><a href="simulace3sigma.html#cb273-57" tabindex="-1"></a></span>
<span id="cb273-58"><a href="simulace3sigma.html#cb273-58" tabindex="-1"></a>curv.fdPar <span class="ot">&lt;-</span> <span class="fu">fdPar</span>(bbasis, curv.Lfd, lambda.opt)</span>
<span id="cb273-59"><a href="simulace3sigma.html#cb273-59" tabindex="-1"></a>BSmooth <span class="ot">&lt;-</span> <span class="fu">smooth.pos</span>(breaks, Dat, curv.fdPar, <span class="at">dbglev =</span> <span class="dv">0</span>,</span>
<span id="cb273-60"><a href="simulace3sigma.html#cb273-60" tabindex="-1"></a>                      <span class="co"># wtvec = c(rep(1000, 5), rep(100, 5), rep(1, 20))</span></span>
<span id="cb273-61"><a href="simulace3sigma.html#cb273-61" tabindex="-1"></a>                      <span class="at">wtvec =</span> <span class="fu">c</span>(<span class="fu">rep</span>(<span class="dv">1000</span>, <span class="dv">5</span>), <span class="fu">seq</span>(<span class="dv">100</span>, <span class="dv">10</span>, <span class="at">length =</span> <span class="dv">5</span>), <span class="fu">rep</span>(<span class="dv">1</span>, <span class="dv">20</span>))</span>
<span id="cb273-62"><a href="simulace3sigma.html#cb273-62" tabindex="-1"></a>                      ) <span class="co"># smooth.pos</span></span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb274"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb274-1"><a href="simulace3sigma.html#cb274-1" tabindex="-1"></a>XXfd <span class="ot">&lt;-</span> BSmooth<span class="sc">$</span>Wfdobj <span class="co"># Wfdobj</span></span>
<span id="cb274-2"><a href="simulace3sigma.html#cb274-2" tabindex="-1"></a></span>
<span id="cb274-3"><a href="simulace3sigma.html#cb274-3" tabindex="-1"></a>fdobjSmootheval <span class="ot">&lt;-</span> <span class="fu">eval.posfd</span>(<span class="at">Wfdobj =</span> XXfd,  <span class="co"># eval.posfd</span></span>
<span id="cb274-4"><a href="simulace3sigma.html#cb274-4" tabindex="-1"></a>                           <span class="at">evalarg =</span> <span class="fu">seq</span>(<span class="fu">min</span>(sigma_vector), <span class="fu">max</span>(sigma_vector), </span>
<span id="cb274-5"><a href="simulace3sigma.html#cb274-5" tabindex="-1"></a>                                         <span class="at">length =</span> <span class="dv">101</span>))</span>
<span id="cb274-6"><a href="simulace3sigma.html#cb274-6" tabindex="-1"></a></span>
<span id="cb274-7"><a href="simulace3sigma.html#cb274-7" tabindex="-1"></a>df_plot_smooth <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb274-8"><a href="simulace3sigma.html#cb274-8" tabindex="-1"></a>  <span class="at">method =</span> <span class="fu">rep</span>(methods, <span class="at">each =</span> <span class="fu">dim</span>(fdobjSmootheval)[<span class="dv">1</span>]),</span>
<span id="cb274-9"><a href="simulace3sigma.html#cb274-9" tabindex="-1"></a>  <span class="at">value =</span> <span class="fu">c</span>(fdobjSmootheval),</span>
<span id="cb274-10"><a href="simulace3sigma.html#cb274-10" tabindex="-1"></a>  <span class="at">sigma =</span> <span class="fu">rep</span>(<span class="fu">seq</span>(<span class="fu">min</span>(sigma_vector), <span class="fu">max</span>(sigma_vector), <span class="at">length =</span> <span class="dv">101</span>), <span class="fu">length</span>(methods))</span>
<span id="cb274-11"><a href="simulace3sigma.html#cb274-11" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb274-12"><a href="simulace3sigma.html#cb274-12" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb274-13"><a href="simulace3sigma.html#cb274-13" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb274-14"><a href="simulace3sigma.html#cb274-14" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) </span></code></pre></div>
</details>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb275"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb275-1"><a href="simulace3sigma.html#cb275-1" tabindex="-1"></a><span class="co"># for test data</span></span>
<span id="cb275-2"><a href="simulace3sigma.html#cb275-2" tabindex="-1"></a>SIMUL_params[, <span class="dv">2</span>, ] <span class="sc">|&gt;</span> </span>
<span id="cb275-3"><a href="simulace3sigma.html#cb275-3" tabindex="-1"></a>  <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb275-4"><a href="simulace3sigma.html#cb275-4" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> methods) <span class="sc">|&gt;</span></span>
<span id="cb275-5"><a href="simulace3sigma.html#cb275-5" tabindex="-1"></a>  <span class="fu">pivot_longer</span>(<span class="at">cols =</span> <span class="fu">as.character</span>(sigma_vector), </span>
<span id="cb275-6"><a href="simulace3sigma.html#cb275-6" tabindex="-1"></a>               <span class="at">names_to =</span> <span class="st">&#39;sigma&#39;</span>, </span>
<span id="cb275-7"><a href="simulace3sigma.html#cb275-7" tabindex="-1"></a>               <span class="at">values_to =</span> <span class="st">&#39;Err&#39;</span>) <span class="sc">|&gt;</span></span>
<span id="cb275-8"><a href="simulace3sigma.html#cb275-8" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods, <span class="at">labels =</span> methods, <span class="at">ordered =</span> <span class="cn">TRUE</span>), </span>
<span id="cb275-9"><a href="simulace3sigma.html#cb275-9" tabindex="-1"></a>         <span class="at">sigma =</span> <span class="fu">as.numeric</span>(sigma)) <span class="sc">|&gt;</span> </span>
<span id="cb275-10"><a href="simulace3sigma.html#cb275-10" tabindex="-1"></a>  <span class="co"># filter(method %in% c(&#39;KNN&#39;, &#39;QDA&#39;, &#39;LR_functional&#39;, </span></span>
<span id="cb275-11"><a href="simulace3sigma.html#cb275-11" tabindex="-1"></a>  <span class="co">#                      &#39;RF_discr&#39;, #&#39;RF_score&#39;, &#39;RF_Bbasis&#39;, </span></span>
<span id="cb275-12"><a href="simulace3sigma.html#cb275-12" tabindex="-1"></a>  <span class="co">#                      &#39;SVM linear - diskr&#39;,# &#39;SVM poly - diskr&#39;, &#39;SVM rbf - diskr&#39;, </span></span>
<span id="cb275-13"><a href="simulace3sigma.html#cb275-13" tabindex="-1"></a>  <span class="co">#                      # &#39;SVM linear - PCA&#39;,# &#39;SVM poly - PCA&#39;, &#39;SVM rbf - PCA&#39;, </span></span>
<span id="cb275-14"><a href="simulace3sigma.html#cb275-14" tabindex="-1"></a>  <span class="co">#                      &#39;SVM linear - Bbasis&#39;,# &#39;SVM poly - Bbasis&#39;, &#39;SVM rbf - Bbasis&#39;,</span></span>
<span id="cb275-15"><a href="simulace3sigma.html#cb275-15" tabindex="-1"></a>  <span class="co">#                      &#39;SVM linear - projection&#39;,# &#39;SVM poly - projection&#39;,</span></span>
<span id="cb275-16"><a href="simulace3sigma.html#cb275-16" tabindex="-1"></a>  <span class="co">#                      # &#39;SVM rbf - projection&#39;, </span></span>
<span id="cb275-17"><a href="simulace3sigma.html#cb275-17" tabindex="-1"></a>  <span class="co">#                      &#39;SVM linear - RKHS - radial&#39;#, &#39;SVM poly - RKHS - radial&#39;, </span></span>
<span id="cb275-18"><a href="simulace3sigma.html#cb275-18" tabindex="-1"></a>  <span class="co">#                      # &#39;SVM rbf - RKHS - radial&#39;</span></span>
<span id="cb275-19"><a href="simulace3sigma.html#cb275-19" tabindex="-1"></a>  <span class="co">#                      )) |&gt;</span></span>
<span id="cb275-20"><a href="simulace3sigma.html#cb275-20" tabindex="-1"></a>  <span class="fu">filter</span>(method <span class="sc">%in%</span> methods_subset) <span class="sc">|&gt;</span></span>
<span id="cb275-21"><a href="simulace3sigma.html#cb275-21" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">method =</span> <span class="fu">factor</span>(method, <span class="at">levels =</span> methods_subset, </span>
<span id="cb275-22"><a href="simulace3sigma.html#cb275-22" tabindex="-1"></a>                         <span class="at">labels =</span> methods_subset, <span class="at">ordered =</span> <span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb275-23"><a href="simulace3sigma.html#cb275-23" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> Err, <span class="at">colour =</span> method, <span class="at">shape =</span> method)) <span class="sc">+</span> </span>
<span id="cb275-24"><a href="simulace3sigma.html#cb275-24" tabindex="-1"></a>  <span class="fu">geom_point</span>(<span class="at">alpha =</span> <span class="fl">0.7</span>, <span class="at">size =</span> <span class="fl">0.6</span>) <span class="sc">+</span> </span>
<span id="cb275-25"><a href="simulace3sigma.html#cb275-25" tabindex="-1"></a>  <span class="fu">theme_bw</span>() <span class="sc">+</span> </span>
<span id="cb275-26"><a href="simulace3sigma.html#cb275-26" tabindex="-1"></a>  <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">&#39;sigma&#39;</span>,</span>
<span id="cb275-27"><a href="simulace3sigma.html#cb275-27" tabindex="-1"></a>       <span class="at">y =</span> <span class="st">&#39;Test Error&#39;</span>,</span>
<span id="cb275-28"><a href="simulace3sigma.html#cb275-28" tabindex="-1"></a>       <span class="at">colour =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb275-29"><a href="simulace3sigma.html#cb275-29" tabindex="-1"></a>       <span class="at">linetype =</span> <span class="st">&#39;Classification Method&#39;</span>,</span>
<span id="cb275-30"><a href="simulace3sigma.html#cb275-30" tabindex="-1"></a>       <span class="at">shape =</span> <span class="st">&#39;Classification Method&#39;</span>) <span class="sc">+</span> </span>
<span id="cb275-31"><a href="simulace3sigma.html#cb275-31" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">legend.position =</span> <span class="st">&#39;right&#39;</span>,</span>
<span id="cb275-32"><a href="simulace3sigma.html#cb275-32" tabindex="-1"></a>        <span class="at">plot.margin =</span> <span class="fu">unit</span>(<span class="fu">c</span>(<span class="fl">0.1</span>, <span class="fl">0.5</span>, <span class="fl">0.3</span>, <span class="fl">0.3</span>), <span class="st">&quot;cm&quot;</span>),</span>
<span id="cb275-33"><a href="simulace3sigma.html#cb275-33" tabindex="-1"></a>        <span class="at">panel.grid.minor.x =</span> <span class="fu">element_blank</span>()) <span class="sc">+</span></span>
<span id="cb275-34"><a href="simulace3sigma.html#cb275-34" tabindex="-1"></a>  <span class="co"># guides(colour=guide_legend(direction = &#39;vertical&#39;),</span></span>
<span id="cb275-35"><a href="simulace3sigma.html#cb275-35" tabindex="-1"></a>  <span class="co">#        linetype=guide_legend(direction = &#39;vertical&#39;),</span></span>
<span id="cb275-36"><a href="simulace3sigma.html#cb275-36" tabindex="-1"></a>  <span class="co">#        shape=guide_legend(direction = &#39;vertical&#39;)) + </span></span>
<span id="cb275-37"><a href="simulace3sigma.html#cb275-37" tabindex="-1"></a>    <span class="co"># scale_y_log10() +</span></span>
<span id="cb275-38"><a href="simulace3sigma.html#cb275-38" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">data =</span> df_plot_smooth, <span class="fu">aes</span>(<span class="at">x =</span> sigma, <span class="at">y =</span> value, <span class="at">col =</span> method,</span>
<span id="cb275-39"><a href="simulace3sigma.html#cb275-39" tabindex="-1"></a>                                       <span class="at">linetype =</span> method),</span>
<span id="cb275-40"><a href="simulace3sigma.html#cb275-40" tabindex="-1"></a>            <span class="at">linewidth =</span> <span class="fl">1.5</span>) <span class="sc">+</span> </span>
<span id="cb275-41"><a href="simulace3sigma.html#cb275-41" tabindex="-1"></a>  <span class="fu">scale_colour_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;deepskyblue2&#39;</span>, <span class="st">&#39;tomato&#39;</span>), <span class="fu">c</span>(<span class="dv">3</span>, <span class="dv">3</span>)),</span>
<span id="cb275-42"><a href="simulace3sigma.html#cb275-42" tabindex="-1"></a>                      <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb275-43"><a href="simulace3sigma.html#cb275-43" tabindex="-1"></a>  <span class="fu">scale_linetype_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="st">&#39;dashed&#39;</span>, <span class="st">&#39;solid&#39;</span>, <span class="st">&#39;dotted&#39;</span>), <span class="dv">2</span>),</span>
<span id="cb275-44"><a href="simulace3sigma.html#cb275-44" tabindex="-1"></a>                        <span class="at">labels =</span> methods_names) <span class="sc">+</span> </span>
<span id="cb275-45"><a href="simulace3sigma.html#cb275-45" tabindex="-1"></a>  <span class="fu">scale_shape_manual</span>(<span class="at">values =</span> <span class="fu">rep</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>, <span class="dv">16</span>, <span class="dv">1</span>, <span class="dv">17</span>)),</span>
<span id="cb275-46"><a href="simulace3sigma.html#cb275-46" tabindex="-1"></a>                     <span class="at">labels =</span> methods_names) <span class="sc">+</span></span>
<span id="cb275-47"><a href="simulace3sigma.html#cb275-47" tabindex="-1"></a>  <span class="fu">guides</span>(<span class="at">colour =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">size =</span> <span class="fl">1.4</span>, <span class="at">alpha =</span> <span class="fl">0.6</span>)),</span>
<span id="cb275-48"><a href="simulace3sigma.html#cb275-48" tabindex="-1"></a>         <span class="at">linetype =</span> <span class="fu">guide_legend</span>(<span class="at">override.aes =</span> <span class="fu">list</span>(<span class="at">linewidth =</span> <span class="fl">0.7</span>)))</span></code></pre></div>
</details>
<div class="figure"><span style="display:block;" id="fig:unnamed-chunk-95"></span>
<img src="02-Simulace_sigma_files/figure-html/unnamed-chunk-95-1.png" alt="Graph of the dependence of test error for individual classification methods on the parameter $\sigma_{x}$." width="672" />
<p class="caption">
Figure 2.16: Graph of the dependence of test error for individual classification methods on the parameter <span class="math inline">\(\sigma_{x}\)</span>.
</p>
</div>
<details class=chunk-details><summary class=chunk-summary><span class=chunk-summary-text>Code</span></summary>
<div class="sourceCode" id="cb276"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb276-1"><a href="simulace3sigma.html#cb276-1" tabindex="-1"></a><span class="co"># ggsave(&quot;figures/kap6_sim_03sigma_curvesErr_subset.tex&quot;, device = tikz, width = 8, height = 5)</span></span></code></pre></div>
</details>
<p>Comments on the graphs can be found in the thesis. We only note that as the value of <span class="math inline">\(\sigma\)</span> increases, the test error also increases for all methods. Functional logistic regression and projection onto the B-spline basis combined with the SVM method with a linear kernel perform the best.</p>

</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="simulace3.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="simulace3shift.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": null,
"fontsettings": null,
"edit": null,
"history": {
"link": null,
"text": null
},
"view": {
"link": "https://github.com/Tomas-Pompa/Functional_classification/blob/main/02-Simulace_sigma.Rmd",
"text": null
},
"download": null,
"search": false,
"toc": {
"collapse": "section",
"scroll_highlight": true
},
"toolbar": {
"position": "fixed"
},
"info": true
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.9/latest.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
